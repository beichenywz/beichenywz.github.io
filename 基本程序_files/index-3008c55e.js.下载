var wO=Object.defineProperty;var kO=(e,t,n)=>t in e?wO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var q=(e,t,n)=>(kO(e,typeof t!="symbol"?t+"":t,n),n),Cy=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var Ty=(e,t,n)=>(Cy(e,t,"read from private field"),n?n.call(e):t.get(e)),h_=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},vy=(e,t,n,s)=>(Cy(e,t,"write to private field"),s?s.call(e,n):t.set(e,n),n);var Ny=(e,t,n)=>(Cy(e,t,"access private method"),n);import CO from"https://cdn.staticfile.org/mermaid/10.1.0/mermaid.esm.min.mjs";import{e as TO,c as Jf,r as F,i as vd,P as vO,h as NO,d as IO,p as BE,l as pn,j as r,k as H3,f as At,a as he,b as jO,g as DO,z as SO,v as qe,m as No,n as LE,o as sd,S as Up,u as Vc,q as Un,s as m,R as zt,t as rn,w as rd,x as ad,y as Q0,A as RO,B as AO,C as BO,_ as be,D as $n,E as Wt,F as LO,G as Io,I as xI,H as Xn,J as Hu,M as $3,K as Gb,L as Vp,N as qp,O as un,Q as T1,T as FI,U as Ue,V as ju,W as PO,X as Cn,Y as yI,Z as Jn,$ as gl,a0 as gn,a1 as bI,a2 as PE,a3 as OO,a4 as v1,a5 as Ei,a6 as fs,a7 as MO,a8 as Ql,a9 as UO,aa as VO,ab as qO,ac as G3,ad as EI,ae as wI,af as HO,ag as $O,ah as Is,ai as kI,aj as GO,ak as Ja,al as vn,am as zO,an as zb,ao as WO,ap as OE,aq as KO,ar as Hp,as as CI,at as TI,au as YO,av as vI,aw as NI,ax as Wb,ay as II,az as XO,aA as QO,aB as As,aC as JO,aD as ZO,aE as Zf,aF as eM,aG as bm,aH as hc,aI as Sa,aJ as Ai,aK as jI,aL as Il,aM as Yt,aN as qr,aO as pc,aP as tM,aQ as ia,aR as DI,aS as SI,aT as Nd,aU as nM,aV as RI,aW as z3,aX as AI,aY as BI,aZ as Ar,a_ as yn,a$ as zn,b0 as eo,b1 as sM,b2 as Mh,b3 as rM,b4 as aM,b5 as Kb,b6 as oM,b7 as iM,b8 as Fh,b9 as lM,ba as cM,bb as uM,bc as dM,bd as fM,be as mM,bf as hM,bg as pM,bh as gM,bi as ep,bj as ya,bk as _M,bl as xM,bm as FM,bn as yM,bo as bM,bp as Zn,bq as EM,br as _u,bs as wM,bt as kM,bu as Yb,bv as CM,bw as sa,bx as TM,by as ME,bz as LI,bA as vM,bB as br,bC as yr,bD as Qo,bE as NM,bF as PI,bG as IM,bH as jM,bI as DM,bJ as SM,bK as RM,bL as AM,bM as BM,bN as OI,bO as em,bP as W3,bQ as LM,bR as PM,bS as OM,bT as MM,bU as UM,bV as UE,bW as MI,bX as VM,bY as Bi,bZ as UI,b_ as ro,b$ as $p,c0 as VI,c1 as kf,c2 as qI,c3 as Cf,c4 as HI,c5 as K3,c6 as Y3,c7 as qM,c8 as HM,c9 as $I,ca as $M,cb as VE,cc as GM,cd as tp,ce as Kr,cf as zM,cg as WM,ch as KM,ci as od,cj as $a,ck as Xb,cl as p_,cm as YM,cn as da,co as XM,cp as QM,cq as JM,cr as g_,cs as Xi,ct as ZM,cu as e8,cv as qc,cw as t8,cx as n8,cy as s8,cz as Gp,cA as qE,cB as r8,cC as a8,cD as o8,cE as i8,cF as l8,cG as c8,cH as u8,cI as d8,cJ as f8,cK as Yl,cL as GI,cM as m8,cN as X3,cO as h8,cP as Qb,cQ as p8,cR as zI,cS as WI,cT as Q3,cU as N1,cV as g8,cW as HE,cX as Em,cY as _8,cZ as KI,c_ as $E,c$ as J0,d0 as Z0,d1 as GE,d2 as YI,d3 as XI,d4 as QI,d5 as zE,d6 as JI,d7 as ZI,d8 as J3,d9 as x8,da as Z3,db as wm,dc as F8,dd as ej,de as y8,df as tj,dg as b8,dh as E8,di as WE,dj as w8,dk as eT,dl as tT,dm as k8,dn as C8,dp as nj,dq as T8,dr as KE,ds as ar,dt as v8,du as N8,dv as I8,dw as j8,dx as sj,dy as nT,dz as D8,dA as uf,dB as S8,dC as rj,dD as aj,dE as R8,dF as A8,dG as B8,dH as L8,dI as P8,dJ as O8,dK as oj,dL as M8,dM as U8,dN as xu,dO as V8,dP as q8}from"./vendor-72681657.js";function d0e(){import("data:text/javascript,")}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();window.mermaid=CO;const sT="https://flowus.cn/login?promotionChannel=Share_02",H8=1024,ij=H8*1024,Iy=ij*1024,id="【FlowUs 息流】";var wi=(e=>(e.splitView="splitView",e.code="code",e.preview="preview",e))(wi||{});const $8="modulepreload",G8=function(e){return"https://cdn.allflow.cn/"+e},rT={},ve=function(t,n,s){if(!n||n.length===0)return t();const a=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=G8(o),o in rT)return;rT[o]=!0;const i=o.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!s)for(let d=a.length-1;d>=0;d--){const f=a[d];if(f.href===o&&(!i||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":$8,i||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),i)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},z8="#2EA9DF",W8="#00AA90",K8="#1B813E",Y8="#FFC408",X8="#F98B2A",Q8="#CB4042",J8="#DB4D6D",Z8="#C1328E",e7="#6A4C9C",t7="#005CAF",n7="#18A0FB",s7="#74673E",r7="#A2A4A6",a7="#000000",o7="#000000",i7="#000000",l7="#000000",c7="#333333",u7="#4F4F4F",d7="#828282",f7="#BDBDBD",m7="#E0E0E0",h7="#E5E5E5",p7="#F0F0F0",g7="#F5F5F5",_7="#F7F7F7",x7="#FFFFFF",F7="#FFFFFF",y7="#FFFFFF",b7="#FFFFFF",E7="#FFFFFF",w7="#FFFFFF",k7="rgba(24,160,251,0.1)",C7="rgba(0,0,0,0.03)",T7="rgba(0,0,0,0.06)",v7="#FFFCBF",N7="#D1FFF0",I7="#CCF0FF",j7="#E5DAFF",D7="#FFD3D3",S7={black:"#D1D1D1",black1:"#252525",black2:"#2E2E2E",black3:"#A0A0A0",grey1:"#D1D1D1",grey2:"#A0A0A0",grey3:"#717171",grey4:"#595959",grey5:"#363636",grey6:"#2E2E2E",grey7:"#2E2E2E",grey8:"#1E1E1E",grey9:"#252525",white:"#D1D1D1",white1:"#171717",white2:"#202020",white3:"#252525",white4:"#2E2E2E",white5:"#363636",active_color:"#178BD8",active_color_10:"rgba(23,139,216,0.15)",black_003:"rgba(255,255,255,0.03)",black_006:"rgba(255,255,255,0.06)",light_yellow:"#675700",light_green:"#233D29",light_blue:"#253E5A",light_purple:"#322B62",light_red:"#4F2828"},to={blue:z8,green_blue:W8,green:K8,yellow:Y8,orange:X8,red:Q8,pink:J8,pink_purple:Z8,purple:e7,blue_cobalt:t7,active_color:n7,brown:s7,grey:r7,black:a7,black1:o7,black2:i7,black3:l7,grey1:c7,grey2:u7,grey3:d7,grey4:f7,grey5:m7,grey6:h7,grey7:p7,grey8:g7,grey9:_7,white:x7,white1:F7,white2:y7,white3:b7,white4:E7,white5:w7,active_color_10:k7,black_003:C7,black_006:T7,light_yellow:v7,light_green:N7,light_blue:I7,light_purple:j7,light_red:D7,"black-base":"#000000","black1-base":"#000000","black2-base":"#000000","black3-base":"#000000","grey1-base":"#333333","grey2-base":"#4F4F4F","grey3-base":"#828282","grey4-base":"#BDBDBD","grey5-base":"#E0E0E0","grey6-base":"#E5E5E5","grey7-base":"#F0F0F0","grey8-base":"#F5F5F5","grey9-base":"#F7F7F7","white-base":"#FFFFFF","white1-base":"#FFFFFF","white2-base":"#FFFFFF","white3-base":"#FFFFFF","white4-base":"#FFFFFF","white5-base":"#FFFFFF","active_color-base":"#18A0FB","active_color_10-base":"rgba(24,160,251,0.1)","black_003-base":"rgba(0,0,0,0.03)","black_006-base":"rgba(0,0,0,0.06)","light_yellow-base":"#FFFCBF","light_green-base":"#D1FFF0","light_blue-base":"#CCF0FF","light_purple-base":"#E5DAFF","light_red-base":"#FFD3D3",dark:S7},R7={".text-t0":{fontWeight:"400",fontSize:"22px",lineHeight:"var(--text-t0-line-height)"},".text-t0-medium":{fontWeight:"450",fontSize:"22px",lineHeight:"var(--text-t0-line-height)"},".text-t0-1":{fontWeight:"400",fontSize:"18px",lineHeight:"var(--text-t0-1-line-height)"},".text-t0-1-medium":{fontWeight:"500",fontSize:"18px",lineHeight:"var(--text-t0-1-line-height)"},".text-t1":{fontWeight:"400",fontSize:"16px",lineHeight:"var(--text-t1-line-height)"},".text-t1-medium":{fontSize:"16px",lineHeight:"var(--text-t1-line-height)",fontWeight:"500"},".text-t1-bold":{fontSize:"16px",lineHeight:"var(--text-t1-line-height)",fontWeight:"600"},".text-t2":{fontWeight:"400",fontSize:"14px",lineHeight:"var(--text-t2-line-height)"},".text-t2-medium":{fontSize:"14px",lineHeight:"var(--text-t2-line-height)",fontWeight:"500"},".text-t2-bold":{fontSize:"14px",lineHeight:"var(--text-t2-line-height)",fontWeight:"600"},".text-t3":{fontWeight:"400",fontSize:"13px",lineHeight:"var(--text-t3-line-height)"},".text-t3-medium":{fontSize:"13px",lineHeight:"var(--text-t3-line-height)",fontWeight:"500"},".text-t3-bold":{fontSize:"13px",lineHeight:"var(--text-t3-line-height)",fontWeight:"600"},".text-t4":{fontWeight:"400",fontSize:"12px",lineHeight:"var(--text-t4-line-height)"},".text-t4-medium":{fontSize:"12px",lineHeight:"var(--text-t4-line-height)",fontWeight:"500"},".text-t4-bold":{fontSize:"12px",lineHeight:"var(--text-t4-line-height)",fontWeight:"600"},".text-t5":{fontWeight:"400",fontSize:"12px",lineHeight:"var(--text-t5-line-height)"},".text-t5-medium":{fontSize:"12px",lineHeight:"var(--text-t5-line-height)",fontWeight:"500"},".text-t5-bold":{fontSize:"12px",lineHeight:"var(--text-t5-line-height)",fontWeight:"600"},".text-h0":{fontSize:"40px",lineHeight:"var(--text-h0-line-height)",fontWeight:"600"},".text-h1":{fontSize:"30px",lineHeight:"var(--text-h1-line-height)",fontWeight:"600"},".text-h2":{fontSize:"24px",lineHeight:"var(--text-h2-line-height)",fontWeight:"600"},".text-h3":{fontSize:"20px",lineHeight:"var(--text-h3-line-height)",fontWeight:"600"},".text-h4":{fontSize:"18px",lineHeight:"var(--text-h4-line-height)",fontWeight:"600"}},s1={};Object.keys(s1).forEach(e=>{const t=Object.keys(s1[e]);s1[e]=t});const A7=TO({theme:{...s1,colors:Object.keys(to)},classGroups:{text:Object.keys(R7).map(e=>e.replace(".","")),fontFace:["text-mono"]}}),B=(...e)=>A7(Jf(e)),_l=F.createContext(void 0),Te=()=>{const e=F.useContext(_l);if(!e)throw new Error("useBitable");return e},B7={background:"linear-gradient(0deg, var(--grey8), var(--grey8)), var(--grey9)"},dl={background:"linear-gradient(0deg, var(--white1), var(--white1)), var(--grey8)",boxShadow:"0px 4px 9.6px rgba(0, 0, 0, 0.12)",border:"1px solid var(--white2)"},Of={id1:"absolute rounded-sm left-0 top-0 w-[128px] h-[96px] rotate-[-13deg] z-[3]",id2:"absolute rounded-sm left-[76px] top-[20px] w-[128px] h-[96px] rotate-[-16deg] z-[2]",id3:"absolute rounded-sm left-[136px] top-[-21px] w-[128px] h-[96px] rotate-[-9.30deg] z-[1]"},xs=e=>new Promise(t=>{setTimeout(t,e)});let L7=class{constructor(){q(this,"resolve");q(this,"reject");q(this,"promise",new Promise((t,n)=>{this.resolve=t,this.reject=n}))}};const gc=e=>/cdn.flowus.cn|allflow.com/.test(`${e}`),P7=e=>{if(e)try{return new URL(e)}catch(t){return}},lj=e=>{if(!e||!gc(e)||!vd(e))return"";try{e=decodeURIComponent(e);const t=new URL(e);return t.pathname.startsWith("/oss/")||t.pathname.startsWith("/oss-dev/")?t.pathname:""}catch(t){return""}},O7=navigator.userAgent.toLowerCase().indexOf("alipayclient")!==-1;navigator.userAgent.toLowerCase().indexOf("micromessenger");const M7=e=>{var o,i;const t=atob(`${e.split(",")[1]}`),n=(i=(o=e.split(",")[0])==null?void 0:o.split(":")[1])==null?void 0:i.split(";")[0],s=new ArrayBuffer(t.length),a=new Uint8Array(s);for(let l=0;l<t.length;l++)a[l]=t.charCodeAt(l);return new Blob([s],{type:n})},aT=new vO({concurrency:5}),cj=e=>{const t=e.indexOf("?");if(t>0&&(e=e.substring(0,t)),!e.endsWith("/")){const n=e.lastIndexOf("/")+1;if(n>0)return e.substring(n)}return"未知文件名"},U7={},V7=e=>{let t=U7[e];if(!t){const n=gc(e);t=(async()=>await fetch(e,{method:"GET",referrerPolicy:n?"strict-origin-when-cross-origin":"no-referrer"}))()}return t},uj=e=>`${window.location.origin.startsWith("http")?window.location.origin:"https://flowus.cn"}/api/download/img?url=${encodeURIComponent(e)}`,q7={},dj=async e=>{let t=q7[e];return t||(t=(async()=>{const n=gc(e),s=await fetch(e,{method:"GET",referrerPolicy:n?"strict-origin-when-cross-origin":"no-referrer"});if(s.status===200){const a=cj(e),o=await s.blob();return{fileName:a,blob:o,url:e}}})()),t},oT=async(e,t=!1)=>{let n=e;if(t)try{const s=await NO({blob:e});if(Array.isArray(s)){const[a]=s;a&&(n=a)}else n=s}catch(s){return e}return n},jy=new Map,fj=(e,t)=>{const n=`${e}-${t.tryHeic}`,s=new L7,a=i=>{jy.set(n,i),t.callback(i)},o=()=>{aT.add(async()=>{var l;const i=await V7(uj(e));i.status===200?i.blob().then(async c=>{const u=await oT(c,t.tryHeic),d={fileName:cj(e),blob:u,url:e};a(d),s.resolve()}).catch(()=>{var c;(c=t.onError)==null||c.call(t),s.resolve()}):((l=t.onError)==null||l.call(t),s.resolve())})};if(jy.has(n)){const i=jy.get(n);if(i){a(i);return}}return aT.add(()=>dj(e).then(async i=>{if(i){const l=await oT(i.blob,t.tryHeic),c={...i,blob:l};a(c)}else o()}).catch(()=>{o()})),s.promise},Jb=()=>document.body.className.includes("dark"),mj=()=>{const[e,t]=F.useState(Jb());return F.useEffect(()=>{const n=document.body,s=()=>t(Jb()),a=new MutationObserver(o=>{o.forEach(i=>{i.type==="attributes"&&s()})});return s(),a.observe(n,{attributes:!0}),()=>{a.disconnect()}},[]),e},H7={grey:"#F2F2F2",brown:"#F0EDE0",orange:"#FFE9D4",yellow:"#FEF7D2",green:"#D9F2EE",blue:"#DCEEFF",purple:"#E9E9FF",pink:"#FEEAF2",red:"#FEE6E2",light_yellow:"#FFFCBF",light_green:"#D1FFF0",light_blue:"#CCF0FF",light_purple:"#E5DAFF",light_red:"#FFD3D3",yellow_green:"#F9F592,#96FBC4",green_blue:"#84FAB0,#79D3FF",blue_purple:"#6BE4FF,#928FFF",purple_red:"#D4A5FF,#FF7697",red_orange:"#F9748F,#FFC6AD"},$7={grey:"#414242",brown:"#373428",orange:"#503011",yellow:"#5C4D19",green:"#233D29",blue:"#253E5A",purple:"#322B62",pink:"#422238",red:"#4F2828",light_yellow:"#675700",light_green:"#005E47",light_blue:"#00597E",light_purple:"#3B1695",light_red:"#873634",yellow_green:"#4B492C,#2D4B3B",green_blue:"#284B35,#243F4C",blue_purple:"#20444C,#2C2B4C",purple_red:"#40314C,#4C232D",red_orange:"#4B232B,#4C3B34"},G7={grey:"#929495",brown:"#845C21",orange:"#E96900",yellow:"#E5B007",green:"#009828",blue:"#206CCF",purple:"#5543D3",pink:"#CB1E83",red:"#CB272D",black:"#000000"},z7={grey:"#7C7C7C",brown:"#95854C",orange:"#EA7E2A",yellow:"#BC9721",green:"#4DB972",blue:"#3A9FCA",purple:"#705EF4",pink:"#BB428B",red:"#D04B4B",black:"#B8B8B8"},W7={grey:"#474D58",brown:"#51482B",orange:"#683D26",yellow:"#8C652F",green:"#3B5B46",blue:"#263C68",purple:"#472B84",pink:"#8B2B69",red:"#8B2730"},K7={grey:"#FFFFFFCC",brown:"#FFFFFFCC",orange:"#FFFFFFCC",yellow:"#FFFFFFCC",green:"#FFFFFFCC",blue:"#FFFFFFCC",purple:"#FFFFFFCC",pink:"#FFFFFFCC",red:"#FFFFFFCC"},Y7={grey:"#ECEDED",brown:"#E8E5D7",orange:"#F8DEC5",yellow:"#FFF2C5",green:"#D2ECD5",blue:"#D2E1F9",purple:"#DCDCF8",pink:"#F8DAE6",red:"#FFD8D7"},X7={grey:"#4B4B4B",brown:"#423D2B",orange:"#623B1A",yellow:"#6E5710",green:"#26472E",blue:"#26466A",purple:"#3A307B",pink:"#512241",red:"#632E2E"},Q7={grey:"#40454F",brown:"#494127",orange:"#5E3722",yellow:"#5E4422",green:"#35523F",blue:"#22365E",purple:"#402777",pink:"#8B2B69",red:"#7D232B"},J7={grey:"#AAAAAA",brown:"#A18151",orange:"#BC814F",yellow:"#B3973C",green:"#46A05E",blue:"#546D8F",purple:"#69629A",pink:"#945A7C",red:"#C1585C"},Z7={grey:"#40454FCC",brown:"#494127CC",orange:"#5E3722CC",yellow:"#5E4422CC",green:"#35523FCC",blue:"#22365ECC",purple:"#402777CC",pink:"#8B2B69CC",red:"#7D232BCC"},eU={grey:"#747474",brown:"#6F5E43",orange:"#796A37",yellow:"#7D5E42",green:"#3D6F4A",blue:"#4C6380",purple:"#5E598A",pink:"#84526F",red:"#814749"},tU={grey:"#F7F9F9",brown:"#F8F7F5",orange:"#FFF9F4",yellow:"#FFFCF3",green:"#F4F9F5",blue:"#F2F7FB",purple:"#F5F5FE",pink:"#FDF6F8",red:"#FDF6F6"},nU={grey:"#252525",brown:"#27231E",orange:"#2A231D",yellow:"#29251B",green:"#1C261F",blue:"#1F242A",purple:"#23222C",pink:"#2A2027",red:"#2A1E1F"},sU={grey:"#F6F6F6",brown:"#F4F3ED",orange:"#FFF2E6",yellow:"#FEFAE4",green:"#E4F6F3",blue:"#E9F6FF",purple:"#EFEFFF",pink:"#FEF0F6",red:"#FEEFEC",light_yellow:"#FFFDD5",light_green:"#E1FFF5",light_blue:"#D9F4FF",light_purple:"#EEE7FF",light_red:"#FFE3E3"},rU={grey:"#323333",brown:"#2A2820",orange:"#3F2F1F",yellow:"#41381B",green:"#1F3729",blue:"#203246",purple:"#272230",pink:"#341F2D",red:"#362121",light_yellow:"#4F4407",light_green:"#074939",light_blue:"#07455F",light_purple:"#30166F",light_red:"#652D2B"},aU={grey:"#E5E6E6",brown:"#E1DDCC",orange:"#FDD9B6",yellow:"#F9EBBC",green:"#C2E3C6",blue:"#CCDAF2",purple:"#D6D6F4",pink:"#F5DBE7",red:"#F7D2D1"},oU={grey:"#7C7C7C4D",brown:"#95854C4D",orange:"#EA7E2A4D",yellow:"#BC97214D",green:"#4DB9724D",blue:"#3A9FCA4D",purple:"#705EF44D",pink:"#BB428B4D",red:"#D04B4B4D"},iU={grey:"#F2F2F2",brown:"#F0EDE0",orange:"#FFE9D4",yellow:"#FEF7D2",green:"#DEF3E0",blue:"#DCEEFF",purple:"#E9E9FF",pink:"#FEEAF2",red:"#FEE6E2"},lU={grey:"#414242",brown:"#373428",orange:"#503011",yellow:"#5C4D19",green:"#233D29",blue:"#253E5A",purple:"#322B62",pink:"#422238",red:"#4F2828"},cU={grey:"#A2A4A6",brown:"#A9834A",orange:"#FB7145",yellow:"#FFC408",green:"#32B851",blue:"#5094ED",purple:"#7767E5",pink:"#EB58AE",red:"#F95959"},uU={grey:"#7C7C7C",brown:"#95854C",orange:"#EA7E2A",yellow:"#BC9721",green:"#4DB972",blue:"#3A9FCA",purple:"#705EF4",pink:"#BB428B",red:"#D04B4B"},dU={grey:"#0000001A",brown:"#0000001A",orange:"#0000001A",yellow:"#0000001A",green:"#0000001A",blue:"#0000001A",purple:"#0000001A",pink:"#0000001A",red:"#0000001A"},fU={grey:"#FFFFFF1A",brown:"#FFFFFF1A",orange:"#FFFFFF1A",yellow:"#FFFFFF1A",green:"#FFFFFF1A",blue:"#FFFFFF1A",purple:"#FFFFFF1A",pink:"#FFFFFF1A",red:"#FFFFFF1A"},mU={grey:"#A2A4A6",brown:"#A9834A",orange:"#FB7145",yellow:"#FFC408",green:"#32B851",blue:"#5094ED",purple:"#7767E5",pink:"#EB58AE",red:"#F95959",black:"#000000"},hU={grey:"#7C7C7C",brown:"#95854C",orange:"#EA7E2A",yellow:"#BC9721",green:"#4DB972",blue:"#3A9FCA",purple:"#705EF4",pink:"#BB428B",red:"#D04B4B",black:"#B8B8B8"},pU={pink_purple:"pink",blue_cobalt:"blue"},ao=(e,t,n)=>{var o;if(!n)return n;["pink_purple","blue_cobalt"].includes(n)&&(n=(o=pU[n])!=null?o:n);const a=Jb()?t[n]:e[n];if(!a)return n;if(a!=null&&a.includes(",")){const[i,l]=a.split(",");return`linear-gradient(to right, ${i} 0%, ${l} 100%)`}return a},hj=e=>(e==="green_blue"&&(e="green"),e),Rn=e=>ao(H7,$7,e),Us=e=>ao(G7,z7,e),YE=e=>ao(W7,K7,e),XE=e=>ao(Y7,X7,e),pj=e=>ao(Q7,J7,e),gU=e=>ao(Z7,eU,e),QE=e=>ao(tU,nU,e),gj=e=>(e=hj(e),ao(sU,rU,e)),iT=e=>(e=hj(e),ao(aU,oU,e)),_U=e=>ao(iU,lU,e),ql=e=>ao(cU,uU,e),Tf=e=>ao(dU,fU,e),ld=e=>ao(mU,hU,e);function xU(e){let t;const n={};for(const s in e){t=e[s];for(let a=0,o,i=t.length;a<i;a++)o=t.charCodeAt(a),Object.prototype.hasOwnProperty.call(n,o)?n[o]+=`,${s}`:n[o]=s}return n}const _j=xU(IO),np=new BE(_j),xj=np.convert.bind(np);np.compare.bind(np);const{STYLE_NORMAL:Fj}=BE,{STYLE_FIRST_LETTER:FU}=BE;function yU(e){return(t,n)=>e(t,n)===0}function Iu(e,t){return e-t}function I1(e,t){return e.localeCompare(t)}function $o(e,t=!0){return t?(n,s)=>-e(n,s):e}function bU(e){return(t,n)=>t==null&&n==null?0:t==null?-1:n==null?1:e(t,n)}function Fa(e){return(t,n)=>t==null&&n==null?0:t==null?1:n==null?-1:e(t,n)}function EU(...e){return(t,n)=>{for(const s of e){const a=s(t,n);if(a!==0)return a}return 0}}function yj(e=Id){return(t,n)=>{if(t.length<n.length)return-1;if(t.length>n.length)return 1;for(let s=0;s<t.length;s++){const a=e(t[s],n[s]);if(a!==0)return a}return 0}}function __(e=Id){return(t,n)=>{const s=Math.max(t.length,n.length);for(let a=0;a<s;a++){const o=e(t[a],n[a]);if(o!==0)return o}return 0}}function wU(e=Id){return(t,n)=>{const s=t[Symbol.iterator](),a=n[Symbol.iterator]();for(;;){const o=s.next(),i=a.next();if(o.done&&i.done)return 0;if(o.done)return-1;if(i.done)return 1;const l=e(o.value,i.value);if(l!==0)return l}}}function Id(e,t){return Array.isArray(e)&&Array.isArray(t)?yj(Id)(e,t):e===t?0:e<t?-1:1}function hr(e,t=Id){return(n,s)=>t(e(n),e(s))}function*lT(e){const t=e.length;for(let n=0;n<t;n++){const s=e.charAt(n);if(/^[0-9]$/.test(s))yield[0,s];else if(/^[a-zA-Z]$/.test(s))yield[1,[s.toLowerCase(),s]];else if(_j[s.charCodeAt(0)]){const[a]=np.single_pinyin(s,{style:Fj});yield[2,[a.charAt(0),a,s]]}else yield[3,s.charCodeAt(0)]}}const ol=(e,t)=>wU(Id)(lT(e),lT(t)),bj="因涉嫌违反平台分享政策，无法查看",Zb="https://cdn.allflow.cn/fe-web-app-images/default-avatar.svg",e2=new Map,kU=e=>{const{src:t,onError:n,onTryProxy:s}=e,[a,o]=F.useState(t),i=F.useRef(!1),l=F.useRef(!1),c=F.useRef(t),[u,d]=F.useState(!1),f=()=>{s==null||s(),d(!0);const p=P7(c.current);let g=c.current;p&&(p.searchParams.delete("img_process"),g=p.href),fj(g,{tryHeic:l.current,callback:async _=>{o(URL.createObjectURL(_.blob)),e2.set(c.current,URL.createObjectURL(_.blob)),d(!1)},onError:()=>{o(Zb),d(!1)}})};return F.useEffect(()=>{if(t!==a){const p=e2.get(t);o(p!=null?p:t),c.current=t,i.current=!!p,l.current=!1}},[t]),{imgUrl:a,setImgUrl:o,onError:p=>{if(!u){if(!c.current.startsWith("blob")){if(!i.current){i.current=!0,gc(c.current)&&(l.current=!0),f();return}if(i.current&&!l.current){l.current=!0,f();return}}n==null||n(p),o(Zb)}},isProxyUrl:i,tryHeic:l,proxyLoading:u}},CU=()=>{const e=(n,s)=>Math.floor(Math.random()*(s-n+1))+n;let t="";for(let n=0;n<4;n++){const s=e(48,122);if(s>57&&s<65||s>90&&s<97){n--;continue}const a=String.fromCharCode(s);t+=a}return t};function JE(e,t){return e.endsWith("/")&&(e=e.slice(0,-1)),e=e.trim(),tm(e)?e:t?`https://${e}`:`http://${e}`}function tm(e){try{return!!new URL(e)}catch(t){return!1}}var mr=(e=>(e.file="file",e.image="image",e.webpage="webpage",e.airtable="airtable",e.figma="figma",e.sketch="sketch",e.modao="modao",e.mockplus="mockplus",e.excalidraw="excalidraw",e.processon="processon",e.canva="canva",e.bilibili="bilibili",e.vqq="vqq",e.music163="music163",e.codesandbox="codesandbox",e.codepen="codepen",e.youku="youku",e.xigua="xigua",e.lusun="lusun",e))(mr||{});const ZE=e=>{var t,n,s,a,o;try{if(!e)return{url:""};const i=JE(e||"",!0),l=new URL(i||"");let c;if(/figma\.com/.test(l.host)){const u=l.searchParams.get("node-id"),d=l.searchParams.get("embed_host"),f=l.pathname.split("/"),h=f[2];if(f[1]==="file"&&h&&d!=="nextspace")return c="file",{url:`${l.origin}/file/${h}?embed_host=nextspace&kind=${u?`&node-id=${u}`:""}&viewer=1`,website:c}}if(/airtable\.com/.test(l.host)&&!l.pathname.includes("/embed/"))return c="airtable",{url:`${l.origin}/embed${l.pathname}`,website:c};if(/bilibili\.com/.test(l.host)&&!/player\.bilibili\.com/.test(l.host)){const u=l.pathname.split("/");let d=u[2];if(c="bilibili",u[1]==="video"&&d){const f=d.startsWith("BV");return!f&&d.startsWith("av")&&(d=d.replace("av","")),{url:`https://player.bilibili.com/player.html?${f?"bvid":"aid"}=${d}&page=1&high_quality=1&as_wide=1&allowfullscreen=true${l.search.replace("?","&")}`,website:c}}}if(/v\.qq\.com/.test(l.host)){const u=(t=l.pathname.split(".html")[0])==null?void 0:t.split("/"),d=(n=l.searchParams.get("vid"))!=null?n:u==null?void 0:u[u.length-1];if(c="vqq",d)return{url:`https://v.qq.com/txp/iframe/player.html?vid=${d}`,website:c}}if(/music\.163\.com/.test(l.host)){const u=l.href.split("?"),d=new URLSearchParams(u[1]).get("id");if(c="music163",(s=u[0])!=null&&s.includes("song"))return{url:`https://music.163.com/outchain/player?type=2&id=${d}&auto=0&height=66`,website:c};if((a=u[0])!=null&&a.includes("playlist"))return{url:`https://music.163.com/outchain/player?type=0&id=${d}&auto=1`,website:c}}if(/codesandbox\.io/.test(l.host)&&!l.pathname.includes("/embed/")){const u=l.pathname.replace("/s/","/embed/");return c="codesandbox",{url:`${l.origin}${u}?fontsize=14&hidenavigation=1&theme=dark`,website:c}}if(/codepen\.io/.test(l.host)&&!l.pathname.includes("/embed/")){const u=l.pathname.replace("/pen/","/embed/");return c="codepen",{url:`${l.origin}${u}?default-tab=html%2Cresult`,website:c}}if(/modao\.cc/.test(l.host)&&!l.pathname.includes("/embed/"))return c="modao",{url:`${i}/embed/v2`,website:c};if(/app\.mockplus\.cn/.test(l.host)&&!l.pathname.includes("/s/"))return c="mockplus",{url:i.replace("/app/","/s/"),website:c};if(/canva\.cn/.test(l.host)&&!l.search.includes("/embed/")){const u=l.pathname.split("/");if(c="canva",u[1]==="design"&&u[2])return{url:`${l.origin}/design/${u[2]}/view?embed`,website:c}}if(/youku\.com/.test(l.host)&&!l.search.includes("/embed/")){const u=l.pathname.split("/");if(c="youku",(o=u[2])!=null&&o.includes("id"))return{url:`https://player.youku.com/embed/${u[2].replace("id_","").replace(".html","")}`,website:c}}if(/ixigua\.com/.test(l.host)&&!l.pathname.includes("/iframe/")){const u=l.pathname.split("/");if(u.length>0)return c="xigua",{url:`https://www.ixigua.com/iframe/${u[u.length-1]}`,website:c}}if(/lusun\.com/.test(l.host)&&!l.pathname.includes("/embed/")){const u=l.pathname.split("/v/"),d=pn(u);if(c="lusun",d)return{url:`https://lusun.com/embed/?id=${d}&${l.search.replace("?","&")}`,website:c}}return{url:e,website:c}}catch(i){return{url:e!=null?e:""}}},Hr={image:/^(apng|avif|bmp|gif|ico|cur|jpg|jpeg|jfif|pjep|pjp|png|svg|webp|heic|heif|pic|tif)$/i,audio:/^(mp3|wma|wave|flac|aac|cda|midi|ape|aiff|ra|rm|rmx|vqf|amr|aiff|ogg|ac3|m4a|wav)$/i,video:/^(mp4|mov|flv|webm|m4v|rm|rmvb|wmv|avi|mpg|mpeg|flc|mkv|f4v|3gp|asf)$/i,txt:/^(txt|rtf|ts|tsx|js|jsx|html|xml|css|less|scss|cpp|py|c|cs|h|asp|sh|go|java|php|json|yml|md|log|m|ini|lua|sql|rs|rb)$/i,office:/^(doc|docx|xls|xlsx|ppt|pptx)$/i,pdf:/^(pdf)$/i,zip:/^(7z|rar|jar|zip|cab|ace|tar)$/i,ppt:/^(ppt|pptx)$/i,csv:/^(csv)$/i},TU=(e="")=>Object.values(Hr).every(t=>!t.test(e)),ew=(e="")=>{const t=Hr.image.test(e),n=TU(e);return!!(t||n)},ac=(e="")=>{const t=e.lastIndexOf("."),n=e.substring(0,t);let s=e.substring(t+1);const a=s.match(/\w+/);return a!=null&&a[0]&&(s=a[0]),{name:n,extName:s}},zp=e=>{const{extName:t}=ac(e);if(!(!t||!e)){if(Hr.image.test(t.toLocaleLowerCase())||Hr.video.test(t.toLocaleLowerCase()))return e;if(Ej(t)){const[n]=e.split("/");return n?e==null?void 0:e.replace(n,"preview").replace(t.toLocaleLowerCase(),"png"):void 0}}},Ej=e=>!!(Hr.office.test(e)||Hr.txt.test(e)||Hr.pdf.test(e)||Hr.csv.test(e)),tw=["heic","heif","tif","bmp","tiff"],bo=(e,t)=>tw.includes(t.toLocaleLowerCase())?e.includes("img_process")?`${e}/format,png`:`${e}&img_process=/format,png`:e,vU=e=>{const{key:t,items:n,reverse:s,isNumber:a}=e,o=i=>/^[0-9]*$/.test(i);return n.sort((i,l)=>{const c=`${i[t]}`,u=`${l[t]}`;return a||o(c)&&o(u)?Number(c)-Number(u):ol(c,u)}),s?n.reverse():n};const wj=(e,t)=>{let n="";if(!t){try{H3.renderToString(e,{output:"html",displayMode:!0,throwOnError:!0})}catch(s){n=`${s.message}`.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return{errorMsg:n}}try{H3.render(e,t,{output:"html",displayMode:!0,throwOnError:!0,strict:!1})}catch(s){n=s!=null&&s.message?`${s.message}`.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):"公式错误"}return{errorMsg:n}},kj=e=>{const t=F.useRef(null),{className:n,text:s="",onClick:a,onRender:o,inline:i}=e;return F.useLayoutEffect(()=>{const{errorMsg:l}=wj(s,t.current);o==null||o(l)},[o,s]),r.jsxs("span",{className:n,onClick:a,children:[i?r.jsx("span",{ref:t,className:"inline-latex inline-block"}):r.jsx("div",{ref:t}),e.children]})},Cj=(e,t,n="HTML")=>{if(t(e))return!0;let s=e;for(;s.tagName!==n;){if(t(s)||!s.parentNode)return!0;s=s.parentNode}return!1};class Tj{constructor(t="(prefers-color-scheme: dark)"){q(this,"queryList");q(this,"onChange",t=>{var n,s;return typeof((n=this.queryList)==null?void 0:n.addEventListener)=="function"?this.queryList.addEventListener("change",t):typeof((s=this.queryList)==null?void 0:s.addListener)=="function"&&this.queryList.addListener(t),()=>this.offChange(t)});q(this,"offChange",t=>{var n,s;typeof((n=this.queryList)==null?void 0:n.removeEventListener)=="function"?this.queryList.removeEventListener("change",t):typeof((s=this.queryList)==null?void 0:s.removeListener)=="function"&&this.queryList.removeListener(t)});this.queryList=window.matchMedia(t)}get media(){var t,n;return(n=(t=this.queryList)==null?void 0:t.media)!=null?n:""}get matches(){var t;return!!((t=this.queryList)!=null&&t.matches)}}const Fs=(e,t)=>{switch(t){case At.PermissionRole.NONE:return!0;case At.PermissionRole.READER:return[At.PermissionRole.READER,At.PermissionRole.COMMENTER,At.PermissionRole.WRITER,At.PermissionRole.EDITOR].includes(e);case At.PermissionRole.COMMENTER:return[At.PermissionRole.COMMENTER,At.PermissionRole.WRITER,At.PermissionRole.EDITOR].includes(e);case At.PermissionRole.WRITER:return[At.PermissionRole.WRITER,At.PermissionRole.EDITOR].includes(e);case At.PermissionRole.EDITOR:return e===At.PermissionRole.EDITOR;default:throw new Error("Unhandled role case")}};var nw=(e=>(e.PASSWORD="psw",e))(nw||{});const NU=e=>sessionStorage.getItem(e),IU=(e,t)=>{sessionStorage.setItem(e,`${t}`)},jU=e=>{const{size:t,success:n,className:s,onChange:a,onError:o}=e,[i,l]=F.useState("");return F.useEffect(()=>{i.length===t&&(/^[a-zA-Z0-9]+$/.test(i)?n(i):o==null||o())},[o,t,i,n]),r.jsx("input",{autoFocus:!0,type:"text",maxLength:t,autoCorrect:"off",autoCapitalize:"off",placeholder:"请输入密码 区分大小写",className:B("transition-all w-full text-t2 bg-grey9 border border-grey6 focus:border-black h-9 px-2.5 rounded placeholder-grey4",s),onInput:c=>{const u=c.currentTarget.value.replaceAll("'","");l(u),a==null||a(u)}})},DU=(e,t)=>`/${t}/${e}.svg`,sw=(e,t)=>`https://cdn.flowus.cn/assets/byte-icon/${e?"dark":"light"}${t}`;he.extend(jO);he.extend(DO);const Dy=new Map([[0,"日"],[1,"一"],[2,"二"],[3,"三"],[4,"四"],[5,"五"],[6,"六"]]),j1="YYYY-MM-DD",vj="YYYY年M月D日",SU=e=>{const t=he(e),n=he();if(Sy(t,0))return"今天";if(Sy(t,1))return"明天";if(Sy(t,2))return"后天";if(cT(t,1))return"昨天";if(cT(t,2))return"前天";const s=n.subtract(7+n.day()-1,"day"),a=s.add(6,"day");if(t.isBetween(s,a,"day","[]"))return`上周${Dy.get(t.day())}`;const o=a.add(1,"day"),i=o.add(6,"day");if(t.isBetween(o,i,"day","[]"))return`本周${Dy.get(t.day())}`;const l=i.add(1,"day"),c=l.add(6,"day");return t.isBetween(l,c,"day","[]")?`下周${Dy.get(t.day())}`:t.format(vj)},cT=(e,t)=>{const n=he().subtract(t,"day");return e.format(j1)===n.format(j1)},Sy=(e,t)=>{const n=he().add(t,"day");return e.format(j1)===n.format(j1)},Nj="YYYY/MM/DD HH:mm",Ij="YYYY/MM/DD",jj=e=>{let t;return e.type===At.TextType.DATETIME?t=he(`${e.startDate} ${e.startTime}`,Nj).startOf("minute").toDate():e.type===At.TextType.DATE?t=he(`${e.startDate}`,Ij).startOf("day").toDate():t=he().toDate(),t},uT=(e,t)=>he(e,t,!0).isValid(),rw=(e,t,n,s)=>{t!=null||(t=At.DateFormat.YYYY_MM_DD),s!=null||(s=At.TimeFormat.H_MM);let a;switch(t){case At.DateFormat.LL:a=he(e).format(vj);break;case At.DateFormat.RELATIVE:a=SU(e);break;default:a=he(e).format(t.toLocaleUpperCase())}return n?`${a} ${he(e).format(s)}`:a},Wp=(e,t,n,s)=>{t!=null||(t=e.dateFormat),n!=null||(n=e.type===At.TextType.DATETIME);const a=jj(e);return s!=null||(s=e.timeFormat),rw(a.getTime(),t,n,s)},Dj=60*1e3,Sj=60*Dj,dT=24*Sj,Rj=(e,t)=>{var n,s,a,o;if(t)if(t.unit==="day"){const i=he(t.time,"HH:mm").get("hour");return t.time?he(e).set("hour",i).unix()*1e3-((n=t.value)!=null?n:0)*dT:he(e).unix()*1e3-((s=t.value)!=null?s:0)*dT}else{if(t.unit==="hour")return he(e).unix()*1e3-((a=t.value)!=null?a:0)*Sj;if(t.unit==="minute")return he(e).unix()*1e3-((o=t.value)!=null?o:0)*Dj}},Aj=e=>{if(!e)return;const t=RU(e);if(t)return Rj(t.timestamp,e.reminder)},RU=e=>{if(!e)return;const t=he(jj(e));if(!isNaN(t.toDate().getTime())){if(e.type===At.TextType.DATE)return{dateString:t.format(Ij),timestamp:t.valueOf(),textType:At.TextType.DATE};if(e.type===At.TextType.DATETIME)return{dateString:t.format(Nj),timestamp:t.valueOf(),textType:At.TextType.DATETIME}}},jd=(e="")=>e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),ex=e=>{let t=!1;switch(e=e!=null?e:At.OrderFolderType.TIME_REVERSED,e){case At.OrderFolderType.SIZE_REVERSED:case At.OrderFolderType.NAME_REVERSED:case At.OrderFolderType.TIME_REVERSED:{t=!0;break}}return{reverse:t,sortType:e}};function*Bj(e){const{maxWidth:t,minimalWidthHint:n=100,mode:s="half"}=e,a=Math.max(100,n);let o=t;do yield Math.floor(o),s==="half"?o=o/2:s==="gradual"&&(o=o-70);while(o>=a)}function AU(e,t){return{srcSet:SO(e,t).reverse().map(([n,s])=>`${s||"about:blank"} ${n}w`).join(", ")}}const BU=(e,t,n)=>{const s=[...Bj({maxWidth:t!=null?t:1920})];return{...AU(s,s.map(a=>`${e!=null&&e.includes("img_process")?e:`${e}&img_process=`}/resize,w_${a}/quality,q_90/`)),sizes:n&&`${n==null?void 0:n.toFixed(0)}px`}},x_={},Lj=(e,t)=>(x_[e]||(x_[e]=new Promise((n,s)=>{let a;t==="script"?(a=document.createElement(t),a.src=e):(a=document.createElement(t),a.href=e,a.rel="stylesheet",a.type="text/css"),a.onload=()=>n(),a.onerror=o=>s(o),document.head.appendChild(a)})),x_[e]),LU=()=>/micromessenger|qqtheme|weibo/i.test(navigator.userAgent);class PU{constructor(){q(this,"queue",[]);q(this,"isRunning",!1);q(this,"run",async()=>{if(!this.isRunning){for(this.isRunning=!0;this.queue.length;){const t=this.queue.shift();if(!t)return;const{text:n,id:s,onError:a,onSuccess:o}=t;try{const{mermaid:i}=window,l=await(i==null?void 0:i.mermaidAPI.render(s,n));o(l.svg)}catch(i){a(i)}}this.isRunning=!1}});q(this,"render",t=>{this.queue.push(t),this.run()})}}const OU=new PU,MU=F.memo(e=>{const{text:t="",className:n,onRender:s,onClick:a}=e,o=F.useRef(null),[i,l]=F.useState(!1),c=F.useRef(qe()),u=mj(),[d,f]=F.useState(window.mermaid);return F.useEffect(()=>{let h=null;return!d&&!O7&&(h=setInterval(()=>{f(window.mermaid)},1e3)),()=>{h&&clearInterval(h)}},[d]),F.useEffect(()=>{d==null||d.mermaidAPI.initialize({theme:u?"dark":"neutral"})},[u,d]),F.useEffect(()=>{const{mermaid:h}=window,p=o.current;if(p&&h){if(!t){l(!0),p.innerHTML="",s==null||s(!1);return}OU.render({text:t,id:`mermaid-${c.current}`,onSuccess:g=>{l(!1),p.innerHTML=g,s==null||s(!0)},onError:g=>{l(!0),p.innerHTML=g,s==null||s(!1)}})}},[t,d]),t?r.jsx("div",{onClick:a,className:B("flex justify-center",i&&"text-red text-t3",n),ref:o},c.current):null}),UU={[wi.splitView]:"默认",[wi.code]:"仅代码",[wi.preview]:"仅预览"},VU=["mermaid"],qU=Object.entries(wi).map(([e,t])=>({title:UU[t],value:t})),Pj=(e="",t=wi.splitView)=>{let n=!0,s=!0,a=!0;return t===wi.code&&(s=!1),t===wi.preview&&(a=!1),VU.includes(e.toLocaleLowerCase())||(n=!1,s=!1),{button:n,preview:s,code:a}},{VITE_PREFIX:Mt="https://flowus.cn",VITE_CDN_HOST:aw}={VITE_ENV:"production",VITE_VOLCENGINE_TRACK_ID:"303823",VITE_TEMPLATE_ID:"6a4efea1-e023-4e99-bb69-d69af5909412",VITE_PREFIX:"https://flowus.cn",VITE_WECHAT_APP_ID:"wx7de87594073bf09f",VITE_GIT_COMMIT:"303a12d8e6f8a744e8260c6edd6c4eecf1c9f733",VITE_IMPORTANT_FEATURE_COLLECTION_ID:"6fcef75c-2637-42e8-86d7-2d59bdef4807",VITE_CDN_HOST:"https://cdn.allflow.cn/",VITE_SERVICE_CENTER_COLLECTION_ID:"14620f35-b0be-4d28-8a10-f3ae4809af43|e077dd8f-a2d7-46e6-a97e-3167cf8665e0",BASE_URL:"https://cdn.allflow.cn/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,LEGACY:!1},bt=`${aw}fe-web-app-images`,HU={spacePersonal:`${bt}/dark-image/space-personal.svg`,createSpaceTeam:`${bt}/dark-image/create-space-team.svg`,createSpacePersonal:`${bt}/dark-image/create-space-personal.svg`,clearTemplate:`${bt}/dark-image/clear-template.svg`,spaceTeam:`${bt}/dark-image/space-team.svg`,teamQrHeader:`${bt}/dark-image/team-qr-header.svg`,service:`${bt}/dark-image/service.svg`,templatesEmpty:`${bt}/dark-image/templates-empty.png`,compactLayout:`${bt}/layout/dark-compact-layout.png`,defaultLayout:`${bt}/layout/dark-default-layout.png`,looseLayout:`${bt}/layout/dark-loose-layout.png`},fT={icon:`${bt}/icon.svg`,defaultAvatar:`${bt}/default-avatar.svg`,loadingGif:`${bt}/loading-gif.svg`,logo:`${bt}/logo.svg`,favicon:`${bt}/favicon.png`,logoWhite:`${bt}/logo_white.svg`,logoBlackWide:`${bt}/logo_black_wide.svg`,logoWhiteWide:`${bt}/logo_white_wide.svg`,resizeLeft:`${bt}/resize-left.svg`,service:`${bt}/service.svg`,gift:`${bt}/gift.svg`,giftOpen:`${bt}/gift-open.svg`,giftModal:`${bt}/gift-modal.svg`,loginAvatar:`${bt}/login-avatar.svg`,qr:`${bt}/qr.png`,spaceTeam:`${bt}/space-team.svg`,spacePersonal:`${bt}/space-personal.svg`,submit:`${bt}/submit.png`,clearTemplate:`${bt}/clear-template.png`,pointBg:`${bt}/point-bg.svg`,createSpaceTeam:`${bt}/create-space-team.svg`,createSpacePersonal:`${bt}/create-space-personal.svg`,createSpacePersonalBottom:`${bt}/create-space-personal-bottom.svg`,shareFormQr:`${bt}/share-form-qr.png`,orderRemarks:`${bt}/order-remarks.svg`,teamWechatQr:`${bt}/team-wechat-qr.jpg`,templateTitle:`${bt}/template-title.svg`,star:`${bt}/star.svg`,importGuestLeft:`${bt}/import-guest-left.png`,importGuestRight:`${bt}/import-guest-right.png`,compactLayout:`${bt}/layout/compact-layout.png`,defaultLayout:`${bt}/layout/default-layout.png`,looseLayout:`${bt}/layout/loose-layout.png`,wechatClipperFailed:`${bt}/wechat-clipper-failed.png`,bindWechatClip:`${bt}/bind-wechat-clip.png`,templatesEmpty:`${bt}/activity/web-big-image/templates-empty.jpg`,templateEmpty:`${bt}/activity/template_empty.svg`,transparent:`${bt}/transparent.png`,medal:`${bt}/medal.png`,medalBg:`${bt}/medal-bg.png`,littleMedal:`${bt}/little-medal.png`,imgAi:new URL("https://cdn.allflow.cn/assets/img_ai-8fa9d091.png",self.location).href},Dn={reload:e=>{e?Object.assign(Dn,HU):Object.assign(Dn,fT)},...fT},$U={activityList:[],basicList:[],advancedList:[],otherList:{}},Hc=No(()=>$U),Uh=()=>Hc.getState(),Oj=()=>Hc(e=>e.otherList),GU=e=>{const{activityList:t,basicList:n=[],advancedList:s=[],otherList:a=[]}=e;Hc.setState(o=>({...o,activityList:t,basicList:n,advancedList:s,otherList:LE(a,"uuid")}))},zU=e=>{const{uuid:t,patch:n}=e;sd(Hc.getState().otherList[t],n)},WU=e=>Hc(t=>t.otherList[e]),Mj=()=>Hc(e=>e.activityList),KU=new Date("2023-04-10").getTime(),Uj=()=>{const e=Mj();return F.useMemo(()=>{const t=new Date().getTime();return e.some(n=>{const s=n.status==="abandoned";return!n.viewed&&!s?!(n.startTime&&n.startTime<KU||n.endTime&&n.endTime<t):!1})},[e])};class YU{constructor(){q(this,"status","online");q(this,"statusChange$",new Up)}get online(){return this.status==="online"}get offline(){return this.status==="offline"}setStatus(t){this.status!==t&&(this.status=t,this.statusChange$.next())}get onStatusChange(){return this.statusChange$.asObservable()}}const $r=new YU,XU=e=>new Proxy(e.getState(),{get(n,s){return Reflect.get(e.getState(),s)}}),QU=e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([n,s])=>{Array.isArray(s)?s.forEach(a=>{t.append(n,`${a}`)}):t.append(n,`${s!=null?s:""}`)}),t.toString()},JU=e=>{const t=new URLSearchParams(e),n={};for(const[s,a]of t.entries())n[s]!=null?(Array.isArray(n[s])||(n[s]=[n[s]]),n[s].push(a)):n[s]=a;return n},tx={stringify:QU,parse:JU},xl=F.createContext(null),On=()=>!!F.useContext(xl),Vj=()=>!F.useContext(xl),$c=()=>{const e=F.useContext(xl),t=Un();return e!=null?e:t},Gc=e=>tx.parse(e)["right-page-id"],ow=()=>(Vc(),Gc(location.search)),Kp=()=>{const e=$c();return F.useCallback(()=>{const{location:t}=e;e.push({pathname:t.pathname,hash:t.hash})},[e])},ZU=()=>{const e=$c();return F.useCallback(()=>{const t=e.location,n=Gc(t.search);e.push({pathname:`/${n}`})},[e])},qj=e=>(typeof e.location=="object"&&(e=e.location),e),mT={lastPageId:""},D1="tocCollapsed",cd="userId",hT="lastViewPage",pT="expandFoldList",t2="token",n2="currentSpaceViewId",Yp="color_picker_last_used_color_info",eV="create_form",Hj="old_version",$j="theme_mode",p0e="last_get_notification_time",Gj="folder_view_type_list",tV="TABLE_CELL_MENU",ni="未命名用户",nV="未命名成员组",aa="未命名页面",zj="未命名收集表",jh="未命名多维表",iw="未命名文件夹",sV="未命名文件",gT="未命名思维导图",lw="未命名代码块",rs="因涉嫌违反平台分享政策，无法查看",Wj="公开分享",rV="链接分享",aV="无访问权限",oV="new_space",iV=600,cw="ui-sans-serif, -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica,'Apple Color Emoji', Arial, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol'",lV="00000000-0000-0000-0000-000000000000",Kj=(()=>"https://desktopdownload.flowus.cn/production")(),cV=`${Kj}/windows/x64/latest.yml`,uV=`${Kj}/assets.json`,_T={[m.BlockType.PAGE]:aa,[m.BlockType.FOLDER]:iw,[m.BlockType.FILE]:sV,[m.BlockType.COLLECTION_VIEW]:jh,[m.BlockType.COLLECTION_VIEW_PAGE]:jh,[m.BlockType.REFERENCE_COLLECTION]:jh,[m.BlockType.REFERENCE_COLLECTION_PAGE]:jh,[m.BlockType.CODE]:lw,[m.BlockType.MIND_MAPPING_PAGE]:gT,[m.BlockType.MIND_MAPPING]:gT},dV=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST],Yj="www.flowus.cn",us="YYYY/MM/DD HH:mm",Ct="YYYY/MM/DD",xT="MM/DD",s2="HH:mm",Da=708,An={userAgreement:`${Mt}/share/51171168-3fcb-4b14-b359-53a58380da4c`,privacyPolicy:`${Mt}/share/29651bee-1323-4f0a-a9ba-535832469fe0`,product:`${Mt}/product`,appDownload:`${Mt}/download`,helpCenter:`${Mt}/share/e68380be-23cf-42c4-9b95-23a52713213d`,shortcut:`${Mt}/share/c19d16ae-56f0-4e29-bc20-f46302eeebfc`,shortcutCommand:`${Mt}/share/401e6d4a-ded8-4e23-a874-a1c30a5928d7`,paidServices:`${Mt}/share/734ccb8d-760d-4792-8c89-2d644dbe24d9`,integralRule:`${Mt}/share/c7e03855-8742-4453-abea-ab0625209955`,helperShare:`${Mt}/share/478fbe3f-8074-48ac-9357-6f0af02b894b`,problemFeedback:`${Mt}/form/a5ed5933-cf92-4c65-9bb1-d2ea974a5aaa`,updateLog:`${Mt}/share/b30dd458-7fb9-4e29-b5ed-e09274465c34`,applySchool:`${Mt}/form/42f08dfb-dc06-4582-bb8e-8385bdc6a3af`,authentication:`${Mt}/auth/school`,applyInvoice:`${Mt}/form/0fd2831b-2793-443a-95c3-2a753c0ecef0a`,learnMore:`${Mt}/share/19cc8990-ac51-43c9-9144-36cb7c09f9c9`,weChatClipper:`${Mt}/share/74fbd0eb-1255-484d-b9a1-a0bafd6be4c6`,cyclePlan:`${Mt}/share/7803ae51-aa1d-4d28-a8d6-6bbdbf42ab49`,importGuest:`${Mt}/share/8172adf1-bbe4-4d1f-99b9-8bbda920d5d9`,videoTeaching:`${Mt}/share/5b6ba2f7-f332-4d9b-a283-c0443b683646`,quoteSuggestion:`${Mt}/share/34d1188d-04b2-4502-a732-ae3b6ec69fb1`,quotePage:`${Mt}/share/c15b6489-60ba-480e-a84b-ad28f9a3f694`,templateContribution:`${Mt}/share/4ac3f00d-02db-4b24-aaed-48a19ceff78f`,campusMaster:`${Mt}/share/fe31151c-da91-4cab-9ec5-610df0ca480a`,importFromNotion:`${Mt}/share/7d5a2460-c632-401b-9880-a672565047e0#9ed2ef68-7345-4fb8-af9a-d1bc49f5df77`,howToImport:`${Mt}/share/7d5a2460-c632-401b-9880-a672565047e0`,templateFeedback:`${Mt}/share/185ba39c-721a-4088-8dda-7c6815e72cdb`,ai:`${Mt}/ai`},zc={PAGE_HISTORY:"PAGE_HISTORY",PAGE_FEEDS:"PAGE_FEEDS",NOTIFICATION:"NOTIFICATION",FORM_PREVIEW:"FORM_PREVIEW",PAGE_TEMPLATE:"PAGE_TEMPLATE",RIGHT_PAGE:"RIGHT_PAGE",MAIN_PAGE:"MAIN_PAGE",FORM_END_PAGE:"FORM_END_PAGE",PAGE_LITE:"PAGE_LITE"},fV=2,Xj="1.53.0-2023/5/19 15:41:37".split("-")[0]||"",Qj=()=>{const e=localStorage.getItem(Gj);return e?JSON.parse(e):{}};var bi=(e=>(e.system="system",e.light="light",e.dark="dark",e))(bi||{}),ys=(e=>(e[e.TABLE=0]="TABLE",e[e.THUMBNAIL=1]="THUMBNAIL",e[e.PREVIEW=2]="PREVIEW",e))(ys||{});const Jj=()=>{const e=localStorage.getItem($j);return e?bi[e]:bi.system};let Dh=0;const mV=10,hV=["userId","lastViewPage","currentSpaceViewId"],Nn=(e,t,n=localStorage)=>{Dh=0,Zj(e,t,n)},Zj=(e,t,n=localStorage)=>{try{n.setItem(e,t)}catch(s){if(!(s instanceof Error)||!s.message.toLowerCase().includes("quota"))return;if(Dh>mV){const a={};hV.forEach(o=>{const i=n.getItem(o);i&&(a[o]=i)}),n.clear(),Object.entries(a).forEach(([o,i])=>{n.setItem(o,i)}),location.reload();return}Dh++,Dh===0?FT("expired"):Dh>=1&&FT("safe-all"),pV(),Zj(e,t,n)}},pV=(e=10,t=localStorage)=>{let n=0;for(let s=0;s<t.length;s++){if(n>=e)return;const a=t.key(s);a&&(a.startsWith("viewId:")||a.startsWith("inline-bitable:")||a.startsWith("LRU::")||a==="springFestivalActivity"||a==="activityModal"||a==="reworkActivity")&&(t.removeItem(a),n++)}},FT=(e="safe-all")=>{const t=new Set;for(let n=0;n<localStorage.length;n++){const s=localStorage.key(n);if(s!=null&&s.startsWith("Managed:")){const a=localStorage.getItem(s);if(e==="all"||a==null)t.add(s);else try{const o=JSON.parse(a),{expiredAt:i,safeToPurge:l}=o;(e==="safe-all"&&l||e==="expired"&&Date.now()>=i)&&t.add(s)}catch(o){t.add(s)}}}for(const n of t)localStorage.removeItem(n)},gV=e=>{const t=`Managed:${e}`,n=localStorage.getItem(t);if(n!=null)try{const s=JSON.parse(n),{data:a,expiredAt:o}=s;if(Date.now()>=o){localStorage.removeItem(t);return}return a}catch(s){return}},yT=e=>{const t=`Managed:${e}`;localStorage.removeItem(t)},_V=(e,t,n)=>{var c,u;const s=(c=n==null?void 0:n.expiredAt)!=null?c:null,a=(u=n==null?void 0:n.safeToPurge)!=null?u:!0,o=`Managed:${e}`,l=JSON.stringify({data:t,expiredAt:s,safeToPurge:a});try{return a?localStorage.setItem(o,l):Nn(o,l),!0}catch(d){return!1}},vf=e=>{var t;try{return JSON.parse((t=localStorage.getItem(e))!=null?t:"{}")}catch(n){return{}}},eD=(e,t)=>(e.current===null&&(e.current=t()),e.current),bT={},dr=e=>{const t=F.useRef(bT);return t.current===bT&&(t.current=e()),t.current};function xV(){const[,e]=F.useState({}),t=F.useRef(!1);return t.current=!1,F.useCallback(n=>{t.current||(t.current=!0,Promise.resolve().then(()=>{e(()=>(n==null||n(),{}))}))},[])}function tD(e){const t=F.useRef();return t.current=e,t}function FV(e){const t=F.useRef(e);return t.current=e,F.useCallback((...n)=>t.current(...n),[])}function nD(e,t){const[n,s]=F.useState(["pending"]);return F.useEffect(()=>{let a=!1;const o=new AbortController;return s(["pending"]),e(o.signal).then(i=>{s(["fulfilled",i])}).catch(i=>{s(["rejected",i])}).finally(()=>{a=!0}),()=>{a||o.abort()}},t),n}const nx=zt.createContext(void 0),yV=50;function bV(e){return{itemsKeys:e.itemsKeys,items:new Map(e.items)}}class jo{constructor(t,n,s){q(this,"storage");q(this,"saveKey");q(this,"capacity");q(this,"lruInfo");q(this,"listeners");q(this,"isBatch",!1);q(this,"batch",t=>{this.isBatch=!0,t(),this.isBatch=!1;try{this.persistence()}catch(n){console.error(n)}});q(this,"addChangeListener",t=>{this.listeners.push(t)});q(this,"removeChangeListener",t=>{const n=this.listeners.indexOf(t);n!==-1&&ET(this.listeners,n)});q(this,"notifyChangeListener",()=>{this.listeners.forEach(t=>{t()})});this.storage=t,this.saveKey=n,this.capacity=s!=null?s:yV,this.lruInfo={itemsKeys:[],items:new Map},this.listeners=[];try{const a=this.storage.getItem(`LRU::${this.saveKey}`);if(a){const o=JSON.parse(a),i=bV(o);i.items.size===i.itemsKeys.length&&(this.lruInfo=i),this.tryClearData()}}catch(a){}this.clearOldData()}clearOldData(){this.storage.removeItem(`${this.saveKey}_count`),this.storage.removeItem(`${this.saveKey}_keys`),this.storage.removeItem(`${this.saveKey}_map`)}put(t,n,s){this.lruInfo.items.set(t,{value:n,expireTime:s});const a=this.lruInfo.itemsKeys.indexOf(t);if(a>=0?wT(this.lruInfo.itemsKeys,a,0):this.lruInfo.itemsKeys.splice(0,0,t),this.tryClearData(),!this.isBatch){try{this.persistence()}catch(o){console.error(o)}this.notifyChangeListener()}}tryClearData(){for(;this.lruInfo.itemsKeys.length>this.capacity;){const t=[],n=Date.now();if(this.lruInfo.items.forEach((s,a)=>{s.expireTime&&s.expireTime<n&&t.push(a)}),t.forEach(s=>{this.delete(s)}),t.length===0){const s=this.lruInfo.itemsKeys.pop();s!==void 0&&this.lruInfo.items.delete(s)}}}clear(){this.lruInfo.itemsKeys=[],this.lruInfo.items.clear(),this.storage.removeItem(`LRU::${this.saveKey}`),this.notifyChangeListener()}get(t){const n=this.lruInfo.itemsKeys.indexOf(t);if(n===-1)return null;const s=this.lruInfo.items.get(t);if(s&&s.expireTime&&s.expireTime<Date.now()){this.delete(t),this.notifyChangeListener();return}return wT(this.lruInfo.itemsKeys,n,0),this.notifyChangeListener(),s==null?void 0:s.value}delete(t){const n=this.lruInfo.itemsKeys.indexOf(t);if(n===-1)return!1;ET(this.lruInfo.itemsKeys,n);const s=this.lruInfo.items.delete(t);return this.persistence(),this.notifyChangeListener(),s}log(){console.log(this.lruInfo)}persistence(){const n={items:Array.from(this.lruInfo.items.entries()),itemsKeys:this.lruInfo.itemsKeys};Nn(`LRU::${this.saveKey}`,JSON.stringify(n),this.storage)}length(){return this.lruInfo.items.size}getSortItems(){const t=[],n=this.lruInfo.items;return this.lruInfo.itemsKeys.forEach(s=>{var o;const a=(o=n.get(s))==null?void 0:o.value;a!==void 0&&t.push({key:s,value:a})}),t}}const ET=(e,t)=>{e.splice(t,1)},wT=(e,t,n)=>{if(t===n)return;const s=e.splice(t,1);e.splice(n,0,s[0])},S1=new jo(localStorage,"expand-block-list",200),uw=60*1e3,il=15*uw,sx=4*il,Hn=24*sx,Ry=new Map,ns=e=>{if(Ry.has(e))return Ry.get(e);const t=new Date(new Date(e).toDateString()).getTime();return Ry.set(e,t),t},EV={$isDarkMode:document.body.className.includes("dark"),$firstLoadPage:!0,$isMobileSize:!1,$isEditingPage:!1,$today:ns(Date.now()),$pageRootLoaded:!1,$createBlockMenuListId:"",$blockMenuListId:"",$theme:Jj(),$isCollapsed:localStorage.getItem(D1)==="true",$columnResizing:!1,$menuListKeywords:"",$isFocusInRightPanel:!1,$textareaPlaceHolder:void 0,$slashSelection:{},$ignoreSlash:!1,$focusedInSyncBlockId:"",$serviceCenterRedBadge:!1,$pressedSpace:!1,$editingBlockId:void 0,$focusBlockId:void 0,$fatalError:void 0,$publicHomePage:void 0,$isSelecting:!1,$expandPageRecord:{},$expandFoldRecord:S1.getSortItems().reduce((e,t)=>(e[t.key]=t.value,e),{}),$fileIllegal:!1,$dirty:!1,$syncUpFault:{backup:!1,noPermission:!1},$membersStates:{},$collectionSearch:{},$folderListViewTypeList:Qj(),$sharedPages:[],$subscriptionData:{},$notificationsMagic:{},$guestsList:[],$toolbarInfo:void 0,$tableShowHiddenGroup:{},$tableGroupFoldStatus:{},$newTableProperty:void 0,$allowEmojiPanel:!0,$bodyWidth:document.body.offsetWidth,$bodyHeight:document.body.offsetHeight,$isOpenImagePreview:!1,$isInAIWhiteList:!1,$lowConfig:localStorage.getItem("LOW_CONFIG")==="true",$readyUpdate:!1,$isCtrlKeyDown:!1,$showTransferList:!1,$aiCommands:[],$aiMembers:[]},Ht=No(()=>EV),wt=XU(Ht),Ye=e=>{Ht.setState(t=>({...t,...e}))},sD=()=>{const e=On();return F.useCallback(t=>{let n=wt.$isFocusInRightPanel;e&&t&&!n&&(n=!0),Ye({$isEditingPage:t,$isFocusInRightPanel:n})},[e])},wV=()=>Ht(e=>e.$firstLoadPage),g0e=()=>Ht(e=>e.$isFocusInRightPanel),dw=()=>Ht(e=>e.$isInAIWhiteList),fw=()=>Ht(e=>e.$bodyWidth),rD=()=>Ht(e=>e.$bodyHeight),aD=()=>Ht(e=>e.$theme),kV=()=>Ht(e=>e.$fatalError),CV=()=>{const e=Uj();return Ht(n=>n.$serviceCenterRedBadge)||e},km=()=>Ht(e=>e.$pressedSpace),rx=()=>Ht(e=>e.$isEditingPage),oD=()=>Ht(e=>e.$today),TV=()=>Ht(e=>e.$pageRootLoaded),Xp=()=>Ht(e=>e.$createBlockMenuListId),iD=()=>rd(()=>$r.onStatusChange.pipe(ad(()=>$r.offline)),$r.offline),Cr=()=>Ht(e=>e.$isMobileSize),ax=()=>Ht(e=>e.$isCollapsed),Dd=()=>Ht(e=>e.$columnResizing),lD=()=>Ht(e=>e.$menuListKeywords),Cm=(e,t)=>{const[n,s]=Ht(a=>{var o,i;return a.$textareaPlaceHolder&&((o=a.$textareaPlaceHolder)==null?void 0:o.blockId)===e?[a.$textareaPlaceHolder.alwaysShow,a.$textareaPlaceHolder.placeHolder]:[!1,(i=t==null?void 0:t.defaultPlaceholder)!=null?i:"请输入文字"]},rn);return{alwaysShowPlaceHolder:n,placeHolder:s}},mw=()=>Ht(e=>e.$slashSelection),cD=()=>Ht(e=>e.$focusedInSyncBlockId),Wc=()=>Ht(e=>e.$isSelecting),_0e=e=>Ht(t=>!!t.$expandPageRecord[e]),ox=(e,t)=>{const n={...wt.$expandPageRecord};e.forEach(s=>{n[s]=t}),Ye({$expandPageRecord:n})},vV=e=>Ht(t=>t.$expandFoldRecord[e]),kT=(e,t)=>{const n={...wt.$expandFoldRecord};e.forEach(s=>{n[s]=t}),Ye({$expandFoldRecord:n})},hw=()=>Ht(e=>e.$fileIllegal),NV=()=>Ht(e=>e.$dirty),uD=()=>Ht(e=>e.$syncUpFault),pw=()=>{const e=Ht(t=>t.$membersStates);return e!=null?e:{}},x0e=e=>{Ye(Object.assign(wt.$membersStates,{[e.userId]:e}))},dD=()=>Ht(e=>e.$aiMembers),Tm=()=>Ht(e=>e.$newCreatedRecord),vm=e=>Ht(t=>t.$collectionSearch[e]),IV=e=>Ht(t=>t.$editingBlockId===e),fD=e=>Ht(t=>{const n=t.$folderListViewTypeList[e];return n!=null?n:ys.TABLE}),jV=()=>Ht(e=>e.$sharedPages),F0e=()=>Ht(e=>e.$notificationsMagic),y0e=()=>{Ye({$notificationsMagic:{}})},Qp=()=>Ht(e=>e.$guestsList),DV=e=>Ht(t=>{var n;return((n=t.$toolbarInfo)==null?void 0:n.syncId)===e&&t.$toolbarInfo.showing}),SV=e=>Ht(t=>{var n;return((n=t.$tableShowHiddenGroup)==null?void 0:n[e])===!0}),Nm=(e,t)=>Ht(n=>{var s,a;return((a=(s=n.$tableGroupFoldStatus)==null?void 0:s[e])==null?void 0:a[t])!==!1}),gw=(e,t)=>Ht(n=>{var s;return((s=n.$newTableProperty)==null?void 0:s.propertyId)===e&&n.$newTableProperty.from===t}),Im=()=>Ht(e=>!!e.$allowCommentInSharePage),RV=(e,t,n)=>Ht(s=>{const{$newTableProperty:a}=s;let o=!0;return a!=null&&a.groupInfo&&(o=a.groupInfo===n),o&&(a==null?void 0:a.propertyId)===e&&a.from===t},rn),Sd=()=>Ht(e=>e.$lowConfig),ix=()=>Ht(e=>e.$isCtrlKeyDown),b0e=()=>Ht(e=>e.$showTransferList),R1={Email:/^([A-Za-z0-9_\-.])+@([A-Za-z0-9_\-.])+\.([A-Za-z]{2,4})$/,Mobile:/^1[3456789]\d{9}$/,Password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/,VerifyCode:/^[0-9]{6}$/};var Rt=(e=>(e.login="/login/",e.create="/create/",e.preview="/preview/",e.share="/share/",e.form="/form/",e.main="/",e.notFoundPage="/404",e))(Rt||{}),ms=(e=>(e.callbackPath="from",e.inviteCode="code",e.inviteTeam="team",e.teamApplyCode="teamApplyCode",e.promotionChannel="promotionChannel",e.password="psw",e.quickRegister="quick-register",e.spaceId="space_id",e.openDialog="open",e))(ms||{});const CT=(e,t)=>Math.max(Math.round(e/t*1e4)/100,0),pt=new Proxy({},{get(e,t){return new URLSearchParams(location.search).get(t)}}),Rd=/^(jpg|jpeg|png|bmp|webp|tiff)$/i;function mD(e){try{return new URL(JE(e)).hostname}catch(t){return e}}function AV(e){if(!e)return"";const t=e.lastIndexOf("."),n=e.substring(t+1);let s="";return Rd.test(n.toLocaleLowerCase())&&(s=`img_process=/resize,w_${Math.floor(500*Math.ceil(window.devicePixelRatio))}/quality,q_100/`),`${aw}${encodeURIComponent(e)}?${s}`}const hD=e=>{if(ma(Rt.share,"startsWith")||ma(Rt.form,"startsWith"))return;const t=e.slice(-36);if(!Q0(t))return;const n=e.split("/");if(n.length>=3&&n.length<=4)return n[1]},ma=(e,t="includes",n=location.pathname)=>(n.endsWith("/")||(n=`${n}/`),t==="startsWith"?n.startsWith(e):t==="endsWith"?n.endsWith(e):n.includes(e)),E0e=(e,t)=>{var a;const{pathname:n}=t;if(n===`/${e}`)return;const s=hD(n);if(s!==e){const o=n.indexOf(s!=null?s:""),i=t.pathname.slice(o+((a=s==null?void 0:s.length)!=null?a:0));return e?`/${e}${i}`:`${i}`}},pD=["test","staging","dev"].includes("production")?4:3,BV=e=>/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(e),ud=()=>{const e=window.location.hostname.split(".");return e.length===pD&&e[0]!=="www"?BV(window.location.hostname)?void 0:e[0]:""},dd=()=>{const{hostname:e,protocol:t,port:n}=window.location,s=e.split(".");return s.length===pD&&s.shift(),`${t}//${s.join(".")}${n?`:${n}`:""}`};var _I;const A1=(_I=(()=>{try{return window!==top&&(top==null?void 0:top.location.href.startsWith(`${location.origin}/template`))}catch(e){return!1}})())!=null?_I:!1,LV=()=>{var e;return(e=top.getPreviewTemplateId)==null?void 0:e.call(top)},ht=()=>wt.$publicHomePage?!0:ma(Rt.share)||ma(Rt.form);function lx(e){var o;const t=wt.$publicHomePage;if(t&&window.location.pathname==="/")return t;const n=hD(e);let s="";ma(Rt.preview)?s=`${Rt.preview}:pageId`:ma(Rt.share)?s=n?`/${n}${Rt.share}:pageId`:`${Rt.share}:pageId`:ma(Rt.form)?s=`${Rt.form}:pageId`:s=n?`/${n}/:pageId`:"/:pageId";const a=RO(e,{path:s,sensitive:!0});if(a){const i=(o=a.params.pageId)==null?void 0:o.substring(0,36);if(i&&Q0(i))return i}return""}const gt=()=>{const e=Vc(),t=qj(e);return lx(t.pathname)},Kc=e=>{var a;const t=wt.$publicHomePage;if(t)return t;const n=window.location.pathname.slice(-36);if(e==="left")return n;const s=(a=Gc(window.location.search))!=null?a:"";return e==="right"||wt.$isFocusInRightPanel?s:n},PV=e=>lx(e),OV=()=>{const e=$c();return F.useCallback(()=>{const t=e.location,n=Gc(t.search),s=PV(t.pathname);e.push({pathname:`/${n}`,search:tx.stringify({"right-page-id":s}),hash:location.hash})},[e])},Jp=e=>{try{return new URL(e)}catch(t){return null}},_w=(e=location.href)=>{var t;return(t=Jp(e))==null?void 0:t.pathname.includes(Rt.share)},MV=e=>{var t;return(t=Jp(e))==null?void 0:t.pathname.includes(Rt.form)},Wa=()=>wt.$isDarkMode,Lr=()=>Ht(e=>e.$isDarkMode),UV=()=>{const[e,t]=F.useState(!1);return F.useEffect(()=>{const n=new Tj("(prefers-color-scheme: dark)");t(n.matches);const s=a=>t(a.matches);return n.onChange(s)},[]),e},df={add:()=>{document.body.classList.add("dark")},remove:()=>{document.body.classList.remove("dark")}},VV=()=>{const e=UV(),t=Lr(),n=aD();F.useEffect(()=>{const s=ht(),a=Jj();if(!a&&s){e&&!Wa()?df.add():df.remove();return}Wa()?(a===bi.light&&df.remove(),a===bi.system&&!e&&df.remove()):(a===bi.dark&&df.add(),a===bi.system&&e&&df.add())},[n,e]),F.useEffect(()=>{Dn.reload(t)},[t]),F.useEffect(()=>{const s=()=>{const o=document.body.classList.contains("dark");Ye({$isDarkMode:o})},a=new MutationObserver(o=>{o.forEach(i=>{i.attributeName==="class"&&s()})});return s(),a.observe(document.body,{attributes:!0}),()=>a.disconnect()},[]),F.useEffect(()=>{},[])},bn=e=>({"data-test-id":e}),w0e=e=>"";var Bn=(e=>(e.menuDown="menu-down",e.menuMore="menu-more",e.DocTitle="doc-title",e.asideHeader="aside-header",e.asideTocHeaderCreateByPrivate="aside-toc-header-create-by-private",e.asideTocHeaderCreateBySpace="aside-toc-header-create-by-space",e.asideDriveHeaderCreate="aside-drive-header-create",e.asideItemCreate="aside-item-create-by-private",e.asideItemCreateByPrivate="aside-item-create-by-private",e.asideItemCreateBySpace="aside-item-create-by-space",e.asideItemToc="aside-item-toc",e.asideItemFolder="aside-item-folder",e.asideItemMore="aside-item-more",e.asideSpaceItem="aside-space-item",e.asideSpaceCreate="aside-space-create",e.asideSpaceSetting="aside-space-setting",e.trashItemRestore="trash-item-restore",e.trashItemDelete="trash-item-delete",e.trashItem="trash-item",e.trashButton="trash-button",e.deleteBarRestore="delete-bar-restore",e.deleteBarDelete="delete-bar-delete",e.pageHeaderMore="page-header-more",e.moveToInput="move-to-input",e.moveToItem="move-to-item",e.emptyCreateDoc="empty-create-doc",e.settingAccountInput="setting-account-input",e.settingSpaceInput="setting-space-input",e.settingSpaceDelete="setting-space-delete",e.settingSave="setting-save",e.settingCancel="setting-cancel",e.createSpaceCancel="create-space-cancel",e.createSpaceInput="create-space-input",e.createSpaceSave="create-space-save",e.warningModalConfirm="warning-modal-confirm",e.warningModalCancel="warning-modal-cancel",e.driveHeaderUpload="drive-header-upload",e.driveHeaderFolder="drive-header-folder",e.driveTitle="drive-title",e.driveFileItem="drive-file-item",e.driveFileItemInput="drive-file-item-input",e.driveFileShare="drive-file-share",e.driveFileMore="drive-file-more",e))(Bn||{});const gD={normal:"w-[1em] h-[1em]",tiny:"w-2 h-2",xxxsmall:"w-[9px] h-[9px]",xxsmall:"w-3 h-3",xsmall:"w-3.5 h-3.5",small:"w-4 h-4",middle:"w-5 h-5",large:"w-6 h-6",xlarge:"w-[26px] h-[26px]",xxlarge:"w-7 h-7",xxxlarge:"w-10 h-10",max:"w-[50px] h-[50px]",xmax:"w-20 h-20",preview:"w-[110px] h-[110px]",auto:"w-full h-full"},TT=Object.keys(BO),H=e=>{const t=Lr(),{size:n="normal",className:s="",style:a={},onClick:o,dataTestId:i}=e;let{name:l}=e;return l?l.startsWith("DmIc")?(console.error("不能直接使用DmIc的Icon，请使用MIc。dark环境下会自动转为DmIc"),null):(l.startsWith("MIc")&&t&&(l=l.replace("MIc","DmIc"),TT.includes(l)||(console.error("缺少深色模式icon",l),l=l.replace("DmIc","MIc"))),TT.includes(l)?r.jsx(AO,{...bn(i),"data-icon":l,className:B("flex-shrink-0 fill-current inline",gD[n],s,{"cursor-pointer":!!o}),onClick:o,style:{verticalAlign:"-0.15em",...a},"aria-hidden":"true",name:l}):(console.error("缺少icon",l),null)):null},xt=e=>{var M;const{type:t="text",visible:n=!0,showBorder:s=!0,value:a,onChange:o,placeholder:i,addonAfter:l,addonBefore:c,maxLength:u,autoFocus:d,warning:f,inputRef:h,onEnter:p,defaultValue:g,onBlur:_,onFocus:x,selection:y,inputClassName:b="",style:E,readonly:w=!1,onClick:k,onKeyDown:C,disableFloat:T=!1,focusHiddenPlaceholder:v=!1,warningClassName:I,delayFocus:j=0}=e,[D,S]=F.useState(!1),R=F.useRef(!1),A=F.useRef(null),L=F.useRef(!1),P=U=>{if(!o)return;const{value:V}=U.target;t==="number"&&T&&!/^\d+$/.test(V)||o(V)};return F.useEffect(()=>{var U;h&&(h.current=A.current),(y==null?void 0:y[0])!==void 0&&y[1]!==void 0&&((U=A.current)==null||U.setSelectionRange(y[0],y[1])),xs(j).then(()=>{var V;d&&((V=A.current)==null||V.focus()),L.current=!0})},[]),r.jsxs("div",{style:E,className:B("text-t2 relative box-border flex items-center rounded border border-grey6 bg-grey9",{hidden:!n,"border-red":f,"focus-within-border":s&&!f,"border-none":!s},e.className),onClick:()=>{var U;k==null||k(),!w&&!c&&!l&&((U=A.current)==null||U.focus())},children:[c&&r.jsx("span",{className:B("mr-1 flex h-full items-center justify-center whitespace-nowrap"),children:c}),r.jsx("input",{ref:A,spellCheck:!1,className:B("w-full flex-grow cursor-text bg-transparent px-3 align-middle text-black placeholder-grey4 outline-none",b),type:(M=e.inputType)!=null?M:"text",...bn(e.dataTestId),onKeyDown:U=>{if(C)C(U);else{if(U.stopPropagation(),be("mod+s")(U)&&U.preventDefault(),R.current)return;U.key==="Enter"&&p&&p(U)}},disabled:w,onFocus:()=>{w||(x==null||x(),S(!0))},onBlur:()=>{L.current&&(_==null||_(),S(!1))},onClick:U=>{var V;(V=A.current)==null||V.focus(),U.stopPropagation()},autoFocus:d,maxLength:u||-1,value:a,defaultValue:g,placeholder:v&&D?"":i,onInput:P,onCompositionStart:()=>{var U;(U=e.onCompositionChange)==null||U.call(e,!0),R.current=!0},onCompositionEnd:()=>{var U;(U=e.onCompositionChange)==null||U.call(e,!1),R.current=!1}}),l&&r.jsx("span",{className:B("flex h-full items-center justify-center whitespace-nowrap pl-2"),children:l}),f&&r.jsx("span",{className:B("text-t4 absolute bottom-full left-2 mb-0.5 text-red",I),children:f})]})},r2=e=>F.useMemo(()=>{const t={};return n=>{let s=t[n];if(typeof s=="number")return s;s=0;let a=n;for(;a>0;)a-=1,s+=e(a);return t[n]=s,s}},[e]),_D=F.createContext(void 0),qV=e=>{const t=F.useRef(null);return r.jsx(_D.Provider,{value:{...e,contentRef:t},children:e.children})},cx=()=>{const e=F.useContext(_D);if(!e)throw new Error("useGrid 需要在 GridProvider 内使用");const{scrollXRef:t,scrollYRef:n,colCount:s,rowCount:a,getColWidth:o,getRowHeight:i}=e,l=r2(o),c=r2(i),u=l(s-1)+o(s-1),d=c(a-1)+i(a-1),f=F.useCallback(h=>{const p=t.current;if(typeof h.x=="number"&&p){const _=l(h.x);p.scrollTo({left:_,behavior:"smooth"})}const g=n.current;if(typeof h.y=="number"&&g){const _=l(h.y);g.scrollTo({top:_,behavior:"smooth"})}},[l,t,n]);return{...e,totalWidth:u,totalHeight:d,getLeft:l,getTop:c,scrollTo:f}},Nf=(e,t,n=0)=>{let s=0,a=n;for(;s<e;)s+=t(a),a+=1;return a};function a2(e){return e===window}const F_=5,HV=()=>{const{getLeft:e,getTop:t,getRowHeight:n,getColWidth:s,getRowKey:a,getColKey:o,renderCell:i,renderRow:l}=cx(),[[c,u],[d,f]]=$V(),h=[];for(let p=d;p<f;p++){const g=t(p),_=n(p),x=a(p),y=[];for(let b=c;b<u;b++){const E=o(b),w=e(b),k=s(b);y.push(r.jsx("div",{className:"absolute cell",style:{top:0,left:w,width:k,height:_},children:i(b,p)},`${E}-${x}`))}l?h.push(r.jsx("div",{className:"absolute",style:{top:g,left:0},children:l(p,y)},x)):h.push(r.jsx("div",{className:"absolute",style:{top:g,left:0},children:y},x))}return h},$V=()=>{const{contentRef:e,scrollXRef:t,scrollYRef:n,colCount:s,rowCount:a,getColWidth:o,getRowHeight:i}=cx(),[l,c]=F.useState([[0,0],[0,0]]);return F.useEffect(()=>{const u=e.current,d=t.current,f=n.current;if(!u||!d||!f)return;let h,p,g,_,x,y;const b=()=>{a2(d)?(h=u.offsetLeft,p=window.innerWidth,y=()=>window.scrollX):(h=u.offsetLeft-d.offsetLeft,p=d.getBoundingClientRect().width,y=()=>d.scrollLeft),a2(f)?(_=u.offsetTop,x=window.innerHeight,g=()=>window.scrollY):(_=u.offsetTop-f.offsetTop,x=f.getBoundingClientRect().height,g=()=>f.scrollTop)},E=()=>{const C=y()-h;let T=Nf(C,o),v=Nf(p,o,T);T=Math.max(T-F_,0),v=Math.min(v+F_,s),c(([,I])=>[[T,v],I])},w=()=>{const C=g()-_;let T=Nf(C,i),v=Nf(x,i,T);T=Math.max(T-F_,0),v=Math.min(v+F_,a),c(([I])=>[I,[T,v]])},k=$n(()=>{b(),E(),w()},60,{leading:!0});return k(),d.addEventListener("scroll",E),f.addEventListener("scroll",w),window.addEventListener("resize",k),()=>{d.removeEventListener("scroll",E),f.removeEventListener("scroll",w),window.removeEventListener("resize",k)}},[e,t,n,a,s,o,i]),l},GV=()=>{const{totalWidth:e,totalHeight:t,contentRef:n}=cx(),s=HV();return r.jsx("div",{className:"relative cell-container",ref:n,style:{width:e,height:t},children:s.length>0?s:r.jsx("span",{className:"relative pl-2 text-grey3 text-t3 top-1",children:"表格内容为空"})})};F.forwardRef((e,t)=>r.jsxs(qV,{...e,children:[r.jsx(zV,{ref:t}),r.jsx(GV,{})]}));const zV=F.forwardRef((e,t)=>{const n=cx();return F.useImperativeHandle(t,()=>n,[n]),null}),xD=F.createContext(void 0),WV=e=>r.jsx(xD.Provider,{value:e,children:e.children}),ux=()=>{const e=F.useContext(xD);if(!e)throw new Error("useList 需要在 ListProvider 内使用");const{getItemSize:t,scrollRef:n,count:s,direction:a}=e,o=r2(t),i=s-1,l=o(i)+t(i);return{...e,getItemOffset:o,scrollTo:u=>{var h;const d=(h=n==null?void 0:n.current)!=null?h:window,f=o(u);typeof d.scrollTo=="function"?d.scrollTo({[a==="horizontal"?"left":"top"]:f,behavior:"smooth"}):d instanceof Element&&(d[a==="horizontal"?"scrollLeft":"scrollTop"]=f)},totalSize:l}},KV=F.forwardRef(({children:e},t)=>{const{totalSize:n,direction:s}=ux();return r.jsxs("div",{ref:t,style:s==="horizontal"?{width:n}:{height:n},className:"relative block-list",children:[e,YV()]})}),YV=()=>{const{getItemOffset:e,getItemSize:t,getItemKey:n,renderItem:s,direction:a}=ux(),[o,i]=XV(),l=[];for(let c=o;c<i;c++){const u=e(c),d=t(c);l.push(r.jsx("div",{className:a==="horizontal"?"h-full print:min-h-fit":"min-w-full print:min-w-fit",style:a==="horizontal"?{position:"absolute",top:0,left:u,width:d}:{position:"absolute",top:u,left:0,height:d},children:s(c)},n(c)))}return l},XV=()=>{const{contentRef:e,scrollRef:t,count:n,bufferSize:s=5,getItemSize:a,direction:o}=ux(),[i,l]=F.useState([0,s]);F.useEffect(()=>{var y;const d=e.current,f=(y=t==null?void 0:t.current)!=null?y:window;if(!d)return;let h=0,p,g;const _=$n(()=>{const b=o==="horizontal"?"left":"top";a2(f)?(h=d.getBoundingClientRect()[b],p=o==="horizontal"?window.innerWidth:window.innerHeight,g=()=>window[o==="horizontal"?"scrollX":"scrollY"]):(h=d.getBoundingClientRect()[b]-f.getBoundingClientRect()[b]+f[o==="horizontal"?"scrollLeft":"scrollTop"],p=f.getBoundingClientRect()[o==="horizontal"?"width":"height"],g=()=>f[o==="horizontal"?"scrollLeft":"scrollTop"])},300,{leading:!0,trailing:!1}),x=()=>{_();const b=g()-h;let E=Nf(b,a),w=Nf(p,a,E);E=Math.max(E-1-s,0),w=Math.min(w+s,n),l([E,w])};return f.addEventListener("scroll",x),window.addEventListener("resize",x),x(),()=>{f.removeEventListener("scroll",x),window.removeEventListener("resize",x)}},[t,e,n,a,s,o]);const[c,u]=i;return[c,Math.min(u,n)]},o2=F.forwardRef((e,t)=>{const n=F.useRef(null),{virtualized:s=!0}=e;return pt.print||!s?r.jsx(r.Fragment,{children:Array.from(Array(e.count)).map((a,o)=>e.renderItem(o))}):r.jsxs(WV,{...e,contentRef:n,children:[r.jsx(QV,{ref:t}),r.jsx(KV,{ref:n,children:e.children})]})}),QV=F.forwardRef((e,t)=>{const n=ux();return F.useImperativeHandle(t,()=>n),null}),JV=10;function vT(e){return e.getPerPage?e.getPerPage():JV}function FD(e){const t=F.useRef(!1),n=F.useRef(!0),[s,a]=F.useState([]),[o,i]=F.useState(!1),l=F.useCallback(async(c,u)=>{var h;if(!u&&!e.canSearchWithEmpty){a((h=e.defaultList)!=null?h:[]);return}i(!0);const d=await e.search(c,u.trim(),vT(e)).catch(()=>{t.current=!1,n.current=!1,i(!1)});if(n.current=!1,!d)return;const f=await e.convert(d).catch(()=>{t.current=!1,i(!1)});f&&(i(!1),t.current=f.length>=vT(e),a(p=>{let g=[];return c===1?g=[...f]:g=[...p,...f],g}))},[e]);return F.useEffect(()=>{var c;a((c=e.defaultList)!=null?c:[])},[e]),{firstTime:n.current,resultList:s,loading:o,hasMore:!o&&t.current,search:l}}const yD=e=>e==null?!1:[m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.CODE].includes(e),ZV=e=>e?e.type===m.BlockType.FILE&&e.data.display==="image"?!0:[m.BlockType.TEXTAREA,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.TEMPLATE,m.BlockType.TODO,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.HEADER,m.BlockType.MIND_MAPPING].includes(e.type):!1,bD=[m.BlockType.PAGE,m.BlockType.FOLDER,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE],Xt=e=>e===void 0?!1:bD.includes(e),Wr=e=>e===m.BlockType.COLLECTION_VIEW_PAGE||e===m.BlockType.COLLECTION_VIEW||e===m.BlockType.REFERENCE_COLLECTION||e===m.BlockType.REFERENCE_COLLECTION_PAGE,nm=e=>e?!!(e.type===m.BlockType.FILE&&e.data.ossName||e.type===m.BlockType.EXTERNAL_FILE&&e.data.link||e.type===m.BlockType.REFERENCE&&e.data.display==="image"||(e.type===m.BlockType.EMBED||e.type===m.BlockType.BOOKMARK)&&e.data.link||e.type===m.BlockType.CODE):!1,i2=e=>nm(e)&&(e==null?void 0:e.data.showEmptyCaption),ki=e=>e?e.type===m.BlockType.REFERENCE&&e.data.display==="linkPage"||e.type===m.BlockType.REFERENCE_COLLECTION||e.type===m.BlockType.REFERENCE_COLLECTION_PAGE:!1,B1=e=>e?e.type===m.BlockType.REFERENCE_COLLECTION||e.type===m.BlockType.REFERENCE_COLLECTION_PAGE:!1,xo=e=>e===m.BlockType.MIND_MAPPING||e===m.BlockType.MIND_MAPPING_PAGE,eq=e=>e?e.type===m.BlockType.FILE&&e.data.display==="image"&&(e.data.link||e.data.ossName):!1,Ia=Wt("block/create"),mn=Wt("block/update"),Ii=Wt("block/list-before"),Wn=Wt("block/list-after"),tr=Wt("block/list-remove"),Zp=Wt("block/destroy"),dx=Wt("block/set-permission"),fx=Wt("block/remove-permission"),jm=Wt("collection-view/create"),oc=Wt("collection-view/update"),fd=Wt("collection-view/list-after"),sm=Wt("collection-view/list-before"),rm=Wt("collection-view/list-remove"),Fl=Wt("collection-view/list-after-pagesort"),md=Wt("collection-view/list-before-pagesort"),_c=Wt("collection-view/list-remove-pagesort"),sp=new Map,mx=Wt("history/start"),xw=Wt("history/end"),Ad=Wt("history/undo"),Dm=Wt("history/redo"),bs=Wt("history/effects",e=>{const t=LO("history/effects");return sp.set(t,e),{payload:t}}),ED=Wt("history/clear"),tq=Wt("space/create"),Fw=Wt("space/update"),hx=Wt("space/mark-ame"),rp=Wt("template/list-before"),ap=Wt("template/list-after"),op=Wt("template/list-remove"),nq=Wt("space-view/create"),px=Wt("space-view/update"),sq=Wt("space-view/delete");Wt("space-view/switch");const am=Wt("favorite/list-before"),om=Wt("favorite/list-after"),hd=Wt("favorite/list-remove"),eg=Wt("transaction/flush"),Er=Wt("transaction/fire");Wt("transaction/queueOperation");const wD=Wt("user/space-view/delete"),rq=Wt("user/space-view/create"),gx=Wt("discussion/create"),Bu=Wt("discussion/update"),tg=Wt("discussion/list-after"),ng=Wt("discussion/list-remove"),aq={},yw=Io({name:"blocks",initialState:aq,reducers:{update(e,t){var n,s;for(const a of Object.keys((n=t.payload.blocks)!=null?n:{})){const o=e[a],i=(s=t.payload.blocks)==null?void 0:s[a];if(!i)continue;const l={...i,data:{...i.data}};!t.payload.force&&o!=null&&l.version<=o.version||((o==null?void 0:o.type)!==m.BlockType.PDF_ANNOTATION&&(l.data.localUrl=o==null?void 0:o.data.localUrl),l.data.iconUrl=o==null?void 0:o.data.iconUrl,l.data.showEmptyCaption=o==null?void 0:o.data.showEmptyCaption,e[a]=l)}},clear(){return{}},incVersion(e,t){t.payload.forEach(n=>{const s=e[n];s&&s.version!==-1&&(s.version+=1)})}},extraReducers(e){e.addCase(Ia,(t,{payload:n})=>{var s;(n.block.type===m.BlockType.PAGE||n.block.type===m.BlockType.FOLDER)&&(n.block={...n.block,local:(s=n.local)!=null?s:!0}),t[n.block.uuid]=n.block}),e.addCase(mn,(t,{payload:n})=>{const{uuid:s,patch:a}=n,o=t[s];if(!o)return;delete o.local;const{data:i={},...l}=a,{format:c,...u}=i;Object.assign(o,l),Object.assign(o.data,u),o.data.format||(o.data.format={}),Object.assign(o.data.format,i==null?void 0:i.format)}),e.addCase(Ii,(t,{payload:n})=>{const{uuid:s,parentId:a,before:o,ignoreUpdateTime:i}=n,l=t[a],c=t[s];if(c&&(c.parentId=a,c.status=m.BlockStatus.NORMAL,i||(c.updatedAt=Date.now()),!!l))if(o){const u=l.subNodes.indexOf(o);u<0?l.subNodes.unshift(s):l.subNodes.splice(u,0,s)}else l.subNodes.unshift(s)}),e.addCase(Wn,(t,{payload:n})=>{const{uuid:s,parentId:a,after:o,ignoreUpdateTime:i}=n,l=t[a],c=t[s];if(c&&(c.parentId=a,c.status=m.BlockStatus.NORMAL,i||(c.updatedAt=Date.now()),!!l))if(o){const u=l.subNodes.indexOf(o);u<0?l.subNodes.push(s):l.subNodes.splice(u+1,0,s)}else l.subNodes.push(s)}),e.addCase(tr,(t,{payload:n})=>{const{uuid:s}=n,a=t[s];if(!a)return;const o=t[a.parentId];o&&(o.subNodes=o.subNodes.filter(i=>i!==s))}),e.addCase(Zp,(t,{payload:n})=>{const{uuid:s}=n;delete t[s]}),e.addCase(dx,(t,{payload:n})=>{const{uuid:s,permission:a}=n,o=t[s];o&&((a.type===m.PermissionType.PUBLIC||a.type===m.PermissionType.RESTRICTED)&&(o.permissions=o.permissions.filter(i=>i.type!==a.type),o.permissions.push(a)),a.type===m.PermissionType.SPACE&&(o.permissions.some(i=>i.type===m.PermissionType.SPACE)?o.permissions=o.permissions.map(i=>i.type===m.PermissionType.SPACE?a:i):o.permissions.push(a)),a.type===m.PermissionType.GROUP&&(o.permissions.some(i=>i.groupId===a.groupId)?o.permissions=o.permissions.map(i=>i.groupId===a.groupId?a:i):o.permissions.push(a)),a.type===m.PermissionType.USER&&(o.permissions.some(i=>i.userId===a.userId)?o.permissions=o.permissions.map(i=>i.userId===a.userId?a:i):o.permissions.push(a)))}),e.addCase(fx,(t,{payload:n})=>{const{uuid:s,permission:a}=n,o=t[s];o&&((a.type===m.PermissionType.SPACE||a.type===m.PermissionType.PUBLIC||a.type===m.PermissionType.RESTRICTED)&&(o.permissions=o.permissions.filter(i=>i.type!==a.type)),a.type===m.PermissionType.GROUP&&(o.permissions=o.permissions.filter(i=>i.groupId!==a.groupId)),a.type===m.PermissionType.USER&&(o.permissions=o.permissions.filter(i=>i.userId!==a.userId)))}),e.addCase(fd,(t,{payload:n})=>{const{uuid:s,after:a,parentId:o}=n,i=t[o];if(i)if(!i.views)i.views=[s];else if(a){const l=i.views.indexOf(a);l<0?i.views.push(s):i.views.splice(l+1,0,s)}else i.views.push(s)}),e.addCase(sm,(t,{payload:n})=>{const{uuid:s,before:a,parentId:o}=n,i=t[o];if(i)if(i.views||(i.views=[s]),a){const l=i.views.indexOf(a);l<0?i.views.push(s):i.views.splice(l,0,s)}else i.views.unshift(s)}),e.addCase(rm,(t,{payload:n})=>{var i;const{uuid:s,parentId:a}=n,o=t[a];o&&(o.views=(i=o.views)==null?void 0:i.filter(l=>l!==s))}),e.addCase(tg,(t,{payload:n})=>{const{uuid:s,after:a,parentId:o}=n,i=t[o];if(i)if(!i.discussions)i.discussions=[s];else if(a){const l=i.discussions.indexOf(a);l<0?i.discussions.push(s):i.discussions.splice(l+1,0,s)}else i.discussions.push(s)}),e.addCase(ng,(t,{payload:n})=>{var i;const{uuid:s,parentId:a}=n,o=t[a];o&&(o.discussions=(i=o.discussions)==null?void 0:i.filter(l=>l!==s))})}}),oq=yw.reducer,Gn=yw.actions,iq={},kD=Io({name:"spaces",initialState:iq,reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}},extraReducers(e){e.addCase(tq,(t,{payload:n})=>{t[n.space.uuid]=n.space}),e.addCase(Fw,(t,{payload:n})=>{const s=t[n.uuid];if(!s)return;const{setting:a,...o}=n.patch;Object.assign(s,o),s.setting?Object.assign(s.setting,a):s.setting={...a}}),e.addCase(op,(t,{payload:n})=>{const s=t[n.parentId];if(!s)return;const a=s.customTemplates.indexOf(n.uuid);a>-1&&s.customTemplates.splice(a,1)}),e.addCase(rp,(t,{payload:n})=>{const s=t[n.parentId];if(s)if(n.before){const a=s.customTemplates.indexOf(n.before);a<0?s.customTemplates.splice(0,0,n.uuid):s.customTemplates.splice(a,0,n.uuid)}else s.customTemplates.splice(0,0,n.uuid)}),e.addCase(ap,(t,{payload:n})=>{const s=t[n.parentId];if(s)if(n.after){const a=s.customTemplates.indexOf(n.after);a<0?s.customTemplates.splice(0,0,n.uuid):s.customTemplates.splice(a+1,0,n.uuid)}else s.customTemplates.splice(0,0,n.uuid)}),e.addCase(hx,(t,{payload:n})=>{const s=n.patch,a=t[n.uuid];if(a){a.userRemark||(a.userRemark={});for(const o of s)a.userRemark[o.userId]=o.markName}})}}),lq=kD.reducer,ip=kD.actions,CD={uuid:"",phone:"",nickname:"",backgroundColor:"",spaceViews:[],inviteCode:"",version:0,status:m.BlockStatus.NORMAL,currentSpaceViewId:"",occupation:0,avatar:"",setting:{}},TD=Io({name:"user",initialState:CD,reducers:{update(e,t){const{setting:n,...s}=t.payload;n&&(e.setting||(e.setting={}),Object.assign(e.setting,n)),Object.assign(e,s)},clear(){return{uuid:"",phone:"",nickname:"",backgroundColor:"",spaceViews:[],inviteCode:"",version:0,status:m.BlockStatus.NORMAL,currentSpaceViewId:"",occupation:0,avatar:""}}},extraReducers(e){e.addCase(wD,(t,{payload:n})=>{const s=t.spaceViews.findIndex(a=>a===n.uuid);s!==-1&&t.spaceViews.splice(s,1)}),e.addCase(rq,(t,{payload:n})=>{t.spaceViews.push(n.uuid)})}}),cq=TD.reducer,Ci=TD.actions,l2=new WeakMap,c2=new WeakMap,vD=e=>{let t=l2.get(e);return t===void 0&&(t=xI.Map(),l2.set(e,t)),t},u2=(e,t)=>{l2.set(e,t)},uq=e=>{let t=c2.get(e);return t===void 0&&(t=xI.Map(),c2.set(e,t)),t},ND=(e,t)=>{c2.set(e,t)},bw=(e,t)=>{const{blocks:n}=t(),s=n[e];if(s)return Xt(s.type)?s.uuid:bw(s.parentId,t)},y_=e=>{var t,n;return(n=(t=dq(e().user.currentSpaceViewId,e))==null?void 0:t.uuid)!=null?n:""},dq=(e,t)=>{var a,o;const{spaceViews:n,spaces:s}=t();return s[(o=(a=n[e])==null?void 0:a.spaceId)!=null?o:""]},fq=(e,t)=>{const n=t[e];if(!n)return;let s=t[n.parentId];for(;s;){if(Xt(s.type))return s.uuid;s=t[s.parentId]}},mq=({getState:e})=>{const t=o=>{const i=e().cache,l=vD(i);u2(i,l.delete(o))},n=()=>{const o=e().cache;u2(o,$3())},s=o=>{const i=fq(o,e().blocks);i!=null&&t(i)},a=()=>{const o=e().cache;ND(o,$3())};return o=>i=>{var l;if(Xn(Wn,Ii)(i)){if(i.payload.parentId!=null){const c=bw(i.payload.parentId,e);c!=null&&t(c)}a()}else if(Xn(mn)(i))i.payload.patch.type===m.BlockType.PAGE&&s(i.payload.uuid),Hu(i.payload.patch,"subNodes")&&(t(i.payload.uuid),a()),(Hu(i.payload.patch,"permissions")||Hu(i.payload.patch,"parentId"))&&(s(i.payload.uuid),a());else if(Xn(dx,fx)(i)){const c=(l=e().blocks[i.payload.uuid])==null?void 0:l.parentId;c!=null&&t(c),a()}else Xn(Zp,tr)(i)?(s(i.payload.uuid),a()):Xn(Ci.update,Ci.clear,ip.update,ip.clear,Gn.update,Gn.clear)(i)&&(a(),n());o(i)}},_x=Wt("comment/create"),lp=Wt("comment/update"),xx=Wt("comment/list-after"),Fx=Wt("comment/list-remove");let b_=!1;const Hl=[],L1=[];let ll=0;const hq=e=>{const t=Hl.pop();t&&(Gb(t,n=>{var o,i,l;const{action:s,snapshot:a}=n;if(Xn(bs)(s)){const c=s.payload;(o=sp.get(c))==null||o.undo()}if(Xn(Ia)(s)){const{block:{uuid:c},ignoreOp:u}=s.payload;e(mn({uuid:c,patch:{status:-1},ignoreOp:u}))}if(Xn(jm)(s)){const{uuid:c}=s.payload.collectionView;e(oc({uuid:c,patch:{status:-1}}))}if(Xn(rm)(s)){const{uuid:c,parentId:u}=s.payload,d=(i=a.blocks[u])==null?void 0:i.views;if(!d)return;const f=d.indexOf(c),h=d[f-1],p=d[f+1];e(p?sm({uuid:c,parentId:u,before:p}):fd({uuid:c,parentId:u,after:h}))}if(Xn(_c)(s)){const{uuid:c,viewId:u}=s.payload,d=(l=a.collectionViews[u])==null?void 0:l.pageSort;if(!d)return;const f=d.indexOf(c),h=d[f-1],p=d[f+1];e(p?md({uuid:c,viewId:u,before:p}):Fl({uuid:c,viewId:u,after:h}))}if(Xn(fd,sm)(s)){const{uuid:c,parentId:u}=s.payload;e(rm({uuid:c,parentId:u}))}if(Xn(Fl,md)(s)){const{uuid:c,viewId:u}=s.payload;e(_c({uuid:c,viewId:u}))}if(Xn(mn)(s)){const{uuid:c,patch:u,ignoreOp:d}=s.payload,f=a.blocks[c];if(!f)return;const h={};Object.keys(u).forEach(p=>{["type","backgroundColor","textColor","status"].includes(p)&&(h[p]=f[p])}),h.data=Vp(u.data,(p,g)=>qp(f.data,g)),e(mn({uuid:c,patch:h,ignoreOp:d}))}if(Xn(Wn,Ii)(s)){const{uuid:c,ignoreOp:u}=s.payload;e(tr({uuid:c,ignoreOp:u}))}if(Xn(tr)(s)){const{payload:c}=s,u=a.blocks[c.uuid];if(!u)return;const d=a.blocks[u.parentId];if(!d)return;const f=d.subNodes.indexOf(c.uuid),h=d.subNodes[f-1],p=d.subNodes[f+1];e(p?Ii({uuid:c.uuid,parentId:d.uuid,before:p,ignoreOp:c.ignoreOp}):Wn({uuid:c.uuid,parentId:d.uuid,after:h,ignoreOp:c.ignoreOp}))}if(Xn(oc)(s)){const{payload:c}=s,u=a.collectionViews[c.uuid];if(!u)return;const d={pageSort:u.pageSort,format:u.format,status:u.status,updatedAt:u.updatedAt};e(oc({uuid:c.uuid,patch:d}))}if(Xn(om,am)(s)){const{payload:c}=s;e(hd({uuid:c.uuid,parentId:a.user.currentSpaceViewId}))}if(Xn(hd)(s)){const{payload:c}=s,u=a.spaceViews[a.user.currentSpaceViewId];if(!u)return;const d=u.favoritePages.indexOf(c.uuid);if(d===0)e(am({uuid:c.uuid,parentId:a.user.currentSpaceViewId}));else{const f=u.favoritePages[d-1];f&&e(om({uuid:c.uuid,parentId:a.user.currentSpaceViewId,after:f}))}}if(Xn(ap,rp)(s)){const{payload:c}=s,u=a.spaceViews[a.user.currentSpaceViewId];if(!u)return;const d=a.spaces[u.spaceId];if(!d)return;e(op({uuid:c.uuid,parentId:d.uuid}))}if(Xn(op)(s)){const{payload:c}=s,u=a.spaceViews[a.user.currentSpaceViewId];if(!u)return;const d=a.spaces[u.spaceId];if(!d)return;const f=d.customTemplates.indexOf(c.uuid);if(f===0)e(rp({uuid:c.uuid,parentId:d.uuid}));else{const h=u.favoritePages[f-1];h&&e(ap({uuid:c.uuid,parentId:d.uuid,after:h}))}}}),e(eg()),L1.push(t))},pq=e=>{const t=L1.pop();t&&(t.forEach(n=>{var a;const{action:s}=n;if(Xn(bs)(s)){const o=s.payload;(a=sp.get(o))==null||a.redo()}else e(s)}),e(eg()),Hl.push(t))};let Ay;const gq=({getState:e,dispatch:t})=>n=>s=>{var a,o,i;if(Xn(mx)(s)){for(ll=1,b_=!0,L1.length=0;Hl.length>49;)Hl.shift();((a=pn(Hl))==null?void 0:a.length)!==0&&Hl.push([]),Ay=s.payload.state}if(Xn(xw)(s)&&(b_=!1,Ay=void 0),b_&&Xn(Ia,mn,tr,Wn,Ii,jm,oc,rm,fd,sm,_c,Fl,md,bs,om,am,hd,px,gx,Bu,tg,ng,_x,lp,xx,Fx)(s)){const l=Ay||e();(o=pn(Hl))==null||o.push({snapshot:l,action:s})}if(Xn(bs)(s)){const l=s.payload;(i=sp.get(l))==null||i.init()}if(Xn(Ad)(s)){n(s),hq(t);return}if(Xn(Dm)(s)){n(s),pq(t);return}Xn(ED)(s)&&(sp.clear(),Hl.length=0,L1.length=0,b_=!1),n(s)},yx=()=>un?localStorage.getItem(t2):T1.get("next_auth"),d2=qe(),_q=un?`${Mt}/api`:"/api",bx=FI.create({baseURL:_q,validateStatus(){return!0}});bx.interceptors.request.use(e=>{if(un){const n=yx();n&&(e.headers.Authorization=`Bearer ${n}`)}e.headers["X-SENDER-ID"]=d2,e.headers["x-platform"]=un?"desktop":"web-cookie",e.headers.app_version_name=Xj;const t=NU(nw.PASSWORD);return t&&(e.headers["share-password"]=t),e});bx.interceptors.response.use(e=>{if(e.config.url==="/users/me"&&!un)return e;if(e.status===401||e.data&&e.data.code===401){if(localStorage.removeItem(cd),localStorage.removeItem(t2),!ma(Rt.login)){if(window.location.pathname===Rt.main&&ud())return e;if(ma(Rt.form,"startsWith"))return;window.location.pathname=Rt.login}}else if(un){const t=e.headers["x-set-token"];t&&localStorage.setItem(t2,t)}return e});const xq=!0,Fq=[{id:"people",name:"Smileys & People",emojis:["grinning","smiley","smile","grin","laughing","sweat_smile","rolling_on_the_floor_laughing","joy","slightly_smiling_face","upside_down_face","wink","blush","innocent","smiling_face_with_3_hearts","heart_eyes","star-struck","kissing_heart","kissing","relaxed","kissing_closed_eyes","kissing_smiling_eyes","yum","stuck_out_tongue","stuck_out_tongue_winking_eye","zany_face","stuck_out_tongue_closed_eyes","money_mouth_face","hugging_face","face_with_hand_over_mouth","shushing_face","thinking_face","zipper_mouth_face","face_with_raised_eyebrow","neutral_face","expressionless","no_mouth","smirk","unamused","face_with_rolling_eyes","grimacing","lying_face","relieved","pensive","sleepy","drooling_face","sleeping","mask","face_with_thermometer","face_with_head_bandage","nauseated_face","face_vomiting","sneezing_face","hot_face","cold_face","woozy_face","dizzy_face","exploding_head","face_with_cowboy_hat","partying_face","sunglasses","nerd_face","face_with_monocle","confused","worried","slightly_frowning_face","white_frowning_face","open_mouth","hushed","astonished","flushed","pleading_face","frowning","anguished","fearful","cold_sweat","disappointed_relieved","cry","sob","scream","confounded","persevere","disappointed","sweat","weary","tired_face","yawning_face","triumph","rage","angry","face_with_symbols_on_mouth","smiling_imp","imp","skull","skull_and_crossbones","hankey","clown_face","japanese_ogre","japanese_goblin","ghost","alien","space_invader","robot_face","smiley_cat","smile_cat","joy_cat","heart_eyes_cat","smirk_cat","kissing_cat","scream_cat","crying_cat_face","pouting_cat","see_no_evil","hear_no_evil","speak_no_evil","wave","raised_back_of_hand","raised_hand_with_fingers_splayed","hand","spock-hand","ok_hand","pinching_hand","v","crossed_fingers","i_love_you_hand_sign","the_horns","call_me_hand","point_left","point_right","point_up_2","middle_finger","point_down","point_up","+1","-1","fist","facepunch","left-facing_fist","right-facing_fist","clap","raised_hands","open_hands","palms_up_together","handshake","pray","writing_hand","nail_care","selfie","muscle","mechanical_arm","mechanical_leg","leg","foot","ear","ear_with_hearing_aid","nose","brain","tooth","bone","eyes","eye","tongue","lips","baby","child","boy","girl","adult","person_with_blond_hair","man","bearded_person","red_haired_man","curly_haired_man","white_haired_man","bald_man","woman","red_haired_woman","red_haired_person","curly_haired_woman","curly_haired_person","white_haired_woman","white_haired_person","bald_woman","bald_person","blond-haired-woman","blond-haired-man","older_adult","older_man","older_woman","person_frowning","man-frowning","woman-frowning","person_with_pouting_face","man-pouting","woman-pouting","no_good","man-gesturing-no","woman-gesturing-no","ok_woman","man-gesturing-ok","woman-gesturing-ok","information_desk_person","man-tipping-hand","woman-tipping-hand","raising_hand","man-raising-hand","woman-raising-hand","deaf_person","deaf_man","deaf_woman","bow","man-bowing","woman-bowing","face_palm","man-facepalming","woman-facepalming","shrug","man-shrugging","woman-shrugging","health_worker","male-doctor","female-doctor","student","male-student","female-student","teacher","male-teacher","female-teacher","judge","male-judge","female-judge","farmer","male-farmer","female-farmer","cook","male-cook","female-cook","mechanic","male-mechanic","female-mechanic","factory_worker","male-factory-worker","female-factory-worker","office_worker","male-office-worker","female-office-worker","scientist","male-scientist","female-scientist","technologist","male-technologist","female-technologist","singer","male-singer","female-singer","artist","male-artist","female-artist","pilot","male-pilot","female-pilot","astronaut","male-astronaut","female-astronaut","firefighter","male-firefighter","female-firefighter","cop","male-police-officer","female-police-officer","sleuth_or_spy","male-detective","female-detective","guardsman","male-guard","female-guard","construction_worker","male-construction-worker","female-construction-worker","prince","princess","man_with_turban","man-wearing-turban","woman-wearing-turban","man_with_gua_pi_mao","person_with_headscarf","man_in_tuxedo","bride_with_veil","pregnant_woman","breast-feeding","angel","santa","mrs_claus","superhero","male_superhero","female_superhero","supervillain","male_supervillain","female_supervillain","mage","male_mage","female_mage","fairy","male_fairy","female_fairy","vampire","male_vampire","female_vampire","merperson","merman","mermaid","elf","male_elf","female_elf","genie","male_genie","female_genie","zombie","male_zombie","female_zombie","massage","man-getting-massage","woman-getting-massage","haircut","man-getting-haircut","woman-getting-haircut","walking","man-walking","woman-walking","standing_person","man_standing","woman_standing","kneeling_person","man_kneeling","woman_kneeling","person_with_probing_cane","man_with_probing_cane","woman_with_probing_cane","person_in_motorized_wheelchair","man_in_motorized_wheelchair","woman_in_motorized_wheelchair","person_in_manual_wheelchair","man_in_manual_wheelchair","woman_in_manual_wheelchair","runner","man-running","woman-running","dancer","man_dancing","man_in_business_suit_levitating","dancers","man-with-bunny-ears-partying","woman-with-bunny-ears-partying","person_in_steamy_room","man_in_steamy_room","woman_in_steamy_room","person_climbing","man_climbing","woman_climbing","fencer","horse_racing","skier","snowboarder","golfer","man-golfing","woman-golfing","surfer","man-surfing","woman-surfing","rowboat","man-rowing-boat","woman-rowing-boat","swimmer","man-swimming","woman-swimming","person_with_ball","man-bouncing-ball","woman-bouncing-ball","weight_lifter","man-lifting-weights","woman-lifting-weights","bicyclist","man-biking","woman-biking","mountain_bicyclist","man-mountain-biking","woman-mountain-biking","person_doing_cartwheel","man-cartwheeling","woman-cartwheeling","wrestlers","man-wrestling","woman-wrestling","water_polo","man-playing-water-polo","woman-playing-water-polo","handball","man-playing-handball","woman-playing-handball","juggling","man-juggling","woman-juggling","person_in_lotus_position","man_in_lotus_position","woman_in_lotus_position","bath","sleeping_accommodation","people_holding_hands","two_women_holding_hands","couple","two_men_holding_hands","couplekiss","woman-kiss-man","man-kiss-man","woman-kiss-woman","couple_with_heart","woman-heart-man","man-heart-man","woman-heart-woman","family","man-woman-boy","man-woman-girl","man-woman-girl-boy","man-woman-boy-boy","man-woman-girl-girl","man-man-boy","man-man-girl","man-man-girl-boy","man-man-boy-boy","man-man-girl-girl","woman-woman-boy","woman-woman-girl","woman-woman-girl-boy","woman-woman-boy-boy","woman-woman-girl-girl","man-boy","man-boy-boy","man-girl","man-girl-boy","man-girl-girl","woman-boy","woman-boy-boy","woman-girl","woman-girl-boy","woman-girl-girl","speaking_head_in_silhouette","bust_in_silhouette","busts_in_silhouette","footprints","kiss","love_letter","cupid","gift_heart","sparkling_heart","heartpulse","heartbeat","revolving_hearts","two_hearts","heart_decoration","heavy_heart_exclamation_mark_ornament","broken_heart","heart","orange_heart","yellow_heart","green_heart","blue_heart","purple_heart","brown_heart","black_heart","white_heart","100","anger","boom","dizzy","sweat_drops","dash","hole","bomb","speech_balloon","eye-in-speech-bubble","left_speech_bubble","right_anger_bubble","thought_balloon","zzz"]},{id:"nature",name:"Animals & Nature",emojis:["monkey_face","monkey","gorilla","orangutan","dog","dog2","guide_dog","service_dog","poodle","wolf","fox_face","raccoon","cat","cat2","lion_face","tiger","tiger2","leopard","horse","racehorse","unicorn_face","zebra_face","deer","cow","ox","water_buffalo","cow2","pig","pig2","boar","pig_nose","ram","sheep","goat","dromedary_camel","camel","llama","giraffe_face","elephant","rhinoceros","hippopotamus","mouse","mouse2","rat","hamster","rabbit","rabbit2","chipmunk","hedgehog","bat","bear","koala","panda_face","sloth","otter","skunk","kangaroo","badger","feet","turkey","chicken","rooster","hatching_chick","baby_chick","hatched_chick","bird","penguin","dove_of_peace","eagle","duck","swan","owl","flamingo","peacock","parrot","frog","crocodile","turtle","lizard","snake","dragon_face","dragon","sauropod","t-rex","whale","whale2","dolphin","fish","tropical_fish","blowfish","shark","octopus","shell","snail","butterfly","bug","ant","bee","beetle","cricket","spider","spider_web","scorpion","mosquito","microbe","bouquet","cherry_blossom","white_flower","rosette","rose","wilted_flower","hibiscus","sunflower","blossom","tulip","seedling","evergreen_tree","deciduous_tree","palm_tree","cactus","ear_of_rice","herb","shamrock","four_leaf_clover","maple_leaf","fallen_leaf","leaves"]},{id:"foods",name:"Food & Drink",emojis:["grapes","melon","watermelon","tangerine","lemon","banana","pineapple","mango","apple","green_apple","pear","peach","cherries","strawberry","kiwifruit","tomato","coconut","avocado","eggplant","potato","carrot","corn","hot_pepper","cucumber","leafy_green","broccoli","garlic","onion","mushroom","peanuts","chestnut","bread","croissant","baguette_bread","pretzel","bagel","pancakes","waffle","cheese_wedge","meat_on_bone","poultry_leg","cut_of_meat","bacon","hamburger","fries","pizza","hotdog","sandwich","taco","burrito","stuffed_flatbread","falafel","egg","fried_egg","shallow_pan_of_food","stew","bowl_with_spoon","green_salad","popcorn","butter","salt","canned_food","bento","rice_cracker","rice_ball","rice","curry","ramen","spaghetti","sweet_potato","oden","sushi","fried_shrimp","fish_cake","moon_cake","dango","dumpling","fortune_cookie","takeout_box","crab","lobster","shrimp","squid","oyster","icecream","shaved_ice","ice_cream","doughnut","cookie","birthday","cake","cupcake","pie","chocolate_bar","candy","lollipop","custard","honey_pot","baby_bottle","glass_of_milk","coffee","tea","sake","champagne","wine_glass","cocktail","tropical_drink","beer","beers","clinking_glasses","tumbler_glass","cup_with_straw","beverage_box","mate_drink","ice_cube","chopsticks","knife_fork_plate","fork_and_knife","spoon","hocho","amphora"]},{id:"activity",name:"Activities",emojis:["jack_o_lantern","christmas_tree","fireworks","sparkler","firecracker","sparkles","balloon","tada","confetti_ball","tanabata_tree","bamboo","dolls","flags","wind_chime","rice_scene","red_envelope","ribbon","gift","reminder_ribbon","admission_tickets","ticket","medal","trophy","sports_medal","first_place_medal","second_place_medal","third_place_medal","soccer","baseball","softball","basketball","volleyball","football","rugby_football","tennis","flying_disc","bowling","cricket_bat_and_ball","field_hockey_stick_and_ball","ice_hockey_stick_and_puck","lacrosse","table_tennis_paddle_and_ball","badminton_racquet_and_shuttlecock","boxing_glove","martial_arts_uniform","goal_net","golf","ice_skate","fishing_pole_and_fish","diving_mask","running_shirt_with_sash","ski","sled","curling_stone","dart","yo-yo","kite","8ball","crystal_ball","nazar_amulet","video_game","joystick","slot_machine","game_die","jigsaw","teddy_bear","spades","hearts","diamonds","clubs","chess_pawn","black_joker","mahjong","flower_playing_cards","performing_arts","frame_with_picture","art","thread","yarn"]},{id:"places",name:"Travel & Places",emojis:["earth_africa","earth_americas","earth_asia","globe_with_meridians","world_map","japan","compass","snow_capped_mountain","mountain","volcano","mount_fuji","camping","beach_with_umbrella","desert","desert_island","national_park","stadium","classical_building","building_construction","bricks","house_buildings","derelict_house_building","house","house_with_garden","office","post_office","european_post_office","hospital","bank","hotel","love_hotel","convenience_store","school","department_store","factory","japanese_castle","european_castle","wedding","tokyo_tower","statue_of_liberty","church","mosque","hindu_temple","synagogue","shinto_shrine","kaaba","fountain","tent","foggy","night_with_stars","cityscape","sunrise_over_mountains","sunrise","city_sunset","city_sunrise","bridge_at_night","hotsprings","carousel_horse","ferris_wheel","roller_coaster","barber","circus_tent","steam_locomotive","railway_car","bullettrain_side","bullettrain_front","train2","metro","light_rail","station","tram","monorail","mountain_railway","train","bus","oncoming_bus","trolleybus","minibus","ambulance","fire_engine","police_car","oncoming_police_car","taxi","oncoming_taxi","car","oncoming_automobile","blue_car","truck","articulated_lorry","tractor","racing_car","racing_motorcycle","motor_scooter","manual_wheelchair","motorized_wheelchair","auto_rickshaw","bike","scooter","skateboard","busstop","motorway","railway_track","oil_drum","fuelpump","rotating_light","traffic_light","vertical_traffic_light","octagonal_sign","construction","anchor","boat","canoe","speedboat","passenger_ship","ferry","motor_boat","ship","airplane","small_airplane","airplane_departure","airplane_arriving","parachute","seat","helicopter","suspension_railway","mountain_cableway","aerial_tramway","satellite","rocket","flying_saucer","bellhop_bell","luggage","hourglass","hourglass_flowing_sand","watch","alarm_clock","stopwatch","timer_clock","mantelpiece_clock","clock12","clock1230","clock1","clock130","clock2","clock230","clock3","clock330","clock4","clock430","clock5","clock530","clock6","clock630","clock7","clock730","clock8","clock830","clock9","clock930","clock10","clock1030","clock11","clock1130","new_moon","waxing_crescent_moon","first_quarter_moon","moon","full_moon","waning_gibbous_moon","last_quarter_moon","waning_crescent_moon","crescent_moon","new_moon_with_face","first_quarter_moon_with_face","last_quarter_moon_with_face","thermometer","sunny","full_moon_with_face","sun_with_face","ringed_planet","star","star2","stars","milky_way","cloud","partly_sunny","thunder_cloud_and_rain","mostly_sunny","barely_sunny","partly_sunny_rain","rain_cloud","snow_cloud","lightning","tornado","fog","wind_blowing_face","cyclone","rainbow","closed_umbrella","umbrella","umbrella_with_rain_drops","umbrella_on_ground","zap","snowflake","snowman","snowman_without_snow","comet","fire","droplet","ocean"]},{id:"objects",name:"Objects",emojis:["eyeglasses","dark_sunglasses","goggles","lab_coat","safety_vest","necktie","shirt","jeans","scarf","gloves","coat","socks","dress","kimono","sari","one-piece_swimsuit","briefs","shorts","bikini","womans_clothes","purse","handbag","pouch","shopping_bags","school_satchel","mans_shoe","athletic_shoe","hiking_boot","womans_flat_shoe","high_heel","sandal","ballet_shoes","boot","crown","womans_hat","tophat","mortar_board","billed_cap","helmet_with_white_cross","prayer_beads","lipstick","ring","gem","mute","speaker","sound","loud_sound","loudspeaker","mega","postal_horn","bell","no_bell","musical_score","musical_note","notes","studio_microphone","level_slider","control_knobs","microphone","headphones","radio","saxophone","guitar","musical_keyboard","trumpet","violin","banjo","drum_with_drumsticks","iphone","calling","phone","telephone_receiver","pager","fax","battery","electric_plug","computer","desktop_computer","printer","keyboard","three_button_mouse","trackball","minidisc","floppy_disk","cd","dvd","abacus","movie_camera","film_frames","film_projector","clapper","tv","camera","camera_with_flash","video_camera","vhs","mag","mag_right","candle","bulb","flashlight","izakaya_lantern","diya_lamp","notebook_with_decorative_cover","closed_book","book","green_book","blue_book","orange_book","books","notebook","ledger","page_with_curl","scroll","page_facing_up","newspaper","rolled_up_newspaper","bookmark_tabs","bookmark","label","moneybag","yen","dollar","euro","pound","money_with_wings","credit_card","receipt","chart","currency_exchange","heavy_dollar_sign","email","e-mail","incoming_envelope","envelope_with_arrow","outbox_tray","inbox_tray","package","mailbox","mailbox_closed","mailbox_with_mail","mailbox_with_no_mail","postbox","ballot_box_with_ballot","pencil2","black_nib","lower_left_fountain_pen","lower_left_ballpoint_pen","lower_left_paintbrush","lower_left_crayon","memo","briefcase","file_folder","open_file_folder","card_index_dividers","date","calendar","spiral_note_pad","spiral_calendar_pad","card_index","chart_with_upwards_trend","chart_with_downwards_trend","bar_chart","clipboard","pushpin","round_pushpin","paperclip","linked_paperclips","straight_ruler","triangular_ruler","scissors","card_file_box","file_cabinet","wastebasket","lock","unlock","lock_with_ink_pen","closed_lock_with_key","key","old_key","hammer","axe","pick","hammer_and_pick","hammer_and_wrench","dagger_knife","crossed_swords","gun","bow_and_arrow","shield","wrench","nut_and_bolt","gear","compression","scales","probing_cane","link","chains","toolbox","magnet","alembic","test_tube","petri_dish","dna","microscope","telescope","satellite_antenna","syringe","drop_of_blood","pill","adhesive_bandage","stethoscope","door","bed","couch_and_lamp","chair","toilet","shower","bathtub","razor","lotion_bottle","safety_pin","broom","basket","roll_of_paper","soap","sponge","fire_extinguisher","shopping_trolley","smoking","coffin","funeral_urn","moyai"]},{id:"symbols",name:"Symbols",emojis:["atm","put_litter_in_its_place","potable_water","wheelchair","mens","womens","restroom","baby_symbol","wc","passport_control","customs","baggage_claim","left_luggage","warning","children_crossing","no_entry","no_entry_sign","no_bicycles","no_smoking","do_not_litter","non-potable_water","no_pedestrians","no_mobile_phones","underage","radioactive_sign","biohazard_sign","arrow_up","arrow_upper_right","arrow_right","arrow_lower_right","arrow_down","arrow_lower_left","arrow_left","arrow_upper_left","arrow_up_down","left_right_arrow","leftwards_arrow_with_hook","arrow_right_hook","arrow_heading_up","arrow_heading_down","arrows_clockwise","arrows_counterclockwise","back","end","on","soon","top","place_of_worship","atom_symbol","om_symbol","star_of_david","wheel_of_dharma","yin_yang","latin_cross","orthodox_cross","star_and_crescent","peace_symbol","menorah_with_nine_branches","six_pointed_star","aries","taurus","gemini","cancer","leo","virgo","libra","scorpius","sagittarius","capricorn","aquarius","pisces","ophiuchus","twisted_rightwards_arrows","repeat","repeat_one","arrow_forward","fast_forward","black_right_pointing_double_triangle_with_vertical_bar","black_right_pointing_triangle_with_double_vertical_bar","arrow_backward","rewind","black_left_pointing_double_triangle_with_vertical_bar","arrow_up_small","arrow_double_up","arrow_down_small","arrow_double_down","double_vertical_bar","black_square_for_stop","black_circle_for_record","eject","cinema","low_brightness","high_brightness","signal_strength","vibration_mode","mobile_phone_off","female_sign","male_sign","medical_symbol","infinity","recycle","fleur_de_lis","trident","name_badge","beginner","o","white_check_mark","ballot_box_with_check","heavy_check_mark","heavy_multiplication_x","x","negative_squared_cross_mark","heavy_plus_sign","heavy_minus_sign","heavy_division_sign","curly_loop","loop","part_alternation_mark","eight_spoked_asterisk","eight_pointed_black_star","sparkle","bangbang","interrobang","question","grey_question","grey_exclamation","exclamation","wavy_dash","copyright","registered","tm","hash","keycap_star","zero","one","two","three","four","five","six","seven","eight","nine","keycap_ten","capital_abcd","abcd","1234","symbols","abc","a","ab","b","cl","cool","free","information_source","id","m","new","ng","o2","ok","parking","sos","up","vs","koko","sa","u6708","u6709","u6307","ideograph_advantage","u5272","u7121","u7981","accept","u7533","u5408","u7a7a","congratulations","secret","u55b6","u6e80","red_circle","large_orange_circle","large_yellow_circle","large_green_circle","large_blue_circle","large_purple_circle","large_brown_circle","black_circle","white_circle","large_red_square","large_orange_square","large_yellow_square","large_green_square","large_blue_square","large_purple_square","large_brown_square","black_large_square","white_large_square","black_medium_square","white_medium_square","black_medium_small_square","white_medium_small_square","black_small_square","white_small_square","large_orange_diamond","large_blue_diamond","small_orange_diamond","small_blue_diamond","small_red_triangle","small_red_triangle_down","diamond_shape_with_a_dot_inside","radio_button","white_square_button","black_square_button"]},{id:"flags",name:"Flags",emojis:["checkered_flag","cn","crossed_flags","de","es","flag-ac","flag-ad","flag-ae","flag-af","flag-ag","flag-ai","flag-al","flag-am","flag-ao","flag-aq","flag-ar","flag-as","flag-at","flag-au","flag-aw","flag-ax","flag-az","flag-ba","flag-bb","flag-bd","flag-be","flag-bf","flag-bg","flag-bh","flag-bi","flag-bj","flag-bl","flag-bm","flag-bn","flag-bo","flag-bq","flag-br","flag-bs","flag-bt","flag-bv","flag-bw","flag-by","flag-bz","flag-ca","flag-cc","flag-cd","flag-cf","flag-cg","flag-ch","flag-ci","flag-ck","flag-cl","flag-cm","flag-co","flag-cp","flag-cr","flag-cu","flag-cv","flag-cw","flag-cx","flag-cy","flag-cz","flag-dg","flag-dj","flag-dk","flag-dm","flag-do","flag-dz","flag-ea","flag-ec","flag-ee","flag-eg","flag-eh","flag-england","flag-er","flag-et","flag-eu","flag-fi","flag-fj","flag-fk","flag-fm","flag-fo","flag-ga","flag-gd","flag-ge","flag-gf","flag-gg","flag-gh","flag-gi","flag-gl","flag-gm","flag-gn","flag-gp","flag-gq","flag-gr","flag-gs","flag-gt","flag-gu","flag-gw","flag-gy","flag-hk","flag-hm","flag-hn","flag-hr","flag-ht","flag-hu","flag-ic","flag-id","flag-ie","flag-il","flag-im","flag-in","flag-io","flag-iq","flag-ir","flag-is","flag-je","flag-jm","flag-jo","flag-ke","flag-kg","flag-kh","flag-ki","flag-km","flag-kn","flag-kp","flag-kw","flag-ky","flag-kz","flag-la","flag-lb","flag-lc","flag-li","flag-lk","flag-lr","flag-ls","flag-lt","flag-lu","flag-lv","flag-ly","flag-ma","flag-mc","flag-md","flag-me","flag-mf","flag-mg","flag-mh","flag-mk","flag-ml","flag-mm","flag-mn","flag-mo","flag-mp","flag-mq","flag-mr","flag-ms","flag-mt","flag-mu","flag-mv","flag-mw","flag-mx","flag-my","flag-mz","flag-na","flag-nc","flag-ne","flag-nf","flag-ng","flag-ni","flag-nl","flag-no","flag-np","flag-nr","flag-nu","flag-nz","flag-om","flag-pa","flag-pe","flag-pf","flag-pg","flag-ph","flag-pk","flag-pl","flag-pm","flag-pn","flag-pr","flag-ps","flag-pt","flag-pw","flag-py","flag-qa","flag-re","flag-ro","flag-rs","flag-rw","flag-sa","flag-sb","flag-sc","flag-scotland","flag-sd","flag-se","flag-sg","flag-sh","flag-si","flag-sj","flag-sk","flag-sl","flag-sm","flag-sn","flag-so","flag-sr","flag-ss","flag-st","flag-sv","flag-sx","flag-sy","flag-sz","flag-ta","flag-tc","flag-td","flag-tf","flag-tg","flag-th","flag-tj","flag-tk","flag-tl","flag-tm","flag-tn","flag-to","flag-tr","flag-tt","flag-tv","flag-tz","flag-ua","flag-ug","flag-um","flag-uy","flag-uz","flag-va","flag-vc","flag-ve","flag-vg","flag-vi","flag-vn","flag-vu","flag-wales","flag-wf","flag-ws","flag-xk","flag-ye","flag-yt","flag-za","flag-zm","flag-zw","fr","gb","it","jp","kr","pirate_flag","rainbow-flag","ru","triangular_flag_on_post","us","waving_black_flag","waving_white_flag"]}],yq={100:{a:"Hundred Points Symbol",b:"1F4AF",d:!0,e:!0,f:!0,h:!0,j:["一百分","得分","完善","数字","世纪","考试","测验","测试","通过","百","score","perfect","numbers","century","exam","quiz","test","pass","hundred"],k:[26,5],o:2},1234:{a:"Input Symbol for Numbers",b:"1F522",d:!0,e:!0,f:!0,h:!0,j:["输入数字","数字","蓝色方块","numbers","blue-square"],k:[28,5],o:2},grinning:{a:"Grinning Face",b:"1F600",d:!0,e:!0,f:!0,h:!0,j:["笑嘻嘻","脸","微笑","快乐","喜悦",":D","笑容","face","smile","happy","joy",":D","grin"],k:[30,35],m:":D",o:2},monkey_face:{a:"Monkey Face",b:"1F435",d:!0,e:!0,f:!0,h:!0,j:["猴面","动物","自然界","马戏团","animal","nature","circus"],k:[12,25],l:[":o)"],o:2},grapes:{a:"Grapes",b:"1F347",d:!0,e:!0,f:!0,h:!0,j:["葡萄","水果","食物","酒","fruit","food","wine"],k:[6,31],o:2},eyeglasses:{a:"Eyeglasses",b:"1F453",d:!0,e:!0,f:!0,h:!0,j:["眼镜","时尚","辅料","目力","宅","笨蛋","怪胎","fashion","accessories","eyesight","nerdy","dork","geek"],k:[14,7],o:2},checkered_flag:{a:"Chequered Flag",b:"1F3C1",d:!0,e:!0,f:!0,h:!0,j:["方格旗","比赛","终点线","比赛","卡 丁 车","contest","finishline","race","gokart"],k:[8,39],o:2},jack_o_lantern:{a:"Jack-O-Lantern",b:"1F383",d:!0,e:!0,f:!0,h:!0,j:["南瓜灯","万圣节","光","南瓜","恐怖","秋天","halloween","light","pumpkin","creepy","fall"],k:[7,34],o:2},wave:{skin_variations:{"1F3FB":{unified:"1F44B-1F3FB",non_qualified:null,image:"1f44b-1f3fb.png",sheet_x:13,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44B-1F3FC",non_qualified:null,image:"1f44b-1f3fc.png",sheet_x:13,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44B-1F3FD",non_qualified:null,image:"1f44b-1f3fd.png",sheet_x:13,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44B-1F3FE",non_qualified:null,image:"1f44b-1f3fe.png",sheet_x:13,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44B-1F3FF",non_qualified:null,image:"1f44b-1f3ff.png",sheet_x:13,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Waving Hand Sign",b:"1F44B",d:!0,e:!0,f:!0,h:!0,j:["挥手","手","手势","再见","单","告别","你好","你好","手掌","hands","gesture","goodbye","solong","farewell","hello","hi","palm"],k:[13,26],o:2},earth_africa:{a:"Earth Globe Europe-Africa",b:"1F30D",d:!0,e:!0,f:!0,h:!0,j:["地球显示欧洲 - 非洲","球","世界","国际","globe","world","international"],k:[5,32],o:2},atm:{a:"Automated Teller Machine",b:"1F3E7",d:!0,e:!0,f:!0,h:!0,j:["ATM标志","钱","销售","现金","蓝色方块","付款","岸","money","sales","cash","blue-square","payment","bank"],k:[11,1],o:2},melon:{a:"Melon",b:"1F348",d:!0,e:!0,f:!0,h:!0,j:["瓜","水果","自然界","食物","fruit","nature","food"],k:[6,32],o:2},triangular_flag_on_post:{a:"Triangular Flag on Post",b:"1F6A9",d:!0,e:!0,f:!0,h:!0,j:["三角标志","马克","里程碑","地方","mark","milestone","place"],k:[35,0],o:2},put_litter_in_its_place:{a:"Put Litter in Its Place Symbol",b:"1F6AE",d:!0,e:!0,f:!0,h:!0,j:["垃圾桶标志","蓝色方块","标志","人","信息","blue-square","sign","human","info"],k:[35,5],o:2},christmas_tree:{a:"Christmas Tree",b:"1F384",d:!0,e:!0,f:!0,h:!0,j:["圣诞树","节日","假期","十二月","圣诞","庆祝","festival","vacation","december","xmas","celebration"],k:[7,35],o:2},monkey:{a:"Monkey",b:"1F412",d:!0,e:!0,f:!0,h:!0,j:["猴","动物","自然界","香蕉","马戏团","animal","nature","banana","circus"],k:[11,46],o:2},earth_americas:{a:"Earth Globe Americas",b:"1F30E",d:!0,e:!0,f:!0,h:!0,j:["环球美洲显示","球","世界","美国","国际","globe","world","USA","international"],k:[5,33],o:2},dark_sunglasses:{a:"Dark Sunglasses",b:"1F576-FE0F",c:"1F576",d:!0,e:!0,f:!0,h:!0,j:["墨镜","脸","凉","辅料","face","cool","accessories"],k:[29,33],o:2},raised_back_of_hand:{skin_variations:{"1F3FB":{unified:"1F91A-1F3FB",non_qualified:null,image:"1f91a-1f3fb.png",sheet_x:37,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91A-1F3FC",non_qualified:null,image:"1f91a-1f3fc.png",sheet_x:37,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91A-1F3FD",non_qualified:null,image:"1f91a-1f3fd.png",sheet_x:37,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91A-1F3FE",non_qualified:null,image:"1f91a-1f3fe.png",sheet_x:37,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91A-1F3FF",non_qualified:null,image:"1f91a-1f3ff.png",sheet_x:37,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Back of Hand",b:"1F91A",d:!0,e:!0,f:!0,h:!0,j:["举手","手指","提出","反手","fingers","raised","backhand"],k:[37,43],o:4},smiley:{a:"Smiling Face with Open Mouth",b:"1F603",d:!0,e:!0,f:!0,h:!0,j:["笑嘻嘻的大眼睛的脸","脸","快乐","喜悦","哈哈",":D",":)","微笑","有趣","face","happy","joy","haha",":D",":)","smile","funny"],k:[30,38],l:["=)","=-)"],m:":)",o:2},earth_asia:{a:"Earth Globe Asia-Australia",b:"1F30F",d:!0,e:!0,f:!0,h:!0,j:["地球仪显示亚澳","球","世界","东","国际","globe","world","east","international"],k:[5,34],o:2},crossed_flags:{a:"Crossed Flags",b:"1F38C",d:!0,e:!0,f:!0,h:!0,j:["交叉旗帜","日语","国家","国家","边境","japanese","nation","country","border"],k:[7,48],o:2},watermelon:{a:"Watermelon",b:"1F349",d:!0,e:!0,f:!0,h:!0,j:["西瓜","水果","食物","野餐","夏天","fruit","food","picnic","summer"],k:[6,33],o:2},goggles:{a:"Goggles",b:"1F97D",d:!0,e:!0,f:!0,h:!0,k:[42,15],o:11,j:["护目镜"]},raised_hand_with_fingers_splayed:{skin_variations:{"1F3FB":{unified:"1F590-1F3FB",non_qualified:null,image:"1f590-1f3fb.png",sheet_x:29,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F590-1F3FC",non_qualified:null,image:"1f590-1f3fc.png",sheet_x:29,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F590-1F3FD",non_qualified:null,image:"1f590-1f3fd.png",sheet_x:29,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F590-1F3FE",non_qualified:null,image:"1f590-1f3fe.png",sheet_x:29,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F590-1F3FF",non_qualified:null,image:"1f590-1f3ff.png",sheet_x:29,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Hand with Fingers Splayed",b:"1F590-FE0F",c:"1F590",d:!0,e:!0,f:!0,h:!0,j:["张开的手掌","手","手指","手掌","hand","fingers","palm"],k:[29,48],o:2},smile:{a:"Smiling Face with Open Mouth and Smiling Eyes",b:"1F604",d:!0,e:!0,f:!0,h:!0,j:["笑嘻嘻的脸","脸","快乐","喜悦","有趣","哈哈","笑","喜欢",":D",":)","face","happy","joy","funny","haha","laugh","like",":D",":)"],k:[30,39],l:["C:","c:",":D",":-D"],m:":)",o:2},potable_water:{a:"Potable Water Symbol",b:"1F6B0",d:!0,e:!0,f:!0,h:!0,j:["饮用水","蓝色方块","液","厕所","清洗","龙头","blue-square","liquid","restroom","cleaning","faucet"],k:[35,7],o:2},fireworks:{a:"Fireworks",b:"1F386",d:!0,e:!0,f:!0,h:!0,j:["烟花","相片","节日","狂欢节","祝贺","photo","festival","carnival","congratulations"],k:[7,42],o:2},gorilla:{a:"Gorilla",b:"1F98D",d:!0,e:!0,f:!0,h:!0,j:["大猩猩","动物","自然界","马戏团","animal","nature","circus"],k:[42,31],o:4},lab_coat:{a:"Lab Coat",b:"1F97C",d:!0,e:!0,f:!0,h:!0,k:[42,14],o:11,j:["实验工作服"]},tangerine:{a:"Tangerine",b:"1F34A",d:!0,e:!0,f:!0,h:!0,j:["柑橘","食物","水果","自然界","橙","food","fruit","nature","orange"],k:[6,34],o:2},wheelchair:{a:"Wheelchair Symbol",b:"267F",d:!0,e:!0,f:!0,h:!0,j:["轮椅标志","蓝色方块","禁用","a11y","可及性","blue-square","disabled","a11y","accessibility"],k:[53,40],o:2},waving_black_flag:{a:"Waving Black Flag",b:"1F3F4",d:!0,e:!0,f:!0,h:!0,k:[11,17],o:2,j:["黑旗"]},orangutan:{a:"Orangutan",b:"1F9A7",d:!0,e:!0,f:!0,h:!0,k:[42,55],o:12,j:["猩猩"]},sparkler:{a:"Firework Sparkler",b:"1F387",d:!0,e:!0,f:!0,h:!0,j:["烟火","星星","晚上","照","stars","night","shine"],k:[7,43],o:2},globe_with_meridians:{a:"Globe with Meridians",b:"1F310",d:!0,e:!0,f:!0,h:!0,j:["带经纬线的地球","地球","国际","世界","互联网","互联网络","i18n","earth","international","world","internet","interweb","i18n"],k:[5,35],o:2},grin:{a:"Grinning Face with Smiling Eyes",b:"1F601",d:!0,e:!0,f:!0,h:!0,j:["喜气洋洋的脸","脸","快乐","微笑","喜悦","卡哇伊","face","happy","smile","joy","kawaii"],k:[30,36],o:2},hand:{skin_variations:{"1F3FB":{unified:"270B-1F3FB",non_qualified:null,image:"270b-1f3fb.png",sheet_x:54,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"270B-1F3FC",non_qualified:null,image:"270b-1f3fc.png",sheet_x:54,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"270B-1F3FD",non_qualified:null,image:"270b-1f3fd.png",sheet_x:54,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"270B-1F3FE",non_qualified:null,image:"270b-1f3fe.png",sheet_x:54,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"270B-1F3FF",non_qualified:null,image:"270b-1f3ff.png",sheet_x:54,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Hand",b:"270B",d:!0,e:!0,f:!0,h:!0,k:[54,49],n:["raised_hand"],o:2,j:["举手"]},firecracker:{a:"Firecracker",b:"1F9E8",d:!0,e:!0,f:!0,h:!0,k:[51,27],o:11,j:["鞭炮"]},lemon:{a:"Lemon",b:"1F34B",d:!0,e:!0,f:!0,h:!0,j:["柠檬","水果","自然界","fruit","nature"],k:[6,35],o:2},dog:{a:"Dog Face",b:"1F436",d:!0,e:!0,f:!0,h:!0,j:["狗脸","动物","朋友","自然界","汪","小狗","宠物","忠实","animal","friend","nature","woof","puppy","pet","faithful"],k:[12,26],o:2},mens:{a:"Mens Symbol",b:"1F6B9",d:!0,e:!0,f:!0,h:!0,j:["男厕所标志","厕所","厕所","厕所","蓝色方块","性","雄","toilet","restroom","wc","blue-square","gender","male"],k:[36,10],o:2},"spock-hand":{skin_variations:{"1F3FB":{unified:"1F596-1F3FB",non_qualified:null,image:"1f596-1f3fb.png",sheet_x:30,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F596-1F3FC",non_qualified:null,image:"1f596-1f3fc.png",sheet_x:30,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F596-1F3FD",non_qualified:null,image:"1f596-1f3fd.png",sheet_x:30,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F596-1F3FE",non_qualified:null,image:"1f596-1f3fe.png",sheet_x:30,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F596-1F3FF",non_qualified:null,image:"1f596-1f3ff.png",sheet_x:30,sheet_y:8,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Hand with Part Between Middle and Ring Fingers",b:"1F596",d:!0,e:!0,f:!0,h:!0,k:[30,3],o:2,j:["瓦肯举手礼"]},world_map:{a:"World Map",b:"1F5FA-FE0F",c:"1F5FA",d:!0,e:!0,f:!0,h:!0,j:["世界地图","位置","方向","location","direction"],k:[30,29],o:2},laughing:{a:"Smiling Face with Open Mouth and Tightly-Closed Eyes",b:"1F606",d:!0,e:!0,f:!0,h:!0,j:["眯眼笑着的脸","快乐","喜悦","大声笑","满意","哈哈","脸","高兴","断续器","笑","happy","joy","lol","satisfied","haha","face","glad","XD","laugh"],k:[30,41],l:[":>",":->"],n:["satisfied"],o:2},waving_white_flag:{a:"Waving White Flag",b:"1F3F3-FE0F",c:"1F3F3",d:!0,e:!0,f:!0,h:!0,k:[11,12],o:2,j:["白旗"]},safety_vest:{a:"Safety Vest",b:"1F9BA",d:!0,e:!0,f:!0,h:!0,k:[43,54],o:12,j:["安全背心"]},sweat_smile:{a:"Smiling Face with Open Mouth and Cold Sweat",b:"1F605",d:!0,e:!0,f:!0,h:!0,j:["尴尬脸","脸","热","快乐","笑","汗","微笑","救济","face","hot","happy","laugh","sweat","smile","relief"],k:[30,40],o:2},sparkles:{a:"Sparkles",b:"2728",d:!0,e:!0,f:!0,h:!0,j:["闪闪发光","星星","照","闪亮","凉","棒","好","魔法","stars","shine","shiny","cool","awesome","good","magic"],k:[55,16],o:2},banana:{a:"Banana",b:"1F34C",d:!0,e:!0,f:!0,h:!0,j:["香蕉","水果","食物","猴子","fruit","food","monkey"],k:[6,36],o:2},"rainbow-flag":{a:"Rainbow Flag",b:"1F3F3-FE0F-200D-1F308",c:"1F3F3-200D-1F308",d:!0,e:!0,f:!0,h:!0,k:[11,11],o:4,j:["彩虹旗"]},ok_hand:{skin_variations:{"1F3FB":{unified:"1F44C-1F3FB",non_qualified:null,image:"1f44c-1f3fb.png",sheet_x:13,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44C-1F3FC",non_qualified:null,image:"1f44c-1f3fc.png",sheet_x:13,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44C-1F3FD",non_qualified:null,image:"1f44c-1f3fd.png",sheet_x:13,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44C-1F3FE",non_qualified:null,image:"1f44c-1f3fe.png",sheet_x:13,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44C-1F3FF",non_qualified:null,image:"1f44c-1f3ff.png",sheet_x:13,sheet_y:37,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Ok Hand Sign",b:"1F44C",d:!0,e:!0,f:!0,h:!0,j:["OK手势","手指","四肢","完善","还行","好","fingers","limbs","perfect","ok","okay"],k:[13,32],o:2},japan:{a:"Silhouette of Japan",b:"1F5FE",d:!0,e:!0,f:!0,h:!0,j:["地图日本","国家","国家","日语","亚洲","nation","country","japanese","asia"],k:[30,33],o:2},dog2:{a:"Dog",b:"1F415",d:!0,e:!0,f:!0,h:!0,j:["狗","动物","自然界","朋友","总督","宠物","忠实","animal","nature","friend","doge","pet","faithful"],k:[11,50],o:2},womens:{a:"Womens Symbol",b:"1F6BA",d:!0,e:!0,f:!0,h:!0,j:["女厕所标志","紫色方块","女人","女性","厕所","洗手间","厕所","性","purple-square","woman","female","toilet","loo","restroom","gender"],k:[36,11],o:2},necktie:{a:"Necktie",b:"1F454",d:!0,e:!0,f:!0,h:!0,j:["领带","衬衫","西装革履","正式","时尚","布","商","shirt","suitup","formal","fashion","cloth","business"],k:[14,8],o:2},pirate_flag:{a:"Pirate Flag",b:"1F3F4-200D-2620-FE0F",c:"1F3F4-200D-2620",d:!0,e:!0,f:!0,h:!0,k:[11,13],o:11,j:["海盗旗"]},guide_dog:{a:"Guide Dog",b:"1F9AE",d:!0,e:!0,f:!0,h:!0,k:[43,2],o:12,j:["导盲犬"]},restroom:{a:"Restroom",b:"1F6BB",d:!0,e:!0,f:!0,h:!0,j:["卫生间标志","蓝色方块","厕所","刷新","厕所","性","blue-square","toilet","refresh","wc","gender"],k:[36,12],o:2},compass:{a:"Compass",b:"1F9ED",d:!0,e:!0,f:!0,h:!0,k:[51,32],o:11,j:["罗盘"]},rolling_on_the_floor_laughing:{a:"Rolling on the Floor Laughing",b:"1F923",d:!0,e:!0,f:!0,h:!0,k:[38,20],o:4,j:["在地上打滚大笑"]},balloon:{a:"Balloon",b:"1F388",d:!0,e:!0,f:!0,h:!0,j:["气球","党","庆祝","生日","马戏团","party","celebration","birthday","circus"],k:[7,44],o:2},pinching_hand:{skin_variations:{"1F3FB":{unified:"1F90F-1F3FB",non_qualified:null,image:"1f90f-1f3fb.png",sheet_x:37,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F90F-1F3FC",non_qualified:null,image:"1f90f-1f3fc.png",sheet_x:37,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F90F-1F3FD",non_qualified:null,image:"1f90f-1f3fd.png",sheet_x:37,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F90F-1F3FE",non_qualified:null,image:"1f90f-1f3fe.png",sheet_x:37,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F90F-1F3FF",non_qualified:null,image:"1f90f-1f3ff.png",sheet_x:37,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Pinching Hand",b:"1F90F",d:!0,e:!0,f:!0,h:!0,k:[37,17],o:12,j:["捏手"]},pineapple:{a:"Pineapple",b:"1F34D",d:!0,e:!0,f:!0,h:!0,j:["菠萝","水果","自然界","食物","fruit","nature","food"],k:[6,37],o:2},shirt:{a:"T-Shirt",b:"1F455",d:!0,e:!0,f:!0,h:!0,k:[14,9],n:["tshirt"],o:2,j:["T恤"]},service_dog:{a:"Service Dog",b:"1F415-200D-1F9BA",d:!0,e:!0,f:!0,h:!0,k:[11,49],o:12,j:["服务犬"]},baby_symbol:{a:"Baby Symbol",b:"1F6BC",d:!0,e:!0,f:!0,h:!0,j:["育婴室标志","橙色方块","孩子","orange-square","child"],k:[36,13],o:2},joy:{a:"Face with Tears of Joy",b:"1F602",d:!0,e:!0,f:!0,h:!0,j:["笑Cry脸","脸","哭","眼泪","哭","快乐","快乐的茶","哈哈","face","cry","tears","weep","happy","happytears","haha"],k:[30,37],o:2},tada:{a:"Party Popper",b:"1F389",d:!0,e:!0,f:!0,h:!0,j:["派对礼花","党","祝贺","生日","魔法","马戏团","庆祝","party","congratulations","birthday","magic","circus","celebration"],k:[7,45],o:2},mango:{a:"Mango",b:"1F96D",d:!0,e:!0,f:!0,h:!0,k:[42,3],o:11,j:["芒果"]},v:{skin_variations:{"1F3FB":{unified:"270C-1F3FB",non_qualified:null,image:"270c-1f3fb.png",sheet_x:54,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"270C-1F3FC",non_qualified:null,image:"270c-1f3fc.png",sheet_x:55,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"270C-1F3FD",non_qualified:null,image:"270c-1f3fd.png",sheet_x:55,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"270C-1F3FE",non_qualified:null,image:"270c-1f3fe.png",sheet_x:55,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"270C-1F3FF",non_qualified:null,image:"270c-1f3ff.png",sheet_x:55,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Victory Hand",b:"270C-FE0F",c:"270C",d:!0,e:!0,f:!0,h:!0,j:["剪刀手","手指","哦耶","手","和平","胜利","二","fingers","ohyeah","hand","peace","victory","two"],k:[54,55],o:2},snow_capped_mountain:{a:"Snow Capped Mountain",b:"1F3D4-FE0F",c:"1F3D4",d:!0,e:!0,f:!0,h:!0,k:[10,39],o:2,j:["雪山"]},"flag-ac":{a:"Ascension Island Flag",b:"1F1E6-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[0,31],o:2,j:["阿森松岛旗"]},jeans:{a:"Jeans",b:"1F456",d:!0,e:!0,f:!0,h:!0,j:["牛仔裤","时尚","购物","fashion","shopping"],k:[14,10],o:2},poodle:{a:"Poodle",b:"1F429",d:!0,e:!0,f:!0,h:!0,j:["贵宾犬","狗","动物","101","自然界","宠物","dog","animal","101","nature","pet"],k:[12,13],o:2},crossed_fingers:{skin_variations:{"1F3FB":{unified:"1F91E-1F3FB",non_qualified:null,image:"1f91e-1f3fb.png",sheet_x:38,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91E-1F3FC",non_qualified:null,image:"1f91e-1f3fc.png",sheet_x:38,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91E-1F3FD",non_qualified:null,image:"1f91e-1f3fd.png",sheet_x:38,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91E-1F3FE",non_qualified:null,image:"1f91e-1f3fe.png",sheet_x:38,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91E-1F3FF",non_qualified:null,image:"1f91e-1f3ff.png",sheet_x:38,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Hand with Index and Middle Fingers Crossed",b:"1F91E",d:!0,e:!0,f:!0,h:!0,j:["两指交叉","好","幸运","good","lucky"],k:[38,5],n:["hand_with_index_and_middle_fingers_crossed"],o:4},"flag-ad":{a:"Andorra Flag",b:"1F1E6-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[0,32],o:2,j:["安道尔国旗"]},slightly_smiling_face:{a:"Slightly Smiling Face",b:"1F642",d:!0,e:!0,f:!0,h:!0,j:["浅笑脸","脸","微笑","face","smile"],k:[31,44],l:[":)","(:",":-)"],o:2},apple:{a:"Red Apple",b:"1F34E",d:!0,e:!0,f:!0,h:!0,j:["红苹果","水果","苹果电脑","学校","fruit","mac","school"],k:[6,38],o:2},wc:{a:"Water Closet",b:"1F6BE",d:!0,e:!0,f:!0,h:!0,j:["盥洗室标志","厕所","厕所","蓝色方块","toilet","restroom","blue-square"],k:[36,15],o:2},scarf:{a:"Scarf",b:"1F9E3",d:!0,e:!0,f:!0,h:!0,k:[51,22],o:5,j:["围巾"]},mountain:{a:"Mountain",b:"26F0-FE0F",c:"26F0",d:!0,e:!0,f:!0,h:!0,j:["山","相片","自然界","环境","photo","nature","environment"],k:[54,11],o:2},confetti_ball:{a:"Confetti Ball",b:"1F38A",d:!0,e:!0,f:!0,h:!0,j:["五彩纸屑球","节日","党","生日","马戏团","festival","party","birthday","circus"],k:[7,46],o:2},i_love_you_hand_sign:{skin_variations:{"1F3FB":{unified:"1F91F-1F3FB",non_qualified:null,image:"1f91f-1f3fb.png",sheet_x:38,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91F-1F3FC",non_qualified:null,image:"1f91f-1f3fc.png",sheet_x:38,sheet_y:13,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91F-1F3FD",non_qualified:null,image:"1f91f-1f3fd.png",sheet_x:38,sheet_y:14,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91F-1F3FE",non_qualified:null,image:"1f91f-1f3fe.png",sheet_x:38,sheet_y:15,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91F-1F3FF",non_qualified:null,image:"1f91f-1f3ff.png",sheet_x:38,sheet_y:16,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"I Love You Hand Sign",b:"1F91F",d:!0,e:!0,f:!0,h:!0,k:[38,11],o:5,j:["爱你手势"]},wolf:{a:"Wolf Face",b:"1F43A",d:!0,e:!0,f:!0,h:!0,j:["狼","动物","自然界","野生","animal","nature","wild"],k:[12,30],o:2},gloves:{a:"Gloves",b:"1F9E4",d:!0,e:!0,f:!0,h:!0,k:[51,23],o:5,j:["手套"]},"flag-ae":{a:"United Arab Emirates Flag",b:"1F1E6-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[0,33],o:2,j:["阿拉伯联合酋长国国旗"]},upside_down_face:{a:"Upside-Down Face",b:"1F643",d:!0,e:!0,f:!0,h:!0,j:["倒置的脸","脸","翻转","憨","微笑","face","flipped","silly","smile"],k:[31,45],o:2},green_apple:{a:"Green Apple",b:"1F34F",d:!0,e:!0,f:!0,h:!0,j:["青苹果","水果","自然界","fruit","nature"],k:[6,39],o:2},passport_control:{a:"Passport Control",b:"1F6C2",d:!0,e:!0,f:!0,h:!0,j:["护照查验符号","习惯","蓝色方块","custom","blue-square"],k:[36,24],o:2},volcano:{a:"Volcano",b:"1F30B",d:!0,e:!0,f:!0,h:!0,j:["火山","相片","自然界","灾难","photo","nature","disaster"],k:[5,30],o:2},tanabata_tree:{a:"Tanabata Tree",b:"1F38B",d:!0,e:!0,f:!0,h:!0,j:["七夕树","植物","自然界","分支","夏天","plant","nature","branch","summer"],k:[7,47],o:2},customs:{a:"Customs",b:"1F6C3",d:!0,e:!0,f:!0,h:!0,j:["海关符号","护照","边境","蓝色方块","passport","border","blue-square"],k:[36,25],o:2},coat:{a:"Coat",b:"1F9E5",d:!0,e:!0,f:!0,h:!0,k:[51,24],o:5,j:["大衣"]},wink:{a:"Winking Face",b:"1F609",d:!0,e:!0,f:!0,h:!0,j:["眨眼微笑的脸","脸","快乐","调皮","秘密",";)","微笑","眼睛","face","happy","mischievous","secret",";)","smile","eye"],k:[30,44],l:[";)",";-)"],m:";)",o:2},bamboo:{a:"Pine Decoration",b:"1F38D",d:!0,e:!0,f:!0,h:!0,j:["松木装饰","植物","自然界","蔬菜","熊猫","pine_decoration","plant","nature","vegetable","panda","pine_decoration"],k:[7,49],o:2},"flag-af":{a:"Afghanistan Flag",b:"1F1E6-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[0,34],o:2,j:["阿富汗国旗"]},fox_face:{a:"Fox Face",b:"1F98A",d:!0,e:!0,f:!0,h:!0,j:["狐狸","动物","自然界","脸","animal","nature","face"],k:[42,28],o:4},pear:{a:"Pear",b:"1F350",d:!0,e:!0,f:!0,h:!0,j:["梨","水果","自然界","食物","fruit","nature","food"],k:[6,40],o:2},mount_fuji:{a:"Mount Fuji",b:"1F5FB",d:!0,e:!0,f:!0,h:!0,j:["富士山","相片","山","自然界","日语","photo","mountain","nature","japanese"],k:[30,30],o:2},the_horns:{skin_variations:{"1F3FB":{unified:"1F918-1F3FB",non_qualified:null,image:"1f918-1f3fb.png",sheet_x:37,sheet_y:32,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F918-1F3FC",non_qualified:null,image:"1f918-1f3fc.png",sheet_x:37,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F918-1F3FD",non_qualified:null,image:"1f918-1f3fd.png",sheet_x:37,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F918-1F3FE",non_qualified:null,image:"1f918-1f3fe.png",sheet_x:37,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F918-1F3FF",non_qualified:null,image:"1f918-1f3ff.png",sheet_x:37,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Sign of the Horns",b:"1F918",d:!0,e:!0,f:!0,h:!0,k:[37,31],n:["sign_of_the_horns"],o:2,j:["摇滚手势"]},call_me_hand:{skin_variations:{"1F3FB":{unified:"1F919-1F3FB",non_qualified:null,image:"1f919-1f3fb.png",sheet_x:37,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F919-1F3FC",non_qualified:null,image:"1f919-1f3fc.png",sheet_x:37,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F919-1F3FD",non_qualified:null,image:"1f919-1f3fd.png",sheet_x:37,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F919-1F3FE",non_qualified:null,image:"1f919-1f3fe.png",sheet_x:37,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F919-1F3FF",non_qualified:null,image:"1f919-1f3ff.png",sheet_x:37,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Call Me Hand",b:"1F919",d:!0,e:!0,f:!0,h:!0,j:["打电话手势","手","手势","hands","gesture"],k:[37,37],o:4},"flag-ag":{a:"Antigua & Barbuda Flag",b:"1F1E6-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[0,35],o:2,j:["安提瓜和巴布达国旗"]},raccoon:{a:"Raccoon",b:"1F99D",d:!0,e:!0,f:!0,h:!0,k:[42,47],o:11,j:["狸"]},dolls:{a:"Japanese Dolls",b:"1F38E",d:!0,e:!0,f:!0,h:!0,j:["日本娃娃","日语","玩具","和服","japanese","toy","kimono"],k:[7,50],o:2},blush:{a:"Smiling Face with Smiling Eyes",b:"1F60A",d:!0,e:!0,f:!0,h:!0,j:["笑眯眯的脸","脸","微笑","快乐","刷新","粉碎","尴尬","害羞","喜悦","face","smile","happy","flushed","crush","embarrassed","shy","joy"],k:[30,45],m:":)",o:2},peach:{a:"Peach",b:"1F351",d:!0,e:!0,f:!0,h:!0,j:["桃子","水果","自然界","食物","fruit","nature","food"],k:[6,41],o:2},baggage_claim:{a:"Baggage Claim",b:"1F6C4",d:!0,e:!0,f:!0,h:!0,j:["行李认领符号","蓝色方块","飞机场","运输","blue-square","airport","transport"],k:[36,26],o:2},socks:{a:"Socks",b:"1F9E6",d:!0,e:!0,f:!0,h:!0,k:[51,25],o:5,j:["袜子"]},camping:{a:"Camping",b:"1F3D5-FE0F",c:"1F3D5",d:!0,e:!0,f:!0,h:!0,j:["露营","相片","户外","帐篷","photo","outdoors","tent"],k:[10,40],o:2},dress:{a:"Dress",b:"1F457",d:!0,e:!0,f:!0,h:!0,j:["连衣裙","衣服","时尚","购物","clothes","fashion","shopping"],k:[14,11],o:2},beach_with_umbrella:{a:"Beach with Umbrella",b:"1F3D6-FE0F",c:"1F3D6",d:!0,e:!0,f:!0,h:!0,k:[10,41],o:2,j:["海滩伞"]},cherries:{a:"Cherries",b:"1F352",d:!0,e:!0,f:!0,h:!0,j:["樱桃","食物","水果","food","fruit"],k:[6,42],o:2},cat:{a:"Cat Face",b:"1F431",d:!0,e:!0,f:!0,h:!0,j:["猫脸","动物","猫叫声","自然界","宠物","小猫","animal","meow","nature","pet","kitten"],k:[12,21],o:2},point_left:{skin_variations:{"1F3FB":{unified:"1F448-1F3FB",non_qualified:null,image:"1f448-1f3fb.png",sheet_x:13,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F448-1F3FC",non_qualified:null,image:"1f448-1f3fc.png",sheet_x:13,sheet_y:10,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F448-1F3FD",non_qualified:null,image:"1f448-1f3fd.png",sheet_x:13,sheet_y:11,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F448-1F3FE",non_qualified:null,image:"1f448-1f3fe.png",sheet_x:13,sheet_y:12,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F448-1F3FF",non_qualified:null,image:"1f448-1f3ff.png",sheet_x:13,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Left Pointing Backhand Index",b:"1F448",d:!0,e:!0,f:!0,h:!0,j:["食指向左","方向","手指","手","左","direction","fingers","hand","left"],k:[13,8],o:2},left_luggage:{a:"Left Luggage",b:"1F6C5",d:!0,e:!0,f:!0,h:!0,j:["寄放行李符号","蓝色方块","旅行","blue-square","travel"],k:[36,27],o:2},"flag-ai":{a:"Anguilla Flag",b:"1F1E6-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[0,36],o:2,j:["安圭拉国旗"]},innocent:{a:"Smiling Face with Halo",b:"1F607",d:!0,e:!0,f:!0,h:!0,j:["头顶光环的笑脸","脸","天使","天堂","光环","face","angel","heaven","halo"],k:[30,42],o:2},flags:{a:"Carp Streamer",b:"1F38F",d:!0,e:!0,f:!0,h:!0,j:["鲤鱼旗","鱼","日语","小野堀","鲤鱼","旗帜","fish","japanese","koinobori","carp","banner"],k:[7,51],o:2},warning:{a:"Warning Sign",b:"26A0-FE0F",c:"26A0",d:!0,e:!0,f:!0,h:!0,j:["警告","惊叹号","维普","警报","错误","问题","问题","exclamation","wip","alert","error","problem","issue"],k:[53,50],o:2},strawberry:{a:"Strawberry",b:"1F353",d:!0,e:!0,f:!0,h:!0,j:["草莓","水果","食物","自然界","fruit","food","nature"],k:[6,43],o:2},point_right:{skin_variations:{"1F3FB":{unified:"1F449-1F3FB",non_qualified:null,image:"1f449-1f3fb.png",sheet_x:13,sheet_y:15,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F449-1F3FC",non_qualified:null,image:"1f449-1f3fc.png",sheet_x:13,sheet_y:16,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F449-1F3FD",non_qualified:null,image:"1f449-1f3fd.png",sheet_x:13,sheet_y:17,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F449-1F3FE",non_qualified:null,image:"1f449-1f3fe.png",sheet_x:13,sheet_y:18,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F449-1F3FF",non_qualified:null,image:"1f449-1f3ff.png",sheet_x:13,sheet_y:19,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Right Pointing Backhand Index",b:"1F449",d:!0,e:!0,f:!0,h:!0,j:["食指向右","手指","手","方向","右","fingers","hand","direction","right"],k:[13,14],o:2},desert:{a:"Desert",b:"1F3DC-FE0F",c:"1F3DC",d:!0,e:!0,f:!0,h:!0,j:["沙漠","相片","温暖","有效","photo","warm","saharah"],k:[10,47],o:2},kimono:{a:"Kimono",b:"1F458",d:!0,e:!0,f:!0,h:!0,j:["和服","连衣裙","时尚","女人","女性","日语","dress","fashion","women","female","japanese"],k:[14,12],o:2},"flag-al":{a:"Albania Flag",b:"1F1E6-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[0,37],o:2,j:["阿尔巴尼亚国旗"]},wind_chime:{a:"Wind Chime",b:"1F390",d:!0,e:!0,f:!0,h:!0,j:["风铃","自然界","东西","春天","钟","nature","ding","spring","bell"],k:[7,52],o:2},smiling_face_with_3_hearts:{a:"Smiling Face with Smiling Eyes and Three Hearts",b:"1F970",d:!0,e:!0,f:!0,h:!0,k:[42,6],o:11,j:["被爱的脸"]},cat2:{a:"Cat",b:"1F408",d:!0,e:!0,f:!0,h:!0,j:["猫","动物","猫叫声","宠物","猫","animal","meow","pet","cats"],k:[11,36],o:2},rice_scene:{a:"Moon Viewing Ceremony",b:"1F391",d:!0,e:!0,f:!0,h:!0,j:["赏月仪式","相片","日本","亚洲","月见","photo","japan","asia","tsukimi"],k:[7,53],o:2},heart_eyes:{a:"Smiling Face with Heart-Shaped Eyes",b:"1F60D",d:!0,e:!0,f:!0,h:!0,j:["眼冒爱心的脸","脸","爱","喜欢","感情","情人","迷恋","粉碎","心","face","love","like","affection","valentines","infatuation","crush","heart"],k:[30,48],o:2},sari:{a:"Sari",b:"1F97B",d:!0,e:!0,f:!0,h:!0,k:[42,13],o:12,j:["纱丽"]},"flag-am":{a:"Armenia Flag",b:"1F1E6-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[0,38],o:2,j:["亚美尼亚国旗"]},lion_face:{a:"Lion Face",b:"1F981",d:!0,e:!0,f:!0,h:!0,k:[42,19],o:2,j:["狮子"]},desert_island:{a:"Desert Island",b:"1F3DD-FE0F",c:"1F3DD",d:!0,e:!0,f:!0,h:!0,j:["沙漠荒岛","相片","热带","莫吉托","photo","tropical","mojito"],k:[10,48],o:2},point_up_2:{skin_variations:{"1F3FB":{unified:"1F446-1F3FB",non_qualified:null,image:"1f446-1f3fb.png",sheet_x:12,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F446-1F3FC",non_qualified:null,image:"1f446-1f3fc.png",sheet_x:12,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F446-1F3FD",non_qualified:null,image:"1f446-1f3fd.png",sheet_x:12,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F446-1F3FE",non_qualified:null,image:"1f446-1f3fe.png",sheet_x:13,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F446-1F3FF",non_qualified:null,image:"1f446-1f3ff.png",sheet_x:13,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Up Pointing Backhand Index",b:"1F446",d:!0,e:!0,f:!0,h:!0,j:["食指向上","手指","手","方向","向上","fingers","hand","direction","up"],k:[12,53],o:2},kiwifruit:{a:"Kiwifruit",b:"1F95D",d:!0,e:!0,f:!0,h:!0,k:[41,44],o:4,j:["猕猴桃"]},children_crossing:{a:"Children Crossing",b:"1F6B8",d:!0,e:!0,f:!0,h:!0,j:["孩童穿越","学校","警告","危险","标志","驾驶","黄色钻石","school","warning","danger","sign","driving","yellow-diamond"],k:[36,9],o:2},national_park:{a:"National Park",b:"1F3DE-FE0F",c:"1F3DE",d:!0,e:!0,f:!0,h:!0,j:["国家公园","相片","环境","自然界","photo","environment","nature"],k:[10,49],o:2},no_entry:{a:"No Entry",b:"26D4",d:!0,e:!0,f:!0,h:!0,j:["禁止入内","限制","安全","隐私","坏","否认","停","圈","limit","security","privacy","bad","denied","stop","circle"],k:[54,8],o:2},"one-piece_swimsuit":{a:"One-Piece Swimsuit",b:"1FA71",d:!0,e:!0,f:!0,h:!0,k:[51,52],o:12,j:["连身泳衣"]},tiger:{a:"Tiger Face",b:"1F42F",d:!0,e:!0,f:!0,h:!0,j:["老虎脸","动物","猫","危险","野生","自然界","吼","animal","cat","danger","wild","nature","roar"],k:[12,19],o:2},red_envelope:{a:"Red Gift Envelope",b:"1F9E7",d:!0,e:!0,f:!0,h:!0,k:[51,26],o:11,j:["红包"]},"star-struck":{a:"Grinning Face with Star Eyes",b:"1F929",d:!0,e:!0,f:!0,h:!0,k:[38,43],n:["grinning_face_with_star_eyes"],o:5,j:["明星来袭"]},middle_finger:{skin_variations:{"1F3FB":{unified:"1F595-1F3FB",non_qualified:null,image:"1f595-1f3fb.png",sheet_x:29,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F595-1F3FC",non_qualified:null,image:"1f595-1f3fc.png",sheet_x:29,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F595-1F3FD",non_qualified:null,image:"1f595-1f3fd.png",sheet_x:30,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F595-1F3FE",non_qualified:null,image:"1f595-1f3fe.png",sheet_x:30,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F595-1F3FF",non_qualified:null,image:"1f595-1f3ff.png",sheet_x:30,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Reversed Hand with Middle Finger Extended",b:"1F595",d:!0,e:!0,f:!0,h:!0,k:[29,54],n:["reversed_hand_with_middle_finger_extended"],o:2,j:["比中指"]},"flag-ao":{a:"Angola Flag",b:"1F1E6-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[0,39],o:2,j:["安哥拉国旗"]},tomato:{a:"Tomato",b:"1F345",d:!0,e:!0,f:!0,h:!0,j:["番茄","水果","蔬菜","自然界","食物","fruit","vegetable","nature","food"],k:[6,29],o:2},coconut:{a:"Coconut",b:"1F965",d:!0,e:!0,f:!0,h:!0,k:[41,52],o:5,j:["椰子"]},ribbon:{a:"Ribbon",b:"1F380",d:!0,e:!0,f:!0,h:!0,j:["丝带","装饰","粉红色","女孩","领结","decoration","pink","girl","bowtie"],k:[7,31],o:2},no_entry_sign:{a:"No Entry Sign",b:"1F6AB",d:!0,e:!0,f:!0,h:!0,j:["禁止符号","禁止","停","限制","否认","禁止","圈","forbid","stop","limit","denied","disallow","circle"],k:[35,2],o:2},point_down:{skin_variations:{"1F3FB":{unified:"1F447-1F3FB",non_qualified:null,image:"1f447-1f3fb.png",sheet_x:13,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F447-1F3FC",non_qualified:null,image:"1f447-1f3fc.png",sheet_x:13,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F447-1F3FD",non_qualified:null,image:"1f447-1f3fd.png",sheet_x:13,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F447-1F3FE",non_qualified:null,image:"1f447-1f3fe.png",sheet_x:13,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F447-1F3FF",non_qualified:null,image:"1f447-1f3ff.png",sheet_x:13,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Down Pointing Backhand Index",b:"1F447",d:!0,e:!0,f:!0,h:!0,j:["食指向下","手指","手","方向","下","fingers","hand","direction","down"],k:[13,2],o:2},"flag-aq":{a:"Antarctica Flag",b:"1F1E6-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[0,40],o:2,j:["南极洲旗"]},briefs:{a:"Briefs",b:"1FA72",d:!0,e:!0,f:!0,h:!0,k:[51,53],o:12,j:["三角泳裤"]},kissing_heart:{a:"Face Throwing a Kiss",b:"1F618",d:!0,e:!0,f:!0,h:!0,j:["飞吻的脸","脸","爱","喜欢","感情","情人","迷恋","吻","face","love","like","affection","valentines","infatuation","kiss"],k:[31,2],l:[":*",":-*"],o:2},tiger2:{a:"Tiger",b:"1F405",d:!0,e:!0,f:!0,h:!0,j:["虎","动物","自然界","吼","animal","nature","roar"],k:[11,33],o:2},stadium:{a:"Stadium",b:"1F3DF-FE0F",c:"1F3DF",d:!0,e:!0,f:!0,h:!0,j:["体育场","相片","地方","体育","音乐会","场地","photo","place","sports","concert","venue"],k:[10,50],o:2},leopard:{a:"Leopard",b:"1F406",d:!0,e:!0,f:!0,h:!0,j:["豹","动物","自然界","animal","nature"],k:[11,34],o:2},no_bicycles:{a:"No Bicycles",b:"1F6B3",d:!0,e:!0,f:!0,h:!0,j:["自行车禁行","骑 单车","禁止","圈","cyclist","prohibited","circle"],k:[35,10],o:2},kissing:{a:"Kissing Face",b:"1F617",d:!0,e:!0,f:!0,h:!0,j:["接吻的脸","爱","喜欢","脸","3","情人","迷恋","吻","love","like","face","3","valentines","infatuation","kiss"],k:[31,1],o:2},"flag-ar":{a:"Argentina Flag",b:"1F1E6-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[0,41],o:2,j:["阿根廷国旗"]},avocado:{a:"Avocado",b:"1F951",d:!0,e:!0,f:!0,h:!0,j:["牛油果","水果","食物","fruit","food"],k:[41,32],o:4},point_up:{skin_variations:{"1F3FB":{unified:"261D-1F3FB",non_qualified:null,image:"261d-1f3fb.png",sheet_x:53,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"261D-1F3FC",non_qualified:null,image:"261d-1f3fc.png",sheet_x:53,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"261D-1F3FD",non_qualified:null,image:"261d-1f3fd.png",sheet_x:53,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"261D-1F3FE",non_qualified:null,image:"261d-1f3fe.png",sheet_x:53,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"261D-1F3FF",non_qualified:null,image:"261d-1f3ff.png",sheet_x:53,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Up Pointing Index",b:"261D-FE0F",c:"261D",d:!0,e:!0,f:!0,h:!0,j:["食指向上","手","手指","方向","向上","hand","fingers","direction","up"],k:[53,2],o:2},gift:{a:"Wrapped Present",b:"1F381",d:!0,e:!0,f:!0,h:!0,j:["包装的礼物","目前","生日","圣诞节","圣诞","present","birthday","christmas","xmas"],k:[7,32],o:2},classical_building:{a:"Classical Building",b:"1F3DB-FE0F",c:"1F3DB",d:!0,e:!0,f:!0,h:!0,j:["古典建筑","艺术","文化","历史","art","culture","history"],k:[10,46],o:2},shorts:{a:"Shorts",b:"1FA73",d:!0,e:!0,f:!0,h:!0,k:[51,54],o:12,j:["短裤"]},"+1":{skin_variations:{"1F3FB":{unified:"1F44D-1F3FB",non_qualified:null,image:"1f44d-1f3fb.png",sheet_x:13,sheet_y:39,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44D-1F3FC",non_qualified:null,image:"1f44d-1f3fc.png",sheet_x:13,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44D-1F3FD",non_qualified:null,image:"1f44d-1f3fd.png",sheet_x:13,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44D-1F3FE",non_qualified:null,image:"1f44d-1f3fe.png",sheet_x:13,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44D-1F3FF",non_qualified:null,image:"1f44d-1f3ff.png",sheet_x:13,sheet_y:43,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Thumbs Up Sign",b:"1F44D",d:!0,e:!0,f:!0,h:!0,j:["比赞","竖起大拇指","是的","棒","好","同意","接受","凉","手","喜欢","thumbsup","yes","awesome","good","agree","accept","cool","hand","like"],k:[13,38],n:["thumbsup"],o:2},horse:{a:"Horse Face",b:"1F434",d:!0,e:!0,f:!0,h:!0,j:["马面","动物","棕色","自然界","animal","brown","nature"],k:[12,24],o:2},bikini:{a:"Bikini",b:"1F459",d:!0,e:!0,f:!0,h:!0,j:["比基尼泳装","游泳","女性","女人","女孩","时尚","海滩","夏天","swimming","female","woman","girl","fashion","beach","summer"],k:[14,13],o:2},no_smoking:{a:"No Smoking Symbol",b:"1F6AD",d:!0,e:!0,f:!0,h:!0,j:["禁止抽烟","香烟","蓝色方块","气味","烟","cigarette","blue-square","smell","smoke"],k:[35,4],o:2},eggplant:{a:"Aubergine",b:"1F346",d:!0,e:!0,f:!0,h:!0,j:["茄子","蔬菜","自然界","食物","茄子","vegetable","nature","food","aubergine"],k:[6,30],o:2},"flag-as":{a:"American Samoa Flag",b:"1F1E6-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[0,42],o:2,j:["美属萨摩亚旗"]},reminder_ribbon:{a:"Reminder Ribbon",b:"1F397-FE0F",c:"1F397",d:!0,e:!0,f:!0,h:!0,j:["丝带","体育","原因","支持","意识","sports","cause","support","awareness"],k:[8,0],o:2},building_construction:{a:"Building Construction",b:"1F3D7-FE0F",c:"1F3D7",d:!0,e:!0,f:!0,h:!0,j:["建筑施工","维普","加工","进展","wip","working","progress"],k:[10,42],o:2},relaxed:{a:"White Smiling Face",b:"263A-FE0F",c:"263A",d:!0,e:!0,f:!0,h:!0,j:["微笑的脸","脸","脸红","按摩","幸福","face","blush","massage","happiness"],k:[53,17],o:2},kissing_closed_eyes:{a:"Kissing Face with Closed Eyes",b:"1F61A",d:!0,e:!0,f:!0,h:!0,j:["闭着眼睛接吻的脸","脸","爱","喜欢","感情","情人","迷恋","吻","face","love","like","affection","valentines","infatuation","kiss"],k:[31,4],o:2},"-1":{skin_variations:{"1F3FB":{unified:"1F44E-1F3FB",non_qualified:null,image:"1f44e-1f3fb.png",sheet_x:13,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44E-1F3FC",non_qualified:null,image:"1f44e-1f3fc.png",sheet_x:13,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44E-1F3FD",non_qualified:null,image:"1f44e-1f3fd.png",sheet_x:13,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44E-1F3FE",non_qualified:null,image:"1f44e-1f3fe.png",sheet_x:13,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44E-1F3FF",non_qualified:null,image:"1f44e-1f3ff.png",sheet_x:13,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Thumbs Down Sign",b:"1F44E",d:!0,e:!0,f:!0,h:!0,j:["倒赞","拇指下","不","讨厌","手","thumbsdown","no","dislike","hand"],k:[13,44],n:["thumbsdown"],o:2},admission_tickets:{a:"Admission Tickets",b:"1F39F-FE0F",c:"1F39F",d:!0,e:!0,f:!0,h:!0,k:[8,5],o:2,j:["门票"]},"flag-at":{a:"Austria Flag",b:"1F1E6-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[0,43],o:2,j:["奥地利国旗"]},womans_clothes:{a:"Womans Clothes",b:"1F45A",d:!0,e:!0,f:!0,h:!0,j:["衬衫","时尚","shopping_bags","女性","fashion","shopping_bags","female"],k:[14,14],o:2},do_not_litter:{a:"Do Not Litter Symbol",b:"1F6AF",d:!0,e:!0,f:!0,h:!0,j:["不乱扔垃圾","垃圾","是","垃圾","圈","trash","bin","garbage","circle"],k:[35,6],o:2},potato:{a:"Potato",b:"1F954",d:!0,e:!0,f:!0,h:!0,j:["土豆","食物","块茎","可素食","淀粉","food","tuber","vegatable","starch"],k:[41,35],o:4},racehorse:{a:"Horse",b:"1F40E",d:!0,e:!0,f:!0,h:!0,j:["马","动物","赌博","运气","animal","gamble","luck"],k:[11,42],o:2},bricks:{a:"Brick",b:"1F9F1",d:!0,e:!0,f:!0,h:!0,k:[51,36],o:11,j:["砖"]},fist:{skin_variations:{"1F3FB":{unified:"270A-1F3FB",non_qualified:null,image:"270a-1f3fb.png",sheet_x:54,sheet_y:44,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"270A-1F3FC",non_qualified:null,image:"270a-1f3fc.png",sheet_x:54,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"270A-1F3FD",non_qualified:null,image:"270a-1f3fd.png",sheet_x:54,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"270A-1F3FE",non_qualified:null,image:"270a-1f3fe.png",sheet_x:54,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"270A-1F3FF",non_qualified:null,image:"270a-1f3ff.png",sheet_x:54,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Raised Fist",b:"270A",d:!0,e:!0,f:!0,h:!0,j:["举拳","手指","手","把握","fingers","hand","grasp"],k:[54,43],o:2},house_buildings:{a:"House Buildings",b:"1F3D8-FE0F",c:"1F3D8",d:!0,e:!0,f:!0,h:!0,k:[10,43],o:2,j:["房屋群"]},carrot:{a:"Carrot",b:"1F955",d:!0,e:!0,f:!0,h:!0,j:["胡萝卜","蔬菜","食物","橙","vegetable","food","orange"],k:[41,36],o:4},ticket:{a:"Ticket",b:"1F3AB",d:!0,e:!0,f:!0,h:!0,j:["票","事件","音乐会","通过","event","concert","pass"],k:[8,17],o:2},"flag-au":{a:"Australia Flag",b:"1F1E6-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[0,44],o:2,j:["澳大利亚国旗"]},"non-potable_water":{a:"Non-Potable Water Symbol",b:"1F6B1",d:!0,e:!0,f:!0,h:!0,j:["非饮用水","喝","龙头","水龙头","圈","drink","faucet","tap","circle"],k:[35,8],o:2},purse:{a:"Purse",b:"1F45B",d:!0,e:!0,f:!0,h:!0,j:["钱包","时尚","辅料","钱","销售","购物","fashion","accessories","money","sales","shopping"],k:[14,15],o:2},unicorn_face:{a:"Unicorn Face",b:"1F984",d:!0,e:!0,f:!0,h:!0,k:[42,22],o:2,j:["独角兽"]},kissing_smiling_eyes:{a:"Kissing Face with Smiling Eyes",b:"1F619",d:!0,e:!0,f:!0,h:!0,j:["含笑亲吻表情","脸","感情","情人","迷恋","吻","face","affection","valentines","infatuation","kiss"],k:[31,3],o:2},facepunch:{skin_variations:{"1F3FB":{unified:"1F44A-1F3FB",non_qualified:null,image:"1f44a-1f3fb.png",sheet_x:13,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44A-1F3FC",non_qualified:null,image:"1f44a-1f3fc.png",sheet_x:13,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44A-1F3FD",non_qualified:null,image:"1f44a-1f3fd.png",sheet_x:13,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44A-1F3FE",non_qualified:null,image:"1f44a-1f3fe.png",sheet_x:13,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44A-1F3FF",non_qualified:null,image:"1f44a-1f3ff.png",sheet_x:13,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Fisted Hand Sign",b:"1F44A",d:!0,e:!0,f:!0,h:!0,j:["伸出直拳","生气","暴力","拳头","打","攻击","手","angry","violence","fist","hit","attack","hand"],k:[13,20],n:["punch"],o:2},medal:{a:"Medal",b:"1F396-FE0F",c:"1F396",d:!0,e:!0,f:!0,h:!0,k:[7,56],o:2,j:["军功徽章"]},zebra_face:{a:"Zebra Face",b:"1F993",d:!0,e:!0,f:!0,h:!0,k:[42,37],o:5,j:["斑马"]},handbag:{a:"Handbag",b:"1F45C",d:!0,e:!0,f:!0,h:!0,j:["手提包","时尚","附属品","辅料","购物","fashion","accessory","accessories","shopping"],k:[14,16],o:2},derelict_house_building:{a:"Derelict House Building",b:"1F3DA-FE0F",c:"1F3DA",d:!0,e:!0,f:!0,h:!0,k:[10,45],o:2,j:["废弃屋"]},yum:{a:"Face Savouring Delicious Food",b:"1F60B",d:!0,e:!0,f:!0,h:!0,j:["美味表情","快乐","喜悦","舌","微笑","脸","憨","美味","名字","美味","品尝","happy","joy","tongue","smile","face","silly","yummy","nom","delicious","savouring"],k:[30,46],o:2},corn:{a:"Ear of Maize",b:"1F33D",d:!0,e:!0,f:!0,h:!0,j:["玉米穗","食物","蔬菜","植物","food","vegetable","plant"],k:[6,21],o:2},"flag-aw":{a:"Aruba Flag",b:"1F1E6-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[0,45],o:2,j:["阿鲁巴国旗"]},no_pedestrians:{a:"No Pedestrians",b:"1F6B7",d:!0,e:!0,f:!0,h:!0,j:["行人禁止通行","规则","路口","走","圈","rules","crossing","walking","circle"],k:[36,8],o:2},house:{a:"House Building",b:"1F3E0",d:!0,e:!0,f:!0,h:!0,j:["房屋","建筑","家","building","home"],k:[10,51],o:2},hot_pepper:{a:"Hot Pepper",b:"1F336-FE0F",c:"1F336",d:!0,e:!0,f:!0,h:!0,j:["辣椒","食物","辣","辣椒","智利","food","spicy","chilli","chili"],k:[6,14],o:2},"flag-ax":{a:"Åland Islands Flag",b:"1F1E6-1F1FD",d:!0,e:!0,f:!0,h:!0,k:[0,46],o:2,j:["奥兰群岛旗"]},trophy:{a:"Trophy",b:"1F3C6",d:!0,e:!0,f:!0,h:!0,j:["奖杯","赢","奖","比赛","地方","英尺宽","仪式","win","award","contest","place","ftw","ceremony"],k:[9,26],o:2},deer:{a:"Deer",b:"1F98C",d:!0,e:!0,f:!0,h:!0,j:["鹿","动物","自然界","角","鹿肉","animal","nature","horns","venison"],k:[42,30],o:4},"left-facing_fist":{skin_variations:{"1F3FB":{unified:"1F91B-1F3FB",non_qualified:null,image:"1f91b-1f3fb.png",sheet_x:37,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91B-1F3FC",non_qualified:null,image:"1f91b-1f3fc.png",sheet_x:37,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91B-1F3FD",non_qualified:null,image:"1f91b-1f3fd.png",sheet_x:37,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91B-1F3FE",non_qualified:null,image:"1f91b-1f3fe.png",sheet_x:37,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91B-1F3FF",non_qualified:null,image:"1f91b-1f3ff.png",sheet_x:37,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Left-Facing Fist",b:"1F91B",d:!0,e:!0,f:!0,h:!0,k:[37,49],o:4,j:["伸出左拳"]},stuck_out_tongue:{a:"Face with Stuck-out Tongue",b:"1F61B",d:!0,e:!0,f:!0,h:!0,j:["吐舌","脸","恶作剧","幼稚","好玩","调皮","微笑","舌","face","prank","childish","playful","mischievous","smile","tongue"],k:[31,5],l:[":p",":-p",":P",":-P",":b",":-b"],m:":p",o:2},pouch:{a:"Pouch",b:"1F45D",d:!0,e:!0,f:!0,h:!0,j:["手拿包","袋","辅料","购物","bag","accessories","shopping"],k:[14,17],o:2},no_mobile_phones:{a:"No Mobile Phones",b:"1F4F5",d:!0,e:!0,f:!0,h:!0,j:["手机禁止","苹果手机","静音","圈","iphone","mute","circle"],k:[27,18],o:2},stuck_out_tongue_winking_eye:{a:"Face with Stuck-out Tongue and Winking Eye",b:"1F61C",d:!0,e:!0,f:!0,h:!0,j:["眨眼吐舌","脸","恶作剧","幼稚","好玩","调皮","微笑","眨眼","舌","face","prank","childish","playful","mischievous","smile","wink","tongue"],k:[31,6],l:[";p",";-p",";b",";-b",";P",";-P"],m:";p",o:2},sports_medal:{a:"Sports Medal",b:"1F3C5",d:!0,e:!0,f:!0,h:!0,k:[9,25],o:2,j:["体育奖章"]},cucumber:{a:"Cucumber",b:"1F952",d:!0,e:!0,f:!0,h:!0,j:["黄瓜","水果","食物","泡菜","fruit","food","pickle"],k:[41,33],o:4},cow:{a:"Cow Face",b:"1F42E",d:!0,e:!0,f:!0,h:!0,j:["奶牛脸","牛肉","牛","动物","自然界","哞","牛奶","beef","ox","animal","nature","moo","milk"],k:[12,18],o:2},underage:{a:"No One Under Eighteen Symbol",b:"1F51E",d:!0,e:!0,f:!0,h:!0,j:["未满十八","18","喝","酒馆","晚上","次要","圈","18","drink","pub","night","minor","circle"],k:[28,1],o:2},"flag-az":{a:"Azerbaijan Flag",b:"1F1E6-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[0,47],o:2,j:["阿塞拜疆国旗"]},shopping_bags:{a:"Shopping Bags",b:"1F6CD-FE0F",c:"1F6CD",d:!0,e:!0,f:!0,h:!0,k:[36,35],o:2,j:["购物袋"]},"right-facing_fist":{skin_variations:{"1F3FB":{unified:"1F91C-1F3FB",non_qualified:null,image:"1f91c-1f3fb.png",sheet_x:37,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F91C-1F3FC",non_qualified:null,image:"1f91c-1f3fc.png",sheet_x:38,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F91C-1F3FD",non_qualified:null,image:"1f91c-1f3fd.png",sheet_x:38,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F91C-1F3FE",non_qualified:null,image:"1f91c-1f3fe.png",sheet_x:38,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F91C-1F3FF",non_qualified:null,image:"1f91c-1f3ff.png",sheet_x:38,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Right-Facing Fist",b:"1F91C",d:!0,e:!0,f:!0,h:!0,k:[37,55],o:4,j:["伸出右拳"]},house_with_garden:{a:"House with Garden",b:"1F3E1",d:!0,e:!0,f:!0,h:!0,j:["带花园的房子","家","植物","自然界","home","plant","nature"],k:[10,52],o:2},clap:{skin_variations:{"1F3FB":{unified:"1F44F-1F3FB",non_qualified:null,image:"1f44f-1f3fb.png",sheet_x:13,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F44F-1F3FC",non_qualified:null,image:"1f44f-1f3fc.png",sheet_x:13,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F44F-1F3FD",non_qualified:null,image:"1f44f-1f3fd.png",sheet_x:13,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F44F-1F3FE",non_qualified:null,image:"1f44f-1f3fe.png",sheet_x:13,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F44F-1F3FF",non_qualified:null,image:"1f44f-1f3ff.png",sheet_x:13,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Clapping Hands Sign",b:"1F44F",d:!0,e:!0,f:!0,h:!0,j:["热烈拍手","手","赞美","掌声","恭喜","耶","hands","praise","applause","congrats","yay"],k:[13,50],o:2},leafy_green:{a:"Leafy Green",b:"1F96C",d:!0,e:!0,f:!0,h:!0,k:[42,2],o:11,j:["绿叶菜"]},office:{a:"Office Building",b:"1F3E2",d:!0,e:!0,f:!0,h:!0,j:["办公楼","建筑","局","工作","building","bureau","work"],k:[10,53],o:2},"flag-ba":{a:"Bosnia & Herzegovina Flag",b:"1F1E7-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[0,48],o:2,j:["波斯尼亚和黑塞哥维那国旗"]},zany_face:{a:"Grinning Face with One Large and One Small Eye",b:"1F92A",d:!0,e:!0,f:!0,h:!0,k:[38,44],n:["grinning_face_with_one_large_and_one_small_eye"],o:5,j:["滑稽的脸"]},first_place_medal:{a:"First Place Medal",b:"1F947",d:!0,e:!0,f:!0,h:!0,k:[41,22],o:4,j:["金牌"]},ox:{a:"Ox",b:"1F402",d:!0,e:!0,f:!0,h:!0,j:["牛","动物","牛","牛肉","animal","cow","beef"],k:[11,30],o:2},school_satchel:{a:"School Satchel",b:"1F392",d:!0,e:!0,f:!0,h:!0,j:["背包","学生","教育","袋","背包","student","education","bag","backpack"],k:[7,54],o:2},radioactive_sign:{a:"Radioactive Sign",b:"2622-FE0F",c:"2622",d:!0,e:!0,f:!0,h:!0,k:[53,9],o:2,j:["放射性的符号"]},second_place_medal:{a:"Second Place Medal",b:"1F948",d:!0,e:!0,f:!0,h:!0,k:[41,23],o:4,j:["银牌"]},stuck_out_tongue_closed_eyes:{a:"Face with Stuck-out Tongue and Tightly-Closed Eyes",b:"1F61D",d:!0,e:!0,f:!0,h:!0,j:["眯眼吐舌头","脸","恶作剧","好玩","调皮","微笑","舌","face","prank","playful","mischievous","smile","tongue"],k:[31,7],o:2},broccoli:{a:"Broccoli",b:"1F966",d:!0,e:!0,f:!0,h:!0,k:[41,53],o:5,j:["西兰花"]},biohazard_sign:{a:"Biohazard Sign",b:"2623-FE0F",c:"2623",d:!0,e:!0,f:!0,h:!0,k:[53,10],o:2,j:["生物危害符号"]},mans_shoe:{a:"Mans Shoe",b:"1F45E",d:!0,e:!0,f:!0,h:!0,j:["男鞋","时尚","雄","fashion","male"],k:[14,18],n:["shoe"],o:2},raised_hands:{skin_variations:{"1F3FB":{unified:"1F64C-1F3FB",non_qualified:null,image:"1f64c-1f3fb.png",sheet_x:33,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64C-1F3FC",non_qualified:null,image:"1f64c-1f3fc.png",sheet_x:33,sheet_y:10,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64C-1F3FD",non_qualified:null,image:"1f64c-1f3fd.png",sheet_x:33,sheet_y:11,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64C-1F3FE",non_qualified:null,image:"1f64c-1f3fe.png",sheet_x:33,sheet_y:12,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64C-1F3FF",non_qualified:null,image:"1f64c-1f3ff.png",sheet_x:33,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Person Raising Both Hands in Celebration",b:"1F64C",d:!0,e:!0,f:!0,h:!0,j:["举起双手","手势","万岁","是的","庆祝","手","gesture","hooray","yea","celebration","hands"],k:[33,8],o:2},post_office:{a:"Japanese Post Office",b:"1F3E3",d:!0,e:!0,f:!0,h:!0,j:["日本邮局","建筑","信封","通信","building","envelope","communication"],k:[10,54],o:2},"flag-bb":{a:"Barbados Flag",b:"1F1E7-1F1E7",d:!0,e:!0,f:!0,h:!0,k:[0,49],o:2,j:["巴巴多斯国旗"]},water_buffalo:{a:"Water Buffalo",b:"1F403",d:!0,e:!0,f:!0,h:!0,j:["水牛","动物","自然界","牛","牛","animal","nature","ox","cow"],k:[11,31],o:2},third_place_medal:{a:"Third Place Medal",b:"1F949",d:!0,e:!0,f:!0,h:!0,k:[41,24],o:4,j:["铜牌"]},european_post_office:{a:"European Post Office",b:"1F3E4",d:!0,e:!0,f:!0,h:!0,j:["邮政局","建筑","电子邮件","building","email"],k:[10,55],o:2},athletic_shoe:{a:"Athletic Shoe",b:"1F45F",d:!0,e:!0,f:!0,h:!0,j:["跑鞋","鞋","体育","球鞋","shoes","sports","sneakers"],k:[14,19],o:2},arrow_up:{a:"Upwards Black Arrow",b:"2B06-FE0F",c:"2B06",d:!0,e:!0,f:!0,h:!0,j:["向上箭头","蓝色方块","继续","返回页首","方向","blue-square","continue","top","direction"],k:[55,38],o:2},cow2:{a:"Cow",b:"1F404",d:!0,e:!0,f:!0,h:!0,j:["奶牛","牛肉","牛","动物","自然界","哞","牛奶","beef","ox","animal","nature","moo","milk"],k:[11,32],o:2},open_hands:{skin_variations:{"1F3FB":{unified:"1F450-1F3FB",non_qualified:null,image:"1f450-1f3fb.png",sheet_x:14,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F450-1F3FC",non_qualified:null,image:"1f450-1f3fc.png",sheet_x:14,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F450-1F3FD",non_qualified:null,image:"1f450-1f3fd.png",sheet_x:14,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F450-1F3FE",non_qualified:null,image:"1f450-1f3fe.png",sheet_x:14,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F450-1F3FF",non_qualified:null,image:"1f450-1f3ff.png",sheet_x:14,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Open Hands Sign",b:"1F450",d:!0,e:!0,f:!0,h:!0,j:["双手展开","手指","蝴蝶","手","打开","fingers","butterfly","hands","open"],k:[13,56],o:2},garlic:{a:"Garlic",b:"1F9C4",d:!0,e:!0,f:!0,h:!0,k:[44,12],o:12,j:["大蒜"]},money_mouth_face:{a:"Money-Mouth Face",b:"1F911",d:!0,e:!0,f:!0,h:!0,j:["吐钱脸","脸","富","美元","钱","face","rich","dollar","money"],k:[37,24],o:2},"flag-bd":{a:"Bangladesh Flag",b:"1F1E7-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[0,50],o:2,j:["孟加拉国国旗"]},soccer:{a:"Soccer Ball",b:"26BD",d:!0,e:!0,f:!0,h:!0,j:["足球","体育","足球","sports","football"],k:[53,56],o:2},hugging_face:{a:"Hugging Face",b:"1F917",d:!0,e:!0,f:!0,h:!0,k:[37,30],o:2,j:["拥抱脸"]},onion:{a:"Onion",b:"1F9C5",d:!0,e:!0,f:!0,h:!0,k:[44,13],o:12,j:["洋葱"]},arrow_upper_right:{a:"North East Arrow",b:"2197-FE0F",c:"2197",d:!0,e:!0,f:!0,h:!0,j:["右上方的箭头","蓝色方块","点","方向","对角","东北","blue-square","point","direction","diagonal","northeast"],k:[52,17],o:2},palms_up_together:{skin_variations:{"1F3FB":{unified:"1F932-1F3FB",non_qualified:null,image:"1f932-1f3fb.png",sheet_x:39,sheet_y:6,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F932-1F3FC",non_qualified:null,image:"1f932-1f3fc.png",sheet_x:39,sheet_y:7,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F932-1F3FD",non_qualified:null,image:"1f932-1f3fd.png",sheet_x:39,sheet_y:8,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F932-1F3FE",non_qualified:null,image:"1f932-1f3fe.png",sheet_x:39,sheet_y:9,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F932-1F3FF",non_qualified:null,image:"1f932-1f3ff.png",sheet_x:39,sheet_y:10,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Palms Up Together",b:"1F932",d:!0,e:!0,f:!0,h:!0,k:[39,5],o:5,j:["双手掌心向上"]},pig:{a:"Pig Face",b:"1F437",d:!0,e:!0,f:!0,h:!0,j:["猪脸","动物","猪的叫声","自然界","animal","oink","nature"],k:[12,27],o:2},hospital:{a:"Hospital",b:"1F3E5",d:!0,e:!0,f:!0,h:!0,j:["医院","建筑","健康","手术","医生","building","health","surgery","doctor"],k:[10,56],o:2},hiking_boot:{a:"Hiking Boot",b:"1F97E",d:!0,e:!0,f:!0,h:!0,k:[42,16],o:11,j:["徒步靴"]},"flag-be":{a:"Belgium Flag",b:"1F1E7-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[0,51],o:2,j:["比利时国旗"]},"flag-bf":{a:"Burkina Faso Flag",b:"1F1E7-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[0,52],o:2,j:["布基纳法索国旗"]},mushroom:{a:"Mushroom",b:"1F344",d:!0,e:!0,f:!0,h:!0,j:["蘑菇","植物","蔬菜","plant","vegetable"],k:[6,28],o:2},pig2:{a:"Pig",b:"1F416",d:!0,e:!0,f:!0,h:!0,j:["猪","动物","自然界","animal","nature"],k:[11,51],o:2},baseball:{a:"Baseball",b:"26BE",d:!0,e:!0,f:!0,h:!0,j:["棒球","体育","有种","sports","balls"],k:[54,0],o:2},face_with_hand_over_mouth:{a:"Smiling Face with Smiling Eyes and Hand Covering Mouth",b:"1F92D",d:!0,e:!0,f:!0,h:!0,k:[38,47],n:["smiling_face_with_smiling_eyes_and_hand_covering_mouth"],o:5,j:["捂嘴"]},handshake:{a:"Handshake",b:"1F91D",d:!0,e:!0,f:!0,h:!0,j:["握手","协议","摇","agreement","shake"],k:[38,4],o:4},womans_flat_shoe:{a:"Flat Shoe",b:"1F97F",d:!0,e:!0,f:!0,h:!0,k:[42,17],o:11,j:["平底鞋"]},bank:{a:"Bank",b:"1F3E6",d:!0,e:!0,f:!0,h:!0,j:["银行","建筑","钱","销售","现金","商","企业","building","money","sales","cash","business","enterprise"],k:[11,0],o:2},arrow_right:{a:"Black Rightwards Arrow",b:"27A1-FE0F",c:"27A1",d:!0,e:!0,f:!0,h:!0,j:["右箭头","蓝色方块","下一个","blue-square","next"],k:[55,32],o:2},peanuts:{a:"Peanuts",b:"1F95C",d:!0,e:!0,f:!0,h:!0,j:["花生","食物","坚果","food","nut"],k:[41,43],o:4},shushing_face:{a:"Face with Finger Covering Closed Lips",b:"1F92B",d:!0,e:!0,f:!0,h:!0,k:[38,45],n:["face_with_finger_covering_closed_lips"],o:5,j:["嘘脸"]},pray:{skin_variations:{"1F3FB":{unified:"1F64F-1F3FB",non_qualified:null,image:"1f64f-1f3fb.png",sheet_x:33,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64F-1F3FC",non_qualified:null,image:"1f64f-1f3fc.png",sheet_x:33,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64F-1F3FD",non_qualified:null,image:"1f64f-1f3fd.png",sheet_x:33,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64F-1F3FE",non_qualified:null,image:"1f64f-1f3fe.png",sheet_x:33,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64F-1F3FF",non_qualified:null,image:"1f64f-1f3ff.png",sheet_x:33,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Person with Folded Hands",b:"1F64F",d:!0,e:!0,f:!0,h:!0,j:["双手合十","请","希望","希望","纳马斯特","高五","please","hope","wish","namaste","highfive"],k:[33,50],o:2},softball:{a:"Softball",b:"1F94E",d:!0,e:!0,f:!0,h:!0,k:[41,29],o:11,j:["垒球"]},high_heel:{a:"High-Heeled Shoe",b:"1F460",d:!0,e:!0,f:!0,h:!0,j:["高跟鞋","时尚","鞋","女性","泵","细高跟鞋","fashion","shoes","female","pumps","stiletto"],k:[14,20],o:2},"flag-bg":{a:"Bulgaria Flag",b:"1F1E7-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[0,53],o:2,j:["保加利亚国旗"]},arrow_lower_right:{a:"South East Arrow",b:"2198-FE0F",c:"2198",d:!0,e:!0,f:!0,h:!0,j:["右下箭头","蓝色方块","方向","对角","东南","blue-square","direction","diagonal","southeast"],k:[52,18],o:2},hotel:{a:"Hotel",b:"1F3E8",d:!0,e:!0,f:!0,h:!0,j:["旅馆","建筑","住宿","签入","building","accomodation","checkin"],k:[11,2],o:2},boar:{a:"Boar",b:"1F417",d:!0,e:!0,f:!0,h:!0,j:["公猪","动物","自然界","animal","nature"],k:[11,52],o:2},sandal:{a:"Womans Sandal",b:"1F461",d:!0,e:!0,f:!0,h:!0,j:["女人的凉鞋","鞋","时尚","人字拖","shoes","fashion","flip flops"],k:[14,21],o:2},"flag-bh":{a:"Bahrain Flag",b:"1F1E7-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[0,54],o:2,j:["巴林国旗"]},arrow_down:{a:"Downwards Black Arrow",b:"2B07-FE0F",c:"2B07",d:!0,e:!0,f:!0,h:!0,j:["向下箭头","蓝色方块","方向","底","blue-square","direction","bottom"],k:[55,39],o:2},thinking_face:{a:"Thinking Face",b:"1F914",d:!0,e:!0,f:!0,h:!0,k:[37,27],o:2,j:["思考的脸"]},writing_hand:{skin_variations:{"1F3FB":{unified:"270D-1F3FB",non_qualified:null,image:"270d-1f3fb.png",sheet_x:55,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"270D-1F3FC",non_qualified:null,image:"270d-1f3fc.png",sheet_x:55,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"270D-1F3FD",non_qualified:null,image:"270d-1f3fd.png",sheet_x:55,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"270D-1F3FE",non_qualified:null,image:"270d-1f3fe.png",sheet_x:55,sheet_y:8,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"270D-1F3FF",non_qualified:null,image:"270d-1f3ff.png",sheet_x:55,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Writing Hand",b:"270D-FE0F",c:"270D",d:!0,e:!0,f:!0,h:!0,j:["用笔手写","lower_left_ballpoint_pen","文具","写","组成","lower_left_ballpoint_pen","stationery","write","compose"],k:[55,4],o:2},chestnut:{a:"Chestnut",b:"1F330",d:!0,e:!0,f:!0,h:!0,j:["板栗","食物","松鼠","food","squirrel"],k:[6,8],o:2},basketball:{a:"Basketball and Hoop",b:"1F3C0",d:!0,e:!0,f:!0,h:!0,j:["篮球","体育","有种","断续器","sports","balls","NBA"],k:[8,38],o:2},pig_nose:{a:"Pig Nose",b:"1F43D",d:!0,e:!0,f:!0,h:!0,j:["猪鼻子","动物","猪的叫声","animal","oink"],k:[12,33],o:2},love_hotel:{a:"Love Hotel",b:"1F3E9",d:!0,e:!0,f:!0,h:!0,j:["爱情酒店","喜欢","感情","约会","like","affection","dating"],k:[11,3],o:2},nail_care:{skin_variations:{"1F3FB":{unified:"1F485-1F3FB",non_qualified:null,image:"1f485-1f3fb.png",sheet_x:24,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F485-1F3FC",non_qualified:null,image:"1f485-1f3fc.png",sheet_x:24,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F485-1F3FD",non_qualified:null,image:"1f485-1f3fd.png",sheet_x:24,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F485-1F3FE",non_qualified:null,image:"1f485-1f3fe.png",sheet_x:24,sheet_y:37,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F485-1F3FF",non_qualified:null,image:"1f485-1f3ff.png",sheet_x:24,sheet_y:38,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Nail Polish",b:"1F485",d:!0,e:!0,f:!0,h:!0,j:["指甲美容","美","修指甲","手指","时尚","指甲","beauty","manicure","finger","fashion","nail"],k:[24,33],o:2},volleyball:{a:"Volleyball",b:"1F3D0",d:!0,e:!0,f:!0,h:!0,j:["排球","体育","有种","sports","balls"],k:[10,35],o:2},"flag-bi":{a:"Burundi Flag",b:"1F1E7-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[0,55],o:2,j:["布隆迪国旗"]},arrow_lower_left:{a:"South West Arrow",b:"2199-FE0F",c:"2199",d:!0,e:!0,f:!0,h:!0,j:["左下箭头","蓝色方块","方向","对角","西南","blue-square","direction","diagonal","southwest"],k:[52,19],o:2},ram:{a:"Ram",b:"1F40F",d:!0,e:!0,f:!0,h:!0,j:["公羊","动物","羊","自然界","animal","sheep","nature"],k:[11,43],o:2},ballet_shoes:{a:"Ballet Shoes",b:"1FA70",d:!0,e:!0,f:!0,h:!0,k:[51,51],o:12,j:["芭蕾舞鞋"]},zipper_mouth_face:{a:"Zipper-Mouth Face",b:"1F910",d:!0,e:!0,f:!0,h:!0,j:["拉链口的脸","脸","密封的","拉链","秘密","face","sealed","zipper","secret"],k:[37,23],o:2},bread:{a:"Bread",b:"1F35E",d:!0,e:!0,f:!0,h:!0,j:["面包","食物","小麦","早餐","吐司","food","wheat","breakfast","toast"],k:[6,54],o:2},convenience_store:{a:"Convenience Store",b:"1F3EA",d:!0,e:!0,f:!0,h:!0,j:["便利店","建筑","购物","杂货","building","shopping","groceries"],k:[11,4],o:2},boot:{a:"Womans Boots",b:"1F462",d:!0,e:!0,f:!0,h:!0,j:["女靴","鞋","时尚","shoes","fashion"],k:[14,22],o:2},sheep:{a:"Sheep",b:"1F411",d:!0,e:!0,f:!0,h:!0,j:["母羊","动物","自然界","羊毛","船舶","animal","nature","wool","shipit"],k:[11,45],o:2},face_with_raised_eyebrow:{a:"Face with One Eyebrow Raised",b:"1F928",d:!0,e:!0,f:!0,h:!0,k:[38,42],n:["face_with_one_eyebrow_raised"],o:5,j:["扬起眉毛的脸"]},"flag-bj":{a:"Benin Flag",b:"1F1E7-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[0,56],o:2,j:["贝宁国旗"]},arrow_left:{a:"Leftwards Black Arrow",b:"2B05-FE0F",c:"2B05",d:!0,e:!0,f:!0,h:!0,j:["左箭头","蓝色方块","以前","返回","blue-square","previous","back"],k:[55,37],o:2},selfie:{skin_variations:{"1F3FB":{unified:"1F933-1F3FB",non_qualified:null,image:"1f933-1f3fb.png",sheet_x:39,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F933-1F3FC",non_qualified:null,image:"1f933-1f3fc.png",sheet_x:39,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F933-1F3FD",non_qualified:null,image:"1f933-1f3fd.png",sheet_x:39,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F933-1F3FE",non_qualified:null,image:"1f933-1f3fe.png",sheet_x:39,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F933-1F3FF",non_qualified:null,image:"1f933-1f3ff.png",sheet_x:39,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Selfie",b:"1F933",d:!0,e:!0,f:!0,h:!0,j:["人拿着手机自拍","照相机","电话","camera","phone"],k:[39,11],o:4},croissant:{a:"Croissant",b:"1F950",d:!0,e:!0,f:!0,h:!0,j:["羊角面包","食物","面包","法语","food","bread","french"],k:[41,31],o:4},school:{a:"School",b:"1F3EB",d:!0,e:!0,f:!0,h:!0,j:["学校","建筑","学生","教育","学习","教","building","student","education","learn","teach"],k:[11,5],o:2},football:{a:"American Football",b:"1F3C8",d:!0,e:!0,f:!0,h:!0,j:["美式足球","体育","有种","美国国家橄榄球联盟","sports","balls","NFL"],k:[9,33],o:2},goat:{a:"Goat",b:"1F410",d:!0,e:!0,f:!0,h:!0,j:["山羊","动物","自然界","animal","nature"],k:[11,44],o:2},department_store:{a:"Department Store",b:"1F3EC",d:!0,e:!0,f:!0,h:!0,j:["百货商店","建筑","购物","商场","building","shopping","mall"],k:[11,6],o:2},"flag-bl":{a:"St. Barthélemy Flag",b:"1F1E7-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[1,0],o:2,j:["圣巴泰勒米旗"]},crown:{a:"Crown",b:"1F451",d:!0,e:!0,f:!0,h:!0,j:["王冠","王","在","领导","王权","主","king","kod","leader","royalty","lord"],k:[14,5],o:2},arrow_upper_left:{a:"North West Arrow",b:"2196-FE0F",c:"2196",d:!0,e:!0,f:!0,h:!0,j:["左上箭头","蓝色方块","点","方向","对角","西北","blue-square","point","direction","diagonal","northwest"],k:[52,16],o:2},neutral_face:{a:"Neutral Face",b:"1F610",d:!0,e:!0,f:!0,h:!0,j:["中性表情","冷漠","喵",":|","中性","indifference","meh",":|","neutral"],k:[30,51],l:[":|",":-|"],o:2},rugby_football:{a:"Rugby Football",b:"1F3C9",d:!0,e:!0,f:!0,h:!0,j:["橄榄球","体育","团队","sports","team"],k:[9,34],o:2},muscle:{skin_variations:{"1F3FB":{unified:"1F4AA-1F3FB",non_qualified:null,image:"1f4aa-1f3fb.png",sheet_x:25,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F4AA-1F3FC",non_qualified:null,image:"1f4aa-1f3fc.png",sheet_x:25,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F4AA-1F3FD",non_qualified:null,image:"1f4aa-1f3fd.png",sheet_x:25,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F4AA-1F3FE",non_qualified:null,image:"1f4aa-1f3fe.png",sheet_x:25,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F4AA-1F3FF",non_qualified:null,image:"1f4aa-1f3ff.png",sheet_x:26,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Flexed Biceps",b:"1F4AA",d:!0,e:!0,f:!0,h:!0,j:["二头肌","手臂","屈","手","夏天","强","二头肌","arm","flex","hand","summer","strong","biceps"],k:[25,52],o:2},baguette_bread:{a:"Baguette Bread",b:"1F956",d:!0,e:!0,f:!0,h:!0,j:["法式长棍面包","食物","面包","法语","food","bread","french"],k:[41,37],o:4},expressionless:{a:"Expressionless Face",b:"1F611",d:!0,e:!0,f:!0,h:!0,j:["面无表情的脸","脸","冷漠","-_-","喵","面 无 表情","face","indifferent","-_-","meh","deadpan"],k:[30,52],o:2},womans_hat:{a:"Womans Hat",b:"1F452",d:!0,e:!0,f:!0,h:!0,j:["女帽","时尚","辅料","女性","女士","春天","fashion","accessories","female","lady","spring"],k:[14,6],o:2},pretzel:{a:"Pretzel",b:"1F968",d:!0,e:!0,f:!0,h:!0,k:[41,55],o:5,j:["椒盐脆饼"]},mechanical_arm:{a:"Mechanical Arm",b:"1F9BE",d:!0,e:!0,f:!0,h:!0,k:[44,6],o:12,j:["机械手臂"]},arrow_up_down:{a:"Up Down Arrow",b:"2195-FE0F",c:"2195",d:!0,e:!0,f:!0,h:!0,j:["上下箭头","蓝色方块","方向","道路","垂直","blue-square","direction","way","vertical"],k:[52,15],o:2},dromedary_camel:{a:"Dromedary Camel",b:"1F42A",d:!0,e:!0,f:!0,h:!0,j:["骆驼","动物","热","沙漠","驼峰","animal","hot","desert","hump"],k:[12,14],o:2},tennis:{a:"Tennis Racquet and Ball",b:"1F3BE",d:!0,e:!0,f:!0,h:!0,j:["网球","体育","有种","绿","sports","balls","green"],k:[8,36],o:2},"flag-bm":{a:"Bermuda Flag",b:"1F1E7-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[1,1],o:2,j:["百慕大旗"]},factory:{a:"Factory",b:"1F3ED",d:!0,e:!0,f:!0,h:!0,j:["工厂","建筑","工业","污染","烟","building","industry","pollution","smoke"],k:[11,7],o:2},japanese_castle:{a:"Japanese Castle",b:"1F3EF",d:!0,e:!0,f:!0,h:!0,j:["日本城堡","相片","建筑","photo","building"],k:[11,9],o:2},no_mouth:{a:"Face Without Mouth",b:"1F636",d:!0,e:!0,f:!0,h:!0,j:["没嘴的脸","脸","你好凯蒂","face","hellokitty"],k:[31,32],o:2},mechanical_leg:{a:"Mechanical Leg",b:"1F9BF",d:!0,e:!0,f:!0,h:!0,k:[44,7],o:12,j:["机械腿"]},bagel:{a:"Bagel",b:"1F96F",d:!0,e:!0,f:!0,h:!0,k:[42,5],o:11,j:["贝果"]},camel:{a:"Bactrian Camel",b:"1F42B",d:!0,e:!0,f:!0,h:!0,j:["两个驼峰的骆驼","动物","自然界","热","沙漠","驼峰","animal","nature","hot","desert","hump"],k:[12,15],o:2},tophat:{a:"Top Hat",b:"1F3A9",d:!0,e:!0,f:!0,h:!0,j:["高帽","魔法","绅士","优雅","马戏团","magic","gentleman","classy","circus"],k:[8,15],o:2},left_right_arrow:{a:"Left Right Arrow",b:"2194-FE0F",c:"2194",d:!0,e:!0,f:!0,h:!0,j:["左右箭头","形状","方向","水平","侧身","shape","direction","horizontal","sideways"],k:[52,14],o:2},"flag-bn":{a:"Brunei Flag",b:"1F1E7-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[1,2],o:2,j:["文莱国旗"]},flying_disc:{a:"Flying Disc",b:"1F94F",d:!0,e:!0,f:!0,h:!0,k:[41,30],o:11,j:["飞盘"]},smirk:{a:"Smirking Face",b:"1F60F",d:!0,e:!0,f:!0,h:!0,j:["诡异笑的脸","脸","微笑","意味 着","恶作剧","洋洋得意","讽刺","face","smile","mean","prank","smug","sarcasm"],k:[30,50],o:2},mortar_board:{a:"Graduation Cap",b:"1F393",d:!0,e:!0,f:!0,h:!0,j:["毕业帽","学校","大学","度","大学","毕业","头","有","法律","学习","教育","school","college","degree","university","graduation","cap","hat","legal","learn","education"],k:[7,55],o:2},european_castle:{a:"European Castle",b:"1F3F0",d:!0,e:!0,f:!0,h:!0,j:["城堡","建筑","王权","历史","building","royalty","history"],k:[11,10],o:2},leg:{skin_variations:{"1F3FB":{unified:"1F9B5-1F3FB",non_qualified:null,image:"1f9b5-1f3fb.png",sheet_x:43,sheet_y:6,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B5-1F3FC",non_qualified:null,image:"1f9b5-1f3fc.png",sheet_x:43,sheet_y:7,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B5-1F3FD",non_qualified:null,image:"1f9b5-1f3fd.png",sheet_x:43,sheet_y:8,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B5-1F3FE",non_qualified:null,image:"1f9b5-1f3fe.png",sheet_x:43,sheet_y:9,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B5-1F3FF",non_qualified:null,image:"1f9b5-1f3ff.png",sheet_x:43,sheet_y:10,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Leg",b:"1F9B5",d:!0,e:!0,f:!0,h:!0,k:[43,5],o:11,j:["腿"]},pancakes:{a:"Pancakes",b:"1F95E",d:!0,e:!0,f:!0,h:!0,j:["煎饼","食物","早餐","烙饼","烤 饼","food","breakfast","flapjacks","hotcakes"],k:[41,45],o:4},leftwards_arrow_with_hook:{a:"Leftwards Arrow with Hook",b:"21A9-FE0F",c:"21A9",d:!0,e:!0,f:!0,h:!0,j:["右箭头向左弯曲","返回","返回","蓝色方块","撤消","进入","back","return","blue-square","undo","enter"],k:[52,20],o:2},"flag-bo":{a:"Bolivia Flag",b:"1F1E7-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[1,3],o:2,j:["玻利维亚国旗"]},bowling:{a:"Bowling",b:"1F3B3",d:!0,e:!0,f:!0,h:!0,j:["保龄球","体育","乐趣","玩","sports","fun","play"],k:[8,25],o:2},llama:{a:"Llama",b:"1F999",d:!0,e:!0,f:!0,h:!0,k:[42,43],o:11,j:["羊驼"]},arrow_right_hook:{a:"Rightwards Arrow with Hook",b:"21AA-FE0F",c:"21AA",d:!0,e:!0,f:!0,h:!0,j:["左箭头向右弯曲","蓝色方块","返回","旋转","方向","blue-square","return","rotate","direction"],k:[52,21],o:2},wedding:{a:"Wedding",b:"1F492",d:!0,e:!0,f:!0,h:!0,j:["婚礼","爱","喜欢","感情","夫妇","婚","新娘","新郎","love","like","affection","couple","marriage","bride","groom"],k:[25,28],o:2},"flag-bq":{a:"Caribbean Netherlands Flag",b:"1F1E7-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[1,4],o:2,j:["荷属加勒比旗"]},foot:{skin_variations:{"1F3FB":{unified:"1F9B6-1F3FB",non_qualified:null,image:"1f9b6-1f3fb.png",sheet_x:43,sheet_y:12,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B6-1F3FC",non_qualified:null,image:"1f9b6-1f3fc.png",sheet_x:43,sheet_y:13,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B6-1F3FD",non_qualified:null,image:"1f9b6-1f3fd.png",sheet_x:43,sheet_y:14,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B6-1F3FE",non_qualified:null,image:"1f9b6-1f3fe.png",sheet_x:43,sheet_y:15,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B6-1F3FF",non_qualified:null,image:"1f9b6-1f3ff.png",sheet_x:43,sheet_y:16,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Foot",b:"1F9B6",d:!0,e:!0,f:!0,h:!0,k:[43,11],o:11,j:["脚丫"]},giraffe_face:{a:"Giraffe Face",b:"1F992",d:!0,e:!0,f:!0,h:!0,k:[42,36],o:5,j:["长颈鹿"]},unamused:{a:"Unamused Face",b:"1F612",d:!0,e:!0,f:!0,h:!0,j:["一脸不快的脸","冷漠","无聊","直面","严重","讽刺","indifference","bored","straight face","serious","sarcasm"],k:[30,53],m:":(",o:2},billed_cap:{a:"Billed Cap",b:"1F9E2",d:!0,e:!0,f:!0,h:!0,k:[51,21],o:5,j:["棒球帽"]},waffle:{a:"Waffle",b:"1F9C7",d:!0,e:!0,f:!0,h:!0,k:[44,15],o:12,j:["松饼"]},cricket_bat_and_ball:{a:"Cricket Bat and Ball",b:"1F3CF",d:!0,e:!0,f:!0,h:!0,k:[10,34],o:2,j:["板球"]},helmet_with_white_cross:{a:"Helmet with White Cross",b:"26D1-FE0F",c:"26D1",d:!0,e:!0,f:!0,h:!0,k:[54,6],o:2,j:["救援头盔"]},ear:{skin_variations:{"1F3FB":{unified:"1F442-1F3FB",non_qualified:null,image:"1f442-1f3fb.png",sheet_x:12,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F442-1F3FC",non_qualified:null,image:"1f442-1f3fc.png",sheet_x:12,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F442-1F3FD",non_qualified:null,image:"1f442-1f3fd.png",sheet_x:12,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F442-1F3FE",non_qualified:null,image:"1f442-1f3fe.png",sheet_x:12,sheet_y:43,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F442-1F3FF",non_qualified:null,image:"1f442-1f3ff.png",sheet_x:12,sheet_y:44,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Ear",b:"1F442",d:!0,e:!0,f:!0,h:!0,j:["耳朵","脸","听见","声音","听","face","hear","sound","listen"],k:[12,39],o:2},elephant:{a:"Elephant",b:"1F418",d:!0,e:!0,f:!0,h:!0,j:["象","动物","自然界","鼻子","千","马戏团","animal","nature","nose","th","circus"],k:[11,53],o:2},cheese_wedge:{a:"Cheese Wedge",b:"1F9C0",d:!0,e:!0,f:!0,h:!0,k:[44,8],o:2,j:["奶酪楔"]},tokyo_tower:{a:"Tokyo Tower",b:"1F5FC",d:!0,e:!0,f:!0,h:!0,j:["东京铁塔","相片","日语","photo","japanese"],k:[30,31],o:2},arrow_heading_up:{a:"Arrow Pointing Rightwards Then Curving Upwards",b:"2934-FE0F",c:"2934",d:!0,e:!0,f:!0,h:!0,j:["右箭头向上弯曲","蓝色方块","方向","返回页首","blue-square","direction","top"],k:[55,35],o:2},field_hockey_stick_and_ball:{a:"Field Hockey Stick and Ball",b:"1F3D1",d:!0,e:!0,f:!0,h:!0,k:[10,36],o:2,j:["曲棍球"]},"flag-br":{a:"Brazil Flag",b:"1F1E7-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[1,5],o:2,j:["巴西国旗"]},face_with_rolling_eyes:{a:"Face with Rolling Eyes",b:"1F644",d:!0,e:!0,f:!0,h:!0,k:[31,46],o:2,j:["翻白眼的脸"]},ear_with_hearing_aid:{skin_variations:{"1F3FB":{unified:"1F9BB-1F3FB",non_qualified:null,image:"1f9bb-1f3fb.png",sheet_x:43,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9BB-1F3FC",non_qualified:null,image:"1f9bb-1f3fc.png",sheet_x:44,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9BB-1F3FD",non_qualified:null,image:"1f9bb-1f3fd.png",sheet_x:44,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9BB-1F3FE",non_qualified:null,image:"1f9bb-1f3fe.png",sheet_x:44,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9BB-1F3FF",non_qualified:null,image:"1f9bb-1f3ff.png",sheet_x:44,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Ear with Hearing Aid",b:"1F9BB",d:!0,e:!0,f:!0,h:!0,k:[43,55],o:12,j:["佩戴助听器的耳朵"]},arrow_heading_down:{a:"Arrow Pointing Rightwards Then Curving Downwards",b:"2935-FE0F",c:"2935",d:!0,e:!0,f:!0,h:!0,j:["右箭头向下弯曲","蓝色方块","方向","底","blue-square","direction","bottom"],k:[55,36],o:2},ice_hockey_stick_and_puck:{a:"Ice Hockey Stick and Puck",b:"1F3D2",d:!0,e:!0,f:!0,h:!0,k:[10,37],o:2,j:["冰球"]},meat_on_bone:{a:"Meat on Bone",b:"1F356",d:!0,e:!0,f:!0,h:!0,j:["肉骨头","好","食物","鸡 腿","good","food","drumstick"],k:[6,46],o:2},prayer_beads:{a:"Prayer Beads",b:"1F4FF",d:!0,e:!0,f:!0,h:!0,j:["念珠","迪克尔","宗教","dhikr","religious"],k:[27,27],o:2},statue_of_liberty:{a:"Statue of Liberty",b:"1F5FD",d:!0,e:!0,f:!0,h:!0,j:["自由女神像","美国人","纽约","american","newyork"],k:[30,32],o:2},grimacing:{a:"Grimacing Face",b:"1F62C",d:!0,e:!0,f:!0,h:!0,j:["狰狞的脸","脸","鬼脸","牙齿","face","grimace","teeth"],k:[31,22],o:2},"flag-bs":{a:"Bahamas Flag",b:"1F1E7-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[1,6],o:2,j:["巴哈马国旗"]},rhinoceros:{a:"Rhinoceros",b:"1F98F",d:!0,e:!0,f:!0,h:!0,j:["犀牛","动物","自然界","角","animal","nature","horn"],k:[42,33],o:4},lacrosse:{a:"Lacrosse Stick and Ball",b:"1F94D",d:!0,e:!0,f:!0,h:!0,k:[41,28],o:11,j:["长曲棍球"]},poultry_leg:{a:"Poultry Leg",b:"1F357",d:!0,e:!0,f:!0,h:!0,j:["鸡腿","食物","肉","鸡 腿","鸟","鸡","土耳其","food","meat","drumstick","bird","chicken","turkey"],k:[6,47],o:2},hippopotamus:{a:"Hippopotamus",b:"1F99B",d:!0,e:!0,f:!0,h:!0,k:[42,45],o:11,j:["河马"]},nose:{skin_variations:{"1F3FB":{unified:"1F443-1F3FB",non_qualified:null,image:"1f443-1f3fb.png",sheet_x:12,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F443-1F3FC",non_qualified:null,image:"1f443-1f3fc.png",sheet_x:12,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F443-1F3FD",non_qualified:null,image:"1f443-1f3fd.png",sheet_x:12,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F443-1F3FE",non_qualified:null,image:"1f443-1f3fe.png",sheet_x:12,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F443-1F3FF",non_qualified:null,image:"1f443-1f3ff.png",sheet_x:12,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Nose",b:"1F443",d:!0,e:!0,f:!0,h:!0,j:["鼻子","气味","闻","smell","sniff"],k:[12,45],o:2},arrows_clockwise:{a:"Clockwise Downwards and Upwards Open Circle Arrows",b:"1F503",d:!0,e:!0,f:!0,h:!0,j:["顺时针垂直箭头","同步","周期","圆","重复","sync","cycle","round","repeat"],k:[27,31],o:2},"flag-bt":{a:"Bhutan Flag",b:"1F1E7-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[1,7],o:2,j:["不丹国旗"]},church:{a:"Church",b:"26EA",d:!0,e:!0,f:!0,h:!0,j:["基督教会","建筑","宗教","基督","building","religion","christ"],k:[54,10],o:2},lipstick:{a:"Lipstick",b:"1F484",d:!0,e:!0,f:!0,h:!0,j:["口红","女性","女孩","时尚","女人","female","girl","fashion","woman"],k:[24,32],o:2},lying_face:{a:"Lying Face",b:"1F925",d:!0,e:!0,f:!0,h:!0,j:["说谎的脸","脸","躺","皮诺奇","face","lie","pinocchio"],k:[38,22],o:4},arrows_counterclockwise:{a:"Anticlockwise Downwards and Upwards Open Circle Arrows",b:"1F504",d:!0,e:!0,f:!0,h:!0,j:["逆时针箭头按钮","蓝色方块","同步","周期","blue-square","sync","cycle"],k:[27,32],o:2},"flag-bv":{a:"Bouvet Island Flag",b:"1F1E7-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[1,8],o:2,j:["布维岛旗"]},cut_of_meat:{a:"Cut of Meat",b:"1F969",d:!0,e:!0,f:!0,h:!0,k:[41,56],o:5,j:["肉块"]},mosque:{a:"Mosque",b:"1F54C",d:!0,e:!0,f:!0,h:!0,j:["清真寺","伊斯兰","崇拜","尖塔","islam","worship","minaret"],k:[28,36],o:2},ring:{a:"Ring",b:"1F48D",d:!0,e:!0,f:!0,h:!0,j:["戒指","婚礼","提供","婚","情人","钻石","时尚","珠宝","宝石","承诺","wedding","propose","marriage","valentines","diamond","fashion","jewelry","gem","engagement"],k:[25,23],o:2},brain:{a:"Brain",b:"1F9E0",d:!0,e:!0,f:!0,h:!0,k:[51,19],o:5,j:["脑"]},table_tennis_paddle_and_ball:{a:"Table Tennis Paddle and Ball",b:"1F3D3",d:!0,e:!0,f:!0,h:!0,k:[10,38],o:2,j:["乒乓"]},relieved:{a:"Relieved Face",b:"1F60C",d:!0,e:!0,f:!0,h:!0,j:["如释重负的脸","脸","放松","唷","按摩","幸福","face","relaxed","phew","massage","happiness"],k:[30,47],o:2},mouse:{a:"Mouse Face",b:"1F42D",d:!0,e:!0,f:!0,h:!0,j:["鼠脸","动物","自然界","cheese_wedge","啮齿动物","animal","nature","cheese_wedge","rodent"],k:[12,17],o:2},hindu_temple:{a:"Hindu Temple",b:"1F6D5",d:!0,e:!0,f:!0,h:!0,k:[36,41],o:12,j:["印度教"]},back:{a:"Back with Leftwards Arrow Above",b:"1F519",d:!0,e:!0,f:!0,h:!0,j:["返回箭头","箭","的话","返回","arrow","words","return"],k:[27,53],o:2},gem:{a:"Gem Stone",b:"1F48E",d:!0,e:!0,f:!0,h:!0,j:["宝石","蓝","红宝石","钻石","珠宝","blue","ruby","diamond","jewelry"],k:[25,24],o:2},pensive:{a:"Pensive Face",b:"1F614",d:!0,e:!0,f:!0,h:!0,j:["沉思的脸","脸","伤心","沮丧","沮丧","face","sad","depressed","upset"],k:[30,55],o:2},"flag-bw":{a:"Botswana Flag",b:"1F1E7-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[1,9],o:2,j:["博茨瓦纳国旗"]},mouse2:{a:"Mouse",b:"1F401",d:!0,e:!0,f:!0,h:!0,j:["老鼠","动物","自然界","啮齿动物","animal","nature","rodent"],k:[11,29],o:2},bacon:{a:"Bacon",b:"1F953",d:!0,e:!0,f:!0,h:!0,j:["培根","食物","早餐","猪肉","猪","肉","food","breakfast","pork","pig","meat"],k:[41,34],o:4},tooth:{a:"Tooth",b:"1F9B7",d:!0,e:!0,f:!0,h:!0,k:[43,17],o:11,j:["牙齿"]},badminton_racquet_and_shuttlecock:{a:"Badminton Racquet and Shuttlecock",b:"1F3F8",d:!0,e:!0,f:!0,h:!0,k:[11,20],o:2,j:["羽毛球"]},rat:{a:"Rat",b:"1F400",d:!0,e:!0,f:!0,h:!0,j:["鼠","动物","鼠","啮齿动物","animal","mouse","rodent"],k:[11,28],o:2},synagogue:{a:"Synagogue",b:"1F54D",d:!0,e:!0,f:!0,h:!0,j:["犹太教堂","犹太教","崇拜","寺庙","犹太的","judaism","worship","temple","jewish"],k:[28,37],o:2},end:{a:"End with Leftwards Arrow Above",b:"1F51A",d:!0,e:!0,f:!0,h:!0,j:["结束箭头","的话","箭","words","arrow"],k:[27,54],o:2},bone:{a:"Bone",b:"1F9B4",d:!0,e:!0,f:!0,h:!0,k:[43,4],o:11,j:["骨头"]},boxing_glove:{a:"Boxing Glove",b:"1F94A",d:!0,e:!0,f:!0,h:!0,j:["拳击手套","体育","战斗","sports","fighting"],k:[41,25],o:4},mute:{a:"Speaker with Cancellation Stroke",b:"1F507",d:!0,e:!0,f:!0,h:!0,j:["静音音箱","声音","卷","沉默","安静","sound","volume","silence","quiet"],k:[27,35],o:2},hamburger:{a:"Hamburger",b:"1F354",d:!0,e:!0,f:!0,h:!0,j:["汉堡包","肉","快餐","牛肉","芝 士 汉堡","麦当劳","汉堡王","meat","fast food","beef","cheeseburger","mcdonalds","burger king"],k:[6,44],o:2},"flag-by":{a:"Belarus Flag",b:"1F1E7-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[1,10],o:2,j:["白俄罗斯国旗"]},sleepy:{a:"Sleepy Face",b:"1F62A",d:!0,e:!0,f:!0,h:!0,j:["困的脸","脸","累","休息","太阳","face","tired","rest","nap"],k:[31,20],o:2},on:{a:"On with Exclamation Mark with Left Right Arrow Above",b:"1F51B",d:!0,e:!0,f:!0,h:!0,j:["开启箭头","箭","的话","arrow","words"],k:[27,55],o:2},martial_arts_uniform:{a:"Martial Arts Uniform",b:"1F94B",d:!0,e:!0,f:!0,h:!0,j:["武术制服","柔道","空手道","跆拳道","judo","karate","taekwondo"],k:[41,26],o:4},speaker:{a:"Speaker",b:"1F508",d:!0,e:!0,f:!0,h:!0,j:["扬声器音量低","声音","卷","沉默","广播","sound","volume","silence","broadcast"],k:[27,36],o:2},drooling_face:{a:"Drooling Face",b:"1F924",d:!0,e:!0,f:!0,h:!0,j:["流口水的脸","脸","face"],k:[38,21],o:4},eyes:{a:"Eyes",b:"1F440",d:!0,e:!0,f:!0,h:!0,j:["一双眼睛","看","看","茎","偷看","看","look","watch","stalk","peek","see"],k:[12,36],o:2},"flag-bz":{a:"Belize Flag",b:"1F1E7-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[1,11],o:2,j:["伯利兹国旗"]},hamster:{a:"Hamster Face",b:"1F439",d:!0,e:!0,f:!0,h:!0,j:["仓鼠","动物","自然界","animal","nature"],k:[12,29],o:2},shinto_shrine:{a:"Shinto Shrine",b:"26E9-FE0F",c:"26E9",d:!0,e:!0,f:!0,h:!0,j:["神社","寺庙","日本","京都","temple","japan","kyoto"],k:[54,9],o:2},fries:{a:"French Fries",b:"1F35F",d:!0,e:!0,f:!0,h:!0,j:["炸薯条","芯片","小吃","快餐","chips","snack","fast food"],k:[6,55],o:2},goal_net:{a:"Goal Net",b:"1F945",d:!0,e:!0,f:!0,h:!0,j:["球网","体育","sports"],k:[41,21],o:4},kaaba:{a:"Kaaba",b:"1F54B",d:!0,e:!0,f:!0,h:!0,j:["天房","麦加","清真寺","伊斯兰","mecca","mosque","islam"],k:[28,35],o:2},soon:{a:"Soon with Rightwards Arrow Above",b:"1F51C",d:!0,e:!0,f:!0,h:!0,j:["很快的箭头","箭","的话","arrow","words"],k:[27,56],o:2},"flag-ca":{a:"Canada Flag",b:"1F1E8-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[1,12],o:2,j:["加拿大国旗"]},rabbit:{a:"Rabbit Face",b:"1F430",d:!0,e:!0,f:!0,h:!0,j:["兔子脸","动物","自然界","宠物","春天","魔法","兔子","animal","nature","pet","spring","magic","bunny"],k:[12,20],o:2},eye:{a:"Eye",b:"1F441-FE0F",c:"1F441",d:!0,e:!0,f:!0,h:!0,j:["眼睛","脸","看","看","看","留","face","look","see","watch","stare"],k:[12,38],o:2},sleeping:{a:"Sleeping Face",b:"1F634",d:!0,e:!0,f:!0,h:!0,j:["熟睡的脸","脸","累","困","晚上","兹兹","face","tired","sleepy","night","zzz"],k:[31,30],o:2},pizza:{a:"Slice of Pizza",b:"1F355",d:!0,e:!0,f:!0,h:!0,j:["比萨","食物","党","food","party"],k:[6,45],o:2},sound:{a:"Speaker with One Sound Wave",b:"1F509",d:!0,e:!0,f:!0,h:!0,j:["扬声器音量中等","卷","议长","广播","volume","speaker","broadcast"],k:[27,37],o:2},rabbit2:{a:"Rabbit",b:"1F407",d:!0,e:!0,f:!0,h:!0,j:["兔子","动物","自然界","宠物","魔法","春天","animal","nature","pet","magic","spring"],k:[11,35],o:2},fountain:{a:"Fountain",b:"26F2",d:!0,e:!0,f:!0,h:!0,j:["喷泉","相片","夏天","水","新鲜","photo","summer","water","fresh"],k:[54,13],o:2},golf:{a:"Flag in Hole",b:"26F3",d:!0,e:!0,f:!0,h:!0,j:["在孔中的旗帜","体育","商","旗","洞","夏天","sports","business","flag","hole","summer"],k:[54,14],o:2},top:{a:"Top with Upwards Arrow Above",b:"1F51D",d:!0,e:!0,f:!0,h:!0,j:["向上箭头","的话","蓝色方块","words","blue-square"],k:[28,0],o:2},mask:{a:"Face with Medical Mask",b:"1F637",d:!0,e:!0,f:!0,h:!0,j:["戴口罩的脸","脸","生病","病","疾病","face","sick","ill","disease"],k:[31,33],o:2},"flag-cc":{a:"Cocos (keeling) Islands Flag",b:"1F1E8-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[1,13],o:2,j:["科科斯国旗"]},hotdog:{a:"Hot Dog",b:"1F32D",d:!0,e:!0,f:!0,h:!0,j:["热狗","食物","法兰克福","food","frankfurter"],k:[6,5],o:2},loud_sound:{a:"Speaker with Three Sound Waves",b:"1F50A",d:!0,e:!0,f:!0,h:!0,j:["扬声器音量高","卷","噪声","吵","议长","广播","volume","noise","noisy","speaker","broadcast"],k:[27,38],o:2},tongue:{a:"Tongue",b:"1F445",d:!0,e:!0,f:!0,h:!0,j:["舌头","口","好玩","mouth","playful"],k:[12,52],o:2},place_of_worship:{a:"Place of Worship",b:"1F6D0",d:!0,e:!0,f:!0,h:!0,j:["敬拜的场所","宗教","教堂","寺庙","祈祷","religion","church","temple","prayer"],k:[36,38],o:2},ice_skate:{a:"Ice Skate",b:"26F8-FE0F",c:"26F8",d:!0,e:!0,f:!0,h:!0,j:["滑冰","体育","sports"],k:[54,18],o:2},sandwich:{a:"Sandwich",b:"1F96A",d:!0,e:!0,f:!0,h:!0,k:[42,0],o:5,j:["三明治"]},chipmunk:{a:"Chipmunk",b:"1F43F-FE0F",c:"1F43F",d:!0,e:!0,f:!0,h:!0,j:["花栗鼠","动物","自然界","啮齿动物","松鼠","animal","nature","rodent","squirrel"],k:[12,35],o:2},loudspeaker:{a:"Public Address Loudspeaker",b:"1F4E2",d:!0,e:!0,f:!0,h:!0,j:["扬声器","卷","声音","volume","sound"],k:[26,56],o:2},lips:{a:"Mouth",b:"1F444",d:!0,e:!0,f:!0,h:!0,j:["嘴巴","口","吻","mouth","kiss"],k:[12,51],o:2},"flag-cd":{a:"Congo - Kinshasa Flag",b:"1F1E8-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[1,14],o:2,j:["刚果 - 金沙萨国旗"]},tent:{a:"Tent",b:"26FA",d:!0,e:!0,f:!0,h:!0,j:["帐篷","相片","露营","户外","photo","camping","outdoors"],k:[54,37],o:2},face_with_thermometer:{a:"Face with Thermometer",b:"1F912",d:!0,e:!0,f:!0,h:!0,j:["嘴里含着温度计的脸","生病","温度","温度计","冷","发烧","sick","temperature","thermometer","cold","fever"],k:[37,25],o:2},taco:{a:"Taco",b:"1F32E",d:!0,e:!0,f:!0,h:!0,j:["玉米卷","食物","墨西哥人","food","mexican"],k:[6,6],o:2},foggy:{a:"Foggy",b:"1F301",d:!0,e:!0,f:!0,h:!0,j:["有雾","相片","山","photo","mountain"],k:[5,20],o:2},"flag-cf":{a:"Central African Republic Flag",b:"1F1E8-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[1,15],o:2,j:["中非共和国国旗"]},baby:{skin_variations:{"1F3FB":{unified:"1F476-1F3FB",non_qualified:null,image:"1f476-1f3fb.png",sheet_x:23,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F476-1F3FC",non_qualified:null,image:"1f476-1f3fc.png",sheet_x:23,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F476-1F3FD",non_qualified:null,image:"1f476-1f3fd.png",sheet_x:23,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F476-1F3FE",non_qualified:null,image:"1f476-1f3fe.png",sheet_x:23,sheet_y:8,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F476-1F3FF",non_qualified:null,image:"1f476-1f3ff.png",sheet_x:23,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Baby",b:"1F476",d:!0,e:!0,f:!0,h:!0,j:["婴儿","孩子","男孩","女孩","幼儿","child","boy","girl","toddler"],k:[23,4],o:2},atom_symbol:{a:"Atom Symbol",b:"269B-FE0F",c:"269B",d:!0,e:!0,f:!0,h:!0,j:["原子符号","科学","物理","化学","science","physics","chemistry"],k:[53,48],o:2},fishing_pole_and_fish:{a:"Fishing Pole and Fish",b:"1F3A3",d:!0,e:!0,f:!0,h:!0,j:["鱼竿","食物","爱好","夏天","food","hobby","summer"],k:[8,9],o:2},hedgehog:{a:"Hedgehog",b:"1F994",d:!0,e:!0,f:!0,h:!0,k:[42,38],o:5,j:["刺猬"]},face_with_head_bandage:{a:"Face with Head-Bandage",b:"1F915",d:!0,e:!0,f:!0,h:!0,j:["带有绷带的脸","受伤","笨拙","绷带","伤害","injured","clumsy","bandage","hurt"],k:[37,28],o:2},mega:{a:"Cheering Megaphone",b:"1F4E3",d:!0,e:!0,f:!0,h:!0,j:["扩音器","声音","议长","卷","sound","speaker","volume"],k:[27,0],o:2},nauseated_face:{a:"Nauseated Face",b:"1F922",d:!0,e:!0,f:!0,h:!0,j:["恶心的脸。","脸","呕吐","总","绿","生病","吐","病","face","vomit","gross","green","sick","throw up","ill"],k:[38,19],o:4},child:{skin_variations:{"1F3FB":{unified:"1F9D2-1F3FB",non_qualified:null,image:"1f9d2-1f3fb.png",sheet_x:48,sheet_y:17,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D2-1F3FC",non_qualified:null,image:"1f9d2-1f3fc.png",sheet_x:48,sheet_y:18,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D2-1F3FD",non_qualified:null,image:"1f9d2-1f3fd.png",sheet_x:48,sheet_y:19,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D2-1F3FE",non_qualified:null,image:"1f9d2-1f3fe.png",sheet_x:48,sheet_y:20,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D2-1F3FF",non_qualified:null,image:"1f9d2-1f3ff.png",sheet_x:48,sheet_y:21,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Child",b:"1F9D2",d:!0,e:!0,f:!0,h:!0,k:[48,16],o:5,j:["儿童"]},"flag-cg":{a:"Congo - Brazzaville Flag",b:"1F1E8-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[1,16],o:2,j:["刚果 - 布拉柴维尔国旗"]},bat:{a:"Bat",b:"1F987",d:!0,e:!0,f:!0,h:!0,j:["蝙蝠","动物","自然界","盲","吸血鬼","animal","nature","blind","vampire"],k:[42,25],o:4},diving_mask:{a:"Diving Mask",b:"1F93F",d:!0,e:!0,f:!0,h:!0,k:[41,15],o:12,j:["潜水面具"]},burrito:{a:"Burrito",b:"1F32F",d:!0,e:!0,f:!0,h:!0,j:["卷饼","食物","墨西哥人","food","mexican"],k:[6,7],o:2},postal_horn:{a:"Postal Horn",b:"1F4EF",d:!0,e:!0,f:!0,h:!0,j:["号角","仪器","音乐","instrument","music"],k:[27,12],o:2},night_with_stars:{a:"Night with Stars",b:"1F303",d:!0,e:!0,f:!0,h:!0,j:["夜晚的星星","傍晚","城市","市中心","evening","city","downtown"],k:[5,22],o:2},om_symbol:{a:"Om Symbol",b:"1F549-FE0F",c:"1F549",d:!0,e:!0,f:!0,h:!0,k:[28,33],o:2,j:["唵符号"]},star_of_david:{a:"Star of David",b:"2721-FE0F",c:"2721",d:!0,e:!0,f:!0,h:!0,j:["六芒星","犹太教","judaism"],k:[55,15],o:2},boy:{skin_variations:{"1F3FB":{unified:"1F466-1F3FB",non_qualified:null,image:"1f466-1f3fb.png",sheet_x:14,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F466-1F3FC",non_qualified:null,image:"1f466-1f3fc.png",sheet_x:14,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F466-1F3FD",non_qualified:null,image:"1f466-1f3fd.png",sheet_x:14,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F466-1F3FE",non_qualified:null,image:"1f466-1f3fe.png",sheet_x:14,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F466-1F3FF",non_qualified:null,image:"1f466-1f3ff.png",sheet_x:14,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Boy",b:"1F466",d:!0,e:!0,f:!0,h:!0,j:["男孩","一","雄","家伙","青少年","man","male","guy","teenager"],k:[14,26],o:2},bell:{a:"Bell",b:"1F514",d:!0,e:!0,f:!0,h:!0,j:["铃","声音","通知","圣诞节","圣诞","磬","sound","notification","christmas","xmas","chime"],k:[27,48],o:2},"flag-ch":{a:"Switzerland Flag",b:"1F1E8-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[1,17],o:2,j:["瑞士国旗"]},running_shirt_with_sash:{a:"Running Shirt with Sash",b:"1F3BD",d:!0,e:!0,f:!0,h:!0,j:["跑步T恤","玩","选美","play","pageant"],k:[8,35],o:2},stuffed_flatbread:{a:"Stuffed Flatbread",b:"1F959",d:!0,e:!0,f:!0,h:!0,j:["口袋饼","食物","扁面包","塞","陀螺","food","flatbread","stuffed","gyro"],k:[41,40],o:4},bear:{a:"Bear Face",b:"1F43B",d:!0,e:!0,f:!0,h:!0,j:["熊","动物","自然界","野生","animal","nature","wild"],k:[12,31],o:2},cityscape:{a:"Cityscape",b:"1F3D9-FE0F",c:"1F3D9",d:!0,e:!0,f:!0,h:!0,j:["城市景观","相片","夜生活","都市的","photo","night life","urban"],k:[10,44],o:2},face_vomiting:{a:"Face with Open Mouth Vomiting",b:"1F92E",d:!0,e:!0,f:!0,h:!0,k:[38,48],n:["face_with_open_mouth_vomiting"],o:5,j:["呕吐的脸"]},wheel_of_dharma:{a:"Wheel of Dharma",b:"2638-FE0F",c:"2638",d:!0,e:!0,f:!0,h:!0,j:["法轮符号","印度教","佛教","梵语","梵语","hinduism","buddhism","sikhism","jainism"],k:[53,15],o:2},ski:{a:"Ski and Ski Boot",b:"1F3BF",d:!0,e:!0,f:!0,h:!0,j:["滑雪","体育","冬","冷","雪","sports","winter","cold","snow"],k:[8,37],o:2},girl:{skin_variations:{"1F3FB":{unified:"1F467-1F3FB",non_qualified:null,image:"1f467-1f3fb.png",sheet_x:14,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F467-1F3FC",non_qualified:null,image:"1f467-1f3fc.png",sheet_x:14,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F467-1F3FD",non_qualified:null,image:"1f467-1f3fd.png",sheet_x:14,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F467-1F3FE",non_qualified:null,image:"1f467-1f3fe.png",sheet_x:14,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F467-1F3FF",non_qualified:null,image:"1f467-1f3ff.png",sheet_x:14,sheet_y:37,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Girl",b:"1F467",d:!0,e:!0,f:!0,h:!0,j:["女孩","女性","女人","青少年","female","woman","teenager"],k:[14,32],o:2},falafel:{a:"Falafel",b:"1F9C6",d:!0,e:!0,f:!0,h:!0,k:[44,14],o:12,j:["炸豆丸子"]},sneezing_face:{a:"Sneezing Face",b:"1F927",d:!0,e:!0,f:!0,h:!0,j:["打喷嚏的脸","脸","保佑你","打喷嚏","生病","过敏","face","gesundheit","sneeze","sick","allergy"],k:[38,41],o:4},no_bell:{a:"Bell with Cancellation Stroke",b:"1F515",d:!0,e:!0,f:!0,h:!0,j:["带有斜线的铃","声音","卷","静音","安静","沉默","sound","volume","mute","quiet","silent"],k:[27,49],o:2},koala:{a:"Koala",b:"1F428",d:!0,e:!0,f:!0,h:!0,j:["考拉","动物","自然界","animal","nature"],k:[12,12],o:2},sunrise_over_mountains:{a:"Sunrise over Mountains",b:"1F304",d:!0,e:!0,f:!0,h:!0,j:["山顶日出","视图","假期","相片","view","vacation","photo"],k:[5,23],o:2},"flag-ci":{a:"Côte D’ivoire Flag",b:"1F1E8-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[1,18],o:2,j:["科特迪瓦旗"]},sunrise:{a:"Sunrise",b:"1F305",d:!0,e:!0,f:!0,h:!0,j:["日出","上午","视图","假期","相片","morning","view","vacation","photo"],k:[5,24],o:2},yin_yang:{a:"Yin Yang",b:"262F-FE0F",c:"262F",d:!0,e:!0,f:!0,h:!0,j:["阴阳符号","平衡","balance"],k:[53,14],o:2},adult:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fb.png",sheet_x:48,sheet_y:11,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fc.png",sheet_x:48,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fd.png",sheet_x:48,sheet_y:13,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fe.png",sheet_x:48,sheet_y:14,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3ff.png",sheet_x:48,sheet_y:15,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Adult",b:"1F9D1",d:!0,e:!0,f:!0,h:!0,k:[48,10],o:5,j:["人"]},hot_face:{a:"Overheated Face",b:"1F975",d:!0,e:!0,f:!0,h:!0,k:[42,10],o:11,j:["热脸"]},musical_score:{a:"Musical Score",b:"1F3BC",d:!0,e:!0,f:!0,h:!0,j:["乐谱","高音","钥匙","组成","treble","clef","compose"],k:[8,34],o:2},sled:{a:"Sled",b:"1F6F7",d:!0,e:!0,f:!0,h:!0,k:[36,56],o:5,j:["雪橇"]},egg:{a:"Egg",b:"1F95A",d:!0,e:!0,f:!0,h:!0,j:["蛋","食物","鸡","早餐","food","chicken","breakfast"],k:[41,41],o:4},panda_face:{a:"Panda Face",b:"1F43C",d:!0,e:!0,f:!0,h:!0,j:["熊猫","动物","自然界","熊猫","animal","nature","panda"],k:[12,32],o:2},"flag-ck":{a:"Cook Islands Flag",b:"1F1E8-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[1,19],o:2,j:["库克群岛旗"]},"flag-cl":{a:"Chile Flag",b:"1F1E8-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[1,20],o:2,j:["智利国旗"]},person_with_blond_hair:{skin_variations:{"1F3FB":{unified:"1F471-1F3FB",non_qualified:null,image:"1f471-1f3fb.png",sheet_x:22,sheet_y:20,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F471-1F3FC",non_qualified:null,image:"1f471-1f3fc.png",sheet_x:22,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F471-1F3FD",non_qualified:null,image:"1f471-1f3fd.png",sheet_x:22,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F471-1F3FE",non_qualified:null,image:"1f471-1f3fe.png",sheet_x:22,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F471-1F3FF",non_qualified:null,image:"1f471-1f3ff.png",sheet_x:22,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F471-200D-2642-FE0F",a:"Person with Blond Hair",b:"1F471",d:!0,e:!0,f:!0,h:!1,k:[22,19],o:2,j:["金色头发的人"]},sloth:{a:"Sloth",b:"1F9A5",d:!0,e:!0,f:!0,h:!0,k:[42,53],o:12,j:["树獭"]},latin_cross:{a:"Latin Cross",b:"271D-FE0F",c:"271D",d:!0,e:!0,f:!0,h:!0,j:["拉丁十字架","基督教","christianity"],k:[55,14],o:2},curling_stone:{a:"Curling Stone",b:"1F94C",d:!0,e:!0,f:!0,h:!0,k:[41,27],o:5,j:["冰壶"]},cold_face:{a:"Freezing Face",b:"1F976",d:!0,e:!0,f:!0,h:!0,k:[42,11],o:11,j:["冰冻的脸"]},fried_egg:{a:"Cooking",b:"1F373",d:!0,e:!0,f:!0,h:!0,j:["烹饪","食物","早餐","厨房","蛋","food","breakfast","kitchen","egg"],k:[7,18],n:["cooking"],o:2},city_sunset:{a:"Cityscape at Dusk",b:"1F306",d:!0,e:!0,f:!0,h:!0,j:["黄昏市容","相片","傍晚","天空","建筑物","photo","evening","sky","buildings"],k:[5,25],o:2},musical_note:{a:"Musical Note",b:"1F3B5",d:!0,e:!0,f:!0,h:!0,j:["音符","得分","语气","声音","score","tone","sound"],k:[8,27],o:2},"flag-cm":{a:"Cameroon Flag",b:"1F1E8-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[1,21],o:2,j:["喀麦隆国旗"]},notes:{a:"Multiple Musical Notes",b:"1F3B6",d:!0,e:!0,f:!0,h:!0,j:["音符","音乐","得分","music","score"],k:[8,28],o:2},woozy_face:{a:"Face with Uneven Eyes and Wavy Mouth",b:"1F974",d:!0,e:!0,f:!0,h:!0,k:[42,9],o:11,j:["头昏眼花的脸"]},dart:{a:"Direct Hit",b:"1F3AF",d:!0,e:!0,f:!0,h:!0,j:["命中红心","游戏","玩","酒吧","game","play","bar"],k:[8,21],o:2},orthodox_cross:{a:"Orthodox Cross",b:"2626-FE0F",c:"2626",d:!0,e:!0,f:!0,h:!0,j:["东正教十字架","suppedaneum","宗教","suppedaneum","religion"],k:[53,11],o:2},shallow_pan_of_food:{a:"Shallow Pan of Food",b:"1F958",d:!0,e:!0,f:!0,h:!0,j:["浅盘食物","食物","烹饪","平底锅","海鲜饭","food","cooking","casserole","paella"],k:[41,39],o:4},otter:{a:"Otter",b:"1F9A6",d:!0,e:!0,f:!0,h:!0,k:[42,54],o:12,j:["獭"]},man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB",non_qualified:null,image:"1f468-1f3fb.png",sheet_x:17,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC",non_qualified:null,image:"1f468-1f3fc.png",sheet_x:17,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD",non_qualified:null,image:"1f468-1f3fd.png",sheet_x:17,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE",non_qualified:null,image:"1f468-1f3fe.png",sheet_x:17,sheet_y:26,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF",non_qualified:null,image:"1f468-1f3ff.png",sheet_x:17,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Man",b:"1F468",d:!0,e:!0,f:!0,h:!0,j:["男人","胡子","爸爸","爸爸","家伙","优雅","先生","胡子","mustache","father","dad","guy","classy","sir","moustache"],k:[17,22],o:2},city_sunrise:{a:"Sunset over Buildings",b:"1F307",d:!0,e:!0,f:!0,h:!0,j:["日落","相片","早上好","黎明","photo","good morning","dawn"],k:[5,26],o:2},bearded_person:{skin_variations:{"1F3FB":{unified:"1F9D4-1F3FB",non_qualified:null,image:"1f9d4-1f3fb.png",sheet_x:48,sheet_y:29,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D4-1F3FC",non_qualified:null,image:"1f9d4-1f3fc.png",sheet_x:48,sheet_y:30,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D4-1F3FD",non_qualified:null,image:"1f9d4-1f3fd.png",sheet_x:48,sheet_y:31,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D4-1F3FE",non_qualified:null,image:"1f9d4-1f3fe.png",sheet_x:48,sheet_y:32,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D4-1F3FF",non_qualified:null,image:"1f9d4-1f3ff.png",sheet_x:48,sheet_y:33,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Bearded Person",b:"1F9D4",d:!0,e:!0,f:!0,h:!0,k:[48,28],o:5,j:["大胡子男人"]},skunk:{a:"Skunk",b:"1F9A8",d:!0,e:!0,f:!0,h:!0,k:[42,56],o:12,j:["臭鼬"]},stew:{a:"Pot of Food",b:"1F372",d:!0,e:!0,f:!0,h:!0,j:["锅装食品","食物","肉","汤","food","meat","soup"],k:[7,17],o:2},cn:{a:"China Flag",b:"1F1E8-1F1F3",d:!0,e:!0,f:!0,h:!0,j:["中国国旗","中国","中文","中华人民共和国","旗","国家","国家","旗帜","china","chinese","prc","flag","country","nation","banner"],k:[1,22],n:["flag-cn"],o:2},studio_microphone:{a:"Studio Microphone",b:"1F399-FE0F",c:"1F399",d:!0,e:!0,f:!0,h:!0,j:["录音室话筒","唱","录音","艺术家","脱口秀","sing","recording","artist","talkshow"],k:[8,1],o:2},star_and_crescent:{a:"Star and Crescent",b:"262A-FE0F",c:"262A",d:!0,e:!0,f:!0,h:!0,j:["星和月牙","伊斯兰","islam"],k:[53,12],o:2},"yo-yo":{a:"Yo-Yo",b:"1FA80",d:!0,e:!0,f:!0,h:!0,k:[52,1],o:12,j:["悠悠球"]},bridge_at_night:{a:"Bridge at Night",b:"1F309",d:!0,e:!0,f:!0,h:!0,j:["夜间大桥","相片","旧金山","photo","sanfrancisco"],k:[5,28],o:2},dizzy_face:{a:"Dizzy Face",b:"1F635",d:!0,e:!0,f:!0,h:!0,j:["晕眩的脸","花","无意识","异种","头晕","spent","unconscious","xox","dizzy"],k:[31,31],o:2},red_haired_man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9B0",non_qualified:null,image:"1f468-1f3fb-200d-1f9b0.png",sheet_x:16,sheet_y:24,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9B0",non_qualified:null,image:"1f468-1f3fc-200d-1f9b0.png",sheet_x:16,sheet_y:25,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9B0",non_qualified:null,image:"1f468-1f3fd-200d-1f9b0.png",sheet_x:16,sheet_y:26,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9B0",non_qualified:null,image:"1f468-1f3fe-200d-1f9b0.png",sheet_x:16,sheet_y:27,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9B0",non_qualified:null,image:"1f468-1f3ff-200d-1f9b0.png",sheet_x:16,sheet_y:28,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Red Haired Man",b:"1F468-200D-1F9B0",d:!0,e:!0,f:!0,h:!0,k:[16,23],o:11,j:["红发男人"]},kite:{a:"Kite",b:"1FA81",d:!0,e:!0,f:!0,h:!0,k:[52,2],o:12,j:["风筝"]},bowl_with_spoon:{a:"Bowl with Spoon",b:"1F963",d:!0,e:!0,f:!0,h:!0,k:[41,50],o:5,j:["碗与勺"]},"flag-co":{a:"Colombia Flag",b:"1F1E8-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[1,23],o:2,j:["哥伦比亚国旗"]},peace_symbol:{a:"Peace Symbol",b:"262E-FE0F",c:"262E",d:!0,e:!0,f:!0,h:!0,j:["和平符号","嬉皮","hippie"],k:[53,13],o:2},kangaroo:{a:"Kangaroo",b:"1F998",d:!0,e:!0,f:!0,h:!0,k:[42,42],o:11,j:["袋鼠"]},hotsprings:{a:"Hot Springs",b:"2668-FE0F",c:"2668",d:!0,e:!0,f:!0,h:!0,j:["温泉","浴","温暖","放松","bath","warm","relax"],k:[53,37],o:2},exploding_head:{a:"Shocked Face with Exploding Head",b:"1F92F",d:!0,e:!0,f:!0,h:!0,k:[38,49],n:["shocked_face_with_exploding_head"],o:5,j:["脑洞大开"]},level_slider:{a:"Level Slider",b:"1F39A-FE0F",c:"1F39A",d:!0,e:!0,f:!0,h:!0,j:["调整桿","规模","scale"],k:[8,2],o:2},badger:{a:"Badger",b:"1F9A1",d:!0,e:!0,f:!0,h:!0,k:[42,51],o:11,j:["獾"]},"8ball":{a:"Billiards",b:"1F3B1",d:!0,e:!0,f:!0,h:!0,j:["8号球（台球）","池","爱好","游戏","运气","魔法","pool","hobby","game","luck","magic"],k:[8,23],o:2},curly_haired_man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9B1",non_qualified:null,image:"1f468-1f3fb-200d-1f9b1.png",sheet_x:16,sheet_y:30,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9B1",non_qualified:null,image:"1f468-1f3fc-200d-1f9b1.png",sheet_x:16,sheet_y:31,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9B1",non_qualified:null,image:"1f468-1f3fd-200d-1f9b1.png",sheet_x:16,sheet_y:32,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9B1",non_qualified:null,image:"1f468-1f3fe-200d-1f9b1.png",sheet_x:16,sheet_y:33,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9B1",non_qualified:null,image:"1f468-1f3ff-200d-1f9b1.png",sheet_x:16,sheet_y:34,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Curly Haired Man",b:"1F468-200D-1F9B1",d:!0,e:!0,f:!0,h:!0,k:[16,29],o:11,j:["卷发男人"]},"flag-cp":{a:"Clipperton Island Flag",b:"1F1E8-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[1,24],o:2,j:["克利珀顿岛旗"]},carousel_horse:{a:"Carousel Horse",b:"1F3A0",d:!0,e:!0,f:!0,h:!0,j:["转盘马","相片","狂欢节","photo","carnival"],k:[8,6],o:2},face_with_cowboy_hat:{a:"Face with Cowboy Hat",b:"1F920",d:!0,e:!0,f:!0,h:!0,k:[38,17],o:4,j:["牛仔帽的脸"]},menorah_with_nine_branches:{a:"Menorah with Nine Branches",b:"1F54E",d:!0,e:!0,f:!0,h:!0,k:[28,38],o:2,j:["灯台"]},green_salad:{a:"Green Salad",b:"1F957",d:!0,e:!0,f:!0,h:!0,j:["绿色沙拉","食物","健康","生菜","food","healthy","lettuce"],k:[41,38],o:4},control_knobs:{a:"Control Knobs",b:"1F39B-FE0F",c:"1F39B",d:!0,e:!0,f:!0,h:!0,j:["控制旋钮","拨号","dial"],k:[8,3],o:2},popcorn:{a:"Popcorn",b:"1F37F",d:!0,e:!0,f:!0,h:!0,j:["爆米花","食物","电影院","电影","小吃","food","movie theater","films","snack"],k:[7,30],o:2},six_pointed_star:{a:"Six Pointed Star with Middle Dot",b:"1F52F",d:!0,e:!0,f:!0,h:!0,j:["虚线六芒星","紫色方块","宗教","犹太的","六线形","purple-square","religion","jewish","hexagram"],k:[28,18],o:2},feet:{a:"Paw Prints",b:"1F43E",d:!0,e:!0,f:!0,h:!0,k:[12,34],n:["paw_prints"],o:2,j:["掌印"]},ferris_wheel:{a:"Ferris Wheel",b:"1F3A1",d:!0,e:!0,f:!0,h:!0,j:["摩天轮","相片","狂欢节","伦敦眼","photo","carnival","londoneye"],k:[8,7],o:2},microphone:{a:"Microphone",b:"1F3A4",d:!0,e:!0,f:!0,h:!0,j:["麦克风","声音","音乐","和","唱","脱口秀","sound","music","PA","sing","talkshow"],k:[8,10],o:2},crystal_ball:{a:"Crystal Ball",b:"1F52E",d:!0,e:!0,f:!0,h:!0,j:["水晶球","磁盘","党","魔法","马戏团","fortune_teller","disco","party","magic","circus","fortune_teller"],k:[28,17],o:2},partying_face:{a:"Face with Party Horn and Party Hat",b:"1F973",d:!0,e:!0,f:!0,h:!0,k:[42,8],o:11,j:["派对","猫脸"]},"flag-cr":{a:"Costa Rica Flag",b:"1F1E8-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[1,25],o:2,j:["哥斯达黎加国旗"]},white_haired_man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9B3",non_qualified:null,image:"1f468-1f3fb-200d-1f9b3.png",sheet_x:16,sheet_y:42,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9B3",non_qualified:null,image:"1f468-1f3fc-200d-1f9b3.png",sheet_x:16,sheet_y:43,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9B3",non_qualified:null,image:"1f468-1f3fd-200d-1f9b3.png",sheet_x:16,sheet_y:44,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9B3",non_qualified:null,image:"1f468-1f3fe-200d-1f9b3.png",sheet_x:16,sheet_y:45,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9B3",non_qualified:null,image:"1f468-1f3ff-200d-1f9b3.png",sheet_x:16,sheet_y:46,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"White Haired Man",b:"1F468-200D-1F9B3",d:!0,e:!0,f:!0,h:!0,k:[16,41],o:11,j:["白发男人"]},headphones:{a:"Headphone",b:"1F3A7",d:!0,e:!0,f:!0,h:!0,j:["耳机","音乐","得分","产品","music","score","gadgets"],k:[8,13],o:2},bald_man:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9B2",non_qualified:null,image:"1f468-1f3fb-200d-1f9b2.png",sheet_x:16,sheet_y:36,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9B2",non_qualified:null,image:"1f468-1f3fc-200d-1f9b2.png",sheet_x:16,sheet_y:37,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9B2",non_qualified:null,image:"1f468-1f3fd-200d-1f9b2.png",sheet_x:16,sheet_y:38,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9B2",non_qualified:null,image:"1f468-1f3fe-200d-1f9b2.png",sheet_x:16,sheet_y:39,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9B2",non_qualified:null,image:"1f468-1f3ff-200d-1f9b2.png",sheet_x:16,sheet_y:40,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Bald Man",b:"1F468-200D-1F9B2",d:!0,e:!0,f:!0,h:!0,k:[16,35],o:11,j:["光头男人"]},sunglasses:{a:"Smiling Face with Sunglasses",b:"1F60E",d:!0,e:!0,f:!0,h:!0,j:["带太阳镜的笑脸","脸","凉","微笑","夏天","海滩","太阳 眼镜","face","cool","smile","summer","beach","sunglass"],k:[30,49],l:["8)"],o:2},butter:{a:"Butter",b:"1F9C8",d:!0,e:!0,f:!0,h:!0,k:[44,16],o:12,j:["牛油"]},roller_coaster:{a:"Roller Coaster",b:"1F3A2",d:!0,e:!0,f:!0,h:!0,j:["过山车","狂欢节","操场","相片","乐趣","carnival","playground","photo","fun"],k:[8,8],o:2},turkey:{a:"Turkey",b:"1F983",d:!0,e:!0,f:!0,h:!0,j:["火鸡","动物","鸟","animal","bird"],k:[42,21],o:2},nazar_amulet:{a:"Nazar Amulet",b:"1F9FF",d:!0,e:!0,f:!0,h:!0,k:[51,50],o:11,j:["纳扎尔护身符"]},"flag-cu":{a:"Cuba Flag",b:"1F1E8-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[1,26],o:2,j:["古巴国旗"]},aries:{a:"Aries",b:"2648",d:!0,e:!0,f:!0,h:!0,j:["白羊座","标志","紫色方块","黄道带","占星学","sign","purple-square","zodiac","astrology"],k:[53,20],o:2},"flag-cv":{a:"Cape Verde Flag",b:"1F1E8-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[1,27],o:2,j:["佛得角国旗"]},barber:{a:"Barber Pole",b:"1F488",d:!0,e:!0,f:!0,h:!0,j:["理发店招牌","毛","客厅","风格","hair","salon","style"],k:[25,18],o:2},taurus:{a:"Taurus",b:"2649",d:!0,e:!0,f:!0,h:!0,j:["金牛座","紫色方块","标志","黄道带","占星学","purple-square","sign","zodiac","astrology"],k:[53,21],o:2},salt:{a:"Salt Shaker",b:"1F9C2",d:!0,e:!0,f:!0,h:!0,k:[44,10],o:11,j:["盐"]},woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB",non_qualified:null,image:"1f469-1f3fb.png",sheet_x:20,sheet_y:10,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC",non_qualified:null,image:"1f469-1f3fc.png",sheet_x:20,sheet_y:11,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD",non_qualified:null,image:"1f469-1f3fd.png",sheet_x:20,sheet_y:12,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE",non_qualified:null,image:"1f469-1f3fe.png",sheet_x:20,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF",non_qualified:null,image:"1f469-1f3ff.png",sheet_x:20,sheet_y:14,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Woman",b:"1F469",d:!0,e:!0,f:!0,h:!0,j:["女人","女性","女孩","女士","female","girls","lady"],k:[20,9],o:2},video_game:{a:"Video Game",b:"1F3AE",d:!0,e:!0,f:!0,h:!0,j:["电玩游戏","玩","安慰","断续器","控制器","play","console","PS4","controller"],k:[8,20],o:2},chicken:{a:"Chicken",b:"1F414",d:!0,e:!0,f:!0,h:!0,j:["鸡","动物","咯咯","自然界","鸟","animal","cluck","nature","bird"],k:[11,48],o:2},radio:{a:"Radio",b:"1F4FB",d:!0,e:!0,f:!0,h:!0,j:["收音机","通信","音乐","播客","程序","communication","music","podcast","program"],k:[27,24],o:2},nerd_face:{a:"Nerd Face",b:"1F913",d:!0,e:!0,f:!0,h:!0,j:["书呆子的脸","脸","宅","怪胎","笨蛋","face","nerdy","geek","dork"],k:[37,26],o:2},red_haired_woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9B0",non_qualified:null,image:"1f469-1f3fb-200d-1f9b0.png",sheet_x:19,sheet_y:9,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9B0",non_qualified:null,image:"1f469-1f3fc-200d-1f9b0.png",sheet_x:19,sheet_y:10,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9B0",non_qualified:null,image:"1f469-1f3fd-200d-1f9b0.png",sheet_x:19,sheet_y:11,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9B0",non_qualified:null,image:"1f469-1f3fe-200d-1f9b0.png",sheet_x:19,sheet_y:12,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9B0",non_qualified:null,image:"1f469-1f3ff-200d-1f9b0.png",sheet_x:19,sheet_y:13,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Red Haired Woman",b:"1F469-200D-1F9B0",d:!0,e:!0,f:!0,h:!0,k:[19,8],o:11,j:["红发女人"]},circus_tent:{a:"Circus Tent",b:"1F3AA",d:!0,e:!0,f:!0,h:!0,j:["马戏团的帐篷","节日","狂欢节","党","festival","carnival","party"],k:[8,16],o:2},face_with_monocle:{a:"Face with Monocle",b:"1F9D0",d:!0,e:!0,f:!0,h:!0,k:[45,16],o:5,j:["带有单片眼镜的脸"]},canned_food:{a:"Canned Food",b:"1F96B",d:!0,e:!0,f:!0,h:!0,k:[42,1],o:5,j:["罐头食品"]},"flag-cw":{a:"Curaçao Flag",b:"1F1E8-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[1,28],o:2,j:["库拉索国旗"]},gemini:{a:"Gemini",b:"264A",d:!0,e:!0,f:!0,h:!0,j:["双子座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,22],o:2},saxophone:{a:"Saxophone",b:"1F3B7",d:!0,e:!0,f:!0,h:!0,j:["萨克斯管","音乐","仪器","爵士乐","蓝调","music","instrument","jazz","blues"],k:[8,29],o:2},rooster:{a:"Rooster",b:"1F413",d:!0,e:!0,f:!0,h:!0,j:["公鸡","动物","自然界","鸡","animal","nature","chicken"],k:[11,47],o:2},joystick:{a:"Joystick",b:"1F579-FE0F",c:"1F579",d:!0,e:!0,f:!0,h:!0,j:["游戏杆","游戏","玩","game","play"],k:[29,36],o:2},guitar:{a:"Guitar",b:"1F3B8",d:!0,e:!0,f:!0,h:!0,j:["吉他","音乐","仪器","music","instrument"],k:[8,30],o:2},slot_machine:{a:"Slot Machine",b:"1F3B0",d:!0,e:!0,f:!0,h:!0,j:["老虎机","但","赌博","维加斯","水果机","运气","赌场","bet","gamble","vegas","fruit machine","luck","casino"],k:[8,22],o:2},bento:{a:"Bento Box",b:"1F371",d:!0,e:!0,f:!0,h:!0,j:["便当盒","食物","日语","箱","food","japanese","box"],k:[7,16],o:2},steam_locomotive:{a:"Steam Locomotive",b:"1F682",d:!0,e:!0,f:!0,h:!0,j:["火车头","运输","车辆","火车","transportation","vehicle","train"],k:[34,1],o:2},confused:{a:"Confused Face",b:"1F615",d:!0,e:!0,f:!0,h:!0,j:["困惑的脸","脸","冷漠","哼","奇怪","嗯嗯",":/","face","indifference","huh","weird","hmmm",":/"],k:[30,56],l:[":\\",":-\\",":/",":-/"],o:2},"flag-cx":{a:"ChristmasIslandFlag",b:"1F1E8-1F1FD",d:!0,e:!0,f:!0,h:!0,k:[1,29],o:2,j:["圣诞岛旗"]},hatching_chick:{a:"HatchingChick",b:"1F423",d:!0,e:!0,f:!0,h:!0,j:["孵化小鸡","动物","鸡","蛋","出生","婴儿","鸟","animal","chicken","egg","born","baby","bird"],k:[12,7],o:2},cancer:{a:"Cancer",b:"264B",d:!0,e:!0,f:!0,h:!0,j:["巨蟹座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,23],o:2},red_haired_person:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9b0.png",sheet_x:47,sheet_y:14,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9b0.png",sheet_x:47,sheet_y:15,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9b0.png",sheet_x:47,sheet_y:16,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9b0.png",sheet_x:47,sheet_y:17,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9B0",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9b0.png",sheet_x:47,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"RedHairedPerson",b:"1F9D1-200D-1F9B0",d:!0,e:!1,f:!1,h:!1,k:[47,13],o:12,j:["红发"]},"flag-cy":{a:"CyprusFlag",b:"1F1E8-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[1,30],o:2,j:["塞浦路斯国旗"]},worried:{a:"WorriedFace",b:"1F61F",d:!0,e:!0,f:!0,h:!0,j:["忧心忡忡的脸","脸","关注","紧张",":(","face","concern","nervous",":("],k:[31,9],o:2},railway_car:{a:"RailwayCar",b:"1F683",d:!0,e:!0,f:!0,h:!0,j:["铁路车","运输","车辆","transportation","vehicle"],k:[34,2],o:2},leo:{a:"Leo",b:"264C",d:!0,e:!0,f:!0,h:!0,j:["狮子座","标志","紫色方块","黄道带","占星学","sign","purple-square","zodiac","astrology"],k:[53,24],o:2},curly_haired_woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9B1",non_qualified:null,image:"1f469-1f3fb-200d-1f9b1.png",sheet_x:19,sheet_y:15,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9B1",non_qualified:null,image:"1f469-1f3fc-200d-1f9b1.png",sheet_x:19,sheet_y:16,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9B1",non_qualified:null,image:"1f469-1f3fd-200d-1f9b1.png",sheet_x:19,sheet_y:17,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9B1",non_qualified:null,image:"1f469-1f3fe-200d-1f9b1.png",sheet_x:19,sheet_y:18,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9B1",non_qualified:null,image:"1f469-1f3ff-200d-1f9b1.png",sheet_x:19,sheet_y:19,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"CurlyHairedWoman",b:"1F469-200D-1F9B1",d:!0,e:!0,f:!0,h:!0,k:[19,14],o:11,j:["卷发女人"]},baby_chick:{a:"BabyChick",b:"1F424",d:!0,e:!0,f:!0,h:!0,j:["小鸡","动物","鸡","鸟","animal","chicken","bird"],k:[12,8],o:2},musical_keyboard:{a:"MusicalKeyboard",b:"1F3B9",d:!0,e:!0,f:!0,h:!0,j:["音乐键盘","计划","仪器","组成","piano","instrument","compose"],k:[8,31],o:2},game_die:{a:"GameDie",b:"1F3B2",d:!0,e:!0,f:!0,h:!0,j:["骰子","说","随机","桌面","玩","运气","dice","random","tabletop","play","luck"],k:[8,24],o:2},rice_cracker:{a:"RiceCracker",b:"1F358",d:!0,e:!0,f:!0,h:!0,j:["米果","食物","日语","food","japanese"],k:[6,48],o:2},virgo:{a:"Virgo",b:"264D",d:!0,e:!0,f:!0,h:!0,j:["处女座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,25],o:2},"flag-cz":{a:"CzechiaFlag",b:"1F1E8-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[1,31],o:2,j:["捷克国旗"]},curly_haired_person:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9b1.png",sheet_x:47,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9b1.png",sheet_x:47,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9b1.png",sheet_x:47,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9b1.png",sheet_x:47,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9B1",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9b1.png",sheet_x:47,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"CurlyHairedPerson",b:"1F9D1-200D-1F9B1",d:!0,e:!1,f:!1,h:!1,k:[47,19],o:12,j:["卷发"]},rice_ball:{a:"RiceBall",b:"1F359",d:!0,e:!0,f:!0,h:!0,j:["饭团","食物","日语","food","japanese"],k:[6,49],o:2},hatched_chick:{a:"Front-FacingBabyChick",b:"1F425",d:!0,e:!0,f:!0,h:!0,j:["面向前的小鸡","动物","鸡","婴儿","鸟","animal","chicken","baby","bird"],k:[12,9],o:2},jigsaw:{a:"JigsawPuzzlePiece",b:"1F9E9",d:!0,e:!0,f:!0,h:!0,k:[51,28],o:11,j:["一块拼图"]},trumpet:{a:"Trumpet",b:"1F3BA",d:!0,e:!0,f:!0,h:!0,j:["喇叭","音乐","黄铜","music","brass"],k:[8,32],o:2},slightly_frowning_face:{a:"SlightlyFrowningFace",b:"1F641",d:!0,e:!0,f:!0,h:!0,j:["微微皱眉的脸","脸","皱 着 眉头","失望","伤心","沮丧","face","frowning","disappointed","sad","upset"],k:[31,43],o:2},bullettrain_side:{a:"High-SpeedTrain",b:"1F684",d:!0,e:!0,f:!0,h:!0,j:["高速火车","运输","车辆","transportation","vehicle"],k:[34,3],o:2},libra:{a:"Libra",b:"264E",d:!0,e:!0,f:!0,h:!0,j:["天秤座","标志","紫色方块","黄道带","占星学","sign","purple-square","zodiac","astrology"],k:[53,26],o:2},de:{a:"GermanyFlag",b:"1F1E9-1F1EA",d:!0,e:!0,f:!0,h:!0,j:["德国国旗","德语","国家","旗","国家","旗帜","german","nation","flag","country","banner"],k:[1,32],n:["flag-de"],o:2},rice:{a:"CookedRice",b:"1F35A",d:!0,e:!0,f:!0,h:!0,j:["熟米饭","食物","中国","亚裔","food","china","asian"],k:[6,50],o:2},violin:{a:"Violin",b:"1F3BB",d:!0,e:!0,f:!0,h:!0,j:["小提琴","音乐","仪器","管弦乐队","交响曲","music","instrument","orchestra","symphony"],k:[8,33],o:2},white_haired_woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9B3",non_qualified:null,image:"1f469-1f3fb-200d-1f9b3.png",sheet_x:19,sheet_y:27,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9B3",non_qualified:null,image:"1f469-1f3fc-200d-1f9b3.png",sheet_x:19,sheet_y:28,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9B3",non_qualified:null,image:"1f469-1f3fd-200d-1f9b3.png",sheet_x:19,sheet_y:29,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9B3",non_qualified:null,image:"1f469-1f3fe-200d-1f9b3.png",sheet_x:19,sheet_y:30,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9B3",non_qualified:null,image:"1f469-1f3ff-200d-1f9b3.png",sheet_x:19,sheet_y:31,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WhiteHairedWoman",b:"1F469-200D-1F9B3",d:!0,e:!0,f:!0,h:!0,k:[19,26],o:11,j:["白头发女人"]},bird:{a:"Bird",b:"1F426",d:!0,e:!0,f:!0,h:!0,j:["鸟","动物","自然界","飞","鸣叫","春天","animal","nature","fly","tweet","spring"],k:[12,10],o:2},white_frowning_face:{a:"WhiteFrowningFace",b:"2639-FE0F",c:"2639",d:!0,e:!0,f:!0,h:!0,k:[53,16],o:2,j:["皱眉表情"]},bullettrain_front:{a:"High-SpeedTrainwithBulletNose",b:"1F685",d:!0,e:!0,f:!0,h:!0,j:["子弹头列车","运输","车辆","速度","几乎","公共","旅行","transportation","vehicle","speed","fast","public","travel"],k:[34,4],o:2},teddy_bear:{a:"TeddyBear",b:"1F9F8",d:!0,e:!0,f:!0,h:!0,k:[51,43],o:11,j:["泰迪熊"]},white_haired_person:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9b3.png",sheet_x:47,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9b3.png",sheet_x:47,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9b3.png",sheet_x:47,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9b3.png",sheet_x:47,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9B3",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9b3.png",sheet_x:47,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"WhiteHairedPerson",b:"1F9D1-200D-1F9B3",d:!0,e:!1,f:!1,h:!1,k:[47,31],o:12,j:["白发"]},spades:{a:"BlackSpadeSuit",b:"2660-FE0F",c:"2660",d:!0,e:!0,f:!0,h:!0,j:["黑桃","扑克","卡","适合","魔法","poker","cards","suits","magic"],k:[53,33],o:2},banjo:{a:"Banjo",b:"1FA95",d:!0,e:!0,f:!0,h:!0,k:[52,9],o:12,j:["班卓琴"]},train2:{a:"Train",b:"1F686",d:!0,e:!0,f:!0,h:!0,j:["火车","运输","车辆","transportation","vehicle"],k:[34,5],o:2},scorpius:{a:"Scorpius",b:"264F",d:!0,e:!0,f:!0,h:!0,j:["天蝎座","标志","黄道带","紫色方块","占星学","天蝎座","sign","zodiac","purple-square","astrology","scorpio"],k:[53,27],o:2},curry:{a:"CurryandRice",b:"1F35B",d:!0,e:!0,f:!0,h:!0,j:["咖喱饭","食物","辣","热","印度","food","spicy","hot","indian"],k:[6,51],o:2},open_mouth:{a:"FacewithOpenMouth",b:"1F62E",d:!0,e:!0,f:!0,h:!0,j:["张着嘴的脸","脸","惊喜","印象","哇","哇","：O","face","surprise","impressed","wow","whoa",":O"],k:[31,24],l:[":o",":-o",":O",":-O"],o:2},"flag-dg":{a:"DiegoGarciaFlag",b:"1F1E9-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[1,33],o:2,j:["迪戈加西亚旗"]},penguin:{a:"Penguin",b:"1F427",d:!0,e:!0,f:!0,h:!0,j:["企鹅","动物","自然界","animal","nature"],k:[12,11],o:2},hearts:{a:"BlackHeartSuit",b:"2665-FE0F",c:"2665",d:!0,e:!0,f:!0,h:!0,j:["红心","扑克","卡","魔法","适合","poker","cards","magic","suits"],k:[53,35],o:2},ramen:{a:"SteamingBowl",b:"1F35C",d:!0,e:!0,f:!0,h:!0,j:["热气腾腾的拉面","食物","日语","面条","筷子","food","japanese","noodle","chopsticks"],k:[6,52],o:2},sagittarius:{a:"Sagittarius",b:"2650",d:!0,e:!0,f:!0,h:!0,j:["射手座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,28],o:2},bald_woman:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9B2",non_qualified:null,image:"1f469-1f3fb-200d-1f9b2.png",sheet_x:19,sheet_y:21,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9B2",non_qualified:null,image:"1f469-1f3fc-200d-1f9b2.png",sheet_x:19,sheet_y:22,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9B2",non_qualified:null,image:"1f469-1f3fd-200d-1f9b2.png",sheet_x:19,sheet_y:23,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9B2",non_qualified:null,image:"1f469-1f3fe-200d-1f9b2.png",sheet_x:19,sheet_y:24,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9B2",non_qualified:null,image:"1f469-1f3ff-200d-1f9b2.png",sheet_x:19,sheet_y:25,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"BaldWoman",b:"1F469-200D-1F9B2",d:!0,e:!0,f:!0,h:!0,k:[19,20],o:11,j:["光头女人"]},dove_of_peace:{a:"DoveofPeace",b:"1F54A-FE0F",c:"1F54A",d:!0,e:!0,f:!0,h:!0,k:[28,34],o:2,j:["鸽子"]},hushed:{a:"HushedFace",b:"1F62F",d:!0,e:!0,f:!0,h:!0,j:["噤声的脸","脸","追求","嘘","face","woo","shh"],k:[31,25],o:2},metro:{a:"Metro",b:"1F687",d:!0,e:!0,f:!0,h:!0,j:["地铁","运输","蓝色方块","捷运","地下","管","transportation","blue-square","mrt","underground","tube"],k:[34,6],o:2},"flag-dj":{a:"DjiboutiFlag",b:"1F1E9-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[1,34],o:2,j:["吉布提国旗"]},drum_with_drumsticks:{a:"DrumwithDrumsticks",b:"1F941",d:!0,e:!0,f:!0,h:!0,k:[41,17],o:4,j:["鼓"]},spaghetti:{a:"Spaghetti",b:"1F35D",d:!0,e:!0,f:!0,h:!0,j:["意大利面","食物","意大利语","面条","food","italian","noodle"],k:[6,53],o:2},eagle:{a:"Eagle",b:"1F985",d:!0,e:!0,f:!0,h:!0,j:["鹰","动物","自然界","鸟","animal","nature","bird"],k:[42,23],o:4},astonished:{a:"AstonishedFace",b:"1F632",d:!0,e:!0,f:!0,h:!0,j:["惊讶的脸","脸","异种","惊讶","中毒","face","xox","surprised","poisoned"],k:[31,28],o:2},capricorn:{a:"Capricorn",b:"2651",d:!0,e:!0,f:!0,h:!0,j:["摩羯座","标志","黄道带","紫色方块","占星学","sign","zodiac","purple-square","astrology"],k:[53,29],o:2},light_rail:{a:"LightRail",b:"1F688",d:!0,e:!0,f:!0,h:!0,j:["轻轨列车","运输","车辆","transportation","vehicle"],k:[34,7],o:2},"flag-dk":{a:"DenmarkFlag",b:"1F1E9-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[1,35],o:2,j:["丹麦国旗"]},iphone:{a:"MobilePhone",b:"1F4F1",d:!0,e:!0,f:!0,h:!0,j:["手机","科技","苹果","产品","拨号","technology","apple","gadgets","dial"],k:[27,14],o:2},bald_person:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9b2.png",sheet_x:47,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9b2.png",sheet_x:47,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9b2.png",sheet_x:47,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9b2.png",sheet_x:47,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9B2",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9b2.png",sheet_x:47,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"BaldPerson",b:"1F9D1-200D-1F9B2",d:!0,e:!1,f:!1,h:!1,k:[47,25],o:12,j:["秃顶男子","光头男子","光头男子"]},diamonds:{a:"BlackDiamondSuit",b:"2666-FE0F",c:"2666",d:!0,e:!0,f:!0,h:!0,j:["钻石","扑克","卡","魔法","适合","poker","cards","magic","suits"],k:[53,36],o:2},clubs:{a:"BlackClubSuit",b:"2663-FE0F",c:"2663",d:!0,e:!0,f:!0,h:!0,j:["梅花","扑克","卡","魔法","适合","poker","cards","magic","suits"],k:[53,34],o:2},aquarius:{a:"Aquarius",b:"2652",d:!0,e:!0,f:!0,h:!0,j:["水瓶座","标志","紫色方块","黄道带","占星学","sign","purple-square","zodiac","astrology"],k:[53,30],o:2},sweet_potato:{a:"RoastedSweetPotato",b:"1F360",d:!0,e:!0,f:!0,h:!0,j:["红薯","食物","自然界","food","nature"],k:[6,56],o:2},"flag-dm":{a:"DominicaFlag",b:"1F1E9-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[1,36],o:2,j:["多米尼加国旗"]},duck:{a:"Duck",b:"1F986",d:!0,e:!0,f:!0,h:!0,j:["鸭","动物","自然界","鸟","马拉德","animal","nature","bird","mallard"],k:[42,24],o:4},calling:{a:"MobilePhonewithRightwardsArrowatLeft",b:"1F4F2",d:!0,e:!0,f:!0,h:!0,j:["带箭头的手机","苹果手机","传入","iphone","incoming"],k:[27,15],o:2},station:{a:"Station",b:"1F689",d:!0,e:!0,f:!0,h:!0,j:["站","运输","车辆","公共","transportation","vehicle","public"],k:[34,8],o:2},"blond-haired-woman":{skin_variations:{"1F3FB":{unified:"1F471-1F3FB-200D-2640-FE0F",non_qualified:"1F471-1F3FB-200D-2640",image:"1f471-1f3fb-200d-2640-fe0f.png",sheet_x:22,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F471-1F3FC-200D-2640-FE0F",non_qualified:"1F471-1F3FC-200D-2640",image:"1f471-1f3fc-200d-2640-fe0f.png",sheet_x:22,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F471-1F3FD-200D-2640-FE0F",non_qualified:"1F471-1F3FD-200D-2640",image:"1f471-1f3fd-200d-2640-fe0f.png",sheet_x:22,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F471-1F3FE-200D-2640-FE0F",non_qualified:"1F471-1F3FE-200D-2640",image:"1f471-1f3fe-200d-2640-fe0f.png",sheet_x:22,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F471-1F3FF-200D-2640-FE0F",non_qualified:"1F471-1F3FF-200D-2640",image:"1f471-1f3ff-200d-2640-fe0f.png",sheet_x:22,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"BlondHairedWoman",b:"1F471-200D-2640-FE0F",c:"1F471-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[22,7],o:4,j:["金发女人"]},flushed:{a:"FlushedFace",b:"1F633",d:!0,e:!0,f:!0,h:!0,j:["红扑扑的脸","脸","脸红","害羞","受宠若惊","face","blush","shy","flattered"],k:[31,29],o:2},pisces:{a:"Pisces",b:"2653",d:!0,e:!0,f:!0,h:!0,j:["双鱼座","紫色方块","标志","黄道带","占星学","purple-square","sign","zodiac","astrology"],k:[53,31],o:2},chess_pawn:{a:"ChessPawn",b:"265F-FE0F",c:"265F",d:!0,e:!0,f:!0,h:!0,k:[53,32],o:11,j:["西洋棋"]},"blond-haired-man":{skin_variations:{"1F3FB":{unified:"1F471-1F3FB-200D-2642-FE0F",non_qualified:"1F471-1F3FB-200D-2642",image:"1f471-1f3fb-200d-2642-fe0f.png",sheet_x:22,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F471-1F3FC-200D-2642-FE0F",non_qualified:"1F471-1F3FC-200D-2642",image:"1f471-1f3fc-200d-2642-fe0f.png",sheet_x:22,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F471-1F3FD-200D-2642-FE0F",non_qualified:"1F471-1F3FD-200D-2642",image:"1f471-1f3fd-200d-2642-fe0f.png",sheet_x:22,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F471-1F3FE-200D-2642-FE0F",non_qualified:"1F471-1F3FE-200D-2642",image:"1f471-1f3fe-200d-2642-fe0f.png",sheet_x:22,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F471-1F3FF-200D-2642-FE0F",non_qualified:"1F471-1F3FF-200D-2642",image:"1f471-1f3ff-200d-2642-fe0f.png",sheet_x:22,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F471",a:"BlondHairedMan",b:"1F471-200D-2642-FE0F",c:"1F471-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[22,13],o:4,j:["金发男人"]},phone:{a:"BlackTelephone",b:"260E-FE0F",c:"260E",d:!0,e:!0,f:!0,h:!0,j:["电话","科技","通信","拨号","电话","technology","communication","dial","telephone"],k:[52,54],n:["telephone"],o:2},oden:{a:"Oden",b:"1F362",d:!0,e:!0,f:!0,h:!0,j:["关东煮","食物","日语","food","japanese"],k:[7,1],o:2},"flag-do":{a:"DominicanRepublicFlag",b:"1F1E9-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[1,37],o:2,j:["多米尼加共和国国旗"]},tram:{a:"Tram",b:"1F68A",d:!0,e:!0,f:!0,h:!0,j:["电车","运输","车辆","transportation","vehicle"],k:[34,9],o:2},swan:{a:"Swan",b:"1F9A2",d:!0,e:!0,f:!0,h:!0,k:[42,52],o:11,j:["天鹅"]},pleading_face:{a:"FacewithPleadingEyes",b:"1F97A",d:!0,e:!0,f:!0,h:!0,k:[42,12],o:11,j:["苦苦哀求的脸"]},"flag-dz":{a:"AlgeriaFlag",b:"1F1E9-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[1,38],o:2,j:["阿尔及利亚国旗"]},monorail:{a:"Monorail",b:"1F69D",d:!0,e:!0,f:!0,h:!0,j:["单轨电车","运输","车辆","transportation","vehicle"],k:[34,28],o:2},owl:{a:"Owl",b:"1F989",d:!0,e:!0,f:!0,h:!0,j:["猫头鹰","动物","自然界","鸟","叫声","animal","nature","bird","hoot"],k:[42,27],o:4},sushi:{a:"Sushi",b:"1F363",d:!0,e:!0,f:!0,h:!0,j:["寿司","食物","鱼","日语","米","food","fish","japanese","rice"],k:[7,2],o:2},telephone_receiver:{a:"TelephoneReceiver",b:"1F4DE",d:!0,e:!0,f:!0,h:!0,j:["电话受话器","科技","通信","拨号","technology","communication","dial"],k:[26,52],o:2},black_joker:{a:"PlayingCardBlackJoker",b:"1F0CF",d:!0,e:!0,f:!0,h:!0,j:["鬼牌","扑克","卡","游戏","玩","魔法","poker","cards","game","play","magic"],k:[0,15],o:2},ophiuchus:{a:"Ophiuchus",b:"26CE",d:!0,e:!0,f:!0,h:!0,j:["蛇夫座","标志","紫色方块","星座","占星学","sign","purple-square","constellation","astrology"],k:[54,4],o:2},frowning:{a:"FrowningFacewithOpenMouth",b:"1F626",d:!0,e:!0,f:!0,h:!0,j:["皱眉张嘴的脸","脸","唉","什么","face","aw","what"],k:[31,16],o:2},older_adult:{skin_variations:{"1F3FB":{unified:"1F9D3-1F3FB",non_qualified:null,image:"1f9d3-1f3fb.png",sheet_x:48,sheet_y:23,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D3-1F3FC",non_qualified:null,image:"1f9d3-1f3fc.png",sheet_x:48,sheet_y:24,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D3-1F3FD",non_qualified:null,image:"1f9d3-1f3fd.png",sheet_x:48,sheet_y:25,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D3-1F3FE",non_qualified:null,image:"1f9d3-1f3fe.png",sheet_x:48,sheet_y:26,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D3-1F3FF",non_qualified:null,image:"1f9d3-1f3ff.png",sheet_x:48,sheet_y:27,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"OlderAdult",b:"1F9D3",d:!0,e:!0,f:!0,h:!0,k:[48,22],o:5,j:["老年人"]},"flag-ea":{a:"Ceuta&MelillaFlag",b:"1F1EA-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[1,39],o:2,j:["休达和梅利利亚国旗"]},flamingo:{a:"Flamingo",b:"1F9A9",d:!0,e:!0,f:!0,h:!0,k:[43,0],o:12,j:["红鹳"]},pager:{a:"Pager",b:"1F4DF",d:!0,e:!0,f:!0,h:!0,j:["呼叫器","英国广播公司","老派","90年代","bbcall","oldschool","90s"],k:[26,53],o:2},mountain_railway:{a:"MountainRailway",b:"1F69E",d:!0,e:!0,f:!0,h:!0,j:["山区铁路","运输","车辆","transportation","vehicle"],k:[34,29],o:2},mahjong:{a:"MahjongTileRedDragon",b:"1F004",d:!0,e:!0,f:!0,h:!0,j:["红中（麻将）","游戏","玩","中文","汉字","game","play","chinese","kanji"],k:[0,14],o:2},older_man:{skin_variations:{"1F3FB":{unified:"1F474-1F3FB",non_qualified:null,image:"1f474-1f3fb.png",sheet_x:22,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F474-1F3FC",non_qualified:null,image:"1f474-1f3fc.png",sheet_x:22,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F474-1F3FD",non_qualified:null,image:"1f474-1f3fd.png",sheet_x:22,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F474-1F3FE",non_qualified:null,image:"1f474-1f3fe.png",sheet_x:22,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F474-1F3FF",non_qualified:null,image:"1f474-1f3ff.png",sheet_x:22,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"OlderMan",b:"1F474",d:!0,e:!0,f:!0,h:!0,j:["老爷爷","人","雄","男人","老","长老","前辈","human","male","men","old","elder","senior"],k:[22,49],o:2},twisted_rightwards_arrows:{a:"TwistedRightwardsArrows",b:"1F500",d:!0,e:!0,f:!0,h:!0,j:["随机曲目按钮","蓝色方块","洗牌","音乐","随机","blue-square","shuffle","music","random"],k:[27,28],o:2},fried_shrimp:{a:"FriedShrimp",b:"1F364",d:!0,e:!0,f:!0,h:!0,j:["炸虾","食物","动物","前菜","夏天","food","animal","appetizer","summer"],k:[7,3],o:2},anguished:{a:"AnguishedFace",b:"1F627",d:!0,e:!0,f:!0,h:!0,j:["震惊的脸","脸","震惊","紧张","face","stunned","nervous"],k:[31,17],l:["D:"],o:2},repeat:{a:"ClockwiseRightwardsandLeftwardsOpenCircleArrows",b:"1F501",d:!0,e:!0,f:!0,h:!0,j:["循环播放按钮","圈","记录","loop","record"],k:[27,29],o:2},fish_cake:{a:"FishCakewithSwirlDesign",b:"1F365",d:!0,e:!0,f:!0,h:!0,j:["鱼板","食物","日本","海","海滩","名嗣","粉红色","旋流","鱼糕","鱼糜","估计","food","japan","sea","beach","narutomaki","pink","swirl","kamaboko","surimi","ramen"],k:[7,4],o:2},fax:{a:"FaxMachine",b:"1F4E0",d:!0,e:!0,f:!0,h:!0,j:["传真机","通信","科技","communication","technology"],k:[26,54],o:2},older_woman:{skin_variations:{"1F3FB":{unified:"1F475-1F3FB",non_qualified:null,image:"1f475-1f3fb.png",sheet_x:22,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F475-1F3FC",non_qualified:null,image:"1f475-1f3fc.png",sheet_x:23,sheet_y:0,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F475-1F3FD",non_qualified:null,image:"1f475-1f3fd.png",sheet_x:23,sheet_y:1,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F475-1F3FE",non_qualified:null,image:"1f475-1f3fe.png",sheet_x:23,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F475-1F3FF",non_qualified:null,image:"1f475-1f3ff.png",sheet_x:23,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"OlderWoman",b:"1F475",d:!0,e:!0,f:!0,h:!0,j:["老婆婆","人","女性","女人","女士","老","长老","前辈","human","female","women","lady","old","elder","senior"],k:[22,55],o:2},"flag-ec":{a:"EcuadorFlag",b:"1F1EA-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[1,40],o:2,j:["厄瓜多尔国旗"]},peacock:{a:"Peacock",b:"1F99A",d:!0,e:!0,f:!0,h:!0,k:[42,44],o:11,j:["孔雀"]},fearful:{a:"FearfulFace",b:"1F628",d:!0,e:!0,f:!0,h:!0,j:["充满恐惧的脸","脸","害怕","害怕","紧张","哎呀","哼","face","scared","terrified","nervous","oops","huh"],k:[31,18],o:2},train:{a:"TramCar",b:"1F68B",d:!0,e:!0,f:!0,h:!0,j:["电车","运输","车辆","运输","公共","旅行","transportation","vehicle","carriage","public","travel"],k:[34,10],o:2},flower_playing_cards:{a:"FlowerPlayingCards",b:"1F3B4",d:!0,e:!0,f:!0,h:!0,j:["花扑克牌","游戏","日落","红","game","sunset","red"],k:[8,26],o:2},repeat_one:{a:"ClockwiseRightwardsandLeftwardsOpenCircleArrowswithCircledOneOverlay",b:"1F502",d:!0,e:!0,f:!0,h:!0,j:["单曲循环按钮","蓝色方块","圈","blue-square","loop"],k:[27,30],o:2},moon_cake:{a:"MoonCake",b:"1F96E",d:!0,e:!0,f:!0,h:!0,k:[42,4],o:11,j:["月饼"]},performing_arts:{a:"PerformingArts",b:"1F3AD",d:!0,e:!0,f:!0,h:!0,j:["表演艺术","演技","剧院","戏剧","acting","theater","drama"],k:[8,19],o:2},cold_sweat:{a:"FacewithOpenMouthandColdSweat",b:"1F630",d:!0,e:!0,f:!0,h:!0,j:["冒冷汗且焦虑的脸","脸","紧张","汗","face","nervous","sweat"],k:[31,26],o:2},person_frowning:{skin_variations:{"1F3FB":{unified:"1F64D-1F3FB",non_qualified:null,image:"1f64d-1f3fb.png",sheet_x:33,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F64D-1F3FC",non_qualified:null,image:"1f64d-1f3fc.png",sheet_x:33,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F64D-1F3FD",non_qualified:null,image:"1f64d-1f3fd.png",sheet_x:33,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F64D-1F3FE",non_qualified:null,image:"1f64d-1f3fe.png",sheet_x:33,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F64D-1F3FF",non_qualified:null,image:"1f64d-1f3ff.png",sheet_x:33,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F64D-200D-2640-FE0F",a:"PersonFrowning",b:"1F64D",d:!0,e:!0,f:!0,h:!1,k:[33,26],o:2,j:["皱眉的人"]},"flag-ee":{a:"EstoniaFlag",b:"1F1EA-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[1,41],o:2,j:["爱沙尼亚国旗"]},battery:{a:"Battery",b:"1F50B",d:!0,e:!0,f:!0,h:!0,j:["电池","权力","能源","维持","power","energy","sustain"],k:[27,39],o:2},parrot:{a:"Parrot",b:"1F99C",d:!0,e:!0,f:!0,h:!0,k:[42,46],o:11,j:["鹦鹉"]},bus:{a:"Bus",b:"1F68C",d:!0,e:!0,f:!0,h:!0,j:["总线","汽车","车辆","运输","car","vehicle","transportation"],k:[34,11],o:2},"flag-eg":{a:"EgyptFlag",b:"1F1EA-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[1,42],o:2,j:["埃及国旗"]},arrow_forward:{a:"BlackRight-PointingTriangle",b:"25B6-FE0F",c:"25B6",d:!0,e:!0,f:!0,h:!0,j:["播放按钮","蓝色方块","右","方向","玩","blue-square","right","direction","play"],k:[52,43],o:2},"man-frowning":{skin_variations:{"1F3FB":{unified:"1F64D-1F3FB-200D-2642-FE0F",non_qualified:"1F64D-1F3FB-200D-2642",image:"1f64d-1f3fb-200d-2642-fe0f.png",sheet_x:33,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64D-1F3FC-200D-2642-FE0F",non_qualified:"1F64D-1F3FC-200D-2642",image:"1f64d-1f3fc-200d-2642-fe0f.png",sheet_x:33,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64D-1F3FD-200D-2642-FE0F",non_qualified:"1F64D-1F3FD-200D-2642",image:"1f64d-1f3fd-200d-2642-fe0f.png",sheet_x:33,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64D-1F3FE-200D-2642-FE0F",non_qualified:"1F64D-1F3FE-200D-2642",image:"1f64d-1f3fe-200d-2642-fe0f.png",sheet_x:33,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64D-1F3FF-200D-2642-FE0F",non_qualified:"1F64D-1F3FF-200D-2642",image:"1f64d-1f3ff-200d-2642-fe0f.png",sheet_x:33,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManFrowning",b:"1F64D-200D-2642-FE0F",c:"1F64D-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[33,20],o:4,j:["男人皱着眉头"]},disappointed_relieved:{a:"DisappointedbutRelievedFace",b:"1F625",d:!0,e:!0,f:!0,h:!0,j:["伤心但释然的脸","脸","唷","汗","紧张","face","phew","sweat","nervous"],k:[31,15],o:2},electric_plug:{a:"ElectricPlug",b:"1F50C",d:!0,e:!0,f:!0,h:!0,j:["电插头","充电器","权力","charger","power"],k:[27,40],o:2},frame_with_picture:{a:"FramewithPicture",b:"1F5BC-FE0F",c:"1F5BC",d:!0,e:!0,f:!0,h:!0,k:[30,14],o:2,j:["裱框图片"]},oncoming_bus:{a:"OncomingBus",b:"1F68D",d:!0,e:!0,f:!0,h:!0,j:["迎面驶来的公交","车辆","运输","vehicle","transportation"],k:[34,12],o:2},dango:{a:"Dango",b:"1F361",d:!0,e:!0,f:!0,h:!0,j:["团子","食物","甜点","甜","日语","烤肉","肉","food","dessert","sweet","japanese","barbecue","meat"],k:[7,0],o:2},frog:{a:"FrogFace",b:"1F438",d:!0,e:!0,f:!0,h:!0,j:["青蛙","动物","自然界","发牢骚","蟾蜍","animal","nature","croak","toad"],k:[12,28],o:2},computer:{a:"PersonalComputer",b:"1F4BB",d:!0,e:!0,f:!0,h:!0,j:["笔记本电脑","科技","笔记本","屏幕","显示","监控","technology","laptop","screen","display","monitor"],k:[26,17],o:2},art:{a:"ArtistPalette",b:"1F3A8",d:!0,e:!0,f:!0,h:!0,j:["调色板","设计","漆","画","颜色","design","paint","draw","colors"],k:[8,14],o:2},"flag-eh":{a:"WesternSaharaFlag",b:"1F1EA-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[1,43],o:2,j:["西撒哈拉国旗"]},fast_forward:{a:"BlackRight-PointingDoubleTriangle",b:"23E9",d:!0,e:!0,f:!0,h:!0,j:["快进按钮","蓝色方块","玩","速度","继续","blue-square","play","speed","continue"],k:[52,26],o:2},cry:{a:"CryingFace",b:"1F622",d:!0,e:!0,f:!0,h:!0,j:["哭脸","脸","眼泪","伤心","沮丧","沮丧",":'(","face","tears","sad","depressed","upset",":'("],k:[31,12],l:[":'("],m:":'(",o:2},"woman-frowning":{skin_variations:{"1F3FB":{unified:"1F64D-1F3FB-200D-2640-FE0F",non_qualified:"1F64D-1F3FB-200D-2640",image:"1f64d-1f3fb-200d-2640-fe0f.png",sheet_x:33,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64D-1F3FC-200D-2640-FE0F",non_qualified:"1F64D-1F3FC-200D-2640",image:"1f64d-1f3fc-200d-2640-fe0f.png",sheet_x:33,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64D-1F3FD-200D-2640-FE0F",non_qualified:"1F64D-1F3FD-200D-2640",image:"1f64d-1f3fd-200d-2640-fe0f.png",sheet_x:33,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64D-1F3FE-200D-2640-FE0F",non_qualified:"1F64D-1F3FE-200D-2640",image:"1f64d-1f3fe-200d-2640-fe0f.png",sheet_x:33,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64D-1F3FF-200D-2640-FE0F",non_qualified:"1F64D-1F3FF-200D-2640",image:"1f64d-1f3ff-200d-2640-fe0f.png",sheet_x:33,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F64D",a:"Woman Frowning",b:"1F64D-200D-2640-FE0F",c:"1F64D-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[33,14],o:4,j:["女人皱眉"]},trolleybus:{a:"Trolleybus",b:"1F68E",d:!0,e:!0,f:!0,h:!0,j:["电车","巴特","运输","车辆","bart","transportation","vehicle"],k:[34,13],o:2},crocodile:{a:"Crocodile",b:"1F40A",d:!0,e:!0,f:!0,h:!0,j:["鳄鱼","动物","自然界","爬行动物","蜥蜴","鳄鱼","animal","nature","reptile","lizard","alligator"],k:[11,38],o:2},dumpling:{a:"Dumpling",b:"1F95F",d:!0,e:!0,f:!0,h:!0,k:[41,46],o:5,j:["饺子"]},black_right_pointing_double_triangle_with_vertical_bar:{a:"Black Right Pointing Double Triangle with Vertical Bar",b:"23ED-FE0F",c:"23ED",d:!0,e:!0,f:!0,h:!0,k:[52,30],o:2,j:["下一曲目按钮"]},desktop_computer:{a:"Desktop Computer",b:"1F5A5-FE0F",c:"1F5A5",d:!0,e:!0,f:!0,h:!0,j:["台式电脑","科技","计算机科学","屏幕","technology","computing","screen"],k:[30,10],o:2},person_with_pouting_face:{skin_variations:{"1F3FB":{unified:"1F64E-1F3FB",non_qualified:null,image:"1f64e-1f3fb.png",sheet_x:33,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F64E-1F3FC",non_qualified:null,image:"1f64e-1f3fc.png",sheet_x:33,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F64E-1F3FD",non_qualified:null,image:"1f64e-1f3fd.png",sheet_x:33,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F64E-1F3FE",non_qualified:null,image:"1f64e-1f3fe.png",sheet_x:33,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F64E-1F3FF",non_qualified:null,image:"1f64e-1f3ff.png",sheet_x:33,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F64E-200D-2640-FE0F",a:"Person with Pouting Face",b:"1F64E",d:!0,e:!0,f:!0,h:!1,k:[33,44],o:2,j:["人噘嘴"]},turtle:{a:"Turtle",b:"1F422",d:!0,e:!0,f:!0,h:!0,j:["乌龟","动物","慢","自然界","龟","animal","slow","nature","tortoise"],k:[12,6],o:2},sob:{a:"Loudly Crying Face",b:"1F62D",d:!0,e:!0,f:!0,h:!0,j:["带有两行眼泪的哭脸","脸","哭","眼泪","伤心","沮丧","沮丧","face","cry","tears","sad","upset","depressed"],k:[31,23],m:":'(",o:2},"flag-er":{a:"EritreaFlag",b:"1F1EA-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[1,44],o:2,j:["厄立特里亚国旗"]},thread:{a:"SpoolofThread",b:"1F9F5",d:!0,e:!0,f:!0,h:!0,k:[51,40],o:11,j:["线"]},minibus:{a:"Minibus",b:"1F690",d:!0,e:!0,f:!0,h:!0,j:["小巴","车辆","汽车","运输","vehicle","car","transportation"],k:[34,15],o:2},fortune_cookie:{a:"FortuneCookie",b:"1F960",d:!0,e:!0,f:!0,h:!0,k:[41,47],o:5,j:["幸运饼干"]},yarn:{a:"BallofYarn",b:"1F9F6",d:!0,e:!0,f:!0,h:!0,k:[51,41],o:11,j:["毛线"]},takeout_box:{a:"TakeoutBox",b:"1F961",d:!0,e:!0,f:!0,h:!0,k:[41,48],o:5,j:["外卖盒"]},"man-pouting":{skin_variations:{"1F3FB":{unified:"1F64E-1F3FB-200D-2642-FE0F",non_qualified:"1F64E-1F3FB-200D-2642",image:"1f64e-1f3fb-200d-2642-fe0f.png",sheet_x:33,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64E-1F3FC-200D-2642-FE0F",non_qualified:"1F64E-1F3FC-200D-2642",image:"1f64e-1f3fc-200d-2642-fe0f.png",sheet_x:33,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64E-1F3FD-200D-2642-FE0F",non_qualified:"1F64E-1F3FD-200D-2642",image:"1f64e-1f3fd-200d-2642-fe0f.png",sheet_x:33,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64E-1F3FE-200D-2642-FE0F",non_qualified:"1F64E-1F3FE-200D-2642",image:"1f64e-1f3fe-200d-2642-fe0f.png",sheet_x:33,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64E-1F3FF-200D-2642-FE0F",non_qualified:"1F64E-1F3FF-200D-2642",image:"1f64e-1f3ff-200d-2642-fe0f.png",sheet_x:33,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManPouting",b:"1F64E-200D-2642-FE0F",c:"1F64E-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[33,38],o:4,j:["男人撅嘴"]},printer:{a:"Printer",b:"1F5A8-FE0F",c:"1F5A8",d:!0,e:!0,f:!0,h:!0,j:["打印机","纸","墨","paper","ink"],k:[30,11],o:2},scream:{a:"FaceScreaminginFear",b:"1F631",d:!0,e:!0,f:!0,h:!0,j:["面对恐惧的尖叫","脸","噍","害怕","嗯","face","munch","scared","omg"],k:[31,27],o:2},es:{a:"SpainFlag",b:"1F1EA-1F1F8",d:!0,e:!0,f:!0,h:!0,j:["西班牙国旗","西班牙","旗","国家","国家","旗帜","spain","flag","nation","country","banner"],k:[1,45],n:["flag-es"],o:2},ambulance:{a:"Ambulance",b:"1F691",d:!0,e:!0,f:!0,h:!0,j:["救护车","健康","911","医院","health","911","hospital"],k:[34,16],o:2},black_right_pointing_triangle_with_double_vertical_bar:{a:"BlackRightPointingTrianglewithDoubleVerticalBar",b:"23EF-FE0F",c:"23EF",d:!0,e:!0,f:!0,h:!0,k:[52,32],o:2,j:["播放或暂停按钮"]},lizard:{a:"Lizard",b:"1F98E",d:!0,e:!0,f:!0,h:!0,j:["蜥蜴","动物","自然界","爬行动物","animal","nature","reptile"],k:[42,32],o:4},"flag-et":{a:"EthiopiaFlag",b:"1F1EA-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[1,46],o:2,j:["埃塞俄比亚国旗"]},keyboard:{a:"Keyboard",b:"2328-FE0F",c:"2328",d:!0,e:!0,f:!0,h:!0,j:["键盘","科技","计算机","类型","输入","发短信","technology","computer","type","input","text"],k:[52,24],o:2},crab:{a:"Crab",b:"1F980",d:!0,e:!0,f:!0,h:!0,j:["螃蟹","动物","甲壳动物","animal","crustacean"],k:[42,18],o:2},confounded:{a:"ConfoundedFace",b:"1F616",d:!0,e:!0,f:!0,h:!0,j:["该死的脸","脸","困惑","生病","不适","哎呀","：S","face","confused","sick","unwell","oops",":S"],k:[31,0],o:2},snake:{a:"Snake",b:"1F40D",d:!0,e:!0,f:!0,h:!0,j:["蛇","动物","邪","自然界","嘶嘶声","蟒","animal","evil","nature","hiss","python"],k:[11,41],o:2},"woman-pouting":{skin_variations:{"1F3FB":{unified:"1F64E-1F3FB-200D-2640-FE0F",non_qualified:"1F64E-1F3FB-200D-2640",image:"1f64e-1f3fb-200d-2640-fe0f.png",sheet_x:33,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64E-1F3FC-200D-2640-FE0F",non_qualified:"1F64E-1F3FC-200D-2640",image:"1f64e-1f3fc-200d-2640-fe0f.png",sheet_x:33,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64E-1F3FD-200D-2640-FE0F",non_qualified:"1F64E-1F3FD-200D-2640",image:"1f64e-1f3fd-200d-2640-fe0f.png",sheet_x:33,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64E-1F3FE-200D-2640-FE0F",non_qualified:"1F64E-1F3FE-200D-2640",image:"1f64e-1f3fe-200d-2640-fe0f.png",sheet_x:33,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64E-1F3FF-200D-2640-FE0F",non_qualified:"1F64E-1F3FF-200D-2640",image:"1f64e-1f3ff-200d-2640-fe0f.png",sheet_x:33,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F64E",a:"WomanPouting",b:"1F64E-200D-2640-FE0F",c:"1F64E-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[33,32],o:4,j:["女人噘嘴"]},arrow_backward:{a:"BlackLeft-PointingTriangle",b:"25C0-FE0F",c:"25C0",d:!0,e:!0,f:!0,h:!0,j:["倒退按钮","蓝色方块","左","方向","blue-square","left","direction"],k:[52,44],o:2},fire_engine:{a:"FireEngine",b:"1F692",d:!0,e:!0,f:!0,h:!0,j:["消防车","运输","汽车","车辆","transportation","cars","vehicle"],k:[34,17],o:2},rewind:{a:"BlackLeft-PointingDoubleTriangle",b:"23EA",d:!0,e:!0,f:!0,h:!0,j:["快退按钮","玩","蓝色方块","play","blue-square"],k:[52,27],o:2},three_button_mouse:{a:"ThreeButtonMouse",b:"1F5B1-FE0F",c:"1F5B1",d:!0,e:!0,f:!0,h:!0,k:[30,12],o:2,j:["电脑鼠标"]},no_good:{skin_variations:{"1F3FB":{unified:"1F645-1F3FB",non_qualified:null,image:"1f645-1f3fb.png",sheet_x:32,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F645-1F3FC",non_qualified:null,image:"1f645-1f3fc.png",sheet_x:32,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F645-1F3FD",non_qualified:null,image:"1f645-1f3fd.png",sheet_x:32,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F645-1F3FE",non_qualified:null,image:"1f645-1f3fe.png",sheet_x:32,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F645-1F3FF",non_qualified:null,image:"1f645-1f3ff.png",sheet_x:32,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F645-200D-2640-FE0F",a:"FacewithNoGoodGesture",b:"1F645",d:!0,e:!0,f:!0,h:!1,k:[32,2],o:2,j:["反对手势的人"]},police_car:{a:"PoliceCar",b:"1F693",d:!0,e:!0,f:!0,h:!0,j:["警车","车辆","汽车","运输","法律","法律","执法","vehicle","cars","transportation","law","legal","enforcement"],k:[34,18],o:2},dragon_face:{a:"DragonFace",b:"1F432",d:!0,e:!0,f:!0,h:!0,j:["龙面","动物","神话","自然界","中文","绿","animal","myth","nature","chinese","green"],k:[12,22],o:2},persevere:{a:"PerseveringFace",b:"1F623",d:!0,e:!0,f:!0,h:!0,j:["无可奈何的脸","脸","生病","不","沮丧","哎呀","face","sick","no","upset","oops"],k:[31,13],o:2},lobster:{a:"Lobster",b:"1F99E",d:!0,e:!0,f:!0,h:!0,k:[42,48],o:11,j:["龙虾"]},"flag-eu":{a:"EuropeanUnionFlag",b:"1F1EA-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[1,47],o:2,j:["欧盟旗"]},disappointed:{a:"DisappointedFace",b:"1F61E",d:!0,e:!0,f:!0,h:!0,j:["失望的脸","脸","伤心","沮丧","沮丧",":(","face","sad","upset","depressed",":("],k:[31,8],l:["):",":(",":-("],m:":(",o:2},shrimp:{a:"Shrimp",b:"1F990",d:!0,e:!0,f:!0,h:!0,j:["虾","动物","海洋","自然界","海鲜","animal","ocean","nature","seafood"],k:[42,34],o:4},dragon:{a:"Dragon",b:"1F409",d:!0,e:!0,f:!0,h:!0,j:["龙","动物","神话","自然界","中文","绿","animal","myth","nature","chinese","green"],k:[11,37],o:2},"man-gesturing-no":{skin_variations:{"1F3FB":{unified:"1F645-1F3FB-200D-2642-FE0F",non_qualified:"1F645-1F3FB-200D-2642",image:"1f645-1f3fb-200d-2642-fe0f.png",sheet_x:31,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F645-1F3FC-200D-2642-FE0F",non_qualified:"1F645-1F3FC-200D-2642",image:"1f645-1f3fc-200d-2642-fe0f.png",sheet_x:31,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F645-1F3FD-200D-2642-FE0F",non_qualified:"1F645-1F3FD-200D-2642",image:"1f645-1f3fd-200d-2642-fe0f.png",sheet_x:31,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F645-1F3FE-200D-2642-FE0F",non_qualified:"1F645-1F3FE-200D-2642",image:"1f645-1f3fe-200d-2642-fe0f.png",sheet_x:32,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F645-1F3FF-200D-2642-FE0F",non_qualified:"1F645-1F3FF-200D-2642",image:"1f645-1f3ff-200d-2642-fe0f.png",sheet_x:32,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManGesturingNo",b:"1F645-200D-2642-FE0F",c:"1F645-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[31,53],o:4,j:["男人反对手势"]},"flag-fi":{a:"FinlandFlag",b:"1F1EB-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[1,48],o:2,j:["芬兰国旗"]},trackball:{a:"Trackball",b:"1F5B2-FE0F",c:"1F5B2",d:!0,e:!0,f:!0,h:!0,j:["轨迹球","科技","触控板","technology","trackpad"],k:[30,13],o:2},black_left_pointing_double_triangle_with_vertical_bar:{a:"BlackLeftPointingDoubleTrianglewithVerticalBar",b:"23EE-FE0F",c:"23EE",d:!0,e:!0,f:!0,h:!0,k:[52,31],o:2,j:["最后一首曲目按钮"]},oncoming_police_car:{a:"OncomingPoliceCar",b:"1F694",d:!0,e:!0,f:!0,h:!0,j:["迎面而来的警车","车辆","法律","法律","执法","911","vehicle","law","legal","enforcement","911"],k:[34,19],o:2},minidisc:{a:"Minidisc",b:"1F4BD",d:!0,e:!0,f:!0,h:!0,j:["电脑光盘","科技","记录","数据","磁盘","90年代","technology","record","data","disk","90s"],k:[26,19],o:2},sweat:{a:"FacewithColdSweat",b:"1F613",d:!0,e:!0,f:!0,h:!0,j:["垂头丧气的汗颜","脸","热","伤心","累","锻炼","face","hot","sad","tired","exercise"],k:[30,54],o:2},squid:{a:"Squid",b:"1F991",d:!0,e:!0,f:!0,h:!0,j:["乌贼","动物","自然界","海洋","海","animal","nature","ocean","sea"],k:[42,35],o:4},sauropod:{a:"Sauropod",b:"1F995",d:!0,e:!0,f:!0,h:!0,k:[42,39],o:5,j:["蜥脚类恐龙"]},arrow_up_small:{a:"Up-PointingSmallRedTriangle",b:"1F53C",d:!0,e:!0,f:!0,h:!0,j:["向上按钮","蓝色方块","三角形","方向","点","向前","返回页首","blue-square","triangle","direction","point","forward","top"],k:[28,31],o:2},"flag-fj":{a:"FijiFlag",b:"1F1EB-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[1,49],o:2,j:["斐济国旗"]},"woman-gesturing-no":{skin_variations:{"1F3FB":{unified:"1F645-1F3FB-200D-2640-FE0F",non_qualified:"1F645-1F3FB-200D-2640",image:"1f645-1f3fb-200d-2640-fe0f.png",sheet_x:31,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F645-1F3FC-200D-2640-FE0F",non_qualified:"1F645-1F3FC-200D-2640",image:"1f645-1f3fc-200d-2640-fe0f.png",sheet_x:31,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F645-1F3FD-200D-2640-FE0F",non_qualified:"1F645-1F3FD-200D-2640",image:"1f645-1f3fd-200d-2640-fe0f.png",sheet_x:31,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F645-1F3FE-200D-2640-FE0F",non_qualified:"1F645-1F3FE-200D-2640",image:"1f645-1f3fe-200d-2640-fe0f.png",sheet_x:31,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F645-1F3FF-200D-2640-FE0F",non_qualified:"1F645-1F3FF-200D-2640",image:"1f645-1f3ff-200d-2640-fe0f.png",sheet_x:31,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F645",a:"WomanGesturingNo",b:"1F645-200D-2640-FE0F",c:"1F645-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[31,47],o:4,j:["女人反对手势"]},taxi:{a:"Taxi",b:"1F695",d:!0,e:!0,f:!0,h:!0,j:["出租车","优步","车辆","汽车","运输","uber","vehicle","cars","transportation"],k:[34,20],o:2},"flag-fk":{a:"FalklandIslandsFlag",b:"1F1EB-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[1,50],o:2,j:["福克兰群岛旗"]},floppy_disk:{a:"FloppyDisk",b:"1F4BE",d:!0,e:!0,f:!0,h:!0,j:["软磁盘","老派","科技","救","90年代","80年代","oldschool","technology","save","90s","80s"],k:[26,20],o:2},"t-rex":{a:"T-Rex",b:"1F996",d:!0,e:!0,f:!0,h:!0,k:[42,40],o:5,j:["霸王龙"]},oyster:{a:"Oyster",b:"1F9AA",d:!0,e:!0,f:!0,h:!0,k:[43,1],o:12,j:["牡蛎"]},arrow_double_up:{a:"BlackUp-PointingDoubleTriangle",b:"23EB",d:!0,e:!0,f:!0,h:!0,j:["快速向上按钮","蓝色方块","方向","返回页首","blue-square","direction","top"],k:[52,28],o:2},oncoming_taxi:{a:"OncomingTaxi",b:"1F696",d:!0,e:!0,f:!0,h:!0,j:["迎面而来的出租车","车辆","汽车","优步","vehicle","cars","uber"],k:[34,21],o:2},ok_woman:{skin_variations:{"1F3FB":{unified:"1F646-1F3FB",non_qualified:null,image:"1f646-1f3fb.png",sheet_x:32,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F646-1F3FC",non_qualified:null,image:"1f646-1f3fc.png",sheet_x:32,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F646-1F3FD",non_qualified:null,image:"1f646-1f3fd.png",sheet_x:32,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F646-1F3FE",non_qualified:null,image:"1f646-1f3fe.png",sheet_x:32,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F646-1F3FF",non_qualified:null,image:"1f646-1f3ff.png",sheet_x:32,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F646-200D-2640-FE0F",a:"FacewithOkGesture",b:"1F646",d:!0,e:!0,f:!0,h:!1,j:["人的同意手势","女人","女孩","女性","粉红色","人","女人","women","girl","female","pink","human","woman"],k:[32,20],o:2},weary:{a:"WearyFace",b:"1F629",d:!0,e:!0,f:!0,h:!0,j:["疲惫的脸","脸","累","困","伤心","沮丧","沮丧","face","tired","sleepy","sad","frustrated","upset"],k:[31,19],o:2},"man-gesturing-ok":{skin_variations:{"1F3FB":{unified:"1F646-1F3FB-200D-2642-FE0F",non_qualified:"1F646-1F3FB-200D-2642",image:"1f646-1f3fb-200d-2642-fe0f.png",sheet_x:32,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F646-1F3FC-200D-2642-FE0F",non_qualified:"1F646-1F3FC-200D-2642",image:"1f646-1f3fc-200d-2642-fe0f.png",sheet_x:32,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F646-1F3FD-200D-2642-FE0F",non_qualified:"1F646-1F3FD-200D-2642",image:"1f646-1f3fd-200d-2642-fe0f.png",sheet_x:32,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F646-1F3FE-200D-2642-FE0F",non_qualified:"1F646-1F3FE-200D-2642",image:"1f646-1f3fe-200d-2642-fe0f.png",sheet_x:32,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F646-1F3FF-200D-2642-FE0F",non_qualified:"1F646-1F3FF-200D-2642",image:"1f646-1f3ff-200d-2642-fe0f.png",sheet_x:32,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManGesturingOk",b:"1F646-200D-2642-FE0F",c:"1F646-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[32,14],o:4,j:["男人同意手势"]},arrow_down_small:{a:"Down-PointingSmallRedTriangle",b:"1F53D",d:!0,e:!0,f:!0,h:!0,j:["向下按钮","蓝色方块","方向","底","blue-square","direction","bottom"],k:[28,32],o:2},tired_face:{a:"TiredFace",b:"1F62B",d:!0,e:!0,f:!0,h:!0,j:["疲惫的脸","生病","怨言","沮丧","沮丧","sick","whine","upset","frustrated"],k:[31,21],o:2},car:{a:"Automobile",b:"1F697",d:!0,e:!0,f:!0,h:!0,k:[34,22],n:["red_car"],o:2,j:["汽车"]},icecream:{a:"SoftIceCream",b:"1F366",d:!0,e:!0,f:!0,h:!0,j:["霜淇淋","食物","热","甜点","夏天","food","hot","dessert","summer"],k:[7,5],o:2},cd:{a:"OpticalDisc",b:"1F4BF",d:!0,e:!0,f:!0,h:!0,j:["光盘","科技","影碟","磁盘","碟片","90年代","technology","dvd","disk","disc","90s"],k:[26,21],o:2},whale:{a:"SpoutingWhale",b:"1F433",d:!0,e:!0,f:!0,h:!0,j:["喷水的鲸鱼","动物","自然界","海","海洋","animal","nature","sea","ocean"],k:[12,23],o:2},"flag-fm":{a:"MicronesiaFlag",b:"1F1EB-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[1,51],o:2,j:["密克罗尼西亚国旗"]},oncoming_automobile:{a:"OncomingAutomobile",b:"1F698",d:!0,e:!0,f:!0,h:!0,j:["迎面而来的汽车","汽车","车辆","运输","car","vehicle","transportation"],k:[34,23],o:2},arrow_double_down:{a:"BlackDown-PointingDoubleTriangle",b:"23EC",d:!0,e:!0,f:!0,h:!0,j:["快速向下按钮","蓝色方块","方向","底","blue-square","direction","bottom"],k:[52,29],o:2},"woman-gesturing-ok":{skin_variations:{"1F3FB":{unified:"1F646-1F3FB-200D-2640-FE0F",non_qualified:"1F646-1F3FB-200D-2640",image:"1f646-1f3fb-200d-2640-fe0f.png",sheet_x:32,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F646-1F3FC-200D-2640-FE0F",non_qualified:"1F646-1F3FC-200D-2640",image:"1f646-1f3fc-200d-2640-fe0f.png",sheet_x:32,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F646-1F3FD-200D-2640-FE0F",non_qualified:"1F646-1F3FD-200D-2640",image:"1f646-1f3fd-200d-2640-fe0f.png",sheet_x:32,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F646-1F3FE-200D-2640-FE0F",non_qualified:"1F646-1F3FE-200D-2640",image:"1f646-1f3fe-200d-2640-fe0f.png",sheet_x:32,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F646-1F3FF-200D-2640-FE0F",non_qualified:"1F646-1F3FF-200D-2640",image:"1f646-1f3ff-200d-2640-fe0f.png",sheet_x:32,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F646",a:"WomanGesturingOk",b:"1F646-200D-2640-FE0F",c:"1F646-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[32,8],o:4,j:["女人同意手势"]},yawning_face:{a:"YawningFace",b:"1F971",d:!0,e:!0,f:!0,h:!0,k:[42,7],o:12,j:["打哈欠脸"]},dvd:{a:"Dvd",b:"1F4C0",d:!0,e:!0,f:!0,h:!0,j:["DVD","光盘","磁盘","碟片","cd","disk","disc"],k:[26,22],o:2},whale2:{a:"Whale",b:"1F40B",d:!0,e:!0,f:!0,h:!0,j:["鲸","动物","自然界","海","海洋","animal","nature","sea","ocean"],k:[11,39],o:2},"flag-fo":{a:"FaroeIslandsFlag",b:"1F1EB-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[1,52],o:2,j:["法罗群岛旗"]},shaved_ice:{a:"ShavedIce",b:"1F367",d:!0,e:!0,f:!0,h:!0,j:["刨冰","热","甜点","夏天","hot","dessert","summer"],k:[7,6],o:2},double_vertical_bar:{a:"DoubleVerticalBar",b:"23F8-FE0F",c:"23F8",d:!0,e:!0,f:!0,h:!0,k:[52,37],o:2,j:["暂停按钮"]},information_desk_person:{skin_variations:{"1F3FB":{unified:"1F481-1F3FB",non_qualified:null,image:"1f481-1f3fb.png",sheet_x:24,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F481-1F3FC",non_qualified:null,image:"1f481-1f3fc.png",sheet_x:24,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F481-1F3FD",non_qualified:null,image:"1f481-1f3fd.png",sheet_x:24,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F481-1F3FE",non_qualified:null,image:"1f481-1f3fe.png",sheet_x:24,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F481-1F3FF",non_qualified:null,image:"1f481-1f3ff.png",sheet_x:24,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F481-200D-2640-FE0F",a:"InformationDeskPerson",b:"1F481",d:!0,e:!0,f:!0,h:!1,k:[24,2],o:2,j:["指引信息的人"]},dolphin:{a:"Dolphin",b:"1F42C",d:!0,e:!0,f:!0,h:!0,j:["海豚","动物","自然界","鱼","海","海洋","鳍 状 肢","直到","海滩","animal","nature","fish","sea","ocean","flipper","fins","beach"],k:[12,16],n:["flipper"],o:2},blue_car:{a:"RecreationalVehicle",b:"1F699",d:!0,e:!0,f:!0,h:!0,j:["运动型多功能车","运输","车辆","transportation","vehicle"],k:[34,24],o:2},ice_cream:{a:"IceCream",b:"1F368",d:!0,e:!0,f:!0,h:!0,j:["冰块","食物","热","甜点","food","hot","dessert"],k:[7,7],o:2},fr:{a:"FranceFlag",b:"1F1EB-1F1F7",d:!0,e:!0,f:!0,h:!0,j:["法国国旗","旗帜","旗","国家","法国","法语","国家","banner","flag","nation","france","french","country"],k:[1,53],n:["flag-fr"],o:2},triumph:{a:"FacewithLookofTriumph",b:"1F624",d:!0,e:!0,f:!0,h:!0,j:["生气的脸","脸","气","唷","骄傲","自豪","face","gas","phew","proud","pride"],k:[31,14],o:2},abacus:{a:"Abacus",b:"1F9EE",d:!0,e:!0,f:!0,h:!0,k:[51,33],o:11,j:["算盘"]},"man-tipping-hand":{skin_variations:{"1F3FB":{unified:"1F481-1F3FB-200D-2642-FE0F",non_qualified:"1F481-1F3FB-200D-2642",image:"1f481-1f3fb-200d-2642-fe0f.png",sheet_x:23,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F481-1F3FC-200D-2642-FE0F",non_qualified:"1F481-1F3FC-200D-2642",image:"1f481-1f3fc-200d-2642-fe0f.png",sheet_x:23,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F481-1F3FD-200D-2642-FE0F",non_qualified:"1F481-1F3FD-200D-2642",image:"1f481-1f3fd-200d-2642-fe0f.png",sheet_x:23,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F481-1F3FE-200D-2642-FE0F",non_qualified:"1F481-1F3FE-200D-2642",image:"1f481-1f3fe-200d-2642-fe0f.png",sheet_x:24,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F481-1F3FF-200D-2642-FE0F",non_qualified:"1F481-1F3FF-200D-2642",image:"1f481-1f3ff-200d-2642-fe0f.png",sheet_x:24,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManTippingHand",b:"1F481-200D-2642-FE0F",c:"1F481-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[23,53],o:4,j:["男人指引信息"]},doughnut:{a:"Doughnut",b:"1F369",d:!0,e:!0,f:!0,h:!0,j:["巧克力甜甜圈","食物","甜点","小吃","甜","甜甜圈","food","dessert","snack","sweet","donut"],k:[7,8],o:2},fish:{a:"Fish",b:"1F41F",d:!0,e:!0,f:!0,h:!0,j:["鱼","动物","食物","自然界","animal","food","nature"],k:[12,3],o:2},truck:{a:"DeliveryTruck",b:"1F69A",d:!0,e:!0,f:!0,h:!0,j:["送货卡车","汽车","运输","cars","transportation"],k:[34,25],o:2},movie_camera:{a:"MovieCamera",b:"1F3A5",d:!0,e:!0,f:!0,h:!0,j:["电影摄影机","影片","记录","film","record"],k:[8,11],o:2},"flag-ga":{a:"GabonFlag",b:"1F1EC-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[1,54],o:2,j:["加蓬国旗"]},rage:{a:"PoutingFace",b:"1F621",d:!0,e:!0,f:!0,h:!0,j:["噘嘴的脸","生气","狂","恨","鄙视","angry","mad","hate","despise"],k:[31,11],o:2},black_square_for_stop:{a:"BlackSquareforStop",b:"23F9-FE0F",c:"23F9",d:!0,e:!0,f:!0,h:!0,k:[52,38],o:2,j:["停止按钮"]},articulated_lorry:{a:"ArticulatedLorry",b:"1F69B",d:!0,e:!0,f:!0,h:!0,j:["铰接式卡车","车辆","汽车","运输","表达","vehicle","cars","transportation","express"],k:[34,26],o:2},angry:{a:"AngryFace",b:"1F620",d:!0,e:!0,f:!0,h:!0,j:["愤怒的脸","狂","脸","恼火","沮丧","mad","face","annoyed","frustrated"],k:[31,10],l:[">:(",">:-("],o:2},cookie:{a:"Cookie",b:"1F36A",d:!0,e:!0,f:!0,h:!0,j:["曲奇饼","食物","小吃","奥利奥","巧克力","甜","甜点","food","snack","oreo","chocolate","sweet","dessert"],k:[7,9],o:2},gb:{a:"UnitedKingdomFlag",b:"1F1EC-1F1E7",d:!0,e:!0,f:!0,h:!0,k:[1,55],n:["uk","flag-gb"],o:2,j:["英国国旗"]},tropical_fish:{a:"TropicalFish",b:"1F420",d:!0,e:!0,f:!0,h:!0,j:["热带鱼","动物","游泳","海洋","海滩","尼 莫","animal","swim","ocean","beach","nemo"],k:[12,4],o:2},"woman-tipping-hand":{skin_variations:{"1F3FB":{unified:"1F481-1F3FB-200D-2640-FE0F",non_qualified:"1F481-1F3FB-200D-2640",image:"1f481-1f3fb-200d-2640-fe0f.png",sheet_x:23,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F481-1F3FC-200D-2640-FE0F",non_qualified:"1F481-1F3FC-200D-2640",image:"1f481-1f3fc-200d-2640-fe0f.png",sheet_x:23,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F481-1F3FD-200D-2640-FE0F",non_qualified:"1F481-1F3FD-200D-2640",image:"1f481-1f3fd-200d-2640-fe0f.png",sheet_x:23,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F481-1F3FE-200D-2640-FE0F",non_qualified:"1F481-1F3FE-200D-2640",image:"1f481-1f3fe-200d-2640-fe0f.png",sheet_x:23,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F481-1F3FF-200D-2640-FE0F",non_qualified:"1F481-1F3FF-200D-2640",image:"1f481-1f3ff-200d-2640-fe0f.png",sheet_x:23,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F481",a:"WomanTippingHand",b:"1F481-200D-2640-FE0F",c:"1F481-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[23,47],o:4,j:["女人指引信息"]},black_circle_for_record:{a:"BlackCircleforRecord",b:"23FA-FE0F",c:"23FA",d:!0,e:!0,f:!0,h:!0,k:[52,39],o:2,j:["录音按钮"]},film_frames:{a:"FilmFrames",b:"1F39E-FE0F",c:"1F39E",d:!0,e:!0,f:!0,h:!0,k:[8,4],o:2,j:["电影帧"]},film_projector:{a:"FilmProjector",b:"1F4FD-FE0F",c:"1F4FD",d:!0,e:!0,f:!0,h:!0,j:["电影放映机","视频","磁带","记录","电影","video","tape","record","movie"],k:[27,26],o:2},"flag-gd":{a:"GrenadaFlag",b:"1F1EC-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[1,56],o:2,j:["格林纳达国旗"]},blowfish:{a:"Blowfish",b:"1F421",d:!0,e:!0,f:!0,h:!0,j:["河豚","动物","自然界","食物","海","海洋","animal","nature","food","sea","ocean"],k:[12,5],o:2},face_with_symbols_on_mouth:{a:"SeriousFacewithSymbolsCoveringMouth",b:"1F92C",d:!0,e:!0,f:!0,h:!0,k:[38,46],n:["serious_face_with_symbols_covering_mouth"],o:5,j:["口出恶言的脸"]},birthday:{a:"BirthdayCake",b:"1F382",d:!0,e:!0,f:!0,h:!0,j:["生日蛋糕","食物","甜点","蛋糕","food","dessert","cake"],k:[7,33],o:2},eject:{a:"Eject",b:"23CF-FE0F",c:"23CF",d:!0,e:!0,f:!0,h:!0,k:[52,25],o:2,j:["弹出按钮"]},raising_hand:{skin_variations:{"1F3FB":{unified:"1F64B-1F3FB",non_qualified:null,image:"1f64b-1f3fb.png",sheet_x:33,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F64B-1F3FC",non_qualified:null,image:"1f64b-1f3fc.png",sheet_x:33,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F64B-1F3FD",non_qualified:null,image:"1f64b-1f3fd.png",sheet_x:33,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F64B-1F3FE",non_qualified:null,image:"1f64b-1f3fe.png",sheet_x:33,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F64B-1F3FF",non_qualified:null,image:"1f64b-1f3ff.png",sheet_x:33,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F64B-200D-2640-FE0F",a:"HappyPersonRaisingOneHand",b:"1F64B",d:!0,e:!0,f:!0,h:!1,k:[33,2],o:2,j:["举手的人"]},tractor:{a:"Tractor",b:"1F69C",d:!0,e:!0,f:!0,h:!0,j:["拖拉机","车辆","汽车","农业","农业","vehicle","car","farming","agriculture"],k:[34,27],o:2},"flag-ge":{a:"GeorgiaFlag",b:"1F1EC-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[2,0],o:2,j:["格鲁吉亚国旗"]},smiling_imp:{a:"SmilingFacewithHorns",b:"1F608",d:!0,e:!0,f:!0,h:!0,j:["长角的笑脸","魔鬼","角","devil","horns"],k:[30,43],o:2},racing_car:{a:"RacingCar",b:"1F3CE-FE0F",c:"1F3CE",d:!0,e:!0,f:!0,h:!0,j:["赛车","体育","比赛","几乎","公式","f1","sports","race","fast","formula","f1"],k:[10,33],o:2},cinema:{a:"Cinema",b:"1F3A6",d:!0,e:!0,f:!0,h:!0,j:["电影院","蓝色方块","记录","影片","电影","窗帘","阶段","剧院","blue-square","record","film","movie","curtain","stage","theater"],k:[8,12],o:2},clapper:{a:"ClapperBoard",b:"1F3AC",d:!0,e:!0,f:!0,h:!0,j:["场记板","电影","影片","记录","movie","film","record"],k:[8,18],o:2},shark:{a:"Shark",b:"1F988",d:!0,e:!0,f:!0,h:!0,j:["鲨鱼","动物","自然界","鱼","海","海洋","下巴","直到","海滩","animal","nature","fish","sea","ocean","jaws","fins","beach"],k:[42,26],o:4},cake:{a:"Shortcake",b:"1F370",d:!0,e:!0,f:!0,h:!0,j:["酥","食物","甜点","food","dessert"],k:[7,15],o:2},"man-raising-hand":{skin_variations:{"1F3FB":{unified:"1F64B-1F3FB-200D-2642-FE0F",non_qualified:"1F64B-1F3FB-200D-2642",image:"1f64b-1f3fb-200d-2642-fe0f.png",sheet_x:32,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64B-1F3FC-200D-2642-FE0F",non_qualified:"1F64B-1F3FC-200D-2642",image:"1f64b-1f3fc-200d-2642-fe0f.png",sheet_x:32,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64B-1F3FD-200D-2642-FE0F",non_qualified:"1F64B-1F3FD-200D-2642",image:"1f64b-1f3fd-200d-2642-fe0f.png",sheet_x:32,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64B-1F3FE-200D-2642-FE0F",non_qualified:"1F64B-1F3FE-200D-2642",image:"1f64b-1f3fe-200d-2642-fe0f.png",sheet_x:33,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64B-1F3FF-200D-2642-FE0F",non_qualified:"1F64B-1F3FF-200D-2642",image:"1f64b-1f3ff-200d-2642-fe0f.png",sheet_x:33,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManRaisingHand",b:"1F64B-200D-2642-FE0F",c:"1F64B-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[32,53],o:4,j:["男人举手"]},octopus:{a:"Octopus",b:"1F419",d:!0,e:!0,f:!0,h:!0,j:["章鱼","动物","生物","海洋","海","自然界","海滩","animal","creature","ocean","sea","nature","beach"],k:[11,54],o:2},"woman-raising-hand":{skin_variations:{"1F3FB":{unified:"1F64B-1F3FB-200D-2640-FE0F",non_qualified:"1F64B-1F3FB-200D-2640",image:"1f64b-1f3fb-200d-2640-fe0f.png",sheet_x:32,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F64B-1F3FC-200D-2640-FE0F",non_qualified:"1F64B-1F3FC-200D-2640",image:"1f64b-1f3fc-200d-2640-fe0f.png",sheet_x:32,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F64B-1F3FD-200D-2640-FE0F",non_qualified:"1F64B-1F3FD-200D-2640",image:"1f64b-1f3fd-200d-2640-fe0f.png",sheet_x:32,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F64B-1F3FE-200D-2640-FE0F",non_qualified:"1F64B-1F3FE-200D-2640",image:"1f64b-1f3fe-200d-2640-fe0f.png",sheet_x:32,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F64B-1F3FF-200D-2640-FE0F",non_qualified:"1F64B-1F3FF-200D-2640",image:"1f64b-1f3ff-200d-2640-fe0f.png",sheet_x:32,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F64B",a:"WomanRaisingHand",b:"1F64B-200D-2640-FE0F",c:"1F64B-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[32,47],o:4,j:["女人举手"]},"flag-gf":{a:"FrenchGuianaFlag",b:"1F1EC-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[2,1],o:2,j:["法属圭亚那旗"]},tv:{a:"Television",b:"1F4FA",d:!0,e:!0,f:!0,h:!0,j:["电视","科技","程序","老派","显示","电视","technology","program","oldschool","show","television"],k:[27,23],o:2},imp:{a:"Imp",b:"1F47F",d:!0,e:!0,f:!0,h:!0,j:["长角的愤怒脸","魔鬼","生气","角","devil","angry","horns"],k:[23,45],o:2},cupcake:{a:"Cupcake",b:"1F9C1",d:!0,e:!0,f:!0,h:!0,k:[44,9],o:11,j:["杯子蛋糕"]},racing_motorcycle:{a:"RacingMotorcycle",b:"1F3CD-FE0F",c:"1F3CD",d:!0,e:!0,f:!0,h:!0,k:[10,32],o:2,j:["摩托车"]},low_brightness:{a:"LowBrightnessSymbol",b:"1F505",d:!0,e:!0,f:!0,h:!0,j:["昏暗的按钮","太阳","下午","温暖","夏天","sun","afternoon","warm","summer"],k:[27,33],o:2},shell:{a:"SpiralShell",b:"1F41A",d:!0,e:!0,f:!0,h:!0,j:["螺","自然界","海","海滩","nature","sea","beach"],k:[11,55],o:2},"flag-gg":{a:"GuernseyFlag",b:"1F1EC-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[2,2],o:2,j:["格恩西岛旗"]},high_brightness:{a:"HighBrightnessSymbol",b:"1F506",d:!0,e:!0,f:!0,h:!0,j:["明亮的按钮","太阳","光","sun","light"],k:[27,34],o:2},deaf_person:{skin_variations:{"1F3FB":{unified:"1F9CF-1F3FB",non_qualified:null,image:"1f9cf-1f3fb.png",sheet_x:45,sheet_y:11,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CF-1F3FC",non_qualified:null,image:"1f9cf-1f3fc.png",sheet_x:45,sheet_y:12,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CF-1F3FD",non_qualified:null,image:"1f9cf-1f3fd.png",sheet_x:45,sheet_y:13,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CF-1F3FE",non_qualified:null,image:"1f9cf-1f3fe.png",sheet_x:45,sheet_y:14,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CF-1F3FF",non_qualified:null,image:"1f9cf-1f3ff.png",sheet_x:45,sheet_y:15,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"DeafPerson",b:"1F9CF",d:!0,e:!0,f:!0,h:!0,k:[45,10],o:12,j:["聋人"]},skull:{a:"Skull",b:"1F480",d:!0,e:!0,f:!0,h:!0,j:["骷髅头骨","死","骨架","恐怖","死亡","dead","skeleton","creepy","death"],k:[23,46],o:2},motor_scooter:{a:"MotorScooter",b:"1F6F5",d:!0,e:!0,f:!0,h:!0,j:["小型摩托车","车辆","黄蜂","萨沙","vehicle","vespa","sasha"],k:[36,54],o:4},camera:{a:"Camera",b:"1F4F7",d:!0,e:!0,f:!0,h:!0,j:["相机","产品","摄影","gadgets","photography"],k:[27,20],o:2},pie:{a:"Pie",b:"1F967",d:!0,e:!0,f:!0,h:!0,k:[41,54],o:5,j:["派"]},"flag-gh":{a:"GhanaFlag",b:"1F1EC-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[2,3],o:2,j:["加纳国旗"]},deaf_man:{skin_variations:{"1F3FB":{unified:"1F9CF-1F3FB-200D-2642-FE0F",non_qualified:"1F9CF-1F3FB-200D-2642",image:"1f9cf-1f3fb-200d-2642-fe0f.png",sheet_x:45,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CF-1F3FC-200D-2642-FE0F",non_qualified:"1F9CF-1F3FC-200D-2642",image:"1f9cf-1f3fc-200d-2642-fe0f.png",sheet_x:45,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CF-1F3FD-200D-2642-FE0F",non_qualified:"1F9CF-1F3FD-200D-2642",image:"1f9cf-1f3fd-200d-2642-fe0f.png",sheet_x:45,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CF-1F3FE-200D-2642-FE0F",non_qualified:"1F9CF-1F3FE-200D-2642",image:"1f9cf-1f3fe-200d-2642-fe0f.png",sheet_x:45,sheet_y:8,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CF-1F3FF-200D-2642-FE0F",non_qualified:"1F9CF-1F3FF-200D-2642",image:"1f9cf-1f3ff-200d-2642-fe0f.png",sheet_x:45,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"DeafMan",b:"1F9CF-200D-2642-FE0F",c:"1F9CF-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[45,4],o:12,j:["男性聋人"]},skull_and_crossbones:{a:"SkullandCrossbones",b:"2620-FE0F",c:"2620",d:!0,e:!0,f:!0,h:!0,j:["骷髅头","毒","危险","致命","可怕","死亡","海盗","邪","poison","danger","deadly","scary","death","pirate","evil"],k:[53,8],o:2},camera_with_flash:{a:"CamerawithFlash",b:"1F4F8",d:!0,e:!0,f:!0,h:!0,k:[27,21],o:2,j:["带闪光灯的相机"]},signal_strength:{a:"AntennawithBars",b:"1F4F6",d:!0,e:!0,f:!0,h:!0,j:["信号条","蓝色方块","接待","电话","互联网","连接","无线网络","蓝牙","酒吧","blue-square","reception","phone","internet","connection","wifi","bluetooth","bars"],k:[27,19],o:2},chocolate_bar:{a:"ChocolateBar",b:"1F36B",d:!0,e:!0,f:!0,h:!0,j:["巧克力棒","食物","小吃","甜点","甜","food","snack","dessert","sweet"],k:[7,10],o:2},manual_wheelchair:{a:"ManualWheelchair",b:"1F9BD",d:!0,e:!0,f:!0,h:!0,k:[44,5],o:12,j:["手动轮椅"]},snail:{a:"Snail",b:"1F40C",d:!0,e:!0,f:!0,h:!0,j:["蜗牛","慢","动物","壳","slow","animal","shell"],k:[11,40],o:2},motorized_wheelchair:{a:"MotorizedWheelchair",b:"1F9BC",d:!0,e:!0,f:!0,h:!0,k:[44,4],o:12,j:["电动轮椅"]},"flag-gi":{a:"GibraltarFlag",b:"1F1EC-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[2,4],o:2,j:["直布罗陀旗"]},hankey:{a:"PileofPoo",b:"1F4A9",d:!0,e:!0,f:!0,h:!0,k:[25,51],n:["poop","shit"],o:2,j:["一坨便便"]},vibration_mode:{a:"VibrationMode",b:"1F4F3",d:!0,e:!0,f:!0,h:!0,j:["振动模式","橙色方块","电话","orange-square","phone"],k:[27,16],o:2},deaf_woman:{skin_variations:{"1F3FB":{unified:"1F9CF-1F3FB-200D-2640-FE0F",non_qualified:"1F9CF-1F3FB-200D-2640",image:"1f9cf-1f3fb-200d-2640-fe0f.png",sheet_x:44,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CF-1F3FC-200D-2640-FE0F",non_qualified:"1F9CF-1F3FC-200D-2640",image:"1f9cf-1f3fc-200d-2640-fe0f.png",sheet_x:45,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CF-1F3FD-200D-2640-FE0F",non_qualified:"1F9CF-1F3FD-200D-2640",image:"1f9cf-1f3fd-200d-2640-fe0f.png",sheet_x:45,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CF-1F3FE-200D-2640-FE0F",non_qualified:"1F9CF-1F3FE-200D-2640",image:"1f9cf-1f3fe-200d-2640-fe0f.png",sheet_x:45,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CF-1F3FF-200D-2640-FE0F",non_qualified:"1F9CF-1F3FF-200D-2640",image:"1f9cf-1f3ff-200d-2640-fe0f.png",sheet_x:45,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"DeafWoman",b:"1F9CF-200D-2640-FE0F",c:"1F9CF-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[44,55],o:12,j:["女性聋人"]},butterfly:{a:"Butterfly",b:"1F98B",d:!0,e:!0,f:!0,h:!0,j:["蝴蝶","动物","昆虫","自然界","毛虫","animal","insect","nature","caterpillar"],k:[42,29],o:4},video_camera:{a:"VideoCamera",b:"1F4F9",d:!0,e:!0,f:!0,h:!0,j:["摄录机","影片","记录","film","record"],k:[27,22],o:2},candy:{a:"Candy",b:"1F36C",d:!0,e:!0,f:!0,h:!0,j:["糖果","小吃","甜点","甜","棒棒糖","snack","dessert","sweet","lolly"],k:[7,11],o:2},auto_rickshaw:{a:"AutoRickshaw",b:"1F6FA",d:!0,e:!0,f:!0,h:!0,k:[37,2],o:12,j:["自动人力车"]},bow:{skin_variations:{"1F3FB":{unified:"1F647-1F3FB",non_qualified:null,image:"1f647-1f3fb.png",sheet_x:32,sheet_y:39,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F647-1F3FC",non_qualified:null,image:"1f647-1f3fc.png",sheet_x:32,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F647-1F3FD",non_qualified:null,image:"1f647-1f3fd.png",sheet_x:32,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F647-1F3FE",non_qualified:null,image:"1f647-1f3fe.png",sheet_x:32,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F647-1F3FF",non_qualified:null,image:"1f647-1f3ff.png",sheet_x:32,sheet_y:43,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F647-200D-2642-FE0F",a:"PersonBowingDeeply",b:"1F647",d:!0,e:!0,f:!0,h:!1,k:[32,38],o:2,j:["鞠躬的人"]},mobile_phone_off:{a:"MobilePhoneoff",b:"1F4F4",d:!0,e:!0,f:!0,h:!0,j:["手机关机","静音","橙色方块","沉默","安静","mute","orange-square","silence","quiet"],k:[27,17],o:2},clown_face:{a:"ClownFace",b:"1F921",d:!0,e:!0,f:!0,h:!0,j:["小丑","脸","face"],k:[38,18],o:4},lollipop:{a:"Lollipop",b:"1F36D",d:!0,e:!0,f:!0,h:!0,j:["棒糖","食物","小吃","糖果","甜","food","snack","candy","sweet"],k:[7,12],o:2},"flag-gl":{a:"GreenlandFlag",b:"1F1EC-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[2,5],o:2,j:["格陵兰旗"]},vhs:{a:"Videocassette",b:"1F4FC",d:!0,e:!0,f:!0,h:!0,j:["录像带","记录","视频","老派","90年代","80年代","record","video","oldschool","90s","80s"],k:[27,25],o:2},bug:{a:"Bug",b:"1F41B",d:!0,e:!0,f:!0,h:!0,j:["虫虫","动物","昆虫","自然界","蠕虫","animal","insect","nature","worm"],k:[11,56],o:2},bike:{a:"Bicycle",b:"1F6B2",d:!0,e:!0,f:!0,h:!0,j:["自行车","体育","自行车","锻炼","时髦","sports","bicycle","exercise","hipster"],k:[35,9],o:2},"man-bowing":{skin_variations:{"1F3FB":{unified:"1F647-1F3FB-200D-2642-FE0F",non_qualified:"1F647-1F3FB-200D-2642",image:"1f647-1f3fb-200d-2642-fe0f.png",sheet_x:32,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F647-1F3FC-200D-2642-FE0F",non_qualified:"1F647-1F3FC-200D-2642",image:"1f647-1f3fc-200d-2642-fe0f.png",sheet_x:32,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F647-1F3FD-200D-2642-FE0F",non_qualified:"1F647-1F3FD-200D-2642",image:"1f647-1f3fd-200d-2642-fe0f.png",sheet_x:32,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F647-1F3FE-200D-2642-FE0F",non_qualified:"1F647-1F3FE-200D-2642",image:"1f647-1f3fe-200d-2642-fe0f.png",sheet_x:32,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F647-1F3FF-200D-2642-FE0F",non_qualified:"1F647-1F3FF-200D-2642",image:"1f647-1f3ff-200d-2642-fe0f.png",sheet_x:32,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F647",a:"ManBowing",b:"1F647-200D-2642-FE0F",c:"1F647-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[32,32],o:4,j:["男人鞠躬"]},female_sign:{a:"FemaleSign",b:"2640-FE0F",c:"2640",d:!1,e:!0,f:!0,h:!0,k:[53,18],o:4,j:["女性标志"]},japanese_ogre:{a:"JapaneseOgre",b:"1F479",d:!0,e:!0,f:!0,h:!0,j:["怪物","怪物","红","面具","万圣节","可怕","恐怖","魔鬼","恶魔","日语","怪物","monster","red","mask","halloween","scary","creepy","devil","demon","japanese","ogre"],k:[23,34],o:2},custard:{a:"Custard",b:"1F36E",d:!0,e:!0,f:!0,h:!0,j:["卡仕达","甜点","食物","dessert","food"],k:[7,13],o:2},ant:{a:"Ant",b:"1F41C",d:!0,e:!0,f:!0,h:!0,j:["蚂蚁","动物","昆虫","自然界","错误","animal","insect","nature","bug"],k:[12,0],o:2},mag:{a:"Left-PointingMagnifyingGlass",b:"1F50D",d:!0,e:!0,f:!0,h:!0,j:["放大镜（向左倾斜）","搜索","缩放","找到","侦探","search","zoom","find","detective"],k:[27,41],o:2},"flag-gm":{a:"GambiaFlag",b:"1F1EC-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,6],o:2,j:["冈比亚国旗"]},honey_pot:{a:"HoneyPot",b:"1F36F",d:!0,e:!0,f:!0,h:!0,j:["蜜罐","蜜蜂","甜","厨房","bees","sweet","kitchen"],k:[7,14],o:2},"woman-bowing":{skin_variations:{"1F3FB":{unified:"1F647-1F3FB-200D-2640-FE0F",non_qualified:"1F647-1F3FB-200D-2640",image:"1f647-1f3fb-200d-2640-fe0f.png",sheet_x:32,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F647-1F3FC-200D-2640-FE0F",non_qualified:"1F647-1F3FC-200D-2640",image:"1f647-1f3fc-200d-2640-fe0f.png",sheet_x:32,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F647-1F3FD-200D-2640-FE0F",non_qualified:"1F647-1F3FD-200D-2640",image:"1f647-1f3fd-200d-2640-fe0f.png",sheet_x:32,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F647-1F3FE-200D-2640-FE0F",non_qualified:"1F647-1F3FE-200D-2640",image:"1f647-1f3fe-200d-2640-fe0f.png",sheet_x:32,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F647-1F3FF-200D-2640-FE0F",non_qualified:"1F647-1F3FF-200D-2640",image:"1f647-1f3ff-200d-2640-fe0f.png",sheet_x:32,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanBowing",b:"1F647-200D-2640-FE0F",c:"1F647-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[32,26],o:4,j:["女人鞠躬"]},male_sign:{a:"MaleSign",b:"2642-FE0F",c:"2642",d:!1,e:!0,f:!0,h:!0,k:[53,19],o:4,j:["男性标志"]},mag_right:{a:"Right-PointingMagnifyingGlass",b:"1F50E",d:!0,e:!0,f:!0,h:!0,j:["放大镜（向右倾斜）","搜索","缩放","找到","侦探","search","zoom","find","detective"],k:[27,42],o:2},japanese_goblin:{a:"JapaneseGoblin",b:"1F47A",d:!0,e:!0,f:!0,h:!0,j:["小妖怪","红","邪","面具","怪物","可怕","恐怖","日语","妖精","red","evil","mask","monster","scary","creepy","japanese","goblin"],k:[23,35],o:2},scooter:{a:"Scooter",b:"1F6F4",d:!0,e:!0,f:!0,h:!0,k:[36,53],o:4,j:["滑板车"]},bee:{a:"Honeybee",b:"1F41D",d:!0,e:!0,f:!0,h:!0,k:[12,1],n:["honeybee"],o:2,j:["蜜蜂"]},"flag-gn":{a:"GuineaFlag",b:"1F1EC-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[2,7],o:2,j:["几内亚国旗"]},candle:{a:"Candle",b:"1F56F-FE0F",c:"1F56F",d:!0,e:!0,f:!0,h:!0,j:["蜡烛","火灾","蜡","fire","wax"],k:[29,6],o:2},skateboard:{a:"Skateboard",b:"1F6F9",d:!0,e:!0,f:!0,h:!0,k:[37,1],o:11,j:["滑板"]},medical_symbol:{a:"MedicalSymbol",b:"2695-FE0F",c:"2695",d:!1,e:!0,f:!0,h:!0,k:[53,44],n:["staff_of_aesculapius"],o:4,j:["医疗符号"]},ghost:{a:"Ghost",b:"1F47B",d:!0,e:!0,f:!0,h:!0,j:["鬼","万圣节","怪异","可怕","halloween","spooky","scary"],k:[23,36],o:2},beetle:{a:"LadyBeetle",b:"1F41E",d:!0,e:!0,f:!0,h:!0,j:["瓢虫","动物","昆虫","自然界","瓢虫","animal","insect","nature","ladybug"],k:[12,2],o:2},face_palm:{skin_variations:{"1F3FB":{unified:"1F926-1F3FB",non_qualified:null,image:"1f926-1f3fb.png",sheet_x:38,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F926-1F3FC",non_qualified:null,image:"1f926-1f3fc.png",sheet_x:38,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F926-1F3FD",non_qualified:null,image:"1f926-1f3fd.png",sheet_x:38,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F926-1F3FE",non_qualified:null,image:"1f926-1f3fe.png",sheet_x:38,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F926-1F3FF",non_qualified:null,image:"1f926-1f3ff.png",sheet_x:38,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"FacePalm",b:"1F926",d:!0,e:!0,f:!0,h:!1,k:[38,35],o:4,j:["人掩面"]},"flag-gp":{a:"GuadeloupeFlag",b:"1F1EC-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[2,8],o:2,j:["瓜德罗普岛旗"]},baby_bottle:{a:"BabyBottle",b:"1F37C",d:!0,e:!0,f:!0,h:!0,j:["婴儿奶瓶","食物","容器","牛奶","food","container","milk"],k:[7,27],o:2},infinity:{a:"Infinity",b:"267E-FE0F",c:"267E",d:!0,e:!0,f:!0,h:!0,k:[53,39],o:11,j:["无限"]},glass_of_milk:{a:"GlassofMilk",b:"1F95B",d:!0,e:!0,f:!0,h:!0,k:[41,42],o:4,j:["牛奶杯"]},"man-facepalming":{skin_variations:{"1F3FB":{unified:"1F926-1F3FB-200D-2642-FE0F",non_qualified:"1F926-1F3FB-200D-2642",image:"1f926-1f3fb-200d-2642-fe0f.png",sheet_x:38,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F926-1F3FC-200D-2642-FE0F",non_qualified:"1F926-1F3FC-200D-2642",image:"1f926-1f3fc-200d-2642-fe0f.png",sheet_x:38,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F926-1F3FD-200D-2642-FE0F",non_qualified:"1F926-1F3FD-200D-2642",image:"1f926-1f3fd-200d-2642-fe0f.png",sheet_x:38,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F926-1F3FE-200D-2642-FE0F",non_qualified:"1F926-1F3FE-200D-2642",image:"1f926-1f3fe-200d-2642-fe0f.png",sheet_x:38,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F926-1F3FF-200D-2642-FE0F",non_qualified:"1F926-1F3FF-200D-2642",image:"1f926-1f3ff-200d-2642-fe0f.png",sheet_x:38,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManFacepalming",b:"1F926-200D-2642-FE0F",c:"1F926-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[38,29],o:4,j:["男人掩面"]},cricket:{a:"Cricket",b:"1F997",d:!0,e:!0,f:!0,h:!0,j:["蟋蟀","体育","sports"],k:[42,41],o:5},busstop:{a:"BusStop",b:"1F68F",d:!0,e:!0,f:!0,h:!0,j:["公交车站","运输","等","transportation","wait"],k:[34,14],o:2},"flag-gq":{a:"EquatorialGuineaFlag",b:"1F1EC-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[2,9],o:2,j:["赤道几内亚国旗"]},alien:{a:"ExtraterrestrialAlien",b:"1F47D",d:!0,e:!0,f:!0,h:!0,j:["外星人","不明飞行物","保罗","奇怪","outer_space","UFO","paul","weird","outer_space"],k:[23,43],o:2},bulb:{a:"ElectricLightBulb",b:"1F4A1",d:!0,e:!0,f:!0,h:!0,j:["灯泡","光","电力","想法","light","electricity","idea"],k:[25,43],o:2},"woman-facepalming":{skin_variations:{"1F3FB":{unified:"1F926-1F3FB-200D-2640-FE0F",non_qualified:"1F926-1F3FB-200D-2640",image:"1f926-1f3fb-200d-2640-fe0f.png",sheet_x:38,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F926-1F3FC-200D-2640-FE0F",non_qualified:"1F926-1F3FC-200D-2640",image:"1f926-1f3fc-200d-2640-fe0f.png",sheet_x:38,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F926-1F3FD-200D-2640-FE0F",non_qualified:"1F926-1F3FD-200D-2640",image:"1f926-1f3fd-200d-2640-fe0f.png",sheet_x:38,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F926-1F3FE-200D-2640-FE0F",non_qualified:"1F926-1F3FE-200D-2640",image:"1f926-1f3fe-200d-2640-fe0f.png",sheet_x:38,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F926-1F3FF-200D-2640-FE0F",non_qualified:"1F926-1F3FF-200D-2640",image:"1f926-1f3ff-200d-2640-fe0f.png",sheet_x:38,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanFacepalming",b:"1F926-200D-2640-FE0F",c:"1F926-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[38,23],o:4,j:["女人掩面"]},spider:{a:"Spider",b:"1F577-FE0F",c:"1F577",d:!0,e:!0,f:!0,h:!0,j:["蜘蛛","动物","蜘蛛类","animal","arachnid"],k:[29,34],o:2},space_invader:{a:"AlienMonster",b:"1F47E",d:!0,e:!0,f:!0,h:!0,j:["外星怪物","游戏","拱廊","玩","game","arcade","play"],k:[23,44],o:2},motorway:{a:"Motorway",b:"1F6E3-FE0F",c:"1F6E3",d:!0,e:!0,f:!0,h:!0,j:["公路","路","库比蒂诺","州际的","公路","road","cupertino","interstate","highway"],k:[36,45],o:2},"flag-gr":{a:"GreeceFlag",b:"1F1EC-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[2,10],o:2,j:["希腊国旗"]},recycle:{a:"BlackUniversalRecyclingSymbol",b:"267B-FE0F",c:"267B",d:!0,e:!0,f:!0,h:!0,j:["回收标志","箭","环境","垃圾","垃圾","arrow","environment","garbage","trash"],k:[53,38],o:2},coffee:{a:"HotBeverage",b:"2615",d:!0,e:!0,f:!0,h:!0,j:["热饮料","饮料","咖啡因","牛奶","表达","beverage","caffeine","latte","espresso"],k:[53,0],o:2},flashlight:{a:"ElectricTorch",b:"1F526",d:!0,e:!0,f:!0,h:!0,j:["手电筒","黑暗","露营","景象","晚上","dark","camping","sight","night"],k:[28,9],o:2},spider_web:{a:"SpiderWeb",b:"1F578-FE0F",c:"1F578",d:!0,e:!0,f:!0,h:!0,j:["蜘蛛网","动物","昆虫","蜘蛛类","丝绸","animal","insect","arachnid","silk"],k:[29,35],o:2},izakaya_lantern:{a:"IzakayaLantern",b:"1F3EE",d:!0,e:!0,f:!0,h:!0,j:["红灯笼","光","纸","万圣节","怪异","light","paper","halloween","spooky"],k:[11,8],n:["lantern"],o:2},"flag-gs":{a:"SouthGeorgia&SouthSandwichIslandsFlag",b:"1F1EC-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[2,11],o:2,j:["南乔治亚岛与南三明治群岛旗"]},shrug:{skin_variations:{"1F3FB":{unified:"1F937-1F3FB",non_qualified:null,image:"1f937-1f3fb.png",sheet_x:39,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F937-1F3FC",non_qualified:null,image:"1f937-1f3fc.png",sheet_x:39,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F937-1F3FD",non_qualified:null,image:"1f937-1f3fd.png",sheet_x:39,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F937-1F3FE",non_qualified:null,image:"1f937-1f3fe.png",sheet_x:39,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F937-1F3FF",non_qualified:null,image:"1f937-1f3ff.png",sheet_x:39,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"Shrug",b:"1F937",d:!0,e:!0,f:!0,h:!1,k:[39,47],o:4,j:["双手一摊的人"]},fleur_de_lis:{a:"FleurDeLis",b:"269C-FE0F",c:"269C",d:!0,e:!0,f:!0,h:!0,j:["鸢尾花","装饰","侦察员","decorative","scout"],k:[53,49],o:2},robot_face:{a:"RobotFace",b:"1F916",d:!0,e:!0,f:!0,h:!0,k:[37,29],o:2,j:["机器人"]},railway_track:{a:"RailwayTrack",b:"1F6E4-FE0F",c:"1F6E4",d:!0,e:!0,f:!0,h:!0,j:["铁路轨道","火车","运输","train","transportation"],k:[36,46],o:2},tea:{a:"TeacupWithoutHandle",b:"1F375",d:!0,e:!0,f:!0,h:!0,j:["不带提手的茶杯","喝","碗","早餐","绿","英国的","drink","bowl","breakfast","green","british"],k:[7,20],o:2},"flag-gt":{a:"GuatemalaFlag",b:"1F1EC-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[2,12],o:2,j:["危地马拉国旗"]},oil_drum:{a:"OilDrum",b:"1F6E2-FE0F",c:"1F6E2",d:!0,e:!0,f:!0,h:!0,j:["油桶","桶装","barrell"],k:[36,44],o:2},diya_lamp:{a:"DiyaLamp",b:"1FA94",d:!0,e:!0,f:!0,h:!0,k:[52,8],o:12,j:["油灯"]},sake:{a:"SakeBottleandCup",b:"1F376",d:!0,e:!0,f:!0,h:!0,j:["清酒","酒","喝","醉","饮料","日语","酒精","豪饮","wine","drink","drunk","beverage","japanese","alcohol","booze"],k:[7,21],o:2},trident:{a:"TridentEmblem",b:"1F531",d:!0,e:!0,f:!0,h:!0,j:["三叉戟","武器","矛","weapon","spear"],k:[28,20],o:2},"man-shrugging":{skin_variations:{"1F3FB":{unified:"1F937-1F3FB-200D-2642-FE0F",non_qualified:"1F937-1F3FB-200D-2642",image:"1f937-1f3fb-200d-2642-fe0f.png",sheet_x:39,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F937-1F3FC-200D-2642-FE0F",non_qualified:"1F937-1F3FC-200D-2642",image:"1f937-1f3fc-200d-2642-fe0f.png",sheet_x:39,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F937-1F3FD-200D-2642-FE0F",non_qualified:"1F937-1F3FD-200D-2642",image:"1f937-1f3fd-200d-2642-fe0f.png",sheet_x:39,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F937-1F3FE-200D-2642-FE0F",non_qualified:"1F937-1F3FE-200D-2642",image:"1f937-1f3fe-200d-2642-fe0f.png",sheet_x:39,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F937-1F3FF-200D-2642-FE0F",non_qualified:"1F937-1F3FF-200D-2642",image:"1f937-1f3ff-200d-2642-fe0f.png",sheet_x:39,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManShrugging",b:"1F937-200D-2642-FE0F",c:"1F937-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[39,41],o:4,j:["双手一摊的男人"]},smiley_cat:{a:"SmilingCatFacewithOpenMouth",b:"1F63A",d:!0,e:!0,f:!0,h:!0,j:["笑嘻嘻的猫","动物","猫","快乐","微笑","animal","cats","happy","smile"],k:[31,36],o:2},scorpion:{a:"Scorpion",b:"1F982",d:!0,e:!0,f:!0,h:!0,j:["蝎","动物","蜘蛛类","animal","arachnid"],k:[42,20],o:2},"woman-shrugging":{skin_variations:{"1F3FB":{unified:"1F937-1F3FB-200D-2640-FE0F",non_qualified:"1F937-1F3FB-200D-2640",image:"1f937-1f3fb-200d-2640-fe0f.png",sheet_x:39,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F937-1F3FC-200D-2640-FE0F",non_qualified:"1F937-1F3FC-200D-2640",image:"1f937-1f3fc-200d-2640-fe0f.png",sheet_x:39,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F937-1F3FD-200D-2640-FE0F",non_qualified:"1F937-1F3FD-200D-2640",image:"1f937-1f3fd-200d-2640-fe0f.png",sheet_x:39,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F937-1F3FE-200D-2640-FE0F",non_qualified:"1F937-1F3FE-200D-2640",image:"1f937-1f3fe-200d-2640-fe0f.png",sheet_x:39,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F937-1F3FF-200D-2640-FE0F",non_qualified:"1F937-1F3FF-200D-2640",image:"1f937-1f3ff-200d-2640-fe0f.png",sheet_x:39,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanShrugging",b:"1F937-200D-2640-FE0F",c:"1F937-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[39,35],o:4,j:["双手一摊的女人"]},notebook_with_decorative_cover:{a:"NotebookwithDecorativeCover",b:"1F4D4",d:!0,e:!0,f:!0,h:!0,j:["有装饰的笔记本","课堂","笔记","记录","纸","研究","classroom","notes","record","paper","study"],k:[26,42],o:2},fuelpump:{a:"FuelPump",b:"26FD",d:!0,e:!0,f:!0,h:!0,j:["加油泵","加油站","石油","gasstation","petroleum"],k:[54,38],o:2},name_badge:{a:"NameBadge",b:"1F4DB",d:!0,e:!0,f:!0,h:!0,j:["名牌徽章","火灾","禁止","fire","forbid"],k:[26,49],o:2},mosquito:{a:"Mosquito",b:"1F99F",d:!0,e:!0,f:!0,h:!0,k:[42,49],o:11,j:["蚊子"]},"flag-gu":{a:"GuamFlag",b:"1F1EC-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[2,13],o:2,j:["关岛旗"]},smile_cat:{a:"GrinningCatFacewithSmilingEyes",b:"1F638",d:!0,e:!0,f:!0,h:!0,j:["眉开眼笑的猫","动物","猫","微笑","animal","cats","smile"],k:[31,34],o:2},champagne:{a:"BottlewithPoppingCork",b:"1F37E",d:!0,e:!0,f:!0,h:!0,j:["开启的香槟","喝","酒","瓶","庆祝","drink","wine","bottle","celebration"],k:[7,29],o:2},joy_cat:{a:"CatFacewithTearsofJoy",b:"1F639",d:!0,e:!0,f:!0,h:!0,j:["笑Cry的猫","动物","猫","哈哈","快乐","眼泪","animal","cats","haha","happy","tears"],k:[31,35],o:2},closed_book:{a:"ClosedBook",b:"1F4D5",d:!0,e:!0,f:!0,h:!0,j:["闭卷","读","图书馆","知识","教科书","学习","read","library","knowledge","textbook","learn"],k:[26,43],o:2},health_worker:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-2695-FE0F",non_qualified:"1F9D1-1F3FB-200D-2695",image:"1f9d1-1f3fb-200d-2695-fe0f.png",sheet_x:47,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-2695-FE0F",non_qualified:"1F9D1-1F3FC-200D-2695",image:"1f9d1-1f3fc-200d-2695-fe0f.png",sheet_x:47,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-2695-FE0F",non_qualified:"1F9D1-1F3FD-200D-2695",image:"1f9d1-1f3fd-200d-2695-fe0f.png",sheet_x:47,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-2695-FE0F",non_qualified:"1F9D1-1F3FE-200D-2695",image:"1f9d1-1f3fe-200d-2695-fe0f.png",sheet_x:47,sheet_y:53,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-2695-FE0F",non_qualified:"1F9D1-1F3FF-200D-2695",image:"1f9d1-1f3ff-200d-2695-fe0f.png",sheet_x:47,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"HealthWorker",b:"1F9D1-200D-2695-FE0F",c:"1F9D1-200D-2695",d:!0,e:!1,f:!1,h:!1,k:[47,49],o:12,j:["卫生工作者"]},rotating_light:{a:"PoliceCarsRevolvingLight",b:"1F6A8",d:!0,e:!0,f:!0,h:!0,j:["警车灯","警察","救护车","911","紧急","警报","错误","已 pinged","法律","法律","police","ambulance","911","emergency","alert","error","pinged","law","legal"],k:[34,56],o:2},microbe:{a:"Microbe",b:"1F9A0",d:!0,e:!0,f:!0,h:!0,k:[42,50],o:11,j:["微生物"]},"flag-gw":{a:"Guinea-BissauFlag",b:"1F1EC-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[2,14],o:2,j:["几内亚比绍国旗"]},wine_glass:{a:"WineGlass",b:"1F377",d:!0,e:!0,f:!0,h:!0,j:["红酒杯","喝","饮料","醉","酒精","豪饮","drink","beverage","drunk","alcohol","booze"],k:[7,22],o:2},beginner:{a:"JapaneseSymbolforBeginner",b:"1F530",d:!0,e:!0,f:!0,h:!0,j:["初学者符号","徽章","盾","badge","shield"],k:[28,19],o:2},bouquet:{a:"Bouquet",b:"1F490",d:!0,e:!0,f:!0,h:!0,j:["花束","花","自然界","春天","flowers","nature","spring"],k:[25,26],o:2},heart_eyes_cat:{a:"SmilingCatFacewithHeart-ShapedEyes",b:"1F63B",d:!0,e:!0,f:!0,h:!0,j:["眼冒爱心的猫","动物","爱","喜欢","感情","猫","情人","心","animal","love","like","affection","cats","valentines","heart"],k:[31,37],o:2},"male-doctor":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-2695-FE0F",non_qualified:"1F468-1F3FB-200D-2695",image:"1f468-1f3fb-200d-2695-fe0f.png",sheet_x:17,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-2695-FE0F",non_qualified:"1F468-1F3FC-200D-2695",image:"1f468-1f3fc-200d-2695-fe0f.png",sheet_x:17,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-2695-FE0F",non_qualified:"1F468-1F3FD-200D-2695",image:"1f468-1f3fd-200d-2695-fe0f.png",sheet_x:17,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-2695-FE0F",non_qualified:"1F468-1F3FE-200D-2695",image:"1f468-1f3fe-200d-2695-fe0f.png",sheet_x:17,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-2695-FE0F",non_qualified:"1F468-1F3FF-200D-2695",image:"1f468-1f3ff-200d-2695-fe0f.png",sheet_x:17,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleDoctor",b:"1F468-200D-2695-FE0F",c:"1F468-200D-2695",d:!0,e:!0,f:!0,h:!0,k:[17,2],o:4,j:["男性卫生工作者"]},book:{a:"OpenBook",b:"1F4D6",d:!0,e:!0,f:!0,h:!0,k:[26,44],n:["open_book"],o:2,j:["打开书"]},traffic_light:{a:"HorizontalTrafficLight",b:"1F6A5",d:!0,e:!0,f:!0,h:!0,j:["水平红绿灯","运输","信号","transportation","signal"],k:[34,53],o:2},cocktail:{a:"CocktailGlass",b:"1F378",d:!0,e:!0,f:!0,h:!0,j:["鸡尾酒玻璃杯","喝","醉","酒精","饮料","豪饮","莫吉托","drink","drunk","alcohol","beverage","booze","mojito"],k:[7,23],o:2},o:{a:"HeavyLargeCircle",b:"2B55",d:!0,e:!0,f:!0,h:!0,j:["空心红圈","圈","圆","circle","round"],k:[55,43],o:2},"flag-gy":{a:"GuyanaFlag",b:"1F1EC-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[2,15],o:2,j:["圭亚那国旗"]},"female-doctor":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-2695-FE0F",non_qualified:"1F469-1F3FB-200D-2695",image:"1f469-1f3fb-200d-2695-fe0f.png",sheet_x:19,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-2695-FE0F",non_qualified:"1F469-1F3FC-200D-2695",image:"1f469-1f3fc-200d-2695-fe0f.png",sheet_x:19,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-2695-FE0F",non_qualified:"1F469-1F3FD-200D-2695",image:"1f469-1f3fd-200d-2695-fe0f.png",sheet_x:19,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-2695-FE0F",non_qualified:"1F469-1F3FE-200D-2695",image:"1f469-1f3fe-200d-2695-fe0f.png",sheet_x:19,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-2695-FE0F",non_qualified:"1F469-1F3FF-200D-2695",image:"1f469-1f3ff-200d-2695-fe0f.png",sheet_x:19,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleDoctor",b:"1F469-200D-2695-FE0F",c:"1F469-200D-2695",d:!0,e:!0,f:!0,h:!0,k:[19,44],o:4,j:["女性卫生工作者"]},smirk_cat:{a:"CatFacewithWrySmile",b:"1F63C",d:!0,e:!0,f:!0,h:!0,j:["得意的猫","动物","猫","傻笑","animal","cats","smirk"],k:[31,38],o:2},green_book:{a:"GreenBook",b:"1F4D7",d:!0,e:!0,f:!0,h:!0,j:["绿皮书","读","图书馆","知识","研究","read","library","knowledge","study"],k:[26,45],o:2},cherry_blossom:{a:"CherryBlossom",b:"1F338",d:!0,e:!0,f:!0,h:!0,j:["樱花","自然界","植物","春天","花","nature","plant","spring","flower"],k:[6,16],o:2},"flag-hk":{a:"HongKongSarChinaFlag",b:"1F1ED-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[2,16],o:2,j:["香港特别行政区旗"]},vertical_traffic_light:{a:"VerticalTrafficLight",b:"1F6A6",d:!0,e:!0,f:!0,h:!0,j:["垂直红绿灯","运输","驾驶","transportation","driving"],k:[34,54],o:2},white_check_mark:{a:"WhiteHeavyCheckMark",b:"2705",d:!0,e:!0,f:!0,h:!0,j:["选取标记按钮","绿色方块","还行","同意","投票","选举","答","蜱","green-square","ok","agree","vote","election","answer","tick"],k:[54,40],o:2},tropical_drink:{a:"TropicalDrink",b:"1F379",d:!0,e:!0,f:!0,h:!0,j:["热带饮料","饮料","鸡尾酒","夏天","海滩","酒精","豪饮","莫吉托","beverage","cocktail","summer","beach","alcohol","booze","mojito"],k:[7,24],o:2},kissing_cat:{a:"KissingCatFacewithClosedEyes",b:"1F63D",d:!0,e:!0,f:!0,h:!0,j:["接吻的猫","动物","猫","吻","animal","cats","kiss"],k:[31,39],o:2},"flag-hm":{a:"Heard&McdonaldIslandsFlag",b:"1F1ED-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,17],o:2,j:["赫德与麦克唐纳群岛旗"]},octagonal_sign:{a:"OctagonalSign",b:"1F6D1",d:!0,e:!0,f:!0,h:!0,k:[36,39],o:4,j:["停止标志"]},white_flower:{a:"WhiteFlower",b:"1F4AE",d:!0,e:!0,f:!0,h:!0,j:["白色的花","日语","春天","japanese","spring"],k:[26,4],o:2},ballot_box_with_check:{a:"BallotBoxwithCheck",b:"2611-FE0F",c:"2611",d:!0,e:!0,f:!0,h:!0,j:["选取框与勾选标记","还行","同意","确认","黑色方块","投票","选举","是的","蜱","ok","agree","confirm","black-square","vote","election","yes","tick"],k:[52,55],o:2},student:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F393",non_qualified:null,image:"1f9d1-1f3fb-200d-1f393.png",sheet_x:45,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F393",non_qualified:null,image:"1f9d1-1f3fc-200d-1f393.png",sheet_x:45,sheet_y:31,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F393",non_qualified:null,image:"1f9d1-1f3fd-200d-1f393.png",sheet_x:45,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F393",non_qualified:null,image:"1f9d1-1f3fe-200d-1f393.png",sheet_x:45,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F393",non_qualified:null,image:"1f9d1-1f3ff-200d-1f393.png",sheet_x:45,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Student",b:"1F9D1-200D-1F393",d:!0,e:!1,f:!1,h:!1,k:[45,29],o:12,j:["学生"]},blue_book:{a:"BlueBook",b:"1F4D8",d:!0,e:!0,f:!0,h:!0,j:["蓝皮书","读","图书馆","知识","学习","研究","read","library","knowledge","learn","study"],k:[26,46],o:2},beer:{a:"BeerMug",b:"1F37A",d:!0,e:!0,f:!0,h:!0,j:["啤酒杯","放松","饮料","喝","醉","党","酒馆","夏天","酒精","豪饮","relax","beverage","drink","drunk","party","pub","summer","alcohol","booze"],k:[7,25],o:2},construction:{a:"ConstructionSign",b:"1F6A7",d:!0,e:!0,f:!0,h:!0,j:["施工路障","维普","进展","谨慎","警告","wip","progress","caution","warning"],k:[34,55],o:2},rosette:{a:"Rosette",b:"1F3F5-FE0F",c:"1F3F5",d:!0,e:!0,f:!0,h:!0,j:["光荣花","花","装饰","军事","flower","decoration","military"],k:[11,18],o:2},heavy_check_mark:{a:"HeavyCheckMark",b:"2714-FE0F",c:"2714",d:!0,e:!0,f:!0,h:!0,j:["勾选标记","还行","耐克","答","是的","蜱","ok","nike","answer","yes","tick"],k:[55,12],o:2},scream_cat:{a:"WearyCatFace",b:"1F640",d:!0,e:!0,f:!0,h:!0,j:["疲惫的猫","动物","猫","噍","害怕","尖叫","animal","cats","munch","scared","scream"],k:[31,42],o:2},orange_book:{a:"OrangeBook",b:"1F4D9",d:!0,e:!0,f:!0,h:!0,j:["橙色书","读","图书馆","知识","教科书","研究","read","library","knowledge","textbook","study"],k:[26,47],o:2},beers:{a:"ClinkingBeerMugs",b:"1F37B",d:!0,e:!0,f:!0,h:!0,j:["碰撞啤酒杯","放松","饮料","喝","醉","党","酒馆","夏天","酒精","豪饮","relax","beverage","drink","drunk","party","pub","summer","alcohol","booze"],k:[7,26],o:2},"male-student":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F393",non_qualified:null,image:"1f468-1f3fb-200d-1f393.png",sheet_x:14,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F393",non_qualified:null,image:"1f468-1f3fc-200d-1f393.png",sheet_x:14,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F393",non_qualified:null,image:"1f468-1f3fd-200d-1f393.png",sheet_x:14,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F393",non_qualified:null,image:"1f468-1f3fe-200d-1f393.png",sheet_x:14,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F393",non_qualified:null,image:"1f468-1f3ff-200d-1f393.png",sheet_x:14,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleStudent",b:"1F468-200D-1F393",d:!0,e:!0,f:!0,h:!0,k:[14,50],o:4,j:["男学生"]},"flag-hn":{a:"HondurasFlag",b:"1F1ED-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[2,18],o:2,j:["洪都拉斯国旗"]},crying_cat_face:{a:"CryingCatFace",b:"1F63F",d:!0,e:!0,f:!0,h:!0,j:["哭泣的猫","动物","眼泪","哭","伤心","猫","沮丧","哭","animal","tears","weep","sad","cats","upset","cry"],k:[31,41],o:2},anchor:{a:"Anchor",b:"2693",d:!0,e:!0,f:!0,h:!0,j:["锚","船","渡轮","海","船","ship","ferry","sea","boat"],k:[53,42],o:2},"flag-hr":{a:"CroatiaFlag",b:"1F1ED-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[2,19],o:2,j:["克罗地亚国旗"]},heavy_multiplication_x:{a:"HeavyMultiplicationX",b:"2716-FE0F",c:"2716",d:!0,e:!0,f:!0,h:!0,j:["乘号","数学","计算","math","calculation"],k:[55,13],o:2},"female-student":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F393",non_qualified:null,image:"1f469-1f3fb-200d-1f393.png",sheet_x:17,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F393",non_qualified:null,image:"1f469-1f3fc-200d-1f393.png",sheet_x:17,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F393",non_qualified:null,image:"1f469-1f3fd-200d-1f393.png",sheet_x:17,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F393",non_qualified:null,image:"1f469-1f3fe-200d-1f393.png",sheet_x:17,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F393",non_qualified:null,image:"1f469-1f3ff-200d-1f393.png",sheet_x:17,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleStudent",b:"1F469-200D-1F393",d:!0,e:!0,f:!0,h:!0,k:[17,40],o:4,j:["女学生"]},rose:{a:"Rose",b:"1F339",d:!0,e:!0,f:!0,h:!0,j:["玫瑰","花","情人","爱","春天","flowers","valentines","love","spring"],k:[6,17],o:2},books:{a:"Books",b:"1F4DA",d:!0,e:!0,f:!0,h:!0,j:["图书","文献","图书馆","研究","literature","library","study"],k:[26,48],o:2},clinking_glasses:{a:"ClinkingGlasses",b:"1F942",d:!0,e:!0,f:!0,h:!0,j:["碰撞玻璃杯","饮料","喝","党","酒精","庆祝","干杯","beverage","drink","party","alcohol","celebrate","cheers"],k:[41,18],o:4},teacher:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3fb-200d-1f3eb.png",sheet_x:45,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3fc-200d-1f3eb.png",sheet_x:45,sheet_y:49,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3fd-200d-1f3eb.png",sheet_x:45,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3fe-200d-1f3eb.png",sheet_x:45,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F3EB",non_qualified:null,image:"1f9d1-1f3ff-200d-1f3eb.png",sheet_x:45,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Teacher",b:"1F9D1-200D-1F3EB",d:!0,e:!1,f:!1,h:!1,k:[45,47],o:12,j:["老师"]},x:{a:"CrossMark",b:"274C",d:!0,e:!0,f:!0,h:!0,j:["十字标记","不","删除","删除","取消","no","delete","remove","cancel"],k:[55,21],o:2},pouting_cat:{a:"PoutingCatFace",b:"1F63E",d:!0,e:!0,f:!0,h:!0,j:["撅嘴猫","动物","猫","animal","cats"],k:[31,40],o:2},wilted_flower:{a:"WiltedFlower",b:"1F940",d:!0,e:!0,f:!0,h:!0,j:["枯萎的花","植物","自然界","花","plant","nature","flower"],k:[41,16],o:4},boat:{a:"Sailboat",b:"26F5",d:!0,e:!0,f:!0,h:!0,k:[54,16],n:["sailboat"],o:2,j:["帆船"]},"flag-ht":{a:"HaitiFlag",b:"1F1ED-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[2,20],o:2,j:["海地国旗"]},tumbler_glass:{a:"TumblerGlass",b:"1F943",d:!0,e:!0,f:!0,h:!0,j:["玻璃杯","喝","饮料","醉","酒精","酒","豪饮","波 旁","威士忌","威士忌酒","玻璃","拍摄","drink","beverage","drunk","alcohol","liquor","booze","bourbon","scotch","whisky","glass","shot"],k:[41,19],o:4},notebook:{a:"Notebook",b:"1F4D3",d:!0,e:!0,f:!0,h:!0,j:["笔记本","文具","记录","笔记","纸","研究","stationery","record","notes","paper","study"],k:[26,41],o:2},"male-teacher":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F3EB",non_qualified:null,image:"1f468-1f3fb-200d-1f3eb.png",sheet_x:15,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F3EB",non_qualified:null,image:"1f468-1f3fc-200d-1f3eb.png",sheet_x:15,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F3EB",non_qualified:null,image:"1f468-1f3fd-200d-1f3eb.png",sheet_x:15,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F3EB",non_qualified:null,image:"1f468-1f3fe-200d-1f3eb.png",sheet_x:15,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F3EB",non_qualified:null,image:"1f468-1f3ff-200d-1f3eb.png",sheet_x:15,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleTeacher",b:"1F468-200D-1F3EB",d:!0,e:!0,f:!0,h:!0,k:[15,11],o:4,j:["男老师"]},ledger:{a:"Ledger",b:"1F4D2",d:!0,e:!0,f:!0,h:!0,j:["账本","笔记","纸","notes","paper"],k:[26,40],o:2},"flag-hu":{a:"HungaryFlag",b:"1F1ED-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[2,21],o:2,j:["匈牙利国旗"]},cup_with_straw:{a:"CupwithStraw",b:"1F964",d:!0,e:!0,f:!0,h:!0,k:[41,51],o:5,j:["吸管杯"]},hibiscus:{a:"Hibiscus",b:"1F33A",d:!0,e:!0,f:!0,h:!0,j:["木槿","植物","蔬菜","花","海滩","plant","vegetable","flowers","beach"],k:[6,18],o:2},see_no_evil:{a:"See-No-EvilMonkey",b:"1F648",d:!0,e:!0,f:!0,h:!0,j:["遮眼的猴子","猴子","动物","自然界","哈哈","monkey","animal","nature","haha"],k:[32,44],o:2},canoe:{a:"Canoe",b:"1F6F6",d:!0,e:!0,f:!0,h:!0,j:["独木舟","船","桨","水","船","boat","paddle","water","ship"],k:[36,55],o:4},negative_squared_cross_mark:{a:"NegativeSquaredCrossMark",b:"274E",d:!0,e:!0,f:!0,h:!0,j:["十字标记按钮","x","绿色方块","不","否认","x","green-square","no","deny"],k:[55,22],o:2},"flag-ic":{a:"CanaryIslandsFlag",b:"1F1EE-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[2,22],o:2,j:["加那利群岛旗"]},beverage_box:{a:"BeverageBox",b:"1F9C3",d:!0,e:!0,f:!0,h:!0,k:[44,11],o:12,j:["饮料盒"]},speedboat:{a:"Speedboat",b:"1F6A4",d:!0,e:!0,f:!0,h:!0,j:["快艇","船","运输","车辆","夏天","ship","transportation","vehicle","summer"],k:[34,52],o:2},heavy_plus_sign:{a:"HeavyPlusSign",b:"2795",d:!0,e:!0,f:!0,h:!0,j:["加号","数学","计算","加法","更多","增加","math","calculation","addition","more","increase"],k:[55,29],o:2},sunflower:{a:"Sunflower",b:"1F33B",d:!0,e:!0,f:!0,h:!0,j:["向日葵","自然界","植物","秋天","nature","plant","fall"],k:[6,19],o:2},page_with_curl:{a:"PagewithCurl",b:"1F4C3",d:!0,e:!0,f:!0,h:!0,j:["卷曲的页面","文件","办公室","纸","documents","office","paper"],k:[26,25],o:2},"female-teacher":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F3EB",non_qualified:null,image:"1f469-1f3fb-200d-1f3eb.png",sheet_x:18,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F3EB",non_qualified:null,image:"1f469-1f3fc-200d-1f3eb.png",sheet_x:18,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F3EB",non_qualified:null,image:"1f469-1f3fd-200d-1f3eb.png",sheet_x:18,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F3EB",non_qualified:null,image:"1f469-1f3fe-200d-1f3eb.png",sheet_x:18,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F3EB",non_qualified:null,image:"1f469-1f3ff-200d-1f3eb.png",sheet_x:18,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleTeacher",b:"1F469-200D-1F3EB",d:!0,e:!0,f:!0,h:!0,k:[18,1],o:4,j:["女教师"]},hear_no_evil:{a:"Hear-No-EvilMonkey",b:"1F649",d:!0,e:!0,f:!0,h:!0,j:["捂耳的猴子","动物","猴子","自然界","animal","monkey","nature"],k:[32,45],o:2},mate_drink:{a:"MateDrink",b:"1F9C9",d:!0,e:!0,f:!0,h:!0,k:[44,17],o:12,j:["玛岱"]},passenger_ship:{a:"PassengerShip",b:"1F6F3-FE0F",c:"1F6F3",d:!0,e:!0,f:!0,h:!0,j:["客船","游艇","巡航","渡轮","yacht","cruise","ferry"],k:[36,52],o:2},judge:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-2696-FE0F",non_qualified:"1F9D1-1F3FB-200D-2696",image:"1f9d1-1f3fb-200d-2696-fe0f.png",sheet_x:47,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-2696-FE0F",non_qualified:"1F9D1-1F3FC-200D-2696",image:"1f9d1-1f3fc-200d-2696-fe0f.png",sheet_x:48,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-2696-FE0F",non_qualified:"1F9D1-1F3FD-200D-2696",image:"1f9d1-1f3fd-200d-2696-fe0f.png",sheet_x:48,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-2696-FE0F",non_qualified:"1F9D1-1F3FE-200D-2696",image:"1f9d1-1f3fe-200d-2696-fe0f.png",sheet_x:48,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-2696-FE0F",non_qualified:"1F9D1-1F3FF-200D-2696",image:"1f9d1-1f3ff-200d-2696-fe0f.png",sheet_x:48,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Judge",b:"1F9D1-200D-2696-FE0F",c:"1F9D1-200D-2696",d:!0,e:!1,f:!1,h:!1,k:[47,55],o:12,j:["法官"]},scroll:{a:"Scroll",b:"1F4DC",d:!0,e:!0,f:!0,h:!0,j:["卷轴","文件","古代","历史","纸","documents","ancient","history","paper"],k:[26,50],o:2},blossom:{a:"Blossom",b:"1F33C",d:!0,e:!0,f:!0,h:!0,j:["开花","自然界","花","黄色","nature","flowers","yellow"],k:[6,20],o:2},"flag-id":{a:"IndonesiaFlag",b:"1F1EE-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[2,23],o:2,j:["印尼国旗"]},speak_no_evil:{a:"Speak-No-EvilMonkey",b:"1F64A",d:!0,e:!0,f:!0,h:!0,j:["捂嘴的猴子","猴子","动物","自然界","嗯","monkey","animal","nature","omg"],k:[32,46],o:2},heavy_minus_sign:{a:"HeavyMinusSign",b:"2796",d:!0,e:!0,f:!0,h:!0,j:["减号","数学","计算","减去","少","math","calculation","subtract","less"],k:[55,30],o:2},"flag-ie":{a:"IrelandFlag",b:"1F1EE-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[2,24],o:2,j:["爱尔兰国旗"]},ice_cube:{a:"IceCube",b:"1F9CA",d:!0,e:!0,f:!0,h:!0,k:[44,18],o:12,j:["冰块"]},page_facing_up:{a:"PageFacingUp",b:"1F4C4",d:!0,e:!0,f:!0,h:!0,j:["页面朝上","文件","办公室","纸","信息","documents","office","paper","information"],k:[26,26],o:2},"male-judge":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-2696-FE0F",non_qualified:"1F468-1F3FB-200D-2696",image:"1f468-1f3fb-200d-2696-fe0f.png",sheet_x:17,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-2696-FE0F",non_qualified:"1F468-1F3FC-200D-2696",image:"1f468-1f3fc-200d-2696-fe0f.png",sheet_x:17,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-2696-FE0F",non_qualified:"1F468-1F3FD-200D-2696",image:"1f468-1f3fd-200d-2696-fe0f.png",sheet_x:17,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-2696-FE0F",non_qualified:"1F468-1F3FE-200D-2696",image:"1f468-1f3fe-200d-2696-fe0f.png",sheet_x:17,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-2696-FE0F",non_qualified:"1F468-1F3FF-200D-2696",image:"1f468-1f3ff-200d-2696-fe0f.png",sheet_x:17,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleJudge",b:"1F468-200D-2696-FE0F",c:"1F468-200D-2696",d:!0,e:!0,f:!0,h:!0,k:[17,8],o:4,j:["男法官"]},tulip:{a:"Tulip",b:"1F337",d:!0,e:!0,f:!0,h:!0,j:["郁金香","花","植物","自然界","夏天","春天","flowers","plant","nature","summer","spring"],k:[6,15],o:2},ferry:{a:"Ferry",b:"26F4-FE0F",c:"26F4",d:!0,e:!0,f:!0,h:!0,j:["渡船","船","船","游艇","boat","ship","yacht"],k:[54,15],o:2},kiss:{a:"KissMark",b:"1F48B",d:!0,e:!0,f:!0,h:!0,j:["吻痕","脸","嘴唇","爱","喜欢","感情","情人","face","lips","love","like","affection","valentines"],k:[25,21],o:2},heavy_division_sign:{a:"HeavyDivisionSign",b:"2797",d:!0,e:!0,f:!0,h:!0,j:["除号","分","数学","计算","divide","math","calculation"],k:[55,31],o:2},newspaper:{a:"Newspaper",b:"1F4F0",d:!0,e:!0,f:!0,h:!0,j:["报纸","压","标题","press","headline"],k:[27,13],o:2},"female-judge":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-2696-FE0F",non_qualified:"1F469-1F3FB-200D-2696",image:"1f469-1f3fb-200d-2696-fe0f.png",sheet_x:19,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-2696-FE0F",non_qualified:"1F469-1F3FC-200D-2696",image:"1f469-1f3fc-200d-2696-fe0f.png",sheet_x:19,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-2696-FE0F",non_qualified:"1F469-1F3FD-200D-2696",image:"1f469-1f3fd-200d-2696-fe0f.png",sheet_x:19,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-2696-FE0F",non_qualified:"1F469-1F3FE-200D-2696",image:"1f469-1f3fe-200d-2696-fe0f.png",sheet_x:19,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-2696-FE0F",non_qualified:"1F469-1F3FF-200D-2696",image:"1f469-1f3ff-200d-2696-fe0f.png",sheet_x:19,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleJudge",b:"1F469-200D-2696-FE0F",c:"1F469-200D-2696",d:!0,e:!0,f:!0,h:!0,k:[19,50],o:4,j:["女法官"]},seedling:{a:"Seedling",b:"1F331",d:!0,e:!0,f:!0,h:!0,j:["幼苗","植物","自然界","草","草坪","春天","plant","nature","grass","lawn","spring"],k:[6,9],o:2},love_letter:{a:"LoveLetter",b:"1F48C",d:!0,e:!0,f:!0,h:!0,j:["爱情信","电子邮件","喜欢","感情","信封","情人","email","like","affection","envelope","valentines"],k:[25,22],o:2},chopsticks:{a:"Chopsticks",b:"1F962",d:!0,e:!0,f:!0,h:!0,k:[41,49],o:5,j:["筷子"]},motor_boat:{a:"MotorBoat",b:"1F6E5-FE0F",c:"1F6E5",d:!0,e:!0,f:!0,h:!0,j:["摩托艇","船","ship"],k:[36,47],o:2},"flag-il":{a:"IsraelFlag",b:"1F1EE-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[2,25],o:2,j:["以色列国旗"]},curly_loop:{a:"CurlyLoop",b:"27B0",d:!0,e:!0,f:!0,h:!0,j:["卷曲环","乱 涂","画","形状","波浪线","scribble","draw","shape","squiggle"],k:[55,33],o:2},"flag-im":{a:"IsleofManFlag",b:"1F1EE-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,26],o:2,j:["马恩岛旗"]},evergreen_tree:{a:"EvergreenTree",b:"1F332",d:!0,e:!0,f:!0,h:!0,j:["常青树","植物","自然界","plant","nature"],k:[6,10],o:2},cupid:{a:"HeartwithArrow",b:"1F498",d:!0,e:!0,f:!0,h:!0,j:["穿心箭","爱","喜欢","心","感情","情人","love","like","heart","affection","valentines"],k:[25,34],o:2},loop:{a:"DoubleCurlyLoop",b:"27BF",d:!0,e:!0,f:!0,h:!0,j:["双循环","磁带","暗盒","tape","cassette"],k:[55,34],o:2},ship:{a:"Ship",b:"1F6A2",d:!0,e:!0,f:!0,h:!0,j:["船","运输","钛","部署","transportation","titanic","deploy"],k:[34,33],o:2},farmer:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F33E",non_qualified:null,image:"1f9d1-1f3fb-200d-1f33e.png",sheet_x:45,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F33E",non_qualified:null,image:"1f9d1-1f3fc-200d-1f33e.png",sheet_x:45,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F33E",non_qualified:null,image:"1f9d1-1f3fd-200d-1f33e.png",sheet_x:45,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F33E",non_qualified:null,image:"1f9d1-1f3fe-200d-1f33e.png",sheet_x:45,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F33E",non_qualified:null,image:"1f9d1-1f3ff-200d-1f33e.png",sheet_x:45,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Farmer",b:"1F9D1-200D-1F33E",d:!0,e:!1,f:!1,h:!1,k:[45,17],o:12,j:["农民"]},rolled_up_newspaper:{a:"RolledUpNewspaper",b:"1F5DE-FE0F",c:"1F5DE",d:!0,e:!0,f:!0,h:!0,k:[30,23],o:2,j:["卷起的报纸"]},knife_fork_plate:{a:"KnifeForkPlate",b:"1F37D-FE0F",c:"1F37D",d:!0,e:!0,f:!0,h:!0,k:[7,28],o:2,j:["刀叉与盘子"]},fork_and_knife:{a:"ForkandKnife",b:"1F374",d:!0,e:!0,f:!0,h:!0,j:["刀叉","餐具","厨房","cutlery","kitchen"],k:[7,19],o:2},"male-farmer":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F33E",non_qualified:null,image:"1f468-1f3fb-200d-1f33e.png",sheet_x:14,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F33E",non_qualified:null,image:"1f468-1f3fc-200d-1f33e.png",sheet_x:14,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F33E",non_qualified:null,image:"1f468-1f3fd-200d-1f33e.png",sheet_x:14,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F33E",non_qualified:null,image:"1f468-1f3fe-200d-1f33e.png",sheet_x:14,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F33E",non_qualified:null,image:"1f468-1f3ff-200d-1f33e.png",sheet_x:14,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleFarmer",b:"1F468-200D-1F33E",d:!0,e:!0,f:!0,h:!0,k:[14,38],o:4,j:["男性农民"]},bookmark_tabs:{a:"BookmarkTabs",b:"1F4D1",d:!0,e:!0,f:!0,h:!0,j:["书签标签","喜欢","救","次序","整洁","favorite","save","order","tidy"],k:[26,39],o:2},part_alternation_mark:{a:"PartAlternationMark",b:"303D-FE0F",c:"303D",d:!0,e:!0,f:!0,h:!0,j:["部分交替标志","图","介绍","统计","商","经济学","坏","graph","presentation","stats","business","economics","bad"],k:[55,45],o:2},"flag-in":{a:"IndiaFlag",b:"1F1EE-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[2,27],o:2,j:["印度国旗"]},gift_heart:{a:"HeartwithRibbon",b:"1F49D",d:!0,e:!0,f:!0,h:!0,j:["心脏丝带","爱","情人","love","valentines"],k:[25,39],o:2},airplane:{a:"Airplane",b:"2708-FE0F",c:"2708",d:!0,e:!0,f:!0,h:!0,j:["飞机","车辆","运输","飞行","飞","vehicle","transportation","flight","fly"],k:[54,41],o:2},deciduous_tree:{a:"DeciduousTree",b:"1F333",d:!0,e:!0,f:!0,h:!0,j:["落叶乔木","植物","自然界","plant","nature"],k:[6,11],o:2},spoon:{a:"Spoon",b:"1F944",d:!0,e:!0,f:!0,h:!0,j:["勺","餐具","厨房","餐具","cutlery","kitchen","tableware"],k:[41,20],o:4},"flag-io":{a:"BritishIndianOceanTerritoryFlag",b:"1F1EE-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[2,28],o:2,j:["英属印度洋领地旗"]},palm_tree:{a:"PalmTree",b:"1F334",d:!0,e:!0,f:!0,h:!0,j:["榈","植物","蔬菜","自然界","夏天","海滩","莫吉托","热带","plant","vegetable","nature","summer","beach","mojito","tropical"],k:[6,12],o:2},sparkling_heart:{a:"SparklingHeart",b:"1F496",d:!0,e:!0,f:!0,h:!0,j:["波光粼粼的心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,32],o:2},"female-farmer":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F33E",non_qualified:null,image:"1f469-1f3fb-200d-1f33e.png",sheet_x:17,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F33E",non_qualified:null,image:"1f469-1f3fc-200d-1f33e.png",sheet_x:17,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F33E",non_qualified:null,image:"1f469-1f3fd-200d-1f33e.png",sheet_x:17,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F33E",non_qualified:null,image:"1f469-1f3fe-200d-1f33e.png",sheet_x:17,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F33E",non_qualified:null,image:"1f469-1f3ff-200d-1f33e.png",sheet_x:17,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleFarmer",b:"1F469-200D-1F33E",d:!0,e:!0,f:!0,h:!0,k:[17,28],o:4,j:["女农民"]},eight_spoked_asterisk:{a:"EightSpokedAsterisk",b:"2733-FE0F",c:"2733",d:!0,e:!0,f:!0,h:!0,j:["八辐条星号","星","火花","绿色方块","star","sparkle","green-square"],k:[55,17],o:2},small_airplane:{a:"SmallAirplane",b:"1F6E9-FE0F",c:"1F6E9",d:!0,e:!0,f:!0,h:!0,j:["小型飞机","飞行","运输","飞","车辆","flight","transportation","fly","vehicle"],k:[36,48],o:2},bookmark:{a:"Bookmark",b:"1F516",d:!0,e:!0,f:!0,h:!0,j:["书签","喜欢","标签","救","favorite","label","save"],k:[27,50],o:2},cook:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F373",non_qualified:null,image:"1f9d1-1f3fb-200d-1f373.png",sheet_x:45,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F373",non_qualified:null,image:"1f9d1-1f3fc-200d-1f373.png",sheet_x:45,sheet_y:25,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F373",non_qualified:null,image:"1f9d1-1f3fd-200d-1f373.png",sheet_x:45,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F373",non_qualified:null,image:"1f9d1-1f3fe-200d-1f373.png",sheet_x:45,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F373",non_qualified:null,image:"1f9d1-1f3ff-200d-1f373.png",sheet_x:45,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Cook",b:"1F9D1-200D-1F373",d:!0,e:!1,f:!1,h:!1,k:[45,23],o:12,j:["厨师"]},eight_pointed_black_star:{a:"EightPointedBlackStar",b:"2734-FE0F",c:"2734",d:!0,e:!0,f:!0,h:!0,j:["八角星","橙色方块","形状","多边形","orange-square","shape","polygon"],k:[55,18],o:2},heartpulse:{a:"GrowingHeart",b:"1F497",d:!0,e:!0,f:!0,h:!0,j:["不断增长的心脏","喜欢","爱","感情","情人","粉红色","like","love","affection","valentines","pink"],k:[25,33],o:2},label:{a:"Label",b:"1F3F7-FE0F",c:"1F3F7",d:!0,e:!0,f:!0,h:!0,j:["标签","销售","日","sale","tag"],k:[11,19],o:2},"flag-iq":{a:"IraqFlag",b:"1F1EE-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[2,29],o:2,j:["伊拉克国旗"]},hocho:{a:"Hocho",b:"1F52A",d:!0,e:!0,f:!0,h:!0,j:["菜刀","刀","叶片","餐具","厨房","武器","knife","blade","cutlery","kitchen","weapon"],k:[28,13],n:["knife"],o:2},cactus:{a:"Cactus",b:"1F335",d:!0,e:!0,f:!0,h:!0,j:["仙人掌","蔬菜","植物","自然界","vegetable","plant","nature"],k:[6,13],o:2},airplane_departure:{a:"AirplaneDeparture",b:"1F6EB",d:!0,e:!0,f:!0,h:!0,k:[36,49],o:2,j:["飞机起飞"]},airplane_arriving:{a:"AirplaneArriving",b:"1F6EC",d:!0,e:!0,f:!0,h:!0,k:[36,50],o:2,j:["飞机到达"]},ear_of_rice:{a:"EarofRice",b:"1F33E",d:!0,e:!0,f:!0,h:!0,j:["水稻","自然界","植物","nature","plant"],k:[6,22],o:2},"flag-ir":{a:"IranFlag",b:"1F1EE-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[2,30],o:2,j:["伊朗国旗"]},moneybag:{a:"MoneyBag",b:"1F4B0",d:!0,e:!0,f:!0,h:!0,j:["钱袋","美元","付款","硬币","销售","dollar","payment","coins","sale"],k:[26,6],o:2},"male-cook":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F373",non_qualified:null,image:"1f468-1f3fb-200d-1f373.png",sheet_x:14,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F373",non_qualified:null,image:"1f468-1f3fc-200d-1f373.png",sheet_x:14,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F373",non_qualified:null,image:"1f468-1f3fd-200d-1f373.png",sheet_x:14,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F373",non_qualified:null,image:"1f468-1f3fe-200d-1f373.png",sheet_x:14,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F373",non_qualified:null,image:"1f468-1f3ff-200d-1f373.png",sheet_x:14,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleCook",b:"1F468-200D-1F373",d:!0,e:!0,f:!0,h:!0,k:[14,44],o:4,j:["男厨师"]},heartbeat:{a:"BeatingHeart",b:"1F493",d:!0,e:!0,f:!0,h:!0,j:["跳动的心","爱","喜欢","感情","情人","粉红色","心","love","like","affection","valentines","pink","heart"],k:[25,29],o:2},sparkle:{a:"Sparkle",b:"2747-FE0F",c:"2747",d:!0,e:!0,f:!0,h:!0,j:["火花","星星","绿色方块","棒","好","烟火","stars","green-square","awesome","good","fireworks"],k:[55,20],o:2},amphora:{a:"Amphora",b:"1F3FA",d:!0,e:!0,f:!0,h:!0,j:["安芙兰","花瓶","罐","vase","jar"],k:[11,22],o:2},yen:{a:"BanknotewithYenSign",b:"1F4B4",d:!0,e:!0,f:!0,h:!0,j:["日元纸币","钱","销售","日语","美元","货币","money","sales","japanese","dollar","currency"],k:[26,10],o:2},revolving_hearts:{a:"RevolvingHearts",b:"1F49E",d:!0,e:!0,f:!0,h:!0,j:["旋转的心","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,40],o:2},bangbang:{a:"DoubleExclamationMark",b:"203C-FE0F",c:"203C",d:!0,e:!0,f:!0,h:!0,j:["双感叹号","惊叹号","惊喜","exclamation","surprise"],k:[52,10],o:2},parachute:{a:"Parachute",b:"1FA82",d:!0,e:!0,f:!0,h:!0,k:[52,3],o:12,j:["降落伞"]},herb:{a:"Herb",b:"1F33F",d:!0,e:!0,f:!0,h:!0,j:["草本植物","蔬菜","植物","药","杂草","草","草坪","vegetable","plant","medicine","weed","grass","lawn"],k:[6,23],o:2},"flag-is":{a:"IcelandFlag",b:"1F1EE-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[2,31],o:2,j:["冰岛旗"]},"female-cook":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F373",non_qualified:null,image:"1f469-1f3fb-200d-1f373.png",sheet_x:17,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F373",non_qualified:null,image:"1f469-1f3fc-200d-1f373.png",sheet_x:17,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F373",non_qualified:null,image:"1f469-1f3fd-200d-1f373.png",sheet_x:17,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F373",non_qualified:null,image:"1f469-1f3fe-200d-1f373.png",sheet_x:17,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F373",non_qualified:null,image:"1f469-1f3ff-200d-1f373.png",sheet_x:17,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleCook",b:"1F469-200D-1F373",d:!0,e:!0,f:!0,h:!0,k:[17,34],o:4,j:["女厨师"]},mechanic:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F527",non_qualified:null,image:"1f9d1-1f3fb-200d-1f527.png",sheet_x:46,sheet_y:15,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F527",non_qualified:null,image:"1f9d1-1f3fc-200d-1f527.png",sheet_x:46,sheet_y:16,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F527",non_qualified:null,image:"1f9d1-1f3fd-200d-1f527.png",sheet_x:46,sheet_y:17,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F527",non_qualified:null,image:"1f9d1-1f3fe-200d-1f527.png",sheet_x:46,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F527",non_qualified:null,image:"1f9d1-1f3ff-200d-1f527.png",sheet_x:46,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Mechanic",b:"1F9D1-200D-1F527",d:!0,e:!1,f:!1,h:!1,k:[46,14],o:12,j:["技工"]},interrobang:{a:"ExclamationQuestionMark",b:"2049-FE0F",c:"2049",d:!0,e:!0,f:!0,h:!0,j:["感叹号问号","什么","标点","惊喜","wat","punctuation","surprise"],k:[52,11],o:2},seat:{a:"Seat",b:"1F4BA",d:!0,e:!0,f:!0,h:!0,j:["座位","坐","飞机","运输","总线","飞行","飞","sit","airplane","transport","bus","flight","fly"],k:[26,16],o:2},dollar:{a:"BanknotewithDollarSign",b:"1F4B5",d:!0,e:!0,f:!0,h:!0,j:["美元纸币","钱","销售","法案","货币","money","sales","bill","currency"],k:[26,11],o:2},two_hearts:{a:"TwoHearts",b:"1F495",d:!0,e:!0,f:!0,h:!0,j:["两颗心","爱","喜欢","感情","情人","心","love","like","affection","valentines","heart"],k:[25,31],o:2},it:{a:"ItalyFlag",b:"1F1EE-1F1F9",d:!0,e:!0,f:!0,h:!0,j:["意大利国旗","意大利","旗","国家","国家","旗帜","italy","flag","nation","country","banner"],k:[2,32],n:["flag-it"],o:2},shamrock:{a:"Shamrock",b:"2618-FE0F",c:"2618",d:!0,e:!0,f:!0,h:!0,j:["酢浆草","蔬菜","植物","自然界","爱尔兰语","三叶草","vegetable","plant","nature","irish","clover"],k:[53,1],o:2},four_leaf_clover:{a:"FourLeafClover",b:"1F340",d:!0,e:!0,f:!0,h:!0,j:["四叶草","蔬菜","植物","自然界","幸运","爱尔兰语","vegetable","plant","nature","lucky","irish"],k:[6,24],o:2},euro:{a:"BanknotewithEuroSign",b:"1F4B6",d:!0,e:!0,f:!0,h:!0,j:["欧元纸币","钱","销售","美元","货币","money","sales","dollar","currency"],k:[26,12],o:2},question:{a:"BlackQuestionMarkOrnament",b:"2753",d:!0,e:!0,f:!0,h:!0,j:["问号","怀疑","困惑","doubt","confused"],k:[55,23],o:2},helicopter:{a:"Helicopter",b:"1F681",d:!0,e:!0,f:!0,h:!0,j:["直升机","运输","车辆","飞","transportation","vehicle","fly"],k:[34,0],o:2},heart_decoration:{a:"HeartDecoration",b:"1F49F",d:!0,e:!0,f:!0,h:!0,j:["心脏装饰","紫色方块","爱","喜欢","purple-square","love","like"],k:[25,41],o:2},"flag-je":{a:"JerseyFlag",b:"1F1EF-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[2,33],o:2,j:["泽西岛旗"]},"male-mechanic":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F527",non_qualified:null,image:"1f468-1f3fb-200d-1f527.png",sheet_x:15,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F527",non_qualified:null,image:"1f468-1f3fc-200d-1f527.png",sheet_x:15,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F527",non_qualified:null,image:"1f468-1f3fd-200d-1f527.png",sheet_x:15,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F527",non_qualified:null,image:"1f468-1f3fe-200d-1f527.png",sheet_x:15,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F527",non_qualified:null,image:"1f468-1f3ff-200d-1f527.png",sheet_x:15,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleMechanic",b:"1F468-200D-1F527",d:!0,e:!0,f:!0,h:!0,k:[15,50],o:4,j:["男技工"]},suspension_railway:{a:"SuspensionRailway",b:"1F69F",d:!0,e:!0,f:!0,h:!0,j:["悬挂铁路","车辆","运输","vehicle","transportation"],k:[34,30],o:2},heavy_heart_exclamation_mark_ornament:{a:"HeavyHeartExclamationMarkOrnament",b:"2763-FE0F",c:"2763",d:!0,e:!0,f:!0,h:!0,k:[55,27],o:2,j:["心脏感叹号"]},"female-mechanic":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F527",non_qualified:null,image:"1f469-1f3fb-200d-1f527.png",sheet_x:18,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F527",non_qualified:null,image:"1f469-1f3fc-200d-1f527.png",sheet_x:18,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F527",non_qualified:null,image:"1f469-1f3fd-200d-1f527.png",sheet_x:18,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F527",non_qualified:null,image:"1f469-1f3fe-200d-1f527.png",sheet_x:18,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F527",non_qualified:null,image:"1f469-1f3ff-200d-1f527.png",sheet_x:18,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleMechanic",b:"1F469-200D-1F527",d:!0,e:!0,f:!0,h:!0,k:[18,35],o:4,j:["女技工"]},"flag-jm":{a:"JamaicaFlag",b:"1F1EF-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,34],o:2,j:["牙买加国旗"]},grey_question:{a:"WhiteQuestionMarkOrnament",b:"2754",d:!0,e:!0,f:!0,h:!0,j:["白色问号","怀疑","灰色","哼","困惑","doubts","gray","huh","confused"],k:[55,24],o:2},maple_leaf:{a:"MapleLeaf",b:"1F341",d:!0,e:!0,f:!0,h:!0,j:["枫叶","自然界","植物","蔬菜","喜欢","秋天","nature","plant","vegetable","ca","fall"],k:[6,25],o:2},pound:{a:"BanknotewithPoundSign",b:"1F4B7",d:!0,e:!0,f:!0,h:!0,j:["英镑纸币","英国的","英镑","钱","销售","条例 草案","英国","英国","货币","british","sterling","money","sales","bills","uk","england","currency"],k:[26,13],o:2},money_with_wings:{a:"MoneywithWings",b:"1F4B8",d:!0,e:!0,f:!0,h:!0,j:["带翅膀的钱","美元","条例 草案","付款","销售","dollar","bills","payment","sale"],k:[26,14],o:2},"flag-jo":{a:"JordanFlag",b:"1F1EF-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[2,35],o:2,j:["约旦国旗"]},fallen_leaf:{a:"FallenLeaf",b:"1F342",d:!0,e:!0,f:!0,h:!0,j:["落叶","自然界","植物","蔬菜","叶","nature","plant","vegetable","leaves"],k:[6,26],o:2},factory_worker:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3fb-200d-1f3ed.png",sheet_x:45,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3fc-200d-1f3ed.png",sheet_x:45,sheet_y:55,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3fd-200d-1f3ed.png",sheet_x:45,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3fe-200d-1f3ed.png",sheet_x:46,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F3ED",non_qualified:null,image:"1f9d1-1f3ff-200d-1f3ed.png",sheet_x:46,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"FactoryWorker",b:"1F9D1-200D-1F3ED",d:!0,e:!1,f:!1,h:!1,k:[45,53],o:12,j:["工人"]},broken_heart:{a:"BrokenHeart",b:"1F494",d:!0,e:!0,f:!0,h:!0,j:["破碎的心脏","伤心","不好意思","破","心","心碎","sad","sorry","break","heart","heartbreak"],k:[25,30],l:["</3"],m:"</3",o:2},grey_exclamation:{a:"WhiteExclamationMarkOrnament",b:"2755",d:!0,e:!0,f:!0,h:!0,j:["白色的感叹号","惊喜","标点","灰色","哇","警告","surprise","punctuation","gray","wow","warning"],k:[55,25],o:2},mountain_cableway:{a:"MountainCableway",b:"1F6A0",d:!0,e:!0,f:!0,h:!0,j:["山缆车","运输","车辆","滑雪","transportation","vehicle","ski"],k:[34,31],o:2},exclamation:{a:"HeavyExclamationMarkSymbol",b:"2757",d:!0,e:!0,f:!0,h:!0,j:["感叹号","heavy_exclamation_mark","危险","惊喜","标点","哇","警告","heavy_exclamation_mark","danger","surprise","punctuation","wow","warning"],k:[55,26],n:["heavy_exclamation_mark"],o:2},leaves:{a:"LeafFlutteringinWind",b:"1F343",d:!0,e:!0,f:!0,h:!0,j:["叶子落下","自然界","植物","树","蔬菜","草","草坪","春天","nature","plant","tree","vegetable","grass","lawn","spring"],k:[6,27],o:2},heart:{a:"HeavyBlackHeart",b:"2764-FE0F",c:"2764",d:!0,e:!0,f:!0,h:!0,j:["红心","爱","喜欢","情人","love","like","valentines"],k:[55,28],l:["<3"],m:"<3",o:2},jp:{a:"JapanFlag",b:"1F1EF-1F1F5",d:!0,e:!0,f:!0,h:!0,j:["日本国旗","日语","国家","旗","国家","旗帜","japanese","nation","flag","country","banner"],k:[2,36],n:["flag-jp"],o:2},"male-factory-worker":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F3ED",non_qualified:null,image:"1f468-1f3fb-200d-1f3ed.png",sheet_x:15,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F3ED",non_qualified:null,image:"1f468-1f3fc-200d-1f3ed.png",sheet_x:15,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F3ED",non_qualified:null,image:"1f468-1f3fd-200d-1f3ed.png",sheet_x:15,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F3ED",non_qualified:null,image:"1f468-1f3fe-200d-1f3ed.png",sheet_x:15,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F3ED",non_qualified:null,image:"1f468-1f3ff-200d-1f3ed.png",sheet_x:15,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleFactoryWorker",b:"1F468-200D-1F3ED",d:!0,e:!0,f:!0,h:!0,k:[15,17],o:4,j:["男工厂工人"]},credit_card:{a:"CreditCard",b:"1F4B3",d:!0,e:!0,f:!0,h:!0,j:["信用卡","钱","销售","美元","法案","付款","购物","money","sales","dollar","bill","payment","shopping"],k:[26,9],o:2},aerial_tramway:{a:"AerialTramway",b:"1F6A1",d:!0,e:!0,f:!0,h:!0,j:["空中缆车","运输","车辆","滑雪","transportation","vehicle","ski"],k:[34,32],o:2},"female-factory-worker":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F3ED",non_qualified:null,image:"1f469-1f3fb-200d-1f3ed.png",sheet_x:18,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F3ED",non_qualified:null,image:"1f469-1f3fc-200d-1f3ed.png",sheet_x:18,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F3ED",non_qualified:null,image:"1f469-1f3fd-200d-1f3ed.png",sheet_x:18,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F3ED",non_qualified:null,image:"1f469-1f3fe-200d-1f3ed.png",sheet_x:18,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F3ED",non_qualified:null,image:"1f469-1f3ff-200d-1f3ed.png",sheet_x:18,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleFactoryWorker",b:"1F469-200D-1F3ED",d:!0,e:!0,f:!0,h:!0,k:[18,7],o:4,j:["女工厂工人"]},receipt:{a:"Receipt",b:"1F9FE",d:!0,e:!0,f:!0,h:!0,k:[51,49],o:11,j:["收据"]},wavy_dash:{a:"WavyDash",b:"3030-FE0F",c:"3030",d:!0,e:!0,f:!0,h:!0,j:["波浪符号","画","线","胡子","胡子","波浪线","乱 涂","draw","line","moustache","mustache","squiggle","scribble"],k:[55,44],o:2},"flag-ke":{a:"KenyaFlag",b:"1F1F0-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[2,37],o:2,j:["肯尼亚国旗"]},satellite:{a:"Satellite",b:"1F6F0-FE0F",c:"1F6F0",d:!0,e:!0,f:!0,h:!0,j:["卫星","通信","前途","收音机","空间","communication","future","radio","space"],k:[36,51],o:2},orange_heart:{a:"OrangeHeart",b:"1F9E1",d:!0,e:!0,f:!0,h:!0,k:[51,20],o:5,j:["橙色心脏"]},yellow_heart:{a:"YellowHeart",b:"1F49B",d:!0,e:!0,f:!0,h:!0,j:["黄心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,37],m:"<3",o:2},copyright:{a:"CopyrightSign",b:"00A9-FE0F",c:"00A9",d:!0,e:!0,f:!0,h:!1,j:["版权","断续器","许可证","圈","法律","法律","ip","license","circle","law","legal"],k:[0,12],o:2},rocket:{a:"Rocket",b:"1F680",d:!0,e:!0,f:!0,h:!0,j:["火箭","发射","船","员工模式","美国宇航局","外太空","outer_space","飞","launch","ship","staffmode","NASA","outerspace","outer_space","fly"],k:[33,56],o:2},chart:{a:"ChartwithUpwardsTrendandYenSign",b:"1F4B9",d:!0,e:!0,f:!0,h:!0,j:["人民币上涨","绿色方块","图","介绍","统计","green-square","graph","presentation","stats"],k:[26,15],o:2},"flag-kg":{a:"KyrgyzstanFlag",b:"1F1F0-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[2,38],o:2,j:["吉尔吉斯斯坦国旗"]},office_worker:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3fb-200d-1f4bc.png",sheet_x:46,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3fc-200d-1f4bc.png",sheet_x:46,sheet_y:10,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3fd-200d-1f4bc.png",sheet_x:46,sheet_y:11,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3fe-200d-1f4bc.png",sheet_x:46,sheet_y:12,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F4BC",non_qualified:null,image:"1f9d1-1f3ff-200d-1f4bc.png",sheet_x:46,sheet_y:13,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"OfficeWorker",b:"1F9D1-200D-1F4BC",d:!0,e:!1,f:!1,h:!1,k:[46,8],o:12,j:["白领"]},currency_exchange:{a:"CurrencyExchange",b:"1F4B1",d:!0,e:!0,f:!0,h:!0,j:["货币交换","钱","销售","美元","旅行","money","sales","dollar","travel"],k:[26,7],o:2},registered:{a:"RegisteredSign",b:"00AE-FE0F",c:"00AE",d:!0,e:!0,f:!0,h:!1,j:["注册商标","字母","圈","alphabet","circle"],k:[0,13],o:2},green_heart:{a:"GreenHeart",b:"1F49A",d:!0,e:!0,f:!0,h:!0,j:["绿色心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,36],m:"<3",o:2},flying_saucer:{a:"FlyingSaucer",b:"1F6F8",d:!0,e:!0,f:!0,h:!0,k:[37,0],o:5,j:["飞碟"]},"flag-kh":{a:"CambodiaFlag",b:"1F1F0-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[2,39],o:2,j:["柬埔寨国旗"]},"male-office-worker":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F4BC",non_qualified:null,image:"1f468-1f3fb-200d-1f4bc.png",sheet_x:15,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F4BC",non_qualified:null,image:"1f468-1f3fc-200d-1f4bc.png",sheet_x:15,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F4BC",non_qualified:null,image:"1f468-1f3fd-200d-1f4bc.png",sheet_x:15,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F4BC",non_qualified:null,image:"1f468-1f3fe-200d-1f4bc.png",sheet_x:15,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F4BC",non_qualified:null,image:"1f468-1f3ff-200d-1f4bc.png",sheet_x:15,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleOfficeWorker",b:"1F468-200D-1F4BC",d:!0,e:!0,f:!0,h:!0,k:[15,44],o:4,j:["男性上班族"]},tm:{a:"TradeMarkSign",b:"2122-FE0F",c:"2122",d:!0,e:!0,f:!0,h:!0,j:["商标","商标","品牌","法律","法律","trademark","brand","law","legal"],k:[52,12],o:2},bellhop_bell:{a:"BellhopBell",b:"1F6CE-FE0F",c:"1F6CE",d:!0,e:!0,f:!0,h:!0,j:["服务铃","服务","service"],k:[36,36],o:2},blue_heart:{a:"BlueHeart",b:"1F499",d:!0,e:!0,f:!0,h:!0,j:["蓝色心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,35],m:"<3",o:2},"flag-ki":{a:"KiribatiFlag",b:"1F1F0-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[2,40],o:2,j:["基里巴斯国旗"]},heavy_dollar_sign:{a:"HeavyDollarSign",b:"1F4B2",d:!0,e:!0,f:!0,h:!0,j:["美元符号","钱","销售","付款","货币","麚","money","sales","payment","currency","buck"],k:[26,8],o:2},"female-office-worker":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F4BC",non_qualified:null,image:"1f469-1f3fb-200d-1f4bc.png",sheet_x:18,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F4BC",non_qualified:null,image:"1f469-1f3fc-200d-1f4bc.png",sheet_x:18,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F4BC",non_qualified:null,image:"1f469-1f3fd-200d-1f4bc.png",sheet_x:18,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F4BC",non_qualified:null,image:"1f469-1f3fe-200d-1f4bc.png",sheet_x:18,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F4BC",non_qualified:null,image:"1f469-1f3ff-200d-1f4bc.png",sheet_x:18,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleOfficeWorker",b:"1F469-200D-1F4BC",d:!0,e:!0,f:!0,h:!0,k:[18,29],o:4,j:["女性上班族"]},purple_heart:{a:"PurpleHeart",b:"1F49C",d:!0,e:!0,f:!0,h:!0,j:["紫色的心脏","爱","喜欢","感情","情人","love","like","affection","valentines"],k:[25,38],m:"<3",o:2},scientist:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F52C",non_qualified:null,image:"1f9d1-1f3fb-200d-1f52c.png",sheet_x:46,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F52C",non_qualified:null,image:"1f9d1-1f3fc-200d-1f52c.png",sheet_x:46,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F52C",non_qualified:null,image:"1f9d1-1f3fd-200d-1f52c.png",sheet_x:46,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F52C",non_qualified:null,image:"1f9d1-1f3fe-200d-1f52c.png",sheet_x:46,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F52C",non_qualified:null,image:"1f9d1-1f3ff-200d-1f52c.png",sheet_x:46,sheet_y:25,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Scientist",b:"1F9D1-200D-1F52C",d:!0,e:!1,f:!1,h:!1,k:[46,20],o:12,j:["科学家"]},luggage:{a:"Luggage",b:"1F9F3",d:!0,e:!0,f:!0,h:!0,k:[51,38],o:11,j:["行李"]},hash:{a:"HashKey",b:"0023-FE0F-20E3",c:"0023-20E3",d:!0,e:!0,f:!0,h:!1,j:["井字号按钮","象征","蓝色方块","唽","symbol","blue-square","twitter"],k:[0,0],o:0},"flag-km":{a:"ComorosFlag",b:"1F1F0-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[2,41],o:2,j:["科摩罗国旗"]},email:{a:"Envelope",b:"2709-FE0F",c:"2709",d:!0,e:!0,f:!0,h:!0,j:["信封","信","邮政","收件箱","通信","letter","postal","inbox","communication"],k:[54,42],n:["envelope"],o:2},"e-mail":{a:"E-MailSymbol",b:"1F4E7",d:!0,e:!0,f:!0,h:!0,j:["电子邮件","通信","收件箱","communication","inbox"],k:[27,4],o:2},keycap_star:{a:"KeycapStar",b:"002A-FE0F-20E3",c:"002A-20E3",d:!0,e:!0,f:!0,h:!1,k:[0,1],o:0,j:["米字号按钮"]},"flag-kn":{a:"St.Kitts&NevisFlag",b:"1F1F0-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[2,42],o:2,j:["圣基茨和尼维斯国旗"]},hourglass:{a:"Hourglass",b:"231B",d:!0,e:!0,f:!0,h:!0,j:["完成的沙漏","时间","时钟","老派","限制","考试","测验","测试","time","clock","oldschool","limit","exam","quiz","test"],k:[52,23],o:2},brown_heart:{a:"BrownHeart",b:"1F90E",d:!0,e:!0,f:!0,h:!0,k:[37,16],o:12,j:["棕色心脏"]},"male-scientist":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F52C",non_qualified:null,image:"1f468-1f3fb-200d-1f52c.png",sheet_x:16,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F52C",non_qualified:null,image:"1f468-1f3fc-200d-1f52c.png",sheet_x:16,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F52C",non_qualified:null,image:"1f468-1f3fd-200d-1f52c.png",sheet_x:16,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F52C",non_qualified:null,image:"1f468-1f3fe-200d-1f52c.png",sheet_x:16,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F52C",non_qualified:null,image:"1f468-1f3ff-200d-1f52c.png",sheet_x:16,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleScientist",b:"1F468-200D-1F52C",d:!0,e:!0,f:!0,h:!0,k:[15,56],o:4,j:["男科学家"]},hourglass_flowing_sand:{a:"HourglasswithFlowingSand",b:"23F3",d:!0,e:!0,f:!0,h:!0,j:["未完成的沙漏","老派","时间","倒计时","oldschool","time","countdown"],k:[52,36],o:2},black_heart:{a:"BlackHeart",b:"1F5A4",d:!0,e:!0,f:!0,h:!0,j:["黑色心脏","邪","evil"],k:[30,9],o:4},zero:{a:"Keycap0",b:"0030-FE0F-20E3",c:"0030-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮0","0","数字","蓝色方块","零","0","numbers","blue-square","null"],k:[0,2],o:0},incoming_envelope:{a:"IncomingEnvelope",b:"1F4E8",d:!0,e:!0,f:!0,h:!0,j:["来信","电子邮件","收件箱","email","inbox"],k:[27,5],o:2},"flag-kp":{a:"NorthKoreaFlag",b:"1F1F0-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[2,43],o:2,j:["朝鲜国旗"]},"female-scientist":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F52C",non_qualified:null,image:"1f469-1f3fb-200d-1f52c.png",sheet_x:18,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F52C",non_qualified:null,image:"1f469-1f3fc-200d-1f52c.png",sheet_x:18,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F52C",non_qualified:null,image:"1f469-1f3fd-200d-1f52c.png",sheet_x:18,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F52C",non_qualified:null,image:"1f469-1f3fe-200d-1f52c.png",sheet_x:18,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F52C",non_qualified:null,image:"1f469-1f3ff-200d-1f52c.png",sheet_x:18,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleScientist",b:"1F469-200D-1F52C",d:!0,e:!0,f:!0,h:!0,k:[18,41],o:4,j:["女科学家"]},watch:{a:"Watch",b:"231A",d:!0,e:!0,f:!0,h:!0,j:["表","时间","辅料","time","accessories"],k:[52,22],o:2},white_heart:{a:"WhiteHeart",b:"1F90D",d:!0,e:!0,f:!0,h:!0,k:[37,15],o:12,j:["白心脏"]},one:{a:"Keycap1",b:"0031-FE0F-20E3",c:"0031-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮1","蓝色方块","数字","1","blue-square","numbers","1"],k:[0,3],o:0},kr:{a:"SouthKoreaFlag",b:"1F1F0-1F1F7",d:!0,e:!0,f:!0,h:!0,j:["韩国国旗","南","韩国","国家","旗","国家","旗帜","south","korea","nation","flag","country","banner"],k:[2,44],n:["flag-kr"],o:2},envelope_with_arrow:{a:"EnvelopewithDownwardsArrowAbove",b:"1F4E9",d:!0,e:!0,f:!0,h:!0,j:["信封与箭头","电子邮件","通信","email","communication"],k:[27,6],o:2},technologist:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3fb-200d-1f4bb.png",sheet_x:46,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3fc-200d-1f4bb.png",sheet_x:46,sheet_y:4,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3fd-200d-1f4bb.png",sheet_x:46,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3fe-200d-1f4bb.png",sheet_x:46,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F4BB",non_qualified:null,image:"1f9d1-1f3ff-200d-1f4bb.png",sheet_x:46,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Technologist",b:"1F9D1-200D-1F4BB",d:!0,e:!1,f:!1,h:!1,k:[46,2],o:12,j:["程序员"]},outbox_tray:{a:"OutboxTray",b:"1F4E4",d:!0,e:!0,f:!0,h:!0,j:["发件箱托盘","收件箱","电子邮件","inbox","email"],k:[27,1],o:2},"male-technologist":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F4BB",non_qualified:null,image:"1f468-1f3fb-200d-1f4bb.png",sheet_x:15,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F4BB",non_qualified:null,image:"1f468-1f3fc-200d-1f4bb.png",sheet_x:15,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F4BB",non_qualified:null,image:"1f468-1f3fd-200d-1f4bb.png",sheet_x:15,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F4BB",non_qualified:null,image:"1f468-1f3fe-200d-1f4bb.png",sheet_x:15,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F4BB",non_qualified:null,image:"1f468-1f3ff-200d-1f4bb.png",sheet_x:15,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleTechnologist",b:"1F468-200D-1F4BB",d:!0,e:!0,f:!0,h:!0,k:[15,38],o:4,j:["男工程师"]},alarm_clock:{a:"AlarmClock",b:"23F0",d:!0,e:!0,f:!0,h:!0,j:["闹钟","时间","唤醒","time","wake"],k:[52,33],o:2},"flag-kw":{a:"KuwaitFlag",b:"1F1F0-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[2,45],o:2,j:["科威特国旗"]},two:{a:"Keycap2",b:"0032-FE0F-20E3",c:"0032-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮2","数字","2","主要","蓝色方块","numbers","2","prime","blue-square"],k:[0,4],o:0},anger:{a:"AngerSymbol",b:"1F4A2",d:!0,e:!0,f:!0,h:!0,j:["愤怒符号","生气","狂","angry","mad"],k:[25,44],o:2},inbox_tray:{a:"InboxTray",b:"1F4E5",d:!0,e:!0,f:!0,h:!0,j:["收件箱托盘","电子邮件","文件","email","documents"],k:[27,2],o:2},three:{a:"Keycap3",b:"0033-FE0F-20E3",c:"0033-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮3","3","数字","主要","蓝色方块","3","numbers","prime","blue-square"],k:[0,5],o:0},"flag-ky":{a:"CaymanIslandsFlag",b:"1F1F0-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[2,46],o:2,j:["开曼群岛旗"]},stopwatch:{a:"Stopwatch",b:"23F1-FE0F",c:"23F1",d:!0,e:!0,f:!0,h:!0,j:["码表","时间","限期","time","deadline"],k:[52,34],o:2},"female-technologist":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F4BB",non_qualified:null,image:"1f469-1f3fb-200d-1f4bb.png",sheet_x:18,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F4BB",non_qualified:null,image:"1f469-1f3fc-200d-1f4bb.png",sheet_x:18,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F4BB",non_qualified:null,image:"1f469-1f3fd-200d-1f4bb.png",sheet_x:18,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F4BB",non_qualified:null,image:"1f469-1f3fe-200d-1f4bb.png",sheet_x:18,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F4BB",non_qualified:null,image:"1f469-1f3ff-200d-1f4bb.png",sheet_x:18,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleTechnologist",b:"1F469-200D-1F4BB",d:!0,e:!0,f:!0,h:!0,k:[18,23],o:4,j:["女工程师"]},boom:{a:"CollisionSymbol",b:"1F4A5",d:!0,e:!0,f:!0,h:!0,j:["碰撞","炸弹","爆炸","爆炸","碰撞","吹","bomb","explode","explosion","collision","blown"],k:[25,47],n:["collision"],o:2},"flag-kz":{a:"KazakhstanFlag",b:"1F1F0-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[2,47],o:2,j:["哈萨克斯坦国旗"]},four:{a:"Keycap4",b:"0034-FE0F-20E3",c:"0034-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮4","4","数字","蓝色方块","4","numbers","blue-square"],k:[0,6],o:0},timer_clock:{a:"TimerClock",b:"23F2-FE0F",c:"23F2",d:!0,e:!0,f:!0,h:!0,j:["定时器","报警","alarm"],k:[52,35],o:2},singer:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3fb-200d-1f3a4.png",sheet_x:45,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3fc-200d-1f3a4.png",sheet_x:45,sheet_y:37,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3fd-200d-1f3a4.png",sheet_x:45,sheet_y:38,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3fe-200d-1f3a4.png",sheet_x:45,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F3A4",non_qualified:null,image:"1f9d1-1f3ff-200d-1f3a4.png",sheet_x:45,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Singer",b:"1F9D1-200D-1F3A4",d:!0,e:!1,f:!1,h:!1,k:[45,35],o:12,j:["歌手"]},package:{a:"Package",b:"1F4E6",d:!0,e:!0,f:!0,h:!0,j:["包裹","邮件","礼物","纸板","箱","移动","mail","gift","cardboard","box","moving"],k:[27,3],o:2},mailbox:{a:"ClosedMailboxwithRaisedFlag",b:"1F4EB",d:!0,e:!0,f:!0,h:!0,j:["邮箱关闭（具有向上的标志）","电子邮件","收件箱","通信","email","inbox","communication"],k:[27,8],o:2},"flag-la":{a:"LaosFlag",b:"1F1F1-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[2,48],o:2,j:["老挝国旗"]},dizzy:{a:"DizzySymbol",b:"1F4AB",d:!0,e:!0,f:!0,h:!0,j:["晕眩","星","火花","射","魔法","star","sparkle","shoot","magic"],k:[26,1],o:2},five:{a:"Keycap5",b:"0035-FE0F-20E3",c:"0035-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮5","5","数字","蓝色方块","主要","5","numbers","blue-square","prime"],k:[0,7],o:0},"male-singer":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F3A4",non_qualified:null,image:"1f468-1f3fb-200d-1f3a4.png",sheet_x:15,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F3A4",non_qualified:null,image:"1f468-1f3fc-200d-1f3a4.png",sheet_x:15,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F3A4",non_qualified:null,image:"1f468-1f3fd-200d-1f3a4.png",sheet_x:15,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F3A4",non_qualified:null,image:"1f468-1f3fe-200d-1f3a4.png",sheet_x:15,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F3A4",non_qualified:null,image:"1f468-1f3ff-200d-1f3a4.png",sheet_x:15,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleSinger",b:"1F468-200D-1F3A4",d:!0,e:!0,f:!0,h:!0,k:[14,56],o:4,j:["男歌手"]},mantelpiece_clock:{a:"MantelpieceClock",b:"1F570-FE0F",c:"1F570",d:!0,e:!0,f:!0,h:!0,j:["壁炉钟","时间","time"],k:[29,7],o:2},"female-singer":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F3A4",non_qualified:null,image:"1f469-1f3fb-200d-1f3a4.png",sheet_x:17,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F3A4",non_qualified:null,image:"1f469-1f3fc-200d-1f3a4.png",sheet_x:17,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F3A4",non_qualified:null,image:"1f469-1f3fd-200d-1f3a4.png",sheet_x:17,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F3A4",non_qualified:null,image:"1f469-1f3fe-200d-1f3a4.png",sheet_x:17,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F3A4",non_qualified:null,image:"1f469-1f3ff-200d-1f3a4.png",sheet_x:17,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleSinger",b:"1F469-200D-1F3A4",d:!0,e:!0,f:!0,h:!0,k:[17,46],o:4,j:["女歌手"]},"flag-lb":{a:"LebanonFlag",b:"1F1F1-1F1E7",d:!0,e:!0,f:!0,h:!0,k:[2,49],o:2,j:["黎巴嫩国旗"]},six:{a:"Keycap6",b:"0036-FE0F-20E3",c:"0036-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮6","6","数字","蓝色方块","6","numbers","blue-square"],k:[0,8],o:0},mailbox_closed:{a:"ClosedMailboxwithLoweredFlag",b:"1F4EA",d:!0,e:!0,f:!0,h:!0,j:["邮箱关闭（具有向下的标志）","电子邮件","通信","收件箱","email","communication","inbox"],k:[27,7],o:2},sweat_drops:{a:"SplashingSweatSymbol",b:"1F4A6",d:!0,e:!0,f:!0,h:!0,j:["汗水滴","水","滴","哎呀","water","drip","oops"],k:[25,48],o:2},clock12:{a:"ClockFaceTwelveOclock",b:"1F55B",d:!0,e:!0,f:!0,h:!0,j:["十二点钟","时间","中午","午夜","中午","晚","早","附表","time","noon","midnight","midday","late","early","schedule"],k:[28,50],o:2},seven:{a:"Keycap7",b:"0037-FE0F-20E3",c:"0037-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮7","7","数字","蓝色方块","主要","7","numbers","blue-square","prime"],k:[0,9],o:0},mailbox_with_mail:{a:"OpenMailboxwithRaisedFlag",b:"1F4EC",d:!0,e:!0,f:!0,h:!0,j:["邮箱开启（具有向上的标志）","电子邮件","收件箱","通信","email","inbox","communication"],k:[27,9],o:2},clock1230:{a:"ClockFaceTwelve-Thirty",b:"1F567",d:!0,e:!0,f:!0,h:!0,j:["十二点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,5],o:2},dash:{a:"DashSymbol",b:"1F4A8",d:!0,e:!0,f:!0,h:!0,j:["冲刺","风","空气","几乎","嘘","速度","烟","吹","wind","air","fast","shoo","fart","smoke","puff"],k:[25,50],o:2},artist:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3fb-200d-1f3a8.png",sheet_x:45,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3fc-200d-1f3a8.png",sheet_x:45,sheet_y:43,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3fd-200d-1f3a8.png",sheet_x:45,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3fe-200d-1f3a8.png",sheet_x:45,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F3A8",non_qualified:null,image:"1f9d1-1f3ff-200d-1f3a8.png",sheet_x:45,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Artist",b:"1F9D1-200D-1F3A8",d:!0,e:!1,f:!1,h:!1,k:[45,41],o:12,j:["艺术家"]},"flag-lc":{a:"St.LuciaFlag",b:"1F1F1-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[2,50],o:2,j:["圣卢西亚国旗"]},hole:{a:"Hole",b:"1F573-FE0F",c:"1F573",d:!0,e:!0,f:!0,h:!0,j:["洞","糗","embarrassing"],k:[29,8],o:2},"male-artist":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F3A8",non_qualified:null,image:"1f468-1f3fb-200d-1f3a8.png",sheet_x:15,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F3A8",non_qualified:null,image:"1f468-1f3fc-200d-1f3a8.png",sheet_x:15,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F3A8",non_qualified:null,image:"1f468-1f3fd-200d-1f3a8.png",sheet_x:15,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F3A8",non_qualified:null,image:"1f468-1f3fe-200d-1f3a8.png",sheet_x:15,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F3A8",non_qualified:null,image:"1f468-1f3ff-200d-1f3a8.png",sheet_x:15,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleArtist",b:"1F468-200D-1F3A8",d:!0,e:!0,f:!0,h:!0,k:[15,5],o:4,j:["男艺术家"]},clock1:{a:"ClockFaceOneOclock",b:"1F550",d:!0,e:!0,f:!0,h:!0,j:["一点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,39],o:2},eight:{a:"Keycap8",b:"0038-FE0F-20E3",c:"0038-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮8","8","蓝色方块","数字","8","blue-square","numbers"],k:[0,10],o:0},mailbox_with_no_mail:{a:"OpenMailboxwithLoweredFlag",b:"1F4ED",d:!0,e:!0,f:!0,h:!0,j:["邮箱开启（具有向下的标志）","电子邮件","收件箱","email","inbox"],k:[27,10],o:2},"flag-li":{a:"LiechtensteinFlag",b:"1F1F1-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[2,51],o:2,j:["列支敦士登国旗"]},bomb:{a:"Bomb",b:"1F4A3",d:!0,e:!0,f:!0,h:!0,j:["炸弹","繁荣","爆炸","爆炸","恐怖主义","boom","explode","explosion","terrorism"],k:[25,45],o:2},nine:{a:"Keycap9",b:"0039-FE0F-20E3",c:"0039-20E3",d:!0,e:!0,f:!0,h:!1,j:["按钮9","蓝色方块","数字","9","blue-square","numbers","9"],k:[0,11],o:0},postbox:{a:"Postbox",b:"1F4EE",d:!0,e:!0,f:!0,h:!0,j:["邮箱","电子邮件","信","信封","email","letter","envelope"],k:[27,11],o:2},"female-artist":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F3A8",non_qualified:null,image:"1f469-1f3fb-200d-1f3a8.png",sheet_x:17,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F3A8",non_qualified:null,image:"1f469-1f3fc-200d-1f3a8.png",sheet_x:17,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F3A8",non_qualified:null,image:"1f469-1f3fd-200d-1f3a8.png",sheet_x:17,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F3A8",non_qualified:null,image:"1f469-1f3fe-200d-1f3a8.png",sheet_x:17,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F3A8",non_qualified:null,image:"1f469-1f3ff-200d-1f3a8.png",sheet_x:18,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleArtist",b:"1F469-200D-1F3A8",d:!0,e:!0,f:!0,h:!0,k:[17,52],o:4,j:["女艺术家"]},clock130:{a:"ClockFaceOne-Thirty",b:"1F55C",d:!0,e:!0,f:!0,h:!0,j:["一点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,51],o:2},"flag-lk":{a:"SriLankaFlag",b:"1F1F1-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[2,52],o:2,j:["斯里兰卡国旗"]},ballot_box_with_ballot:{a:"BallotBoxwithBallot",b:"1F5F3-FE0F",c:"1F5F3",d:!0,e:!0,f:!0,h:!0,k:[30,28],o:2,j:["投票箱与选票"]},pilot:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-2708-FE0F",non_qualified:"1F9D1-1F3FB-200D-2708",image:"1f9d1-1f3fb-200d-2708-fe0f.png",sheet_x:48,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-2708-FE0F",non_qualified:"1F9D1-1F3FC-200D-2708",image:"1f9d1-1f3fc-200d-2708-fe0f.png",sheet_x:48,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-2708-FE0F",non_qualified:"1F9D1-1F3FD-200D-2708",image:"1f9d1-1f3fd-200d-2708-fe0f.png",sheet_x:48,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-2708-FE0F",non_qualified:"1F9D1-1F3FE-200D-2708",image:"1f9d1-1f3fe-200d-2708-fe0f.png",sheet_x:48,sheet_y:8,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-2708-FE0F",non_qualified:"1F9D1-1F3FF-200D-2708",image:"1f9d1-1f3ff-200d-2708-fe0f.png",sheet_x:48,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Pilot",b:"1F9D1-200D-2708-FE0F",c:"1F9D1-200D-2708",d:!0,e:!1,f:!1,h:!1,k:[48,4],o:12,j:["飞行员"]},keycap_ten:{a:"KeycapTen",b:"1F51F",d:!0,e:!0,f:!0,h:!0,j:["按钮10","数字","10","蓝色方块","numbers","10","blue-square"],k:[28,2],o:2},clock2:{a:"ClockFaceTwoOclock",b:"1F551",d:!0,e:!0,f:!0,h:!0,j:["两点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,40],o:2},"flag-lr":{a:"LiberiaFlag",b:"1F1F1-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[2,53],o:2,j:["利比里亚国旗"]},speech_balloon:{a:"SpeechBalloon",b:"1F4AC",d:!0,e:!0,f:!0,h:!0,j:["谈话气球","泡沫","的话","消息","说话","聊天","bubble","words","message","talk","chatting"],k:[26,2],o:2},"eye-in-speech-bubble":{a:"EyeinSpeechBubble",b:"1F441-FE0F-200D-1F5E8-FE0F",d:!0,e:!0,f:!1,h:!1,k:[12,37],o:2,j:["带有眼睛的气泡框"]},"flag-ls":{a:"LesothoFlag",b:"1F1F1-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[2,54],o:2,j:["莱索托国旗"]},clock230:{a:"ClockFaceTwo-Thirty",b:"1F55D",d:!0,e:!0,f:!0,h:!0,j:["两点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,52],o:2},"male-pilot":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-2708-FE0F",non_qualified:"1F468-1F3FB-200D-2708",image:"1f468-1f3fb-200d-2708-fe0f.png",sheet_x:17,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-2708-FE0F",non_qualified:"1F468-1F3FC-200D-2708",image:"1f468-1f3fc-200d-2708-fe0f.png",sheet_x:17,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-2708-FE0F",non_qualified:"1F468-1F3FD-200D-2708",image:"1f468-1f3fd-200d-2708-fe0f.png",sheet_x:17,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-2708-FE0F",non_qualified:"1F468-1F3FE-200D-2708",image:"1f468-1f3fe-200d-2708-fe0f.png",sheet_x:17,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-2708-FE0F",non_qualified:"1F468-1F3FF-200D-2708",image:"1f468-1f3ff-200d-2708-fe0f.png",sheet_x:17,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MalePilot",b:"1F468-200D-2708-FE0F",c:"1F468-200D-2708",d:!0,e:!0,f:!0,h:!0,k:[17,14],o:4,j:["男飞行员"]},capital_abcd:{a:"InputSymbolforLatinCapitalLetters",b:"1F520",d:!0,e:!0,f:!0,h:!0,j:["输入大写拉丁字母","字母","的话","蓝色方块","alphabet","words","blue-square"],k:[28,3],o:2},pencil2:{a:"Pencil",b:"270F-FE0F",c:"270F",d:!0,e:!0,f:!0,h:!0,j:["铅笔","文具","写","纸","写作","学校","研究","stationery","write","paper","writing","school","study"],k:[55,10],o:2},"female-pilot":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-2708-FE0F",non_qualified:"1F469-1F3FB-200D-2708",image:"1f469-1f3fb-200d-2708-fe0f.png",sheet_x:20,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-2708-FE0F",non_qualified:"1F469-1F3FC-200D-2708",image:"1f469-1f3fc-200d-2708-fe0f.png",sheet_x:20,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-2708-FE0F",non_qualified:"1F469-1F3FD-200D-2708",image:"1f469-1f3fd-200d-2708-fe0f.png",sheet_x:20,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-2708-FE0F",non_qualified:"1F469-1F3FE-200D-2708",image:"1f469-1f3fe-200d-2708-fe0f.png",sheet_x:20,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-2708-FE0F",non_qualified:"1F469-1F3FF-200D-2708",image:"1f469-1f3ff-200d-2708-fe0f.png",sheet_x:20,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemalePilot",b:"1F469-200D-2708-FE0F",c:"1F469-200D-2708",d:!0,e:!0,f:!0,h:!0,k:[19,56],o:4,j:["女飞行员"]},black_nib:{a:"BlackNib",b:"2712-FE0F",c:"2712",d:!0,e:!0,f:!0,h:!0,j:["黑色的笔尖","笔","文具","写作","写","pen","stationery","writing","write"],k:[55,11],o:2},left_speech_bubble:{a:"LeftSpeechBubble",b:"1F5E8-FE0F",c:"1F5E8",d:!0,e:!0,f:!0,h:!0,j:["左讲话气泡","的话","消息","说话","聊天","words","message","talk","chatting"],k:[30,26],o:2},clock3:{a:"ClockFaceThreeOclock",b:"1F552",d:!0,e:!0,f:!0,h:!0,j:["三点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,41],o:2},abcd:{a:"InputSymbolforLatinSmallLetters",b:"1F521",d:!0,e:!0,f:!0,h:!0,j:["输入小写拉丁字母","蓝色方块","字母","blue-square","alphabet"],k:[28,4],o:2},"flag-lt":{a:"LithuaniaFlag",b:"1F1F1-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[2,55],o:2,j:["立陶宛国旗"]},clock330:{a:"ClockFaceThree-Thirty",b:"1F55E",d:!0,e:!0,f:!0,h:!0,j:["三点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,53],o:2},astronaut:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F680",non_qualified:null,image:"1f9d1-1f3fb-200d-1f680.png",sheet_x:46,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F680",non_qualified:null,image:"1f9d1-1f3fc-200d-1f680.png",sheet_x:46,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F680",non_qualified:null,image:"1f9d1-1f3fd-200d-1f680.png",sheet_x:46,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F680",non_qualified:null,image:"1f9d1-1f3fe-200d-1f680.png",sheet_x:46,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F680",non_qualified:null,image:"1f9d1-1f3ff-200d-1f680.png",sheet_x:46,sheet_y:31,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Astronaut",b:"1F9D1-200D-1F680",d:!0,e:!1,f:!1,h:!1,k:[46,26],o:12,j:["宇航员"]},"flag-lu":{a:"LuxembourgFlag",b:"1F1F1-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[2,56],o:2,j:["卢森堡国旗"]},right_anger_bubble:{a:"RightAngerBubble",b:"1F5EF-FE0F",c:"1F5EF",d:!0,e:!0,f:!0,h:!0,j:["右愤怒气泡","标题","演讲","思维","狂","caption","speech","thinking","mad"],k:[30,27],o:2},lower_left_fountain_pen:{a:"LowerLeftFountainPen",b:"1F58B-FE0F",c:"1F58B",d:!0,e:!0,f:!0,h:!0,k:[29,45],o:2,j:["钢笔"]},"male-astronaut":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F680",non_qualified:null,image:"1f468-1f3fb-200d-1f680.png",sheet_x:16,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F680",non_qualified:null,image:"1f468-1f3fc-200d-1f680.png",sheet_x:16,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F680",non_qualified:null,image:"1f468-1f3fd-200d-1f680.png",sheet_x:16,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F680",non_qualified:null,image:"1f468-1f3fe-200d-1f680.png",sheet_x:16,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F680",non_qualified:null,image:"1f468-1f3ff-200d-1f680.png",sheet_x:16,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleAstronaut",b:"1F468-200D-1F680",d:!0,e:!0,f:!0,h:!0,k:[16,5],o:4,j:["男航天员"]},thought_balloon:{a:"ThoughtBalloon",b:"1F4AD",d:!0,e:!0,f:!0,h:!0,j:["思考气泡","泡沫","云","演讲","思维","梦","bubble","cloud","speech","thinking","dream"],k:[26,3],o:2},symbols:{a:"InputSymbolforSymbols",b:"1F523",d:!0,e:!0,f:!0,h:!0,j:["输入符号","蓝色方块","音乐","注意","符号","百分之","符号","字符","blue-square","music","note","ampersand","percent","glyphs","characters"],k:[28,6],o:2},clock4:{a:"ClockFaceFourOclock",b:"1F553",d:!0,e:!0,f:!0,h:!0,j:["四点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,42],o:2},"flag-lv":{a:"LatviaFlag",b:"1F1F1-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[3,0],o:2,j:["拉脱维亚国旗"]},lower_left_ballpoint_pen:{a:"LowerLeftBallpointPen",b:"1F58A-FE0F",c:"1F58A",d:!0,e:!0,f:!0,h:!0,k:[29,44],o:2,j:["笔"]},abc:{a:"InputSymbolforLatinLetters",b:"1F524",d:!0,e:!0,f:!0,h:!0,j:["输入拉丁字母","蓝色方块","字母","blue-square","alphabet"],k:[28,7],o:2},zzz:{a:"SleepingSymbol",b:"1F4A4",d:!0,e:!0,f:!0,h:!0,j:["ZZZ","困","累","梦","sleepy","tired","dream"],k:[25,46],o:2},lower_left_paintbrush:{a:"LowerLeftPaintbrush",b:"1F58C-FE0F",c:"1F58C",d:!0,e:!0,f:!0,h:!0,k:[29,46],o:2,j:["画笔"]},"female-astronaut":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F680",non_qualified:null,image:"1f469-1f3fb-200d-1f680.png",sheet_x:18,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F680",non_qualified:null,image:"1f469-1f3fc-200d-1f680.png",sheet_x:18,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F680",non_qualified:null,image:"1f469-1f3fd-200d-1f680.png",sheet_x:18,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F680",non_qualified:null,image:"1f469-1f3fe-200d-1f680.png",sheet_x:18,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F680",non_qualified:null,image:"1f469-1f3ff-200d-1f680.png",sheet_x:18,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleAstronaut",b:"1F469-200D-1F680",d:!0,e:!0,f:!0,h:!0,k:[18,47],o:4,j:["女航天员"]},"flag-ly":{a:"LibyaFlag",b:"1F1F1-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[3,1],o:2,j:["利比亚国旗"]},clock430:{a:"ClockFaceFour-Thirty",b:"1F55F",d:!0,e:!0,f:!0,h:!0,j:["四点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,54],o:2},"flag-ma":{a:"MoroccoFlag",b:"1F1F2-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[3,2],o:2,j:["摩洛哥国旗"]},a:{a:"NegativeSquaredLatinCapitalLettera",b:"1F170-FE0F",c:"1F170",d:!0,e:!0,f:!0,h:!0,j:["A符号符号","红方块","字母","信","red-square","alphabet","letter"],k:[0,16],o:2},clock5:{a:"ClockFaceFiveOclock",b:"1F554",d:!0,e:!0,f:!0,h:!0,j:["五点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,43],o:2},lower_left_crayon:{a:"LowerLeftCrayon",b:"1F58D-FE0F",c:"1F58D",d:!0,e:!0,f:!0,h:!0,k:[29,47],o:2,j:["蜡笔"]},firefighter:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F692",non_qualified:null,image:"1f9d1-1f3fb-200d-1f692.png",sheet_x:46,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F692",non_qualified:null,image:"1f9d1-1f3fc-200d-1f692.png",sheet_x:46,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F692",non_qualified:null,image:"1f9d1-1f3fd-200d-1f692.png",sheet_x:46,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F692",non_qualified:null,image:"1f9d1-1f3fe-200d-1f692.png",sheet_x:46,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F692",non_qualified:null,image:"1f9d1-1f3ff-200d-1f692.png",sheet_x:46,sheet_y:37,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"Firefighter",b:"1F9D1-200D-1F692",d:!0,e:!1,f:!1,h:!1,k:[46,32],o:12,j:["消防员"]},"male-firefighter":{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F692",non_qualified:null,image:"1f468-1f3fb-200d-1f692.png",sheet_x:16,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F692",non_qualified:null,image:"1f468-1f3fc-200d-1f692.png",sheet_x:16,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F692",non_qualified:null,image:"1f468-1f3fd-200d-1f692.png",sheet_x:16,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F692",non_qualified:null,image:"1f468-1f3fe-200d-1f692.png",sheet_x:16,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F692",non_qualified:null,image:"1f468-1f3ff-200d-1f692.png",sheet_x:16,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleFirefighter",b:"1F468-200D-1F692",d:!0,e:!0,f:!0,h:!0,k:[16,11],o:4,j:["男性消防员"]},memo:{a:"Memo",b:"1F4DD",d:!0,e:!0,f:!0,h:!0,j:["备忘录","写","文件","文具","铅笔","纸","写作","法律","考试","测验","测试","研究","组成","write","documents","stationery","pencil","paper","writing","legal","exam","quiz","test","study","compose"],k:[26,51],n:["pencil"],o:2},ab:{a:"NegativeSquaredAb",b:"1F18E",d:!0,e:!0,f:!0,h:!0,j:["AB符号符号","红方块","字母","red-square","alphabet"],k:[0,20],o:2},"flag-mc":{a:"MonacoFlag",b:"1F1F2-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[3,3],o:2,j:["摩纳哥国旗"]},clock530:{a:"ClockFaceFive-Thirty",b:"1F560",d:!0,e:!0,f:!0,h:!0,j:["五点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,55],o:2},briefcase:{a:"Briefcase",b:"1F4BC",d:!0,e:!0,f:!0,h:!0,j:["公文包","商","文件","工作","法律","法律","工作","生涯","business","documents","work","law","legal","job","career"],k:[26,18],o:2},"female-firefighter":{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F692",non_qualified:null,image:"1f469-1f3fb-200d-1f692.png",sheet_x:18,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F692",non_qualified:null,image:"1f469-1f3fc-200d-1f692.png",sheet_x:18,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F692",non_qualified:null,image:"1f469-1f3fd-200d-1f692.png",sheet_x:18,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F692",non_qualified:null,image:"1f469-1f3fe-200d-1f692.png",sheet_x:19,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F692",non_qualified:null,image:"1f469-1f3ff-200d-1f692.png",sheet_x:19,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleFirefighter",b:"1F469-200D-1F692",d:!0,e:!0,f:!0,h:!0,k:[18,53],o:4,j:["女消防员"]},clock6:{a:"ClockFaceSixOclock",b:"1F555",d:!0,e:!0,f:!0,h:!0,j:["六点钟","时间","晚","早","附表","黎明","黄昏","time","late","early","schedule","dawn","dusk"],k:[28,44],o:2},b:{a:"NegativeSquaredLatinCapitalLetterB",b:"1F171-FE0F",c:"1F171",d:!0,e:!0,f:!0,h:!0,j:["B符号","红方块","字母","信","red-square","alphabet","letter"],k:[0,17],o:2},"flag-md":{a:"MoldovaFlag",b:"1F1F2-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[3,4],o:2,j:["摩尔多瓦国旗"]},clock630:{a:"ClockFaceSix-Thirty",b:"1F561",d:!0,e:!0,f:!0,h:!0,j:["六点半","时间","晚","早","附表","time","late","early","schedule"],k:[28,56],o:2},cl:{a:"SquaredCl",b:"1F191",d:!0,e:!0,f:!0,h:!0,j:["CL符号","字母","的话","红方块","alphabet","words","red-square"],k:[0,21],o:2},"flag-me":{a:"MontenegroFlag",b:"1F1F2-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[3,5],o:2,j:["黑山国旗"]},file_folder:{a:"FileFolder",b:"1F4C1",d:!0,e:!0,f:!0,h:!0,j:["文件夹","文件","商","办公室","documents","business","office"],k:[26,23],o:2},cop:{skin_variations:{"1F3FB":{unified:"1F46E-1F3FB",non_qualified:null,image:"1f46e-1f3fb.png",sheet_x:21,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F46E-1F3FC",non_qualified:null,image:"1f46e-1f3fc.png",sheet_x:21,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F46E-1F3FD",non_qualified:null,image:"1f46e-1f3fd.png",sheet_x:21,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F46E-1F3FE",non_qualified:null,image:"1f46e-1f3fe.png",sheet_x:21,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F46E-1F3FF",non_qualified:null,image:"1f46e-1f3ff.png",sheet_x:21,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F46E-200D-2642-FE0F",a:"PoliceOfficer",b:"1F46E",d:!0,e:!0,f:!0,h:!1,k:[21,49],o:2,j:["警官"]},"male-police-officer":{skin_variations:{"1F3FB":{unified:"1F46E-1F3FB-200D-2642-FE0F",non_qualified:"1F46E-1F3FB-200D-2642",image:"1f46e-1f3fb-200d-2642-fe0f.png",sheet_x:21,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46E-1F3FC-200D-2642-FE0F",non_qualified:"1F46E-1F3FC-200D-2642",image:"1f46e-1f3fc-200d-2642-fe0f.png",sheet_x:21,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46E-1F3FD-200D-2642-FE0F",non_qualified:"1F46E-1F3FD-200D-2642",image:"1f46e-1f3fd-200d-2642-fe0f.png",sheet_x:21,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46E-1F3FE-200D-2642-FE0F",non_qualified:"1F46E-1F3FE-200D-2642",image:"1f46e-1f3fe-200d-2642-fe0f.png",sheet_x:21,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46E-1F3FF-200D-2642-FE0F",non_qualified:"1F46E-1F3FF-200D-2642",image:"1f46e-1f3ff-200d-2642-fe0f.png",sheet_x:21,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F46E",a:"MalePoliceOfficer",b:"1F46E-200D-2642-FE0F",c:"1F46E-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[21,43],o:4,j:["男警官"]},cool:{a:"SquaredCool",b:"1F192",d:!0,e:!0,f:!0,h:!0,j:["COOL符号","的话","蓝色方块","words","blue-square"],k:[0,22],o:2},clock7:{a:"ClockFaceSevenOclock",b:"1F556",d:!0,e:!0,f:!0,h:!0,j:["七点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,45],o:2},"flag-mf":{a:"St.MartinFlag",b:"1F1F2-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[3,6],o:2,j:["圣马丁国旗"]},open_file_folder:{a:"OpenFileFolder",b:"1F4C2",d:!0,e:!0,f:!0,h:!0,j:["开启的文件夹","文件","负荷","documents","load"],k:[26,24],o:2},card_index_dividers:{a:"CardIndexDividers",b:"1F5C2-FE0F",c:"1F5C2",d:!0,e:!0,f:!0,h:!0,j:["索引分隔卡","组织","商","文具","organizing","business","stationery"],k:[30,15],o:2},"flag-mg":{a:"MadagascarFlag",b:"1F1F2-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[3,7],o:2,j:["马达加斯加国旗"]},free:{a:"SquaredFree",b:"1F193",d:!0,e:!0,f:!0,h:!0,j:["免费符号","蓝色方块","的话","blue-square","words"],k:[0,23],o:2},"female-police-officer":{skin_variations:{"1F3FB":{unified:"1F46E-1F3FB-200D-2640-FE0F",non_qualified:"1F46E-1F3FB-200D-2640",image:"1f46e-1f3fb-200d-2640-fe0f.png",sheet_x:21,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46E-1F3FC-200D-2640-FE0F",non_qualified:"1F46E-1F3FC-200D-2640",image:"1f46e-1f3fc-200d-2640-fe0f.png",sheet_x:21,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46E-1F3FD-200D-2640-FE0F",non_qualified:"1F46E-1F3FD-200D-2640",image:"1f46e-1f3fd-200d-2640-fe0f.png",sheet_x:21,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46E-1F3FE-200D-2640-FE0F",non_qualified:"1F46E-1F3FE-200D-2640",image:"1f46e-1f3fe-200d-2640-fe0f.png",sheet_x:21,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46E-1F3FF-200D-2640-FE0F",non_qualified:"1F46E-1F3FF-200D-2640",image:"1f46e-1f3ff-200d-2640-fe0f.png",sheet_x:21,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemalePoliceOfficer",b:"1F46E-200D-2640-FE0F",c:"1F46E-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[21,37],o:4,j:["女警官"]},clock730:{a:"ClockFaceSeven-Thirty",b:"1F562",d:!0,e:!0,f:!0,h:!0,j:["七点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,0],o:2},date:{a:"Calendar",b:"1F4C5",d:!0,e:!0,f:!0,h:!0,j:["日历","日历","附表","calendar","schedule"],k:[26,27],o:2},clock8:{a:"ClockFaceEightOclock",b:"1F557",d:!0,e:!0,f:!0,h:!0,j:["八点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,46],o:2},information_source:{a:"InformationSource",b:"2139-FE0F",c:"2139",d:!0,e:!0,f:!0,h:!0,j:["信息标识","蓝色方块","字母","信","blue-square","alphabet","letter"],k:[52,13],o:2},sleuth_or_spy:{skin_variations:{"1F3FB":{unified:"1F575-1F3FB",non_qualified:null,image:"1f575-1f3fb.png",sheet_x:29,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F575-1F3FC",non_qualified:null,image:"1f575-1f3fc.png",sheet_x:29,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F575-1F3FD",non_qualified:null,image:"1f575-1f3fd.png",sheet_x:29,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F575-1F3FE",non_qualified:null,image:"1f575-1f3fe.png",sheet_x:29,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F575-1F3FF",non_qualified:null,image:"1f575-1f3ff.png",sheet_x:29,sheet_y:32,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F575-FE0F-200D-2642-FE0F",a:"SleuthorSpy",b:"1F575-FE0F",c:"1F575",d:!0,e:!0,f:!0,h:!1,k:[29,27],o:2,j:["侦探"]},"flag-mh":{a:"MarshallIslandsFlag",b:"1F1F2-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[3,8],o:2,j:["马绍尔群岛旗"]},clock830:{a:"ClockFaceEight-Thirty",b:"1F563",d:!0,e:!0,f:!0,h:!0,j:["八点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,1],o:2},calendar:{a:"Tear-offCalendar",b:"1F4C6",d:!0,e:!0,f:!0,h:!0,j:["撕下日历","附表","日期","规划","schedule","date","planning"],k:[26,28],o:2},"male-detective":{skin_variations:{"1F3FB":{unified:"1F575-1F3FB-200D-2642-FE0F",non_qualified:"1F575-1F3FB-200D-2642",image:"1f575-1f3fb-200d-2642-fe0f.png",sheet_x:29,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F575-1F3FC-200D-2642-FE0F",non_qualified:"1F575-1F3FC-200D-2642",image:"1f575-1f3fc-200d-2642-fe0f.png",sheet_x:29,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F575-1F3FD-200D-2642-FE0F",non_qualified:"1F575-1F3FD-200D-2642",image:"1f575-1f3fd-200d-2642-fe0f.png",sheet_x:29,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F575-1F3FE-200D-2642-FE0F",non_qualified:"1F575-1F3FE-200D-2642",image:"1f575-1f3fe-200d-2642-fe0f.png",sheet_x:29,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F575-1F3FF-200D-2642-FE0F",non_qualified:"1F575-1F3FF-200D-2642",image:"1f575-1f3ff-200d-2642-fe0f.png",sheet_x:29,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F575-FE0F",a:"MaleDetective",b:"1F575-FE0F-200D-2642-FE0F",d:!0,e:!0,f:!0,h:!1,k:[29,21],o:4,j:["男侦探"]},"flag-mk":{a:"NorthMacedoniaFlag",b:"1F1F2-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[3,9],o:2,j:["马其顿国旗"]},id:{a:"SquaredId",b:"1F194",d:!0,e:!0,f:!0,h:!0,j:["ID符号","紫色方块","的话","purple-square","words"],k:[0,24],o:2},spiral_note_pad:{a:"SpiralNotePad",b:"1F5D2-FE0F",c:"1F5D2",d:!0,e:!0,f:!0,h:!0,k:[30,19],o:2,j:["线圈记事本"]},"female-detective":{skin_variations:{"1F3FB":{unified:"1F575-1F3FB-200D-2640-FE0F",non_qualified:"1F575-1F3FB-200D-2640",image:"1f575-1f3fb-200d-2640-fe0f.png",sheet_x:29,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F575-1F3FC-200D-2640-FE0F",non_qualified:"1F575-1F3FC-200D-2640",image:"1f575-1f3fc-200d-2640-fe0f.png",sheet_x:29,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F575-1F3FD-200D-2640-FE0F",non_qualified:"1F575-1F3FD-200D-2640",image:"1f575-1f3fd-200d-2640-fe0f.png",sheet_x:29,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F575-1F3FE-200D-2640-FE0F",non_qualified:"1F575-1F3FE-200D-2640",image:"1f575-1f3fe-200d-2640-fe0f.png",sheet_x:29,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F575-1F3FF-200D-2640-FE0F",non_qualified:"1F575-1F3FF-200D-2640",image:"1f575-1f3ff-200d-2640-fe0f.png",sheet_x:29,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleDetective",b:"1F575-FE0F-200D-2640-FE0F",d:!0,e:!0,f:!0,h:!1,k:[29,15],o:4,j:["女侦探"]},clock9:{a:"ClockFaceNineOclock",b:"1F558",d:!0,e:!0,f:!0,h:!0,j:["九点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,47],o:2},"flag-ml":{a:"MaliFlag",b:"1F1F2-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[3,10],o:2,j:["马里国旗"]},m:{a:"CircledLatinCapitalLetterM",b:"24C2-FE0F",c:"24C2",d:!0,e:!0,f:!0,h:!0,j:["地铁车站","字母","蓝圈","信","alphabet","blue-circle","letter"],k:[52,40],o:2},"flag-mm":{a:"Myanmar(burma)Flag",b:"1F1F2-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[3,11],o:2,j:["缅甸国旗"]},clock930:{a:"ClockFaceNine-Thirty",b:"1F564",d:!0,e:!0,f:!0,h:!0,j:["九点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,2],o:2},guardsman:{skin_variations:{"1F3FB":{unified:"1F482-1F3FB",non_qualified:null,image:"1f482-1f3fb.png",sheet_x:24,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F482-1F3FC",non_qualified:null,image:"1f482-1f3fc.png",sheet_x:24,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F482-1F3FD",non_qualified:null,image:"1f482-1f3fd.png",sheet_x:24,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F482-1F3FE",non_qualified:null,image:"1f482-1f3fe.png",sheet_x:24,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F482-1F3FF",non_qualified:null,image:"1f482-1f3ff.png",sheet_x:24,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F482-200D-2642-FE0F",a:"Guardsman",b:"1F482",d:!0,e:!0,f:!0,h:!1,j:["警卫","英国","千兆克","英国的","雄","家伙","皇家","uk","gb","british","male","guy","royal"],k:[24,20],o:2},new:{a:"SquaredNew",b:"1F195",d:!0,e:!0,f:!0,h:!0,j:["全新符号","蓝色方块","的话","开始","blue-square","words","start"],k:[0,25],o:2},spiral_calendar_pad:{a:"SpiralCalendarPad",b:"1F5D3-FE0F",c:"1F5D3",d:!0,e:!0,f:!0,h:!0,k:[30,20],o:2,j:["线圈月历"]},ng:{a:"SquaredNg",b:"1F196",d:!0,e:!0,f:!0,h:!0,j:["NG符号","蓝色方块","的话","形状","图标","blue-square","words","shape","icon"],k:[0,26],o:2},card_index:{a:"CardIndex",b:"1F4C7",d:!0,e:!0,f:!0,h:!0,j:["卡片索引","商","文具","business","stationery"],k:[26,29],o:2},clock10:{a:"ClockFaceTenOclock",b:"1F559",d:!0,e:!0,f:!0,h:!0,j:["十点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,48],o:2},"flag-mn":{a:"MongoliaFlag",b:"1F1F2-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[3,12],o:2,j:["蒙古国旗"]},"male-guard":{skin_variations:{"1F3FB":{unified:"1F482-1F3FB-200D-2642-FE0F",non_qualified:"1F482-1F3FB-200D-2642",image:"1f482-1f3fb-200d-2642-fe0f.png",sheet_x:24,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F482-1F3FC-200D-2642-FE0F",non_qualified:"1F482-1F3FC-200D-2642",image:"1f482-1f3fc-200d-2642-fe0f.png",sheet_x:24,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F482-1F3FD-200D-2642-FE0F",non_qualified:"1F482-1F3FD-200D-2642",image:"1f482-1f3fd-200d-2642-fe0f.png",sheet_x:24,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F482-1F3FE-200D-2642-FE0F",non_qualified:"1F482-1F3FE-200D-2642",image:"1f482-1f3fe-200d-2642-fe0f.png",sheet_x:24,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F482-1F3FF-200D-2642-FE0F",non_qualified:"1F482-1F3FF-200D-2642",image:"1f482-1f3ff-200d-2642-fe0f.png",sheet_x:24,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F482",a:"MaleGuard",b:"1F482-200D-2642-FE0F",c:"1F482-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[24,14],o:4,j:["男警卫"]},"flag-mo":{a:"MacaoSarChinaFlag",b:"1F1F2-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[3,13],o:2,j:["澳门特别行政区旗"]},clock1030:{a:"ClockFaceTen-Thirty",b:"1F565",d:!0,e:!0,f:!0,h:!0,j:["十点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,3],o:2},chart_with_upwards_trend:{a:"ChartwithUpwardsTrend",b:"1F4C8",d:!0,e:!0,f:!0,h:!0,j:["图表向上","图","介绍","统计","恢复","商","经济学","钱","销售","好","成功","graph","presentation","stats","recovery","business","economics","money","sales","good","success"],k:[26,30],o:2},o2:{a:"NegativeSquaredLatinCapitalLetterO",b:"1F17E-FE0F",c:"1F17E",d:!0,e:!0,f:!0,h:!0,j:["O符号","字母","红方块","信","alphabet","red-square","letter"],k:[0,18],o:2},"female-guard":{skin_variations:{"1F3FB":{unified:"1F482-1F3FB-200D-2640-FE0F",non_qualified:"1F482-1F3FB-200D-2640",image:"1f482-1f3fb-200d-2640-fe0f.png",sheet_x:24,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F482-1F3FC-200D-2640-FE0F",non_qualified:"1F482-1F3FC-200D-2640",image:"1f482-1f3fc-200d-2640-fe0f.png",sheet_x:24,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F482-1F3FD-200D-2640-FE0F",non_qualified:"1F482-1F3FD-200D-2640",image:"1f482-1f3fd-200d-2640-fe0f.png",sheet_x:24,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F482-1F3FE-200D-2640-FE0F",non_qualified:"1F482-1F3FE-200D-2640",image:"1f482-1f3fe-200d-2640-fe0f.png",sheet_x:24,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F482-1F3FF-200D-2640-FE0F",non_qualified:"1F482-1F3FF-200D-2640",image:"1f482-1f3ff-200d-2640-fe0f.png",sheet_x:24,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleGuard",b:"1F482-200D-2640-FE0F",c:"1F482-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[24,8],o:4,j:["女警卫"]},chart_with_downwards_trend:{a:"ChartwithDownwardsTrend",b:"1F4C9",d:!0,e:!0,f:!0,h:!0,j:["图表向下","图","介绍","统计","衰退","商","经济学","钱","销售","坏","失败","graph","presentation","stats","recession","business","economics","money","sales","bad","failure"],k:[26,31],o:2},"flag-mp":{a:"NorthernMarianaIslandsFlag",b:"1F1F2-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[3,14],o:2,j:["北马里亚纳群岛旗"]},ok:{a:"SquaredOk",b:"1F197",d:!0,e:!0,f:!0,h:!0,j:["OK符号","好","同意","是的","蓝色方块","good","agree","yes","blue-square"],k:[0,27],o:2},clock11:{a:"ClockFaceElevenOclock",b:"1F55A",d:!0,e:!0,f:!0,h:!0,j:["十一点点钟","时间","晚","早","附表","time","late","early","schedule"],k:[28,49],o:2},construction_worker:{skin_variations:{"1F3FB":{unified:"1F477-1F3FB",non_qualified:null,image:"1f477-1f3fb.png",sheet_x:23,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F477-1F3FC",non_qualified:null,image:"1f477-1f3fc.png",sheet_x:23,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F477-1F3FD",non_qualified:null,image:"1f477-1f3fd.png",sheet_x:23,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F477-1F3FE",non_qualified:null,image:"1f477-1f3fe.png",sheet_x:23,sheet_y:26,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F477-1F3FF",non_qualified:null,image:"1f477-1f3ff.png",sheet_x:23,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F477-200D-2642-FE0F",a:"ConstructionWorker",b:"1F477",d:!0,e:!0,f:!0,h:!1,k:[23,22],o:2,j:["建筑工人"]},"male-construction-worker":{skin_variations:{"1F3FB":{unified:"1F477-1F3FB-200D-2642-FE0F",non_qualified:"1F477-1F3FB-200D-2642",image:"1f477-1f3fb-200d-2642-fe0f.png",sheet_x:23,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F477-1F3FC-200D-2642-FE0F",non_qualified:"1F477-1F3FC-200D-2642",image:"1f477-1f3fc-200d-2642-fe0f.png",sheet_x:23,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F477-1F3FD-200D-2642-FE0F",non_qualified:"1F477-1F3FD-200D-2642",image:"1f477-1f3fd-200d-2642-fe0f.png",sheet_x:23,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F477-1F3FE-200D-2642-FE0F",non_qualified:"1F477-1F3FE-200D-2642",image:"1f477-1f3fe-200d-2642-fe0f.png",sheet_x:23,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F477-1F3FF-200D-2642-FE0F",non_qualified:"1F477-1F3FF-200D-2642",image:"1f477-1f3ff-200d-2642-fe0f.png",sheet_x:23,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F477",a:"MaleConstructionWorker",b:"1F477-200D-2642-FE0F",c:"1F477-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[23,16],o:4,j:["男性建筑工人"]},clock1130:{a:"ClockFaceEleven-Thirty",b:"1F566",d:!0,e:!0,f:!0,h:!0,j:["十一点半","时间","晚","早","附表","time","late","early","schedule"],k:[29,4],o:2},"flag-mq":{a:"MartiniqueFlag",b:"1F1F2-1F1F6",d:!0,e:!0,f:!0,h:!0,k:[3,15],o:2,j:["马提尼克国旗"]},bar_chart:{a:"BarChart",b:"1F4CA",d:!0,e:!0,f:!0,h:!0,j:["直方图","图","介绍","统计","graph","presentation","stats"],k:[26,32],o:2},parking:{a:"NegativeSquaredLatinCapitalLetterP",b:"1F17F-FE0F",c:"1F17F",d:!0,e:!0,f:!0,h:!0,j:["P符号","汽车","蓝色方块","字母","信","cars","blue-square","alphabet","letter"],k:[0,19],o:2},new_moon:{a:"NewMoonSymbol",b:"1F311",d:!0,e:!0,f:!0,h:!0,j:["新月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,36],o:2},"female-construction-worker":{skin_variations:{"1F3FB":{unified:"1F477-1F3FB-200D-2640-FE0F",non_qualified:"1F477-1F3FB-200D-2640",image:"1f477-1f3fb-200d-2640-fe0f.png",sheet_x:23,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F477-1F3FC-200D-2640-FE0F",non_qualified:"1F477-1F3FC-200D-2640",image:"1f477-1f3fc-200d-2640-fe0f.png",sheet_x:23,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F477-1F3FD-200D-2640-FE0F",non_qualified:"1F477-1F3FD-200D-2640",image:"1f477-1f3fd-200d-2640-fe0f.png",sheet_x:23,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F477-1F3FE-200D-2640-FE0F",non_qualified:"1F477-1F3FE-200D-2640",image:"1f477-1f3fe-200d-2640-fe0f.png",sheet_x:23,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F477-1F3FF-200D-2640-FE0F",non_qualified:"1F477-1F3FF-200D-2640",image:"1f477-1f3ff-200d-2640-fe0f.png",sheet_x:23,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleConstructionWorker",b:"1F477-200D-2640-FE0F",c:"1F477-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[23,10],o:4,j:["女建筑工人"]},sos:{a:"SquaredSos",b:"1F198",d:!0,e:!0,f:!0,h:!0,j:["求救符号","帮助","红方块","的话","紧急","911","help","red-square","words","emergency","911"],k:[0,28],o:2},clipboard:{a:"Clipboard",b:"1F4CB",d:!0,e:!0,f:!0,h:!0,j:["剪贴板","文具","文件","stationery","documents"],k:[26,33],o:2},"flag-mr":{a:"MauritaniaFlag",b:"1F1F2-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[3,16],o:2,j:["毛里塔尼亚国旗"]},prince:{skin_variations:{"1F3FB":{unified:"1F934-1F3FB",non_qualified:null,image:"1f934-1f3fb.png",sheet_x:39,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F934-1F3FC",non_qualified:null,image:"1f934-1f3fc.png",sheet_x:39,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F934-1F3FD",non_qualified:null,image:"1f934-1f3fd.png",sheet_x:39,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F934-1F3FE",non_qualified:null,image:"1f934-1f3fe.png",sheet_x:39,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F934-1F3FF",non_qualified:null,image:"1f934-1f3ff.png",sheet_x:39,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Prince",b:"1F934",d:!0,e:!0,f:!0,h:!0,j:["王子","男孩","一","雄","冠","皇家","王","boy","man","male","crown","royal","king"],k:[39,17],o:4},waxing_crescent_moon:{a:"WaxingCrescentMoonSymbol",b:"1F312",d:!0,e:!0,f:!0,h:!0,j:["娥眉月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,37],o:2},"flag-ms":{a:"MontserratFlag",b:"1F1F2-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[3,17],o:2,j:["蒙特塞拉特国旗"]},pushpin:{a:"Pushpin",b:"1F4CC",d:!0,e:!0,f:!0,h:!0,j:["图钉","文具","马克","这里","stationery","mark","here"],k:[26,34],o:2},up:{a:"SquaredUpwithExclamationMark",b:"1F199",d:!0,e:!0,f:!0,h:!0,j:["向上符号","蓝色方块","以上","高","blue-square","above","high"],k:[0,29],o:2},"flag-mt":{a:"MaltaFlag",b:"1F1F2-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[3,18],o:2,j:["马耳他国旗"]},princess:{skin_variations:{"1F3FB":{unified:"1F478-1F3FB",non_qualified:null,image:"1f478-1f3fb.png",sheet_x:23,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F478-1F3FC",non_qualified:null,image:"1f478-1f3fc.png",sheet_x:23,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F478-1F3FD",non_qualified:null,image:"1f478-1f3fd.png",sheet_x:23,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F478-1F3FE",non_qualified:null,image:"1f478-1f3fe.png",sheet_x:23,sheet_y:32,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F478-1F3FF",non_qualified:null,image:"1f478-1f3ff.png",sheet_x:23,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Princess",b:"1F478",d:!0,e:!0,f:!0,h:!0,j:["公主","女孩","女人","女性","金发","冠","皇家","女王","girl","woman","female","blond","crown","royal","queen"],k:[23,28],o:2},round_pushpin:{a:"RoundPushpin",b:"1F4CD",d:!0,e:!0,f:!0,h:!0,j:["圆图钉","文具","位置","地图","这里","stationery","location","map","here"],k:[26,35],o:2},first_quarter_moon:{a:"FirstQuarterMoonSymbol",b:"1F313",d:!0,e:!0,f:!0,h:!0,j:["上弦月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,38],o:2},vs:{a:"SquaredVs",b:"1F19A",d:!0,e:!0,f:!0,h:!0,j:["对战符号","的话","橙色方块","words","orange-square"],k:[0,30],o:2},"flag-mu":{a:"MauritiusFlag",b:"1F1F2-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[3,19],o:2,j:["毛里求斯国旗"]},koko:{a:"SquaredKatakanaKoko",b:"1F201",d:!0,e:!0,f:!0,h:!0,j:["这里符号","蓝色方块","这里","片假名","日语","目的地","blue-square","here","katakana","japanese","destination"],k:[5,4],o:2},man_with_turban:{skin_variations:{"1F3FB":{unified:"1F473-1F3FB",non_qualified:null,image:"1f473-1f3fb.png",sheet_x:22,sheet_y:44,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F473-1F3FC",non_qualified:null,image:"1f473-1f3fc.png",sheet_x:22,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F473-1F3FD",non_qualified:null,image:"1f473-1f3fd.png",sheet_x:22,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F473-1F3FE",non_qualified:null,image:"1f473-1f3fe.png",sheet_x:22,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F473-1F3FF",non_qualified:null,image:"1f473-1f3ff.png",sheet_x:22,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F473-200D-2642-FE0F",a:"ManwithTurban",b:"1F473",d:!0,e:!0,f:!0,h:!1,j:["戴着头巾的人","雄","印度","印度教","阿拉伯人","male","indian","hinduism","arabs"],k:[22,43],o:2},moon:{a:"WaxingGibbousMoonSymbol",b:"1F314",d:!0,e:!0,f:!0,h:!0,k:[5,39],n:["waxing_gibbous_moon"],o:2,j:["残月月亮"]},paperclip:{a:"Paperclip",b:"1F4CE",d:!0,e:!0,f:!0,h:!0,j:["回形针","文件","文具","documents","stationery"],k:[26,36],o:2},linked_paperclips:{a:"LinkedPaperclips",b:"1F587-FE0F",c:"1F587",d:!0,e:!0,f:!0,h:!0,k:[29,43],o:2,j:["交叠的回形针"]},"man-wearing-turban":{skin_variations:{"1F3FB":{unified:"1F473-1F3FB-200D-2642-FE0F",non_qualified:"1F473-1F3FB-200D-2642",image:"1f473-1f3fb-200d-2642-fe0f.png",sheet_x:22,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F473-1F3FC-200D-2642-FE0F",non_qualified:"1F473-1F3FC-200D-2642",image:"1f473-1f3fc-200d-2642-fe0f.png",sheet_x:22,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F473-1F3FD-200D-2642-FE0F",non_qualified:"1F473-1F3FD-200D-2642",image:"1f473-1f3fd-200d-2642-fe0f.png",sheet_x:22,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F473-1F3FE-200D-2642-FE0F",non_qualified:"1F473-1F3FE-200D-2642",image:"1f473-1f3fe-200d-2642-fe0f.png",sheet_x:22,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F473-1F3FF-200D-2642-FE0F",non_qualified:"1F473-1F3FF-200D-2642",image:"1f473-1f3ff-200d-2642-fe0f.png",sheet_x:22,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F473",a:"ManWearingTurban",b:"1F473-200D-2642-FE0F",c:"1F473-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[22,37],o:4,j:["戴着男性头巾的男性"]},sa:{a:"SquaredKatakanaSa",b:"1F202-FE0F",c:"1F202",d:!0,e:!0,f:!0,h:!0,j:["服务费符号","日语","蓝色方块","片假名","japanese","blue-square","katakana"],k:[5,5],o:2},full_moon:{a:"FullMoonSymbol",b:"1F315",d:!0,e:!0,f:!0,h:!0,j:["满月","自然界","黄色","黄昏","行星","空间","晚上","傍晚","睡","nature","yellow","twilight","planet","space","night","evening","sleep"],k:[5,40],o:2},"flag-mv":{a:"MaldivesFlag",b:"1F1F2-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[3,20],o:2,j:["马尔代夫国旗"]},"flag-mw":{a:"MalawiFlag",b:"1F1F2-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[3,21],o:2,j:["马拉维国旗"]},waning_gibbous_moon:{a:"WaningGibbousMoonSymbol",b:"1F316",d:!0,e:!0,f:!0,h:!0,j:["残月月亮","自然界","黄昏","行星","空间","晚上","傍晚","睡","waxing_gibbous_moon","nature","twilight","planet","space","night","evening","sleep","waxing_gibbous_moon"],k:[5,41],o:2},"woman-wearing-turban":{skin_variations:{"1F3FB":{unified:"1F473-1F3FB-200D-2640-FE0F",non_qualified:"1F473-1F3FB-200D-2640",image:"1f473-1f3fb-200d-2640-fe0f.png",sheet_x:22,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F473-1F3FC-200D-2640-FE0F",non_qualified:"1F473-1F3FC-200D-2640",image:"1f473-1f3fc-200d-2640-fe0f.png",sheet_x:22,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F473-1F3FD-200D-2640-FE0F",non_qualified:"1F473-1F3FD-200D-2640",image:"1f473-1f3fd-200d-2640-fe0f.png",sheet_x:22,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F473-1F3FE-200D-2640-FE0F",non_qualified:"1F473-1F3FE-200D-2640",image:"1f473-1f3fe-200d-2640-fe0f.png",sheet_x:22,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F473-1F3FF-200D-2640-FE0F",non_qualified:"1F473-1F3FF-200D-2640",image:"1f473-1f3ff-200d-2640-fe0f.png",sheet_x:22,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanWearingTurban",b:"1F473-200D-2640-FE0F",c:"1F473-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[22,31],o:4,j:["戴着女性头巾的女性"]},u6708:{a:"SquaredCjkUnifiedIdeograph-6708",b:"1F237-FE0F",c:"1F237",d:!0,e:!0,f:!0,h:!0,j:["每月金额符号","中文","月","月亮","日语","橙色方块","汉字","chinese","month","moon","japanese","orange-square","kanji"],k:[5,13],o:2},straight_ruler:{a:"StraightRuler",b:"1F4CF",d:!0,e:!0,f:!0,h:!0,j:["直尺","文具","算","长度","数学","学校","绘图","建筑师","素描","stationery","calculate","length","math","school","drawing","architect","sketch"],k:[26,37],o:2},u6709:{a:"SquaredCjkUnifiedIdeograph-6709",b:"1F236",d:!0,e:!0,f:!0,h:!0,j:["付费符号","橙色方块","中文","有","汉字","orange-square","chinese","have","kanji"],k:[5,12],o:2},triangular_ruler:{a:"TriangularRuler",b:"1F4D0",d:!0,e:!0,f:!0,h:!0,j:["三角尺","文具","数学","建筑师","素描","stationery","math","architect","sketch"],k:[26,38],o:2},man_with_gua_pi_mao:{skin_variations:{"1F3FB":{unified:"1F472-1F3FB",non_qualified:null,image:"1f472-1f3fb.png",sheet_x:22,sheet_y:26,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F472-1F3FC",non_qualified:null,image:"1f472-1f3fc.png",sheet_x:22,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F472-1F3FD",non_qualified:null,image:"1f472-1f3fd.png",sheet_x:22,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F472-1F3FE",non_qualified:null,image:"1f472-1f3fe.png",sheet_x:22,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F472-1F3FF",non_qualified:null,image:"1f472-1f3ff.png",sheet_x:22,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManwithGuaPiMao",b:"1F472",d:!0,e:!0,f:!0,h:!0,j:["男人戴中式帽子","雄","男孩","中文","male","boy","chinese"],k:[22,25],o:2},"flag-mx":{a:"MexicoFlag",b:"1F1F2-1F1FD",d:!0,e:!0,f:!0,h:!0,k:[3,22],o:2,j:["墨西哥国旗"]},last_quarter_moon:{a:"LastQuarterMoonSymbol",b:"1F317",d:!0,e:!0,f:!0,h:!0,j:["下弦月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,42],o:2},person_with_headscarf:{skin_variations:{"1F3FB":{unified:"1F9D5-1F3FB",non_qualified:null,image:"1f9d5-1f3fb.png",sheet_x:48,sheet_y:35,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D5-1F3FC",non_qualified:null,image:"1f9d5-1f3fc.png",sheet_x:48,sheet_y:36,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D5-1F3FD",non_qualified:null,image:"1f9d5-1f3fd.png",sheet_x:48,sheet_y:37,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D5-1F3FE",non_qualified:null,image:"1f9d5-1f3fe.png",sheet_x:48,sheet_y:38,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D5-1F3FF",non_qualified:null,image:"1f9d5-1f3ff.png",sheet_x:48,sheet_y:39,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"PersonwithHeadscarf",b:"1F9D5",d:!0,e:!0,f:!0,h:!0,k:[48,34],o:5,j:["女人戴着头巾"]},waning_crescent_moon:{a:"WaningCrescentMoonSymbol",b:"1F318",d:!0,e:!0,f:!0,h:!0,j:["残月","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,43],o:2},u6307:{a:"SquaredCjkUnifiedIdeograph-6307",b:"1F22F",d:!0,e:!0,f:!0,h:!0,j:["指定符号","中文","点","绿色方块","汉字","chinese","point","green-square","kanji"],k:[5,7],o:2},scissors:{a:"BlackScissors",b:"2702-FE0F",c:"2702",d:!0,e:!0,f:!0,h:!0,j:["剪刀","文具","切","stationery","cut"],k:[54,39],o:2},"flag-my":{a:"MalaysiaFlag",b:"1F1F2-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[3,23],o:2,j:["马来西亚国旗"]},ideograph_advantage:{a:"CircledIdeographAdvantage",b:"1F250",d:!0,e:!0,f:!0,h:!0,j:["获得的符号","中文","汉字","获得","获取","圈","chinese","kanji","obtain","get","circle"],k:[5,17],o:2},man_in_tuxedo:{skin_variations:{"1F3FB":{unified:"1F935-1F3FB",non_qualified:null,image:"1f935-1f3fb.png",sheet_x:39,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F935-1F3FC",non_qualified:null,image:"1f935-1f3fc.png",sheet_x:39,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F935-1F3FD",non_qualified:null,image:"1f935-1f3fd.png",sheet_x:39,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F935-1F3FE",non_qualified:null,image:"1f935-1f3fe.png",sheet_x:39,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F935-1F3FF",non_qualified:null,image:"1f935-1f3ff.png",sheet_x:39,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinTuxedo",b:"1F935",d:!0,e:!0,f:!0,h:!0,j:["穿着燕尾服的男人","夫妇","婚","婚礼","新郎","couple","marriage","wedding","groom"],k:[39,23],o:4},"flag-mz":{a:"MozambiqueFlag",b:"1F1F2-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[3,24],o:2,j:["莫桑比克国旗"]},card_file_box:{a:"CardFileBox",b:"1F5C3-FE0F",c:"1F5C3",d:!0,e:!0,f:!0,h:!0,j:["卡档案盒","商","文具","business","stationery"],k:[30,16],o:2},crescent_moon:{a:"CrescentMoon",b:"1F319",d:!0,e:!0,f:!0,h:!0,j:["弯月","晚上","睡","天空","傍晚","魔法","night","sleep","sky","evening","magic"],k:[5,44],o:2},"flag-na":{a:"NamibiaFlag",b:"1F1F3-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[3,25],o:2,j:["纳米比亚国旗"]},bride_with_veil:{skin_variations:{"1F3FB":{unified:"1F470-1F3FB",non_qualified:null,image:"1f470-1f3fb.png",sheet_x:22,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F470-1F3FC",non_qualified:null,image:"1f470-1f3fc.png",sheet_x:22,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F470-1F3FD",non_qualified:null,image:"1f470-1f3fd.png",sheet_x:22,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F470-1F3FE",non_qualified:null,image:"1f470-1f3fe.png",sheet_x:22,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F470-1F3FF",non_qualified:null,image:"1f470-1f3ff.png",sheet_x:22,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"BridewithVeil",b:"1F470",d:!0,e:!0,f:!0,h:!0,j:["戴着面纱的新娘","夫妇","婚","婚礼","女人","新娘","couple","marriage","wedding","woman","bride"],k:[22,1],o:2},new_moon_with_face:{a:"NewMoonwithFace",b:"1F31A",d:!0,e:!0,f:!0,h:!0,j:["新月脸","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,45],o:2},file_cabinet:{a:"FileCabinet",b:"1F5C4-FE0F",c:"1F5C4",d:!0,e:!0,f:!0,h:!0,j:["文件柜","归档","组织","filing","organizing"],k:[30,17],o:2},u5272:{a:"SquaredCjkUnifiedIdeograph-5272",b:"1F239",d:!0,e:!0,f:!0,h:!0,j:["特价符号","切","分","中文","汉字","粉红色方块","cut","divide","chinese","kanji","pink-square"],k:[5,15],o:2},wastebasket:{a:"Wastebasket",b:"1F5D1-FE0F",c:"1F5D1",d:!0,e:!0,f:!0,h:!0,j:["废纸篓","是","垃圾","垃圾","垃圾","折腾","bin","trash","rubbish","garbage","toss"],k:[30,18],o:2},pregnant_woman:{skin_variations:{"1F3FB":{unified:"1F930-1F3FB",non_qualified:null,image:"1f930-1f3fb.png",sheet_x:38,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F930-1F3FC",non_qualified:null,image:"1f930-1f3fc.png",sheet_x:38,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F930-1F3FD",non_qualified:null,image:"1f930-1f3fd.png",sheet_x:38,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F930-1F3FE",non_qualified:null,image:"1f930-1f3fe.png",sheet_x:38,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F930-1F3FF",non_qualified:null,image:"1f930-1f3ff.png",sheet_x:38,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"PregnantWoman",b:"1F930",d:!0,e:!0,f:!0,h:!0,j:["孕妇","婴儿","baby"],k:[38,50],o:4},first_quarter_moon_with_face:{a:"FirstQuarterMoonwithFace",b:"1F31B",d:!0,e:!0,f:!0,h:!0,j:["上弦月脸","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,46],o:2},"flag-nc":{a:"NewCaledoniaFlag",b:"1F1F3-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[3,26],o:2,j:["新喀里多尼亚国旗"]},u7121:{a:"SquaredCjkUnifiedIdeograph-7121",b:"1F21A",d:!0,e:!0,f:!0,h:!0,j:["免费符号","无","中文","汉字","日语","橙色方块","nothing","chinese","kanji","japanese","orange-square"],k:[5,6],o:2},lock:{a:"Lock",b:"1F512",d:!0,e:!0,f:!0,h:!0,j:["锁住的锁","安全","密码","挂锁","security","password","padlock"],k:[27,46],o:2},"flag-ne":{a:"NigerFlag",b:"1F1F3-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[3,27],o:2,j:["尼日尔国旗"]},last_quarter_moon_with_face:{a:"LastQuarterMoonwithFace",b:"1F31C",d:!0,e:!0,f:!0,h:!0,j:["下弦月脸","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,47],o:2},"breast-feeding":{skin_variations:{"1F3FB":{unified:"1F931-1F3FB",non_qualified:null,image:"1f931-1f3fb.png",sheet_x:39,sheet_y:0,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F931-1F3FC",non_qualified:null,image:"1f931-1f3fc.png",sheet_x:39,sheet_y:1,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F931-1F3FD",non_qualified:null,image:"1f931-1f3fd.png",sheet_x:39,sheet_y:2,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F931-1F3FE",non_qualified:null,image:"1f931-1f3fe.png",sheet_x:39,sheet_y:3,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F931-1F3FF",non_qualified:null,image:"1f931-1f3ff.png",sheet_x:39,sheet_y:4,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Breast-Feeding",b:"1F931",d:!0,e:!0,f:!0,h:!0,k:[38,56],o:5,j:["女人喂养母乳"]},u7981:{a:"SquaredCjkUnifiedIdeograph-7981",b:"1F232",d:!0,e:!0,f:!0,h:!0,j:["禁止符号","汉字","日语","中文","禁止","限制","限制","红方块","kanji","japanese","chinese","forbidden","limit","restricted","red-square"],k:[5,8],o:2},accept:{a:"CircledIdeographAccept",b:"1F251",d:!0,e:!0,f:!0,h:!0,j:["同意符号","还行","好","中文","汉字","同意","是的","橙色圆圈","ok","good","chinese","kanji","agree","yes","orange-circle"],k:[5,18],o:2},angel:{skin_variations:{"1F3FB":{unified:"1F47C-1F3FB",non_qualified:null,image:"1f47c-1f3fb.png",sheet_x:23,sheet_y:38,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F47C-1F3FC",non_qualified:null,image:"1f47c-1f3fc.png",sheet_x:23,sheet_y:39,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F47C-1F3FD",non_qualified:null,image:"1f47c-1f3fd.png",sheet_x:23,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F47C-1F3FE",non_qualified:null,image:"1f47c-1f3fe.png",sheet_x:23,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F47C-1F3FF",non_qualified:null,image:"1f47c-1f3ff.png",sheet_x:23,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"BabyAngel",b:"1F47C",d:!0,e:!0,f:!0,h:!0,j:["天使宝贝","天堂","翅膀","光环","heaven","wings","halo"],k:[23,37],o:2},unlock:{a:"OpenLock",b:"1F513",d:!0,e:!0,f:!0,h:!0,j:["松开的锁","隐私","安全","privacy","security"],k:[27,47],o:2},"flag-nf":{a:"NorfolkIslandFlag",b:"1F1F3-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[3,28],o:2,j:["诺福克岛旗"]},thermometer:{a:"Thermometer",b:"1F321-FE0F",c:"1F321",d:!0,e:!0,f:!0,h:!0,j:["温度计","天气","温度","热","冷","weather","temperature","hot","cold"],k:[5,52],o:2},"flag-ng":{a:"NigeriaFlag",b:"1F1F3-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[3,29],o:2,j:["尼日利亚国旗"]},u7533:{a:"SquaredCjkUnifiedIdeograph-7533",b:"1F238",d:!0,e:!0,f:!0,h:!0,j:["申请符号","中文","日语","汉字","橙色方块","chinese","japanese","kanji","orange-square"],k:[5,14],o:2},sunny:{a:"BlackSunwithRays",b:"2600-FE0F",c:"2600",d:!0,e:!0,f:!0,h:!0,j:["太阳","天气","自然界","亮度","夏天","海滩","春天","weather","nature","brightness","summer","beach","spring"],k:[52,49],o:2},lock_with_ink_pen:{a:"LockwithInkPen",b:"1F50F",d:!0,e:!0,f:!0,h:!0,j:["笔与锁","安全","秘密","security","secret"],k:[27,43],o:2},santa:{skin_variations:{"1F3FB":{unified:"1F385-1F3FB",non_qualified:null,image:"1f385-1f3fb.png",sheet_x:7,sheet_y:37,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F385-1F3FC",non_qualified:null,image:"1f385-1f3fc.png",sheet_x:7,sheet_y:38,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F385-1F3FD",non_qualified:null,image:"1f385-1f3fd.png",sheet_x:7,sheet_y:39,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F385-1F3FE",non_qualified:null,image:"1f385-1f3fe.png",sheet_x:7,sheet_y:40,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F385-1F3FF",non_qualified:null,image:"1f385-1f3ff.png",sheet_x:7,sheet_y:41,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FatherChristmas",b:"1F385",d:!0,e:!0,f:!0,h:!0,j:["圣诞老人","节日","一","雄","圣诞","父亲基督","festival","man","male","xmas","fatherchristmas"],k:[7,36],o:2},closed_lock_with_key:{a:"ClosedLockwithKey",b:"1F510",d:!0,e:!0,f:!0,h:!0,j:["钥匙与锁","安全","隐私","security","privacy"],k:[27,44],o:2},u5408:{a:"SquaredCjkUnifiedIdeograph-5408",b:"1F234",d:!0,e:!0,f:!0,h:!0,j:["合格符号","日语","中文","加入","汉字","红方块","japanese","chinese","join","kanji","red-square"],k:[5,10],o:2},"flag-ni":{a:"NicaraguaFlag",b:"1F1F3-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[3,30],o:2,j:["尼加拉瓜国旗"]},mrs_claus:{skin_variations:{"1F3FB":{unified:"1F936-1F3FB",non_qualified:null,image:"1f936-1f3fb.png",sheet_x:39,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F936-1F3FC",non_qualified:null,image:"1f936-1f3fc.png",sheet_x:39,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F936-1F3FD",non_qualified:null,image:"1f936-1f3fd.png",sheet_x:39,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F936-1F3FE",non_qualified:null,image:"1f936-1f3fe.png",sheet_x:39,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F936-1F3FF",non_qualified:null,image:"1f936-1f3ff.png",sheet_x:39,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MotherChristmas",b:"1F936",d:!0,e:!0,f:!0,h:!0,j:["圣诞老婆婆","女人","女性","圣诞","母亲基督","woman","female","xmas","motherchristmas"],k:[39,29],n:["mother_christmas"],o:4},full_moon_with_face:{a:"FullMoonwithFace",b:"1F31D",d:!0,e:!0,f:!0,h:!0,j:["满月脸","自然界","黄昏","行星","空间","晚上","傍晚","睡","nature","twilight","planet","space","night","evening","sleep"],k:[5,48],o:2},key:{a:"Key",b:"1F511",d:!0,e:!0,f:!0,h:!0,j:["钥匙","锁","通过","密码","lock","door","password"],k:[27,45],o:2},superhero:{skin_variations:{"1F3FB":{unified:"1F9B8-1F3FB",non_qualified:null,image:"1f9b8-1f3fb.png",sheet_x:43,sheet_y:31,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B8-1F3FC",non_qualified:null,image:"1f9b8-1f3fc.png",sheet_x:43,sheet_y:32,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B8-1F3FD",non_qualified:null,image:"1f9b8-1f3fd.png",sheet_x:43,sheet_y:33,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B8-1F3FE",non_qualified:null,image:"1f9b8-1f3fe.png",sheet_x:43,sheet_y:34,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B8-1F3FF",non_qualified:null,image:"1f9b8-1f3ff.png",sheet_x:43,sheet_y:35,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Superhero",b:"1F9B8",d:!0,e:!0,f:!0,h:!0,k:[43,30],o:11,j:["超级英雄"]},"flag-nl":{a:"NetherlandsFlag",b:"1F1F3-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[3,31],o:2,j:["荷兰国旗"]},u7a7a:{a:"SquaredCjkUnifiedIdeograph-7a7a",b:"1F233",d:!0,e:!0,f:!0,h:!0,j:["空缺符号","汉字","日语","中文","空","天空","蓝色方块","kanji","japanese","chinese","empty","sky","blue-square"],k:[5,9],o:2},sun_with_face:{a:"SunwithFace",b:"1F31E",d:!0,e:!0,f:!0,h:!0,j:["太阳脸","自然界","上午","天空","nature","morning","sky"],k:[5,49],o:2},male_superhero:{skin_variations:{"1F3FB":{unified:"1F9B8-1F3FB-200D-2642-FE0F",non_qualified:"1F9B8-1F3FB-200D-2642",image:"1f9b8-1f3fb-200d-2642-fe0f.png",sheet_x:43,sheet_y:25,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B8-1F3FC-200D-2642-FE0F",non_qualified:"1F9B8-1F3FC-200D-2642",image:"1f9b8-1f3fc-200d-2642-fe0f.png",sheet_x:43,sheet_y:26,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B8-1F3FD-200D-2642-FE0F",non_qualified:"1F9B8-1F3FD-200D-2642",image:"1f9b8-1f3fd-200d-2642-fe0f.png",sheet_x:43,sheet_y:27,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B8-1F3FE-200D-2642-FE0F",non_qualified:"1F9B8-1F3FE-200D-2642",image:"1f9b8-1f3fe-200d-2642-fe0f.png",sheet_x:43,sheet_y:28,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B8-1F3FF-200D-2642-FE0F",non_qualified:"1F9B8-1F3FF-200D-2642",image:"1f9b8-1f3ff-200d-2642-fe0f.png",sheet_x:43,sheet_y:29,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleSuperhero",b:"1F9B8-200D-2642-FE0F",c:"1F9B8-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[43,24],o:11,j:["男性超级英雄"]},ringed_planet:{a:"RingedPlanet",b:"1FA90",d:!0,e:!0,f:!0,h:!0,k:[52,4],o:12,j:["环斑星球"]},old_key:{a:"OldKey",b:"1F5DD-FE0F",c:"1F5DD",d:!0,e:!0,f:!0,h:!0,j:["旧钥匙","锁","通过","密码","lock","door","password"],k:[30,22],o:2},congratulations:{a:"CircledIdeographCongratulation",b:"3297-FE0F",c:"3297",d:!0,e:!0,f:!0,h:!0,j:["祝福符号","中文","汉字","日语","红圈","chinese","kanji","japanese","red-circle"],k:[55,46],o:2},"flag-no":{a:"NorwayFlag",b:"1F1F3-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[3,32],o:2,j:["挪威国旗"]},star:{a:"WhiteMediumStar",b:"2B50",d:!0,e:!0,f:!0,h:!0,j:["星","晚上","黄色","night","yellow"],k:[55,42],o:2},secret:{a:"CircledIdeographSecret",b:"3299-FE0F",c:"3299",d:!0,e:!0,f:!0,h:!0,j:["秘密符号","隐私","中文","嘘","汉字","红圈","privacy","chinese","sshh","kanji","red-circle"],k:[55,47],o:2},"flag-np":{a:"NepalFlag",b:"1F1F3-1F1F5",d:!0,e:!0,f:!0,h:!0,k:[3,33],o:2,j:["尼泊尔国旗"]},female_superhero:{skin_variations:{"1F3FB":{unified:"1F9B8-1F3FB-200D-2640-FE0F",non_qualified:"1F9B8-1F3FB-200D-2640",image:"1f9b8-1f3fb-200d-2640-fe0f.png",sheet_x:43,sheet_y:19,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B8-1F3FC-200D-2640-FE0F",non_qualified:"1F9B8-1F3FC-200D-2640",image:"1f9b8-1f3fc-200d-2640-fe0f.png",sheet_x:43,sheet_y:20,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B8-1F3FD-200D-2640-FE0F",non_qualified:"1F9B8-1F3FD-200D-2640",image:"1f9b8-1f3fd-200d-2640-fe0f.png",sheet_x:43,sheet_y:21,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B8-1F3FE-200D-2640-FE0F",non_qualified:"1F9B8-1F3FE-200D-2640",image:"1f9b8-1f3fe-200d-2640-fe0f.png",sheet_x:43,sheet_y:22,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B8-1F3FF-200D-2640-FE0F",non_qualified:"1F9B8-1F3FF-200D-2640",image:"1f9b8-1f3ff-200d-2640-fe0f.png",sheet_x:43,sheet_y:23,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleSuperhero",b:"1F9B8-200D-2640-FE0F",c:"1F9B8-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[43,18],o:11,j:["女超级英雄"]},hammer:{a:"Hammer",b:"1F528",d:!0,e:!0,f:!0,h:!0,j:["锤子","工具","建","创造","tools","build","create"],k:[28,11],o:2},star2:{a:"GlowingStar",b:"1F31F",d:!0,e:!0,f:!0,h:!0,j:["发光的星星","晚上","火花","棒","好","魔法","night","sparkle","awesome","good","magic"],k:[5,50],o:2},"flag-nr":{a:"NauruFlag",b:"1F1F3-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[3,34],o:2,j:["瑙鲁国旗"]},axe:{a:"Axe",b:"1FA93",d:!0,e:!0,f:!0,h:!0,k:[52,7],o:12,j:["斧头"]},u55b6:{a:"SquaredCjkUnifiedIdeograph-55b6",b:"1F23A",d:!0,e:!0,f:!0,h:!0,j:["营业中符号","日语","营业时间","橙色方块","japanese","openinghours","orange-square"],k:[5,16],o:2},supervillain:{skin_variations:{"1F3FB":{unified:"1F9B9-1F3FB",non_qualified:null,image:"1f9b9-1f3fb.png",sheet_x:43,sheet_y:49,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B9-1F3FC",non_qualified:null,image:"1f9b9-1f3fc.png",sheet_x:43,sheet_y:50,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B9-1F3FD",non_qualified:null,image:"1f9b9-1f3fd.png",sheet_x:43,sheet_y:51,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B9-1F3FE",non_qualified:null,image:"1f9b9-1f3fe.png",sheet_x:43,sheet_y:52,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B9-1F3FF",non_qualified:null,image:"1f9b9-1f3ff.png",sheet_x:43,sheet_y:53,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Supervillain",b:"1F9B9",d:!0,e:!0,f:!0,h:!0,k:[43,48],o:11,j:["大反派"]},stars:{a:"ShootingStar",b:"1F320",d:!0,e:!0,f:!0,h:!0,j:["流星","晚上","相片","night","photo"],k:[5,51],o:2},u6e80:{a:"SquaredCjkUnifiedIdeograph-6e80",b:"1F235",d:!0,e:!0,f:!0,h:!0,j:["客满符号","满","中文","日语","红方块","汉字","full","chinese","japanese","red-square","kanji"],k:[5,11],o:2},"flag-nu":{a:"NiueFlag",b:"1F1F3-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[3,35],o:2,j:["纽埃国旗"]},pick:{a:"Pick",b:"26CF-FE0F",c:"26CF",d:!0,e:!0,f:!0,h:!0,j:["鎬","工具","你","tools","dig"],k:[54,5],o:2},male_supervillain:{skin_variations:{"1F3FB":{unified:"1F9B9-1F3FB-200D-2642-FE0F",non_qualified:"1F9B9-1F3FB-200D-2642",image:"1f9b9-1f3fb-200d-2642-fe0f.png",sheet_x:43,sheet_y:43,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B9-1F3FC-200D-2642-FE0F",non_qualified:"1F9B9-1F3FC-200D-2642",image:"1f9b9-1f3fc-200d-2642-fe0f.png",sheet_x:43,sheet_y:44,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B9-1F3FD-200D-2642-FE0F",non_qualified:"1F9B9-1F3FD-200D-2642",image:"1f9b9-1f3fd-200d-2642-fe0f.png",sheet_x:43,sheet_y:45,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B9-1F3FE-200D-2642-FE0F",non_qualified:"1F9B9-1F3FE-200D-2642",image:"1f9b9-1f3fe-200d-2642-fe0f.png",sheet_x:43,sheet_y:46,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B9-1F3FF-200D-2642-FE0F",non_qualified:"1F9B9-1F3FF-200D-2642",image:"1f9b9-1f3ff-200d-2642-fe0f.png",sheet_x:43,sheet_y:47,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleSupervillain",b:"1F9B9-200D-2642-FE0F",c:"1F9B9-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[43,42],o:11,j:["男性大反派"]},female_supervillain:{skin_variations:{"1F3FB":{unified:"1F9B9-1F3FB-200D-2640-FE0F",non_qualified:"1F9B9-1F3FB-200D-2640",image:"1f9b9-1f3fb-200d-2640-fe0f.png",sheet_x:43,sheet_y:37,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9B9-1F3FC-200D-2640-FE0F",non_qualified:"1F9B9-1F3FC-200D-2640",image:"1f9b9-1f3fc-200d-2640-fe0f.png",sheet_x:43,sheet_y:38,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9B9-1F3FD-200D-2640-FE0F",non_qualified:"1F9B9-1F3FD-200D-2640",image:"1f9b9-1f3fd-200d-2640-fe0f.png",sheet_x:43,sheet_y:39,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9B9-1F3FE-200D-2640-FE0F",non_qualified:"1F9B9-1F3FE-200D-2640",image:"1f9b9-1f3fe-200d-2640-fe0f.png",sheet_x:43,sheet_y:40,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9B9-1F3FF-200D-2640-FE0F",non_qualified:"1F9B9-1F3FF-200D-2640",image:"1f9b9-1f3ff-200d-2640-fe0f.png",sheet_x:43,sheet_y:41,added_in:"11.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleSupervillain",b:"1F9B9-200D-2640-FE0F",c:"1F9B9-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[43,36],o:11,j:["女性大反派"]},hammer_and_pick:{a:"HammerandPick",b:"2692-FE0F",c:"2692",d:!0,e:!0,f:!0,h:!0,j:["锤子和鎬","工具","建","创造","tools","build","create"],k:[53,41],o:2},milky_way:{a:"MilkyWay",b:"1F30C",d:!0,e:!0,f:!0,h:!0,j:["银河","相片","空间","星星","photo","space","stars"],k:[5,31],o:2},red_circle:{a:"LargeRedCircle",b:"1F534",d:!0,e:!0,f:!0,h:!0,j:["红色圆圈","形状","错误","危险","shape","error","danger"],k:[28,23],o:2},"flag-nz":{a:"NewZealandFlag",b:"1F1F3-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[3,36],o:2,j:["新西兰国旗"]},large_orange_circle:{a:"LargeOrangeCircle",b:"1F7E0",d:!0,e:!0,f:!0,h:!0,k:[37,3],o:12,j:["橙色圆圈"]},hammer_and_wrench:{a:"HammerandWrench",b:"1F6E0-FE0F",c:"1F6E0",d:!0,e:!0,f:!0,h:!0,j:["锤子和扳手","工具","建","创造","tools","build","create"],k:[36,42],o:2},"flag-om":{a:"OmanFlag",b:"1F1F4-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[3,37],o:2,j:["阿曼国旗"]},cloud:{a:"Cloud",b:"2601-FE0F",c:"2601",d:!0,e:!0,f:!0,h:!0,j:["云","天气","天空","weather","sky"],k:[52,50],o:2},mage:{skin_variations:{"1F3FB":{unified:"1F9D9-1F3FB",non_qualified:null,image:"1f9d9-1f3fb.png",sheet_x:49,sheet_y:50,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9D9-1F3FC",non_qualified:null,image:"1f9d9-1f3fc.png",sheet_x:49,sheet_y:51,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9D9-1F3FD",non_qualified:null,image:"1f9d9-1f3fd.png",sheet_x:49,sheet_y:52,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9D9-1F3FE",non_qualified:null,image:"1f9d9-1f3fe.png",sheet_x:49,sheet_y:53,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9D9-1F3FF",non_qualified:null,image:"1f9d9-1f3ff.png",sheet_x:49,sheet_y:54,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D9-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9D9-200D-2640-FE0F",a:"Mage",b:"1F9D9",d:!0,e:!0,f:!0,h:!0,k:[49,49],o:5,j:["魔法师"]},dagger_knife:{a:"DaggerKnife",b:"1F5E1-FE0F",c:"1F5E1",d:!0,e:!0,f:!0,h:!0,k:[30,24],o:2,j:["匕首"]},partly_sunny:{a:"SunBehindCloud",b:"26C5",d:!0,e:!0,f:!0,h:!0,j:["晴时多云","天气","自然界","多云","上午","秋天","春天","weather","nature","cloudy","morning","fall","spring"],k:[54,2],o:2},large_yellow_circle:{a:"LargeYellowCircle",b:"1F7E1",d:!0,e:!0,f:!0,h:!0,k:[37,4],o:12,j:["黄色圆圈"]},male_mage:{skin_variations:{"1F3FB":{unified:"1F9D9-1F3FB-200D-2642-FE0F",non_qualified:"1F9D9-1F3FB-200D-2642",image:"1f9d9-1f3fb-200d-2642-fe0f.png",sheet_x:49,sheet_y:44,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D9-1F3FC-200D-2642-FE0F",non_qualified:"1F9D9-1F3FC-200D-2642",image:"1f9d9-1f3fc-200d-2642-fe0f.png",sheet_x:49,sheet_y:45,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D9-1F3FD-200D-2642-FE0F",non_qualified:"1F9D9-1F3FD-200D-2642",image:"1f9d9-1f3fd-200d-2642-fe0f.png",sheet_x:49,sheet_y:46,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D9-1F3FE-200D-2642-FE0F",non_qualified:"1F9D9-1F3FE-200D-2642",image:"1f9d9-1f3fe-200d-2642-fe0f.png",sheet_x:49,sheet_y:47,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D9-1F3FF-200D-2642-FE0F",non_qualified:"1F9D9-1F3FF-200D-2642",image:"1f9d9-1f3ff-200d-2642-fe0f.png",sheet_x:49,sheet_y:48,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleMage",b:"1F9D9-200D-2642-FE0F",c:"1F9D9-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[49,43],o:5,j:["人的魔法师"]},"flag-pa":{a:"PanamaFlag",b:"1F1F5-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[3,38],o:2,j:["巴拿马国旗"]},thunder_cloud_and_rain:{a:"ThunderCloudandRain",b:"26C8-FE0F",c:"26C8",d:!0,e:!0,f:!0,h:!0,k:[54,3],o:2,j:["雷雨交加"]},large_green_circle:{a:"LargeGreenCircle",b:"1F7E2",d:!0,e:!0,f:!0,h:!0,k:[37,5],o:12,j:["绿色圆圈"]},female_mage:{skin_variations:{"1F3FB":{unified:"1F9D9-1F3FB-200D-2640-FE0F",non_qualified:"1F9D9-1F3FB-200D-2640",image:"1f9d9-1f3fb-200d-2640-fe0f.png",sheet_x:49,sheet_y:38,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FB"},"1F3FC":{unified:"1F9D9-1F3FC-200D-2640-FE0F",non_qualified:"1F9D9-1F3FC-200D-2640",image:"1f9d9-1f3fc-200d-2640-fe0f.png",sheet_x:49,sheet_y:39,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FC"},"1F3FD":{unified:"1F9D9-1F3FD-200D-2640-FE0F",non_qualified:"1F9D9-1F3FD-200D-2640",image:"1f9d9-1f3fd-200d-2640-fe0f.png",sheet_x:49,sheet_y:40,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FD"},"1F3FE":{unified:"1F9D9-1F3FE-200D-2640-FE0F",non_qualified:"1F9D9-1F3FE-200D-2640",image:"1f9d9-1f3fe-200d-2640-fe0f.png",sheet_x:49,sheet_y:41,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FE"},"1F3FF":{unified:"1F9D9-1F3FF-200D-2640-FE0F",non_qualified:"1F9D9-1F3FF-200D-2640",image:"1f9d9-1f3ff-200d-2640-fe0f.png",sheet_x:49,sheet_y:42,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D9-1F3FF"}},obsoletes:"1F9D9",a:"FemaleMage",b:"1F9D9-200D-2640-FE0F",c:"1F9D9-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[49,37],o:5,j:["女魔法师"]},crossed_swords:{a:"CrossedSwords",b:"2694-FE0F",c:"2694",d:!0,e:!0,f:!0,h:!0,j:["交锋的剑","武器","weapon"],k:[53,43],o:2},"flag-pe":{a:"PeruFlag",b:"1F1F5-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[3,39],o:2,j:["秘鲁国旗"]},gun:{a:"Pistol",b:"1F52B",d:!0,e:!0,f:!0,h:!0,j:["水枪","暴力","武器","手枪","左轮手枪","violence","weapon","pistol","revolver"],k:[28,14],o:2},mostly_sunny:{a:"MostlySunny",b:"1F324-FE0F",c:"1F324",d:!0,e:!0,f:!0,h:!0,k:[5,53],n:["sun_small_cloud"],o:2,j:["晴时多云"]},fairy:{skin_variations:{"1F3FB":{unified:"1F9DA-1F3FB",non_qualified:null,image:"1f9da-1f3fb.png",sheet_x:50,sheet_y:11,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9DA-1F3FC",non_qualified:null,image:"1f9da-1f3fc.png",sheet_x:50,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9DA-1F3FD",non_qualified:null,image:"1f9da-1f3fd.png",sheet_x:50,sheet_y:13,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9DA-1F3FE",non_qualified:null,image:"1f9da-1f3fe.png",sheet_x:50,sheet_y:14,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9DA-1F3FF",non_qualified:null,image:"1f9da-1f3ff.png",sheet_x:50,sheet_y:15,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoleted_by:"1F9DA-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9DA-200D-2640-FE0F",a:"Fairy",b:"1F9DA",d:!0,e:!0,f:!0,h:!0,k:[50,10],o:5,j:["妖精"]},"flag-pf":{a:"FrenchPolynesiaFlag",b:"1F1F5-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[3,40],o:2,j:["法属波利尼西亚旗"]},large_blue_circle:{a:"LargeBlueCircle",b:"1F535",d:!0,e:!0,f:!0,h:!0,j:["蓝色圆圈","形状","图标","按钮","shape","icon","button"],k:[28,24],o:2},large_purple_circle:{a:"LargePurpleCircle",b:"1F7E3",d:!0,e:!0,f:!0,h:!0,k:[37,6],o:12,j:["紫色圆圈"]},bow_and_arrow:{a:"BowandArrow",b:"1F3F9",d:!0,e:!0,f:!0,h:!0,j:["弓箭","体育","sports"],k:[11,21],o:2},male_fairy:{skin_variations:{"1F3FB":{unified:"1F9DA-1F3FB-200D-2642-FE0F",non_qualified:"1F9DA-1F3FB-200D-2642",image:"1f9da-1f3fb-200d-2642-fe0f.png",sheet_x:50,sheet_y:5,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F9DA-1F3FC-200D-2642-FE0F",non_qualified:"1F9DA-1F3FC-200D-2642",image:"1f9da-1f3fc-200d-2642-fe0f.png",sheet_x:50,sheet_y:6,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F9DA-1F3FD-200D-2642-FE0F",non_qualified:"1F9DA-1F3FD-200D-2642",image:"1f9da-1f3fd-200d-2642-fe0f.png",sheet_x:50,sheet_y:7,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F9DA-1F3FE-200D-2642-FE0F",non_qualified:"1F9DA-1F3FE-200D-2642",image:"1f9da-1f3fe-200d-2642-fe0f.png",sheet_x:50,sheet_y:8,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F9DA-1F3FF-200D-2642-FE0F",non_qualified:"1F9DA-1F3FF-200D-2642",image:"1f9da-1f3ff-200d-2642-fe0f.png",sheet_x:50,sheet_y:9,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"MaleFairy",b:"1F9DA-200D-2642-FE0F",c:"1F9DA-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[50,4],o:5,j:["男妖精"]},barely_sunny:{a:"BarelySunny",b:"1F325-FE0F",c:"1F325",d:!0,e:!0,f:!0,h:!0,k:[5,54],n:["sun_behind_cloud"],o:2,j:["多云时晴"]},"flag-pg":{a:"PapuaNewGuineaFlag",b:"1F1F5-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[3,41],o:2,j:["巴布亚新几内亚国旗"]},shield:{a:"Shield",b:"1F6E1-FE0F",c:"1F6E1",d:!0,e:!0,f:!0,h:!0,j:["盾牌","保护","安全","protection","security"],k:[36,43],o:2},partly_sunny_rain:{a:"PartlySunnyRain",b:"1F326-FE0F",c:"1F326",d:!0,e:!0,f:!0,h:!0,k:[5,55],n:["sun_behind_rain_cloud"],o:2,j:["太阳雨"]},large_brown_circle:{a:"LargeBrownCircle",b:"1F7E4",d:!0,e:!0,f:!0,h:!0,k:[37,7],o:12,j:["棕色圆圈"]},female_fairy:{skin_variations:{"1F3FB":{unified:"1F9DA-1F3FB-200D-2640-FE0F",non_qualified:"1F9DA-1F3FB-200D-2640",image:"1f9da-1f3fb-200d-2640-fe0f.png",sheet_x:49,sheet_y:56,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FB"},"1F3FC":{unified:"1F9DA-1F3FC-200D-2640-FE0F",non_qualified:"1F9DA-1F3FC-200D-2640",image:"1f9da-1f3fc-200d-2640-fe0f.png",sheet_x:50,sheet_y:0,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FC"},"1F3FD":{unified:"1F9DA-1F3FD-200D-2640-FE0F",non_qualified:"1F9DA-1F3FD-200D-2640",image:"1f9da-1f3fd-200d-2640-fe0f.png",sheet_x:50,sheet_y:1,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FD"},"1F3FE":{unified:"1F9DA-1F3FE-200D-2640-FE0F",non_qualified:"1F9DA-1F3FE-200D-2640",image:"1f9da-1f3fe-200d-2640-fe0f.png",sheet_x:50,sheet_y:2,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FE"},"1F3FF":{unified:"1F9DA-1F3FF-200D-2640-FE0F",non_qualified:"1F9DA-1F3FF-200D-2640",image:"1f9da-1f3ff-200d-2640-fe0f.png",sheet_x:50,sheet_y:3,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1,obsoletes:"1F9DA-1F3FF"}},obsoletes:"1F9DA",a:"FemaleFairy",b:"1F9DA-200D-2640-FE0F",c:"1F9DA-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[49,55],o:5,j:["女妖精"]},"flag-ph":{a:"PhilippinesFlag",b:"1F1F5-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[3,42],o:2,j:["菲律宾国旗"]},"flag-pk":{a:"PakistanFlag",b:"1F1F5-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[3,43],o:2,j:["巴基斯坦国旗"]},black_circle:{a:"MediumBlackCircle",b:"26AB",d:!0,e:!0,f:!0,h:!0,j:["黑圆圈","形状","按钮","圆","shape","button","round"],k:[53,53],o:2},wrench:{a:"Wrench",b:"1F527",d:!0,e:!0,f:!0,h:!0,j:["扳手","工具","迪伊","宜家","修复","保持","tools","diy","ikea","fix","maintainer"],k:[28,10],o:2},vampire:{skin_variations:{"1F3FB":{unified:"1F9DB-1F3FB",non_qualified:null,image:"1f9db-1f3fb.png",sheet_x:50,sheet_y:29,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9DB-1F3FC",non_qualified:null,image:"1f9db-1f3fc.png",sheet_x:50,sheet_y:30,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9DB-1F3FD",non_qualified:null,image:"1f9db-1f3fd.png",sheet_x:50,sheet_y:31,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9DB-1F3FE",non_qualified:null,image:"1f9db-1f3fe.png",sheet_x:50,sheet_y:32,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9DB-1F3FF",non_qualified:null,image:"1f9db-1f3ff.png",sheet_x:50,sheet_y:33,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DB-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9DB-200D-2640-FE0F",a:"Vampire",b:"1F9DB",d:!0,e:!0,f:!0,h:!0,k:[50,28],o:5,j:["吸血鬼"]},rain_cloud:{a:"RainCloud",b:"1F327-FE0F",c:"1F327",d:!0,e:!0,f:!0,h:!0,k:[5,56],o:2,j:["云伴随雨"]},snow_cloud:{a:"SnowCloud",b:"1F328-FE0F",c:"1F328",d:!0,e:!0,f:!0,h:!0,k:[6,0],o:2,j:["云伴随雪"]},"flag-pl":{a:"PolandFlag",b:"1F1F5-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[3,44],o:2,j:["波兰国旗"]},male_vampire:{skin_variations:{"1F3FB":{unified:"1F9DB-1F3FB-200D-2642-FE0F",non_qualified:"1F9DB-1F3FB-200D-2642",image:"1f9db-1f3fb-200d-2642-fe0f.png",sheet_x:50,sheet_y:23,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9DB-1F3FC-200D-2642-FE0F",non_qualified:"1F9DB-1F3FC-200D-2642",image:"1f9db-1f3fc-200d-2642-fe0f.png",sheet_x:50,sheet_y:24,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9DB-1F3FD-200D-2642-FE0F",non_qualified:"1F9DB-1F3FD-200D-2642",image:"1f9db-1f3fd-200d-2642-fe0f.png",sheet_x:50,sheet_y:25,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9DB-1F3FE-200D-2642-FE0F",non_qualified:"1F9DB-1F3FE-200D-2642",image:"1f9db-1f3fe-200d-2642-fe0f.png",sheet_x:50,sheet_y:26,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9DB-1F3FF-200D-2642-FE0F",non_qualified:"1F9DB-1F3FF-200D-2642",image:"1f9db-1f3ff-200d-2642-fe0f.png",sheet_x:50,sheet_y:27,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"MaleVampire",b:"1F9DB-200D-2642-FE0F",c:"1F9DB-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[50,22],o:5,j:["男吸血鬼"]},nut_and_bolt:{a:"NutandBolt",b:"1F529",d:!0,e:!0,f:!0,h:!0,j:["螺母和螺栓","手机","工具","修复","handy","tools","fix"],k:[28,12],o:2},white_circle:{a:"MediumWhiteCircle",b:"26AA",d:!0,e:!0,f:!0,h:!0,j:["白圆圈","形状","圆","shape","round"],k:[53,52],o:2},female_vampire:{skin_variations:{"1F3FB":{unified:"1F9DB-1F3FB-200D-2640-FE0F",non_qualified:"1F9DB-1F3FB-200D-2640",image:"1f9db-1f3fb-200d-2640-fe0f.png",sheet_x:50,sheet_y:17,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FB"},"1F3FC":{unified:"1F9DB-1F3FC-200D-2640-FE0F",non_qualified:"1F9DB-1F3FC-200D-2640",image:"1f9db-1f3fc-200d-2640-fe0f.png",sheet_x:50,sheet_y:18,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FC"},"1F3FD":{unified:"1F9DB-1F3FD-200D-2640-FE0F",non_qualified:"1F9DB-1F3FD-200D-2640",image:"1f9db-1f3fd-200d-2640-fe0f.png",sheet_x:50,sheet_y:19,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FD"},"1F3FE":{unified:"1F9DB-1F3FE-200D-2640-FE0F",non_qualified:"1F9DB-1F3FE-200D-2640",image:"1f9db-1f3fe-200d-2640-fe0f.png",sheet_x:50,sheet_y:20,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FE"},"1F3FF":{unified:"1F9DB-1F3FF-200D-2640-FE0F",non_qualified:"1F9DB-1F3FF-200D-2640",image:"1f9db-1f3ff-200d-2640-fe0f.png",sheet_x:50,sheet_y:21,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DB-1F3FF"}},obsoletes:"1F9DB",a:"FemaleVampire",b:"1F9DB-200D-2640-FE0F",c:"1F9DB-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[50,16],o:5,j:["女吸血鬼"]},"flag-pm":{a:"St.Pierre&MiquelonFlag",b:"1F1F5-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[3,45],o:2,j:["圣皮埃尔和密克隆国旗"]},large_red_square:{a:"LargeRedSquare",b:"1F7E5",d:!0,e:!0,f:!0,h:!0,k:[37,8],o:12,j:["红色正方形"]},lightning:{a:"Lightning",b:"1F329-FE0F",c:"1F329",d:!0,e:!0,f:!0,h:!0,k:[6,1],n:["lightning_cloud"],o:2,j:["云伴随闪电"]},gear:{a:"Gear",b:"2699-FE0F",c:"2699",d:!0,e:!0,f:!0,h:!0,j:["齿轮","齿轮","cog"],k:[53,47],o:2},merperson:{skin_variations:{"1F3FB":{unified:"1F9DC-1F3FB",non_qualified:null,image:"1f9dc-1f3fb.png",sheet_x:50,sheet_y:47,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FB-200D-2642-FE0F"},"1F3FC":{unified:"1F9DC-1F3FC",non_qualified:null,image:"1f9dc-1f3fc.png",sheet_x:50,sheet_y:48,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FC-200D-2642-FE0F"},"1F3FD":{unified:"1F9DC-1F3FD",non_qualified:null,image:"1f9dc-1f3fd.png",sheet_x:50,sheet_y:49,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FD-200D-2642-FE0F"},"1F3FE":{unified:"1F9DC-1F3FE",non_qualified:null,image:"1f9dc-1f3fe.png",sheet_x:50,sheet_y:50,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FE-200D-2642-FE0F"},"1F3FF":{unified:"1F9DC-1F3FF",non_qualified:null,image:"1f9dc-1f3ff.png",sheet_x:50,sheet_y:51,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DC-1F3FF-200D-2642-FE0F"}},obsoleted_by:"1F9DC-200D-2642-FE0F",a:"Merperson",b:"1F9DC",d:!0,e:!0,f:!0,h:!0,k:[50,46],o:5,j:["人鱼"]},tornado:{a:"Tornado",b:"1F32A-FE0F",c:"1F32A",d:!0,e:!0,f:!0,h:!0,j:["龙卷风","天气","气旋","龙卷风","weather","cyclone","twister"],k:[6,2],n:["tornado_cloud"],o:2},large_orange_square:{a:"LargeOrangeSquare",b:"1F7E7",d:!0,e:!0,f:!0,h:!0,k:[37,10],o:12,j:["橙色正方形"]},"flag-pn":{a:"PitcairnIslandsFlag",b:"1F1F5-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[3,46],o:2,j:["皮特凯恩群岛旗"]},compression:{a:"Compression",b:"1F5DC-FE0F",c:"1F5DC",d:!0,e:!0,f:!0,h:!0,k:[30,21],o:2,j:["夹具"]},merman:{skin_variations:{"1F3FB":{unified:"1F9DC-1F3FB-200D-2642-FE0F",non_qualified:"1F9DC-1F3FB-200D-2642",image:"1f9dc-1f3fb-200d-2642-fe0f.png",sheet_x:50,sheet_y:41,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FB"},"1F3FC":{unified:"1F9DC-1F3FC-200D-2642-FE0F",non_qualified:"1F9DC-1F3FC-200D-2642",image:"1f9dc-1f3fc-200d-2642-fe0f.png",sheet_x:50,sheet_y:42,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FC"},"1F3FD":{unified:"1F9DC-1F3FD-200D-2642-FE0F",non_qualified:"1F9DC-1F3FD-200D-2642",image:"1f9dc-1f3fd-200d-2642-fe0f.png",sheet_x:50,sheet_y:43,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FD"},"1F3FE":{unified:"1F9DC-1F3FE-200D-2642-FE0F",non_qualified:"1F9DC-1F3FE-200D-2642",image:"1f9dc-1f3fe-200d-2642-fe0f.png",sheet_x:50,sheet_y:44,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FE"},"1F3FF":{unified:"1F9DC-1F3FF-200D-2642-FE0F",non_qualified:"1F9DC-1F3FF-200D-2642",image:"1f9dc-1f3ff-200d-2642-fe0f.png",sheet_x:50,sheet_y:45,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DC-1F3FF"}},obsoletes:"1F9DC",a:"Merman",b:"1F9DC-200D-2642-FE0F",c:"1F9DC-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[50,40],o:5,j:["人鱼"]},large_yellow_square:{a:"LargeYellowSquare",b:"1F7E8",d:!0,e:!0,f:!0,h:!0,k:[37,11],o:12,j:["黄色正方形"]},fog:{a:"Fog",b:"1F32B-FE0F",c:"1F32B",d:!0,e:!0,f:!0,h:!0,j:["雾气","天气","weather"],k:[6,3],o:2},scales:{a:"Scales",b:"2696-FE0F",c:"2696",d:!0,e:!0,f:!0,h:!0,k:[53,45],o:2,j:["天平"]},"flag-pr":{a:"PuertoRicoFlag",b:"1F1F5-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[3,47],o:2,j:["波多黎各国旗"]},wind_blowing_face:{a:"WindBlowingFace",b:"1F32C-FE0F",c:"1F32C",d:!0,e:!0,f:!0,h:!0,k:[6,4],o:2,j:["吹气"]},"flag-ps":{a:"PalestinianTerritoriesFlag",b:"1F1F5-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[3,48],o:2,j:["巴勒斯坦领土旗"]},mermaid:{skin_variations:{"1F3FB":{unified:"1F9DC-1F3FB-200D-2640-FE0F",non_qualified:"1F9DC-1F3FB-200D-2640",image:"1f9dc-1f3fb-200d-2640-fe0f.png",sheet_x:50,sheet_y:35,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9DC-1F3FC-200D-2640-FE0F",non_qualified:"1F9DC-1F3FC-200D-2640",image:"1f9dc-1f3fc-200d-2640-fe0f.png",sheet_x:50,sheet_y:36,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9DC-1F3FD-200D-2640-FE0F",non_qualified:"1F9DC-1F3FD-200D-2640",image:"1f9dc-1f3fd-200d-2640-fe0f.png",sheet_x:50,sheet_y:37,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9DC-1F3FE-200D-2640-FE0F",non_qualified:"1F9DC-1F3FE-200D-2640",image:"1f9dc-1f3fe-200d-2640-fe0f.png",sheet_x:50,sheet_y:38,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9DC-1F3FF-200D-2640-FE0F",non_qualified:"1F9DC-1F3FF-200D-2640",image:"1f9dc-1f3ff-200d-2640-fe0f.png",sheet_x:50,sheet_y:39,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Mermaid",b:"1F9DC-200D-2640-FE0F",c:"1F9DC-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[50,34],o:5,j:["美人鱼"]},probing_cane:{a:"ProbingCane",b:"1F9AF",d:!0,e:!0,f:!0,h:!0,k:[43,3],o:12,j:["探测杆"]},large_green_square:{a:"LargeGreenSquare",b:"1F7E9",d:!0,e:!0,f:!0,h:!0,k:[37,12],o:12,j:["绿色正方形"]},"flag-pt":{a:"PortugalFlag",b:"1F1F5-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[3,49],o:2,j:["葡萄牙国旗"]},link:{a:"LinkSymbol",b:"1F517",d:!0,e:!0,f:!0,h:!0,j:["链接","环","网址","rings","url"],k:[27,51],o:2},large_blue_square:{a:"LargeBlueSquare",b:"1F7E6",d:!0,e:!0,f:!0,h:!0,k:[37,9],o:12,j:["蓝色正方形"]},elf:{skin_variations:{"1F3FB":{unified:"1F9DD-1F3FB",non_qualified:null,image:"1f9dd-1f3fb.png",sheet_x:51,sheet_y:8,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FB-200D-2642-FE0F"},"1F3FC":{unified:"1F9DD-1F3FC",non_qualified:null,image:"1f9dd-1f3fc.png",sheet_x:51,sheet_y:9,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FC-200D-2642-FE0F"},"1F3FD":{unified:"1F9DD-1F3FD",non_qualified:null,image:"1f9dd-1f3fd.png",sheet_x:51,sheet_y:10,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FD-200D-2642-FE0F"},"1F3FE":{unified:"1F9DD-1F3FE",non_qualified:null,image:"1f9dd-1f3fe.png",sheet_x:51,sheet_y:11,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FE-200D-2642-FE0F"},"1F3FF":{unified:"1F9DD-1F3FF",non_qualified:null,image:"1f9dd-1f3ff.png",sheet_x:51,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9DD-1F3FF-200D-2642-FE0F"}},obsoleted_by:"1F9DD-200D-2642-FE0F",a:"Elf",b:"1F9DD",d:!0,e:!0,f:!0,h:!0,k:[51,7],o:5,j:["小精灵"]},cyclone:{a:"Cyclone",b:"1F300",d:!0,e:!0,f:!0,h:!0,j:["气旋","天气","旋流","蓝","云","旋涡","螺旋","漩涡","纺","龙卷风","飓风","台风","weather","swirl","blue","cloud","vortex","spiral","whirlpool","spin","tornado","hurricane","typhoon"],k:[5,19],o:2},rainbow:{a:"Rainbow",b:"1F308",d:!0,e:!0,f:!0,h:!0,j:["彩虹","自然界","快乐","unicorn_face","相片","天空","春天","nature","happy","unicorn_face","photo","sky","spring"],k:[5,27],o:2},male_elf:{skin_variations:{"1F3FB":{unified:"1F9DD-1F3FB-200D-2642-FE0F",non_qualified:"1F9DD-1F3FB-200D-2642",image:"1f9dd-1f3fb-200d-2642-fe0f.png",sheet_x:51,sheet_y:2,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FB"},"1F3FC":{unified:"1F9DD-1F3FC-200D-2642-FE0F",non_qualified:"1F9DD-1F3FC-200D-2642",image:"1f9dd-1f3fc-200d-2642-fe0f.png",sheet_x:51,sheet_y:3,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FC"},"1F3FD":{unified:"1F9DD-1F3FD-200D-2642-FE0F",non_qualified:"1F9DD-1F3FD-200D-2642",image:"1f9dd-1f3fd-200d-2642-fe0f.png",sheet_x:51,sheet_y:4,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FD"},"1F3FE":{unified:"1F9DD-1F3FE-200D-2642-FE0F",non_qualified:"1F9DD-1F3FE-200D-2642",image:"1f9dd-1f3fe-200d-2642-fe0f.png",sheet_x:51,sheet_y:5,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FE"},"1F3FF":{unified:"1F9DD-1F3FF-200D-2642-FE0F",non_qualified:"1F9DD-1F3FF-200D-2642",image:"1f9dd-1f3ff-200d-2642-fe0f.png",sheet_x:51,sheet_y:6,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9DD-1F3FF"}},obsoletes:"1F9DD",a:"MaleElf",b:"1F9DD-200D-2642-FE0F",c:"1F9DD-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[51,1],o:5,j:["男精灵"]},"flag-pw":{a:"PalauFlag",b:"1F1F5-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[3,50],o:2,j:["帕劳国旗"]},chains:{a:"Chains",b:"26D3-FE0F",c:"26D3",d:!0,e:!0,f:!0,h:!0,j:["链","锁","逮捕","lock","arrest"],k:[54,7],o:2},large_purple_square:{a:"LargePurpleSquare",b:"1F7EA",d:!0,e:!0,f:!0,h:!0,k:[37,13],o:12,j:["紫色正方形"]},female_elf:{skin_variations:{"1F3FB":{unified:"1F9DD-1F3FB-200D-2640-FE0F",non_qualified:"1F9DD-1F3FB-200D-2640",image:"1f9dd-1f3fb-200d-2640-fe0f.png",sheet_x:50,sheet_y:53,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9DD-1F3FC-200D-2640-FE0F",non_qualified:"1F9DD-1F3FC-200D-2640",image:"1f9dd-1f3fc-200d-2640-fe0f.png",sheet_x:50,sheet_y:54,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9DD-1F3FD-200D-2640-FE0F",non_qualified:"1F9DD-1F3FD-200D-2640",image:"1f9dd-1f3fd-200d-2640-fe0f.png",sheet_x:50,sheet_y:55,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9DD-1F3FE-200D-2640-FE0F",non_qualified:"1F9DD-1F3FE-200D-2640",image:"1f9dd-1f3fe-200d-2640-fe0f.png",sheet_x:50,sheet_y:56,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9DD-1F3FF-200D-2640-FE0F",non_qualified:"1F9DD-1F3FF-200D-2640",image:"1f9dd-1f3ff-200d-2640-fe0f.png",sheet_x:51,sheet_y:0,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"FemaleElf",b:"1F9DD-200D-2640-FE0F",c:"1F9DD-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[50,52],o:5,j:["女精灵"]},"flag-py":{a:"ParaguayFlag",b:"1F1F5-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[3,51],o:2,j:["巴拉圭国旗"]},closed_umbrella:{a:"ClosedUmbrella",b:"1F302",d:!0,e:!0,f:!0,h:!0,j:["关闭的伞","天气","雨","细雨","weather","rain","drizzle"],k:[5,21],o:2},toolbox:{a:"Toolbox",b:"1F9F0",d:!0,e:!0,f:!0,h:!0,k:[51,35],o:11,j:["工具箱"]},large_brown_square:{a:"LargeBrownSquare",b:"1F7EB",d:!0,e:!0,f:!0,h:!0,k:[37,14],o:12,j:["棕色正方形"]},magnet:{a:"Magnet",b:"1F9F2",d:!0,e:!0,f:!0,h:!0,k:[51,37],o:11,j:["磁铁"]},genie:{obsoleted_by:"1F9DE-200D-2642-FE0F",a:"Genie",b:"1F9DE",d:!0,e:!0,f:!0,h:!0,k:[51,15],o:5,j:["神灯精灵"]},"flag-qa":{a:"QatarFlag",b:"1F1F6-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[3,52],o:2,j:["卡塔尔国旗"]},umbrella:{a:"Umbrella",b:"2602-FE0F",c:"2602",d:!0,e:!0,f:!0,h:!0,j:["雨伞","雨","天气","春天","rainy","weather","spring"],k:[52,51],o:2},black_large_square:{a:"BlackLargeSquare",b:"2B1B",d:!0,e:!0,f:!0,h:!0,j:["黑色大正方形","形状","图标","按钮","shape","icon","button"],k:[55,40],o:2},male_genie:{obsoletes:"1F9DE",a:"MaleGenie",b:"1F9DE-200D-2642-FE0F",c:"1F9DE-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[51,14],o:5,j:["男神灯精灵"]},umbrella_with_rain_drops:{a:"UmbrellawithRainDrops",b:"2614",d:!0,e:!0,f:!0,h:!0,k:[52,56],o:2,j:["雨中的伞"]},"flag-re":{a:"RéunionFlag",b:"1F1F7-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[3,53],o:2,j:["留尼汪国旗"]},white_large_square:{a:"WhiteLargeSquare",b:"2B1C",d:!0,e:!0,f:!0,h:!0,j:["白色的大正方形","形状","图标","石头","按钮","shape","icon","stone","button"],k:[55,41],o:2},alembic:{a:"Alembic",b:"2697-FE0F",c:"2697",d:!0,e:!0,f:!0,h:!0,j:["蒸馏器","蒸馏","科学","实验","化学","distilling","science","experiment","chemistry"],k:[53,46],o:2},black_medium_square:{a:"BlackMediumSquare",b:"25FC-FE0F",c:"25FC",d:!0,e:!0,f:!0,h:!0,j:["中等黑色正方形","形状","按钮","图标","shape","button","icon"],k:[52,46],o:2},test_tube:{a:"TestTube",b:"1F9EA",d:!0,e:!0,f:!0,h:!0,k:[51,29],o:11,j:["试管"]},"flag-ro":{a:"RomaniaFlag",b:"1F1F7-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[3,54],o:2,j:["罗马尼亚国旗"]},female_genie:{a:"FemaleGenie",b:"1F9DE-200D-2640-FE0F",c:"1F9DE-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[51,13],o:5,j:["女神灯精灵"]},umbrella_on_ground:{a:"UmbrellaonGround",b:"26F1-FE0F",c:"26F1",d:!0,e:!0,f:!0,h:!0,k:[54,12],o:2,j:["伞放地面"]},zombie:{obsoleted_by:"1F9DF-200D-2642-FE0F",a:"Zombie",b:"1F9DF",d:!0,e:!0,f:!0,h:!0,k:[51,18],o:5,j:["僵尸"]},zap:{a:"HighVoltageSign",b:"26A1",d:!0,e:!0,f:!0,h:!0,j:["高电压","雷","天气","闪电螺栓","几乎","thunder","weather","lightningbolt","fast"],k:[53,51],o:2},white_medium_square:{a:"WhiteMediumSquare",b:"25FB-FE0F",c:"25FB",d:!0,e:!0,f:!0,h:!0,j:["中等白色正方形","形状","石头","图标","shape","stone","icon"],k:[52,45],o:2},"flag-rs":{a:"SerbiaFlag",b:"1F1F7-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[3,55],o:2,j:["塞尔维亚国旗"]},petri_dish:{a:"PetriDish",b:"1F9EB",d:!0,e:!0,f:!0,h:!0,k:[51,30],o:11,j:["培养皿"]},snowflake:{a:"Snowflake",b:"2744-FE0F",c:"2744",d:!0,e:!0,f:!0,h:!0,j:["雪花","冬","季节","冷","天气","圣诞节","圣诞","winter","season","cold","weather","christmas","xmas"],k:[55,19],o:2},dna:{a:"DnaDoubleHelix",b:"1F9EC",d:!0,e:!0,f:!0,h:!0,k:[51,31],o:11,j:["去氧核糖核酸"]},male_zombie:{obsoletes:"1F9DF",a:"MaleZombie",b:"1F9DF-200D-2642-FE0F",c:"1F9DF-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[51,17],o:5,j:["男僵尸"]},black_medium_small_square:{a:"BlackMediumSmallSquare",b:"25FE",d:!0,e:!0,f:!0,h:!0,j:["黑中小正方形","图标","形状","按钮","icon","shape","button"],k:[52,48],o:2},ru:{a:"RussiaFlag",b:"1F1F7-1F1FA",d:!0,e:!0,f:!0,h:!0,j:["俄罗斯国旗","俄语","联邦","旗","国家","国家","旗帜","russian","federation","flag","nation","country","banner"],k:[3,56],n:["flag-ru"],o:2},female_zombie:{a:"FemaleZombie",b:"1F9DF-200D-2640-FE0F",c:"1F9DF-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[51,16],o:5,j:["女僵尸"]},"flag-rw":{a:"RwandaFlag",b:"1F1F7-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[4,0],o:2,j:["卢旺达国旗"]},snowman:{a:"Snowman",b:"2603-FE0F",c:"2603",d:!0,e:!0,f:!0,h:!0,j:["雪人","冬","季节","冷","天气","圣诞节","圣诞","冷冻","without_snow","winter","season","cold","weather","christmas","xmas","frozen","without_snow"],k:[52,52],o:2},white_medium_small_square:{a:"WhiteMediumSmallSquare",b:"25FD",d:!0,e:!0,f:!0,h:!0,j:["白色中小正方","形状","石头","图标","按钮","shape","stone","icon","button"],k:[52,47],o:2},microscope:{a:"Microscope",b:"1F52C",d:!0,e:!0,f:!0,h:!0,j:["显微镜","实验室","实验","放大","科学","研究","laboratory","experiment","zoomin","science","study"],k:[28,15],o:2},snowman_without_snow:{a:"SnowmanWithoutSnow",b:"26C4",d:!0,e:!0,f:!0,h:!0,k:[54,1],o:2,j:["雪人（没下雪）"]},telescope:{a:"Telescope",b:"1F52D",d:!0,e:!0,f:!0,h:!0,j:["望远镜","星星","空间","缩放","科学","天文学","stars","space","zoom","science","astronomy"],k:[28,16],o:2},massage:{skin_variations:{"1F3FB":{unified:"1F486-1F3FB",non_qualified:null,image:"1f486-1f3fb.png",sheet_x:24,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F486-1F3FC",non_qualified:null,image:"1f486-1f3fc.png",sheet_x:24,sheet_y:53,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F486-1F3FD",non_qualified:null,image:"1f486-1f3fd.png",sheet_x:24,sheet_y:54,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F486-1F3FE",non_qualified:null,image:"1f486-1f3fe.png",sheet_x:24,sheet_y:55,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F486-1F3FF",non_qualified:null,image:"1f486-1f3ff.png",sheet_x:24,sheet_y:56,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F486-200D-2640-FE0F",a:"FaceMassage",b:"1F486",d:!0,e:!0,f:!0,h:!1,k:[24,51],o:2,j:["按摩中的人"]},black_small_square:{a:"BlackSmallSquare",b:"25AA-FE0F",c:"25AA",d:!0,e:!0,f:!0,h:!0,j:["黑色小正方形","形状","图标","shape","icon"],k:[52,41],o:2},"flag-sa":{a:"SaudiArabiaFlag",b:"1F1F8-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[4,1],o:2,j:["沙特阿拉伯国旗"]},"man-getting-massage":{skin_variations:{"1F3FB":{unified:"1F486-1F3FB-200D-2642-FE0F",non_qualified:"1F486-1F3FB-200D-2642",image:"1f486-1f3fb-200d-2642-fe0f.png",sheet_x:24,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F486-1F3FC-200D-2642-FE0F",non_qualified:"1F486-1F3FC-200D-2642",image:"1f486-1f3fc-200d-2642-fe0f.png",sheet_x:24,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F486-1F3FD-200D-2642-FE0F",non_qualified:"1F486-1F3FD-200D-2642",image:"1f486-1f3fd-200d-2642-fe0f.png",sheet_x:24,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F486-1F3FE-200D-2642-FE0F",non_qualified:"1F486-1F3FE-200D-2642",image:"1f486-1f3fe-200d-2642-fe0f.png",sheet_x:24,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F486-1F3FF-200D-2642-FE0F",non_qualified:"1F486-1F3FF-200D-2642",image:"1f486-1f3ff-200d-2642-fe0f.png",sheet_x:24,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManGettingMassage",b:"1F486-200D-2642-FE0F",c:"1F486-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[24,45],o:4,j:["按摩中的男子"]},comet:{a:"Comet",b:"2604-FE0F",c:"2604",d:!0,e:!0,f:!0,h:!0,j:["彗星","空间","space"],k:[52,53],o:2},white_small_square:{a:"WhiteSmallSquare",b:"25AB-FE0F",c:"25AB",d:!0,e:!0,f:!0,h:!0,j:["白色的小正方形","形状","图标","shape","icon"],k:[52,42],o:2},"flag-sb":{a:"SolomonIslandsFlag",b:"1F1F8-1F1E7",d:!0,e:!0,f:!0,h:!0,k:[4,2],o:2,j:["所罗门群岛旗"]},satellite_antenna:{a:"SatelliteAntenna",b:"1F4E1",d:!0,e:!0,f:!0,h:!0,k:[26,55],o:2,j:["卫星天线"]},large_orange_diamond:{a:"LargeOrangeDiamond",b:"1F536",d:!0,e:!0,f:!0,h:!0,j:["大橙色钻石","形状","宝石","宝石","shape","jewel","gem"],k:[28,25],o:2},"woman-getting-massage":{skin_variations:{"1F3FB":{unified:"1F486-1F3FB-200D-2640-FE0F",non_qualified:"1F486-1F3FB-200D-2640",image:"1f486-1f3fb-200d-2640-fe0f.png",sheet_x:24,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F486-1F3FC-200D-2640-FE0F",non_qualified:"1F486-1F3FC-200D-2640",image:"1f486-1f3fc-200d-2640-fe0f.png",sheet_x:24,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F486-1F3FD-200D-2640-FE0F",non_qualified:"1F486-1F3FD-200D-2640",image:"1f486-1f3fd-200d-2640-fe0f.png",sheet_x:24,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F486-1F3FE-200D-2640-FE0F",non_qualified:"1F486-1F3FE-200D-2640",image:"1f486-1f3fe-200d-2640-fe0f.png",sheet_x:24,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F486-1F3FF-200D-2640-FE0F",non_qualified:"1F486-1F3FF-200D-2640",image:"1f486-1f3ff-200d-2640-fe0f.png",sheet_x:24,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F486",a:"WomanGettingMassage",b:"1F486-200D-2640-FE0F",c:"1F486-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[24,39],o:4,j:["按摩中的女子"]},fire:{a:"Fire",b:"1F525",d:!0,e:!0,f:!0,h:!0,j:["火","热","煮","火焰","hot","cook","flame"],k:[28,8],o:2},syringe:{a:"Syringe",b:"1F489",d:!0,e:!0,f:!0,h:!0,j:["注射器","健康","医院","药物","血","药","针","医生","护士","health","hospital","drugs","blood","medicine","needle","doctor","nurse"],k:[25,19],o:2},"flag-sc":{a:"SeychellesFlag",b:"1F1F8-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[4,3],o:2,j:["塞舌尔国旗"]},large_blue_diamond:{a:"LargeBlueDiamond",b:"1F537",d:!0,e:!0,f:!0,h:!0,j:["大蓝钻石","形状","宝石","宝石","shape","jewel","gem"],k:[28,26],o:2},"flag-sd":{a:"SudanFlag",b:"1F1F8-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[4,4],o:2,j:["苏丹国旗"]},droplet:{a:"Droplet",b:"1F4A7",d:!0,e:!0,f:!0,h:!0,j:["水滴","水","滴","龙头","春天","water","drip","faucet","spring"],k:[25,49],o:2},drop_of_blood:{a:"DropofBlood",b:"1FA78",d:!0,e:!0,f:!0,h:!0,k:[51,55],o:12,j:["血滴"]},haircut:{skin_variations:{"1F3FB":{unified:"1F487-1F3FB",non_qualified:null,image:"1f487-1f3fb.png",sheet_x:25,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F487-1F3FC",non_qualified:null,image:"1f487-1f3fc.png",sheet_x:25,sheet_y:14,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F487-1F3FD",non_qualified:null,image:"1f487-1f3fd.png",sheet_x:25,sheet_y:15,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F487-1F3FE",non_qualified:null,image:"1f487-1f3fe.png",sheet_x:25,sheet_y:16,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F487-1F3FF",non_qualified:null,image:"1f487-1f3ff.png",sheet_x:25,sheet_y:17,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F487-200D-2640-FE0F",a:"Haircut",b:"1F487",d:!0,e:!0,f:!0,h:!1,k:[25,12],o:2,j:["理发中的人"]},ocean:{a:"WaterWave",b:"1F30A",d:!0,e:!0,f:!0,h:!0,j:["波浪","海","水","浪","自然界","海啸","灾难","sea","water","wave","nature","tsunami","disaster"],k:[5,29],o:2},"flag-se":{a:"SwedenFlag",b:"1F1F8-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[4,5],o:2,j:["瑞典国旗"]},"man-getting-haircut":{skin_variations:{"1F3FB":{unified:"1F487-1F3FB-200D-2642-FE0F",non_qualified:"1F487-1F3FB-200D-2642",image:"1f487-1f3fb-200d-2642-fe0f.png",sheet_x:25,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F487-1F3FC-200D-2642-FE0F",non_qualified:"1F487-1F3FC-200D-2642",image:"1f487-1f3fc-200d-2642-fe0f.png",sheet_x:25,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F487-1F3FD-200D-2642-FE0F",non_qualified:"1F487-1F3FD-200D-2642",image:"1f487-1f3fd-200d-2642-fe0f.png",sheet_x:25,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F487-1F3FE-200D-2642-FE0F",non_qualified:"1F487-1F3FE-200D-2642",image:"1f487-1f3fe-200d-2642-fe0f.png",sheet_x:25,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F487-1F3FF-200D-2642-FE0F",non_qualified:"1F487-1F3FF-200D-2642",image:"1f487-1f3ff-200d-2642-fe0f.png",sheet_x:25,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManGettingHaircut",b:"1F487-200D-2642-FE0F",c:"1F487-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[25,6],o:4,j:["理发中的男子"]},small_orange_diamond:{a:"SmallOrangeDiamond",b:"1F538",d:!0,e:!0,f:!0,h:!0,j:["小橙钻石","形状","宝石","宝石","shape","jewel","gem"],k:[28,27],o:2},pill:{a:"Pill",b:"1F48A",d:!0,e:!0,f:!0,h:!0,j:["药丸","健康","药","医生","药房","药","health","medicine","doctor","pharmacy","drug"],k:[25,20],o:2},"woman-getting-haircut":{skin_variations:{"1F3FB":{unified:"1F487-1F3FB-200D-2640-FE0F",non_qualified:"1F487-1F3FB-200D-2640",image:"1f487-1f3fb-200d-2640-fe0f.png",sheet_x:25,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F487-1F3FC-200D-2640-FE0F",non_qualified:"1F487-1F3FC-200D-2640",image:"1f487-1f3fc-200d-2640-fe0f.png",sheet_x:25,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F487-1F3FD-200D-2640-FE0F",non_qualified:"1F487-1F3FD-200D-2640",image:"1f487-1f3fd-200d-2640-fe0f.png",sheet_x:25,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F487-1F3FE-200D-2640-FE0F",non_qualified:"1F487-1F3FE-200D-2640",image:"1f487-1f3fe-200d-2640-fe0f.png",sheet_x:25,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F487-1F3FF-200D-2640-FE0F",non_qualified:"1F487-1F3FF-200D-2640",image:"1f487-1f3ff-200d-2640-fe0f.png",sheet_x:25,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F487",a:"WomanGettingHaircut",b:"1F487-200D-2640-FE0F",c:"1F487-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[25,0],o:4,j:["理发中的女子"]},small_blue_diamond:{a:"SmallBlueDiamond",b:"1F539",d:!0,e:!0,f:!0,h:!0,j:["小蓝钻石","形状","宝石","宝石","shape","jewel","gem"],k:[28,28],o:2},"flag-sg":{a:"SingaporeFlag",b:"1F1F8-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[4,6],o:2,j:["新加坡国旗"]},adhesive_bandage:{a:"AdhesiveBandage",b:"1FA79",d:!0,e:!0,f:!0,h:!0,k:[51,56],o:12,j:["创可贴"]},walking:{skin_variations:{"1F3FB":{unified:"1F6B6-1F3FB",non_qualified:null,image:"1f6b6-1f3fb.png",sheet_x:36,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F6B6-1F3FC",non_qualified:null,image:"1f6b6-1f3fc.png",sheet_x:36,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F6B6-1F3FD",non_qualified:null,image:"1f6b6-1f3fd.png",sheet_x:36,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F6B6-1F3FE",non_qualified:null,image:"1f6b6-1f3fe.png",sheet_x:36,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F6B6-1F3FF",non_qualified:null,image:"1f6b6-1f3ff.png",sheet_x:36,sheet_y:7,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F6B6-200D-2642-FE0F",a:"Pedestrian",b:"1F6B6",d:!0,e:!0,f:!0,h:!1,k:[36,2],o:2,j:["步行的人"]},small_red_triangle:{a:"Up-PointingRedTriangle",b:"1F53A",d:!0,e:!0,f:!0,h:!0,j:["红色三角形朝上","形状","方向","向上","返回页首","shape","direction","up","top"],k:[28,29],o:2},"flag-sh":{a:"St.HelenaFlag",b:"1F1F8-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[4,7],o:2,j:["圣赫勒拿国旗"]},stethoscope:{a:"Stethoscope",b:"1FA7A",d:!0,e:!0,f:!0,h:!0,k:[52,0],o:12,j:["听筒"]},"man-walking":{skin_variations:{"1F3FB":{unified:"1F6B6-1F3FB-200D-2642-FE0F",non_qualified:"1F6B6-1F3FB-200D-2642",image:"1f6b6-1f3fb-200d-2642-fe0f.png",sheet_x:35,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B6-1F3FC-200D-2642-FE0F",non_qualified:"1F6B6-1F3FC-200D-2642",image:"1f6b6-1f3fc-200d-2642-fe0f.png",sheet_x:35,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B6-1F3FD-200D-2642-FE0F",non_qualified:"1F6B6-1F3FD-200D-2642",image:"1f6b6-1f3fd-200d-2642-fe0f.png",sheet_x:35,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B6-1F3FE-200D-2642-FE0F",non_qualified:"1F6B6-1F3FE-200D-2642",image:"1f6b6-1f3fe-200d-2642-fe0f.png",sheet_x:36,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B6-1F3FF-200D-2642-FE0F",non_qualified:"1F6B6-1F3FF-200D-2642",image:"1f6b6-1f3ff-200d-2642-fe0f.png",sheet_x:36,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F6B6",a:"ManWalking",b:"1F6B6-200D-2642-FE0F",c:"1F6B6-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[35,53],o:4,j:["步行的男子"]},"flag-si":{a:"SloveniaFlag",b:"1F1F8-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[4,8],o:2,j:["斯洛文尼亚国旗"]},door:{a:"Door",b:"1F6AA",d:!0,e:!0,f:!0,h:!0,j:["门","房子","进入","退出","house","entry","exit"],k:[35,1],o:2},small_red_triangle_down:{a:"Down-PointingRedTriangle",b:"1F53B",d:!0,e:!0,f:!0,h:!0,j:["红色三角形朝下","形状","方向","底","shape","direction","bottom"],k:[28,30],o:2},"flag-sj":{a:"Svalbard&JanMayenFlag",b:"1F1F8-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[4,9],o:2,j:["斯瓦尔巴和扬马延旗"]},diamond_shape_with_a_dot_inside:{a:"DiamondShapewithaDotInside",b:"1F4A0",d:!0,e:!0,f:!0,h:!0,j:["带有点的钻石","宝石","蓝","宝石","晶体","看中","jewel","blue","gem","crystal","fancy"],k:[25,42],o:2},"woman-walking":{skin_variations:{"1F3FB":{unified:"1F6B6-1F3FB-200D-2640-FE0F",non_qualified:"1F6B6-1F3FB-200D-2640",image:"1f6b6-1f3fb-200d-2640-fe0f.png",sheet_x:35,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B6-1F3FC-200D-2640-FE0F",non_qualified:"1F6B6-1F3FC-200D-2640",image:"1f6b6-1f3fc-200d-2640-fe0f.png",sheet_x:35,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B6-1F3FD-200D-2640-FE0F",non_qualified:"1F6B6-1F3FD-200D-2640",image:"1f6b6-1f3fd-200d-2640-fe0f.png",sheet_x:35,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B6-1F3FE-200D-2640-FE0F",non_qualified:"1F6B6-1F3FE-200D-2640",image:"1f6b6-1f3fe-200d-2640-fe0f.png",sheet_x:35,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B6-1F3FF-200D-2640-FE0F",non_qualified:"1F6B6-1F3FF-200D-2640",image:"1f6b6-1f3ff-200d-2640-fe0f.png",sheet_x:35,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanWalking",b:"1F6B6-200D-2640-FE0F",c:"1F6B6-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[35,47],o:4,j:["步行的女子"]},bed:{a:"Bed",b:"1F6CF-FE0F",c:"1F6CF",d:!0,e:!0,f:!0,h:!0,j:["床","睡","休息","sleep","rest"],k:[36,37],o:2},radio_button:{a:"RadioButton",b:"1F518",d:!0,e:!0,f:!0,h:!0,j:["单选按钮","输入","老","音乐","圈","input","old","music","circle"],k:[27,52],o:2},"flag-sk":{a:"SlovakiaFlag",b:"1F1F8-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[4,10],o:2,j:["斯洛伐克国旗"]},standing_person:{skin_variations:{"1F3FB":{unified:"1F9CD-1F3FB",non_qualified:null,image:"1f9cd-1f3fb.png",sheet_x:44,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CD-1F3FC",non_qualified:null,image:"1f9cd-1f3fc.png",sheet_x:44,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CD-1F3FD",non_qualified:null,image:"1f9cd-1f3fd.png",sheet_x:44,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CD-1F3FE",non_qualified:null,image:"1f9cd-1f3fe.png",sheet_x:44,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CD-1F3FF",non_qualified:null,image:"1f9cd-1f3ff.png",sheet_x:44,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"StandingPerson",b:"1F9CD",d:!0,e:!0,f:!0,h:!0,k:[44,31],o:12,j:["站立的人"]},couch_and_lamp:{a:"CouchandLamp",b:"1F6CB-FE0F",c:"1F6CB",d:!0,e:!0,f:!0,h:!0,j:["沙发和灯","读","寒意","read","chill"],k:[36,28],o:2},man_standing:{skin_variations:{"1F3FB":{unified:"1F9CD-1F3FB-200D-2642-FE0F",non_qualified:"1F9CD-1F3FB-200D-2642",image:"1f9cd-1f3fb-200d-2642-fe0f.png",sheet_x:44,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CD-1F3FC-200D-2642-FE0F",non_qualified:"1F9CD-1F3FC-200D-2642",image:"1f9cd-1f3fc-200d-2642-fe0f.png",sheet_x:44,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CD-1F3FD-200D-2642-FE0F",non_qualified:"1F9CD-1F3FD-200D-2642",image:"1f9cd-1f3fd-200d-2642-fe0f.png",sheet_x:44,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CD-1F3FE-200D-2642-FE0F",non_qualified:"1F9CD-1F3FE-200D-2642",image:"1f9cd-1f3fe-200d-2642-fe0f.png",sheet_x:44,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CD-1F3FF-200D-2642-FE0F",non_qualified:"1F9CD-1F3FF-200D-2642",image:"1f9cd-1f3ff-200d-2642-fe0f.png",sheet_x:44,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManStanding",b:"1F9CD-200D-2642-FE0F",c:"1F9CD-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[44,25],o:12,j:["站立的男子"]},white_square_button:{a:"WhiteSquareButton",b:"1F533",d:!0,e:!0,f:!0,h:!0,j:["白色方形按钮","形状","输入","shape","input"],k:[28,22],o:2},"flag-sl":{a:"SierraLeoneFlag",b:"1F1F8-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[4,11],o:2,j:["塞拉利昂国旗"]},chair:{a:"Chair",b:"1FA91",d:!0,e:!0,f:!0,h:!0,k:[52,5],o:12,j:["椅子"]},toilet:{a:"Toilet",b:"1F6BD",d:!0,e:!0,f:!0,h:!0,j:["马桶","厕所","厕所","盥洗室","浴室","便盆","restroom","wc","washroom","bathroom","potty"],k:[36,14],o:2},black_square_button:{a:"BlackSquareButton",b:"1F532",d:!0,e:!0,f:!0,h:!0,j:["黑色方形按钮","形状","输入","框架","shape","input","frame"],k:[28,21],o:2},"flag-sm":{a:"SanMarinoFlag",b:"1F1F8-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[4,12],o:2,j:["圣马力诺国旗"]},woman_standing:{skin_variations:{"1F3FB":{unified:"1F9CD-1F3FB-200D-2640-FE0F",non_qualified:"1F9CD-1F3FB-200D-2640",image:"1f9cd-1f3fb-200d-2640-fe0f.png",sheet_x:44,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CD-1F3FC-200D-2640-FE0F",non_qualified:"1F9CD-1F3FC-200D-2640",image:"1f9cd-1f3fc-200d-2640-fe0f.png",sheet_x:44,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CD-1F3FD-200D-2640-FE0F",non_qualified:"1F9CD-1F3FD-200D-2640",image:"1f9cd-1f3fd-200d-2640-fe0f.png",sheet_x:44,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CD-1F3FE-200D-2640-FE0F",non_qualified:"1F9CD-1F3FE-200D-2640",image:"1f9cd-1f3fe-200d-2640-fe0f.png",sheet_x:44,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CD-1F3FF-200D-2640-FE0F",non_qualified:"1F9CD-1F3FF-200D-2640",image:"1f9cd-1f3ff-200d-2640-fe0f.png",sheet_x:44,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanStanding",b:"1F9CD-200D-2640-FE0F",c:"1F9CD-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[44,19],o:12,j:["站立的女子"]},kneeling_person:{skin_variations:{"1F3FB":{unified:"1F9CE-1F3FB",non_qualified:null,image:"1f9ce-1f3fb.png",sheet_x:44,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CE-1F3FC",non_qualified:null,image:"1f9ce-1f3fc.png",sheet_x:44,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CE-1F3FD",non_qualified:null,image:"1f9ce-1f3fd.png",sheet_x:44,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CE-1F3FE",non_qualified:null,image:"1f9ce-1f3fe.png",sheet_x:44,sheet_y:53,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CE-1F3FF",non_qualified:null,image:"1f9ce-1f3ff.png",sheet_x:44,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"KneelingPerson",b:"1F9CE",d:!0,e:!0,f:!0,h:!0,k:[44,49],o:12,j:["跪下的人"]},shower:{a:"Shower",b:"1F6BF",d:!0,e:!0,f:!0,h:!0,j:["淋浴","干净","水","浴室","clean","water","bathroom"],k:[36,16],o:2},"flag-sn":{a:"SenegalFlag",b:"1F1F8-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[4,13],o:2,j:["塞内加尔国旗"]},bathtub:{a:"Bathtub",b:"1F6C1",d:!0,e:!0,f:!0,h:!0,j:["浴缸","干净","淋浴","浴室","clean","shower","bathroom"],k:[36,23],o:2},"flag-so":{a:"SomaliaFlag",b:"1F1F8-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[4,14],o:2,j:["索马里亚国旗"]},man_kneeling:{skin_variations:{"1F3FB":{unified:"1F9CE-1F3FB-200D-2642-FE0F",non_qualified:"1F9CE-1F3FB-200D-2642",image:"1f9ce-1f3fb-200d-2642-fe0f.png",sheet_x:44,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CE-1F3FC-200D-2642-FE0F",non_qualified:"1F9CE-1F3FC-200D-2642",image:"1f9ce-1f3fc-200d-2642-fe0f.png",sheet_x:44,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CE-1F3FD-200D-2642-FE0F",non_qualified:"1F9CE-1F3FD-200D-2642",image:"1f9ce-1f3fd-200d-2642-fe0f.png",sheet_x:44,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CE-1F3FE-200D-2642-FE0F",non_qualified:"1F9CE-1F3FE-200D-2642",image:"1f9ce-1f3fe-200d-2642-fe0f.png",sheet_x:44,sheet_y:47,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CE-1F3FF-200D-2642-FE0F",non_qualified:"1F9CE-1F3FF-200D-2642",image:"1f9ce-1f3ff-200d-2642-fe0f.png",sheet_x:44,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManKneeling",b:"1F9CE-200D-2642-FE0F",c:"1F9CE-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[44,43],o:12,j:["跪下的男子"]},"flag-sr":{a:"SurinameFlag",b:"1F1F8-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[4,15],o:2,j:["苏里南国旗"]},woman_kneeling:{skin_variations:{"1F3FB":{unified:"1F9CE-1F3FB-200D-2640-FE0F",non_qualified:"1F9CE-1F3FB-200D-2640",image:"1f9ce-1f3fb-200d-2640-fe0f.png",sheet_x:44,sheet_y:38,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9CE-1F3FC-200D-2640-FE0F",non_qualified:"1F9CE-1F3FC-200D-2640",image:"1f9ce-1f3fc-200d-2640-fe0f.png",sheet_x:44,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9CE-1F3FD-200D-2640-FE0F",non_qualified:"1F9CE-1F3FD-200D-2640",image:"1f9ce-1f3fd-200d-2640-fe0f.png",sheet_x:44,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9CE-1F3FE-200D-2640-FE0F",non_qualified:"1F9CE-1F3FE-200D-2640",image:"1f9ce-1f3fe-200d-2640-fe0f.png",sheet_x:44,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9CE-1F3FF-200D-2640-FE0F",non_qualified:"1F9CE-1F3FF-200D-2640",image:"1f9ce-1f3ff-200d-2640-fe0f.png",sheet_x:44,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanKneeling",b:"1F9CE-200D-2640-FE0F",c:"1F9CE-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[44,37],o:12,j:["跪下的女子"]},razor:{a:"Razor",b:"1FA92",d:!0,e:!0,f:!0,h:!0,k:[52,6],o:12,j:["剃刀"]},person_with_probing_cane:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9af.png",sheet_x:47,sheet_y:8,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9af.png",sheet_x:47,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9af.png",sheet_x:47,sheet_y:10,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9af.png",sheet_x:47,sheet_y:11,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9AF",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9af.png",sheet_x:47,sheet_y:12,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"PersonwithProbingCane",b:"1F9D1-200D-1F9AF",d:!0,e:!1,f:!1,h:!1,k:[47,7],o:12,j:["拄盲杖的人"]},"flag-ss":{a:"SouthSudanFlag",b:"1F1F8-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[4,16],o:2,j:["南苏丹国旗"]},lotion_bottle:{a:"LotionBottle",b:"1F9F4",d:!0,e:!0,f:!0,h:!0,k:[51,39],o:11,j:["乳液"]},"flag-st":{a:"SãoTomé&PríncipeFlag",b:"1F1F8-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[4,17],o:2,j:["圣多美和普林西比国旗"]},safety_pin:{a:"SafetyPin",b:"1F9F7",d:!0,e:!0,f:!0,h:!0,k:[51,42],o:11,j:["安全别针"]},man_with_probing_cane:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9AF",non_qualified:null,image:"1f468-1f3fb-200d-1f9af.png",sheet_x:16,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9AF",non_qualified:null,image:"1f468-1f3fc-200d-1f9af.png",sheet_x:16,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9AF",non_qualified:null,image:"1f468-1f3fd-200d-1f9af.png",sheet_x:16,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9AF",non_qualified:null,image:"1f468-1f3fe-200d-1f9af.png",sheet_x:16,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9AF",non_qualified:null,image:"1f468-1f3ff-200d-1f9af.png",sheet_x:16,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManwithProbingCane",b:"1F468-200D-1F9AF",d:!0,e:!0,f:!0,h:!0,k:[16,17],o:12,j:["男人拿着导盲杆"]},broom:{a:"Broom",b:"1F9F9",d:!0,e:!0,f:!0,h:!0,k:[51,44],o:11,j:["扫帚"]},woman_with_probing_cane:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9AF",non_qualified:null,image:"1f469-1f3fb-200d-1f9af.png",sheet_x:19,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9AF",non_qualified:null,image:"1f469-1f3fc-200d-1f9af.png",sheet_x:19,sheet_y:4,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9AF",non_qualified:null,image:"1f469-1f3fd-200d-1f9af.png",sheet_x:19,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9AF",non_qualified:null,image:"1f469-1f3fe-200d-1f9af.png",sheet_x:19,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9AF",non_qualified:null,image:"1f469-1f3ff-200d-1f9af.png",sheet_x:19,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanwithProbingCane",b:"1F469-200D-1F9AF",d:!0,e:!0,f:!0,h:!0,k:[19,2],o:12,j:["女人拿着导盲杆"]},"flag-sv":{a:"ElSalvadorFlag",b:"1F1F8-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[4,18],o:2,j:["萨尔瓦多国旗"]},"flag-sx":{a:"SintMaartenFlag",b:"1F1F8-1F1FD",d:!0,e:!0,f:!0,h:!0,k:[4,19],o:2,j:["圣马丁岛旗"]},basket:{a:"Basket",b:"1F9FA",d:!0,e:!0,f:!0,h:!0,k:[51,45],o:11,j:["篮子"]},person_in_motorized_wheelchair:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9bc.png",sheet_x:47,sheet_y:38,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9bc.png",sheet_x:47,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9bc.png",sheet_x:47,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9bc.png",sheet_x:47,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9BC",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9bc.png",sheet_x:47,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"PersoninMotorizedWheelchair",b:"1F9D1-200D-1F9BC",d:!0,e:!1,f:!1,h:!1,k:[47,37],o:12,j:["坐电动轮椅的人"]},man_in_motorized_wheelchair:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9BC",non_qualified:null,image:"1f468-1f3fb-200d-1f9bc.png",sheet_x:16,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9BC",non_qualified:null,image:"1f468-1f3fc-200d-1f9bc.png",sheet_x:16,sheet_y:49,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9BC",non_qualified:null,image:"1f468-1f3fd-200d-1f9bc.png",sheet_x:16,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9BC",non_qualified:null,image:"1f468-1f3fe-200d-1f9bc.png",sheet_x:16,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9BC",non_qualified:null,image:"1f468-1f3ff-200d-1f9bc.png",sheet_x:16,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinMotorizedWheelchair",b:"1F468-200D-1F9BC",d:!0,e:!0,f:!0,h:!0,k:[16,47],o:12,j:["男人乘坐电动轮椅"]},"flag-sy":{a:"SyriaFlag",b:"1F1F8-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[4,20],o:2,j:["叙利亚国旗"]},roll_of_paper:{a:"RollofPaper",b:"1F9FB",d:!0,e:!0,f:!0,h:!0,k:[51,46],o:11,j:["卷纸"]},woman_in_motorized_wheelchair:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9BC",non_qualified:null,image:"1f469-1f3fb-200d-1f9bc.png",sheet_x:19,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9BC",non_qualified:null,image:"1f469-1f3fc-200d-1f9bc.png",sheet_x:19,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9BC",non_qualified:null,image:"1f469-1f3fd-200d-1f9bc.png",sheet_x:19,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9BC",non_qualified:null,image:"1f469-1f3fe-200d-1f9bc.png",sheet_x:19,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9BC",non_qualified:null,image:"1f469-1f3ff-200d-1f9bc.png",sheet_x:19,sheet_y:37,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomaninMotorizedWheelchair",b:"1F469-200D-1F9BC",d:!0,e:!0,f:!0,h:!0,k:[19,32],o:12,j:["女人乘坐电动轮椅"]},"flag-sz":{a:"EswatiniFlag",b:"1F1F8-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[4,21],o:2,j:["史瓦帝尼国旗"]},soap:{a:"BarofSoap",b:"1F9FC",d:!0,e:!0,f:!0,h:!0,k:[51,47],o:11,j:["肥皂"]},"flag-ta":{a:"TristanDaCunhaFlag",b:"1F1F9-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[4,22],o:2,j:["特里斯坦-达库尼亚群岛旗"]},sponge:{a:"Sponge",b:"1F9FD",d:!0,e:!0,f:!0,h:!0,k:[51,48],o:11,j:["海绵"]},person_in_manual_wheelchair:{skin_variations:{"1F3FB":{unified:"1F9D1-1F3FB-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3fb-200d-1f9bd.png",sheet_x:47,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FC":{unified:"1F9D1-1F3FC-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3fc-200d-1f9bd.png",sheet_x:47,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FD":{unified:"1F9D1-1F3FD-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3fd-200d-1f9bd.png",sheet_x:47,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FE":{unified:"1F9D1-1F3FE-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3fe-200d-1f9bd.png",sheet_x:47,sheet_y:47,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1},"1F3FF":{unified:"1F9D1-1F3FF-200D-1F9BD",non_qualified:null,image:"1f9d1-1f3ff-200d-1f9bd.png",sheet_x:47,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!1,has_img_facebook:!1}},a:"PersoninManualWheelchair",b:"1F9D1-200D-1F9BD",d:!0,e:!1,f:!1,h:!1,k:[47,43],o:12,j:["坐手动轮椅的人"]},fire_extinguisher:{a:"FireExtinguisher",b:"1F9EF",d:!0,e:!0,f:!0,h:!0,k:[51,34],o:11,j:["灭火器"]},man_in_manual_wheelchair:{skin_variations:{"1F3FB":{unified:"1F468-1F3FB-200D-1F9BD",non_qualified:null,image:"1f468-1f3fb-200d-1f9bd.png",sheet_x:16,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F468-1F3FC-200D-1F9BD",non_qualified:null,image:"1f468-1f3fc-200d-1f9bd.png",sheet_x:16,sheet_y:55,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F468-1F3FD-200D-1F9BD",non_qualified:null,image:"1f468-1f3fd-200d-1f9bd.png",sheet_x:16,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F468-1F3FE-200D-1F9BD",non_qualified:null,image:"1f468-1f3fe-200d-1f9bd.png",sheet_x:17,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F468-1F3FF-200D-1F9BD",non_qualified:null,image:"1f468-1f3ff-200d-1f9bd.png",sheet_x:17,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinManualWheelchair",b:"1F468-200D-1F9BD",d:!0,e:!0,f:!0,h:!0,k:[16,53],o:12,j:["男人推行轮椅"]},"flag-tc":{a:"Turks&CaicosIslandsFlag",b:"1F1F9-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[4,23],o:2,j:["特克斯和凯科斯群岛旗"]},woman_in_manual_wheelchair:{skin_variations:{"1F3FB":{unified:"1F469-1F3FB-200D-1F9BD",non_qualified:null,image:"1f469-1f3fb-200d-1f9bd.png",sheet_x:19,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F469-1F3FC-200D-1F9BD",non_qualified:null,image:"1f469-1f3fc-200d-1f9bd.png",sheet_x:19,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F469-1F3FD-200D-1F9BD",non_qualified:null,image:"1f469-1f3fd-200d-1f9bd.png",sheet_x:19,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F469-1F3FE-200D-1F9BD",non_qualified:null,image:"1f469-1f3fe-200d-1f9bd.png",sheet_x:19,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F469-1F3FF-200D-1F9BD",non_qualified:null,image:"1f469-1f3ff-200d-1f9bd.png",sheet_x:19,sheet_y:43,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomaninManualWheelchair",b:"1F469-200D-1F9BD",d:!0,e:!0,f:!0,h:!0,k:[19,38],o:12,j:["女人推行轮椅"]},"flag-td":{a:"ChadFlag",b:"1F1F9-1F1E9",d:!0,e:!0,f:!0,h:!0,k:[4,24],o:2,j:["乍得国旗"]},shopping_trolley:{a:"ShoppingTrolley",b:"1F6D2",d:!0,e:!0,f:!0,h:!0,k:[36,40],o:4,j:["购物车"]},runner:{skin_variations:{"1F3FB":{unified:"1F3C3-1F3FB",non_qualified:null,image:"1f3c3-1f3fb.png",sheet_x:9,sheet_y:2,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3C3-1F3FC",non_qualified:null,image:"1f3c3-1f3fc.png",sheet_x:9,sheet_y:3,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3C3-1F3FD",non_qualified:null,image:"1f3c3-1f3fd.png",sheet_x:9,sheet_y:4,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3C3-1F3FE",non_qualified:null,image:"1f3c3-1f3fe.png",sheet_x:9,sheet_y:5,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3C3-1F3FF",non_qualified:null,image:"1f3c3-1f3ff.png",sheet_x:9,sheet_y:6,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3C3-200D-2642-FE0F",a:"Runner",b:"1F3C3",d:!0,e:!0,f:!0,h:!1,k:[9,1],n:["running"],o:2,j:["奔跑的男人"]},"flag-tf":{a:"FrenchSouthernTerritoriesFlag",b:"1F1F9-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[4,25],o:2,j:["法属南部和南极领地旗"]},smoking:{a:"SmokingSymbol",b:"1F6AC",d:!0,e:!0,f:!0,h:!0,j:["香烟","杀死","烟草","香烟","关节","烟","kills","tobacco","cigarette","joint","smoke"],k:[35,3],o:2},coffin:{a:"Coffin",b:"26B0-FE0F",c:"26B0",d:!0,e:!0,f:!0,h:!0,j:["棺材","吸血鬼","死","这","死亡","把","墓地","墓地","棺材","葬礼","箱","vampire","dead","die","death","rip","graveyard","cemetery","casket","funeral","box"],k:[53,54],o:2},"man-running":{skin_variations:{"1F3FB":{unified:"1F3C3-1F3FB-200D-2642-FE0F",non_qualified:"1F3C3-1F3FB-200D-2642",image:"1f3c3-1f3fb-200d-2642-fe0f.png",sheet_x:8,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C3-1F3FC-200D-2642-FE0F",non_qualified:"1F3C3-1F3FC-200D-2642",image:"1f3c3-1f3fc-200d-2642-fe0f.png",sheet_x:8,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C3-1F3FD-200D-2642-FE0F",non_qualified:"1F3C3-1F3FD-200D-2642",image:"1f3c3-1f3fd-200d-2642-fe0f.png",sheet_x:8,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C3-1F3FE-200D-2642-FE0F",non_qualified:"1F3C3-1F3FE-200D-2642",image:"1f3c3-1f3fe-200d-2642-fe0f.png",sheet_x:8,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C3-1F3FF-200D-2642-FE0F",non_qualified:"1F3C3-1F3FF-200D-2642",image:"1f3c3-1f3ff-200d-2642-fe0f.png",sheet_x:9,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3C3",a:"ManRunning",b:"1F3C3-200D-2642-FE0F",c:"1F3C3-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[8,52],o:4,j:["奔跑的男人"]},"flag-tg":{a:"TogoFlag",b:"1F1F9-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[4,26],o:2,j:["多哥国旗"]},"woman-running":{skin_variations:{"1F3FB":{unified:"1F3C3-1F3FB-200D-2640-FE0F",non_qualified:"1F3C3-1F3FB-200D-2640",image:"1f3c3-1f3fb-200d-2640-fe0f.png",sheet_x:8,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C3-1F3FC-200D-2640-FE0F",non_qualified:"1F3C3-1F3FC-200D-2640",image:"1f3c3-1f3fc-200d-2640-fe0f.png",sheet_x:8,sheet_y:48,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C3-1F3FD-200D-2640-FE0F",non_qualified:"1F3C3-1F3FD-200D-2640",image:"1f3c3-1f3fd-200d-2640-fe0f.png",sheet_x:8,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C3-1F3FE-200D-2640-FE0F",non_qualified:"1F3C3-1F3FE-200D-2640",image:"1f3c3-1f3fe-200d-2640-fe0f.png",sheet_x:8,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C3-1F3FF-200D-2640-FE0F",non_qualified:"1F3C3-1F3FF-200D-2640",image:"1f3c3-1f3ff-200d-2640-fe0f.png",sheet_x:8,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanRunning",b:"1F3C3-200D-2640-FE0F",c:"1F3C3-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[8,46],o:4,j:["女人跑步"]},funeral_urn:{a:"FuneralUrn",b:"26B1-FE0F",c:"26B1",d:!0,e:!0,f:!0,h:!0,j:["骨灰盒","死","这","死亡","把","灰烬","dead","die","death","rip","ashes"],k:[53,55],o:2},"flag-th":{a:"ThailandFlag",b:"1F1F9-1F1ED",d:!0,e:!0,f:!0,h:!0,k:[4,27],o:2,j:["泰国国旗"]},moyai:{a:"Moyai",b:"1F5FF",d:!0,e:!0,f:!0,h:!0,j:["摩艾石像","岩石","伊斯特岛","摩艾","rock","easterisland","moai"],k:[30,34],o:2},"flag-tj":{a:"TajikistanFlag",b:"1F1F9-1F1EF",d:!0,e:!0,f:!0,h:!0,k:[4,28],o:2,j:["塔吉克斯坦国旗"]},dancer:{skin_variations:{"1F3FB":{unified:"1F483-1F3FB",non_qualified:null,image:"1f483-1f3fb.png",sheet_x:24,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F483-1F3FC",non_qualified:null,image:"1f483-1f3fc.png",sheet_x:24,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F483-1F3FD",non_qualified:null,image:"1f483-1f3fd.png",sheet_x:24,sheet_y:29,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F483-1F3FE",non_qualified:null,image:"1f483-1f3fe.png",sheet_x:24,sheet_y:30,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F483-1F3FF",non_qualified:null,image:"1f483-1f3ff.png",sheet_x:24,sheet_y:31,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Dancer",b:"1F483",d:!0,e:!0,f:!0,h:!0,j:["女子跳舞","女性","女孩","女人","乐趣","female","girl","woman","fun"],k:[24,26],o:2},"flag-tk":{a:"TokelauFlag",b:"1F1F9-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[4,29],o:2,j:["托克劳国旗"]},man_dancing:{skin_variations:{"1F3FB":{unified:"1F57A-1F3FB",non_qualified:null,image:"1f57a-1f3fb.png",sheet_x:29,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F57A-1F3FC",non_qualified:null,image:"1f57a-1f3fc.png",sheet_x:29,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F57A-1F3FD",non_qualified:null,image:"1f57a-1f3fd.png",sheet_x:29,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F57A-1F3FE",non_qualified:null,image:"1f57a-1f3fe.png",sheet_x:29,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F57A-1F3FF",non_qualified:null,image:"1f57a-1f3ff.png",sheet_x:29,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManDancing",b:"1F57A",d:!0,e:!0,f:!0,h:!0,j:["男人跳舞","雄","男孩","乐趣","舞蹈家","male","boy","fun","dancer"],k:[29,37],o:4},"flag-tl":{a:"Timor-LesteFlag",b:"1F1F9-1F1F1",d:!0,e:!0,f:!0,h:!0,k:[4,30],o:2,j:["东帝汶国旗"]},man_in_business_suit_levitating:{skin_variations:{"1F3FB":{unified:"1F574-1F3FB",non_qualified:null,image:"1f574-1f3fb.png",sheet_x:29,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F574-1F3FC",non_qualified:null,image:"1f574-1f3fc.png",sheet_x:29,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F574-1F3FD",non_qualified:null,image:"1f574-1f3fd.png",sheet_x:29,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F574-1F3FE",non_qualified:null,image:"1f574-1f3fe.png",sheet_x:29,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F574-1F3FF",non_qualified:null,image:"1f574-1f3ff.png",sheet_x:29,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinBusinessSuitLevitating",b:"1F574-FE0F",c:"1F574",d:!0,e:!0,f:!0,h:!0,k:[29,9],o:2,j:["穿西装的人漂浮"]},"flag-tm":{a:"TurkmenistanFlag",b:"1F1F9-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[4,31],o:2,j:["土库曼斯坦国旗"]},dancers:{obsoleted_by:"1F46F-200D-2640-FE0F",a:"WomanwithBunnyEars",b:"1F46F",d:!0,e:!0,f:!0,h:!0,k:[22,0],o:2,j:["兔子人"]},"man-with-bunny-ears-partying":{a:"ManwithBunnyEarsPartying",b:"1F46F-200D-2642-FE0F",c:"1F46F-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[21,56],o:4,j:["兔男郎"]},"flag-tn":{a:"TunisiaFlag",b:"1F1F9-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[4,32],o:2,j:["突尼西亚国旗"]},"flag-to":{a:"TongaFlag",b:"1F1F9-1F1F4",d:!0,e:!0,f:!0,h:!0,k:[4,33],o:2,j:["汤加国旗"]},"woman-with-bunny-ears-partying":{obsoletes:"1F46F",a:"WomanwithBunnyEarsPartying",b:"1F46F-200D-2640-FE0F",c:"1F46F-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[21,55],o:4,j:["兔女郎"]},"flag-tr":{a:"TurkeyFlag",b:"1F1F9-1F1F7",d:!0,e:!0,f:!0,h:!0,k:[4,34],o:2,j:["土耳其国旗"]},person_in_steamy_room:{skin_variations:{"1F3FB":{unified:"1F9D6-1F3FB",non_qualified:null,image:"1f9d6-1f3fb.png",sheet_x:48,sheet_y:53,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FB-200D-2642-FE0F"},"1F3FC":{unified:"1F9D6-1F3FC",non_qualified:null,image:"1f9d6-1f3fc.png",sheet_x:48,sheet_y:54,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FC-200D-2642-FE0F"},"1F3FD":{unified:"1F9D6-1F3FD",non_qualified:null,image:"1f9d6-1f3fd.png",sheet_x:48,sheet_y:55,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FD-200D-2642-FE0F"},"1F3FE":{unified:"1F9D6-1F3FE",non_qualified:null,image:"1f9d6-1f3fe.png",sheet_x:48,sheet_y:56,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FE-200D-2642-FE0F"},"1F3FF":{unified:"1F9D6-1F3FF",non_qualified:null,image:"1f9d6-1f3ff.png",sheet_x:49,sheet_y:0,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D6-1F3FF-200D-2642-FE0F"}},obsoleted_by:"1F9D6-200D-2642-FE0F",a:"PersoninSteamyRoom",b:"1F9D6",d:!0,e:!0,f:!0,h:!0,k:[48,52],o:5,j:["蒸汽房内的人"]},man_in_steamy_room:{skin_variations:{"1F3FB":{unified:"1F9D6-1F3FB-200D-2642-FE0F",non_qualified:"1F9D6-1F3FB-200D-2642",image:"1f9d6-1f3fb-200d-2642-fe0f.png",sheet_x:48,sheet_y:47,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FB"},"1F3FC":{unified:"1F9D6-1F3FC-200D-2642-FE0F",non_qualified:"1F9D6-1F3FC-200D-2642",image:"1f9d6-1f3fc-200d-2642-fe0f.png",sheet_x:48,sheet_y:48,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FC"},"1F3FD":{unified:"1F9D6-1F3FD-200D-2642-FE0F",non_qualified:"1F9D6-1F3FD-200D-2642",image:"1f9d6-1f3fd-200d-2642-fe0f.png",sheet_x:48,sheet_y:49,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FD"},"1F3FE":{unified:"1F9D6-1F3FE-200D-2642-FE0F",non_qualified:"1F9D6-1F3FE-200D-2642",image:"1f9d6-1f3fe-200d-2642-fe0f.png",sheet_x:48,sheet_y:50,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FE"},"1F3FF":{unified:"1F9D6-1F3FF-200D-2642-FE0F",non_qualified:"1F9D6-1F3FF-200D-2642",image:"1f9d6-1f3ff-200d-2642-fe0f.png",sheet_x:48,sheet_y:51,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D6-1F3FF"}},obsoletes:"1F9D6",a:"ManinSteamyRoom",b:"1F9D6-200D-2642-FE0F",c:"1F9D6-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[48,46],o:5,j:["蒸汽房内的男人"]},"flag-tt":{a:"Trinidad&TobagoFlag",b:"1F1F9-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[4,35],o:2,j:["特立尼达和多巴哥国旗"]},woman_in_steamy_room:{skin_variations:{"1F3FB":{unified:"1F9D6-1F3FB-200D-2640-FE0F",non_qualified:"1F9D6-1F3FB-200D-2640",image:"1f9d6-1f3fb-200d-2640-fe0f.png",sheet_x:48,sheet_y:41,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D6-1F3FC-200D-2640-FE0F",non_qualified:"1F9D6-1F3FC-200D-2640",image:"1f9d6-1f3fc-200d-2640-fe0f.png",sheet_x:48,sheet_y:42,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D6-1F3FD-200D-2640-FE0F",non_qualified:"1F9D6-1F3FD-200D-2640",image:"1f9d6-1f3fd-200d-2640-fe0f.png",sheet_x:48,sheet_y:43,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D6-1F3FE-200D-2640-FE0F",non_qualified:"1F9D6-1F3FE-200D-2640",image:"1f9d6-1f3fe-200d-2640-fe0f.png",sheet_x:48,sheet_y:44,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D6-1F3FF-200D-2640-FE0F",non_qualified:"1F9D6-1F3FF-200D-2640",image:"1f9d6-1f3ff-200d-2640-fe0f.png",sheet_x:48,sheet_y:45,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomaninSteamyRoom",b:"1F9D6-200D-2640-FE0F",c:"1F9D6-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[48,40],o:5,j:["蒸汽房内的女人"]},"flag-tv":{a:"TuvaluFlag",b:"1F1F9-1F1FB",d:!0,e:!0,f:!0,h:!0,k:[4,36],o:2,j:["图瓦卢国旗"]},person_climbing:{skin_variations:{"1F3FB":{unified:"1F9D7-1F3FB",non_qualified:null,image:"1f9d7-1f3fb.png",sheet_x:49,sheet_y:14,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9D7-1F3FC",non_qualified:null,image:"1f9d7-1f3fc.png",sheet_x:49,sheet_y:15,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9D7-1F3FD",non_qualified:null,image:"1f9d7-1f3fd.png",sheet_x:49,sheet_y:16,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9D7-1F3FE",non_qualified:null,image:"1f9d7-1f3fe.png",sheet_x:49,sheet_y:17,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9D7-1F3FF",non_qualified:null,image:"1f9d7-1f3ff.png",sheet_x:49,sheet_y:18,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D7-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9D7-200D-2640-FE0F",a:"PersonClimbing",b:"1F9D7",d:!0,e:!0,f:!0,h:!0,k:[49,13],o:5,j:["攀岩的人"]},man_climbing:{skin_variations:{"1F3FB":{unified:"1F9D7-1F3FB-200D-2642-FE0F",non_qualified:"1F9D7-1F3FB-200D-2642",image:"1f9d7-1f3fb-200d-2642-fe0f.png",sheet_x:49,sheet_y:8,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D7-1F3FC-200D-2642-FE0F",non_qualified:"1F9D7-1F3FC-200D-2642",image:"1f9d7-1f3fc-200d-2642-fe0f.png",sheet_x:49,sheet_y:9,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D7-1F3FD-200D-2642-FE0F",non_qualified:"1F9D7-1F3FD-200D-2642",image:"1f9d7-1f3fd-200d-2642-fe0f.png",sheet_x:49,sheet_y:10,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D7-1F3FE-200D-2642-FE0F",non_qualified:"1F9D7-1F3FE-200D-2642",image:"1f9d7-1f3fe-200d-2642-fe0f.png",sheet_x:49,sheet_y:11,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D7-1F3FF-200D-2642-FE0F",non_qualified:"1F9D7-1F3FF-200D-2642",image:"1f9d7-1f3ff-200d-2642-fe0f.png",sheet_x:49,sheet_y:12,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManClimbing",b:"1F9D7-200D-2642-FE0F",c:"1F9D7-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[49,7],o:5,j:["男子攀岩"]},"flag-tz":{a:"TanzaniaFlag",b:"1F1F9-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[4,38],o:2,j:["坦桑尼亚国旗"]},"flag-ua":{a:"UkraineFlag",b:"1F1FA-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[4,39],o:2,j:["乌克兰国旗"]},woman_climbing:{skin_variations:{"1F3FB":{unified:"1F9D7-1F3FB-200D-2640-FE0F",non_qualified:"1F9D7-1F3FB-200D-2640",image:"1f9d7-1f3fb-200d-2640-fe0f.png",sheet_x:49,sheet_y:2,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FB"},"1F3FC":{unified:"1F9D7-1F3FC-200D-2640-FE0F",non_qualified:"1F9D7-1F3FC-200D-2640",image:"1f9d7-1f3fc-200d-2640-fe0f.png",sheet_x:49,sheet_y:3,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FC"},"1F3FD":{unified:"1F9D7-1F3FD-200D-2640-FE0F",non_qualified:"1F9D7-1F3FD-200D-2640",image:"1f9d7-1f3fd-200d-2640-fe0f.png",sheet_x:49,sheet_y:4,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FD"},"1F3FE":{unified:"1F9D7-1F3FE-200D-2640-FE0F",non_qualified:"1F9D7-1F3FE-200D-2640",image:"1f9d7-1f3fe-200d-2640-fe0f.png",sheet_x:49,sheet_y:5,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FE"},"1F3FF":{unified:"1F9D7-1F3FF-200D-2640-FE0F",non_qualified:"1F9D7-1F3FF-200D-2640",image:"1f9d7-1f3ff-200d-2640-fe0f.png",sheet_x:49,sheet_y:6,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D7-1F3FF"}},obsoletes:"1F9D7",a:"WomanClimbing",b:"1F9D7-200D-2640-FE0F",c:"1F9D7-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[49,1],o:5,j:["女子攀岩"]},"flag-ug":{a:"UgandaFlag",b:"1F1FA-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[4,40],o:2,j:["乌干达国旗"]},fencer:{a:"Fencer",b:"1F93A",d:!0,e:!0,f:!0,h:!0,k:[40,32],o:4,j:["西洋剑"]},"flag-um":{a:"U.s.OutlyingIslandsFlag",b:"1F1FA-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[4,41],o:2,j:["美国离岛旗子"]},horse_racing:{skin_variations:{"1F3FB":{unified:"1F3C7-1F3FB",non_qualified:null,image:"1f3c7-1f3fb.png",sheet_x:9,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C7-1F3FC",non_qualified:null,image:"1f3c7-1f3fc.png",sheet_x:9,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C7-1F3FD",non_qualified:null,image:"1f3c7-1f3fd.png",sheet_x:9,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C7-1F3FE",non_qualified:null,image:"1f3c7-1f3fe.png",sheet_x:9,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C7-1F3FF",non_qualified:null,image:"1f3c7-1f3ff.png",sheet_x:9,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"HorseRacing",b:"1F3C7",d:!0,e:!0,f:!0,h:!0,j:["赛马","动物","博彩","竞争","赌博","运气","animal","betting","competition","gambling","luck"],k:[9,27],o:2},skier:{a:"Skier",b:"26F7-FE0F",c:"26F7",d:!0,e:!0,f:!0,h:!0,j:["滑雪的人","体育","冬","雪","sports","winter","snow"],k:[54,17],o:2},"flag-un":{a:"UnitedNationsFlag",b:"1F1FA-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[4,42],o:4,j:["联合国旗"]},us:{a:"UnitedStatesFlag",b:"1F1FA-1F1F8",d:!0,e:!0,f:!0,h:!0,j:["美国国旗","联合","国家","美洲","旗","国家","国家","旗帜","united","states","america","flag","nation","country","banner"],k:[4,43],n:["flag-us"],o:2},snowboarder:{skin_variations:{"1F3FB":{unified:"1F3C2-1F3FB",non_qualified:null,image:"1f3c2-1f3fb.png",sheet_x:8,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C2-1F3FC",non_qualified:null,image:"1f3c2-1f3fc.png",sheet_x:8,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C2-1F3FD",non_qualified:null,image:"1f3c2-1f3fd.png",sheet_x:8,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C2-1F3FE",non_qualified:null,image:"1f3c2-1f3fe.png",sheet_x:8,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C2-1F3FF",non_qualified:null,image:"1f3c2-1f3ff.png",sheet_x:8,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Snowboarder",b:"1F3C2",d:!0,e:!0,f:!0,h:!0,j:["滑雪的人","体育","冬","sports","winter"],k:[8,40],o:2},golfer:{skin_variations:{"1F3FB":{unified:"1F3CC-1F3FB",non_qualified:null,image:"1f3cc-1f3fb.png",sheet_x:10,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3CC-1F3FC",non_qualified:null,image:"1f3cc-1f3fc.png",sheet_x:10,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3CC-1F3FD",non_qualified:null,image:"1f3cc-1f3fd.png",sheet_x:10,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3CC-1F3FE",non_qualified:null,image:"1f3cc-1f3fe.png",sheet_x:10,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3CC-1F3FF",non_qualified:null,image:"1f3cc-1f3ff.png",sheet_x:10,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3CC-FE0F-200D-2642-FE0F",a:"Golfer",b:"1F3CC-FE0F",c:"1F3CC",d:!0,e:!0,f:!0,h:!1,k:[10,26],o:2,j:["打高尔夫球的人"]},"flag-uy":{a:"UruguayFlag",b:"1F1FA-1F1FE",d:!0,e:!0,f:!0,h:!0,k:[4,44],o:2,j:["乌拉圭国旗"]},"flag-uz":{a:"UzbekistanFlag",b:"1F1FA-1F1FF",d:!0,e:!0,f:!0,h:!0,k:[4,45],o:2,j:["乌兹别克斯坦"]},"man-golfing":{skin_variations:{"1F3FB":{unified:"1F3CC-1F3FB-200D-2642-FE0F",non_qualified:"1F3CC-1F3FB-200D-2642",image:"1f3cc-1f3fb-200d-2642-fe0f.png",sheet_x:10,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CC-1F3FC-200D-2642-FE0F",non_qualified:"1F3CC-1F3FC-200D-2642",image:"1f3cc-1f3fc-200d-2642-fe0f.png",sheet_x:10,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CC-1F3FD-200D-2642-FE0F",non_qualified:"1F3CC-1F3FD-200D-2642",image:"1f3cc-1f3fd-200d-2642-fe0f.png",sheet_x:10,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CC-1F3FE-200D-2642-FE0F",non_qualified:"1F3CC-1F3FE-200D-2642",image:"1f3cc-1f3fe-200d-2642-fe0f.png",sheet_x:10,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CC-1F3FF-200D-2642-FE0F",non_qualified:"1F3CC-1F3FF-200D-2642",image:"1f3cc-1f3ff-200d-2642-fe0f.png",sheet_x:10,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3CC-FE0F",a:"ManGolfing",b:"1F3CC-FE0F-200D-2642-FE0F",d:!0,e:!0,f:!0,h:!1,k:[10,20],o:4,j:["男子高尔夫"]},"flag-va":{a:"VaticanCityFlag",b:"1F1FB-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[4,46],o:2,j:["梵蒂冈"]},"woman-golfing":{skin_variations:{"1F3FB":{unified:"1F3CC-1F3FB-200D-2640-FE0F",non_qualified:"1F3CC-1F3FB-200D-2640",image:"1f3cc-1f3fb-200d-2640-fe0f.png",sheet_x:10,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CC-1F3FC-200D-2640-FE0F",non_qualified:"1F3CC-1F3FC-200D-2640",image:"1f3cc-1f3fc-200d-2640-fe0f.png",sheet_x:10,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CC-1F3FD-200D-2640-FE0F",non_qualified:"1F3CC-1F3FD-200D-2640",image:"1f3cc-1f3fd-200d-2640-fe0f.png",sheet_x:10,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CC-1F3FE-200D-2640-FE0F",non_qualified:"1F3CC-1F3FE-200D-2640",image:"1f3cc-1f3fe-200d-2640-fe0f.png",sheet_x:10,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CC-1F3FF-200D-2640-FE0F",non_qualified:"1F3CC-1F3FF-200D-2640",image:"1f3cc-1f3ff-200d-2640-fe0f.png",sheet_x:10,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanGolfing",b:"1F3CC-FE0F-200D-2640-FE0F",d:!0,e:!0,f:!0,h:!1,k:[10,14],o:4,j:["女子高尔夫"]},"flag-vc":{a:"St.Vincent&GrenadinesFlag",b:"1F1FB-1F1E8",d:!0,e:!0,f:!0,h:!0,k:[4,47],o:2,j:["圣文森特和格林纳丁斯"]},surfer:{skin_variations:{"1F3FB":{unified:"1F3C4-1F3FB",non_qualified:null,image:"1f3c4-1f3fb.png",sheet_x:9,sheet_y:20,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3C4-1F3FC",non_qualified:null,image:"1f3c4-1f3fc.png",sheet_x:9,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3C4-1F3FD",non_qualified:null,image:"1f3c4-1f3fd.png",sheet_x:9,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3C4-1F3FE",non_qualified:null,image:"1f3c4-1f3fe.png",sheet_x:9,sheet_y:23,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3C4-1F3FF",non_qualified:null,image:"1f3c4-1f3ff.png",sheet_x:9,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3C4-200D-2642-FE0F",a:"Surfer",b:"1F3C4",d:!0,e:!0,f:!0,h:!1,k:[9,19],o:2,j:["冲浪男"]},"man-surfing":{skin_variations:{"1F3FB":{unified:"1F3C4-1F3FB-200D-2642-FE0F",non_qualified:"1F3C4-1F3FB-200D-2642",image:"1f3c4-1f3fb-200d-2642-fe0f.png",sheet_x:9,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C4-1F3FC-200D-2642-FE0F",non_qualified:"1F3C4-1F3FC-200D-2642",image:"1f3c4-1f3fc-200d-2642-fe0f.png",sheet_x:9,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C4-1F3FD-200D-2642-FE0F",non_qualified:"1F3C4-1F3FD-200D-2642",image:"1f3c4-1f3fd-200d-2642-fe0f.png",sheet_x:9,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C4-1F3FE-200D-2642-FE0F",non_qualified:"1F3C4-1F3FE-200D-2642",image:"1f3c4-1f3fe-200d-2642-fe0f.png",sheet_x:9,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C4-1F3FF-200D-2642-FE0F",non_qualified:"1F3C4-1F3FF-200D-2642",image:"1f3c4-1f3ff-200d-2642-fe0f.png",sheet_x:9,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3C4",a:"ManSurfing",b:"1F3C4-200D-2642-FE0F",c:"1F3C4-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[9,13],o:4,j:["男子冲浪"]},"flag-ve":{a:"VenezuelaFlag",b:"1F1FB-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[4,48],o:2,j:["委内瑞拉"]},"flag-vg":{a:"BritishVirginIslandsFlag",b:"1F1FB-1F1EC",d:!0,e:!0,f:!0,h:!0,k:[4,49],o:2,j:["英属维尔京群岛"]},"woman-surfing":{skin_variations:{"1F3FB":{unified:"1F3C4-1F3FB-200D-2640-FE0F",non_qualified:"1F3C4-1F3FB-200D-2640",image:"1f3c4-1f3fb-200d-2640-fe0f.png",sheet_x:9,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3C4-1F3FC-200D-2640-FE0F",non_qualified:"1F3C4-1F3FC-200D-2640",image:"1f3c4-1f3fc-200d-2640-fe0f.png",sheet_x:9,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3C4-1F3FD-200D-2640-FE0F",non_qualified:"1F3C4-1F3FD-200D-2640",image:"1f3c4-1f3fd-200d-2640-fe0f.png",sheet_x:9,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3C4-1F3FE-200D-2640-FE0F",non_qualified:"1F3C4-1F3FE-200D-2640",image:"1f3c4-1f3fe-200d-2640-fe0f.png",sheet_x:9,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3C4-1F3FF-200D-2640-FE0F",non_qualified:"1F3C4-1F3FF-200D-2640",image:"1f3c4-1f3ff-200d-2640-fe0f.png",sheet_x:9,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanSurfing",b:"1F3C4-200D-2640-FE0F",c:"1F3C4-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[9,7],o:4,j:["女子冲浪"]},rowboat:{skin_variations:{"1F3FB":{unified:"1F6A3-1F3FB",non_qualified:null,image:"1f6a3-1f3fb.png",sheet_x:34,sheet_y:47,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F6A3-1F3FC",non_qualified:null,image:"1f6a3-1f3fc.png",sheet_x:34,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F6A3-1F3FD",non_qualified:null,image:"1f6a3-1f3fd.png",sheet_x:34,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F6A3-1F3FE",non_qualified:null,image:"1f6a3-1f3fe.png",sheet_x:34,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F6A3-1F3FF",non_qualified:null,image:"1f6a3-1f3ff.png",sheet_x:34,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F6A3-200D-2642-FE0F",a:"Rowboat",b:"1F6A3",d:!0,e:!0,f:!0,h:!1,k:[34,46],o:2,j:["划船的人"]},"flag-vi":{a:"U.s.VirginIslandsFlag",b:"1F1FB-1F1EE",d:!0,e:!0,f:!0,h:!0,k:[4,50],o:2,j:["美属维尔京群岛"]},"man-rowing-boat":{skin_variations:{"1F3FB":{unified:"1F6A3-1F3FB-200D-2642-FE0F",non_qualified:"1F6A3-1F3FB-200D-2642",image:"1f6a3-1f3fb-200d-2642-fe0f.png",sheet_x:34,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6A3-1F3FC-200D-2642-FE0F",non_qualified:"1F6A3-1F3FC-200D-2642",image:"1f6a3-1f3fc-200d-2642-fe0f.png",sheet_x:34,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6A3-1F3FD-200D-2642-FE0F",non_qualified:"1F6A3-1F3FD-200D-2642",image:"1f6a3-1f3fd-200d-2642-fe0f.png",sheet_x:34,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6A3-1F3FE-200D-2642-FE0F",non_qualified:"1F6A3-1F3FE-200D-2642",image:"1f6a3-1f3fe-200d-2642-fe0f.png",sheet_x:34,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6A3-1F3FF-200D-2642-FE0F",non_qualified:"1F6A3-1F3FF-200D-2642",image:"1f6a3-1f3ff-200d-2642-fe0f.png",sheet_x:34,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F6A3",a:"ManRowingBoat",b:"1F6A3-200D-2642-FE0F",c:"1F6A3-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[34,40],o:4,j:["男子划船"]},"flag-vn":{a:"VietnamFlag",b:"1F1FB-1F1F3",d:!0,e:!0,f:!0,h:!0,k:[4,51],o:2,j:["越南"]},"flag-vu":{a:"VanuatuFlag",b:"1F1FB-1F1FA",d:!0,e:!0,f:!0,h:!0,k:[4,52],o:2,j:["瓦努阿图"]},"woman-rowing-boat":{skin_variations:{"1F3FB":{unified:"1F6A3-1F3FB-200D-2640-FE0F",non_qualified:"1F6A3-1F3FB-200D-2640",image:"1f6a3-1f3fb-200d-2640-fe0f.png",sheet_x:34,sheet_y:35,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6A3-1F3FC-200D-2640-FE0F",non_qualified:"1F6A3-1F3FC-200D-2640",image:"1f6a3-1f3fc-200d-2640-fe0f.png",sheet_x:34,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6A3-1F3FD-200D-2640-FE0F",non_qualified:"1F6A3-1F3FD-200D-2640",image:"1f6a3-1f3fd-200d-2640-fe0f.png",sheet_x:34,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6A3-1F3FE-200D-2640-FE0F",non_qualified:"1F6A3-1F3FE-200D-2640",image:"1f6a3-1f3fe-200d-2640-fe0f.png",sheet_x:34,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6A3-1F3FF-200D-2640-FE0F",non_qualified:"1F6A3-1F3FF-200D-2640",image:"1f6a3-1f3ff-200d-2640-fe0f.png",sheet_x:34,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanRowingBoat",b:"1F6A3-200D-2640-FE0F",c:"1F6A3-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[34,34],o:4,j:["女子划船"]},swimmer:{skin_variations:{"1F3FB":{unified:"1F3CA-1F3FB",non_qualified:null,image:"1f3ca-1f3fb.png",sheet_x:9,sheet_y:48,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3CA-1F3FC",non_qualified:null,image:"1f3ca-1f3fc.png",sheet_x:9,sheet_y:49,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3CA-1F3FD",non_qualified:null,image:"1f3ca-1f3fd.png",sheet_x:9,sheet_y:50,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3CA-1F3FE",non_qualified:null,image:"1f3ca-1f3fe.png",sheet_x:9,sheet_y:51,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3CA-1F3FF",non_qualified:null,image:"1f3ca-1f3ff.png",sheet_x:9,sheet_y:52,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3CA-200D-2642-FE0F",a:"Swimmer",b:"1F3CA",d:!0,e:!0,f:!0,h:!1,k:[9,47],o:2,j:["游泳的人"]},"flag-wf":{a:"Wallis&FutunaFlag",b:"1F1FC-1F1EB",d:!0,e:!0,f:!0,h:!0,k:[4,53],o:2,j:["瓦利斯和富图纳"]},"man-swimming":{skin_variations:{"1F3FB":{unified:"1F3CA-1F3FB-200D-2642-FE0F",non_qualified:"1F3CA-1F3FB-200D-2642",image:"1f3ca-1f3fb-200d-2642-fe0f.png",sheet_x:9,sheet_y:42,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CA-1F3FC-200D-2642-FE0F",non_qualified:"1F3CA-1F3FC-200D-2642",image:"1f3ca-1f3fc-200d-2642-fe0f.png",sheet_x:9,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CA-1F3FD-200D-2642-FE0F",non_qualified:"1F3CA-1F3FD-200D-2642",image:"1f3ca-1f3fd-200d-2642-fe0f.png",sheet_x:9,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CA-1F3FE-200D-2642-FE0F",non_qualified:"1F3CA-1F3FE-200D-2642",image:"1f3ca-1f3fe-200d-2642-fe0f.png",sheet_x:9,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CA-1F3FF-200D-2642-FE0F",non_qualified:"1F3CA-1F3FF-200D-2642",image:"1f3ca-1f3ff-200d-2642-fe0f.png",sheet_x:9,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3CA",a:"ManSwimming",b:"1F3CA-200D-2642-FE0F",c:"1F3CA-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[9,41],o:4,j:["男子游泳"]},"flag-ws":{a:"SamoaFlag",b:"1F1FC-1F1F8",d:!0,e:!0,f:!0,h:!0,k:[4,54],o:2,j:["萨摩亚"]},"woman-swimming":{skin_variations:{"1F3FB":{unified:"1F3CA-1F3FB-200D-2640-FE0F",non_qualified:"1F3CA-1F3FB-200D-2640",image:"1f3ca-1f3fb-200d-2640-fe0f.png",sheet_x:9,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CA-1F3FC-200D-2640-FE0F",non_qualified:"1F3CA-1F3FC-200D-2640",image:"1f3ca-1f3fc-200d-2640-fe0f.png",sheet_x:9,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CA-1F3FD-200D-2640-FE0F",non_qualified:"1F3CA-1F3FD-200D-2640",image:"1f3ca-1f3fd-200d-2640-fe0f.png",sheet_x:9,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CA-1F3FE-200D-2640-FE0F",non_qualified:"1F3CA-1F3FE-200D-2640",image:"1f3ca-1f3fe-200d-2640-fe0f.png",sheet_x:9,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CA-1F3FF-200D-2640-FE0F",non_qualified:"1F3CA-1F3FF-200D-2640",image:"1f3ca-1f3ff-200d-2640-fe0f.png",sheet_x:9,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanSwimming",b:"1F3CA-200D-2640-FE0F",c:"1F3CA-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[9,35],o:4,j:["女子游泳"]},"flag-xk":{a:"KosovoFlag",b:"1F1FD-1F1F0",d:!0,e:!0,f:!0,h:!0,k:[4,55],o:2,j:["科索沃"]},person_with_ball:{skin_variations:{"1F3FB":{unified:"26F9-1F3FB",non_qualified:null,image:"26f9-1f3fb.png",sheet_x:54,sheet_y:32,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"26F9-1F3FC",non_qualified:null,image:"26f9-1f3fc.png",sheet_x:54,sheet_y:33,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"26F9-1F3FD",non_qualified:null,image:"26f9-1f3fd.png",sheet_x:54,sheet_y:34,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"26F9-1F3FE",non_qualified:null,image:"26f9-1f3fe.png",sheet_x:54,sheet_y:35,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"26F9-1F3FF",non_qualified:null,image:"26f9-1f3ff.png",sheet_x:54,sheet_y:36,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"26F9-FE0F-200D-2642-FE0F",a:"PersonwithBall",b:"26F9-FE0F",c:"26F9",d:!0,e:!0,f:!0,h:!1,k:[54,31],o:2,j:["运球的人"]},"flag-ye":{a:"YemenFlag",b:"1F1FE-1F1EA",d:!0,e:!0,f:!0,h:!0,k:[4,56],o:2,j:["也门"]},"man-bouncing-ball":{skin_variations:{"1F3FB":{unified:"26F9-1F3FB-200D-2642-FE0F",non_qualified:"26F9-1F3FB-200D-2642",image:"26f9-1f3fb-200d-2642-fe0f.png",sheet_x:54,sheet_y:26,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"26F9-1F3FC-200D-2642-FE0F",non_qualified:"26F9-1F3FC-200D-2642",image:"26f9-1f3fc-200d-2642-fe0f.png",sheet_x:54,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"26F9-1F3FD-200D-2642-FE0F",non_qualified:"26F9-1F3FD-200D-2642",image:"26f9-1f3fd-200d-2642-fe0f.png",sheet_x:54,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"26F9-1F3FE-200D-2642-FE0F",non_qualified:"26F9-1F3FE-200D-2642",image:"26f9-1f3fe-200d-2642-fe0f.png",sheet_x:54,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"26F9-1F3FF-200D-2642-FE0F",non_qualified:"26F9-1F3FF-200D-2642",image:"26f9-1f3ff-200d-2642-fe0f.png",sheet_x:54,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"26F9-FE0F",a:"ManBouncingBall",b:"26F9-FE0F-200D-2642-FE0F",d:!0,e:!0,f:!0,h:!1,k:[54,25],o:4,j:["男子运球"]},"flag-yt":{a:"MayotteFlag",b:"1F1FE-1F1F9",d:!0,e:!0,f:!0,h:!0,k:[5,0],o:2,j:["马约特"]},"woman-bouncing-ball":{skin_variations:{"1F3FB":{unified:"26F9-1F3FB-200D-2640-FE0F",non_qualified:"26F9-1F3FB-200D-2640",image:"26f9-1f3fb-200d-2640-fe0f.png",sheet_x:54,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"26F9-1F3FC-200D-2640-FE0F",non_qualified:"26F9-1F3FC-200D-2640",image:"26f9-1f3fc-200d-2640-fe0f.png",sheet_x:54,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"26F9-1F3FD-200D-2640-FE0F",non_qualified:"26F9-1F3FD-200D-2640",image:"26f9-1f3fd-200d-2640-fe0f.png",sheet_x:54,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"26F9-1F3FE-200D-2640-FE0F",non_qualified:"26F9-1F3FE-200D-2640",image:"26f9-1f3fe-200d-2640-fe0f.png",sheet_x:54,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"26F9-1F3FF-200D-2640-FE0F",non_qualified:"26F9-1F3FF-200D-2640",image:"26f9-1f3ff-200d-2640-fe0f.png",sheet_x:54,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanBouncingBall",b:"26F9-FE0F-200D-2640-FE0F",d:!0,e:!0,f:!0,h:!1,k:[54,19],o:4,j:["女子运球"]},"flag-za":{a:"SouthAfricaFlag",b:"1F1FF-1F1E6",d:!0,e:!0,f:!0,h:!0,k:[5,1],o:2,j:["南非"]},"flag-zm":{a:"ZambiaFlag",b:"1F1FF-1F1F2",d:!0,e:!0,f:!0,h:!0,k:[5,2],o:2,j:["赞比亚"]},weight_lifter:{skin_variations:{"1F3FB":{unified:"1F3CB-1F3FB",non_qualified:null,image:"1f3cb-1f3fb.png",sheet_x:10,sheet_y:9,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F3CB-1F3FC",non_qualified:null,image:"1f3cb-1f3fc.png",sheet_x:10,sheet_y:10,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F3CB-1F3FD",non_qualified:null,image:"1f3cb-1f3fd.png",sheet_x:10,sheet_y:11,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F3CB-1F3FE",non_qualified:null,image:"1f3cb-1f3fe.png",sheet_x:10,sheet_y:12,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F3CB-1F3FF",non_qualified:null,image:"1f3cb-1f3ff.png",sheet_x:10,sheet_y:13,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F3CB-FE0F-200D-2642-FE0F",a:"WeightLifter",b:"1F3CB-FE0F",c:"1F3CB",d:!0,e:!0,f:!0,h:!1,k:[10,8],o:2,j:["举重的人"]},"man-lifting-weights":{skin_variations:{"1F3FB":{unified:"1F3CB-1F3FB-200D-2642-FE0F",non_qualified:"1F3CB-1F3FB-200D-2642",image:"1f3cb-1f3fb-200d-2642-fe0f.png",sheet_x:10,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CB-1F3FC-200D-2642-FE0F",non_qualified:"1F3CB-1F3FC-200D-2642",image:"1f3cb-1f3fc-200d-2642-fe0f.png",sheet_x:10,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CB-1F3FD-200D-2642-FE0F",non_qualified:"1F3CB-1F3FD-200D-2642",image:"1f3cb-1f3fd-200d-2642-fe0f.png",sheet_x:10,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CB-1F3FE-200D-2642-FE0F",non_qualified:"1F3CB-1F3FE-200D-2642",image:"1f3cb-1f3fe-200d-2642-fe0f.png",sheet_x:10,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CB-1F3FF-200D-2642-FE0F",non_qualified:"1F3CB-1F3FF-200D-2642",image:"1f3cb-1f3ff-200d-2642-fe0f.png",sheet_x:10,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F3CB-FE0F",a:"ManLiftingWeights",b:"1F3CB-FE0F-200D-2642-FE0F",d:!0,e:!0,f:!0,h:!1,k:[10,2],o:4,j:["男子举重"]},"flag-zw":{a:"ZimbabweFlag",b:"1F1FF-1F1FC",d:!0,e:!0,f:!0,h:!0,k:[5,3],o:2,j:["津巴布韦"]},"woman-lifting-weights":{skin_variations:{"1F3FB":{unified:"1F3CB-1F3FB-200D-2640-FE0F",non_qualified:"1F3CB-1F3FB-200D-2640",image:"1f3cb-1f3fb-200d-2640-fe0f.png",sheet_x:9,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F3CB-1F3FC-200D-2640-FE0F",non_qualified:"1F3CB-1F3FC-200D-2640",image:"1f3cb-1f3fc-200d-2640-fe0f.png",sheet_x:9,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F3CB-1F3FD-200D-2640-FE0F",non_qualified:"1F3CB-1F3FD-200D-2640",image:"1f3cb-1f3fd-200d-2640-fe0f.png",sheet_x:9,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F3CB-1F3FE-200D-2640-FE0F",non_qualified:"1F3CB-1F3FE-200D-2640",image:"1f3cb-1f3fe-200d-2640-fe0f.png",sheet_x:10,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F3CB-1F3FF-200D-2640-FE0F",non_qualified:"1F3CB-1F3FF-200D-2640",image:"1f3cb-1f3ff-200d-2640-fe0f.png",sheet_x:10,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanLiftingWeights",b:"1F3CB-FE0F-200D-2640-FE0F",d:!0,e:!0,f:!0,h:!1,k:[9,53],o:4,j:["女子举重"]},"flag-england":{a:"EnglandFlag",b:"1F3F4-E0067-E0062-E0065-E006E-E0067-E007F",d:!0,e:!0,f:!0,h:!0,k:[11,14],o:5,j:["英格兰"]},bicyclist:{skin_variations:{"1F3FB":{unified:"1F6B4-1F3FB",non_qualified:null,image:"1f6b4-1f3fb.png",sheet_x:35,sheet_y:24,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F6B4-1F3FC",non_qualified:null,image:"1f6b4-1f3fc.png",sheet_x:35,sheet_y:25,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F6B4-1F3FD",non_qualified:null,image:"1f6b4-1f3fd.png",sheet_x:35,sheet_y:26,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F6B4-1F3FE",non_qualified:null,image:"1f6b4-1f3fe.png",sheet_x:35,sheet_y:27,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F6B4-1F3FF",non_qualified:null,image:"1f6b4-1f3ff.png",sheet_x:35,sheet_y:28,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F6B4-200D-2642-FE0F",a:"Bicyclist",b:"1F6B4",d:!0,e:!0,f:!0,h:!1,k:[35,23],o:2,j:["骑自行车的人"]},"flag-scotland":{a:"ScotlandFlag",b:"1F3F4-E0067-E0062-E0073-E0063-E0074-E007F",d:!0,e:!0,f:!0,h:!0,k:[11,15],o:5,j:["苏格兰"]},"flag-wales":{a:"WalesFlag",b:"1F3F4-E0067-E0062-E0077-E006C-E0073-E007F",d:!0,e:!0,f:!0,h:!0,k:[11,16],o:5,j:["Flag:Wales"]},"man-biking":{skin_variations:{"1F3FB":{unified:"1F6B4-1F3FB-200D-2642-FE0F",non_qualified:"1F6B4-1F3FB-200D-2642",image:"1f6b4-1f3fb-200d-2642-fe0f.png",sheet_x:35,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B4-1F3FC-200D-2642-FE0F",non_qualified:"1F6B4-1F3FC-200D-2642",image:"1f6b4-1f3fc-200d-2642-fe0f.png",sheet_x:35,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B4-1F3FD-200D-2642-FE0F",non_qualified:"1F6B4-1F3FD-200D-2642",image:"1f6b4-1f3fd-200d-2642-fe0f.png",sheet_x:35,sheet_y:20,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B4-1F3FE-200D-2642-FE0F",non_qualified:"1F6B4-1F3FE-200D-2642",image:"1f6b4-1f3fe-200d-2642-fe0f.png",sheet_x:35,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B4-1F3FF-200D-2642-FE0F",non_qualified:"1F6B4-1F3FF-200D-2642",image:"1f6b4-1f3ff-200d-2642-fe0f.png",sheet_x:35,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F6B4",a:"ManBiking",b:"1F6B4-200D-2642-FE0F",c:"1F6B4-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[35,17],o:4,j:["骑自行车的男子"]},"woman-biking":{skin_variations:{"1F3FB":{unified:"1F6B4-1F3FB-200D-2640-FE0F",non_qualified:"1F6B4-1F3FB-200D-2640",image:"1f6b4-1f3fb-200d-2640-fe0f.png",sheet_x:35,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B4-1F3FC-200D-2640-FE0F",non_qualified:"1F6B4-1F3FC-200D-2640",image:"1f6b4-1f3fc-200d-2640-fe0f.png",sheet_x:35,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B4-1F3FD-200D-2640-FE0F",non_qualified:"1F6B4-1F3FD-200D-2640",image:"1f6b4-1f3fd-200d-2640-fe0f.png",sheet_x:35,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B4-1F3FE-200D-2640-FE0F",non_qualified:"1F6B4-1F3FE-200D-2640",image:"1f6b4-1f3fe-200d-2640-fe0f.png",sheet_x:35,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B4-1F3FF-200D-2640-FE0F",non_qualified:"1F6B4-1F3FF-200D-2640",image:"1f6b4-1f3ff-200d-2640-fe0f.png",sheet_x:35,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanBiking",b:"1F6B4-200D-2640-FE0F",c:"1F6B4-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[35,11],o:4,j:["女子骑行自行车"]},mountain_bicyclist:{skin_variations:{"1F3FB":{unified:"1F6B5-1F3FB",non_qualified:null,image:"1f6b5-1f3fb.png",sheet_x:35,sheet_y:42,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F6B5-1F3FC",non_qualified:null,image:"1f6b5-1f3fc.png",sheet_x:35,sheet_y:43,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F6B5-1F3FD",non_qualified:null,image:"1f6b5-1f3fd.png",sheet_x:35,sheet_y:44,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F6B5-1F3FE",non_qualified:null,image:"1f6b5-1f3fe.png",sheet_x:35,sheet_y:45,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F6B5-1F3FF",non_qualified:null,image:"1f6b5-1f3ff.png",sheet_x:35,sheet_y:46,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},obsoleted_by:"1F6B5-200D-2642-FE0F",a:"MountainBicyclist",b:"1F6B5",d:!0,e:!0,f:!0,h:!1,k:[35,41],o:2,j:["骑行山地自行车的人"]},"man-mountain-biking":{skin_variations:{"1F3FB":{unified:"1F6B5-1F3FB-200D-2642-FE0F",non_qualified:"1F6B5-1F3FB-200D-2642",image:"1f6b5-1f3fb-200d-2642-fe0f.png",sheet_x:35,sheet_y:36,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B5-1F3FC-200D-2642-FE0F",non_qualified:"1F6B5-1F3FC-200D-2642",image:"1f6b5-1f3fc-200d-2642-fe0f.png",sheet_x:35,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B5-1F3FD-200D-2642-FE0F",non_qualified:"1F6B5-1F3FD-200D-2642",image:"1f6b5-1f3fd-200d-2642-fe0f.png",sheet_x:35,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B5-1F3FE-200D-2642-FE0F",non_qualified:"1F6B5-1F3FE-200D-2642",image:"1f6b5-1f3fe-200d-2642-fe0f.png",sheet_x:35,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B5-1F3FF-200D-2642-FE0F",non_qualified:"1F6B5-1F3FF-200D-2642",image:"1f6b5-1f3ff-200d-2642-fe0f.png",sheet_x:35,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},obsoletes:"1F6B5",a:"ManMountainBiking",b:"1F6B5-200D-2642-FE0F",c:"1F6B5-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[35,35],o:4,j:["男子骑行山地自行车"]},"woman-mountain-biking":{skin_variations:{"1F3FB":{unified:"1F6B5-1F3FB-200D-2640-FE0F",non_qualified:"1F6B5-1F3FB-200D-2640",image:"1f6b5-1f3fb-200d-2640-fe0f.png",sheet_x:35,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6B5-1F3FC-200D-2640-FE0F",non_qualified:"1F6B5-1F3FC-200D-2640",image:"1f6b5-1f3fc-200d-2640-fe0f.png",sheet_x:35,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6B5-1F3FD-200D-2640-FE0F",non_qualified:"1F6B5-1F3FD-200D-2640",image:"1f6b5-1f3fd-200d-2640-fe0f.png",sheet_x:35,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6B5-1F3FE-200D-2640-FE0F",non_qualified:"1F6B5-1F3FE-200D-2640",image:"1f6b5-1f3fe-200d-2640-fe0f.png",sheet_x:35,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6B5-1F3FF-200D-2640-FE0F",non_qualified:"1F6B5-1F3FF-200D-2640",image:"1f6b5-1f3ff-200d-2640-fe0f.png",sheet_x:35,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanMountainBiking",b:"1F6B5-200D-2640-FE0F",c:"1F6B5-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[35,29],o:4,j:["女子骑行山地自行车"]},person_doing_cartwheel:{skin_variations:{"1F3FB":{unified:"1F938-1F3FB",non_qualified:null,image:"1f938-1f3fb.png",sheet_x:40,sheet_y:9,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F938-1F3FC",non_qualified:null,image:"1f938-1f3fc.png",sheet_x:40,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F938-1F3FD",non_qualified:null,image:"1f938-1f3fd.png",sheet_x:40,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F938-1F3FE",non_qualified:null,image:"1f938-1f3fe.png",sheet_x:40,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F938-1F3FF",non_qualified:null,image:"1f938-1f3ff.png",sheet_x:40,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"PersonDoingCartwheel",b:"1F938",d:!0,e:!0,f:!0,h:!1,k:[40,8],o:4,j:["跳大车轮的人"]},"man-cartwheeling":{skin_variations:{"1F3FB":{unified:"1F938-1F3FB-200D-2642-FE0F",non_qualified:"1F938-1F3FB-200D-2642",image:"1f938-1f3fb-200d-2642-fe0f.png",sheet_x:40,sheet_y:3,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F938-1F3FC-200D-2642-FE0F",non_qualified:"1F938-1F3FC-200D-2642",image:"1f938-1f3fc-200d-2642-fe0f.png",sheet_x:40,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F938-1F3FD-200D-2642-FE0F",non_qualified:"1F938-1F3FD-200D-2642",image:"1f938-1f3fd-200d-2642-fe0f.png",sheet_x:40,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F938-1F3FE-200D-2642-FE0F",non_qualified:"1F938-1F3FE-200D-2642",image:"1f938-1f3fe-200d-2642-fe0f.png",sheet_x:40,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F938-1F3FF-200D-2642-FE0F",non_qualified:"1F938-1F3FF-200D-2642",image:"1f938-1f3ff-200d-2642-fe0f.png",sheet_x:40,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManCartwheeling",b:"1F938-200D-2642-FE0F",c:"1F938-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[40,2],o:4,j:["男跳大车轮的男人"]},"woman-cartwheeling":{skin_variations:{"1F3FB":{unified:"1F938-1F3FB-200D-2640-FE0F",non_qualified:"1F938-1F3FB-200D-2640",image:"1f938-1f3fb-200d-2640-fe0f.png",sheet_x:39,sheet_y:54,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F938-1F3FC-200D-2640-FE0F",non_qualified:"1F938-1F3FC-200D-2640",image:"1f938-1f3fc-200d-2640-fe0f.png",sheet_x:39,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F938-1F3FD-200D-2640-FE0F",non_qualified:"1F938-1F3FD-200D-2640",image:"1f938-1f3fd-200d-2640-fe0f.png",sheet_x:39,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F938-1F3FE-200D-2640-FE0F",non_qualified:"1F938-1F3FE-200D-2640",image:"1f938-1f3fe-200d-2640-fe0f.png",sheet_x:40,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F938-1F3FF-200D-2640-FE0F",non_qualified:"1F938-1F3FF-200D-2640",image:"1f938-1f3ff-200d-2640-fe0f.png",sheet_x:40,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanCartwheeling",b:"1F938-200D-2640-FE0F",c:"1F938-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[39,53],o:4,j:["跳大车轮的女人"]},wrestlers:{a:"Wrestlers",b:"1F93C",d:!0,e:!0,f:!0,h:!0,k:[40,35],o:4,j:["人们摔跤"]},"man-wrestling":{a:"ManWrestling",b:"1F93C-200D-2642-FE0F",c:"1F93C-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[40,34],o:4,j:["男子摔跤"]},"woman-wrestling":{a:"WomanWrestling",b:"1F93C-200D-2640-FE0F",c:"1F93C-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[40,33],o:4,j:["女子摔跤"]},water_polo:{skin_variations:{"1F3FB":{unified:"1F93D-1F3FB",non_qualified:null,image:"1f93d-1f3fb.png",sheet_x:40,sheet_y:49,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F93D-1F3FC",non_qualified:null,image:"1f93d-1f3fc.png",sheet_x:40,sheet_y:50,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F93D-1F3FD",non_qualified:null,image:"1f93d-1f3fd.png",sheet_x:40,sheet_y:51,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F93D-1F3FE",non_qualified:null,image:"1f93d-1f3fe.png",sheet_x:40,sheet_y:52,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F93D-1F3FF",non_qualified:null,image:"1f93d-1f3ff.png",sheet_x:40,sheet_y:53,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"WaterPolo",b:"1F93D",d:!0,e:!0,f:!0,h:!1,k:[40,48],o:4,j:["打水球的人"]},"man-playing-water-polo":{skin_variations:{"1F3FB":{unified:"1F93D-1F3FB-200D-2642-FE0F",non_qualified:"1F93D-1F3FB-200D-2642",image:"1f93d-1f3fb-200d-2642-fe0f.png",sheet_x:40,sheet_y:43,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F93D-1F3FC-200D-2642-FE0F",non_qualified:"1F93D-1F3FC-200D-2642",image:"1f93d-1f3fc-200d-2642-fe0f.png",sheet_x:40,sheet_y:44,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F93D-1F3FD-200D-2642-FE0F",non_qualified:"1F93D-1F3FD-200D-2642",image:"1f93d-1f3fd-200d-2642-fe0f.png",sheet_x:40,sheet_y:45,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F93D-1F3FE-200D-2642-FE0F",non_qualified:"1F93D-1F3FE-200D-2642",image:"1f93d-1f3fe-200d-2642-fe0f.png",sheet_x:40,sheet_y:46,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F93D-1F3FF-200D-2642-FE0F",non_qualified:"1F93D-1F3FF-200D-2642",image:"1f93d-1f3ff-200d-2642-fe0f.png",sheet_x:40,sheet_y:47,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManPlayingWaterPolo",b:"1F93D-200D-2642-FE0F",c:"1F93D-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[40,42],o:4,j:["打水球的男子"]},"woman-playing-water-polo":{skin_variations:{"1F3FB":{unified:"1F93D-1F3FB-200D-2640-FE0F",non_qualified:"1F93D-1F3FB-200D-2640",image:"1f93d-1f3fb-200d-2640-fe0f.png",sheet_x:40,sheet_y:37,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F93D-1F3FC-200D-2640-FE0F",non_qualified:"1F93D-1F3FC-200D-2640",image:"1f93d-1f3fc-200d-2640-fe0f.png",sheet_x:40,sheet_y:38,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F93D-1F3FD-200D-2640-FE0F",non_qualified:"1F93D-1F3FD-200D-2640",image:"1f93d-1f3fd-200d-2640-fe0f.png",sheet_x:40,sheet_y:39,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F93D-1F3FE-200D-2640-FE0F",non_qualified:"1F93D-1F3FE-200D-2640",image:"1f93d-1f3fe-200d-2640-fe0f.png",sheet_x:40,sheet_y:40,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F93D-1F3FF-200D-2640-FE0F",non_qualified:"1F93D-1F3FF-200D-2640",image:"1f93d-1f3ff-200d-2640-fe0f.png",sheet_x:40,sheet_y:41,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanPlayingWaterPolo",b:"1F93D-200D-2640-FE0F",c:"1F93D-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[40,36],o:4,j:["打水球的女子"]},handball:{skin_variations:{"1F3FB":{unified:"1F93E-1F3FB",non_qualified:null,image:"1f93e-1f3fb.png",sheet_x:41,sheet_y:10,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FC":{unified:"1F93E-1F3FC",non_qualified:null,image:"1f93e-1f3fc.png",sheet_x:41,sheet_y:11,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FD":{unified:"1F93E-1F3FD",non_qualified:null,image:"1f93e-1f3fd.png",sheet_x:41,sheet_y:12,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FE":{unified:"1F93E-1F3FE",non_qualified:null,image:"1f93e-1f3fe.png",sheet_x:41,sheet_y:13,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1},"1F3FF":{unified:"1F93E-1F3FF",non_qualified:null,image:"1f93e-1f3ff.png",sheet_x:41,sheet_y:14,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!1}},a:"Handball",b:"1F93E",d:!0,e:!0,f:!0,h:!1,k:[41,9],o:4,j:["打手球的人"]},"man-playing-handball":{skin_variations:{"1F3FB":{unified:"1F93E-1F3FB-200D-2642-FE0F",non_qualified:"1F93E-1F3FB-200D-2642",image:"1f93e-1f3fb-200d-2642-fe0f.png",sheet_x:41,sheet_y:4,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F93E-1F3FC-200D-2642-FE0F",non_qualified:"1F93E-1F3FC-200D-2642",image:"1f93e-1f3fc-200d-2642-fe0f.png",sheet_x:41,sheet_y:5,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F93E-1F3FD-200D-2642-FE0F",non_qualified:"1F93E-1F3FD-200D-2642",image:"1f93e-1f3fd-200d-2642-fe0f.png",sheet_x:41,sheet_y:6,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F93E-1F3FE-200D-2642-FE0F",non_qualified:"1F93E-1F3FE-200D-2642",image:"1f93e-1f3fe-200d-2642-fe0f.png",sheet_x:41,sheet_y:7,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F93E-1F3FF-200D-2642-FE0F",non_qualified:"1F93E-1F3FF-200D-2642",image:"1f93e-1f3ff-200d-2642-fe0f.png",sheet_x:41,sheet_y:8,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManPlayingHandball",b:"1F93E-200D-2642-FE0F",c:"1F93E-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[41,3],o:4,j:["打手球的男子"]},"woman-playing-handball":{skin_variations:{"1F3FB":{unified:"1F93E-1F3FB-200D-2640-FE0F",non_qualified:"1F93E-1F3FB-200D-2640",image:"1f93e-1f3fb-200d-2640-fe0f.png",sheet_x:40,sheet_y:55,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F93E-1F3FC-200D-2640-FE0F",non_qualified:"1F93E-1F3FC-200D-2640",image:"1f93e-1f3fc-200d-2640-fe0f.png",sheet_x:40,sheet_y:56,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F93E-1F3FD-200D-2640-FE0F",non_qualified:"1F93E-1F3FD-200D-2640",image:"1f93e-1f3fd-200d-2640-fe0f.png",sheet_x:41,sheet_y:0,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F93E-1F3FE-200D-2640-FE0F",non_qualified:"1F93E-1F3FE-200D-2640",image:"1f93e-1f3fe-200d-2640-fe0f.png",sheet_x:41,sheet_y:1,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F93E-1F3FF-200D-2640-FE0F",non_qualified:"1F93E-1F3FF-200D-2640",image:"1f93e-1f3ff-200d-2640-fe0f.png",sheet_x:41,sheet_y:2,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanPlayingHandball",b:"1F93E-200D-2640-FE0F",c:"1F93E-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[40,54],o:4,j:["打手球的女子"]},juggling:{skin_variations:{"1F3FB":{unified:"1F939-1F3FB",non_qualified:null,image:"1f939-1f3fb.png",sheet_x:40,sheet_y:27,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F939-1F3FC",non_qualified:null,image:"1f939-1f3fc.png",sheet_x:40,sheet_y:28,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F939-1F3FD",non_qualified:null,image:"1f939-1f3fd.png",sheet_x:40,sheet_y:29,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F939-1F3FE",non_qualified:null,image:"1f939-1f3fe.png",sheet_x:40,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F939-1F3FF",non_qualified:null,image:"1f939-1f3ff.png",sheet_x:40,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Juggling",b:"1F939",d:!0,e:!0,f:!0,h:!0,k:[40,26],o:4,j:["玩杂耍的人"]},"man-juggling":{skin_variations:{"1F3FB":{unified:"1F939-1F3FB-200D-2642-FE0F",non_qualified:"1F939-1F3FB-200D-2642",image:"1f939-1f3fb-200d-2642-fe0f.png",sheet_x:40,sheet_y:21,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F939-1F3FC-200D-2642-FE0F",non_qualified:"1F939-1F3FC-200D-2642",image:"1f939-1f3fc-200d-2642-fe0f.png",sheet_x:40,sheet_y:22,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F939-1F3FD-200D-2642-FE0F",non_qualified:"1F939-1F3FD-200D-2642",image:"1f939-1f3fd-200d-2642-fe0f.png",sheet_x:40,sheet_y:23,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F939-1F3FE-200D-2642-FE0F",non_qualified:"1F939-1F3FE-200D-2642",image:"1f939-1f3fe-200d-2642-fe0f.png",sheet_x:40,sheet_y:24,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F939-1F3FF-200D-2642-FE0F",non_qualified:"1F939-1F3FF-200D-2642",image:"1f939-1f3ff-200d-2642-fe0f.png",sheet_x:40,sheet_y:25,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManJuggling",b:"1F939-200D-2642-FE0F",c:"1F939-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[40,20],o:4,j:["男子玩杂耍"]},"woman-juggling":{skin_variations:{"1F3FB":{unified:"1F939-1F3FB-200D-2640-FE0F",non_qualified:"1F939-1F3FB-200D-2640",image:"1f939-1f3fb-200d-2640-fe0f.png",sheet_x:40,sheet_y:15,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F939-1F3FC-200D-2640-FE0F",non_qualified:"1F939-1F3FC-200D-2640",image:"1f939-1f3fc-200d-2640-fe0f.png",sheet_x:40,sheet_y:16,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F939-1F3FD-200D-2640-FE0F",non_qualified:"1F939-1F3FD-200D-2640",image:"1f939-1f3fd-200d-2640-fe0f.png",sheet_x:40,sheet_y:17,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F939-1F3FE-200D-2640-FE0F",non_qualified:"1F939-1F3FE-200D-2640",image:"1f939-1f3fe-200d-2640-fe0f.png",sheet_x:40,sheet_y:18,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F939-1F3FF-200D-2640-FE0F",non_qualified:"1F939-1F3FF-200D-2640",image:"1f939-1f3ff-200d-2640-fe0f.png",sheet_x:40,sheet_y:19,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"WomanJuggling",b:"1F939-200D-2640-FE0F",c:"1F939-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[40,14],o:4,j:["女人玩杂耍"]},person_in_lotus_position:{skin_variations:{"1F3FB":{unified:"1F9D8-1F3FB",non_qualified:null,image:"1f9d8-1f3fb.png",sheet_x:49,sheet_y:32,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FB-200D-2640-FE0F"},"1F3FC":{unified:"1F9D8-1F3FC",non_qualified:null,image:"1f9d8-1f3fc.png",sheet_x:49,sheet_y:33,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FC-200D-2640-FE0F"},"1F3FD":{unified:"1F9D8-1F3FD",non_qualified:null,image:"1f9d8-1f3fd.png",sheet_x:49,sheet_y:34,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FD-200D-2640-FE0F"},"1F3FE":{unified:"1F9D8-1F3FE",non_qualified:null,image:"1f9d8-1f3fe.png",sheet_x:49,sheet_y:35,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FE-200D-2640-FE0F"},"1F3FF":{unified:"1F9D8-1F3FF",non_qualified:null,image:"1f9d8-1f3ff.png",sheet_x:49,sheet_y:36,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoleted_by:"1F9D8-1F3FF-200D-2640-FE0F"}},obsoleted_by:"1F9D8-200D-2640-FE0F",a:"PersoninLotusPosition",b:"1F9D8",d:!0,e:!0,f:!0,h:!0,k:[49,31],o:5,j:["的人盘腿坐"]},man_in_lotus_position:{skin_variations:{"1F3FB":{unified:"1F9D8-1F3FB-200D-2642-FE0F",non_qualified:"1F9D8-1F3FB-200D-2642",image:"1f9d8-1f3fb-200d-2642-fe0f.png",sheet_x:49,sheet_y:26,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F9D8-1F3FC-200D-2642-FE0F",non_qualified:"1F9D8-1F3FC-200D-2642",image:"1f9d8-1f3fc-200d-2642-fe0f.png",sheet_x:49,sheet_y:27,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F9D8-1F3FD-200D-2642-FE0F",non_qualified:"1F9D8-1F3FD-200D-2642",image:"1f9d8-1f3fd-200d-2642-fe0f.png",sheet_x:49,sheet_y:28,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F9D8-1F3FE-200D-2642-FE0F",non_qualified:"1F9D8-1F3FE-200D-2642",image:"1f9d8-1f3fe-200d-2642-fe0f.png",sheet_x:49,sheet_y:29,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F9D8-1F3FF-200D-2642-FE0F",non_qualified:"1F9D8-1F3FF-200D-2642",image:"1f9d8-1f3ff-200d-2642-fe0f.png",sheet_x:49,sheet_y:30,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManinLotusPosition",b:"1F9D8-200D-2642-FE0F",c:"1F9D8-200D-2642",d:!0,e:!0,f:!0,h:!0,k:[49,25],o:5,j:["男人盘腿坐"]},woman_in_lotus_position:{skin_variations:{"1F3FB":{unified:"1F9D8-1F3FB-200D-2640-FE0F",non_qualified:"1F9D8-1F3FB-200D-2640",image:"1f9d8-1f3fb-200d-2640-fe0f.png",sheet_x:49,sheet_y:20,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FB"},"1F3FC":{unified:"1F9D8-1F3FC-200D-2640-FE0F",non_qualified:"1F9D8-1F3FC-200D-2640",image:"1f9d8-1f3fc-200d-2640-fe0f.png",sheet_x:49,sheet_y:21,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FC"},"1F3FD":{unified:"1F9D8-1F3FD-200D-2640-FE0F",non_qualified:"1F9D8-1F3FD-200D-2640",image:"1f9d8-1f3fd-200d-2640-fe0f.png",sheet_x:49,sheet_y:22,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FD"},"1F3FE":{unified:"1F9D8-1F3FE-200D-2640-FE0F",non_qualified:"1F9D8-1F3FE-200D-2640",image:"1f9d8-1f3fe-200d-2640-fe0f.png",sheet_x:49,sheet_y:23,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FE"},"1F3FF":{unified:"1F9D8-1F3FF-200D-2640-FE0F",non_qualified:"1F9D8-1F3FF-200D-2640",image:"1f9d8-1f3ff-200d-2640-fe0f.png",sheet_x:49,sheet_y:24,added_in:"5.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0,obsoletes:"1F9D8-1F3FF"}},obsoletes:"1F9D8",a:"WomaninLotusPosition",b:"1F9D8-200D-2640-FE0F",c:"1F9D8-200D-2640",d:!0,e:!0,f:!0,h:!0,k:[49,19],o:5,j:["女子盘腿坐"]},bath:{skin_variations:{"1F3FB":{unified:"1F6C0-1F3FB",non_qualified:null,image:"1f6c0-1f3fb.png",sheet_x:36,sheet_y:18,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6C0-1F3FC",non_qualified:null,image:"1f6c0-1f3fc.png",sheet_x:36,sheet_y:19,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6C0-1F3FD",non_qualified:null,image:"1f6c0-1f3fd.png",sheet_x:36,sheet_y:20,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6C0-1F3FE",non_qualified:null,image:"1f6c0-1f3fe.png",sheet_x:36,sheet_y:21,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6C0-1F3FF",non_qualified:null,image:"1f6c0-1f3ff.png",sheet_x:36,sheet_y:22,added_in:"2.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"Bath",b:"1F6C0",d:!0,e:!0,f:!0,h:!0,j:["人泡澡","干净","淋浴","浴室","clean","shower","bathroom"],k:[36,17],o:2},sleeping_accommodation:{skin_variations:{"1F3FB":{unified:"1F6CC-1F3FB",non_qualified:null,image:"1f6cc-1f3fb.png",sheet_x:36,sheet_y:30,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F6CC-1F3FC",non_qualified:null,image:"1f6cc-1f3fc.png",sheet_x:36,sheet_y:31,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F6CC-1F3FD",non_qualified:null,image:"1f6cc-1f3fd.png",sheet_x:36,sheet_y:32,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F6CC-1F3FE",non_qualified:null,image:"1f6cc-1f3fe.png",sheet_x:36,sheet_y:33,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F6CC-1F3FF",non_qualified:null,image:"1f6cc-1f3ff.png",sheet_x:36,sheet_y:34,added_in:"4.0",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"SleepingAccommodation",b:"1F6CC",d:!0,e:!0,f:!0,h:!0,k:[36,29],o:2,j:["人在床上"]},people_holding_hands:{skin_variations:{"1F3FB-1F3FB":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:46,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FC":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:46,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FD":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:46,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FE":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:46,sheet_y:42,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FF":{unified:"1F9D1-1F3FB-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:46,sheet_y:43,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FB":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:46,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FC":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:46,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FD":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:46,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FE":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:46,sheet_y:47,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FF":{unified:"1F9D1-1F3FC-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:46,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FB":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:46,sheet_y:49,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FC":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:46,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FD":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:46,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FE":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:46,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FF":{unified:"1F9D1-1F3FD-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:46,sheet_y:53,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FE-1F3FB":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:46,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FC":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:46,sheet_y:55,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FD":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:46,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FE":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:47,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FF":{unified:"1F9D1-1F3FE-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:47,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FF-1F3FB":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FB",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fb.png",sheet_x:47,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FC":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FC",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fc.png",sheet_x:47,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FD":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FD",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fd.png",sheet_x:47,sheet_y:4,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FE":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FE",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fe.png",sheet_x:47,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FF":{unified:"1F9D1-1F3FF-200D-1F91D-200D-1F9D1-1F3FF",non_qualified:null,image:"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3ff.png",sheet_x:47,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"PeopleHoldingHands",b:"1F9D1-200D-1F91D-200D-1F9D1",d:!0,e:!0,f:!0,h:!0,k:[46,38],o:12,j:["人们牵手"]},two_women_holding_hands:{skin_variations:{"1F3FB":{unified:"1F46D-1F3FB",non_qualified:null,image:"1f46d-1f3fb.png",sheet_x:21,sheet_y:12,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46D-1F3FC",non_qualified:null,image:"1f46d-1f3fc.png",sheet_x:21,sheet_y:13,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46D-1F3FD",non_qualified:null,image:"1f46d-1f3fd.png",sheet_x:21,sheet_y:14,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46D-1F3FE",non_qualified:null,image:"1f46d-1f3fe.png",sheet_x:21,sheet_y:15,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46D-1F3FF",non_qualified:null,image:"1f46d-1f3ff.png",sheet_x:21,sheet_y:16,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FC":{unified:"1F469-1F3FB-200D-1F91D-200D-1F469-1F3FC",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f469-1f3fc.png",sheet_x:21,sheet_y:17,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FD":{unified:"1F469-1F3FB-200D-1F91D-200D-1F469-1F3FD",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f469-1f3fd.png",sheet_x:21,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FE":{unified:"1F469-1F3FB-200D-1F91D-200D-1F469-1F3FE",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f469-1f3fe.png",sheet_x:21,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FF":{unified:"1F469-1F3FB-200D-1F91D-200D-1F469-1F3FF",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f469-1f3ff.png",sheet_x:21,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FB":{unified:"1F469-1F3FC-200D-1F91D-200D-1F469-1F3FB",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f469-1f3fb.png",sheet_x:21,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FD":{unified:"1F469-1F3FC-200D-1F91D-200D-1F469-1F3FD",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f469-1f3fd.png",sheet_x:21,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FE":{unified:"1F469-1F3FC-200D-1F91D-200D-1F469-1F3FE",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f469-1f3fe.png",sheet_x:21,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FF":{unified:"1F469-1F3FC-200D-1F91D-200D-1F469-1F3FF",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f469-1f3ff.png",sheet_x:21,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FB":{unified:"1F469-1F3FD-200D-1F91D-200D-1F469-1F3FB",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f469-1f3fb.png",sheet_x:21,sheet_y:25,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FC":{unified:"1F469-1F3FD-200D-1F91D-200D-1F469-1F3FC",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f469-1f3fc.png",sheet_x:21,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FE":{unified:"1F469-1F3FD-200D-1F91D-200D-1F469-1F3FE",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f469-1f3fe.png",sheet_x:21,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FF":{unified:"1F469-1F3FD-200D-1F91D-200D-1F469-1F3FF",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f469-1f3ff.png",sheet_x:21,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FE-1F3FB":{unified:"1F469-1F3FE-200D-1F91D-200D-1F469-1F3FB",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f469-1f3fb.png",sheet_x:21,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FC":{unified:"1F469-1F3FE-200D-1F91D-200D-1F469-1F3FC",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f469-1f3fc.png",sheet_x:21,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FD":{unified:"1F469-1F3FE-200D-1F91D-200D-1F469-1F3FD",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f469-1f3fd.png",sheet_x:21,sheet_y:31,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FF":{unified:"1F469-1F3FE-200D-1F91D-200D-1F469-1F3FF",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f469-1f3ff.png",sheet_x:21,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FF-1F3FB":{unified:"1F469-1F3FF-200D-1F91D-200D-1F469-1F3FB",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fb.png",sheet_x:21,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FC":{unified:"1F469-1F3FF-200D-1F91D-200D-1F469-1F3FC",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fc.png",sheet_x:21,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FD":{unified:"1F469-1F3FF-200D-1F91D-200D-1F469-1F3FD",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fd.png",sheet_x:21,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FE":{unified:"1F469-1F3FF-200D-1F91D-200D-1F469-1F3FE",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fe.png",sheet_x:21,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"TwoWomenHoldingHands",b:"1F46D",d:!0,e:!0,f:!0,h:!0,j:["女士牵手","双","友谊","夫妇","爱","喜欢","女性","人","人","pair","friendship","couple","love","like","female","people","human"],k:[21,11],n:["women_holding_hands"],o:2},couple:{skin_variations:{"1F3FB":{unified:"1F46B-1F3FB",non_qualified:null,image:"1f46b-1f3fb.png",sheet_x:20,sheet_y:17,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46B-1F3FC",non_qualified:null,image:"1f46b-1f3fc.png",sheet_x:20,sheet_y:18,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46B-1F3FD",non_qualified:null,image:"1f46b-1f3fd.png",sheet_x:20,sheet_y:19,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46B-1F3FE",non_qualified:null,image:"1f46b-1f3fe.png",sheet_x:20,sheet_y:20,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46B-1F3FF",non_qualified:null,image:"1f46b-1f3ff.png",sheet_x:20,sheet_y:21,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FC":{unified:"1F469-1F3FB-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:22,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FD":{unified:"1F469-1F3FB-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:23,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FE":{unified:"1F469-1F3FB-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:24,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FF":{unified:"1F469-1F3FB-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f469-1f3fb-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:25,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FB":{unified:"1F469-1F3FC-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:26,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FD":{unified:"1F469-1F3FC-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:27,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FE":{unified:"1F469-1F3FC-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:28,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FF":{unified:"1F469-1F3FC-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f469-1f3fc-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:29,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FB":{unified:"1F469-1F3FD-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:30,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FC":{unified:"1F469-1F3FD-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:31,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FE":{unified:"1F469-1F3FD-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:32,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FF":{unified:"1F469-1F3FD-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f469-1f3fd-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:33,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FB":{unified:"1F469-1F3FE-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:34,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FC":{unified:"1F469-1F3FE-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:35,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FD":{unified:"1F469-1F3FE-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:36,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FF":{unified:"1F469-1F3FE-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f469-1f3fe-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:37,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FB":{unified:"1F469-1F3FF-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:38,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FC":{unified:"1F469-1F3FF-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:39,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FD":{unified:"1F469-1F3FF-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:40,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FE":{unified:"1F469-1F3FF-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:41,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"ManandWomanHoldingHands",b:"1F46B",d:!0,e:!0,f:!0,h:!0,j:["女人和男人牵手","双","人","人","爱","日期","约会","喜欢","感情","情人","婚","pair","people","human","love","date","dating","like","affection","valentines","marriage"],k:[20,16],n:["man_and_woman_holding_hands","woman_and_man_holding_hands"],o:2},two_men_holding_hands:{skin_variations:{"1F3FB":{unified:"1F46C-1F3FB",non_qualified:null,image:"1f46c-1f3fb.png",sheet_x:20,sheet_y:43,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC":{unified:"1F46C-1F3FC",non_qualified:null,image:"1f46c-1f3fc.png",sheet_x:20,sheet_y:44,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD":{unified:"1F46C-1F3FD",non_qualified:null,image:"1f46c-1f3fd.png",sheet_x:20,sheet_y:45,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE":{unified:"1F46C-1F3FE",non_qualified:null,image:"1f46c-1f3fe.png",sheet_x:20,sheet_y:46,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF":{unified:"1F46C-1F3FF",non_qualified:null,image:"1f46c-1f3ff.png",sheet_x:20,sheet_y:47,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FB-1F3FC":{unified:"1F468-1F3FB-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f468-1f3fb-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:20,sheet_y:48,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FD":{unified:"1F468-1F3FB-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f468-1f3fb-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:49,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FE":{unified:"1F468-1F3FB-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f468-1f3fb-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:50,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FB-1F3FF":{unified:"1F468-1F3FB-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f468-1f3fb-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:51,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FB":{unified:"1F468-1F3FC-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f468-1f3fc-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:52,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FC-1F3FD":{unified:"1F468-1F3FC-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f468-1f3fc-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:20,sheet_y:53,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FE":{unified:"1F468-1F3FC-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f468-1f3fc-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:20,sheet_y:54,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FC-1F3FF":{unified:"1F468-1F3FC-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f468-1f3fc-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:20,sheet_y:55,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FB":{unified:"1F468-1F3FD-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f468-1f3fd-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:20,sheet_y:56,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FC":{unified:"1F468-1F3FD-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f468-1f3fd-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:21,sheet_y:0,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FD-1F3FE":{unified:"1F468-1F3FD-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f468-1f3fd-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:21,sheet_y:1,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FD-1F3FF":{unified:"1F468-1F3FD-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f468-1f3fd-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:21,sheet_y:2,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FE-1F3FB":{unified:"1F468-1F3FE-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f468-1f3fe-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:21,sheet_y:3,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FC":{unified:"1F468-1F3FE-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f468-1f3fe-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:21,sheet_y:4,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FD":{unified:"1F468-1F3FE-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f468-1f3fe-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:21,sheet_y:5,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FE-1F3FF":{unified:"1F468-1F3FE-200D-1F91D-200D-1F468-1F3FF",non_qualified:null,image:"1f468-1f3fe-200d-1f91d-200d-1f468-1f3ff.png",sheet_x:21,sheet_y:6,added_in:"12.1",has_img_apple:!0,has_img_google:!1,has_img_twitter:!0,has_img_facebook:!1},"1F3FF-1F3FB":{unified:"1F468-1F3FF-200D-1F91D-200D-1F468-1F3FB",non_qualified:null,image:"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fb.png",sheet_x:21,sheet_y:7,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FC":{unified:"1F468-1F3FF-200D-1F91D-200D-1F468-1F3FC",non_qualified:null,image:"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fc.png",sheet_x:21,sheet_y:8,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FD":{unified:"1F468-1F3FF-200D-1F91D-200D-1F468-1F3FD",non_qualified:null,image:"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fd.png",sheet_x:21,sheet_y:9,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0},"1F3FF-1F3FE":{unified:"1F468-1F3FF-200D-1F91D-200D-1F468-1F3FE",non_qualified:null,image:"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fe.png",sheet_x:21,sheet_y:10,added_in:"12.1",has_img_apple:!0,has_img_google:!0,has_img_twitter:!0,has_img_facebook:!0}},a:"TwoMenHoldingHands",b:"1F46C",d:!0,e:!0,f:!0,h:!0,j:["男士牵手","双","夫妇","爱","喜欢","溴","友谊","人","人","pair","couple","love","like","bromance","friendship","people","human"],k:[20,42],n:["men_holding_hands"],o:2},couplekiss:{obsoleted_by:"1F469-200D-2764-FE0F-200D-1F48B-200D-1F468",a:"Kiss",b:"1F48F",d:!0,e:!0,f:!0,h:!0,k:[25,25],o:2,j:["亲吻"]},"woman-kiss-man":{obsoletes:"1F48F",a:"WomanKissMan",b:"1F469-200D-2764-FE0F-200D-1F48B-200D-1F468",c:"1F469-200D-2764-200D-1F48B-200D-1F468",d:!0,e:!0,f:!0,h:!0,k:[20,7],o:2,j:["男人和女人接吻"]},"man-kiss-man":{a:"ManKissMan",b:"1F468-200D-2764-FE0F-200D-1F48B-200D-1F468",c:"1F468-200D-2764-200D-1F48B-200D-1F468",d:!0,e:!0,f:!0,h:!0,k:[17,21],o:2,j:["男人与男人亲吻"]},"woman-kiss-woman":{a:"WomanKissWoman",b:"1F469-200D-2764-FE0F-200D-1F48B-200D-1F469",c:"1F469-200D-2764-200D-1F48B-200D-1F469",d:!0,e:!0,f:!0,h:!0,k:[20,8],o:2,j:["女人和女人亲吻"]},couple_with_heart:{obsoleted_by:"1F469-200D-2764-FE0F-200D-1F468",a:"CouplewithHeart",b:"1F491",d:!0,e:!0,f:!0,h:!0,k:[25,27],o:2,j:["情侣"]},"woman-heart-man":{obsoletes:"1F491",a:"WomanHeartMan",b:"1F469-200D-2764-FE0F-200D-1F468",c:"1F469-200D-2764-200D-1F468",d:!0,e:!0,f:!0,h:!0,k:[20,5],o:2,j:["异性情侣"]},"man-heart-man":{a:"ManHeartMan",b:"1F468-200D-2764-FE0F-200D-1F468",c:"1F468-200D-2764-200D-1F468",d:!0,e:!0,f:!0,h:!0,k:[17,20],o:2,j:["男性情侣"]},"woman-heart-woman":{a:"WomanHeartWoman",b:"1F469-200D-2764-FE0F-200D-1F469",c:"1F469-200D-2764-200D-1F469",d:!0,e:!0,f:!0,h:!0,k:[20,6],o:2,j:["女性情侣"]},family:{obsoleted_by:"1F468-200D-1F469-200D-1F466",a:"Family",b:"1F46A",d:!0,e:!0,f:!0,h:!0,k:[20,15],n:["man-woman-boy"],o:2,j:["家庭"]},"man-woman-boy":{obsoletes:"1F46A",a:"ManWomanBoy",b:"1F468-200D-1F469-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,33],n:["family"],o:2,j:["一位男士一位女士带一个男孩的家庭"]},"man-woman-girl":{a:"ManWomanGirl",b:"1F468-200D-1F469-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,35],o:2,j:["一位男士一位女士带一个女孩的家庭"]},"man-woman-girl-boy":{a:"ManWomanGirlBoy",b:"1F468-200D-1F469-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,36],o:2,j:["一位男士一位女士带一个男孩一个女孩的家庭"]},"man-woman-boy-boy":{a:"ManWomanBoyBoy",b:"1F468-200D-1F469-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,34],o:2,j:["一位男士一位女士带两个男孩的家庭"]},"man-woman-girl-girl":{a:"ManWomanGirlGirl",b:"1F468-200D-1F469-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,37],o:2,j:["一位男士一位女士带两个女孩的家庭"]},"man-man-boy":{a:"ManManBoy",b:"1F468-200D-1F468-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,28],o:2,j:["两位男士带一个男孩的家庭"]},"man-man-girl":{a:"ManManGirl",b:"1F468-200D-1F468-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,30],o:2,j:["两位男士带一个女孩的家庭"]},"man-man-girl-boy":{a:"ManManGirlBoy",b:"1F468-200D-1F468-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,31],o:2,j:["两位男士带一个男孩一个女孩的家庭"]},"man-man-boy-boy":{a:"ManManBoyBoy",b:"1F468-200D-1F468-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,29],o:2,j:["两位男士带两个男孩的家庭"]},"man-man-girl-girl":{a:"ManManGirlGirl",b:"1F468-200D-1F468-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,32],o:2,j:["两位男士带两个女孩的家庭"]},"woman-woman-boy":{a:"WomanWomanBoy",b:"1F469-200D-1F469-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,18],o:2,j:["两位妇女带一个男孩的家庭"]},"woman-woman-girl":{a:"WomanWomanGirl",b:"1F469-200D-1F469-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[18,20],o:2,j:["两位妇女带一个女孩的家庭"]},"woman-woman-girl-boy":{a:"WomanWomanGirlBoy",b:"1F469-200D-1F469-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,21],o:2,j:["两位妇女带一个男孩一个女孩的家庭"]},"woman-woman-boy-boy":{a:"WomanWomanBoyBoy",b:"1F469-200D-1F469-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,19],o:2,j:["两位妇女带两个男孩的家庭"]},"woman-woman-girl-girl":{a:"WomanWomanGirlGirl",b:"1F469-200D-1F469-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[18,22],o:2,j:["两位妇女带两个女孩的家庭"]},"man-boy":{a:"ManBoy",b:"1F468-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,24],o:4,j:["男士带一个男孩的家庭"]},"man-boy-boy":{a:"ManBoyBoy",b:"1F468-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,23],o:4,j:["男士带两个男孩的家庭"]},"man-girl":{a:"ManGirl",b:"1F468-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,27],o:4,j:["男士带女孩的家庭"]},"man-girl-boy":{a:"ManGirlBoy",b:"1F468-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[15,25],o:4,j:["男士带一个男孩一个女孩的家庭"]},"man-girl-girl":{a:"ManGirlGirl",b:"1F468-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[15,26],o:4,j:["男士带两个女孩的家庭"]},"woman-boy":{a:"WomanBoy",b:"1F469-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,14],o:4,j:["妇女带一个男孩的家庭"]},"woman-boy-boy":{a:"WomanBoyBoy",b:"1F469-200D-1F466-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,13],o:4,j:["妇女带两个男孩的家庭"]},"woman-girl":{a:"WomanGirl",b:"1F469-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[18,17],o:4,j:["妇女带女孩的家庭"]},"woman-girl-boy":{a:"WomanGirlBoy",b:"1F469-200D-1F467-200D-1F466",d:!0,e:!0,f:!0,h:!0,k:[18,15],o:4,j:["妇女带一个男孩一个女孩的家庭"]},"woman-girl-girl":{a:"WomanGirlGirl",b:"1F469-200D-1F467-200D-1F467",d:!0,e:!0,f:!0,h:!0,k:[18,16],o:4,j:["妇女带两个女孩的家庭"]},speaking_head_in_silhouette:{a:"SpeakingHeadinSilhouette",b:"1F5E3-FE0F",c:"1F5E3",d:!0,e:!0,f:!0,h:!0,k:[30,25],o:2,j:["说话者"]},bust_in_silhouette:{a:"BustinSilhouette",b:"1F464",d:!0,e:!0,f:!0,h:!0,j:["半身剪影","用户","人","人","user","person","human"],k:[14,24],o:2},busts_in_silhouette:{a:"BustsinSilhouette",b:"1F465",d:!0,e:!0,f:!0,h:!0,j:["半身剪影（两人）","用户","人","人","群","团队","user","person","human","group","team"],k:[14,25],o:2},footprints:{a:"Footprints",b:"1F463",d:!0,e:!0,f:!0,h:!0,j:["足迹","脚","跟踪","走","海滩","feet","tracking","walking","beach"],k:[14,23],o:2}},bq={raised_hand:"hand",satisfied:"laughing",tshirt:"shirt",hand_with_index_and_middle_fingers_crossed:"crossed_fingers",sign_of_the_horns:"the_horns",grinning_face_with_star_eyes:"star-struck",reversed_hand_with_middle_finger_extended:"middle_finger",thumbsup:"+1",thumbsdown:"-1",punch:"facepunch",grinning_face_with_one_large_and_one_small_eye:"zany_face",shoe:"mans_shoe",smiling_face_with_smiling_eyes_and_hand_covering_mouth:"face_with_hand_over_mouth",face_with_finger_covering_closed_lips:"shushing_face",face_with_one_eyebrow_raised:"face_with_raised_eyebrow",face_with_open_mouth_vomiting:"face_vomiting",cooking:"fried_egg","flag-cn":"cn",shocked_face_with_exploding_head:"exploding_head",paw_prints:"feet","flag-de":"de",telephone:"phone","flag-es":"es",red_car:"car",flipper:"dolphin","flag-fr":"fr",uk:"gb","flag-gb":"gb",serious_face_with_symbols_covering_mouth:"face_with_symbols_on_mouth",poop:"hankey",shit:"hankey",honeybee:"bee",staff_of_aesculapius:"medical_symbol",lantern:"izakaya_lantern",open_book:"book",sailboat:"boat",knife:"hocho","flag-it":"it",heavy_exclamation_mark:"exclamation","flag-jp":"jp",envelope:"email","flag-kr":"kr",collision:"boom",pencil:"memo",waxing_gibbous_moon:"moon",mother_christmas:"mrs_claus",sun_small_cloud:"mostly_sunny",sun_behind_cloud:"barely_sunny",sun_behind_rain_cloud:"partly_sunny_rain",lightning_cloud:"lightning",tornado_cloud:"tornado","flag-ru":"ru",running:"runner","flag-us":"us",women_holding_hands:"two_women_holding_hands",man_and_woman_holding_hands:"couple",woman_and_man_holding_hands:"couple",men_holding_hands:"two_men_holding_hands","man-woman-boy":"family",family:"man-woman-boy"},Mf={compressed:xq,categories:Fq,emojis:yq,aliases:bq},Eq=!1,wq=[{id:"学习办公",name:"学习办公",emojis:["newspaper-folding","notebook-one","notebook","repair","ruler","code","analysis","chart-graph","stopwatch-start","arithmetic-one","arithmetic","screenshot","pie","pie-two","pie-three","pie-four","pie-five","pie-six","pie-seven","stopwatch","mind-mapping","average","bubble-chart","curve-adjustment","trend-two","schedule","flask","triangle-ruler","chart-scatter","color-card","time","experiment-one","experiment","cuvette","test-tube","vial","book","book-one","data-sheet","data-screen","chart-pie-one","speed-one","chart-histogram-one","chart-histogram-two","chart-histogram","viencharts","thermometer","folder-one","add-text-two","text-recognition","display","picture-album","block","degree-hat","voice-input","compass","chart-proportion","chart-line-area","chart-line","histogram","bullet-map","components","maximum","min","chart-stock","kagi-map","table-lamp","pencil 1"]},{id:"数码设备",name:"数码设备",emojis:["laptop","laptop-computer","bolt-one","plug","charging-treasure","hair-dryer-one","sd-card","printer","battery-storage","sim","tv-one","digital-watches","headset-two","mac-finder","server","toolkit","cd","rocket-one","robot-one","timer","new-computer","surveillance-cameras-two","surveillance-cameras","keyboard-one","receiver","toilet","thunderbolt","iphone","poker","switch-nintendo","devices","camera-one","radio","hand-painted-plate","mouse-one","usb-one","projector-two","webcam","drone-one","drone","washing-machine-one","camera-two","cpu","speaker","seal","hard-disk","gamepad","round-socket","electronic-door-lock","camera-three","dvi","ipad","sd","usb-type-c","usb-memory-stick","disk-one","camera"]},{id:"IT",name:"IT",emojis:["shield-add","helpcenter","protect","protection","table-file","bug","file-question","code-one","file-code","folder-code","translate","share-one","share-sys","connection-box","broadcast","date-comes-back","activity-source","loading-one","file-hash","file-tips","bluetooth","connection-point","connect","link-three","link","browser","file-staff","hourglass","setting-two","setting-config","video-one","inbox","folder-focus","home","tree-list","data","database-success","database-code","database-point","database-time","data-switching","data-display","cast-screen","picture","network-tree","web-page","file-text","doc-search-two","file-excel","file-gif","file-jpg","file-pdf","file-word","file-cabinet","folder-download","file-search-two","wifi","system","picture-album","view-list","agreement","signal","file-music","audio-file","mail"]},{id:"几何符号",name:"几何符号",emojis:["misaligned-semicircle","symmetry","multi-triangular","geometric-flowers","stereo-perspective","two-triangles-two","two-ellipses","hexagon-strip","six-points","cross-ring-two","cube-three","three-hexagons","three-triangles","triangle-round-rectangle","triangular-pyramid","three-slashes","symbol-double-x","four-leaves","rectangular-circular-separation","rectangular-circular-connection","endless","asterisk","two-triangles","whirlwind","circles-seven","six-circular-connection","round-distortion","smart-optimization","cones","coordinate-system","percentage","help","caution","bitcoin","success","division","error","share-two","symbol","close","plus","plus-cross","minus","forbid","ce-marking","trademark","add-one","check-one","check","info","star","correct","attention","figma-component","vip"]},{id:"生活",name:"生活",emojis:["airpods","single-bed","hanger","door-handle","alarm-clock","sofa-two","sofa","double-bed","hanger-two","tub","hair-brush","english-mustache","cosmetic-brush","barber-clippers","face-powder","makeups","beauty-instrument","comb","shaver-one","facial-cleanser","nail-polish-one","paint 1","prescription","injection","brain","weight","cardioelectric","medicine-bottle-one","medical-box","nutrition","exchange-four","workbench","shopping","stock-market","funds","finance","gift","financing-one","wallet-one","wallet-two","financing-two","flash-payment","commodity","water-rate-two","water-rate","water-level","consume","bank-card","bachelor-cap-one","high-heeled-shoes","briefcase","basketball-clothes","necktie","slippers-one","slippers","perfume","theme","diamond-ring","diamonds","t-shirt","teeth","eyes","glasses","spanner 1"]},{id:"表情",name:"表情",emojis:["distraught-face","confused-face","frowning-face-whit-open-mouth","emotion-unhappy","grimacing-face","worried-face","upside-down-face","pouting-face","surprised-face-with-open-mouth","surprised-face-with-open-big-mouth","sly-face-whit-smile","weary-face","emotion-happy","grinning-face","slightly-frowning-face-whit-open-mouth","angry-face","disappointed-face","slightly-smiling-face","expressionless-face","face-without-mouth","smiling-face","grinning-face-with-squinting-eyes","anguished-face","winking-face","winking-face-with-open-eyes","astonished-face","grinning-face-with-tightly-closed-eyes-open-mouth","loudly-crying-face-whit-open-mouth","grinning-face-with-open-mouth","neutral-face"]},{id:"体育",name:"体育",emojis:["baseball-bat","whistling","play-volleyball","balance-one","dumbbel-line","chess-one","torch","muscle","dumbbell","baokemeng","weightlifting","basketball","court","basketball-stand","skating","volleyball","treadmill-two","treadmill","treadmill-one","riding","target-two","boxing","rope-skipping","helmet","tennis","badminton","sport","sporting","football","soccer","soccer-one","baby-feet","baby-taste","party-balloon","steoller","heart-ballon","rocking-horse","sleep 1"]},{id:"旅行地点",name:"旅行地点",emojis:["eiffel-tower","pagoda","tower-of-pisa","museum-one","castle","city-gate","city-one","city","gate","light-house","dubai","elevator","pearl-of-the-orient","windmill-one","factory-building","palace","monument-one","monument-two","building-four","building-one","building-three","church-one","church-two","hotel","arc-de-triomphe","fence-one","circus","maya","ferris-wheel","brdige-three","bridge-one","bridge-two","home-two","death-star","tower","booth","future-build-one","signal-tower-one","chimney","dome","fence-two","chinese-pavilion","clock-tower","mark","set-off","ship","sailboat-one","road-sign","steering-wheel","airplane","high-speed-rail","bus-one","cruise","aviation","sailing","passport-one","landing","cable-car","journey","tour-bus","tickets-one","mounted","flag","take-off-one","gps","hot-air-balloon","pennant","mountain","world","railway","parking","luggage","vacation","coconut-tree","camp","local","guide-board","subway","transporter"]},{id:"影音游戏",name:"影音游戏",emojis:["play","record","fm","movie","headset","arrow-keys","piano","record-disc","trophy","film","skull","voice","puzzle","poker","monitor","acoustic","handle-square","handle-triangle","handle-up","handle-down","handle-right","handle-round","handle-left","handle-a","handle-b","handle-c","handle-x","handle-y","handle-z","performance","music-one","music","music-rhythm","music-cd","movie-board","ghost","game","game-ps","game-handle","entertainment"]},{id:"动物植物",name:"动物植物",emojis:["bat","elephant","pigeon","dog","dolphin","hippo","monkey","butterfly","whale","deer","cat","owl","bee","bird","cattle","frog","dog-zodiac","monkey-zodiac","tiger-zodiac","chicken-zodiac","dragon-zodiac","horse-zodiac","cattle-zodiac","snake-zodiac","mouse-zodiac","rabbit-zodiac","sheep-zodiac","pig-zodiac","koala-bear","rabbit","bear","panda","duck","eagle","fish-one","pig","pinwheel","windmill-two","fruiter","outdoor","blossom","fire-two","bloom","christmas-tree","tree","tree-one","sapling","leaves","christmas-tree-one","cactus","leaves-two","seedling"]},{id:"食物饮料",name:"食物饮料",emojis:["lollipop","icecream-three","icecream-two","pineapple","fork-spoon","tea","shovel-one","orange","chef-hat-one","garlic","shrimp","cake-three","cake","oven","tomato","goblet","bone","juice","hamburger","carrot","chafing-dish-one","hot-pot-one","hot-pot","chicken","chicken-leg","liqueur","measuring-cup","eggplant","nut","egg","bottle-one","chopsticks-fork","chili","pear","rice","bread-one","bread","bowl","noodles","cheese","pumpkin","lemon","orange-one","milk-one","milk","avocado-one","crab","cooking","beer","beer-mug","apple-one","bottle-two","vegetables","barbecue","birthday-cake","candy","peach","doughnut","shovel","pot","spoon","peas","bowl-one","watermelon","banana","icecream-one","drink","cherry","chafing-dish","french-fries"]},{id:"品牌",name:"品牌",emojis:["android","tiktok","messages","new-lark","google","health","facebook-one","facebook","browser-chrome","browser-safari","friends-circle","apple","ulikecam","facetime","taobao","twitter","weibo","windows","wechat","app-store","youtube","alipay","dribble","bytedance","adobe-illustrate","adobe-indesign","adobe-lightroom","adobe-photoshop","behance","figma","foursquare","github","github-one","gitlab","html-five","instagram-one","instagram","paypal","sketch","telegram","tumblr"]}],kq={"newspaper-folding":{name:"newspaper-folding",keywords:["报纸折叠","newspaper-folding"]},"notebook-one":{name:"notebook-one",keywords:["笔记本","notebook-one"]},notebook:{name:"notebook",keywords:["笔记本","notebook"]},repair:{name:"repair",keywords:["编辑","repair"]},ruler:{name:"ruler",keywords:["尺子","ruler"]},code:{name:"code",keywords:["代码","code"]},analysis:{name:"analysis",keywords:["分析","analysis"]},"chart-graph":{name:"chart-graph",keywords:["关系图","chart-graph"]},"stopwatch-start":{name:"stopwatch-start",keywords:["计时器","stopwatch-start"]},"arithmetic-one":{name:"arithmetic-one",keywords:["计算","arithmetic-one"]},arithmetic:{name:"arithmetic",keywords:["计算","arithmetic"]},screenshot:{name:"screenshot",keywords:["截屏","screenshot"]},pie:{name:"pie",keywords:["进度","pie"]},"pie-two":{name:"pie-two",keywords:["进度2","pie-two"]},"pie-three":{name:"pie-three",keywords:["进度3","pie-three"]},"pie-four":{name:"pie-four",keywords:["进度4","pie-four"]},"pie-five":{name:"pie-five",keywords:["进度5","pie-five"]},"pie-six":{name:"pie-six",keywords:["进度6","pie-six"]},"pie-seven":{name:"pie-seven",keywords:["进度7","pie-seven"]},stopwatch:{name:"stopwatch",keywords:["秒表","stopwatch"]},"mind-mapping":{name:"mind-mapping",keywords:["脑图","mind-mapping"]},average:{name:"average",keywords:["平均值","average"]},"bubble-chart":{name:"bubble-chart",keywords:["气泡图","bubble-chart"]},"curve-adjustment":{name:"curve-adjustment",keywords:["曲线调整","curve-adjustment"]},"trend-two":{name:"trend-two",keywords:["趋势","trend-two"]},schedule:{name:"schedule",keywords:["日程表","schedule"]},flask:{name:"flask",keywords:["三角杯","flask"]},"triangle-ruler":{name:"triangle-ruler",keywords:["三角尺","triangle-ruler"]},"chart-scatter":{name:"chart-scatter",keywords:["散点图","chart-scatter"]},"color-card":{name:"color-card",keywords:["色卡","color-card"]},time:{name:"time",keywords:["时间","time"]},"experiment-one":{name:"experiment-one",keywords:["实验","experiment-one"]},experiment:{name:"experiment",keywords:["实验","experiment"]},cuvette:{name:"cuvette",keywords:["试管","cuvette"]},"test-tube":{name:"test-tube",keywords:["试管","test-tube"]},vial:{name:"vial",keywords:["试管","vial"]},book:{name:"book",keywords:["书籍","book"]},"book-one":{name:"book-one",keywords:["书籍1","book-one"]},"data-sheet":{name:"data-sheet",keywords:["数据表","data-sheet"]},"data-screen":{name:"data-screen",keywords:["数据看板","data-screen"]},"chart-pie-one":{name:"chart-pie-one",keywords:["数据图","chart-pie-one"]},"speed-one":{name:"speed-one",keywords:["速度","speed-one"]},"chart-histogram-one":{name:"chart-histogram-one",keywords:["条形图","chart-histogram-one"]},"chart-histogram-two":{name:"chart-histogram-two",keywords:["条形图","chart-histogram-two"]},"chart-histogram":{name:"chart-histogram",keywords:["条形图","chart-histogram"]},viencharts:{name:"viencharts",keywords:["维恩图","viencharts"]},thermometer:{name:"thermometer",keywords:["温度计","thermometer"]},"folder-one":{name:"folder-one",keywords:["文件夹1","folder-one"]},"add-text-two":{name:"add-text-two",keywords:["文字","add-text-two"]},"text-recognition":{name:"text-recognition",keywords:["文字识别","text-recognition"]},display:{name:"display",keywords:["显示屏","display"]},"picture-album":{name:"picture-album",keywords:["相册","picture-album"]},block:{name:"block",keywords:["行内公式","block"]},"degree-hat":{name:"degree-hat",keywords:["学位帽","degree-hat"]},"voice-input":{name:"voice-input",keywords:["语音文字","voice-input"]},compass:{name:"compass",keywords:["圆规","compass"]},"chart-proportion":{name:"chart-proportion",keywords:["占比图","chart-proportion"]},"chart-line-area":{name:"chart-line-area",keywords:["折线面积图","chart-line-area"]},"chart-line":{name:"chart-line",keywords:["折线图","chart-line"]},histogram:{name:"histogram",keywords:["直方图","histogram"]},"bullet-map":{name:"bullet-map",keywords:["子弹图","bullet-map"]},components:{name:"components",keywords:["组件","components"]},maximum:{name:"maximum",keywords:["最大值","maximum"]},min:{name:"min",keywords:["最小值","min"]},"chart-stock":{name:"chart-stock",keywords:["K线图","chart-stock"]},"kagi-map":{name:"kagi-map",keywords:["kagi图","kagi-map"]},"table-lamp":{name:"table-lamp",keywords:["台灯","table-lamp"]},"pencil 1":{name:"pencil 1",keywords:["铅笔","pencil 1"]},laptop:{name:"laptop",keywords:["笔记本","laptop"]},"laptop-computer":{name:"laptop-computer",keywords:["笔记本电脑","laptop-computer"]},"bolt-one":{name:"bolt-one",keywords:["插头","bolt-one"]},plug:{name:"plug",keywords:["插头","plug"]},"charging-treasure":{name:"charging-treasure",keywords:["充电宝","charging-treasure"]},"hair-dryer-one":{name:"hair-dryer-one",keywords:["吹风机","hair-dryer-one"]},"sd-card":{name:"sd-card",keywords:["存储卡","sd-card"]},printer:{name:"printer",keywords:["打印机","printer"]},"battery-storage":{name:"battery-storage",keywords:["电池充电","battery-storage"]},sim:{name:"sim",keywords:["电话卡","sim"]},"tv-one":{name:"tv-one",keywords:["电视","tv-one"]},"digital-watches":{name:"digital-watches",keywords:["电子表","digital-watches"]},"headset-two":{name:"headset-two",keywords:["耳机","headset-two"]},"mac-finder":{name:"mac-finder",keywords:["访达","mac-finder"]},server:{name:"server",keywords:["服务器","server"]},toolkit:{name:"toolkit",keywords:["工具箱","toolkit"]},cd:{name:"cd",keywords:["光盘","cd"]},"rocket-one":{name:"rocket-one",keywords:["火箭","rocket-one"]},"robot-one":{name:"robot-one",keywords:["机器人1","robot-one"]},timer:{name:"timer",keywords:["计时器","timer"]},"new-computer":{name:"new-computer",keywords:["计算机","new-computer"]},"surveillance-cameras-two":{name:"surveillance-cameras-two",keywords:["监控摄像头","surveillance-cameras-two"]},"surveillance-cameras":{name:"surveillance-cameras",keywords:["监控摄像头","surveillance-cameras"]},"keyboard-one":{name:"keyboard-one",keywords:["键盘","keyboard-one"]},receiver:{name:"receiver",keywords:["接收器","receiver"]},toilet:{name:"toilet",keywords:["马桶","toilet"]},thunderbolt:{name:"thunderbolt",keywords:["霹雳接口","thunderbolt"]},iphone:{name:"iphone",keywords:["苹果手机","iphone"]},poker:{name:"poker",keywords:["扑克","poker"]},"switch-nintendo":{name:"switch-nintendo",keywords:["任天堂游戏","switch-nintendo"]},devices:{name:"devices",keywords:["设备","devices"]},"camera-one":{name:"camera-one",keywords:["摄像头","camera-one"]},radio:{name:"radio",keywords:["收音机","radio"]},"hand-painted-plate":{name:"hand-painted-plate",keywords:["手绘板","hand-painted-plate"]},"mouse-one":{name:"mouse-one",keywords:["鼠标","mouse-one"]},"usb-one":{name:"usb-one",keywords:["数据接口","usb-one"]},"projector-two":{name:"projector-two",keywords:["投影仪","projector-two"]},webcam:{name:"webcam",keywords:["网络摄像头","webcam"]},"drone-one":{name:"drone-one",keywords:["无人机","drone-one"]},drone:{name:"drone",keywords:["无人机","drone"]},"washing-machine-one":{name:"washing-machine-one",keywords:["洗衣机1","washing-machine-one"]},"camera-two":{name:"camera-two",keywords:["相机","camera-two"]},cpu:{name:"cpu",keywords:["芯片","cpu"]},speaker:{name:"speaker",keywords:["音响","speaker"]},seal:{name:"seal",keywords:["印章","seal"]},"hard-disk":{name:"hard-disk",keywords:["硬盘","hard-disk"]},gamepad:{name:"gamepad",keywords:["游戏机","gamepad"]},"round-socket":{name:"round-socket",keywords:["圆形插座","round-socket"]},"electronic-door-lock":{name:"electronic-door-lock",keywords:["智能门锁","electronic-door-lock"]},"camera-three":{name:"camera-three",keywords:["智能摄像头","camera-three"]},dvi:{name:"dvi",keywords:["DVI","dvi"]},ipad:{name:"ipad",keywords:["Ipad","ipad"]},sd:{name:"sd",keywords:["SD卡","sd"]},"usb-type-c":{name:"usb-type-c",keywords:["TypeC","usb-type-c"]},"usb-memory-stick":{name:"usb-memory-stick",keywords:["U盘","usb-memory-stick"]},"disk-one":{name:"disk-one",keywords:["U盘1","disk-one"]},camera:{name:"camera",keywords:["相机","camera"]},"shield-add":{name:"shield-add",keywords:["安全增加","shield-add"]},helpcenter:{name:"helpcenter",keywords:["帮助中心","helpcenter"]},protect:{name:"protect",keywords:["保护","protect"]},protection:{name:"protection",keywords:["保护","protection"]},"table-file":{name:"table-file",keywords:["表格","table-file"]},bug:{name:"bug",keywords:["程序问题","bug"]},"file-question":{name:"file-question",keywords:["存疑文件","file-question"]},"code-one":{name:"code-one",keywords:["代码1","code-one"]},"file-code":{name:"file-code",keywords:["代码文件","file-code"]},"folder-code":{name:"folder-code",keywords:["代码文件夹","folder-code"]},translate:{name:"translate",keywords:["翻译","translate"]},"share-one":{name:"share-one",keywords:["分享","share-one"]},"share-sys":{name:"share-sys",keywords:["分享","share-sys"]},"connection-box":{name:"connection-box",keywords:["分组","connection-box"]},broadcast:{name:"broadcast",keywords:["广播","broadcast"]},"date-comes-back":{name:"date-comes-back",keywords:["回传数据","date-comes-back"]},"activity-source":{name:"activity-source",keywords:["活动源","activity-source"]},"loading-one":{name:"loading-one",keywords:["加载","loading-one"]},"file-hash":{name:"file-hash",keywords:["井号文件","file-hash"]},"file-tips":{name:"file-tips",keywords:["警示文件","file-tips"]},bluetooth:{name:"bluetooth",keywords:["蓝牙","bluetooth"]},"connection-point":{name:"connection-point",keywords:["连接点","connection-point"]},connect:{name:"connect",keywords:["链接","connect"]},"link-three":{name:"link-three",keywords:["链接","link-three"]},link:{name:"link",keywords:["链接","link"]},browser:{name:"browser",keywords:["浏览器","browser"]},"file-staff":{name:"file-staff",keywords:["人事文件","file-staff"]},hourglass:{name:"hourglass",keywords:["沙漏","hourglass"]},"setting-two":{name:"setting-two",keywords:["设置","setting-two"]},"setting-config":{name:"setting-config",keywords:["设置配置","setting-config"]},"video-one":{name:"video-one",keywords:["视频","video-one"]},inbox:{name:"inbox",keywords:["收件箱","inbox"]},"folder-focus":{name:"folder-focus",keywords:["收藏文件夹","folder-focus"]},home:{name:"home",keywords:["首页","home"]},"tree-list":{name:"tree-list",keywords:["树结构","tree-list"]},data:{name:"data",keywords:["数据库","data"]},"database-success":{name:"database-success",keywords:["数据库成功","database-success"]},"database-code":{name:"database-code",keywords:["数据库代码","database-code"]},"database-point":{name:"database-point",keywords:["数据库节点","database-point"]},"database-time":{name:"database-time",keywords:["数据库时间","database-time"]},"data-switching":{name:"data-switching",keywords:["数据切换","data-switching"]},"data-display":{name:"data-display",keywords:["数据显示","data-display"]},"cast-screen":{name:"cast-screen",keywords:["投射屏幕","cast-screen"]},picture:{name:"picture",keywords:["图片","picture"]},"network-tree":{name:"network-tree",keywords:["网络节点","network-tree"]},"web-page":{name:"web-page",keywords:["网页","web-page"]},"file-text":{name:"file-text",keywords:["文本文件","file-text"]},"doc-search-two":{name:"doc-search-two",keywords:["文档搜索","doc-search-two"]},"file-excel":{name:"file-excel",keywords:["文件-excel","file-excel"]},"file-gif":{name:"file-gif",keywords:["文件-gif","file-gif"]},"file-jpg":{name:"file-jpg",keywords:["文件-jpg","file-jpg"]},"file-pdf":{name:"file-pdf",keywords:["文件-pdf","file-pdf"]},"file-word":{name:"file-word",keywords:["文件-word","file-word"]},"file-cabinet":{name:"file-cabinet",keywords:["文件柜","file-cabinet"]},"folder-download":{name:"folder-download",keywords:["文件夹-下载","folder-download"]},"file-search-two":{name:"file-search-two",keywords:["文件搜索","file-search-two"]},wifi:{name:"wifi",keywords:["无线网络","wifi"]},system:{name:"system",keywords:["系统","system"]},"view-list":{name:"view-list",keywords:["详情列表","view-list"]},agreement:{name:"agreement",keywords:["协议","agreement"]},signal:{name:"signal",keywords:["信号","signal"]},"file-music":{name:"file-music",keywords:["音乐文件","file-music"]},"audio-file":{name:"audio-file",keywords:["音频文件","audio-file"]},mail:{name:"mail",keywords:["邮件","mail"]},"misaligned-semicircle":{name:"misaligned-semicircle",keywords:["半圆","misaligned-semicircle"]},symmetry:{name:"symmetry",keywords:["对称","symmetry"]},"multi-triangular":{name:"multi-triangular",keywords:["多三角","multi-triangular"]},"geometric-flowers":{name:"geometric-flowers",keywords:["几何花","geometric-flowers"]},"stereo-perspective":{name:"stereo-perspective",keywords:["立体透视","stereo-perspective"]},"two-triangles-two":{name:"two-triangles-two",keywords:["两个三角","two-triangles-two"]},"two-ellipses":{name:"two-ellipses",keywords:["两个椭圆","two-ellipses"]},"hexagon-strip":{name:"hexagon-strip",keywords:["六边条","hexagon-strip"]},"six-points":{name:"six-points",keywords:["六个点","six-points"]},"cross-ring-two":{name:"cross-ring-two",keywords:["魔比斯环","cross-ring-two"]},"cube-three":{name:"cube-three",keywords:["魔方","cube-three"]},"three-hexagons":{name:"three-hexagons",keywords:["三个菱形","three-hexagons"]},"three-triangles":{name:"three-triangles",keywords:["三个三角","three-triangles"]},"triangle-round-rectangle":{name:"triangle-round-rectangle",keywords:["三角圆矩形","triangle-round-rectangle"]},"triangular-pyramid":{name:"triangular-pyramid",keywords:["三棱锥","triangular-pyramid"]},"three-slashes":{name:"three-slashes",keywords:["三斜杠","three-slashes"]},"symbol-double-x":{name:"symbol-double-x",keywords:["双X符号","symbol-double-x"]},"four-leaves":{name:"four-leaves",keywords:["四片叶子","four-leaves"]},"rectangular-circular-separation":{name:"rectangular-circular-separation",keywords:["图形分割","rectangular-circular-separation"]},"rectangular-circular-connection":{name:"rectangular-circular-connection",keywords:["图形连接","rectangular-circular-connection"]},endless:{name:"endless",keywords:["无穷尽","endless"]},asterisk:{name:"asterisk",keywords:["星号","asterisk"]},"two-triangles":{name:"two-triangles",keywords:["星星","two-triangles"]},whirlwind:{name:"whirlwind",keywords:["旋风","whirlwind"]},"circles-seven":{name:"circles-seven",keywords:["圆圈","circles-seven"]},"six-circular-connection":{name:"six-circular-connection",keywords:["圆形连接","six-circular-connection"]},"round-distortion":{name:"round-distortion",keywords:["圆形扭曲","round-distortion"]},"smart-optimization":{name:"smart-optimization",keywords:["智能优化","smart-optimization"]},cones:{name:"cones",keywords:["坐标系","cones"]},"coordinate-system":{name:"coordinate-system",keywords:["坐标系统","coordinate-system"]},percentage:{name:"percentage",keywords:["百分号","percentage"]},help:{name:"help",keywords:["帮助","help"]},caution:{name:"caution",keywords:["报错","caution"]},bitcoin:{name:"bitcoin",keywords:["比特币","bitcoin"]},success:{name:"success",keywords:["成功","success"]},division:{name:"division",keywords:["除号","division"]},error:{name:"error",keywords:["错误","error"]},"share-two":{name:"share-two",keywords:["分享2","share-two"]},symbol:{name:"symbol",keywords:["符号","symbol"]},close:{name:"close",keywords:["关闭","close"]},plus:{name:"plus",keywords:["加","plus"]},"plus-cross":{name:"plus-cross",keywords:["加号","plus-cross"]},minus:{name:"minus",keywords:["减","minus"]},forbid:{name:"forbid",keywords:["禁止","forbid"]},"ce-marking":{name:"ce-marking",keywords:["欧洲市场","ce-marking"]},trademark:{name:"trademark",keywords:["商标符号","trademark"]},"add-one":{name:"add-one",keywords:["添加","add-one"]},"check-one":{name:"check-one",keywords:["校验","check-one"]},check:{name:"check",keywords:["校验","check"]},info:{name:"info",keywords:["信息","info"]},star:{name:"star",keywords:["星星","star"]},correct:{name:"correct",keywords:["正确的","correct"]},attention:{name:"attention",keywords:["注意","attention"]},"figma-component":{name:"figma-component",keywords:["组件","figma-component"]},vip:{name:"vip",keywords:["VIP","vip"]},airpods:{name:"airpods",keywords:["AirPods","airpods"]},"single-bed":{name:"single-bed",keywords:["单人床","single-bed"]},hanger:{name:"hanger",keywords:["晾衣架","hanger"]},"door-handle":{name:"door-handle",keywords:["门把手","door-handle"]},"alarm-clock":{name:"alarm-clock",keywords:["闹钟","alarm-clock"]},"sofa-two":{name:"sofa-two",keywords:["沙发","sofa-two"]},sofa:{name:"sofa",keywords:["沙发","sofa"]},"double-bed":{name:"double-bed",keywords:["双人床","double-bed"]},"hanger-two":{name:"hanger-two",keywords:["衣架","hanger-two"]},tub:{name:"tub",keywords:["浴缸","tub"]},"hair-brush":{name:"hair-brush",keywords:["发梳","hair-brush"]},"english-mustache":{name:"english-mustache",keywords:["胡子","english-mustache"]},"cosmetic-brush":{name:"cosmetic-brush",keywords:["化妆刷","cosmetic-brush"]},"barber-clippers":{name:"barber-clippers",keywords:["理发剪","barber-clippers"]},"face-powder":{name:"face-powder",keywords:["脸粉","face-powder"]},makeups:{name:"makeups",keywords:["美容","makeups"]},"beauty-instrument":{name:"beauty-instrument",keywords:["美容仪","beauty-instrument"]},comb:{name:"comb",keywords:["梳子","comb"]},"shaver-one":{name:"shaver-one",keywords:["剃须刀","shaver-one"]},"facial-cleanser":{name:"facial-cleanser",keywords:["洗面奶","facial-cleanser"]},"nail-polish-one":{name:"nail-polish-one",keywords:["指甲油1","nail-polish-one"]},"paint 1":{name:"paint 1",keywords:["化妆刷","paint 1"]},prescription:{name:"prescription",keywords:["处方","prescription"]},injection:{name:"injection",keywords:["打针","injection"]},brain:{name:"brain",keywords:["大脑","brain"]},weight:{name:"weight",keywords:["体重","weight"]},cardioelectric:{name:"cardioelectric",keywords:["心电","cardioelectric"]},"medicine-bottle-one":{name:"medicine-bottle-one",keywords:["药瓶","medicine-bottle-one"]},"medical-box":{name:"medical-box",keywords:["医疗箱","medical-box"]},nutrition:{name:"nutrition",keywords:["营养","nutrition"]},"exchange-four":{name:"exchange-four",keywords:["兑换4","exchange-four"]},workbench:{name:"workbench",keywords:["工作台","workbench"]},shopping:{name:"shopping",keywords:["购物车","shopping"]},"stock-market":{name:"stock-market",keywords:["股市","stock-market"]},funds:{name:"funds",keywords:["基金","funds"]},finance:{name:"finance",keywords:["金融","finance"]},gift:{name:"gift",keywords:["礼物","gift"]},"financing-one":{name:"financing-one",keywords:["理财","financing-one"]},"wallet-one":{name:"wallet-one",keywords:["钱包","wallet-one"]},"wallet-two":{name:"wallet-two",keywords:["钱包","wallet-two"]},"financing-two":{name:"financing-two",keywords:["融资2","financing-two"]},"flash-payment":{name:"flash-payment",keywords:["闪付","flash-payment"]},commodity:{name:"commodity",keywords:["商品","commodity"]},"water-rate-two":{name:"water-rate-two",keywords:["水电费","water-rate-two"]},"water-rate":{name:"water-rate",keywords:["水费","water-rate"]},"water-level":{name:"water-level",keywords:["水位线","water-level"]},consume:{name:"consume",keywords:["消费","consume"]},"bank-card":{name:"bank-card",keywords:["银行卡","bank-card"]},"bachelor-cap-one":{name:"bachelor-cap-one",keywords:["博士帽1","bachelor-cap-one"]},"high-heeled-shoes":{name:"high-heeled-shoes",keywords:["高跟鞋","high-heeled-shoes"]},briefcase:{name:"briefcase",keywords:["公文包","briefcase"]},"basketball-clothes":{name:"basketball-clothes",keywords:["篮球服","basketball-clothes"]},necktie:{name:"necktie",keywords:["领带","necktie"]},"slippers-one":{name:"slippers-one",keywords:["拖鞋","slippers-one"]},slippers:{name:"slippers",keywords:["拖鞋","slippers"]},perfume:{name:"perfume",keywords:["香水","perfume"]},theme:{name:"theme",keywords:["主题","theme"]},"diamond-ring":{name:"diamond-ring",keywords:["钻戒","diamond-ring"]},diamonds:{name:"diamonds",keywords:["钻石","diamonds"]},"t-shirt":{name:"t-shirt",keywords:["T恤","t-shirt"]},teeth:{name:"teeth",keywords:["牙齿","teeth"]},eyes:{name:"eyes",keywords:["眼睛","eyes"]},glasses:{name:"glasses",keywords:["眼镜","glasses"]},"spanner 1":{name:"spanner 1",keywords:["扳手","spanner 1"]},"distraught-face":{name:"distraught-face",keywords:["闭眼生气","distraught-face"]},"confused-face":{name:"confused-face",keywords:["别嘴","confused-face"]},"frowning-face-whit-open-mouth":{name:"frowning-face-whit-open-mouth",keywords:["别嘴生气","frowning-face-whit-open-mouth"]},"emotion-unhappy":{name:"emotion-unhappy",keywords:["不开心","emotion-unhappy"]},"grimacing-face":{name:"grimacing-face",keywords:["呲牙张嘴","grimacing-face"]},"worried-face":{name:"worried-face",keywords:["担心","worried-face"]},"upside-down-face":{name:"upside-down-face",keywords:["翻转笑脸","upside-down-face"]},"pouting-face":{name:"pouting-face",keywords:["愤怒","pouting-face"]},"surprised-face-with-open-mouth":{name:"surprised-face-with-open-mouth",keywords:["惊讶","surprised-face-with-open-mouth"]},"surprised-face-with-open-big-mouth":{name:"surprised-face-with-open-big-mouth",keywords:["惊讶张嘴","surprised-face-with-open-big-mouth"]},"sly-face-whit-smile":{name:"sly-face-whit-smile",keywords:["囧笑","sly-face-whit-smile"]},"weary-face":{name:"weary-face",keywords:["沮丧","weary-face"]},"emotion-happy":{name:"emotion-happy",keywords:["开心","emotion-happy"]},"grinning-face":{name:"grinning-face",keywords:["开心","grinning-face"]},"slightly-frowning-face-whit-open-mouth":{name:"slightly-frowning-face-whit-open-mouth",keywords:["轻微沮丧","slightly-frowning-face-whit-open-mouth"]},"angry-face":{name:"angry-face",keywords:["生气","angry-face"]},"disappointed-face":{name:"disappointed-face",keywords:["失落","disappointed-face"]},"slightly-smiling-face":{name:"slightly-smiling-face",keywords:["微笑","slightly-smiling-face"]},"expressionless-face":{name:"expressionless-face",keywords:["无语脸","expressionless-face"]},"face-without-mouth":{name:"face-without-mouth",keywords:["无嘴脸","face-without-mouth"]},"smiling-face":{name:"smiling-face",keywords:["笑脸","smiling-face"]},"grinning-face-with-squinting-eyes":{name:"grinning-face-with-squinting-eyes",keywords:["笑眯眼","grinning-face-with-squinting-eyes"]},"anguished-face":{name:"anguished-face",keywords:["圆嘴","anguished-face"]},"winking-face":{name:"winking-face",keywords:["眨眼睛","winking-face"]},"winking-face-with-open-eyes":{name:"winking-face-with-open-eyes",keywords:["眨一个眼睛","winking-face-with-open-eyes"]},"astonished-face":{name:"astonished-face",keywords:["张大嘴","astonished-face"]},"grinning-face-with-tightly-closed-eyes-open-mouth":{name:"grinning-face-with-tightly-closed-eyes-open-mouth",keywords:["张嘴闭眼笑","grinning-face-with-tightly-closed-eyes-open-mouth"]},"loudly-crying-face-whit-open-mouth":{name:"loudly-crying-face-whit-open-mouth",keywords:["张嘴哭","loudly-crying-face-whit-open-mouth"]},"grinning-face-with-open-mouth":{name:"grinning-face-with-open-mouth",keywords:["张嘴笑","grinning-face-with-open-mouth"]},"neutral-face":{name:"neutral-face",keywords:["正常标签","neutral-face"]},"baseball-bat":{name:"baseball-bat",keywords:["棒球棍","baseball-bat"]},whistling:{name:"whistling",keywords:["吹哨","whistling"]},"play-volleyball":{name:"play-volleyball",keywords:["打排球","play-volleyball"]},"balance-one":{name:"balance-one",keywords:["电子秤","balance-one"]},"dumbbel-line":{name:"dumbbel-line",keywords:["杠铃","dumbbel-line"]},"chess-one":{name:"chess-one",keywords:["国际象棋","chess-one"]},torch:{name:"torch",keywords:["火炬","torch"]},muscle:{name:"muscle",keywords:["肌肉","muscle"]},dumbbell:{name:"dumbbell",keywords:["健身","dumbbell"]},baokemeng:{name:"baokemeng",keywords:["精灵球","baokemeng"]},weightlifting:{name:"weightlifting",keywords:["举重","weightlifting"]},basketball:{name:"basketball",keywords:["篮球","basketball"]},court:{name:"court",keywords:["篮球场","court"]},"basketball-stand":{name:"basketball-stand",keywords:["篮球架","basketball-stand"]},skating:{name:"skating",keywords:["溜冰鞋","skating"]},volleyball:{name:"volleyball",keywords:["排球","volleyball"]},"treadmill-two":{name:"treadmill-two",keywords:["跑步机","treadmill-two"]},treadmill:{name:"treadmill",keywords:["跑步机","treadmill"]},"treadmill-one":{name:"treadmill-one",keywords:["跑步机1","treadmill-one"]},riding:{name:"riding",keywords:["骑自行车","riding"]},"target-two":{name:"target-two",keywords:["枪靶","target-two"]},boxing:{name:"boxing",keywords:["拳击","boxing"]},"rope-skipping":{name:"rope-skipping",keywords:["跳绳","rope-skipping"]},helmet:{name:"helmet",keywords:["头盔","helmet"]},tennis:{name:"tennis",keywords:["网球","tennis"]},badminton:{name:"badminton",keywords:["羽毛球","badminton"]},sport:{name:"sport",keywords:["运动","sport"]},sporting:{name:"sporting",keywords:["运动","sporting"]},football:{name:"football",keywords:["足球","football"]},soccer:{name:"soccer",keywords:["足球","soccer"]},"soccer-one":{name:"soccer-one",keywords:["足球1","soccer-one"]},"baby-feet":{name:"baby-feet",keywords:["脚掌","baby-feet"]},"baby-taste":{name:"baby-taste",keywords:["品尝","baby-taste"]},"party-balloon":{name:"party-balloon",keywords:["气球","party-balloon"]},steoller:{name:"steoller",keywords:["童车","steoller"]},"heart-ballon":{name:"heart-ballon",keywords:["心形气球","heart-ballon"]},"rocking-horse":{name:"rocking-horse",keywords:["摇马","rocking-horse"]},"sleep 1":{name:"sleep 1",keywords:["睡眠","sleep 1"]},"eiffel-tower":{name:"eiffel-tower",keywords:["埃菲尔铁塔","eiffel-tower"]},pagoda:{name:"pagoda",keywords:["宝塔","pagoda"]},"tower-of-pisa":{name:"tower-of-pisa",keywords:["比萨斜塔","tower-of-pisa"]},"museum-one":{name:"museum-one",keywords:["博物馆","museum-one"]},castle:{name:"castle",keywords:["城堡","castle"]},"city-gate":{name:"city-gate",keywords:["城门","city-gate"]},"city-one":{name:"city-one",keywords:["城市","city-one"]},city:{name:"city",keywords:["城市","city"]},gate:{name:"gate",keywords:["大门","gate"]},"light-house":{name:"light-house",keywords:["灯塔","light-house"]},dubai:{name:"dubai",keywords:["迪拜大厦","dubai"]},elevator:{name:"elevator",keywords:["电梯","elevator"]},"pearl-of-the-orient":{name:"pearl-of-the-orient",keywords:["东方明珠","pearl-of-the-orient"]},"windmill-one":{name:"windmill-one",keywords:["风车","windmill-one"]},"factory-building":{name:"factory-building",keywords:["工厂","factory-building"]},palace:{name:"palace",keywords:["宫殿","palace"]},"monument-one":{name:"monument-one",keywords:["纪念碑","monument-one"]},"monument-two":{name:"monument-two",keywords:["纪念碑","monument-two"]},"building-four":{name:"building-four",keywords:["建筑","building-four"]},"building-one":{name:"building-one",keywords:["建筑","building-one"]},"building-three":{name:"building-three",keywords:["建筑","building-three"]},"church-one":{name:"church-one",keywords:["教堂","church-one"]},"church-two":{name:"church-two",keywords:["教堂","church-two"]},hotel:{name:"hotel",keywords:["酒店","hotel"]},"arc-de-triomphe":{name:"arc-de-triomphe",keywords:["凯旋门","arc-de-triomphe"]},"fence-one":{name:"fence-one",keywords:["栏栅","fence-one"]},circus:{name:"circus",keywords:["马戏团","circus"]},maya:{name:"maya",keywords:["玛雅","maya"]},"ferris-wheel":{name:"ferris-wheel",keywords:["摩天轮","ferris-wheel"]},"brdige-three":{name:"brdige-three",keywords:["桥","brdige-three"]},"bridge-one":{name:"bridge-one",keywords:["桥","bridge-one"]},"bridge-two":{name:"bridge-two",keywords:["桥","bridge-two"]},"home-two":{name:"home-two",keywords:["首页","home-two"]},"death-star":{name:"death-star",keywords:["死亡之星","death-star"]},tower:{name:"tower",keywords:["塔楼","tower"]},booth:{name:"booth",keywords:["摊位","booth"]},"future-build-one":{name:"future-build-one",keywords:["未来大厦","future-build-one"]},"signal-tower-one":{name:"signal-tower-one",keywords:["信号塔","signal-tower-one"]},chimney:{name:"chimney",keywords:["烟筒","chimney"]},dome:{name:"dome",keywords:["圆顶","dome"]},"fence-two":{name:"fence-two",keywords:["栅栏","fence-two"]},"chinese-pavilion":{name:"chinese-pavilion",keywords:["中国楼阁","chinese-pavilion"]},"clock-tower":{name:"clock-tower",keywords:["钟楼","clock-tower"]},mark:{name:"mark",keywords:["标记","mark"]},"set-off":{name:"set-off",keywords:["出发","set-off"]},ship:{name:"ship",keywords:["船","ship"]},"sailboat-one":{name:"sailboat-one",keywords:["帆船1","sailboat-one"]},"road-sign":{name:"road-sign",keywords:["方向标识","road-sign"]},"steering-wheel":{name:"steering-wheel",keywords:["方向盘","steering-wheel"]},airplane:{name:"airplane",keywords:["飞机","airplane"]},"high-speed-rail":{name:"high-speed-rail",keywords:["高铁","high-speed-rail"]},"bus-one":{name:"bus-one",keywords:["公交","bus-one"]},cruise:{name:"cruise",keywords:["航海","cruise"]},aviation:{name:"aviation",keywords:["航空","aviation"]},sailing:{name:"sailing",keywords:["航行","sailing"]},"passport-one":{name:"passport-one",keywords:["护照","passport-one"]},landing:{name:"landing",keywords:["降落","landing"]},"cable-car":{name:"cable-car",keywords:["缆车","cable-car"]},journey:{name:"journey",keywords:["旅行","journey"]},"tour-bus":{name:"tour-bus",keywords:["旅游巴士","tour-bus"]},"tickets-one":{name:"tickets-one",keywords:["门票","tickets-one"]},mounted:{name:"mounted",keywords:["摩托","mounted"]},flag:{name:"flag",keywords:["旗子","flag"]},"take-off-one":{name:"take-off-one",keywords:["起飞","take-off-one"]},gps:{name:"gps",keywords:["汽车导航","gps"]},"hot-air-balloon":{name:"hot-air-balloon",keywords:["热气球","hot-air-balloon"]},pennant:{name:"pennant",keywords:["三角旗","pennant"]},mountain:{name:"mountain",keywords:["山","mountain"]},world:{name:"world",keywords:["世界","world"]},railway:{name:"railway",keywords:["铁路","railway"]},parking:{name:"parking",keywords:["停车场","parking"]},luggage:{name:"luggage",keywords:["行李箱","luggage"]},vacation:{name:"vacation",keywords:["椰树","vacation"]},"coconut-tree":{name:"coconut-tree",keywords:["椰子树","coconut-tree"]},camp:{name:"camp",keywords:["野营","camp"]},local:{name:"local",keywords:["已定位","local"]},"guide-board":{name:"guide-board",keywords:["指示牌","guide-board"]},subway:{name:"subway",keywords:["地铁","subway"]},transporter:{name:"transporter",keywords:["送货车","transporter"]},play:{name:"play",keywords:["播放","play"]},record:{name:"record",keywords:["唱片集","record"]},fm:{name:"fm",keywords:["电台","fm"]},movie:{name:"movie",keywords:["电影","movie"]},headset:{name:"headset",keywords:["耳机","headset"]},"arrow-keys":{name:"arrow-keys",keywords:["方向键","arrow-keys"]},piano:{name:"piano",keywords:["钢琴","piano"]},"record-disc":{name:"record-disc",keywords:["光盘","record-disc"]},trophy:{name:"trophy",keywords:["奖杯","trophy"]},film:{name:"film",keywords:["胶片","film"]},skull:{name:"skull",keywords:["骷髅","skull"]},voice:{name:"voice",keywords:["录音","voice"]},puzzle:{name:"puzzle",keywords:["拼图","puzzle"]},monitor:{name:"monitor",keywords:["摄像","monitor"]},acoustic:{name:"acoustic",keywords:["声波","acoustic"]},"handle-square":{name:"handle-square",keywords:["手柄方形","handle-square"]},"handle-triangle":{name:"handle-triangle",keywords:["手柄三角形","handle-triangle"]},"handle-up":{name:"handle-up",keywords:["手柄上","handle-up"]},"handle-down":{name:"handle-down",keywords:["手柄下","handle-down"]},"handle-right":{name:"handle-right",keywords:["手柄右","handle-right"]},"handle-round":{name:"handle-round",keywords:["手柄圆圈","handle-round"]},"handle-left":{name:"handle-left",keywords:["手柄左","handle-left"]},"handle-a":{name:"handle-a",keywords:["手柄A","handle-a"]},"handle-b":{name:"handle-b",keywords:["手柄B","handle-b"]},"handle-c":{name:"handle-c",keywords:["手柄C","handle-c"]},"handle-x":{name:"handle-x",keywords:["手柄X","handle-x"]},"handle-y":{name:"handle-y",keywords:["手柄Y","handle-y"]},"handle-z":{name:"handle-z",keywords:["手柄Z","handle-z"]},performance:{name:"performance",keywords:["演出","performance"]},"music-one":{name:"music-one",keywords:["音乐","music-one"]},music:{name:"music",keywords:["音乐","music"]},"music-rhythm":{name:"music-rhythm",keywords:["音乐律动","music-rhythm"]},"music-cd":{name:"music-cd",keywords:["音乐cd","music-cd"]},"movie-board":{name:"movie-board",keywords:["影视板","movie-board"]},ghost:{name:"ghost",keywords:["幽灵","ghost"]},game:{name:"game",keywords:["游戏","game"]},"game-ps":{name:"game-ps",keywords:["游戏机","game-ps"]},"game-handle":{name:"game-handle",keywords:["游戏手柄","game-handle"]},entertainment:{name:"entertainment",keywords:["娱乐","entertainment"]},bat:{name:"bat",keywords:["蝙蝠","bat"]},elephant:{name:"elephant",keywords:["大象","elephant"]},pigeon:{name:"pigeon",keywords:["鸽子","pigeon"]},dog:{name:"dog",keywords:["狗","dog"]},dolphin:{name:"dolphin",keywords:["海豚","dolphin"]},hippo:{name:"hippo",keywords:["河马","hippo"]},monkey:{name:"monkey",keywords:["猴","monkey"]},butterfly:{name:"butterfly",keywords:["蝴蝶","butterfly"]},whale:{name:"whale",keywords:["鲸鱼","whale"]},deer:{name:"deer",keywords:["鹿","deer"]},cat:{name:"cat",keywords:["猫","cat"]},owl:{name:"owl",keywords:["猫头鹰","owl"]},bee:{name:"bee",keywords:["蜜蜂","bee"]},bird:{name:"bird",keywords:["鸟","bird"]},cattle:{name:"cattle",keywords:["牛","cattle"]},frog:{name:"frog",keywords:["青蛙","frog"]},"dog-zodiac":{name:"dog-zodiac",keywords:["生肖狗","dog-zodiac"]},"monkey-zodiac":{name:"monkey-zodiac",keywords:["生肖猴","monkey-zodiac"]},"tiger-zodiac":{name:"tiger-zodiac",keywords:["生肖虎","tiger-zodiac"]},"chicken-zodiac":{name:"chicken-zodiac",keywords:["生肖鸡","chicken-zodiac"]},"dragon-zodiac":{name:"dragon-zodiac",keywords:["生肖龙","dragon-zodiac"]},"horse-zodiac":{name:"horse-zodiac",keywords:["生肖马","horse-zodiac"]},"cattle-zodiac":{name:"cattle-zodiac",keywords:["生肖牛","cattle-zodiac"]},"snake-zodiac":{name:"snake-zodiac",keywords:["生肖蛇","snake-zodiac"]},"mouse-zodiac":{name:"mouse-zodiac",keywords:["生肖鼠","mouse-zodiac"]},"rabbit-zodiac":{name:"rabbit-zodiac",keywords:["生肖兔","rabbit-zodiac"]},"sheep-zodiac":{name:"sheep-zodiac",keywords:["生肖羊","sheep-zodiac"]},"pig-zodiac":{name:"pig-zodiac",keywords:["生肖猪","pig-zodiac"]},"koala-bear":{name:"koala-bear",keywords:["树袋熊","koala-bear"]},rabbit:{name:"rabbit",keywords:["兔子","rabbit"]},bear:{name:"bear",keywords:["熊","bear"]},panda:{name:"panda",keywords:["熊猫","panda"]},duck:{name:"duck",keywords:["鸭子","duck"]},eagle:{name:"eagle",keywords:["鹰","eagle"]},"fish-one":{name:"fish-one",keywords:["鱼","fish-one"]},pig:{name:"pig",keywords:["猪","pig"]},pinwheel:{name:"pinwheel",keywords:["风车","pinwheel"]},"windmill-two":{name:"windmill-two",keywords:["风车","windmill-two"]},fruiter:{name:"fruiter",keywords:["果树","fruiter"]},outdoor:{name:"outdoor",keywords:["户外","outdoor"]},blossom:{name:"blossom",keywords:["花","blossom"]},"fire-two":{name:"fire-two",keywords:["火堆","fire-two"]},bloom:{name:"bloom",keywords:["开花","bloom"]},"christmas-tree":{name:"christmas-tree",keywords:["圣诞树","christmas-tree"]},tree:{name:"tree",keywords:["树","tree"]},"tree-one":{name:"tree-one",keywords:["树1","tree-one"]},sapling:{name:"sapling",keywords:["树苗","sapling"]},leaves:{name:"leaves",keywords:["树叶","leaves"]},"christmas-tree-one":{name:"christmas-tree-one",keywords:["松树","christmas-tree-one"]},cactus:{name:"cactus",keywords:["仙人掌","cactus"]},"leaves-two":{name:"leaves-two",keywords:["叶子","leaves-two"]},seedling:{name:"seedling",keywords:["幼苗","seedling"]},lollipop:{name:"lollipop",keywords:["棒棒糖","lollipop"]},"icecream-three":{name:"icecream-three",keywords:["冰棍","icecream-three"]},"icecream-two":{name:"icecream-two",keywords:["冰激凌","icecream-two"]},pineapple:{name:"pineapple",keywords:["菠萝","pineapple"]},"fork-spoon":{name:"fork-spoon",keywords:["叉子勺子","fork-spoon"]},tea:{name:"tea",keywords:["茶","tea"]},"shovel-one":{name:"shovel-one",keywords:["铲子","shovel-one"]},orange:{name:"orange",keywords:["橙子","orange"]},"chef-hat-one":{name:"chef-hat-one",keywords:["厨师帽子","chef-hat-one"]},garlic:{name:"garlic",keywords:["大蒜","garlic"]},shrimp:{name:"shrimp",keywords:["大虾","shrimp"]},"cake-three":{name:"cake-three",keywords:["蛋糕","cake-three"]},cake:{name:"cake",keywords:["蛋糕","cake"]},oven:{name:"oven",keywords:["电烤箱","oven"]},tomato:{name:"tomato",keywords:["番茄","tomato"]},goblet:{name:"goblet",keywords:["高脚杯","goblet"]},bone:{name:"bone",keywords:["骨头","bone"]},juice:{name:"juice",keywords:["果饮","juice"]},hamburger:{name:"hamburger",keywords:["汉堡","hamburger"]},carrot:{name:"carrot",keywords:["胡萝卜","carrot"]},"chafing-dish-one":{name:"chafing-dish-one",keywords:["火锅","chafing-dish-one"]},"hot-pot-one":{name:"hot-pot-one",keywords:["火锅","hot-pot-one"]},"hot-pot":{name:"hot-pot",keywords:["火锅","hot-pot"]},chicken:{name:"chicken",keywords:["鸡肉","chicken"]},"chicken-leg":{name:"chicken-leg",keywords:["鸡腿","chicken-leg"]},liqueur:{name:"liqueur",keywords:["鸡尾酒","liqueur"]},"measuring-cup":{name:"measuring-cup",keywords:["计量杯","measuring-cup"]},eggplant:{name:"eggplant",keywords:["茄子","eggplant"]},nut:{name:"nut",keywords:["坚果","nut"]},egg:{name:"egg",keywords:["煎鸡蛋","egg"]},"bottle-one":{name:"bottle-one",keywords:["酒瓶","bottle-one"]},"chopsticks-fork":{name:"chopsticks-fork",keywords:["筷子叉子","chopsticks-fork"]},chili:{name:"chili",keywords:["辣椒","chili"]},pear:{name:"pear",keywords:["梨子","pear"]},rice:{name:"rice",keywords:["米饭","rice"]},"bread-one":{name:"bread-one",keywords:["面包","bread-one"]},bread:{name:"bread",keywords:["面包","bread"]},bowl:{name:"bowl",keywords:["面条","bowl"]},noodles:{name:"noodles",keywords:["面条","noodles"]},cheese:{name:"cheese",keywords:["奶酪","cheese"]},pumpkin:{name:"pumpkin",keywords:["南瓜","pumpkin"]},lemon:{name:"lemon",keywords:["柠檬","lemon"]},"orange-one":{name:"orange-one",keywords:["柠檬片","orange-one"]},"milk-one":{name:"milk-one",keywords:["牛奶","milk-one"]},milk:{name:"milk",keywords:["牛奶","milk"]},"avocado-one":{name:"avocado-one",keywords:["牛油果","avocado-one"]},crab:{name:"crab",keywords:["螃蟹","crab"]},cooking:{name:"cooking",keywords:["烹饪","cooking"]},beer:{name:"beer",keywords:["啤酒","beer"]},"beer-mug":{name:"beer-mug",keywords:["啤酒杯","beer-mug"]},"apple-one":{name:"apple-one",keywords:["苹果","apple-one"]},"bottle-two":{name:"bottle-two",keywords:["瓶子","bottle-two"]},vegetables:{name:"vegetables",keywords:["青菜","vegetables"]},barbecue:{name:"barbecue",keywords:["烧烤","barbecue"]},"birthday-cake":{name:"birthday-cake",keywords:["生日蛋糕","birthday-cake"]},candy:{name:"candy",keywords:["糖果","candy"]},peach:{name:"peach",keywords:["桃子","peach"]},doughnut:{name:"doughnut",keywords:["甜甜圈","doughnut"]},shovel:{name:"shovel",keywords:["铁铲","shovel"]},pot:{name:"pot",keywords:["铁锅","pot"]},spoon:{name:"spoon",keywords:["铁勺","spoon"]},peas:{name:"peas",keywords:["豌豆角","peas"]},"bowl-one":{name:"bowl-one",keywords:["碗","bowl-one"]},watermelon:{name:"watermelon",keywords:["西瓜","watermelon"]},banana:{name:"banana",keywords:["香蕉","banana"]},"icecream-one":{name:"icecream-one",keywords:["雪糕","icecream-one"]},drink:{name:"drink",keywords:["饮料","drink"]},cherry:{name:"cherry",keywords:["樱桃","cherry"]},"chafing-dish":{name:"chafing-dish",keywords:["鸳鸯锅","chafing-dish"]},"french-fries":{name:"french-fries",keywords:["炸薯条","french-fries"]},android:{name:"android",keywords:["安卓","android"]},tiktok:{name:"tiktok",keywords:["抖音","tiktok"]},messages:{name:"messages",keywords:["短信","messages"]},"new-lark":{name:"new-lark",keywords:["飞书-新","new-lark"]},google:{name:"google",keywords:["谷歌","google"]},health:{name:"health",keywords:["健康","health"]},"facebook-one":{name:"facebook-one",keywords:["脸书","facebook-one"]},facebook:{name:"facebook",keywords:["脸书","facebook"]},"browser-chrome":{name:"browser-chrome",keywords:["浏览器","browser-chrome"]},"browser-safari":{name:"browser-safari",keywords:["浏览器-safari","browser-safari"]},"friends-circle":{name:"friends-circle",keywords:["朋友圈","friends-circle"]},apple:{name:"apple",keywords:["苹果","apple"]},ulikecam:{name:"ulikecam",keywords:["轻颜相机","ulikecam"]},facetime:{name:"facetime",keywords:["视频电话","facetime"]},taobao:{name:"taobao",keywords:["淘宝","taobao"]},twitter:{name:"twitter",keywords:["推特","twitter"]},weibo:{name:"weibo",keywords:["微博","weibo"]},windows:{name:"windows",keywords:["微软视窗","windows"]},wechat:{name:"wechat",keywords:["微信","wechat"]},"app-store":{name:"app-store",keywords:["应用商店","app-store"]},youtube:{name:"youtube",keywords:["优兔","youtube"]},alipay:{name:"alipay",keywords:["支付宝","alipay"]},dribble:{name:"dribble",keywords:["追波","dribble"]},bytedance:{name:"bytedance",keywords:["字节跳动","bytedance"]},"adobe-illustrate":{name:"adobe-illustrate",keywords:["adobe-illustrate","adobe-illustrate"]},"adobe-indesign":{name:"adobe-indesign",keywords:["adobe-indesign","adobe-indesign"]},"adobe-lightroom":{name:"adobe-lightroom",keywords:["adobe-lightroom","adobe-lightroom"]},"adobe-photoshop":{name:"adobe-photoshop",keywords:["adobe-photoshop","adobe-photoshop"]},behance:{name:"behance",keywords:["behance","behance"]},figma:{name:"figma",keywords:["figma","figma"]},foursquare:{name:"foursquare",keywords:["foursquare","foursquare"]},github:{name:"github",keywords:["github ","github"]},"github-one":{name:"github-one",keywords:["github-one","github-one"]},gitlab:{name:"gitlab",keywords:["gitlab","gitlab"]},"html-five":{name:"html-five",keywords:["html5","html-five"]},"instagram-one":{name:"instagram-one",keywords:["instagram","instagram-one"]},instagram:{name:"instagram",keywords:["instagram","instagram"]},paypal:{name:"paypal",keywords:["paypal","paypal"]},sketch:{name:"sketch",keywords:["sketch","sketch"]},telegram:{name:"telegram",keywords:["Telegram","telegram"]},tumblr:{name:"tumblr",keywords:["tumblr","tumblr"]}},Cq={},ID={compressed:Eq,categories:wq,emojis:kq,aliases:Cq},Tq=String,vq=Tq.fromCodePoint||function(...t){const s=[];let a,o,i=-1;const{length:l}=t;if(!l)return"";let c="";for(;++i<l;){let u=Number(t[i]);if(!isFinite(u)||u<0||u>1114111||Math.floor(u)!==u)throw RangeError(`Invalid code point: ${u}`);u<=65535?s.push(u):(u-=65536,a=(u>>10)+55296,o=u%1024+56320,s.push(a,o)),(i+1===l||s.length>16384)&&(c+=String.fromCharCode.apply(null,s),s.length=0)}return c},sg=(e="")=>xj(e,{style:FU}).join(""),yl=(e="",t=!1)=>xj(e,{style:Fj,heteronym:t}).join(""),By={name:"a",unified:"b",non_qualified:"c",has_img_apple:"d",has_img_google:"e",has_img_twitter:"f",has_img_facebook:"h",keywords:"j",sheet:"k",emoticons:"l",text:"m",short_names:"n",added_in:"o"},jD=e=>{const t=[],n=(s,a,o)=>{if(s){if(Array.isArray(s)&&o){const i=yl(s[0]).toLowerCase(),l=sg(s[0]).toLowerCase();t.push(l),t.indexOf(i)===-1&&t.push(i),t.indexOf(l)===-1&&t.push(l)}(Array.isArray(s)?s:[s]).forEach(i=>{(a?i.split(/[-|_|\s]+/):[i]).forEach(l=>{l=l.toLowerCase(),t.indexOf(l)===-1&&t.push(l)})})}};return n(e.short_names,!0),n(e.name,!0),n(e.keywords,!1,!0),n(e.emoticons,!1),t.join(",")},rg=e=>{e.compressed=!1;for(const t in e.emojis){const n=e.emojis[t];for(const s in By)n[s]=n[By[s]],delete n[By[s]];n.short_names||(n.short_names=[]),n.short_names.unshift(t),n.sheet_x=n.sheet[0],n.sheet_y=n.sheet[1],delete n.sheet,n.text||(n.text=""),n.added_in||(n.added_in=6),n.added_in=n.added_in.toFixed(1),n.search=jD(n)}},DD=0,SD=1,RD=2,AD=3,BD=4,LD=5,Nq=6,Iq=7,jq=[LD,AD,BD,DD,SD,RD],Dq=[LD,AD,BD,DD,SD,RD,Nq,Iq],Fu={};function Ex(e){const t=wx();e&&(Fu.categoryIndex=1/0,Fu.count=0);const[n,s]=Sq(t,e?jq:Dq);return Fu.categoryIndex===n?Fu.count++:(Fu.categoryIndex=n,Fu.count=1),Fu.count>3?Ex():s}function Sq(e,t){const n=Math.round(Math.random()*(t.length-1));return[n,Rq(e,n)]}function Rq(e,t){const n=e.categories[t],s=Math.round(Math.random()*(n.emojis.length-1)),a=n.emojis[s],o=e.emojis[a];return kx(o.unified)}function wx(){return Mf.compressed&&rg(Mf),Mf}const Aq=/^(?:\:([^\:]+)\:)(?:\:skin-tone-(\d)\:)?$/,Bq=["1F3FA","1F3FB","1F3FC","1F3FD","1F3FE","1F3FF"];function kx(e){if(!e)return null;const t=e.split("-"),n=t.map(s=>`0x${s}`);return vq.apply(null,n)}function Lq(e){const{name:t,short_names:n,skin_tone:s,skin_variations:a,emoticons:o,unified:i,custom:l,customCategory:c,imageUrl:u,sheet_x:d,sheet_y:f}=e,h=e.id||(n==null?void 0:n[0])||t;let p=`:${h}:`;return l?{id:h,name:t,short_names:n,colons:p,emoticons:o,custom:l,customCategory:c,imageUrl:u}:(s&&(p+=`:skin-tone-${s}:`),{id:h,name:t,short_names:n,colons:p,emoticons:o,unified:i==null?void 0:i.toLowerCase(),skin:s||(a?1:null),native:kx(i),sheet_x:d,sheet_y:f})}function ic(...e){return Lq(Sm(...e))}function Sm(e,t,n,s){let a={};if(typeof e=="string"){const o=e.match(Aq);if(o&&(e=o[1],o[2]&&(t=parseInt(o[2],10))),s.aliases.hasOwnProperty(e)&&(e=s.aliases[e]),s.emojis.hasOwnProperty(e))a=s.emojis[e];else return null}else e.id&&(s.aliases.hasOwnProperty(e.id)&&(e.id=s.aliases[e.id]),s.emojis.hasOwnProperty(e.id)&&(a=s.emojis[e.id],t||(t=e.skin)));if(Object.keys(a).length||(a=e,a.custom=!0),a.search||(a.search=jD(a)),a.emoticons||(a.emoticons=[]),a.variations||(a.variations=[]),a.skin_variations&&t>1){a=JSON.parse(JSON.stringify(a));const o=Bq[t-1],i=a.skin_variations[o];if(i&&(!i.variations&&a.variations&&delete a.variations,n&&(i[`has_img_${n}`]===void 0||i[`has_img_${n}`])||!n)){a.skin_tone=t;for(const l in i){const c=i[l];a[l]=c}}}return a.variations&&a.variations.length&&(a=JSON.parse(JSON.stringify(a)),a.unified=a.variations.shift()),a}function PD(e,t,n){n.compressed&&rg(n);const s=["🏻","🏼","🏽","🏾","🏿"],a=["1F3FB","1F3FC","1F3FD","1F3FE","1F3FF"];let o,i;const l=e;s.forEach((u,d)=>{e.indexOf(u)>0&&(o=d+2,i=a[d])});let c;for(const u in n.emojis){const d=n.emojis[u];let f=d.unified;d.variations&&d.variations.length&&(f=d.variations.shift()),o&&d.skin_variations&&d.skin_variations[i]&&(f=d.skin_variations[i].unified),kx(f)===l&&(c=d)}return c?(c.id=c.short_names[0],ic(c,o,t,n)):null}function NT(e){return e.reduce((t,n)=>(t.indexOf(n)===-1&&t.push(n),t),[])}function Pq(e,t){const n=NT(e),s=NT(t);return n.filter(a=>s.indexOf(a)>=0)}function f2(e,t){const n={};for(const s in e){const a=e[s];let o=a;t.hasOwnProperty(s)&&(o=t[s]),typeof o=="object"&&(o=f2(a,o)),n[s]=o}return n}function Oq(e){const t=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;let n=!1;return function(){n||(n=!0,t(()=>{n=!1,e()}))}}let Ew="emoji-mart";const OD=typeof window<"u"&&"localStorage"in window;let m2,h2;function Mq(e){e||(e={}),m2=e.getter,h2=e.setter}function Uq(e){Ew=e}function Vq(e){for(const t in e){const n=e[t];MD(t,n)}}function MD(e,t){if(h2)h2(e,t);else{if(!OD)return;try{window.localStorage[`${Ew}.${e}`]=JSON.stringify(t)}catch(n){}}}function qq(e){if(m2)return m2(e);if(OD)try{const t=window.localStorage[`${Ew}.${e}`];if(t)return JSON.parse(t)}catch(t){}}const pd={update:Vq,set:MD,get:qq,setNamespace:Uq,setHandlers:Mq};class UD{constructor(t,n){t.compressed&&rg(t),this.data=t||{},this.set=n||null,this.originalPool={},this.index={},this.emojis={},this.emoticons={},this.customEmojisList=[],this.caches=new Map,this.buildIndex()}buildIndex(){for(const t in this.data.emojis){const n=this.data.emojis[t],{short_names:s,emoticons:a,skin_variations:o,name:i}=n;let l="";if(s?l=s[0]:l=i,a&&a.forEach(c=>{this.emoticons[c]||(this.emoticons[c]=l)}),o){this.emojis[l]={};for(let c=1;c<=6;c++)this.emojis[l][c]=ic({id:l,skin:c},c,this.set,this.data)}else this.emojis[l]=ic(l,null,this.set,this.data);this.originalPool[l]=n}}clearCustomEmojis(t){this.customEmojisList.forEach(n=>{const s=n.id||n.short_names[0];delete t[s],delete this.emojis[s]})}addCustomToPool(t,n){this.customEmojisList.length&&this.clearCustomEmojis(n),t.forEach(s=>{const a=s.id||s.short_names[0];a&&!n[a]&&(n[a]=Sm(s,null,null,this.data),this.emojis[a]=ic(s,null,null,this.data))}),this.customEmojisList=t,this.index={}}search(t,{emojisToShowFilter:n,maxResults:s,include:a,exclude:o,custom:i=[]}={}){this.customEmojisList!==i&&this.addCustomToPool(i,this.originalPool);const l=t;if(l){const f=this.caches.get(l);if(f)return f}const c=pd.get("skin")||1;s||(s=75),a||(a=[]),o||(o=[]);let u=null,d=this.originalPool;if(t.length){if(t==="-"||t==="-1")return[this.emojis[-1][c]];let f=t.toLowerCase().split(/[\s|,|\-|_]+/),h=[];if(f.length>2&&(f=[f[0],f[1]]),(a.length||o.length)&&(d={},this.data.categories.forEach(p=>{const g=a&&a.length?a.indexOf(p.id)>-1:!0,_=o&&o.length?o.indexOf(p.id)>-1:!1;!g||_||p.emojis.forEach(x=>d[x]=this.data.emojis[x])}),i.length)){const p=a&&a.length?a.indexOf("custom")>-1:!0,g=o&&o.length?o.indexOf("custom")>-1:!1;p&&!g&&this.addCustomToPool(i,d)}h=f.map(p=>{let g=d,_=this.index,x=0;for(let y=0;y<p.length;y++){const b=p[y];if(x++,_[b]||(_[b]={}),_=_[b],!_.results){const E={};_.results=[],_.pool={};for(const w in g){const k=g[w],{search:C}=k,T=p.substr(0,x),v=C.indexOf(T);if(v!==-1){let I=v+1;T===w&&(I=0),this.emojis[w]&&this.emojis[w][c]?_.results.push(this.emojis[w][c]):_.results.push(this.emojis[w]),_.pool[w]=k,E[w]=I}}_.results.sort((w,k)=>{const C=E[w.id],T=E[k.id];return C===T?w.id.localeCompare(k.id):C-T})}g=_.pool}return _.results}).filter(p=>p),h.length>1?u=Pq.apply(null,h):h.length?u=h[0]:u=[]}return u&&(n&&(u=u.filter(f=>n(d[f.id]))),u&&u.length>s&&(u=u.slice(0,s))),this.caches.set(l,u),u}}const VD=new UD(Mf),Hq=new UD(ID),{emojis:$q,emoticons:Gq}=VD;function zq(...e){return VD.search(...e)}function Wq(...e){return Hq.search(...e)}const Lu={search:zq,customSearch:Wq,emojis:$q,emoticons:Gq};let ho,ww,qD={};function HD(){ww=!0,ho=pd.get("frequently_v1")}function Kq(e){ww||HD();const{colons:t}=e;ho||(ho=qD),ho[t]||(ho[t]=0),ho[t]+=1,pd.set("last",t),pd.set("frequently_v1",ho)}function Yq(e){if(ww||HD(),!ho)return qD={},[];const t=e*4,n=[];for(const i in ho)ho.hasOwnProperty(i)&&n.push(i);const a=n.sort((i,l)=>ho[i]-ho[l]).reverse().slice(0,t),o=pd.get("last");return o&&a.indexOf(o)===-1&&(a.pop(),a.push(o)),a}const $u={add:Kq,get:Yq},Zi={skin:1,set:"apple",sheetSize:64,sheetColumns:57,sheetRows:57,native:!0,forceSize:!1,tooltip:!1,useButton:!1,backgroundImageFn:()=>"https://cdn.allflow.cn/assets/google_emoji.5dd44719.png"},P1={onClick:()=>{},onSelect:()=>{},onSkinChange:()=>{},emojiSize:24,perLine:9,i18n:{},style:{},title:"Emoji Mart™",emoji:"department_store",color:"#000000",set:Zi.set,theme:"light",skin:null,defaultSkin:Zi.skin,native:Zi.native,sheetSize:Zi.sheetSize,backgroundImageFn:Zi.backgroundImageFn,emojisToShowFilter:null,showPreview:!0,showSkinTones:!0,emojiTooltip:Zi.tooltip,useButton:Zi.useButton,autoFocus:!0,enableFrequentEmojiSort:!1,custom:[],skinEmoji:"",notFound:()=>{},notFoundEmoji:"sleuth_or_spy",icons:{}},$l={data:Ue.object.isRequired,onOver:Ue.func,onLeave:Ue.func,onClick:Ue.func,fallback:Ue.func,backgroundImageFn:Ue.func,native:Ue.bool,forceSize:Ue.bool,tooltip:Ue.bool,useButton:Ue.bool,skin:Ue.oneOf([1,2,3,4,5,6]),sheetSize:Ue.oneOf([16,20,32,64]),sheetColumns:Ue.number,sheetRows:Ue.number,set:Ue.oneOf(["apple","google","twitter","facebook"]),size:Ue.oneOfType([Ue.string,Ue.number]).isRequired,emoji:Ue.oneOfType([Ue.string,Ue.object]).isRequired},$D={onClick:Ue.func,onSelect:Ue.func,onSkinChange:Ue.func,perLine:Ue.number,emojiSize:Ue.oneOfType([Ue.number,Ue.string]),i18n:Ue.object,style:Ue.object,title:Ue.string,emoji:Ue.string,color:Ue.string,set:$l.set,skin:$l.skin,native:Ue.bool,backgroundImageFn:$l.backgroundImageFn,sheetSize:$l.sheetSize,emojisToShowFilter:Ue.func,showPreview:Ue.bool,showSkinTones:Ue.bool,emojiTooltip:$l.tooltip,useButton:$l.useButton,theme:Ue.oneOf(["auto","light","dark"]),include:Ue.arrayOf(Ue.string),exclude:Ue.arrayOf(Ue.string),recent:Ue.arrayOf(Ue.string),autoFocus:Ue.bool,enableFrequentEmojiSort:Ue.bool,custom:Ue.arrayOf(Ue.shape({name:Ue.string.isRequired,short_names:Ue.arrayOf(Ue.string).isRequired,emoticons:Ue.arrayOf(Ue.string),keywords:Ue.arrayOf(Ue.string),imageUrl:Ue.string,spriteUrl:Ue.string,sheet_x:Ue.number,sheet_y:Ue.number,size:Ue.number,sheetColumns:Ue.number,sheetRows:Ue.number})),skinEmoji:Ue.string,notFound:Ue.func,notFoundEmoji:Ue.string,icons:Ue.object,keyword:Ue.string,hideSearchInput:Ue.bool},Xq=e=>{if(!e)return;const t=new Event("click",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)},Qq=e=>{if(!e)return;const t=new MouseEvent("mouseenter",{view:window,bubbles:!0,cancelable:!0});e.dispatchEvent(t)},Jq=e=>{if(!e)return;const t=new MouseEvent("mouseleave",{view:window,bubbles:!0,cancelable:!0,altKey:!0});e.dispatchEvent(t)},Zq=e=>{if(!e)return;const t=new MouseEvent("blur",{view:window,bubbles:!0,cancelable:!0,altKey:!0});e.dispatchEvent(t)},GD=10,Cx=20,Tr=30;class eH{constructor(){q(this,"captureListenersMap",new Map);q(this,"normalListenersMap",new Map);q(this,"listenNormal",t=>{const n=this.normalListenersMap.get(t.type);if(n){for(const s of n)if(s.listener(t))break}});q(this,"listenCapture",t=>{const n=this.captureListenersMap.get(t.type);if(n){for(const s of n)if(s.listener(t))break}})}startListenEvent(t,n){window.addEventListener(t,n?this.listenCapture:this.listenNormal,n)}addEventListener(t,n,s=GD,a){const o=a?this.captureListenersMap:this.normalListenersMap;let i=o.get(t);return i||(i=[]),i.length===0&&this.startListenEvent(t,a),i.push({priority:s,listener:n}),i.sort(tH),o.set(t,i),()=>{this.removeEventListener(t,n,a)}}removeEventListener(t,n,s){const o=(s?this.captureListenersMap:this.normalListenersMap).get(t),i=o==null?void 0:o.findIndex(l=>l.listener===n);i!==void 0&&i>=0&&(o==null||o.splice(i,1)),(o==null?void 0:o.length)===0&&window.removeEventListener(t,s?this.listenCapture:this.listenNormal,s)}}function tH(e,t){const n=typeof t.priority=="function"?t.priority():t.priority,s=typeof e.priority=="function"?e.priority():e.priority;return n-s}const qt=new eH,kw=(e,t,n,s=Tr,a={})=>{var g,_;const o=Cr(),i=(g=a.defaultActiveIndex)!=null?g:-1,[l,c]=F.useState(i),u=F.useRef(i);u.current=(_=a.activeIndex)!=null?_:l;const d=F.useRef(t),f=F.useRef(n),h=F.useRef(a.onGlobalCaptureKeydown),p=F.useRef(a.onSelectedActiveIndex);return d.current=t,f.current=n,h.current=a.onGlobalCaptureKeydown,p.current=a.onSelectedActiveIndex,F.useEffect(()=>{const x=w=>{var k,C,T;if(!(w<0)&&((k=p.current)==null||k.call(p,w),a.scrollContainer&&a.scrollContainer.current)){const v=d.current(w);if((C=a==null?void 0:a.virtuoso)!=null&&C.current&&!v){(T=a==null?void 0:a.virtuoso)==null||T.current.scrollToIndex({index:w,align:"center",behavior:"auto"}),o||a.scrollContainer.current.setAttribute("style","pointer-events: none");return}if(v||console.warn(`could not found item element, index[${w}]`),v){const I=v.getBoundingClientRect(),j=a.scrollContainer.current.getBoundingClientRect();I.top+I.height>j.top+j.height?v.scrollIntoView({behavior:"auto",block:"end"}):I.top<j.top&&v.scrollIntoView({behavior:"auto",block:"start"}),o||a.scrollContainer.current.setAttribute("style","pointer-events: none")}}};let y=!1;const b=w=>{var T;let k=!1,C=u.current;switch(!0){case ju("ArrowUp")(w):{if(e===0)break;w.preventDefault(),w.stopImmediatePropagation(),C=f.current(C,"up"),k=!0;break}case ju("ArrowDown")(w):{if(e===0)break;w.preventDefault(),w.stopImmediatePropagation(),C=f.current(C,"down"),k=!0;break}case ju("Enter")(w):{if(y)return;if(y=!0,setTimeout(()=>y=!1,300),e===0||C===-1)break;w.preventDefault(),w.stopImmediatePropagation();const v=d.current(C);v||console.warn(`could not found item element, index[${C}]`),Xq(v),k=!0;break}case ju("ArrowLeft")(w):{if(e===0)break;const v=f.current(C,"left");if(v===-1){const I=d.current(C);Jq(I),Zq(I),(I==null?void 0:I.closest("[data-prevent-event]"))&&w.preventDefault()}else C=v,w.preventDefault(),w.stopImmediatePropagation(),k=!0;break}case ju("ArrowRight")(w):{if(e===0)break;const v=f.current(C,"right");if(v===-1){const I=d.current(C);Qq(I),(I==null?void 0:I.closest("[data-prevent-event]"))&&w.preventDefault()}else C=v,w.preventDefault(),w.stopImmediatePropagation(),k=!0;break}}return C!==u.current&&(x(C),c(C)),k||(T=h.current)==null||T.call(h,w),k},E=qt.addEventListener("keydown",b,s,!0);return setTimeout(()=>{var T,v;const w=(v=(T=a.scrollContainer)==null?void 0:T.current)==null?void 0:v.getBoundingClientRect();if(!w){E();return}const{height:k,width:C}=w;if(k===void 0||C===void 0){E();return}if(k===0||C===0){E();return}u.current<e?x(u.current):c(0)},100),()=>{E()}},[e,s,a.scrollContainer,o,a==null?void 0:a.virtuoso]),F.useEffect(()=>{var y,b,E,w;if(o){(b=(y=a.scrollContainer)==null?void 0:y.current)==null||b.removeAttribute("style");return}(w=(E=a.scrollContainer)==null?void 0:E.current)==null||w.setAttribute("style","pointer-events: none; cursor: none;");const x=()=>{var k,C;(C=(k=a.scrollContainer)==null?void 0:k.current)==null||C.removeAttribute("style")};return qt.addEventListener("mousemove",x,s),()=>{qt.removeEventListener("mousemove",x)}},[o,a.scrollContainer,s]),F.useEffect(()=>{c(i)},[i,e]),[u.current,c]},nH="list-item-inactive",Ly="list-item",sH="list-item-custom",Bd=e=>{const{listenPriority:t,containerRef:n,onSelectedActiveIndex:s,defaultIndex:a=0,customItem:o,type:i="list",spanCount:l,customSelector:c=""}=e,u=e.itemCount||zt.Children.count(e.children),d=_=>{var x,y;return n.current===null?(console.warn("direction containerRef props不能为null"),null):o?(x=n.current.querySelectorAll(`${c} [${sH}=""]`)[_])!=null?x:null:(y=n.current.querySelector(`${c} [${Ly}="${_}"]`))!=null?y:null},f=(_,x)=>{const y=rH(i,_,x,l,u);if(y===-1)return y;const b=d(y);return b?b.hasAttribute(nH)?f(y,x):y:f(x==="up"||x==="left"?u:-1,x)},[h,p]=kw(u,d,f,t,{scrollContainer:n,onSelectedActiveIndex:s,defaultActiveIndex:a});let g=e.children;if(typeof e.children=="function"?(g=e.children(h,p),o||(g=zt.Children.map(g,(_,x)=>zt.isValidElement(_)?zt.cloneElement(_,{[`${Ly}`]:`${x}`}):null))):o||(g=zt.Children.map(e.children,(_,x)=>zt.isValidElement(_)?zt.cloneElement(_,{[`${Ly}`]:`${x}`}):null)),i==="grid"&&l===void 0)throw Error('type is "grid", spanCount props must not be undefined');return r.jsx(r.Fragment,{children:g})},rH=(e,t,n,s,a)=>{let o=-1;const i=n==="up";switch(e){case"list":{if(n==="left"||n==="right")return-1;o=i?t-1:t+1,i&&t===0&&(o=a!=null?a:o);break}case"grid":{if(s===void 0||a===void 0)return-1;switch(s>=a&&(i?n="left":n==="down"&&(n="right")),n){case"left":case"right":{o=n==="left"?t-1:t+1;break}case"up":case"down":{o=i?t-s:t+s;break}}break}default:throw Error("what r u doing")}return o},aH={activity:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{d:"M12 0C5.373 0 0 5.372 0 12c0 6.627 5.373 12 12 12 6.628 0 12-5.373 12-12 0-6.628-5.372-12-12-12m9.949 11H17.05c.224-2.527 1.232-4.773 1.968-6.113A9.966 9.966 0 0 1 21.949 11M13 11V2.051a9.945 9.945 0 0 1 4.432 1.564c-.858 1.491-2.156 4.22-2.392 7.385H13zm-2 0H8.961c-.238-3.165-1.536-5.894-2.393-7.385A9.95 9.95 0 0 1 11 2.051V11zm0 2v8.949a9.937 9.937 0 0 1-4.432-1.564c.857-1.492 2.155-4.221 2.393-7.385H11zm4.04 0c.236 3.164 1.534 5.893 2.392 7.385A9.92 9.92 0 0 1 13 21.949V13h2.04zM4.982 4.887C5.718 6.227 6.726 8.473 6.951 11h-4.9a9.977 9.977 0 0 1 2.931-6.113M2.051 13h4.9c-.226 2.527-1.233 4.771-1.969 6.113A9.972 9.972 0 0 1 2.051 13m16.967 6.113c-.735-1.342-1.744-3.586-1.968-6.113h4.899a9.961 9.961 0 0 1-2.931 6.113"})}),custom:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsxs("g",{transform:"translate(2.000000, 1.000000)",children:[r.jsx("rect",{id:"Rectangle",x:"8",y:"0",width:"3",height:"21",rx:"1.5"}),r.jsx("rect",{id:"Rectangle",transform:"translate(9.843, 10.549) rotate(60) translate(-9.843, -10.549) ",x:"8.343",y:"0.049",width:"3",height:"21",rx:"1.5"}),r.jsx("rect",{id:"Rectangle",transform:"translate(9.843, 10.549) rotate(-60) translate(-9.843, -10.549) ",x:"8.343",y:"0.049",width:"3",height:"21",rx:"1.5"})]})}),flags:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{d:"M0 0l6.084 24H8L1.916 0zM21 5h-4l-1-4H4l3 12h3l1 4h13L21 5zM6.563 3h7.875l2 8H8.563l-2-8zm8.832 10l-2.856 1.904L12.063 13h3.332zM19 13l-1.5-6h1.938l2 8H16l3-2z"})}),foods:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{d:"M17 4.978c-1.838 0-2.876.396-3.68.934.513-1.172 1.768-2.934 4.68-2.934a1 1 0 0 0 0-2c-2.921 0-4.629 1.365-5.547 2.512-.064.078-.119.162-.18.244C11.73 1.838 10.798.023 9.207.023 8.579.022 7.85.306 7 .978 5.027 2.54 5.329 3.902 6.492 4.999 3.609 5.222 0 7.352 0 12.969c0 4.582 4.961 11.009 9 11.009 1.975 0 2.371-.486 3-1 .629.514 1.025 1 3 1 4.039 0 9-6.418 9-11 0-5.953-4.055-8-7-8M8.242 2.546c.641-.508.943-.523.965-.523.426.169.975 1.405 1.357 3.055-1.527-.629-2.741-1.352-2.98-1.846.059-.112.241-.356.658-.686M15 21.978c-1.08 0-1.21-.109-1.559-.402l-.176-.146c-.367-.302-.816-.452-1.266-.452s-.898.15-1.266.452l-.176.146c-.347.292-.477.402-1.557.402-2.813 0-7-5.389-7-9.009 0-5.823 4.488-5.991 5-5.991 1.939 0 2.484.471 3.387 1.251l.323.276a1.995 1.995 0 0 0 2.58 0l.323-.276c.902-.78 1.447-1.251 3.387-1.251.512 0 5 .168 5 6 0 3.617-4.187 9-7 9"})}),nature:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M15.5 8a1.5 1.5 0 1 0 .001 3.001A1.5 1.5 0 0 0 15.5 8M8.5 8a1.5 1.5 0 1 0 .001 3.001A1.5 1.5 0 0 0 8.5 8"}),r.jsx("path",{d:"M18.933 0h-.027c-.97 0-2.138.787-3.018 1.497-1.274-.374-2.612-.51-3.887-.51-1.285 0-2.616.133-3.874.517C7.245.79 6.069 0 5.093 0h-.027C3.352 0 .07 2.67.002 7.026c-.039 2.479.276 4.238 1.04 5.013.254.258.882.677 1.295.882.191 3.177.922 5.238 2.536 6.38.897.637 2.187.949 3.2 1.102C8.04 20.6 8 20.795 8 21c0 1.773 2.35 3 4 3 1.648 0 4-1.227 4-3 0-.201-.038-.393-.072-.586 2.573-.385 5.435-1.877 5.925-7.587.396-.22.887-.568 1.104-.788.763-.774 1.079-2.534 1.04-5.013C23.929 2.67 20.646 0 18.933 0M3.223 9.135c-.237.281-.837 1.155-.884 1.238-.15-.41-.368-1.349-.337-3.291.051-3.281 2.478-4.972 3.091-5.031.256.015.731.27 1.265.646-1.11 1.171-2.275 2.915-2.352 5.125-.133.546-.398.858-.783 1.313M12 22c-.901 0-1.954-.693-2-1 0-.654.475-1.236 1-1.602V20a1 1 0 1 0 2 0v-.602c.524.365 1 .947 1 1.602-.046.307-1.099 1-2 1m3-3.48v.02a4.752 4.752 0 0 0-1.262-1.02c1.092-.516 2.239-1.334 2.239-2.217 0-1.842-1.781-2.195-3.977-2.195-2.196 0-3.978.354-3.978 2.195 0 .883 1.148 1.701 2.238 2.217A4.8 4.8 0 0 0 9 18.539v-.025c-1-.076-2.182-.281-2.973-.842-1.301-.92-1.838-3.045-1.853-6.478l.023-.041c.496-.826 1.49-1.45 1.804-3.102 0-2.047 1.357-3.631 2.362-4.522C9.37 3.178 10.555 3 11.948 3c1.447 0 2.685.192 3.733.57 1 .9 2.316 2.465 2.316 4.48.313 1.651 1.307 2.275 1.803 3.102.035.058.068.117.102.178-.059 5.967-1.949 7.01-4.902 7.19m6.628-8.202c-.037-.065-.074-.13-.113-.195a7.587 7.587 0 0 0-.739-.987c-.385-.455-.648-.768-.782-1.313-.076-2.209-1.241-3.954-2.353-5.124.531-.376 1.004-.63 1.261-.647.636.071 3.044 1.764 3.096 5.031.027 1.81-.347 3.218-.37 3.235"})]}),objects:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M12 0a9 9 0 0 0-5 16.482V21s2.035 3 5 3 5-3 5-3v-4.518A9 9 0 0 0 12 0zm0 2c3.86 0 7 3.141 7 7s-3.14 7-7 7-7-3.141-7-7 3.14-7 7-7zM9 17.477c.94.332 1.946.523 3 .523s2.06-.19 3-.523v.834c-.91.436-1.925.689-3 .689a6.924 6.924 0 0 1-3-.69v-.833zm.236 3.07A8.854 8.854 0 0 0 12 21c.965 0 1.888-.167 2.758-.451C14.155 21.173 13.153 22 12 22c-1.102 0-2.117-.789-2.764-1.453z"}),r.jsx("path",{d:"M14.745 12.449h-.004c-.852-.024-1.188-.858-1.577-1.824-.421-1.061-.703-1.561-1.182-1.566h-.009c-.481 0-.783.497-1.235 1.537-.436.982-.801 1.811-1.636 1.791l-.276-.043c-.565-.171-.853-.691-1.284-1.794-.125-.313-.202-.632-.27-.913-.051-.213-.127-.53-.195-.634C7.067 9.004 7.039 9 6.99 9A1 1 0 0 1 7 7h.01c1.662.017 2.015 1.373 2.198 2.134.486-.981 1.304-2.058 2.797-2.075 1.531.018 2.28 1.153 2.731 2.141l.002-.008C14.944 8.424 15.327 7 16.979 7h.032A1 1 0 1 1 17 9h-.011c-.149.076-.256.474-.319.709a6.484 6.484 0 0 1-.311.951c-.429.973-.79 1.789-1.614 1.789"})]}),people:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"}),r.jsx("path",{d:"M8 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 8 7M16 7a2 2 0 1 0-.001 3.999A2 2 0 0 0 16 7M15.232 15c-.693 1.195-1.87 2-3.349 2-1.477 0-2.655-.805-3.347-2H15m3-2H6a6 6 0 1 0 12 0"})]}),places:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M6.5 12C5.122 12 4 13.121 4 14.5S5.122 17 6.5 17 9 15.879 9 14.5 7.878 12 6.5 12m0 3c-.275 0-.5-.225-.5-.5s.225-.5.5-.5.5.225.5.5-.225.5-.5.5M17.5 12c-1.378 0-2.5 1.121-2.5 2.5s1.122 2.5 2.5 2.5 2.5-1.121 2.5-2.5-1.122-2.5-2.5-2.5m0 3c-.275 0-.5-.225-.5-.5s.225-.5.5-.5.5.225.5.5-.225.5-.5.5"}),r.jsx("path",{d:"M22.482 9.494l-1.039-.346L21.4 9h.6c.552 0 1-.439 1-.992 0-.006-.003-.008-.003-.008H23c0-1-.889-2-1.984-2h-.642l-.731-1.717C19.262 3.012 18.091 2 16.764 2H7.236C5.909 2 4.738 3.012 4.357 4.283L3.626 6h-.642C1.889 6 1 7 1 8h.003S1 8.002 1 8.008C1 8.561 1.448 9 2 9h.6l-.043.148-1.039.346a2.001 2.001 0 0 0-1.359 2.097l.751 7.508a1 1 0 0 0 .994.901H3v1c0 1.103.896 2 2 2h2c1.104 0 2-.897 2-2v-1h6v1c0 1.103.896 2 2 2h2c1.104 0 2-.897 2-2v-1h1.096a.999.999 0 0 0 .994-.901l.751-7.508a2.001 2.001 0 0 0-1.359-2.097M6.273 4.857C6.402 4.43 6.788 4 7.236 4h9.527c.448 0 .834.43.963.857L19.313 9H4.688l1.585-4.143zM7 21H5v-1h2v1zm12 0h-2v-1h2v1zm2.189-3H2.811l-.662-6.607L3 11h18l.852.393L21.189 18z"})]}),recent:()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:[r.jsx("path",{d:"M13 4h-2l-.001 7H9v2h2v2h2v-2h4v-2h-4z"}),r.jsx("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10"})]}),symbols:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{d:"M0 0h11v2H0zM4 11h3V6h4V4H0v2h4zM15.5 17c1.381 0 2.5-1.116 2.5-2.493s-1.119-2.493-2.5-2.493S13 13.13 13 14.507 14.119 17 15.5 17m0-2.986c.276 0 .5.222.5.493 0 .272-.224.493-.5.493s-.5-.221-.5-.493.224-.493.5-.493M21.5 19.014c-1.381 0-2.5 1.116-2.5 2.493S20.119 24 21.5 24s2.5-1.116 2.5-2.493-1.119-2.493-2.5-2.493m0 2.986a.497.497 0 0 1-.5-.493c0-.271.224-.493.5-.493s.5.222.5.493a.497.497 0 0 1-.5.493M22 13l-9 9 1.513 1.5 8.99-9.009zM17 11c2.209 0 4-1.119 4-2.5V2s.985-.161 1.498.949C23.01 4.055 23 6 23 6s1-1.119 1-3.135C24-.02 21 0 21 0h-2v6.347A5.853 5.853 0 0 0 17 6c-2.209 0-4 1.119-4 2.5s1.791 2.5 4 2.5M10.297 20.482l-1.475-1.585a47.54 47.54 0 0 1-1.442 1.129c-.307-.288-.989-1.016-2.045-2.183.902-.836 1.479-1.466 1.729-1.892s.376-.871.376-1.336c0-.592-.273-1.178-.818-1.759-.546-.581-1.329-.871-2.349-.871-1.008 0-1.79.293-2.344.879-.556.587-.832 1.181-.832 1.784 0 .813.419 1.748 1.256 2.805-.847.614-1.444 1.208-1.794 1.784a3.465 3.465 0 0 0-.523 1.833c0 .857.308 1.56.924 2.107.616.549 1.423.823 2.42.823 1.173 0 2.444-.379 3.813-1.137L8.235 24h2.819l-2.09-2.383 1.333-1.135zm-6.736-6.389a1.02 1.02 0 0 1 .73-.286c.31 0 .559.085.747.254a.849.849 0 0 1 .283.659c0 .518-.419 1.112-1.257 1.784-.536-.651-.805-1.231-.805-1.742a.901.901 0 0 1 .302-.669M3.74 22c-.427 0-.778-.116-1.057-.349-.279-.232-.418-.487-.418-.766 0-.594.509-1.288 1.527-2.083.968 1.134 1.717 1.946 2.248 2.438-.921.507-1.686.76-2.3.76"})})},r1={search:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13",viewBox:"0 0 20 20",opacity:"0.5",children:r.jsx("path",{d:"M12.9 14.32a8 8 0 1 1 1.41-1.41l5.35 5.33-1.42 1.42-5.33-5.34zM8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"})}),delete:()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13",viewBox:"0 0 20 20",opacity:"0.5",children:r.jsx("path",{d:"M10 8.586L2.929 1.515 1.515 2.929 8.586 10l-7.071 7.071 1.414 1.414L10 11.414l7.071 7.071 1.414-1.414L11.414 10l7.071-7.071-1.414-1.414L10 8.586z"})})},oH=Object.freeze(Object.defineProperty({__proto__:null,categories:aH,search:r1},Symbol.toStringTag,{value:"Module"})),iH={search:"搜索",recent:"最近",people:"表情",nature:"动物",foods:"食物",activity:"活动",places:"地点",objects:"物件",symbols:"符号",flags:"旗帜",学习办公:"学习办公",数码设备:"数码设备",IT:r.jsx(r.Fragment,{children:" IT"}),几何符号:"几何符号",生活:"生活",表情:"表情",体育:"体育",旅行地点:"旅行地点",影音游戏:"影音游戏",动物植物:"动物植物",食物饮料:"食物饮料",品牌:"品牌"};class Cw extends zt.PureComponent{constructor(t){super(t),this.state={selected:"people"},this.handleClick=this.handleClick.bind(this)}handleClick(t){const n=t.currentTarget.getAttribute("data-index"),{categories:s,onAnchorClick:a}=this.props;a(s[n],n)}render(){const{categories:t,i18n:n}=this.props,{selected:s}=this.state;return r.jsx("nav",{className:"flex justify-between h-[45px] bg-white2/90 rounded-b px-4 items-center w-full overflow-x-auto space-x-2","aria-label":n.categorieslabel,children:t.map((a,o)=>{const{id:i,anchor:l}=a,c=i===s;if(l===!1)return null;const u=i.startsWith("custom-")?"custom":i;return r.jsx("div",{"data-index":o,"aria-label":n.categories[u],onClick:this.handleClick,title:n.categories[u],className:`shrink-0 text-t2 cursor-pointer ${c?"":"text-grey4"}`,children:iH[i]},i)})})}}Cw.propTypes={categories:Ue.array,onAnchorClick:Ue.func,icons:Ue.object};Cw.defaultProps={categories:[],onAnchorClick:()=>{},icons:{}};const kn=PO,zD=(e,t)=>{if(typeof e=="object"&&e!==null&&typeof t=="object"&&t!==null){const n=Object.keys(e).filter(a=>e[a]!==void 0),s=Object.keys(t).filter(a=>t[a]!==void 0);if(n.sort(),s.sort(),!Cn(n,s))return!1;for(const a of n)if(!zD(e[a],t[a]))return!1;return!0}return kn(e,t)},Fe=F.memo(e=>{var M;const{popup:t,offset:n=[0,10],placement:s="top",children:a,className:o,duration:i=[200,50],delay:l=[200,50],popupClass:c="",popupClick:u,equalWidth:d,arrow:f=!1,onClick:h,style:p,trigger:g="mouseenter",dataTestId:_,interactive:x=!1,maxWidth:y=200,theme:b="next-tooltip",animation:E="fade",visible:w,appendTo:k=()=>document.body,disabled:C,lazyLoad:T=!1,onShow:v,onShown:I,onHidden:j,...D}=e,S=F.useRef(null),R=typeof w=="boolean"?{visible:w}:{trigger:g},A=["data-no-cancel-selected","data-test-id","id","data-menu-id"],[L,P]=F.useState(!T);return F.useEffect(()=>{w!==void 0&&(w?P(w):xs(100).then(()=>{P(w)}))},[w]),r.jsx(yI,{onHidden:U=>{T&&P(!1),j==null||j(U)},onShow:U=>{T&&P(!0),v==null||v(U)},onShown:U=>{T&&P(!0),I==null||I(U)},interactive:x,arrow:f,delay:l,duration:i,disabled:!t||C,theme:b,placement:s,offset:n,maxWidth:d?(M=S.current)==null?void 0:M.clientWidth:y,appendTo:k,animation:E,content:L&&r.jsx("div",{className:B("text-t4 line-clamp-5 break-words",c),onClick:u,children:L&&t}),...Jn(D,A),...R,children:r.jsx("div",{"data-no-cancel-selected":!0,ref:S,className:B("flex",o),style:p,onClick:h,...gl(D,A),...bn(_),children:a})})},kn),WD=e=>{const{emoji:t,skin:n,set:s,data:a}=e;return Sm(t,n,s,a)},IT=e=>{const{sheet_x:t,sheet_y:n}=WD(e),s=100/(e.sheetColumns-1),a=100/(e.sheetRows-1);return`${s*t}% ${a*n}%`},Tw=e=>{const{emoji:t,skin:n,set:s,data:a}=e;return ic(t,n,s,a)},lH=(e,t)=>{if(!t.onClick)return;const{onClick:n}=t,s=Tw(t);n(s,e)},cH=(e,t)=>{if(!t.onOver)return;const{onOver:n}=t,s=Tw(t);n(s,e)},uH=(e,t)=>{if(!t.onLeave)return;const{onLeave:n}=t,s=Tw(t);n(s,e)},dH=e=>!isNaN(e-parseFloat(e)),fH=e=>{const t=document.createElement("div");for(const n in e){let s=e[n];dH(s)&&(s+="px"),t.style[n]=s}return t.getAttribute("style")},Ti=zt.memo(e=>{e.data.compressed&&rg(e.data);for(const _ in Ti.defaultProps)e[_]===void 0&&Ti.defaultProps[_]!==void 0&&(e[_]=Ti.defaultProps[_]);const t=WD(e);if(!t)return e.fallback?e.fallback(t,e):null;const{unified:n,custom:s,short_names:a,imageUrl:o,keywords:i}=t,l=n&&kx(n),c=[l].concat(a).filter(Boolean).join(", ");let u={},{children:d}=e,f="emoji-mart-emoji",h=null;if(!n&&!s)return e.fallback?e.fallback(t,e):null;e.tooltip&&(h=i[0]),e.className&&(f+=` ${e.className}`);const p={name:"span",props:{...e.attribute}};if(e.native&&n){f+=" emoji-mart-emoji-native",u={fontSize:e.size},d=l;const _=parseFloat(e.size);e.forceSize&&(u.display="inline-block",u.width=`${_+8}px`,u.height=`${_+8}px`,u.wordBreak="keep-all")}else if(s)f+=" emoji-mart-emoji-custom",u={width:e.size,height:e.size,display:"inline-block"},t.spriteUrl?u={...u,backgroundImage:`url(${t.spriteUrl})`,backgroundSize:`${100*e.sheetColumns}% ${100*e.sheetRows}%`,backgroundPosition:IT(e)}:u={...u,backgroundImage:`url(${o})`,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"};else{if(!(t[`has_img_${e.set}`]===void 0||t[`has_img_${e.set}`])&&!e.ignoreEmojiSet)return e.fallback?e.fallback(t,e):null;const x=e.useSvg?n.toLowerCase().replaceAll("-","_").replaceAll("_fe0f",""):"";u={margin:e.useSvg?void 0:"4px",width:e.size,height:e.size,backgroundImage:e.useSvg?`url(https://cdn.allflow.cn/emoji/google/u${x}.svg)`:`url(${e.backgroundImageFn(e.set,e.sheetSize)})`,backgroundSize:e.useSvg?void 0:`${100*e.sheetColumns}% ${100*e.sheetRows}%`,backgroundPosition:e.useSvg?void 0:IT(e),backgroundRepeat:e.useSvg?void 0:"no-repeat"},p.name="img",p.props={src:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="}}if(e.onClick&&e.useButton&&(p.name="button",p.props={type:"button"}),e.html)return u=fH(u),`<${p.name} style='${u}' aria-label='${c}' ${h?`title='${h}'`:""} class='${f}'>${d||""}</${p.name}>`;u={...u,...e.style};const g=r.jsx(p.name,{onClick:_=>lH(_,e),onMouseEnter:_=>cH(_,e),onMouseLeave:_=>uH(_,e),"aria-label":c,className:f,"list-item-custom":"",style:u,...p.props,children:d});return h?r.jsx(Fe,{popup:h,popupClass:"px-1.5",className:"inline-block",children:g}):g});Ti.propTypes={...$l,data:Ue.object.isRequired};Ti.defaultProps=Zi;let vw=class extends zt.Component{constructor(t){super(t),this.data=t.data,this.lazyLoad=t.lazyLoad,this.setContainerRef=this.setContainerRef.bind(this),this.setLabelRef=this.setLabelRef.bind(this),this.firstRender=this.lazyLoad}componentDidMount(){this.firstRender&&(this.firstRenderTimeout=setTimeout(()=>{this.firstRender=!1,this.forceUpdate()},300)),this.margin=0,this.minMargin=0,this.memoizeSize()}componentWillUnmount(){clearTimeout(this.firstRenderTimeout)}shouldComponentUpdate(t){const{name:n,perLine:s,native:a,hasStickyPosition:o,emojis:i,emojiProps:l,categoryBaseIndex:c,activeIndex:u}=this.props,{skin:d,size:f,set:h,customColorKey:p}=l,{perLine:g,native:_,hasStickyPosition:x,emojis:y,emojiProps:b,categoryBaseIndex:E,activeIndex:w}=t,{skin:k,size:C,set:T,customColorKey:v}=b;let I=!1;n==="Recent"&&s!==g&&(I=!0),n==="Search"&&(I=i!==y),(d!==k||f!==C||a!==_||h!==T||p!==v||o!==x||c!==E)&&(I=!0);const j=this.getEmojis();return j&&u!==w&&(w>=E&&w<j.length+E||u>=E&&u<j.length+E)&&(I=!0),I}memoizeSize(){if(!this.container){this.top=0,this.maxMargin=0;return}const t=this.container.parentElement,{top:n,height:s}=this.container.getBoundingClientRect(),{top:a}=t.getBoundingClientRect(),{height:o}=this.label.getBoundingClientRect();this.top=n-a+t.scrollTop,s===0?this.maxMargin=0:this.maxMargin=s-o}handleScroll(t){let n=t-this.top;if(n=n<this.minMargin?this.minMargin:n,n=n>this.maxMargin?this.maxMargin:n,n!==this.margin)return this.props.hasStickyPosition||(this.label.style.top=`${n}px`),this.margin=n,!0}getEmojis(){const{name:t,recent:n,perLine:s}=this.props;let{emojis:a}=this.props;if(t==="Recent"){const{custom:o}=this.props,i=n||$u.get(s);if(i.length&&(a=i.map(l=>{const c=o.filter(u=>u.id===l)[0];return c||l}).filter(l=>!!Sm(l,null,null,this.data))),a.length===0&&i.length>0)return null}if(a)if(this.firstRender){const o=$u.get(s).length,i=8*s-o;a.length>i&&(a=a.slice(0,i))}else a=a.slice(0);return a}updateDisplay(t){!this.getEmojis()||!this.container||(this.container.style.display=t)}setContainerRef(t){this.container=t}setLabelRef(t){this.label=t}render(){const{id:t,name:n,hasStickyPosition:s,emojiProps:a,i18n:o,categoryBaseIndex:i,activeIndex:l}=this.props,c=this.getEmojis();let u={},d={},f={};c||(f={display:"none"}),s||(u={height:28},d={position:"absolute"});const h=o.categories[t]||n;return r.jsxs("section",{ref:this.setContainerRef,className:"emoji-mart-category","aria-label":h,style:f,children:[r.jsxs("div",{style:u,"data-name":n,className:"flex items-center px-4 bg-white2 emoji-mart-category-label text-t2 h-9",children:[r.jsx("span",{className:`flex items-center text-grey3 w-full h-full ${c&&c.length===0?"hidden":""}`,style:d,ref:this.setLabelRef,"aria-hidden":!0,children:h}),c&&!c.length&&r.jsx("div",{className:"flex justify-center text-t2 text-grey4 w-full",children:"无相关 Emoji"})]}),r.jsx("div",{className:"px-[11px] emoji-mart-category-list mb-2.5",children:c&&c.map((p,g)=>r.jsx(Ti,{emoji:p,data:this.data,...a,className:i+g===l?"emoji-mart-emoji-active":void 0},p.short_names&&p.short_names.join("_")||p.name+g||p))})]})}};vw.propTypes={emojis:Ue.array,hasStickyPosition:Ue.bool,name:Ue.string.isRequired,native:Ue.bool.isRequired,perLine:Ue.number.isRequired,emojiProps:Ue.object.isRequired,recent:Ue.arrayOf(Ue.string),notFound:Ue.func,notFoundEmoji:Ue.string.isRequired,categoryBaseIndex:Ue.number,activeIndex:Ue.number};vw.defaultProps={emojis:[],hasStickyPosition:!0};class Tx extends zt.PureComponent{constructor(t){super(t),this.state={opened:!1}}handleClick(t){const n=parseInt(t.currentTarget.getAttribute("data-skin"),10),{onChange:s}=this.props;this.state.opened?(this.setState({opened:!1}),n!==this.props.skin&&s(n)):this.setState({opened:!0})}render(){return null}}Tx.propTypes={onChange:Ue.func,skin:Ue.number.isRequired};Tx.defaultProps={onChange:()=>{}};class Nw extends Tx{constructor(t){super(t),this.handleClick=this.handleClick.bind(this)}render(){const{skin:t,emojiProps:n,data:s,skinEmoji:a,i18n:o}=this.props,{opened:i}=this.state,l=[];for(let c=1;c<=6;c++){const u=c===t;l.push(r.jsx("span",{className:`emoji-mart-skin-swatch custom${u?" selected":""}`,children:r.jsx("span",{onClick:this.handleClick,"data-skin":c,className:`emoji-mart-skin-tone-${c}`,children:r.jsx(Ti,{emoji:a,data:s,skin:c,backgroundImageFn:n.backgroundImageFn,native:n.native,set:n.set,sheetSize:n.sheetSize,size:23})})},`skin-tone-${c}`))}return r.jsxs("div",{className:`emoji-mart-skin-swatches custom${i?" opened":""}`,children:[r.jsx("div",{className:`emoji-mart-skin-text${i?" opened":""}`,children:o.skintext}),l]})}}Nw.propTypes={onChange:Ue.func,skin:Ue.number.isRequired,emojiProps:Ue.object.isRequired,skinTone:Ue.number,skinEmoji:Ue.string.isRequired,i18n:Ue.object};Nw.defaultProps={onChange:()=>{},skinTone:null};class Iw extends Tx{constructor(t){super(t),this.handleClick=this.handleClick.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}handleKeyDown(t){(t.keyCode===13||t.keyCode===32)&&(t.preventDefault(),this.handleClick(t))}render(){const{skin:t,i18n:n}=this.props,{opened:s}=this.state,a=[];for(let o=1;o<=6;o++){const i=o===t,l=s||i;a.push(r.jsx("span",{className:`emoji-mart-skin-swatch${i?" selected":""}`,"aria-label":n.skintones[o],"aria-hidden":!l,...s?{role:"menuitem"}:{},children:r.jsx("span",{onClick:this.handleClick,onKeyDown:this.handleKeyDown,role:"button",...i?{"aria-haspopup":!0,"aria-expanded":!!s}:{},...s?{"aria-pressed":!!i}:{},tabIndex:l?"0":"","aria-label":n.skintones[o],title:n.skintones[o],"data-skin":o,className:`emoji-mart-skin emoji-mart-skin-tone-${o}`})},`skin-tone-${o}`))}return r.jsx("section",{className:`emoji-mart-skin-swatches${s?" opened":""}`,"aria-label":n.skintext,children:r.jsx("div",{...s?{role:"menubar"}:{},children:a})})}}Iw.propTypes={onChange:Ue.func,skin:Ue.number.isRequired,i18n:Ue.object};Iw.defaultProps={onChange:()=>{}};let jw=class extends zt.PureComponent{constructor(t){super(t),this.data=t.data,this.state={emoji:null}}render(){const{emoji:t}=this.state,{emojiProps:n,skinsProps:s,showSkinTones:a,title:o,emoji:i,i18n:l,showPreview:c}=this.props;if(t&&c){const u=Sm(t,null,null,this.data),{emoticons:d=[]}=u,f=[],h=[];return d.forEach(p=>{f.indexOf(p.toLowerCase())>=0||(f.push(p.toLowerCase()),h.push(p))}),r.jsxs("div",{className:"emoji-mart-preview",children:[r.jsx("div",{className:"emoji-mart-preview-emoji","aria-hidden":"true",children:r.jsx(Ti,{key:t.id,emoji:t,data:this.data,...n})}),r.jsxs("div",{className:"emoji-mart-preview-data","aria-hidden":"true",children:[r.jsx("div",{className:"emoji-mart-preview-name",children:t.name}),r.jsx("div",{className:"emoji-mart-preview-shortnames",children:u.short_names.map(p=>r.jsxs("span",{className:"emoji-mart-preview-shortname",children:[":",p,":"]},p))}),r.jsx("div",{className:"emoji-mart-preview-emoticons",children:h.map(p=>r.jsx("span",{className:"emoji-mart-preview-emoticon",children:p},p))})]})]})}return r.jsxs("div",{className:"emoji-mart-preview",children:[r.jsx("div",{className:"emoji-mart-preview-emoji","aria-hidden":"true",children:i&&i.length&&r.jsx(Ti,{emoji:i,data:this.data,...n})}),r.jsx("div",{className:"emoji-mart-preview-data","aria-hidden":"true",children:r.jsx("span",{className:"emoji-mart-title-label",children:o})}),a&&r.jsx("div",{className:`emoji-mart-preview-skins${s.skinEmoji?" custom":""}`,children:s.skinEmoji?r.jsx(Nw,{skin:s.skin,emojiProps:n,data:this.data,skinEmoji:s.skinEmoji,i18n:l,onChange:s.onChange}):r.jsx(Iw,{skin:s.skin,i18n:l,onChange:s.onChange})})]})}};jw.propTypes={showSkinTones:Ue.bool,title:Ue.string.isRequired,emoji:Ue.string.isRequired,emojiProps:Ue.object.isRequired,skinsProps:Ue.object.isRequired};jw.defaultProps={showSkinTones:!0,onChange:()=>{}};let mH=0,Dw=class extends zt.PureComponent{constructor(t){super(t),this.state={icon:r1.search,isSearching:!1,id:++mH},this.data=t.data,this.setRef=this.setRef.bind(this),this.clear=this.clear.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleChange=Oq(this.handleChange.bind(this))}componentDidMount(){this.input&&this.input.value&&this.search(this.input.value)}search(t){t===""?this.setState({icon:r1.search,isSearching:!1}):this.setState({icon:r1.delete,isSearching:!0});const n=this.props.useCustomIcon?Lu.customSearch:Lu.search;this.props.onSearch(n(t,{emojisToShowFilter:this.props.emojisToShowFilter,maxResults:this.props.maxResults,include:this.props.include,exclude:this.props.exclude,custom:this.props.custom}))}clear(){this.input.value!==""&&(this.input.value="",this.input.focus(),this.search(""))}handleChange(){this.input&&this.search(this.input.value)}handleKeyUp(t){t.keyCode===13&&this.clear()}setRef(t){this.input=t}render(){const{i18n:t,autoFocus:n}=this.props,{id:s}=this.state,a=`emoji-mart-search-${s}`;return r.jsxs("section",{className:"emoji-mart-search","aria-label":t.search,style:{width:"100%"},children:[r.jsx("input",{id:a,ref:this.setRef,type:"search",className:"focus-within-border",onChange:this.handleChange,placeholder:this.props.useCustomIcon?t.searchIcon:t.search,autoFocus:n,autoComplete:"false"}),r.jsx("label",{className:"emoji-mart-sr-only",htmlFor:a,children:t.search})]})}};Dw.propTypes={onSearch:Ue.func,maxResults:Ue.number,emojisToShowFilter:Ue.func,autoFocus:Ue.bool};Dw.defaultProps={onSearch:()=>{},maxResults:75,emojisToShowFilter:null,autoFocus:!1};const jT={search:"搜索 Emoji",searchIcon:"搜索 Icons",clear:"Clear",notfound:"No Emoji Found",skintext:"Choose your default skin tone",categories:{search:"搜索结果",recent:"最近使用",people:"表情与人物",nature:"动物与自然",foods:"食物与饮料",activity:"活动",places:"旅行与地点",objects:"物件",symbols:"符号",flags:"旗帜",custom:"自定义"},categorieslabel:"Emoji 分类",skintones:{1:"Default Skin Tone",2:"Light Skin Tone",3:"Medium-Light Skin Tone",4:"Medium Skin Tone",5:"Medium-Dark Skin Tone",6:"Dark Skin Tone"}},DT=3;class Sw extends zt.PureComponent{constructor(t){super(t),this.scrollTop=0,this.CUSTOM=[],this.RECENT_CATEGORY={id:"recent",name:"Recent",emojis:null,anchor:!1},this.SEARCH_CATEGORY={id:"search",name:"Search",emojis:null,anchor:!1},t.data.compressed&&rg(t.data),this.data=t.data,this.i18n=f2(jT,t.i18n),this.icons=f2(oH,t.icons),this.state={renderCategoryCount:DT},this.categories=[];let n=[].concat(this.data.categories);if(this.scrollRef=F.createRef(),t.custom.length>0){const i={};let l=0;t.custom.forEach(c=>{i[c.customCategory]||(i[c.customCategory]={id:c.customCategory?`custom-${c.customCategory}`:"custom",name:c.customCategory||"Custom",emojis:[],anchor:l===0},l++);const u=i[c.customCategory],d={...c,id:c.short_names[0],custom:!0};u.emojis.push(d),this.CUSTOM.push(d)}),n=n.concat(Object.keys(i).map(c=>i[c]))}t.include!==void 0&&n.sort((i,l)=>t.include.indexOf(i.id)>t.include.indexOf(l.id)?1:-1);for(let i=0;i<n.length;i++){const l=n[i],c=t.include&&t.include.length?t.include.indexOf(l.id)>-1:!0,u=t.exclude&&t.exclude.length?t.exclude.indexOf(l.id)>-1:!1;if(!(!c||u))if(t.emojisToShowFilter){const d=[],{emojis:f}=l;for(let h=0;h<f.length;h++){const p=f[h];t.emojisToShowFilter(this.data.emojis[p]||p)&&d.push(p)}if(d.length){const h={emojis:d,name:l.name,id:l.id};this.categories.push(h)}}else this.categories.push(l)}const s=t.include&&t.include.length?t.include.indexOf(this.RECENT_CATEGORY.id)>-1:!0,a=t.exclude&&t.exclude.length?t.exclude.indexOf(this.RECENT_CATEGORY.id)>-1:!1,o=$u.get(this.props.perLine).length>0;if(s&&!a&&o&&this.categories.unshift(this.RECENT_CATEGORY),this.categories[0]&&(this.categories[0].first=!0),this.categories.unshift(this.SEARCH_CATEGORY),this.setAnchorsRef=this.setAnchorsRef.bind(this),this.handleAnchorClick=this.handleAnchorClick.bind(this),this.setSearchRef=this.setSearchRef.bind(this),this.handleSearch=this.handleSearch.bind(this),this.setScrollRef=this.setScrollRef.bind(this),this.handleScroll=this.handleScroll.bind(this),this.handleScrollPaint=this.handleScrollPaint.bind(this),this.handleEmojiOver=this.handleEmojiOver.bind(this),this.handleEmojiLeave=this.handleEmojiLeave.bind(this),this.handleEmojiClick=this.handleEmojiClick.bind(this),this.handleEmojiSelect=this.handleEmojiSelect.bind(this),this.setPreviewRef=this.setPreviewRef.bind(this),this.handleSkinChange=this.handleSkinChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleDarkMatchMediaChange=this.handleDarkMatchMediaChange.bind(this),this.getAllCategoryBaseIndex=this.getAllCategoryBaseIndex.bind(this),this.emojiProps={native:t.native,skin:t.skin,size:t.emojiSize,set:t.set,sheetSize:t.sheetSize,sheetColumns:t.sheetColumns,sheetRows:t.sheetRows,forceSize:t.native,tooltip:t.emojiTooltip,backgroundImageFn:t.backgroundImageFn,useButton:t.useButton,fallback:t.fallback,customColorKey:t.customColorKey,onOver:this.handleEmojiOver,onLeave:this.handleEmojiLeave,onClick:this.handleEmojiClick(!1)},this.emojiPropsFromRecently={...this.emojiProps,onClick:this.handleEmojiClick(!0)},this.props.keyword){this.lastKeyword=this.props.keyword;const i=this.props.useCustomIcon?Lu.customSearch:Lu.search;this.handleSearch(i(this.props.keyword,{emojisToShowFilter:this.props.emojisToShowFilter,maxResults:this.props.maxResults||75,include:this.props.include,exclude:this.props.exclude,custom:this.CUSTOM}))}}componentDidUpdate(){if(this.lastKeyword!==this.props.keyword)if(this.lastKeyword=this.props.keyword,!this.props.keyword)this.handleSearch(null);else{const t=this.props.useCustomIcon?Lu.customSearch:Lu.search;this.handleSearch(t(this.props.keyword,{emojisToShowFilter:this.props.emojisToShowFilter,maxResults:this.props.maxResults||75,include:this.props.include,exclude:this.props.exclude,custom:this.CUSTOM}))}this.updateCategoriesSize(),this.handleScroll()}componentWillUnmount(){this.SEARCH_CATEGORY.emojis=null,clearTimeout(this.leaveTimeout),this.addRenderCategoryCountTimer&&clearTimeout(this.addRenderCategoryCountTimer),this.darkMatchMedia&&this.darkMatchMedia.offChange(this.handleDarkMatchMediaChange)}testStickyPosition(){const t=document.createElement("div");["","-webkit-","-ms-","-moz-","-o-"].forEach(s=>t.style.position=`${s}sticky`),this.hasStickyPosition=!!t.style.position.length}getPreferredTheme(){return this.props.theme!=="auto"?this.props.theme:this.state.theme?this.state.theme:typeof matchMedia!="function"||(this.darkMatchMedia||(this.darkMatchMedia=new Tj("(prefers-color-scheme: dark)"),this.darkMatchMedia.onChange(this.handleDarkMatchMediaChange)),this.darkMatchMedia.media.match(/^not/))?P1.theme:this.darkMatchMedia.matches?"dark":"light"}handleDarkMatchMediaChange(){this.setState({theme:this.darkMatchMedia.matches?"dark":"light"})}handleEmojiOver(t){const{preview:n}=this;if(!n)return;const s=this.CUSTOM.filter(a=>a.id===t.id)[0];for(const a in s)s.hasOwnProperty(a)&&(t[a]=s[a]);n.setState({emoji:t}),clearTimeout(this.leaveTimeout)}handleEmojiLeave(){const{preview:t}=this;t&&(this.leaveTimeout=setTimeout(()=>{t.setState({emoji:null})},16))}handleEmojiClick(t){return(n,s)=>{this.props.onClick(n,s),this.handleEmojiSelect(n,s,t)}}handleEmojiSelect(t,n,s){const a=this.props.onSelect(t,n,s);!this.props.recent&&!a&&$u.add(t);const o=this.categoryRefs["category-1"];if(o){const{maxMargin:i}=o;this.props.enableFrequentEmojiSort&&o.forceUpdate(),requestAnimationFrame(()=>{this.scroll&&(o.memoizeSize(),i!==o.maxMargin&&(this.updateCategoriesSize(),this.handleScrollPaint(),this.SEARCH_CATEGORY.emojis&&o.updateDisplay("none")))})}}handleScroll(){this.waitingForPaint||(this.waitingForPaint=!0,requestAnimationFrame(this.handleScrollPaint))}handleScrollPaint(){if(this.waitingForPaint=!1,!this.scroll)return;let t=null;if(this.SEARCH_CATEGORY.emojis)t=this.SEARCH_CATEGORY;else{const n=this.scroll,s=n==null?void 0:n.scrollTop,a=s>(this.scrollTop||0);let o=0;this.scrollTop=s;for(let i=0,l=this.categories.length;i<l;i++){const c=a?this.categories.length-1-i:i,u=this.categories[c],d=this.categoryRefs[`category-${c}`];if(d){const f=d.handleScroll(s);(!o||d.top<o)&&d.top>0&&(o=d.top),f&&!t&&(t=u)}}s<o?t=this.categories.filter(i=>i.anchor!==!1)[0]:s+this.clientHeight>=this.scrollHeight&&(t=this.categories[this.categories.length-1])}if(t){const{anchors:n}=this,{id:s}=t;n&&n.state.selected!==s&&n.setState({selected:s})}}handleSearch(t){if(this.SEARCH_CATEGORY.emojis=t,t&&clearTimeout(this.addRenderCategoryCountTimer),!!this.categoryRefs){for(let n=0,s=this.categories.length;n<s;n++){const a=this.categoryRefs[`category-${n}`];if(a&&a.props.name!=="Search"){const o=t?"none":"inherit";a.updateDisplay(o)}}this.forceUpdate(),this.scroll&&(this.scroll.scrollTop=0),this.handleScroll()}}handleAnchorClick(t,n){const s=this.categoryRefs[`category-${n}`],{scroll:a}=this;let o=null;o=()=>{if(s){let{top:i}=s;t.first?i=0:i+=1,a.scrollTop=i}},this.SEARCH_CATEGORY.emojis?(this.handleSearch(null),this.search&&this.search.clear(),requestAnimationFrame(o)):o()}handleSkinChange(t){const n={skin:t},{onSkinChange:s}=this.props;this.setState(n),pd.update(n),s(t)}handleKeyDown(t){let n=!1;switch(t.keyCode){case 13:let s=null;this.SEARCH_CATEGORY.emojis&&this.SEARCH_CATEGORY.emojis.length&&(s=ic(this.SEARCH_CATEGORY.emojis[0],this.state.skin,this.props.set,this.props.data))&&(this.handleEmojiSelect(s),n=!0);break}n&&t.preventDefault()}updateCategoriesSize(){for(let t=0,n=this.categories.length;t<n;t++){const s=this.categoryRefs[`category-${t}`];s&&s.memoizeSize()}if(this.scroll){const t=this.scroll;this.scrollHeight=t.scrollHeight,this.clientHeight=t.clientHeight}}getCategories(){if(this.SEARCH_CATEGORY.emojis)return this.categories.slice(0,this.state.renderCategoryCount);const t=this.state.renderCategoryCount===DT;if(this.state.renderCategoryCount<this.categories.length){const n=Math.min(this.state.renderCategoryCount+1,this.categories.length);return this.addRenderCategoryCountTimer=setTimeout(()=>{this.SEARCH_CATEGORY.emojis||this.setState({renderCategoryCount:n})},t?500:200),this.categories.slice(0,this.state.renderCategoryCount)}return this.categories}setAnchorsRef(t){this.anchors=t}setSearchRef(t){this.search=t}setPreviewRef(t){this.preview=t}setScrollRef(t){this.scroll=t,this.scrollRef.current=t}setCategoryRef(t,n){this.categoryRefs||(this.categoryRefs={}),this.categoryRefs[t]=n,n&&this.SEARCH_CATEGORY.emojis&&n.props.name!=="Search"&&n.updateDisplay("none")}getAllCategoryBaseIndex(t){let n=0;const s={};let a=0;if(this.SEARCH_CATEGORY.emojis)return s[0]=0,[s,this.SEARCH_CATEGORY.emojis.length];for(let o=0;o<t.length;o++){const i=t[o];if(i.name==="Recent"){const{custom:l,recent:c,perLine:u}=this.props,d=c||$u.get(u);if(d.length){const f=d.map(h=>{const p=l.filter(g=>g.id===h)[0];return p||h}).filter(h=>!!Sm(h,null,null,this.data)).length;s[o]=n,n+=f,a+=f}}else i.emojis&&(s[o]=n,n+=i.emojis.length,a+=i.emojis.length)}return[s,a]}render(){const{perLine:t,set:n,sheetSize:s,sheetColumns:a,sheetRows:o,style:i,title:l,emoji:c,color:u,native:d,backgroundImageFn:f,emojisToShowFilter:h,showPreview:p,showSkinTones:g,include:_,exclude:x,recent:y,autoFocus:b,skinEmoji:E,notFound:w,notFoundEmoji:k,customColorKey:C}=this.props,T=this.getPreferredTheme(),v=this.props.skin||this.state.skin||pd.get("skin")||this.props.defaultSkin,I=this.getCategories(),[j,D]=this.getAllCategoryBaseIndex(I),S=this,R=this.props.hideSearchInput&&this.SEARCH_CATEGORY.emojis!==null;return this.emojiProps={...this.emojiProps,customColorKey:C},this.emojiPropsFromRecently={...this.emojiPropsFromRecently,customColorKey:C},r.jsxs("section",{style:{...i},className:`emoji-mart emoji-mart-${T} relative`,"aria-label":l,onKeyDown:this.handleKeyDown,children:[this.props.customHeader,!this.props.hideSearchInput&&r.jsxs("div",{style:{display:"flex",alignItems:"center",marginTop:"15px"},children:[r.jsx(Dw,{useCustomIcon:this.props.useCustomIcon,ref:this.setSearchRef,onSearch:this.handleSearch,data:this.data,i18n:this.i18n,emojisToShowFilter:h,include:_,exclude:x,custom:this.CUSTOM,autoFocus:b}),this.props.searchBtn]}),r.jsxs("div",{ref:this.setScrollRef,className:this.props.hideSearchInput?"emoji-mart-scroll-inline":"emoji-mart-scroll",onScroll:this.handleScroll,children:[r.jsx("div",{style:{marginTop:"10px"}}),r.jsx(Bd,{type:"grid",customSelector:R?`[aria-label="${jT.categories.search}"]`:"",spanCount:t,itemCount:D,customItem:!0,defaultIndex:-1,containerRef:this.scrollRef,children:A=>I.map((L,P)=>r.jsx(vw,{lazyLoad:L.id==="people",ref:this.setCategoryRef.bind(S,`category-${P}`),activeIndex:A,id:L.id,name:L.name,emojis:L.emojis,perLine:t,native:d,hasStickyPosition:this.hasStickyPosition,data:this.data,i18n:this.i18n,categoryBaseIndex:j[P],recent:L.id===this.RECENT_CATEGORY.id?y:void 0,custom:L.id===this.RECENT_CATEGORY.id?this.CUSTOM:void 0,emojiProps:P===1?this.emojiPropsFromRecently:this.emojiProps,notFound:w,notFoundEmoji:k,useCustomIcon:this.props.useCustomIcon},L.name))}),!R&&r.jsx("div",{className:"h-[47px]"})]}),!R&&r.jsx("div",{className:"emoji-mart-bar absolute w-full bottom-0 z-10",children:r.jsx(Cw,{ref:this.setAnchorsRef,data:this.data,i18n:this.i18n,color:u,categories:this.categories,onAnchorClick:this.handleAnchorClick,icons:this.icons})}),(p||g)&&r.jsx("div",{className:"emoji-mart-bar",children:r.jsx(jw,{ref:this.setPreviewRef,data:this.data,title:l,emoji:c,showSkinTones:g,showPreview:p,emojiProps:{native:d,size:38,skin:v,set:n,sheetSize:s,sheetColumns:a,sheetRows:o,backgroundImageFn:f},skinsProps:{skin:v,onChange:this.handleSkinChange,skinEmoji:E},i18n:this.i18n})})]})}}Sw.propTypes={...$D,data:Ue.object.isRequired};Sw.defaultProps={...P1};class Rw extends zt.PureComponent{render(){return r.jsx(Sw,{...this.props,...this.state})}}Rw.propTypes=$D;Rw.defaultProps={...P1,data:Mf};const Gu=e=>{for(const t in Gu.defaultProps)e[t]===void 0&&Gu.defaultProps[t]!==void 0&&(e[t]=Gu.defaultProps[t]);return r.jsx(Ti,{...e})};Gu.propTypes=$l;Gu.defaultProps={...Zi,data:Mf};var Pe=(e=>(e.blue="blue",e.green="green",e.yellow="yellow",e.orange="orange",e.red="red",e.pink="pink",e.purple="purple",e.active_color="active_color",e.brown="brown",e.grey="grey",e.black="black",e.white="white",e.light_yellow="light_yellow",e.light_green="light_green",e.light_blue="light_blue",e.light_purple="light_purple",e.light_red="light_red",e.yellow_green="yellow_green",e.green_blue="green_blue",e.blue_purple="blue_purple",e.purple_red="purple_red",e.red_orange="red_orange",e))(Pe||{});const hH={[m.CardSize.SMALL]:192,[m.CardSize.MEDIUM]:272,[m.CardSize.LARGE]:332},p2=e=>e===m.CollectionCardImageDir.VERTICAL?1.5:.55,Co=(e,t)=>{const n=hH[e];return t===m.CollectionCardImageDir.VERTICAL?n-10:n},pH={[m.CardSize.SMALL]:100,[m.CardSize.MEDIUM]:150,[m.CardSize.LARGE]:180},Eo=180,lc=38,gH=1200,si=37,wr=[{key:Pe.grey,name:"灰色"},{key:Pe.brown,name:"棕色"},{key:Pe.orange,name:"橘色"},{key:Pe.yellow,name:"黄色"},{key:Pe.green,name:"绿色"},{key:Pe.blue,name:"蓝色"},{key:Pe.purple,name:"紫色"},{key:Pe.pink,name:"粉色"},{key:Pe.red,name:"红色"}],an={[m.CollectionSchemaType.TITLE]:"IcTitleName",[m.CollectionSchemaType.NUMBER]:"IcTitleNum",[m.CollectionSchemaType.TEXT]:"IcTitleText",[m.CollectionSchemaType.CHECKBOX]:"IcTitleCheckbox",[m.CollectionSchemaType.SELECT]:"IcTitleSelect",[m.CollectionSchemaType.MULTI_SELECT]:"IcTitleMutiSelect",[m.CollectionSchemaType.CREATED_AT]:"IcTitleTime",[m.CollectionSchemaType.UPDATED_AT]:"IcTitleTime",[m.CollectionSchemaType.DATE]:"IcTitleDate",[m.CollectionSchemaType.PERSON]:"IcTitlePerson",[m.CollectionSchemaType.FILE]:"IcTitleFiles",[m.CollectionSchemaType.URL]:"IcTitleUrl",[m.CollectionSchemaType.EMAIL]:"IcTitleEmail",[m.CollectionSchemaType.PHONE]:"IcTitlePhone",[m.CollectionSchemaType.CREATED_BY]:"IcTitlePerson",[m.CollectionSchemaType.UPDATED_BY]:"IcTitlePerson",[m.CollectionSchemaType.FORMULA]:"IcTitleFormula",[m.CollectionSchemaType.RELATION]:"IcTitleRelation",[m.CollectionSchemaType.ROLLUP]:"IcTitleRollup"},Aw=[{type:m.CollectionSchemaType.TEXT,title:"文本",icon:an.text},{type:m.CollectionSchemaType.NUMBER,title:"数字",icon:an.number},{type:m.CollectionSchemaType.CHECKBOX,title:"勾选框",icon:an.checkbox},{type:m.CollectionSchemaType.SELECT,title:"单选",icon:an.select},{type:m.CollectionSchemaType.MULTI_SELECT,title:"多选",icon:an.multi_select},{type:m.CollectionSchemaType.DATE,title:"日期",icon:an.date},{type:m.CollectionSchemaType.PERSON,title:"人员",icon:an.person},{type:m.CollectionSchemaType.FILE,title:"文件媒体",icon:an.file},{type:m.CollectionSchemaType.URL,title:"网址链接",icon:an.url},{type:m.CollectionSchemaType.EMAIL,title:"邮箱",icon:an.email},{type:m.CollectionSchemaType.PHONE,title:"电话",icon:an.phone},{type:m.CollectionSchemaType.FORMULA,title:"公式",icon:an.formula},{type:m.CollectionSchemaType.RELATION,title:"关联",icon:an.relation},{type:m.CollectionSchemaType.ROLLUP,title:"汇总",icon:an.rollup},{type:m.CollectionSchemaType.CREATED_AT,title:"创建时间",icon:an.created_at},{type:m.CollectionSchemaType.CREATED_BY,title:"创建人",icon:an.created_by},{type:m.CollectionSchemaType.UPDATED_AT,title:"编辑时间",icon:an.updated_at},{type:m.CollectionSchemaType.UPDATED_BY,title:"编辑人",icon:an.updated_by}],KD=[{type:m.CollectionSchemaType.TEXT,title:"文本",icon:an.text},{type:m.CollectionSchemaType.NUMBER,title:"数字",icon:an.number},{type:m.CollectionSchemaType.CHECKBOX,title:"勾选框",icon:an.checkbox},{type:m.CollectionSchemaType.SELECT,title:"单选",icon:an.select},{type:m.CollectionSchemaType.MULTI_SELECT,title:"多选",icon:an.multi_select},{type:m.CollectionSchemaType.DATE,title:"日期",icon:an.date},{type:m.CollectionSchemaType.PERSON,title:"人员",icon:an.person},{type:m.CollectionSchemaType.FILE,title:"文件媒体",icon:an.file},{type:m.CollectionSchemaType.URL,title:"网址链接",icon:an.url},{type:m.CollectionSchemaType.EMAIL,title:"邮箱",icon:an.email},{type:m.CollectionSchemaType.PHONE,title:"电话",icon:an.phone}],Bw=[m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.CREATED_BY,m.CollectionSchemaType.UPDATED_AT,m.CollectionSchemaType.UPDATED_BY,m.CollectionSchemaType.RELATION,m.CollectionSchemaType.ROLLUP,m.CollectionSchemaType.FORMULA],im=[m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.UPDATED_AT,m.CollectionSchemaType.CREATED_BY,m.CollectionSchemaType.UPDATED_BY],YD=[m.CollectionSchemaType.FORMULA,m.CollectionSchemaType.ROLLUP],_H=LE(Aw,"type"),xH=LE(KD,"type"),bl={tableFooter:"table-footer",tableHeader:"table-header",tableSortManager:"table-sort-manager"};var zu=(e=>(e.left="left",e.right="right",e))(zu||{});const FH=["left","right"],yH=typeof navigator<"u"&&/iPhone/i.test(navigator.userAgent),bH=typeof navigator<"u"&&/windows|win32/i.test(navigator.userAgent),Fi=typeof navigator<"u"&&/Mac OS X/.test(navigator.userAgent),XD=typeof navigator<"u"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),Gt=Fi?"⌘":"Ctrl",Py=Fi?"⌥":"Alt",QD=5,vx=e=>{const t=F.useRef(qe()),n=F.useRef(null),[s,a,o]=F.useMemo(()=>{const p=localStorage.getItem(Yp),g=e.items.slice(0);let _=g.reduce((y,b)=>y+b.items.length,0),x=!1;if(p!=="undefined"&&p!=null&&g[0]&&!e.disabledHasRecently){const y={perLine:g[0].perLine,title:"上次使用",items:[JSON.parse(p)],rightText:`${Gt}+Shift+H`};g.unshift(y),_+=1,x=!0}return[x,g,_]},[e.items,e.disabledHasRecently]),i=p=>{var _;if(p<0||p>=o)return null;let g=0;for(const x of a)for(let y=0;y<x.items.length;y++){if(p===g)return(_=n.current)==null?void 0:_.querySelector(`[data-list-item="${t.current}-${x.title}-${y}"]`);g++}return null},l=(p,g)=>{var y;const _=(y=e.perLine)!=null?y:QD;let x;return g==="up"||g==="down"?p===0&&g==="down"&&s?x=p+1:p===1&&g==="up"&&s?x=p-1:x=g==="up"?p-_:p+_:x=g==="left"?p-1:p+1,x<0&&(x=o-1),x>=o&&(x=0),x},[c]=kw(o,i,l,Tr+1,{scrollContainer:n});let u=-1,d=-1,f=0,h=!1;return a.forEach((p,g)=>{if(!h){u=g;for(let _=0;_<p.items.length;_++){if(c===f){h=!0,d=_;break}f++}}}),r.jsxs("div",{ref:n,"data-no-cancel-selected":!0,className:"next-modal overflow-y-auto pt-1.5 max-h-[80vh] select-none",onPointerDown:p=>p.preventDefault(),children:[r.jsx(JD.Provider,{value:d,children:a.map((p,g)=>r.jsx("div",{className:"mb-2.5",children:r.jsx(wH,{selected:u===g,id:t.current,...p,perLine:e.perLine,onColorSelect:e.onColorSelect})},g))}),e.footer]})},EH=42.5,wH=e=>{const{title:t,rightText:n,items:s,perLine:a=QD,id:o,selected:i}=e,l=EH*a+8*3,c=kH();return r.jsxs("div",{style:{width:l},children:[r.jsxs("div",{className:"flex items-center justify-between text-t2 text-grey3 px-3.5 h-9",children:[r.jsx("div",{children:t}),r.jsx("div",{children:n})]}),r.jsx("div",{className:"flex flex-row flex-wrap justify-between px-2",children:s.map((u,d)=>r.jsx(Lw,{selected:i&&c===d,"data-list-item":`${o}-${t}-${d}`,...u,onClick:()=>{var f;Nn(Yp,JSON.stringify(u)),(f=e.onColorSelect)==null||f.call(e,{...u})}},d))})]})},Lw=e=>{const{desc:t,isBgColor:n,selected:s,hideIcon:a,icon:o,colorkey:i,bgColor:l,hover:c=!0,disable:u=!1,...d}=e,f=!i&&n,h=F.useMemo(()=>f?r.jsx("span",{className:"w-full h-px bg-black_006 -rotate-45"}):a?null:n?s?r.jsx(H,{name:"IcSelectedSpace",size:"middle",className:"text-white-base"}):null:o||r.jsx(H,{name:"IcText",style:{color:n||!i?void 0:Us(i)},className:B("text-[18px]",!i&&"text-black")}),[i,a,o,n,f,s]);return r.jsx(Fe,{offset:[0,5],popup:t,children:r.jsx("div",{className:B("h-10 w-10 flex items-center justify-center rounded",{"normal-bg":s},{"animate-hover ":c},{"cursor-pointer ":!u}),...d,children:r.jsx("div",{className:B("rounded-full flex items-center justify-center p-1 w-[30px] h-[30px]",n&&"p-0"),style:{background:l||(n?Rn(i):void 0),boxShadow:"inset 0 0 0 1px var(--black_006)"},children:h})})})},JD=F.createContext(0),kH=()=>F.useContext(JD),Ld=({onSelect:e,value:t,bgColorFn:n,selectedIcon:s,colors:a=wr,hideHeader:o,header:i="颜色",className:l})=>r.jsxs(r.Fragment,{children:[o?r.jsx("div",{className:"h-2"}):r.jsx("div",{className:"text-t2 text-grey3 pl-3.5 mt-2",children:i}),r.jsx("div",{className:B("grid gap-[3px] px-2 mt-1 grid-cols-5",l),children:a.map(c=>{const u=t===c.key,d=u?s||r.jsx(H,{name:"IcSelectedSpace",className:B("text-[18px]",gn({color:YE(c.key)}))}):void 0;return r.jsx(Lw,{selected:u,icon:d,hideIcon:!u,isBgColor:!0,bgColor:n?n(c.key):void 0,colorkey:c.key,desc:c.name,onClick:()=>e(c.key)},c.key)})})]}),In=new bI.Emitter;bI.Emitter.defaultMaxListeners=200;const ST=Symbol.for("all");function ag(e){const t=PE(void 0),n=({children:s,...a})=>{const o=e(a),i=F.useMemo(()=>o,[]),l=F.useMemo(()=>new Map,[]),c=F.useMemo(()=>{const u=(h,p)=>{let g=l.get(h);g||(g=new Set,l.set(h,g)),g.add(p)};return{observe:u,unobserve:h=>l.forEach(p=>p.delete(h)),observeAll:h=>{u(ST,h)},model:i}},[]);return F.useEffect(()=>{const u=new Set(l.get(ST));CH(o).forEach(d=>{var p;const f=Reflect.get(o,d),h=Reflect.get(i,d);Object.is(h,f)||(Reflect.set(i,d,f),(p=l.get(d))==null||p.forEach(g=>u.add(g)))}),u.forEach(d=>d())},[o,i,l]),r.jsx(t.Provider,{value:c,children:s})};return n.Context=t,n.displayName=`Model(${e.name})`,n}function ws(e){const t=OO(e.Context);if(!t)throw new Error(`useModel 需要在 ${e.displayName} 内使用`);const{model:n,observe:s,unobserve:a}=t,[,o]=F.useReducer(l=>l+1,0),i=F.useRef(!0);return i.current=!0,F.useEffect(()=>{i.current=!1}),F.useEffect(()=>()=>a(o),[]),F.useMemo(()=>new Proxy(n,{get(l,c){return i.current&&s(c,o),Reflect.get(l,c)},set(l,c){return!1}}),[])}function Nx(e,t,n){const s=v1(e.Context,u=>u);if(!s)throw new Error(`useModelSelect 需要在 ${e.displayName} 内使用`);const{model:a,observeAll:o,unobserve:i}=s,[l,c]=F.useReducer(u=>{const d=t(a);return n!=null&&n(u,d)?u:d},t(a));return F.useEffect(()=>(o(c),()=>{i(c)}),[]),l}function CH(e){return[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)]}const TH=()=>{const[e,t]=F.useState({});return{nodes:e,setNodes:t}},Ix=ag(TH),vH=()=>Nx(Ix,e=>Ei(e.nodes)),Rm=e=>Nx(Ix,t=>!!t.nodes[e]),Pw=()=>Nx(Ix,e=>e.setNodes),ZD=F.createContext(!1),NH=()=>F.useContext(ZD),Za=e=>new Promise(t=>{setTimeout(t,e)}),E_={},oa=(e,t="normal")=>{var s;E_[t]||(E_[t]=Promise.resolve());const n=(s=E_[t])==null?void 0:s.then(e,e);return n&&(E_[t]=n),n};class jx{constructor(){q(this,"resolve");q(this,"reject");q(this,"promise",new Promise((t,n)=>{this.resolve=t,this.reject=n}))}}const Kt=()=>{const e=Pw();return F.useCallback((t,n)=>{var l;if(!t)return;const s=typeof n=="function"?{closeAfter:n}:n,a=s==null?void 0:s.closeAfter,o=(l=s==null?void 0:s.noAnimation)!=null?l:!1,i=document.querySelector(`[data-modal-id="${t}"]`);if(i)if(s!=null&&s.ignoreEmitter||In.emit("closeModal",t),o)e(c=>Jn(c,t)),a==null||a();else{i.className.includes("animate__fadeIn")?i.classList.add("animate__fadeOut"):i.classList.add("dropdown_hidden");const c=document.querySelector(`[data-modal-mask-id="${t}"]`);c==null||c.remove(),Za(150).then(()=>{e(u=>Jn(u,t)),a==null||a()})}else a==null||a()},[e])},Pf=class{constructor(){q(this,"resizeObserver");q(this,"elements");q(this,"elementsLastEntry");this.elements=new WeakMap,this.elementsLastEntry=new WeakMap,this.resizeObserver=new ResizeObserver(t=>{t.forEach(n=>{const{target:s}=n,a=this.elements.get(s);a&&(this.elementsLastEntry.set(s,n),a.forEach(o=>o(n)))})})}static getInstance(){return Pf.instance||(Pf.instance=new Pf),Pf.instance}observe(t,n){if(!this.elements.has(t))this.elements.set(t,new Set([n])),this.resizeObserver.observe(t);else{const s=this.elements.get(t);s==null||s.add(n);const a=this.elementsLastEntry.get(t);a&&n(a)}return()=>this.unobserve(t,n)}unobserve(t,n){if(!this.elements.has(t))return;const s=this.elements.get(t);s==null||s.delete(n),(s==null?void 0:s.size)===0&&(this.elements.delete(t),this.elementsLastEntry.delete(t),this.resizeObserver.unobserve(t))}};let a1=Pf;q(a1,"instance");const Pd=a1.getInstance(),no=(e,t)=>{const{wait:n=500,type:s="all",mode:a="debounce"}=t||{},[o,i]=F.useState({width:(e==null?void 0:e.getBoundingClientRect().width)||0,height:(e==null?void 0:e.getBoundingClientRect().height)||0});return F.useEffect(()=>{if(!e)return;const c=(a==="debounce"?$n:fs)(d=>{const f=d.target.getBoundingClientRect();i(s==="all"?{width:f.width,height:f.height}:h=>({...h,[s]:f[s]}))},n,{leading:!0,trailing:!0}),u=Pd.observe(e,c);return()=>{u()}},[e,a,s,n]),o},lm=e=>{const{clientX:t,clientY:n}=e;return{getBoundingClientRect:()=>({width:0,height:0,x:t,y:n,top:n,right:t,bottom:n,left:t,toJSON:()=>"null"})}},Br=e=>{if(!eS(e))return e;const t=e.getBoundingClientRect();return{getBoundingClientRect:()=>t}},eS=e=>!!(e!=null&&e.tagName),IH=e=>{const{popcorn:t,content:n,contentProps:s,placement:a,modalId:o,modifiers:i=[],closeBeforeCallBack:l,closeAfterCallBack:c,escCloseBeforeCallBack:u,mask:d=!0,autoClose:f=!0,offset:h=[0,0],className:p="",keyboard:g=!0,flip:_=!0,id:x="dropDownContent",closeNoAnimate:y=!1,arrow:b,arrayClassName:E,disableEsc:w,animation:k="slideIn",blockMaskClick:C=!0}=e,T=F.useRef(null),v=no(document.body),I=no(eS(t)?t:null),j=Kt(),D=F.useRef(null),S=F.useRef(null),R=F.useRef(!1),A=F.useCallback(M=>{let U=M;R.current||(l==null?void 0:l())==="prevent"||(R.current=!0,M?typeof M=="object"?U={...M,closeAfter:c}:U=()=>{c==null||c(),typeof M=="function"&&M()}:U={closeAfter:c,noAnimation:y},o&&j(o,U))},[c,l,j,y,o]);MO(()=>{!d&&f&&A()},T,"pointerdown");const L=F.useCallback(M=>{be("esc")(M)&&(M.preventDefault(),M.stopPropagation(),u==null||u(),A())},[A,u]),P=()=>{var M;try{T.current&&((M=D.current)==null||M.update())}catch(U){}};return F.useEffect(()=>{P()},[v,I]),F.useEffect(()=>{if(T.current===null)return;const M=[{name:"computeStyles",options:{gpuAcceleration:!1}},{name:"offset",options:{offset:h}}];_?M.push({name:"preventOverflow",options:{tether:!1,altAxis:!0}}):M.push({name:"flip",enabled:!1}),b&&M.push({name:"arrow",options:{element:S.current}}),M.push(...i),D.current=Ql(t,T.current,{placement:a||"bottom-end",strategy:"fixed",modifiers:M});const U=Pd.observe(T.current,()=>P());if(g){if(w)return;qt.addEventListener("keydown",L,Tr,!0)}return()=>{var V;if(g){if(w)return;qt.removeEventListener("keydown",L,!0)}U(),(V=D.current)==null||V.destroy(),A()}},[]),r.jsxs(r.Fragment,{children:[d&&r.jsx("div",{"data-modal-mask-id":o,className:"fixed inset-0",onContextMenuCapture:M=>M.preventDefault(),onPointerDown:M=>{C&&M.preventDefault()},onClick:M=>{M.stopPropagation(),f&&A()}}),r.jsxs("div",{ref:T,id:x,"data-modal-id":o,className:B("-inset-full",k==="slideIn"&&"dropDownContent",k==="fadeIn"&&"animate__animated animate__fadeIn",p),style:{animationDuration:"0.1s"},onClick:M=>M.stopPropagation(),children:[r.jsx(n,{onCloseModal:A,...s!=null?s:{},popper:D}),b&&r.jsx("div",{id:"arrow",ref:S,className:B("w-5 h-5 top--[9px] z-1",E),children:r.jsx("div",{id:"arrow-inner"})})]})]})},og=({children:e,className:t,visible:n=!1,onClose:s,onChange:a,content:o,onClick:i,placement:l="bottom",disable:c=!1})=>{const u=no(document.body),[d,f]=F.useState(n),{x:h,y:p,reference:g,floating:_,strategy:x,context:y,refs:b,update:E}=UO({open:d,middleware:[HO(),$O({crossAxis:!0})],onOpenChange:f,placement:l}),{getReferenceProps:w,getFloatingProps:k}=VO([qO(y,{toggle:!0})]);return F.useEffect(()=>{d&&b.reference.current&&b.floating.current&&G3(b.reference.current,b.floating.current,E)},[d,E,b.reference,b.floating]),F.useEffect(()=>{setTimeout(()=>{d&&b.reference.current&&b.floating.current&&G3(b.reference.current,b.floating.current,E)},100)},[d,b.floating,b.reference,E,u]),F.useEffect(()=>{f(n)},[n]),F.useEffect(()=>{!d&&(s==null||s())},[s,d]),F.useEffect(()=>{a==null||a(d)},[a,d]),r.jsxs(r.Fragment,{children:[r.jsx("div",{ref:g,...w({ref:g}),className:t,onClick:c?void 0:()=>f(!d),children:e}),d&&!c&&EI.createPortal(r.jsx(wI,{lockScroll:!0,className:"z-[8848] animate__animated animate__fadeIn",style:{animationDuration:"0.1s"},onClick:()=>f(!1),children:r.jsx("div",{ref:_,...k({ref:_,style:{position:x,top:p!=null?p:"",left:h!=null?h:""},onClick:C=>{C.stopPropagation(),i==null||i(C)}}),children:o})}),document.body)]})},hs=({className:e,size:t,...n})=>localStorage.getItem("super-loading")?r.jsx("img",{...n,src:Dn.icon,className:B("super-loading",gD[t||"max"],e)}):r.jsx(H,{name:"IcNaviLoading",size:t||"max",className:B("animate-spin text-grey4",e),...n}),jH=()=>r.jsx("img",{className:"w-[160px] h-[160px]",src:Dn.loadingGif,alt:"加载中"});const Ow=e=>{const{content:t,modalId:n,className:s,center:a=!0,autoClose:o=!0,keyboard:i=!0,containerClassName:l,closeAfterCallBack:c,closeBeforeCallBackForClickOutSide:u,noAnimation:d=!1}=e,f=Kt(),h=F.useCallback(g=>{n&&f(n,g)},[f,n]),p=F.useCallback(g=>{if(be("esc")(g)){if(g.stopPropagation(),g.preventDefault(),!o)return;u==null||u(),h(),c==null||c()}},[o,u,h,c]);return F.useEffect(()=>(i&&qt.addEventListener("keydown",p,Tr,!0),()=>{i&&qt.removeEventListener("keydown",p,!0)}),[]),r.jsx(wI,{id:"modalContent",className:B("fixed top-0 left-0 flex justify-center w-screen h-screen mask animate__animated animate__fadeIn",a?"items-center":"items-start pt-[calc(25vh)]",l),"data-modal-id":n,style:{animationDuration:d?"0s":"0.1s"},onContextMenuCapture:g=>g.preventDefault(),onClick:g=>{g.stopPropagation(),o&&(u==null||u(),h(),c==null||c())},children:r.jsx("div",{className:B("next-modal rounded-md enlarge",s),onClick:g=>g.stopPropagation(),style:{animationDuration:d?"0s":"0.1s"},children:r.jsx(t,{onCloseModal:h})})})},tS=e=>{const{modalId:t,title:n,icon:s="circle",className:a,...o}=e,i=s==="blocks";return r.jsx(Ow,{center:!0,autoClose:!1,...o,modalId:t,className:B("flex flex-col items-center justify-center",i?"pb-5 min-w-80 min-h-28 px-11":"w-80 h-28",a),content:()=>r.jsxs(r.Fragment,{children:[i?r.jsx(jH,{}):r.jsx(hs,{}),r.jsx("span",{className:"mt-2 text-t1",children:n})]})})},Dx=({time:e=0,prefix:t="",onFinish:n,onChange:s,className:a=""})=>{const[o,i]=F.useState(e);return F.useEffect(()=>{o===0&&n&&n(!0)},[o,n]),F.useEffect(()=>{s&&s(o)},[o,s]),F.useEffect(()=>{i(o);const l=setInterval(()=>{i(c=>c<1?(clearInterval(l),0):c-1)},1e3);return()=>{i(0)}},[]),r.jsxs("span",{className:a,children:[`${t} `,o,"s"]})},DH={auto:"h-full w-full text-t2-medium",middle:"w-80 h-12 text-t1-medium",large:"h-8 px-3.5 text-t2-medium"},SH={primary:"bg-black border-black text-white1",secondary:"bg-white dark:bg-transparent text-black border-grey5",red:"text-red border-red",white:"bg-transparent text-white-base border-white",black:"bg-transparent text-black border-black",base_white:"bg-white text-black-base border-white",active:"bg-active_color text-white border-transparent"},RH={primary:"hover:opacity-90",secondary:"hover:brightness-90 dark:hover:bg-black_003",red:"hover:bg-red/10",white:"hover:bg-black_003",black:"hover:bg-black_003",base_white:"hover:brightness-90",active:"hover:brightness-90 text-t2-bold dark:hover:brightness-110"},je=zt.memo(e=>{const{colorType:t="secondary",disable:n,onClick:s,autoFocus:a=!1,size:o="large",className:i,children:l,...c}=e;return r.jsx("button",{...c,"data-color-type":t,onClick:s,autoFocus:a,disabled:n,onKeyDown:u=>{be("enter")(u)&&u.currentTarget.click()},className:B("flex justify-center items-center rounded border outline-none text-ellipsis animate-click select-none",DH[o],SH[t],n?"opacity-30 cursor-not-allowed":RH[t],i),children:l})}),AH=e=>{const{title:t,content:n,confirm:s,cancel:a,confirmText:o,cancelText:i,noCancel:l=!1,countTime:c,modalId:u,keyboard:d,colorType:f="red",maxWidth:h,minWidth:p=300,footer:g,..._}=e,[x,y]=F.useState(!!c),b=()=>y(!1);return r.jsx(Ow,{..._,keyboard:d,center:!0,modalId:u,className:"bg-white3",content:({onCloseModal:E})=>r.jsxs("div",{className:"flex flex-col justify-center items-center px-7 py-6 max-w-xs text-center",style:{maxWidth:h,minWidth:p},children:[t&&r.jsx("div",{className:`text-t1-medium ${n?"":"mb-8"}`,children:t}),n&&r.jsx("div",{className:"mt-2.5 mb-5 text-t2",children:n}),r.jsxs("div",{className:"flex flex-col w-full text-t3",children:[r.jsx(je,{className:B("font-medium",!l&&"mb-2.5"),colorType:f,autoFocus:!0,disable:x,...bn(Bn.warningModalConfirm),onClick:()=>{x||(E(),s==null||s())},children:x?r.jsx(Dx,{time:c,onFinish:b}):o||"确定"}),!l&&r.jsx(je,{...bn(Bn.warningModalCancel),onClick:()=>{E(),a==null||a()},children:i||"取消"})]}),g]})})},me=()=>{const e=Kt(),t=Pw(),n=F.useCallback((a,o,i)=>{const l=(a==null?void 0:a.modalId)||qe();return t(c=>{const u=!!c[l],d={...c};if(!u){const f={[l]:{id:l,config:{},element:r.jsx(o,{...a,modalId:l})}};Object.assign(d,f)}if(u&&(i===2||a!=null&&a.forceUpdate)){const f={[l]:{id:l,config:{},element:r.jsx(o,{...a,noAnimation:!0,modalId:l})}};Object.assign(d,f)}return d}),{modalId:l}},[t]);return F.useMemo(()=>({modal:a=>n(a,Ow,0),dropdown:a=>n(a,IH,1),warning:a=>n(a,AH,3),loading:a=>n(a,tS,2),closeModal:e}),[e,n])},jl=e=>r.jsxs(Ix,{children:[r.jsx(BH,{element:e.element}),e.children]}),BH=e=>{const{element:t=document.body}=e,n=vH(),s=Kt();return F.useEffect(()=>{const a=o=>{n.some(i=>i.id===o)&&s(o,{ignoreEmitter:!0})};return In.on("closeModal",a),()=>{In.off("closeModal",a)}},[s,n]),Is.createPortal(r.jsx(r.Fragment,{children:r.jsx(ZD.Provider,{value:!0,children:n.map(a=>r.jsx("div",{className:"fixed z-[8848]",children:a.element},a.id))})}),t)};function Li(e){const[t,n]=F.useState(!1),{ref:s}=kI({root:e==null?void 0:e.root,triggerOnce:!0,initialInView:e==null?void 0:e.initialInView,rootMargin:e==null?void 0:e.rootMargin,onChange:a=>{a&&n(a)}});return[t,s]}const LH=e=>{var h,p;const{emojiProps:t,emoji:n}=e,s=(h=e.color)!=null?h:"black",[a,o]=Li(),i=F.useMemo(()=>ld(s),[s]),l=DU(n.name,s);F.useEffect(()=>{Lj("https://cdn.flowus.cn/emoji/byte-icon-sprite.js","script")},[]);const c=()=>{const{emoji:g,data:_}=t;if(_)return ic(g,void 0,void 0,_)},u=g=>{if(!t.onClick)return;const{onClick:_}=t,x=c();x&&(x.imgPath=l,x&&_(x,g))},d=g=>{if(!t.onOver)return;const{onOver:_}=t,x=c();x&&(x.imgPath=l,x&&_(x,g))},f=g=>{if(!t.onLeave)return;const{onLeave:_}=t,x=c();x&&(x.imgPath=l,x&&_(x,g))};return r.jsxs("div",{ref:o,className:"inline-flex items-center justify-center shrink-0 emoji-mart-emoji text-center","list-item-custom":"",style:{width:parseFloat(`${t.size}`)+12,height:parseFloat(`${t.size}`)+12},children:[!a&&r.jsx("div",{style:{width:t.size,height:t.size}}),a&&r.jsx(Fe,{popup:(p=n.keywords)==null?void 0:p[0],children:r.jsx("span",{"aria-label":n.name,onClick:u,onMouseEnter:d,onMouseLeave:f,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",style:{color:i,width:t.size,height:t.size},children:r.jsx("use",{xlinkHref:`#${n.name}`})})})})]})},g2=e=>{const t=Fi,n=me(),[s,a]=F.useState(()=>localStorage.getItem("last-icon-color")||Pe.grey);return r.jsx(Rw,{customColorKey:s,data:e.useCustomIcon?ID:void 0,perLine:12,showSkinTones:!1,showPreview:!1,theme:"light",set:t?"apple":"google",native:t,emojiTooltip:!0,onSelect:e.onSelect,fallback:(o,i)=>e.useCustomIcon?r.jsx(LH,{emoji:o,emojiProps:i,color:i.customColorKey}):null,searchBtn:e.useCustomIcon?r.jsx("div",{className:"flex items-center justify-center w-8 h-8 hover:bg-black_003 cursor-pointer shrink-0 mr-2.5 ml-1.5 rounded",onClick:o=>{n.dropdown({popcorn:o.currentTarget,placement:"right",content:({onCloseModal:i})=>{var l;return r.jsx("div",{className:"next-modal w-[250px] px-1 pt-1.5 pb-2.5",children:r.jsx(Ld,{colors:nS,hideHeader:!0,value:(l=localStorage.getItem("last-icon-color"))!=null?l:Pe.black,selectedIcon:r.jsx(H,{name:"IcSelectedSpace",className:"text-[18px] text-white"}),onSelect:c=>{a(c),localStorage.setItem("last-icon-color",c),i()},bgColorFn:ld})})}})},children:r.jsx(Fe,{popup:"选择图标颜色",children:r.jsx("div",{className:"w-7 h-7 rounded-full border border-black/5 ",style:{backgroundColor:ld(s)}})})}):null,...e})},nS=wr.map(e=>({...e,name:""}));nS.unshift({key:Pe.black,name:""});const $s=e=>{var p,g;const{iconSize:t,emojiStr:n,defaultIcon:s,disableHover:a,className:o,hasOverlay:i,inline:l,style:c,...u}=e,d=F.useMemo(()=>n?PD(n,Fi?"apple":"google",wx()):null,[n]),f=(_,x)=>_?r.jsx("span",{className:"emoji",style:{fontSize:"1em",lineHeight:"1em"},children:_&&_.length>0?_:x}):x;if(l)return d?r.jsx(Gu,{className:o,attribute:u,ignoreEmojiSet:!0,useSvg:!0,emoji:d,size:"1em",skin:(p=d.skin)!=null?p:1,native:Fi,set:Fi?"apple":"google",style:c}):r.jsx("span",{className:"emoji inline",...u,style:c,children:n});const h=Number.isNaN(t)?void 0:t;return r.jsxs("span",{...u,className:B("emoji-container relative whitespace-nowrap",e.disableHover?"pointer-events-none":"cursor-pointer animate-hover",o),style:{fontSize:h,minWidth:h},children:[d?r.jsx(Gu,{ignoreEmojiSet:!0,useSvg:!0,emoji:d,size:"1em",skin:(g=d.skin)!=null?g:1,native:Fi,set:Fi?"apple":"google"}):f(n,s),i&&r.jsx(H,{className:"absolute right-[-1px] bottom-[0]",name:"MIcBadgePagelink",style:{fontSize:"0.65em",color:"black"}})]})},_2=e=>{const t=Fi?"":"google",n=F.useRef(null);return r.jsx("div",{ref:n,className:"flex p-1 rounded-sm next-modal",style:e.style,children:r.jsx(Bd,{listenPriority:Tr+1,containerRef:n,itemCount:6,spanCount:6,type:"grid",children:s=>Array.from({length:6}).map((a,o)=>{const i=ic(e.emoji,o+1,t,wx());return r.jsx($s,{className:s===o?"emoji-mart-emoji-active":void 0,onClick:()=>e.onSelect(i),emojiStr:i.native,iconSize:e.emojiSize||24},o)})})})},Wu={},PH=8,sS=()=>{let e=0;Object.values(Wu).forEach((t,n)=>{const s=t.clientHeight;n===0&&(e+=40),e+=s+PH;const a=e-s;t.classList.add("animate__animated","animate__faster","animate__fadeInDown","mt-4"),t.setAttribute("style",`position:fixed; transition: all .15s; z-index:8849; top:-40px; left:0; right:0; width:fit-content; margin:0 auto; margin-top: ${a}px; animation-duration: 0.2s; max-width:90%;`)})},rS=e=>{var t;(t=Wu[e])==null||t.classList.add("animate__fadeOutUp"),setTimeout(()=>{var n;(n=Wu[e])==null||n.remove(),delete Wu[e],sS()},300)},RT=e=>{const{content:t,duration:n,icon:s,key:a,messageType:o}=e,i=a||qe();if(Wu[i])return o==="loading"&&Is.render(r.jsx(AT,{icon:s,content:t,duration:n,itemId:i,messageType:o}),Wu[i]),i;const l=document.createElement("div");return l.id=i,document.getElementById("root").appendChild(l),Wu[i]=l,sS(),Is.render(r.jsx(AT,{icon:s,content:t,duration:n,itemId:i,messageType:o}),l),i},AT=e=>{const{icon:t,content:n,duration:s=3e3,itemId:a,messageType:o}=e;return F.useEffect(()=>{s!==0&&setTimeout(()=>{rS(a)},s)},[s,a]),r.jsxs("div",{className:"flex items-center px-3 py-2 next-modal bg-white4 min-h-[40px] text-t3 w-full",children:[r.jsx($s,{className:B("mr-2 pointer-events-none",{gelatine:o==="loading"}),iconSize:12,emojiStr:t}),r.jsx("span",{className:"break-words",children:n})]})},w_=(e,t)=>{var s;const n={loading:"⌛️",warning:"😮",error:"😱",success:"🥳"};return RT(typeof t=="object"?{content:t.content,duration:t.duration,key:t.key,messageType:e,icon:(s=t.icon)!=null?s:n[e]}:{content:t,icon:n[e]})},ye={success:e=>w_("success",e),error:e=>w_("error",e),warning:e=>w_("warning",e),loading:e=>w_("loading",typeof e=="string"?e:{duration:0,...e}),closeMessage:rS};bx.interceptors.request.use(e=>{let{url:t=""}=e;const{method:n,params:s}=e;return n==="get"&&s&&(t+="?",Object.keys(s).forEach(a=>{const o=s[a];o!==void 0&&(t+=`${a}=${encodeURIComponent(o)}&`)}),e.url=t.slice(0,t.length-1),e.params=void 0),e});const OH=async e=>{const{method:t,path:n,headers:s,query:a,formData:o,body:i}=e,l=n.replace(/[:]/g,"_");let c=i;o&&(c=new FormData,Object.entries(c).forEach(([d,f])=>{f!=null&&c.append(d,f)}));const u=await bx({method:t,url:l,params:a,data:c,headers:s});return u.data.code!==200&&console.error(u.data),{url:l,ok:!0,status:u.status,statusText:u.statusText,body:u.data}},MH=e=>{if(console.log("request 业务错误",e),e.code===502)return;const t=e.msg||e.message;t?ye.error(t):ye.error("网络异常")},Ce=m.createRequest(OH,MH);var Et=(e=>(e.personal="personal",e.freePersonal="freePersonal",e.freeTeam="freeTeam",e.smallTeam="smallTeam",e.team="team",e))(Et||{}),Yn=(e=>(e.uploading="uploading",e.success="success",e.failure="failure",e))(Yn||{}),Vs=(e=>(e.normal="normal",e.card="card",e.preview="preview",e))(Vs||{});const Yc=No(()=>({})),aS=()=>Yc.getState(),UH=e=>{Yc.setState(t=>({...t,...e}))},Mw=e=>{Yc.setState(t=>Jn(t,e))},v0e=()=>Yc(e=>e,rn),N0e=()=>Yc(e=>e.length),Pi=e=>Yc(t=>Object.values(t).find(n=>n.key.endsWith(e)),rn),cl=e=>{var n;const{key:t}=e;if(t){const s=(n=aS()[t])!=null?n:{};UH({[t]:{...s,...e}})}},oS=e=>Yc(t=>Object.entries(t).filter(([n,s])=>n.startsWith(e)&&s.status&&[Yn.uploading,Yn.failure].includes(s.status)).flatMap(([n,s])=>s).sort((n,s)=>s.createdAt-n.createdAt),rn),iS=e=>Yc(t=>Object.entries(t).filter(([n,s])=>n.startsWith(e)&&s.status&&[Yn.uploading,Yn.failure].includes(s.status)).length),fl="flowus.backup_transactions",O1="flowus.backup_no_permission_transactions";let Vh={};const Jo=GO.expanding();let or=[];const M1=new Up;let If=Date.now(),BT=0;const Oy=new Set,fn=(e,t)=>{var s;((s=Vh[e])!=null?s:Vh[e]=[]).push(t)},VH=e=>{const t=[];return e.forEach((n,s)=>{if(JSON.stringify(n).length<=32*1024){t.push(n);return}const a=s===e.length-1,o=i=>{const l=i.command==="set"&&t.length===0,c=a?n.id:qe();if(l)t.push({id:c,spaceId:n.spaceId,operations:[i]});else{const u=pn(t);u?u.operations.push(i):t.push({id:c,spaceId:n.spaceId,operations:[i]})}};n.operations.forEach(i=>{o(i)})}),t},LT=async e=>{var n;await $H(),or=VH([...or,...Jo.flush()]),If=Date.now();const t=[];if(or.length>0){$r.offline&&await zb($r.onStatusChange.pipe(TI(()=>$r.online)));const s=[];for(;or.length>0;){const a=or.shift();If=Date.now(),s.push(a);let o=!1;if(JSON.stringify(s).length>=256*1024){const i=s.pop();s.length===0?s.push(i):(or.unshift(i),If=Date.now()),o=!0}else or.length<=0&&(o=!0);if(o){const i=s.slice(0);s.length=0;try{await Ce.editor.transactionBlock({requestId:qe(),transactions:i})}catch(l){if(l.code!==1403)throw or=[...i,...or],l;t.push(...i)}$r.setStatus("online"),Ye({$syncUpFault:{noPermission:!1,backup:!1}}),i.forEach(l=>{const c=x2.get(l.id);c==null||c(),x2.delete(l.id)})}}or.length<=0&&Jo.isEmpty()&&Ye({$dirty:!1}),or.length<=0&&await Ja.removeItem(fl)}if(t.length>0){const s=(n=await Ja.getItem(O1))!=null?n:[];Ja.setItem(O1,[...s,...t]),In.emit("syncNoPermission")}If=Date.now()},PT=1e3,qH=async e=>{const t=await Ja.getItem(fl);if(t!=null&&t.transactions.length>0){for(const o of t.transactions)Jo.put(o);try{await LT(e)}catch(o){}if(or.length===0)await My(),location.reload();else{const o=[...or,...Jo.flush()];or=[];let i=0,l=o.length;for(;!(l<=i);){const c=o.slice(i,l);try{await Ce.editor.transactionBlock({requestId:qe(),transactions:c}),i=l,l=o.length}catch(u){l=Math.floor((i+l)/2)}}l<o.length?(await GH(o.slice(l)),await xs(500),alert("已自动恢复上次同步失败的部分数据，如发现有丢失重要数据，可自行从下载的 transactions.json 中找回。"),await My(),location.reload()):(await My(),location.reload())}}let n=[],s=-1/0,a=0;for(;;){let o="defer";if(or.length===0&&Jo.isEmpty()&&(o=await zb(M1)),o==="defer"){const i=Date.now();if(i-s<PT){const l=PT-(i-s);await zb(WO(KO(l),M1.pipe(OE())))}}if(or.length>0||!Jo.isEmpty()){try{await LT(e),n=[],a=0}catch(i){const l=/502/i.test(`${i==null?void 0:i.code}`),c=/Network Error/i.test(`${i==null?void 0:i.message}`),u=/^13/.test(`${i==null?void 0:i.code}`);if(c&&!navigator.onLine&&$r.setStatus("offline"),l||u)a=Math.min(a+4,16),await xs(1e3*a);else if(!c){const d=Date.now();n.push({error:i,timestamp:d}),n=n.filter(f=>d-f.timestamp<15*60*1e3),n.length>=3&&(Hp(i),Ye({$syncUpFault:{...wt.$syncUpFault,backup:!0}}),await xs(15*60*1e3))}}s=Date.now()}}},lS=e=>{const t=e.flush();for(const n of t)e.put(n);return t},cS=()=>[...or,...lS(Jo)],uS=async e=>{var t,n,s,a;if(BT<If){const o=[...or,...lS(Jo)],i={};for(const l of o)for(const c of l.operations){const u=(a=(s=(t=c.args)==null?void 0:t.uuid)!=null?s:(n=c.args)==null?void 0:n.parentId)!=null?a:c.id,d=bw(u,e);d!=null&&(i[d]=e().blocks[d].version)}o.length>0?await Ja.setItem(fl,{affectedPages:i,transactions:o}):await Ja.removeItem(fl),BT=Date.now()}},HH=async e=>{for(;;)await uS(e),await xs(1e3)},My=async e=>{or=[],Jo.flush(),await Ja.removeItem(fl)},$H=async e=>{var n;const t=JSON.stringify(e!=null?e:cS(),null,2);try{const s=(n=await Ja.getItem(`${fl}.$`))!=null?n:0;await Ja.setItem(`${fl}.${s}`,t),await Ja.setItem(`${fl}.$`,(s+1)%5)}catch(s){YO("backupTransactionsAndTriggerDownload: backup fail")}},GH=async e=>{const t=JSON.stringify(e!=null?e:cS(),null,2),n=new Blob([t],{type:"application/json; charset=UTF-8"}),s=URL.createObjectURL(n),a=document.createElement("a");a.href=s,a.download="transactions.json",a.style.cssText="position: fixed; left: -9999px; top: -9999px;",document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout(()=>{URL.revokeObjectURL(s)},60*1e3*3)},I0e=async()=>{var t;return(t=await Ja.getItem(O1))!=null?t:[]},j0e=async()=>{await Ja.removeItem(O1)},Uy=e=>(e==null?void 0:e.type)==="SPACE"?"space":"block",x2=new Map,zH=({getState:e,dispatch:t})=>{qH(t),HH(e);const n=s=>{const{callback:a=()=>{}}=s||{};let o=!1;const i=()=>{o||(a==null||a(),o=!0)};let l=!1;for(const[u,d]of Object.entries(Vh)){const h=JSON.stringify(d).length>131072?CI(d,12):[d];h.forEach((p,g)=>{const _=qe(),x={id:_,spaceId:u,operations:p};a!=null&&g===h.length-1&&x2.set(_,i),Jo.put(x)}),l=!0,If=Date.now()}const c=[...Oy];t(yw.actions.incVersion(c)),c.length>0&&Ye({$dirty:!0}),Oy.clear(),Vh={},l||i==null||i()};return window.addEventListener("beforeunload",s=>{uS(e),(Object.keys(Vh).length||!Jo.isEmpty()||or.length>0)&&(s.preventDefault(),s.returnValue="同步操作未完成, 是否离开?"),Object.entries(aS()).some(o=>o[1].progress!==100&&o[1].status===Yn.uploading)&&(s.preventDefault(),s.returnValue="图片仍在上传, 是否离开?")}),s=>a=>{var o,i;if(!WH(a)||(o=a.payload)!=null&&o.ignoreOp)return s(a);if(vn(eg)(a))return n(),M1.next("defer"),s(a);if(vn(Er)(a)){const l=new jx;return n({callback:()=>{l.resolve()}}),M1.next("immediate"),oa(()=>l.promise),s(a)}if(Oy.add(a.payload.uuid),vn(Ia)(a)){const{payload:l}=a;return fn(l.block.spaceId,{id:l.block.uuid,command:m.CommandType.SET,table:"block",path:[],args:{...Jn(l.block,["local","version","subNodes","data"]),data:OT(l.block.data)}}),s(a)}if(vn(tr)(a)){const{payload:l}=a,{blocks:c}=e(),u=c[l.uuid];if(u){const d=Uy(c[u.parentId]);fn(u.spaceId,{id:u.parentId,command:m.CommandType.LIST_REMOVE,table:d,path:["subNodes"],args:{uuid:u.uuid}})}return s(a)}if(vn(Wn)(a)){const{payload:l}=a,{blocks:c}=e(),u=c[l.uuid],d=c[l.parentId];if(u){const f=Uy(d);fn(u.spaceId,{id:u.uuid,command:m.CommandType.UPDATE,table:"block",path:[],args:{status:m.BlockStatus.NORMAL,parentId:l.parentId}}),fn(u.spaceId,{id:l.parentId,command:m.CommandType.LIST_AFTER,table:f,path:["subNodes"],args:{uuid:u.uuid,after:l.after}})}return s(a)}if(vn(Ii)(a)){const{payload:l}=a,{blocks:c}=e(),u=c[l.uuid],d=c[l.parentId];if(u){const f=Uy(d);u.parentId!==l.parentId&&fn(u.spaceId,{id:u.uuid,command:m.CommandType.UPDATE,table:"block",path:[],args:{status:m.BlockStatus.NORMAL,parentId:l.parentId}}),fn(u.spaceId,{id:l.parentId,command:m.CommandType.LIST_BEFORE,table:f,path:["subNodes"],args:{uuid:u.uuid,before:l.before}})}return s(a)}if(vn(mn)(a)){const{payload:l}=a,c=e().blocks[l.uuid];if(c&&(c!=null&&c.parentId)){const u=(i=l.patch.data)==null?void 0:i.segments;l.patch.data&&(u!=null&&u.length)&&JSON.stringify(u).includes('"text":false')&&(l.patch.data.segments=u.map(f=>({...f,enhancer:Jn(f.enhancer,"textColor")})));const d=Jn(l.patch,["local","version","subNodes","data"]);if(Object.keys(d).length&&fn(c.spaceId,{id:c.uuid,path:[],command:m.CommandType.UPDATE,table:"block",args:d}),l.patch.data){const f=Jn(l.patch.data,["format"]);fn(c.spaceId,{id:c.uuid,path:["data"],command:m.CommandType.UPDATE,table:"block",args:OT(f)}),l.patch.data.format&&fn(c.spaceId,{id:c.uuid,path:["data","format"],command:m.CommandType.UPDATE,table:"block",args:{...l.patch.data.format}})}}return s(a)}if(vn(dx)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&fn(c.spaceId,{id:c.uuid,path:[],command:m.CommandType.SET_PERMISSION,table:"block",args:l.permission}),s(a)}if(vn(fx)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&fn(c.spaceId,{id:c.uuid,path:[],command:m.CommandType.REMOVE_PERMISSION,table:"block",args:l.permission}),s(a)}if(vn(jm)(a)){const{payload:l}=a;return fn(l.collectionView.spaceId,{id:l.collectionView.uuid,command:m.CommandType.SET,table:"collectionView",path:[],args:l.collectionView}),s(a)}if(vn(oc)(a)){const{payload:l}=a,{collectionViews:c}=e(),u=c[l.uuid];if(u){const d=Jn(l.patch,["format"]);fn(u.spaceId,{id:l.uuid,command:m.CommandType.UPDATE,table:"collectionView",path:[],args:d}),l.patch.format&&fn(u.spaceId,{id:l.uuid,command:m.CommandType.UPDATE,table:"collectionView",path:["format"],args:{...l.patch.format}})}return s(a)}if(vn(fd)(a)){const{payload:l}=a,{collectionViews:c}=e(),u=c[l.uuid];return u&&(u.parentId!==l.parentId&&fn(u.spaceId,{id:u.uuid,command:m.CommandType.UPDATE,table:"collectionView",path:[],args:{status:m.BlockStatus.NORMAL,parentId:l.parentId}}),fn(u.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_AFTER,path:["views"],args:{uuid:l.uuid,after:l.after}})),s(a)}if(vn(sm)(a)){const{payload:l}=a,{collectionViews:c}=e(),u=c[l.uuid];return u&&(l.parentId!==u.parentId&&fn(u.spaceId,{id:u.uuid,command:m.CommandType.UPDATE,table:"collectionView",path:[],args:{status:m.BlockStatus.NORMAL,parentId:l.parentId}}),fn(u.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_BEFORE,path:["views"],args:{uuid:l.uuid,before:l.before}})),s(a)}if(vn(md)(a)){const{payload:l}=a,{collectionViews:c}=e(),u=c[l.viewId];return u&&fn(u.spaceId,{id:l.viewId,table:"collectionView",command:m.CommandType.LIST_BEFORE,path:["pageSort"],args:{uuid:l.uuid,before:l.before}}),s(a)}if(vn(Fl)(a)){const{payload:l}=a,{collectionViews:c}=e(),u=c[l.viewId];return u&&fn(u.spaceId,{id:l.viewId,table:"collectionView",command:m.CommandType.LIST_AFTER,path:["pageSort"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(vn(_c)(a)){const{payload:l}=a,{collectionViews:c}=e(),u=c[l.viewId];return u&&fn(u.spaceId,{id:l.viewId,table:"collectionView",command:m.CommandType.LIST_REMOVE,path:["pageSort"],args:{uuid:l.uuid}}),s(a)}if(vn(_c)(a)){const{payload:l}=a,{collectionViews:c}=e(),u=c[l.uuid];return u&&fn(u.spaceId,{id:l.viewId,table:"collectionView",command:m.CommandType.LIST_REMOVE,path:["pageSort"],args:{uuid:l.uuid}}),s(a)}if(vn(rm)(a)){const{payload:l}=a,{collectionViews:c}=e(),u=c[l.uuid];return u&&fn(u.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_REMOVE,path:["views"],args:{uuid:l.uuid}}),s(a)}if(vn(om)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&fn(c.spaceId,{id:l.parentId,table:"spaceView",command:m.CommandType.LIST_AFTER,path:["favoritePages"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(vn(am)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&fn(c.spaceId,{id:l.parentId,table:"spaceView",command:m.CommandType.LIST_BEFORE,path:["favoritePages"],args:{uuid:l.uuid,before:l.before}}),s(a)}if(vn(hd)(a)){const{payload:l}=a,c=y_(e);return fn(c,{id:l.parentId,table:"spaceView",command:m.CommandType.LIST_REMOVE,path:["favoritePages"],args:{uuid:l.uuid}}),s(a)}if(vn(px)(a)){const{payload:l}=a,c=Jn(l.patch,["setting"]),u=y_(e);return fn(u,{id:l.uuid,table:"spaceView",command:m.CommandType.UPDATE,path:[],args:c}),l.patch.setting&&fn(u,{id:l.uuid,table:"spaceView",command:m.CommandType.UPDATE,path:["setting"],args:{...l.patch.setting}}),s(a)}if(vn(Fw)(a)){const{payload:l}=a,c=y_(e),u=gl(l.patch,["title","icon","permissionGroups","domain","publicHomePage","isShowAd","setting"]);fn(c,{id:l.uuid,table:"space",command:m.CommandType.SET,path:[],args:u})}if(vn(ap)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&fn(c.spaceId,{id:l.parentId,table:"space",command:m.CommandType.LIST_AFTER,path:["customTemplates"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(vn(rp)(a)){const{payload:l}=a,c=e().blocks[l.uuid];return c&&fn(c.spaceId,{id:l.parentId,table:"space",command:m.CommandType.LIST_BEFORE,path:["customTemplates"],args:{uuid:l.uuid,before:l.before}}),s(a)}if(vn(op)(a)){const{payload:l}=a,c=y_(e);return fn(c,{id:l.parentId,table:"space",command:m.CommandType.LIST_REMOVE,path:["customTemplates"],args:{uuid:l.uuid}}),s(a)}if(vn(gx)(a)){const{payload:l}=a;return fn(l.discussion.spaceId,{id:l.discussion.uuid,command:m.CommandType.SET,table:"discussion",path:[],args:l.discussion}),s(a)}if(vn(Bu)(a)){const{payload:l}=a,{discussions:c}=e(),u=c[l.uuid];return u&&fn(u.spaceId,{id:l.uuid,command:m.CommandType.UPDATE,table:"discussion",path:[],args:l.patch}),s(a)}if(vn(tg)(a)){const{payload:l}=a,c=e().discussions[l.uuid];return c&&fn(c.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_AFTER,path:["discussions"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(vn(ng)(a)){const{payload:l}=a;return fn(l.spaceId,{id:l.parentId,table:"block",command:m.CommandType.LIST_REMOVE,path:["discussions"],args:{uuid:l.uuid}}),s(a)}if(vn(_x)(a)){const{payload:l}=a;return fn(l.comment.spaceId,{id:l.comment.uuid,command:m.CommandType.SET,table:"comment",path:[],args:l.comment}),s(a)}if(vn(lp)(a)){const{payload:l}=a,{comments:c}=e(),u=c[l.uuid];return u&&fn(u.spaceId,{id:l.uuid,command:m.CommandType.UPDATE,table:"comment",path:[],args:l.patch}),s(a)}if(vn(xx)(a)){const{payload:l}=a,c=e().comments[l.uuid];return c&&fn(c.spaceId,{id:l.parentId,table:"discussion",command:m.CommandType.LIST_AFTER,path:["comments"],args:{uuid:l.uuid,after:l.after}}),s(a)}if(vn(Fx)(a)){const{payload:l}=a;return fn(l.spaceId,{id:l.parentId,table:"discussion",command:m.CommandType.LIST_REMOVE,path:["comments"],args:{uuid:l.uuid}}),s(a)}s(a)}};function OT(e){return zO(e)?gl(e,["pageId","cover","coverPos","icon","segments","checked","level","width","height","ratio","ossName","fileType","caption","widths","size","text","ref","link","extName","display","pageFixedWidth","directoryMenu","format","embedType","viewMode","columnRatio","permissions","schema","collectionProperties","collectionPageProperties","collectionCardColor","description","linkInfo","header","createdTemplateBy","pdfAnnotation"]):{}}function WH(e){return/^(block|collection-view|space-view|transaction|favorite|space|template|discussion|comment)\//.test(e==null?void 0:e.type)}const KH=(e={})=>e,YH={},dS=Io({initialState:YH,name:"collectionViews",reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}},extraReducers(e){e.addCase(jm,(t,{payload:n})=>{t[n.collectionView.uuid]=n.collectionView}),e.addCase(oc,(t,{payload:n})=>{const s=t[n.uuid];if(s){n.patch.format&&Object.assign(s.format,n.patch.format);const a=Jn(n.patch,"format");Object.keys(a).length>0&&Object.assign(s,a)}}),e.addCase(_c,(t,{payload:n})=>{const{uuid:s,viewId:a}=n,o=t[a];o&&(o.pageSort=o.pageSort.filter(i=>i!==s))}),e.addCase(md,(t,{payload:n})=>{const{uuid:s,viewId:a,before:o}=n,i=t[a];if(i)if(o){const l=i.pageSort.indexOf(o);l<0?i.pageSort.unshift(s):i.pageSort.splice(l,0,s)}else i.pageSort.unshift(s)}),e.addCase(Fl,(t,{payload:n})=>{const{uuid:s,after:a,viewId:o}=n,i=t[o];if(i)if(a){const l=i.pageSort.indexOf(a);l<0?i.pageSort.push(s):i.pageSort.splice(l+1,0,s)}else i.pageSort.push(s)})}}),XH=dS.reducer,Am=dS.actions,QH={},fS=Io({initialState:QH,name:"comments",reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}},extraReducers(e){e.addCase(_x,(t,{payload:n})=>{t[n.comment.uuid]=n.comment}),e.addCase(lp,(t,{payload:n})=>{const s=t[n.uuid];s&&Object.assign(s,n.patch)})}}),JH=fS.reducer,ZH=fS.actions,e$={},mS=Io({initialState:e$,name:"discussions",reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}},extraReducers(e){e.addCase(gx,(t,{payload:n})=>{t[n.discussion.uuid]=n.discussion}),e.addCase(Bu,(t,{payload:n})=>{const s=t[n.uuid];s&&Object.assign(s,n.patch)}),e.addCase(xx,(t,{payload:n})=>{const{uuid:s,after:a,parentId:o}=n,i=t[o];if(i)if(!i.comments)i.comments=[s];else if(a){const l=i.comments.indexOf(a);l<0?i.comments.push(s):i.comments.splice(l+1,0,s)}else i.comments.push(s)}),e.addCase(Fx,(t,{payload:n})=>{var i;const{uuid:s,parentId:a}=n,o=t[a];o&&(o.comments=(i=o.comments)==null?void 0:i.filter(l=>l!==s))})}}),t$=mS.reducer,n$=mS.actions,s$={},hS=Io({name:"pageMetas",initialState:s$,reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}}}),r$=hS.reducer,Pu=hS.actions,a$={},pS=Io({name:"publicSpaces",initialState:a$,reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}}}),o$=pS.reducer,gS=pS.actions,i$={},_S=Io({name:"simple-table",initialState:i$,reducers:{update(e,t){Object.assign(e,t.payload)}}}),l$=_S.reducer,Qn=_S.actions,c$={},xS=Io({name:"spaceViews",initialState:c$,reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}}},extraReducers(e){e.addCase(nq,(t,{payload:n})=>{t[n.spaceView.uuid]=n.spaceView}),e.addCase(sq,(t,{payload:n})=>{delete t[n.uuid]}),e.addCase(px,(t,{payload:n})=>{const s=t[n.uuid];if(!s)return;const{setting:a,...o}=n.patch;Object.assign(s,o),s.setting||(s.setting={}),a&&Object.assign(s.setting,a)}),e.addCase(hd,(t,{payload:n})=>{const s=t[n.parentId];if(!s)return;const a=s.favoritePages.indexOf(n.uuid);a>-1&&s.favoritePages.splice(a,1)}),e.addCase(am,(t,{payload:n})=>{const s=t[n.parentId];if(s)if(n.before){const a=s.favoritePages.indexOf(n.before);a<0?s.favoritePages.splice(0,0,n.uuid):s.favoritePages.splice(a,0,n.uuid)}else s.favoritePages.splice(0,0,n.uuid)}),e.addCase(om,(t,{payload:n})=>{const s=t[n.parentId];if(s)if(n.after){const a=s.favoritePages.indexOf(n.after);a<0?s.favoritePages.splice(0,0,n.uuid):s.favoritePages.splice(a+1,0,n.uuid)}else s.favoritePages.splice(0,0,n.uuid)})}}),u$=xS.reducer,d$=xS.actions,f$={selectedBlocks:[],selectedCells:[]},FS=Io({name:"ui",initialState:f$,reducers:{update(e,t){t.payload.selectedBlocks&&(e.isSelectTopToBottom=!0),Object.assign(e,t.payload)},updateSelectBlocks(e,t){e.selectedBlocks=t.payload,t.payload.length&&(e.selectedCells=[]),e.isSelectTopToBottom=!0},addSelectBlock(e,t){e.selectedBlocks.find(s=>s.blockId===t.payload.blockId)||e.selectedBlocks.push(t.payload)},removeSelectBlock(e,t){const n=e.selectedBlocks.findIndex(s=>s.blockId===t.payload.blockId);n>=0&&e.selectedBlocks.splice(n,1)},updateSelectCells(e,t){e.selectedCells=t.payload,t.payload.length&&(e.selectedBlocks=[],e.isSelectTopToBottom=!0)}},extraReducers(){}}),m$=FS.reducer,nt=FS.actions,h$={},yS=Io({name:"users",initialState:h$,reducers:{update(e,t){Object.assign(e,t.payload)},clear(){return{}},updateSpaceUsers(e,t){const{users:n,space:s}=t.payload,a=Object.entries(n).reduce((o,[i,l])=>{var u,d,f,h;const c=(d=(u=s==null?void 0:s.userRemark)==null?void 0:u[i])!=null?d:"";return o[i]={...l,pinyin:`${yl(l.nickname||ni,!0)}${l.phone}${yl(c)}`,spaceRole:(h=(f=s==null?void 0:s.permissions)==null?void 0:f.find(({userId:p})=>p===i))==null?void 0:h.role},o},{});Object.assign(e,a)},removeUser(e,t){delete e[t.payload]}}}),p$=yS.reducer,El=yS.actions,bS=Object.freeze(Object.defineProperty({__proto__:null,blocks:oq,cache:KH,collectionViews:XH,comments:JH,discussions:t$,pageMetas:r$,publicSpaces:o$,simpleTable:l$,spaceViews:u$,spaces:lq,ui:m$,user:cq,users:p$},Symbol.toStringTag,{value:"Module"})),U1=vI({reducer:{...bS},devTools:!1,middleware(e){return e({serializableCheck:!1}).concat(zH,gq,mq)}}),{getState:le,dispatch:ee,subscribe:D0e}=U1,K=new Proxy(le(),{get(e,t){return Reflect.get(le(),t)}}),ls=(e,t)=>{const{blocks:n}=t!=null?t:le(),s=n[e];if(!s)return;let a=n[s.parentId];for(;a;){if(Xt(a.type))return a.uuid;a=n[a.parentId]}},ES={blocks:{},collectionViews:{},comments:{},discussions:{},pageMetas:{},publicSpaces:{},simpleTable:{},spaceViews:{},spaces:{},ui:{selectedBlocks:[],selectedCells:[]},users:{},user:CD,cache:{}},g$=No(()=>ES),F2=PE({$state:g$,isInit:!1}),_$=e=>{const{wait:t=0,waitMode:n="throttle"}=e,s=F.useRef(No(()=>ES)),a=F.useRef(!0),o=F.useMemo(()=>(n==="throttle"?fs:$n)(()=>{const l=new Proxy(le(),{get:(c,u)=>le()[u]});s.current.setState(l)},t,{leading:!0,trailing:!0}),[t,n]);return NI(o,rn),{state:s.current,isInit:a.current}},x$=(e,t)=>{const{equalityFn:n}=t||{},s=v1(F2,o=>o.$state);return v1(F2,o=>o.isInit)?s(e,n!=null?n:rn):NI(e,n!=null?n:rn)},ae=x$;function Bm(e,t){const n=[];return e.forEach(s=>{n.some(a=>a[t]===s[t])||n.push(s)}),n}const y2=()=>{const e=le(),t=[];return e.user.spaceViews.forEach(n=>{var a,o;const s=e.spaces[(o=(a=e.spaceViews[n])==null?void 0:a.spaceId)!=null?o:""];s&&t.push(s)}),Bm(t,"uuid")},Uw=()=>{const e=ae(n=>n.user.spaceViews),t=ae(n=>n.spaces);return F.useMemo(()=>{const n=[];return e.forEach(s=>{var o,i;const a=t[(i=(o=K.spaceViews[s])==null?void 0:o.spaceId)!=null?i:""];a&&n.push(a)}),Bm(n,"uuid")},[e,t])},wS=e=>{Nn(n2,e),ee(Ci.update({currentSpaceViewId:e}))},kS=(e,t=!1)=>{const n=V1(e);n&&wS(n),t&&(Ye({$sharedPages:[]}),Ye({$pageRootLoaded:!1}))},V1=e=>{const{spaceViews:t}=le();for(const[n,s]of Object.entries(t))if(s.spaceId===e)return n;return""},Ut=()=>{var e,t;return(t=(e=CS(le().user.currentSpaceViewId))==null?void 0:e.uuid)!=null?t:""},cm=()=>TS(le().user.currentSpaceViewId),CS=e=>{var o,i;const{spaceViews:t,spaces:n,publicSpaces:s}=le(),a=(i=(o=t[e])==null?void 0:o.spaceId)!=null?i:"";return Lm(a)},Lm=e=>{var s;const{spaces:t,publicSpaces:n}=le();return(s=t[e])!=null?s:n[e]},TS=e=>{const{spaceViews:t}=le();return t[e]},Ku={uuid:"",setting:{},domain:"",isShowAd:!0,publicHomePage:"",customTemplates:[],title:"",icon:{},backgroundColor:"",subNodes:[],version:0,status:m.BlockStatus.NORMAL},Ft=()=>ae(e=>{var n;if(!e.user.currentSpaceViewId)return Ku;const t=e.spaceViews[e.user.currentSpaceViewId];return t&&(n=e.spaces[t.spaceId])!=null?n:Ku}),Vw=()=>ae(e=>{var n,s;let t;if(!e.user.currentSpaceViewId)t=Ku;else{const a=e.spaceViews[e.user.currentSpaceViewId];a?t=e.spaces[a.spaceId]:t=Ku}return(s=(n=t==null?void 0:t.setting)==null?void 0:n.daySetting)!=null?s:m.DaySetting.MON}),qw=()=>ae(e=>e.spaceViews[e.user.currentSpaceViewId]),Od=e=>ae(t=>{var n,s;return(s=(n=t.spaces[e!=null?e:""])!=null?n:t.publicSpaces[e!=null?e:""])!=null?s:Ku}),Tn=()=>{var t;const e=le();return(t=CS(e.user.currentSpaceViewId))!=null?t:Ku},S0e=()=>ae(e=>{var n;if(!e.user.currentSpaceViewId)return;const t=e.spaceViews[e.user.currentSpaceViewId];if(t)return(n=e.spaces[t.spaceId])==null?void 0:n.domain}),Md=e=>ae(t=>{var s,a;if(!e||ud())return"";const n=(a=(s=t.spaces[e])==null?void 0:s.domain)!=null?a:"";return n?`/${n}`:""}),F$=(e="")=>ae(t=>t.publicSpaces[e]),vS=()=>F.useCallback(async e=>{const t=V1(e);Is.unstable_batchedUpdates(()=>{var n;ee(wD({uuid:t})),wS((n=K.user.spaceViews[0])!=null?n:"")}),await Ce.infra.deleteSpace(e)},[]),y$=()=>un?{x_device_type:"desktop",x_platform:Wb?"mac":"windows",platform:Wb?"mac":"windows"}:{x_device_type:"web",x_platform:"web",platform:"web"};class b${constructor(t,n,s){q(this,"windowFunName");q(this,"login",(t,n,s)=>(this.trackEvent("config",{user_unique_id:t,...n},s),this));q(this,"logout",()=>(this.trackEvent("config",{user_unique_id:""},!0),this));q(this,"trackEvent",(t,n,s)=>(Reflect.get(window,this.windowFunName)(t,n),this));q(this,"addUserAttribute",(t,n)=>(this.trackEvent("profileSet",t,n),this));q(this,"evtParams",{});q(this,"setCommonParams",(t,n)=>(this.evtParams=t,this.trackEvent("config",{...this.evtParams},n),this));q(this,"addCommonParams",(t,n)=>(Object.assign(this.evtParams,t),this.trackEvent("config",{evtParams:{...this.evtParams}},n),this));this.windowFunName=s;const a=document.createElement("script");a.innerHTML=`(function(win, export_obj) {
      win['TeaAnalyticsObject'] = export_obj;
      if (!win[export_obj]) {
          function _collect() {
              _collect.q.push(arguments);
          }
          _collect.q = _collect.q || [];
          win[export_obj] = _collect;
      }
      win[export_obj].l = +new Date();
  })(window, '${this.windowFunName}');`,document.body.appendChild(a);const o=document.createElement("script");o.src="https://lf3-data.volccdn.com/obj/data-static/log-sdk/collect/5.0/collect-rangers-v5.0.0.js",o.async=!0,document.body.appendChild(o),Reflect.get(window,this.windowFunName)("init",{app_id:t,channel:"cn",log:n}),this.trackEvent("config",{disable_auto_pv:!0}),Reflect.get(window,this.windowFunName)("start")}}class E${constructor(t="collect"){q(this,"stayTimeMap",new Map);q(this,"tracker");q(this,"login",(t,n,s)=>(this.tracker.login(t,n,s),this));q(this,"logout",()=>(this.tracker.logout(),this));q(this,"setCommonParams",(t,n)=>(this.tracker.setCommonParams(t,n),this));q(this,"addCommonParams",(t,n)=>(this.tracker.setCommonParams(t,n),this));q(this,"event",(t,n={},s)=>{this.tracker.trackEvent(t,n,s)});q(this,"pageEnter",t=>{this.stayTimeMap.set(t,Date.now())});q(this,"pageLeave",(t,n={},s)=>{const a=this.stayTimeMap.get(t);if(!a)return;const o=(Date.now()-a)/1e3;this.tracker.trackEvent(t,{...n,time:o.toFixed(1)},s)});q(this,"addUserAttribute",(t,n)=>{this.tracker.addUserAttribute(t,n)});this.tracker=new b$(parseInt("303823",10),!1,t)}}const ce=new E$("webCollectEvent"),q1=1,H1=1<<1,$1=1<<1,NS=async(e=q1|H1|$1,t,n)=>{var x,y,b;const s=localStorage.getItem(cd);if(!s)return;const a=await Ce.infra.getUserRoot.raw(s);if(a.code!==200){n&&ye.error(a.msg),a.code===1403&&localStorage.removeItem(cd);return}const o=a.data,{users:i,spaces:l,spaceViews:c}=o;let u;if(c){const E=Object.values(c).filter(w=>!(l&&l[w.spaceId])).map(w=>w.spaceId);if(E.length){const w=await Ce.infra.getSpacesPublicData({spaceIds:E});u=w.spaces,ee(ip.update(u)),ee(gS.update(w.spaces))}}const d=le().user.currentSpaceViewId;let f=t?d:localStorage.getItem(n2);const h=i==null?void 0:i[s];if(!h)return;const p=c==null?void 0:c[f!=null?f:""];return!!!((l==null?void 0:l[(x=p==null?void 0:p.spaceId)!=null?x:""])||(u==null?void 0:u[(y=p==null?void 0:p.spaceId)!=null?y:""]))&&h.spaceViews.length>0&&(f=(b=(()=>h.spaceViews.find(w=>{var T,v,I,j;const k=l==null?void 0:l[(v=(T=c==null?void 0:c[w])==null?void 0:T.spaceId)!=null?v:""],C=u==null?void 0:u[(j=(I=c==null?void 0:c[w])==null?void 0:I.spaceId)!=null?j:""];return!!(k||C)}))())!=null?b:"",f&&Nn(n2,f)),Is.unstable_batchedUpdates(()=>{if(l&&Vy(e,H1)){ee(ip.update(l));const E={...Vp(l,w=>({spaceId:w.uuid,type:"SPACE",data:{icon:w.icon},permissions:[],...w}))};ee(Gn.update({blocks:E}))}o.spaceViews&&Vy(e,$1)&&ee(d$.update(o.spaceViews)),Vy(e,q1)&&(ee(Ci.update({...h,currentSpaceViewId:f!=null?f:""})),ce.addCommonParams({promotion_channel:h.promotionChannel,...y$()}))}),o},Vy=(e,t)=>(e&t)!==0,Pm=async e=>{await NS(q1|H1|$1,e)},Bs=(e,t)=>{if(window.location.pathname!==e){const s=new URLSearchParams(decodeURIComponent(location.search)).toString(),a=t&&s?`?${s}`:"";if(un)if(tm(e)){const o=new URL(e);window.location.href=`${o.pathname}${o.search||""}`}else window.location.href=`${e}${a}`;else window.location.href=tm(e)?`${e}${a}`:`${Sn()}${e}`}},cp=e=>{if(un)if(tm(e)){const t=new URL(e);window.location.replace(`${t.pathname}${t.search||""}`)}else window.location.replace(e);else{const t=tm(e)?e:`${Sn()}${e}`;window.location.replace(t)}},Sn=()=>un?Mt:window.location.origin,G1=e=>{const{user:t}=le();return t.spaceViews.length===0?(Bs(Rt.create,e),!0):!1},Hw=()=>F.useCallback(async(e,t)=>{ee(Fw({uuid:e,patch:t}))},[]),Yr=(e,t=ni)=>{var a,o;const n=Ft(),s=ae(i=>{var l;return(l=i.users[e])==null?void 0:l.nickname});return(o=((a=n.userRemark)==null?void 0:a[e])||s)!=null?o:t},ss=(e,t=ni)=>{var s,a,o;return(o=((s=Tn().userRemark)==null?void 0:s[e])||((a=K.users[e])==null?void 0:a.nickname))!=null?o:t},$w=e=>{if(!e)return{showPageIcon:!0,showPage:!0};const t=![m.BlockType.TEXTAREA,m.BlockType.HEADER].includes(e),n=[m.BlockType.BOOKMARK,m.BlockType.EMBED,m.BlockType.DIVIDER,m.BlockType.TABLE,m.BlockType.TEMPLATE,m.BlockType.SYNC_CONTAINER,m.BlockType.SYNC_REFERENCE].includes(e);return{showPageIcon:t,showPage:n}},Ot=e=>{var t,n;return e==null?"":(n=(t=_T[e])!=null?t:_T[m.BlockType.PAGE])!=null?n:""},z1=1,de=(e=[],t=0)=>(e||(e=[]),e.map(n=>{var s,a;if(n.type===m.TextType.LINK_PAGE&&n.uuid){if(t>z1)return"";const o=K.blocks[n.uuid];return o?`@${de(o.data.segments,t+1)||Ot(o.type)}`:""}else{if([m.TextType.DATETIME,m.TextType.DATE].includes(n.type))return`@${Wp(n)}`;if(n.type===m.TextType.USER&&n.uuid)return`@${ss(n.uuid)}`;if(n.type===m.TextType.MENTION_BLOCK&&n.uuid){if(t>z1)return"@块引用";const o=K.blocks[n.uuid];if(!o)return"@块引用";if(o.type===m.BlockType.PDF_ANNOTATION)return`@${(a=(s=o.data.pdfAnnotation)==null?void 0:s.text)!=null?a:""}`;if(n.text)return n.text;const{showPage:i}=$w(o.type);if(!ls(n.uuid))return"@块引用";if(i){const c=K.blocks[n.uuid];if(c)return`@${de(c.data.segments,t+1)||Ot(c.type)}`}return`@${de(o.data.segments,t+1)||Ot(o.type)}`}}return n.text}).join("")),mt=e=>e==null?[]:[{text:e.toString(),type:m.TextType.TEXT,enhancer:{}}],xc=e=>!e||!e.segments||e.segments.length===0?!0:!de(e.segments)&&e.segments.length===0,b2=e=>{const{name:t,ossName:n,size:s,width:a,height:o}=e;return{uuid:qe(),type:m.TextType.URL,enhancer:{},fileStorageType:"internal",text:t,url:n,size:s,width:a,height:o}},IS=()=>{const e=async(n,s=!0)=>{var y,b,E;const{spaceId:a=Ut(),pageNo:o,perPage:i,search:l,fileType:c,type:u,source:d,parentId:f}=n,h=await Ce.editor.searchDocs(a,o,i,l,c,u,d,f),{blocks:p,collectionViews:g}=(y=h.recordMap)!=null?y:{};if(!p)return{hasMore:!1,result:[],total:(b=h.total)!=null?b:0};const _=w=>{const k=[];let C=p[w];for(;C;)C=p[C.parentId],C&&Xt(C.type)&&k.unshift(C);return k};s&&ee(Gn.update({blocks:p}));const x=h.results.map(w=>{const k=p[w.uuid];if(k)return{block:k,coverUrl:w.coverUrl,navs:_(w.uuid)}}).filter(w=>!!w);return{hasMore:h.more,result:x,total:(E=h.total)!=null?E:0}};return async(n,s=!0)=>{let a=!0;const o=[];let i=0;const l=10;let c=0;do{const u=await e({...n,pageNo:n.pageNo+i},s);a=u.hasMore,o.push(...u.result),i++,c=u.total}while(a&&o.length<n.perPage&&i<l);return{hasMore:a,total:c,newPageNo:n.pageNo+i-1,resultBlocks:o}}},R0e=()=>{const e=async(n,s,a,o=!0)=>{var d,f,h;const i=await Ce.infra.getSpaceTrash(n,s,a),l=(d=i.recordMap)==null?void 0:d.blocks;if(!l)return{hasMore:!1,result:[],total:(f=i.total)!=null?f:0};const c=p=>{const g=[];let _=l[p];for(;_;)_=l[_.parentId],_&&Xt(_.type)&&g.unshift(_);return g};o&&ee(Gn.update({blocks:l}));const u=i.results.map(p=>{const g=l[p.uuid];if(g)return g.deletedAt=p.deletedAt,{block:g,coverUrl:p.coverUrl,navs:c(p.uuid)}}).filter(p=>!!p);return{hasMore:i.more,result:u,total:(h=i.total)!=null?h:0}};return async(n,s,a,o=!0)=>{let i=!0;const l=[];let c=0;const u=10;let d=0;do{const f=await e(n,s+c,a,o);i=f.hasMore,l.push(...f.result),c++,d=f.total}while(i&&l.length<a&&c<u);return{hasMore:i,total:d,newPageNo:s+c-1,resultBlocks:l}}},cn={image:/^(apng|avif|bmp|gif|ico|cur|jpg|jpeg|jfif|pjep|pjp|png|svg|webp|heic|heif|pic|tif)$/i,audio:/^(mp3|wma|wave|flac|aac|cda|midi|ape|aiff|ra|rm|rmx|vqf|amr|aiff|ogg|ac3|m4a|wav)$/i,video:/^(mp4|mov|flv|webm|m4v|rm|rmvb|wmv|avi|mpg|mpeg|flc|mkv|f4v|3gp|asf)$/i,txt:/^(txt|rtf|ts|tsx|js|jsx|html|xml|css|less|scss|cpp|py|c|cs|h|asp|sh|go|java|php|json|yml|md|log|m|ini|lua|sql|rs|rb)$/i,office:/^(doc|docx|xls|xlsx|ppt|pptx)$/i,pdf:/^(pdf)$/i,zip:/^(7z|rar|jar|zip|cab|ace|tar)$/i,ppt:/^(ppt|pptx)$/i,csv:/^(csv)$/i},jS=e=>{let t="";return e===m.BlockType.FOLDER?t="文件夹":e===m.BlockType.FILE?t="文件":t="页面",t},w$="video/*,.mpg,.3gp,.asf,.avi,.f4v,.flv,.mkv,.rmvb,.wmv",k$="audio/*,.ogg,.m4a,.amr,.ac3,.wma,.ape",sn=(e="")=>{const t=e.lastIndexOf("."),n=e.substring(0,t);let s=e.substring(t+1);const a=s.match(/\w+/);return a!=null&&a[0]&&(s=a[0]),{name:n,extName:s}},up=(e=[])=>sn(de(e)),C$=(e="")=>cn.audio.test(e)?"audio":cn.video.test(e)?"video":cn.image.test(e)?"image":"file",T$=(e="",t=4)=>{if(e.length<=t)return[e,""];const n=e.substring(0,e.length-t),s=e.substring(e.length-t);return[n,s]},pa=(e="")=>{let t="IcBlockFile";if(!e)return"IcBlockFile";if(e=e.toLocaleLowerCase(),cn.image.test(e))t="list_image";else if(cn.audio.test(e))t="voice";else if(cn.video.test(e))t="video";else if(cn.zip.test(e))t="zip";else if(cn.ppt.test(e))t="ppt";else if(cn.txt.test(e))switch(e){case"md":case"html":t=e;break;default:t="txt"}else switch(e){case"pdf":case"ppt":case"apk":case"torrent":t=e;break;case"xls":case"xlsx":t="excel";break;case"doc":case"docx":t="word";break}return t==="IcBlockFile"?"IcBlockFile":`MIc${II(XO(t))}`},Gw=(e,t)=>t?`${e}.${t}`:e!=null?e:"",zw=e=>new Promise((t,n)=>{const s=new Image;s.setAttribute("crossOrigin","anonymous"),s.onload=()=>{t({width:s.width,height:s.height,size:e.size,url:s.src})},s.onerror=()=>{n(new Error("图片解析失败"))},s.src=URL.createObjectURL(e)}),DS=e=>new Promise((t,n)=>{const s=document.createElement("video");s.preload="metadata",s.onloadedmetadata=()=>{window.URL.revokeObjectURL(s.src),t({width:s.videoWidth,height:s.videoHeight,size:e.size,url:s.src})},s.onerror=()=>{n(new Error("视频解析失败"))},s.src=URL.createObjectURL(e)}),Sx=e=>{const{defaultList:t,type:n,fileType:s,source:a,parentId:o,canSearchWithEmpty:i=!1,getPerPage:l,spaceId:c}=e,u=IS(),d=F.useRef(1),f=F.useRef({search:async(w,k,C)=>{const T=await u({pageNo:w,search:k,perPage:C,type:n,fileType:s,source:a,parentId:o,spaceId:c});return d.current=T.newPageNo,T.resultBlocks},async convert(w){return w.map(k=>({uuid:k.block.uuid,title:de(k.block.data.segments),type:k.block.type,navs:k.navs,data:{icon:k.block.data.icon,ossName:k.block.data.ossName,extName:sn(de(k.block.data.segments)).extName,size:k.block.data.size},coverUrl:k.coverUrl,parentId:k.block.parentId}))},defaultList:t,getPerPage:l,canSearchWithEmpty:i}),{search:h,resultList:p,loading:g,hasMore:_,firstTime:x}=FD(f.current),y=F.useRef(""),{run:b}=QO(w=>{y.current=w,d.current=1,h(1,y.current)},{wait:800}),E=F.useCallback(()=>{const w=d.current+1;h(d.current+1,y.current),d.current=w},[h]);return F.useEffect(()=>{f.current.defaultList=t,h(d.current,y.current)},[i,t,h]),{firstTime:x,resultList:p,loading:g,hasMore:_,loadMore:E,onInputChange:b,keyword:y.current}};var ra=(e=>(e[e.START=1]="START",e[e.RESIZING=2]="RESIZING",e[e.END=3]="END",e))(ra||{}),E2=(e=>(e.leftClick="leftClick",e.rightCLick="rightCLick",e.All="All",e))(E2||{});const ig=(e,t)=>{const{type:n="all",moveSlop:s=1,buttonType:a="leftClick",onResize:o,dispatchEvent:i=!1}=t,l=F.useRef(o);l.current=o;const c=F.useRef(!1),u=F.useRef(!1);F.useEffect(()=>{const d=e.current;if(!d)return;let f=0,h=0,p=0,g=0,_;const x=E=>{if(!l.current)return;switch(a){case"leftClick":{if(E.button!==0)return;break}case"rightCLick":{if(E.button!==2)return;break}case"All":{if(E.button!==0&&E.button!==2)return;break}}i||(E.stopPropagation(),E.preventDefault()),c.current=!0,f=E.clientX,h=E.clientY,_={resizeStatus:1,downX:f,downY:h,moveX:0,moveY:0,deltaX:0,deltaY:0},l.current(_)&&(c.current=!1,_=void 0,p=0,g=0,f=0,h=0)},y=E=>{if(!l.current||!c.current||!_)return;E.stopPropagation();const w=E.clientX-f,k=E.clientY-h,C=w-p,T=k-g;let v=!1;switch(n){case"x":{v=Math.abs(C)>s;break}case"y":{v=Math.abs(T)>s;break}case"all":{v=Math.abs(C)>s||Math.abs(T)>s;break}}v&&(u.current=!0,_.moveX=w,_.moveY=k,_.deltaX=C,_.deltaY=T,_.resizeStatus=2,p=w,g=k,l.current(_))},b=E=>{if(!l.current||!c.current||!_)return;c.current=!1;const w=E.clientX-f,k=E.clientY-h,C=w-p,T=k-g;_.moveX=w,_.moveY=k,_.deltaX=C,_.deltaY=T,_.resizeStatus=3,l.current(_),_=void 0,p=0,g=0,f=0,h=0,u.current&&(E.stopPropagation(),u.current=!1)};return d.addEventListener("mousedown",x,!0),qt.addEventListener("mousemove",y),qt.addEventListener("mouseup",b),()=>{qt.removeEventListener("mouseup",b),qt.removeEventListener("mousemove",y),d.removeEventListener("mousedown",x,!0)}},[a,i,e,s,n])},MT=`virtuoso-${qe()}`,v$=({items:e,renderItem:t,computeItemKey:n,virtuosoRef:s,maxHeight:a="50vh",className:o,defaultHeight:i})=>{const[l,c]=F.useState(i||document.body.clientHeight/2),u=async f=>{if(!f)return;await Za(100);const h=document.querySelector(`#${MT} [data-test-id="virtuoso-item-list"]`);if(h){const p=h.getBoundingClientRect();c(p.height)}},d=f=>{const h=e[f];return h?t(h,f):null};return r.jsx(As,{className:B("overflow-y-auto",o),data:e,scrollerRef:u,id:MT,overscan:100,style:{height:l,maxHeight:a},ref:s,computeItemKey:n,itemContent:d})},SS={},RS=new Set,Oi=(e,t,n)=>{SS[e]=t,n&&RS.add(e)},Xc="h-9 px-2 mx-1.5",Mi="next-modal max-h-[75vh] w-[260px] rounded py-2 overflow-y-auto",Ww=(e="")=>["／","/","、"].includes(e),gd=(e="")=>JO(ZO(e,/\s+/g,"")),N$=(e,t,n,s)=>{if(!e)return t;if(!t)return e;const a=Zf(e,"");return a.splice(n,s!=null?s:0,t),a.join("")},Rx=({text:e,search:t,className:n,ignoreUpperCase:s=!0,containerClassName:a})=>{if(!e)return null;const o=(s?e.toUpperCase():e).indexOf(s?t.toUpperCase():t);if(o===-1)return r.jsx(r.Fragment,{children:e});const i=e.slice(0,o),l=e.slice(o,o+t.length),c=e.slice(o+t.length,e.length);return r.jsxs("span",{className:a,children:[r.jsx("span",{className:n,children:i}),r.jsx("span",{className:B("text-active_color",n),children:l}),r.jsx("span",{className:n,children:c})]})},I$=e=>{const{limitLen:t,text:n,search:s,ignoreUpperCase:a=!0,...o}=e;if(!n)return null;const i=(a?n.toUpperCase():n).indexOf(a?s.toUpperCase():s);if(i===-1)return r.jsx(r.Fragment,{children:n});const l=Math.max(0,i-t/2),c=Math.min(l+t,n.length);return r.jsx(Rx,{text:n.slice(l,c),search:s,ignoreUpperCase:a,...o})},j$=e=>{const t=e.listItem.data;if(!t)return null;const{icon:n,image:s,textColor:a,backgroundColor:o}=t,i=o!==void 0;return r.jsx("div",{...e.attribute,onClick:l=>{e.onItemClick&&e.onItemClick(e.listItem,e.index,l)},className:B(Xc,"rounded cursor-pointer active-bg animate-hover",{"normal-bg":e.selected}),children:r.jsxs(Fe,{className:"flex items-center justify-between h-full",placement:"right",theme:"none",offset:[0,16],popup:t.context,children:[r.jsxs("div",{className:"flex items-center",children:[n&&r.jsx(H,{name:n,size:"middle",className:"mr-2"}),s&&r.jsx("img",{className:"flex-shrink-0 object-fill w-5 h-5 rounded border-grey4 mr-2",src:t.image}),(a||i)&&r.jsx("div",{className:"border border-black_006 rounded-full flex items-center justify-center w-5 h-5 mr-2",style:{background:i?Rn(o):void 0},children:r.jsx("span",{className:"text-t2-bold text-black",style:{color:a?Us(a):void 0},children:"A"})}),r.jsx("div",{className:"flex flex-col",children:r.jsx("span",{className:"text-black text-t2 mr-2",children:t.title})})]}),r.jsx("div",{className:"text-grey3 text-t2 text-ellipsis max-w-[130px]",children:r.jsx(D$,{dataScheme:t})})]})})},D$=F.memo(({dataScheme:e})=>{var l,c,u;const t=lD(),n=Ww((l=t[0])!=null?l:""),s=n?t.slice(1):t,a=eM([...(c=e.keywords)!=null?c:[]],void 0),o=F.useMemo(()=>s?a.find(f=>gd(f).includes(s)&&f&&s?f:null):null,[a,s]),i=`${(u=o!=null?o:a[0])!=null?u:""}`;return r.jsxs(r.Fragment,{children:[n&&!!a.length&&r.jsx("span",{className:"text-active_color",children:"/"}),r.jsx(Rx,{text:i,search:s})]})}),S$=e=>{const t=e.listItem.data;return t?r.jsx("div",{className:B(Xc,"flex items-center text-t2 text-grey3",t.className),children:r.jsxs("div",{className:"flex justify-between items-center w-full",children:[t.titleSuffix?r.jsxs("div",{children:[r.jsx("span",{children:t.title}),t.titleSuffix]}):r.jsx("span",{children:t.title}),t.icon]})}):null},R$=e=>{const t=e.listItem.data;return t?r.jsxs("div",{...e.attribute,className:B("flex items-center px-2 mx-2 h-9 text-t2 text-black rounded animate-hover cursor-pointer justify-between",t.className,{"normal-bg":e.selected}),onClick:n=>e.onItemClick&&e.onItemClick(e.listItem,e.index,n),children:[r.jsx("span",{children:t.title}),t.selected&&t.followTitle&&r.jsx(H,{name:"IcSelectedSpace",size:"middle"}),r.jsx("span",{className:B("text-grey4 text-t2 ml-auto",t==null?void 0:t.textClassName),children:t.desc}),t.selected&&!t.followTitle&&r.jsx(H,{name:"IcSelectedSpace",size:"middle",className:"ml-auto"})]}):null},A$=e=>{const t=e.listItem.data;return t?r.jsx("div",{...e.attribute,onClick:n=>{var s,a;(s=t.onClick)==null||s.call(t,n),(a=e.onItemClick)==null||a.call(e,e.listItem,e.index,n)},className:B(Xc," rounded cursor-pointer active-bg animate-hover",{"normal-bg":e.selected}),children:r.jsxs(Fe,{className:B("flex items-center justify-between h-full"),placement:"right",theme:"none",offset:[0,16],popup:t.context,children:[r.jsxs("div",{className:"flex items-center",children:[t.icon?r.jsx(H,{name:t.icon,size:"xlarge",className:"mr-2"}):t.image&&r.jsx("img",{className:"flex-shrink-0 object-fill w-[26px] h-[26px] rounded border-grey4 mr-2",src:t.image}),r.jsx("div",{className:"flex flex-col",children:r.jsx("span",{className:"text-black text-t2",children:t.title})})]}),t.selected&&r.jsx(H,{name:"IcSelectedSpace",size:"middle"})]})}):null},B$=e=>r.jsx("div",{className:"flex items-center mx-4 my-1",children:r.jsx("div",{className:"w-full h-px bg-grey6"})}),L$=e=>{const{dataScheme:t,isSelected:n,divRef:s}=e,a=Cr(),o=F.useRef(null),[i,l]=F.useState(!1),[c,u]=F.useState(!1);return F.useEffect(()=>{if(!o.current)return;const d=o.current,f=()=>l(!0),h=()=>l(!1);d.addEventListener("mouseenter",f),d.addEventListener("focus",f),d.addEventListener("blur",h);const p=()=>{d.removeEventListener("blur",h),d.removeEventListener("mouseenter",f),d.removeEventListener("focus",f)};return d||p(),p},[]),F.useEffect(()=>{n||l(!1)},[n]),bm(()=>{i?u(i):xs(50).then(()=>{u(i)})},[i],{leading:!0,trailing:!0,wait:50}),r.jsx("div",{children:t.renderSubMenu&&!t.disable?r.jsx(yI,{ref:o,visible:i,delay:[200,0],duration:[150,50],offset:a?[0,0]:t.offset||[0,-8],placement:a?"bottom":"right",theme:"none",interactive:!0,interactiveDebounce:0,arrow:!1,animation:"shift-away",appendTo:()=>document.body,content:c&&t.renderSubMenu(),children:r.jsx("div",{children:e.children})}):e.children})},P$=e=>{var s;const t=F.useRef(),n=e.listItem.data;return n?r.jsx(L$,{dataScheme:n,divRef:t,isSelected:e.selected,children:r.jsx(Fe,{popup:n.tip,placement:"left",children:r.jsxs("div",{...e.attribute,ref:t,onClick:a=>{var o,i;n.disable||((o=e.onItemClick)==null||o.call(e,e.listItem,e.index,a),(i=n.onClick)==null||i.call(n,a))},className:B(Xc,"relative flex items-center w-full justify-between rounded cursor-pointer active-bg animate-hover text-ellipsis",{"normal-bg":e.selected,"opacity-30 cursor-not-allowed":n.disable},n.className),children:[r.jsx("div",{className:"flex min-w-0 items-center",children:n.content?n.content:r.jsxs(r.Fragment,{children:[typeof n.icon=="string"?r.jsx(H,{name:n.icon,size:"middle"}):n.icon,r.jsx("span",{className:B("flex-1 min-w-0 overflow-hidden text-black whitespace-nowrap overflow-ellipsis text-t2",n.icon&&"ml-2"),children:n.title}),n.label]})}),r.jsxs(r.Fragment,{children:[n.rightText&&r.jsx("span",{className:"text-t3 text-grey3 mr-2",children:n.rightText}),n.hasArrow&&((s=n.arrow)!=null?s:r.jsx(H,{name:"IcMenuNext",size:"middle",className:"text-grey4 mr-2"}))]}),n.selected&&r.jsx(H,{name:"IcSelectedSpace",size:"middle"})]})})}):null},qh=(e,t=le)=>{const{blocks:n,comments:s,discussions:a}=t(),o=n[e];if(!o){const i=s[e];if(i)return qh(i.parentId);const l=a[e];return l?qh(l.parentId):void 0}return Xt(o.type)?o.uuid:qh(o.parentId)},Jl={[m.PermissionRole.NONE]:0,[m.PermissionRole.READER]:1,[m.PermissionRole.COMMENTER]:2,[m.PermissionRole.WRITER]:3,[m.PermissionRole.EDITOR]:4},it=e=>ae(t=>hn(e,t),{equalityFn:kn}),hn=(e,t=le())=>{const n=uq(t.cache);if(e!=null&&n.has(e))return n.get(e);const s=O$(e,t);return e!=null&&ND(t.cache,n.set(e,s)),s},O$=(e,t=le())=>{var _,x,y,b;const n=t.user.uuid,{blocks:s}=K,a={shared:!1,illegal:!1,isRestricted:!1,allowDuplicate:!0,allowShowSidebar:!1,password:void 0,permissions:[],role:m.PermissionRole.NONE,roleWithoutPublic:m.PermissionRole.NONE,publicRole:m.PermissionRole.NONE};if(e==null)return a;let o=s[e];if(!o){if(K.discussions[e]!=null){const E=(_=K.discussions[e])==null?void 0:_.parentId,w=E==null?void 0:qh(E);w!=null&&(o=s[w],e=w)}else if(K.comments[e]!=null){const E=(x=K.comments[e])==null?void 0:x.parentId,w=E==null?void 0:K.discussions[E],k=w==null?void 0:w.parentId,C=k==null?void 0:qh(k);C!=null&&(o=s[C],e=C)}if(o==null)return a}if(o.permissions.length){const E=o.permissions.some(w=>w.type===m.PermissionType.ILLEGAL);a.illegal=a.illegal||E}const i=new Set,l=E=>{var C,T;if(i.has(E))return;i.add(E);const w=s[E];if(!w||w.type==="SPACE")return;const k=w.permissions.filter(v=>{var I;return v.type!==m.PermissionType.SPACE||((I=t.spaces[w.spaceId])==null?void 0:I.permissions)});if(k.length){const v=(R,A,L)=>{const P=a.permissions.find(M=>M[R]===A);if(P&&L&&P.role&&Jl[P.role]>Jl[L])return P},I=k.filter(R=>R.type!==m.PermissionType.ILLEGAL&&R.type!==m.PermissionType.RESTRICTED).map(R=>R.type===m.PermissionType.SPACE?v("type",R.type,R.role)||R:R.type===m.PermissionType.GROUP?v("groupId",R.groupId,R.role)||R:R.type===m.PermissionType.USER?v("userId",R.userId,R.role)||R:R.type===m.PermissionType.PUBLIC&&v("type",R.type,R.role)||R),j=a.permissions.filter(R=>R.type===m.PermissionType.ILLEGAL||R.type===m.PermissionType.RESTRICTED?!1:R.type===m.PermissionType.SPACE||R.type===m.PermissionType.PUBLIC?I.every(A=>A.type!==R.type):R.type===m.PermissionType.GROUP?I.every(A=>A.groupId!==R.groupId):I.every(A=>A.userId!==R.userId));a.permissions=[...I,...j];const D=k.find(R=>R.type===m.PermissionType.PUBLIC),S=k.some(R=>R.type===m.PermissionType.RESTRICTED);if(D&&a.shared&&((D.allowDuplicate||hc(D.allowDuplicate))&&(a.allowDuplicate=!0),D.shareShowSidebar&&(a.allowShowSidebar=!0)),D!=null&&D.password&&!a.password&&(a.password=D.password),D&&!a.shared&&(a.shared=!!D,a.allowDuplicate=(C=D.allowDuplicate)!=null?C:!0,a.allowShowSidebar=(T=D.shareShowSidebar)!=null?T:!1,a.password=D.password,e!==E&&(a.parentId=w.uuid,a.title=de(w.data.segments))),S){if(e===E&&(a.isRestricted=!0),w.parentId!==w.spaceId){let R=s[w.parentId];const A=new Set;for(;R&&!Xt(R.type);){const L=R.parentId;if(A.has(L))break;A.add(L),R=s[R.parentId]}if(!R)return;a.parentId=R.uuid,a.title=de(R.data.segments)}return}}l(w.parentId)};l(e);const c=a.permissions.find(E=>E.userId===n),u=a.permissions.find(E=>E.type===m.PermissionType.PUBLIC),{permissionGroups:d}=Tn(),f=a.permissions.filter(E=>{const w=d==null?void 0:d.find(k=>k.id===E.groupId);return w==null?void 0:w.userIds.includes(n)}),h=a.permissions.find(E=>E.type===m.PermissionType.SPACE);h||a.permissions.unshift({type:m.PermissionType.SPACE,role:m.PermissionRole.NONE});const p=[c,...f];c!=null&&c.isGuest||p.push(h),a.roleWithoutPublic=p.reduce((E,w)=>{var C;if(!w)return E;const k=(C=w.role)!=null?C:m.PermissionRole.NONE;return Jl[k]>Jl[E]?k:E},m.PermissionRole.NONE);const g=a.shared&&a.roleWithoutPublic===m.PermissionRole.NONE?m.PermissionRole.READER:a.roleWithoutPublic;return a.role=ht()?(y=u==null?void 0:u.role)!=null?y:m.PermissionRole.READER:g,a.publicRole=(b=u==null?void 0:u.role)!=null?b:m.PermissionRole.NONE,a};function M$(e,t,n){const s=gl(e,["uuid","spaceId","parentId","type",...t]);if(n){const a=gl(e.data,n);return{...s,data:a}}return s}function _e(e,t,n){const s=ae(f=>{var h;return(h=f.blocks[e!=null?e:""])==null?void 0:h.spaceId}),a=ae(f=>{var h;return(h=f.blocks[e!=null?e:""])==null?void 0:h.parentId}),o=ae(f=>{var h;return(h=f.blocks[e!=null?e:""])==null?void 0:h.type}),i={uuid:e,spaceId:s,parentId:a,type:o},l=F.useRef(null),c=F.useRef(null),u={};for(const f of t){if(n&&f==="data")continue;const h=ae(p=>{var g;if(e)return(g=p.blocks[e])==null?void 0:g[f]});u[f]=h}const d={};if(n)for(const f of n){const h=ae(p=>{var g;if(e)return(g=p.blocks[e])==null?void 0:g.data[f]});d[f]=h}if(i.spaceId){let f={...i,...u};return n&&(c.current&&Cn(c.current,d)||(c.current=d),f={...f,data:c.current}),l.current&&Cn(l.current,f)||(l.current=f),l.current}}const Hh=({children:e,className:t,...n})=>r.jsx("span",{className:B("whitespace-nowrap overflow-hidden overflow-ellipsis",t),...n,children:e}),lg=({navs:e=[],className:t,placement:n,untitled:s,showTooltip:a=!0,showAll:o})=>{var l,c,u,d;if(e.length===0)return null;if(o)return r.jsx("div",{className:B("flex text-t4 text-grey3",t),children:e.map((f,h)=>r.jsxs(F.Fragment,{children:[h>0&&r.jsx("span",{children:" / "}),r.jsx(k_,{title:de(f.data.segments),uuid:f.uuid})]},h))});if(e.length<3)return r.jsx("div",{className:B("flex text-t4 text-grey3",t),children:e.map((f,h)=>r.jsxs(F.Fragment,{children:[h>0&&r.jsx("span",{children:" / "}),r.jsx(Hh,{children:r.jsx(k_,{title:de(f.data.segments),uuid:f.uuid})})]},h))});const i=e.slice(1,e.length-1).map(f=>de(f.data.segments)||Ot(f.type)||s).join(" / ");return r.jsxs("div",{className:B("flex text-t4 text-grey3",t),children:[r.jsx(Hh,{children:r.jsx(k_,{title:de((l=Sa(e))==null?void 0:l.data.segments),uuid:(c=Sa(e))==null?void 0:c.uuid})}),a?r.jsx(Fe,{className:"flex-shrink-0",popup:i,placement:n,children:r.jsx("span",{children:" / ... / "})}):r.jsx("span",{children:" / ... / "}),r.jsx(Hh,{children:r.jsx(k_,{title:de((u=pn(e))==null?void 0:u.data.segments),uuid:(d=pn(e))==null?void 0:d.uuid,untitled:s})})]})},k_=({uuid:e="",title:t,untitled:n})=>{const s=_e(e,["data"]),{illegal:a}=it(e);return r.jsx("div",{children:a?rs:t||Ot(s==null?void 0:s.type)||n})},U$=e=>{const t=e.listItem.data;if(!t)return null;const n=t.navs&&t.navs.length>0;return r.jsxs("div",{...e.attribute,onClick:s=>{e.onItemClick&&e.onItemClick(e.listItem,e.index,s)},className:B(Xc,"flex flex-col justify-center rounded cursor-pointer active-bg animate-hover",n?"h-[58px]":"h-10",{"normal-bg":e.selected}),children:[r.jsxs("div",{className:"flex flex-row items-center",children:[r.jsx(H,{name:t.iconName,size:"middle"}),r.jsx("span",{className:"ml-2 text-black text-t2 text-ellipsis",children:t.title})]}),r.jsx("div",{className:"flex flex-col ml-7",children:t.navs&&t.navs.length>0&&r.jsx(lg,{navs:t.navs})})]})},Ax=e=>{var o;if(!e)return null;const{type:t,uuid:n,data:s,backgroundColor:a}=e;return{backgroundColor:a,type:t,uuid:n,data:s,title:de((o=e.data.segments)!=null?o:[])||Ot(t),parentId:e.parentId}};var Oe=(e=>(e[e.DELETE=1]="DELETE",e[e.COPY=2]="COPY",e[e.RENAME=3]="RENAME",e[e.MOVETO=4]="MOVETO",e[e.TURN_INTO=5]="TURN_INTO",e[e.CREATE=6]="CREATE",e[e.COLOR=7]="COLOR",e[e.TURN_TO_PAGE=8]="TURN_TO_PAGE",e[e.TURN_TO_EMBED=9]="TURN_TO_EMBED",e[e.TEMPLATE=10]="TEMPLATE",e[e.TABLE_CONVERT=11]="TABLE_CONVERT",e[e.COPY_MOVE=12]="COPY_MOVE",e[e.CUT=13]="CUT",e[e.COPY_CLIPBOARD=14]="COPY_CLIPBOARD",e[e.OPEN_RIGHT_PAGE=15]="OPEN_RIGHT_PAGE",e[e.AI_EDITOR=16]="AI_EDITOR",e))(Oe||{}),Dr=(e=>(e.DATE="date",e.PEOPLE="people",e.LINK_PAGE="link_page",e.EQUATION="equation",e.EMOJI="emoji",e.PAGE="page",e))(Dr||{}),al=(e=>(e.aiAssistantWithEmptyDoc="AI 辅助",e.aiAssistantWithNotEmptyDoc="AI 辅助",e.basicBlock="基础块",e.media="媒体",e.embed="嵌入内容",e.inlineElement="行内元素",e.layout="布局",e.turninto="转换为",e.action="快捷操作",e.lastUsedColor="上次使用颜色",e.color="文字颜色",e.colorBackground="背景颜色",e.database="多维表",e.advanced="高级块",e))(al||{});const AS=Vp(al,e=>({pinyin:yl(e),initials:sg(e)})),BS=[{title:"圆点",value:"disc"},{title:"圆圈",value:"circle"},{title:"方块",value:"square"}],LS=[{title:"数字",value:"numbers"},{title:"字母",value:"letters"},{title:"罗马",value:"roman"}],A0e=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.HEADER,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.EQUATION,m.BlockType.PAGE,m.BlockType.CODE],Kw=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.HEADER,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.EQUATION,m.BlockType.PAGE,m.BlockType.CODE,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE,m.BlockType.FILE],Yw=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.HEADER,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.EQUATION,m.BlockType.PAGE,m.BlockType.CODE,m.BlockType.MIND_MAPPING],Xw=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.EQUATION,m.BlockType.PAGE,m.BlockType.CODE],V$=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.HEADER,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.FOLD_LIST,m.BlockType.QUOTE,m.BlockType.MARK],Bx="last_selected_code_language",Om="Plain Text",q$=Ai((e,t)=>e,(e,t)=>t,(e,t)=>ji(t,e),{memoizeOptions:{maxSize:100}}),Lx=()=>{const e=t=>q$(le().blocks,t);return F.useCallback(e,[])},UT=e=>{let t=K.blocks[e];const n=[];for(;t&&!Xt(t==null?void 0:t.type);)n.push(t),t=K.blocks[t.parentId];return n},ji=(e,t=le().blocks,n)=>{const s=new Set;let a=t[e];const o=new Set;for(;a&&!o.has(a.uuid);){if(o.add(a.uuid),s.add(a.uuid),n&&a.uuid===n)return s;a=t[a.parentId]}return s},PS=Ai((e,t)=>e.blocks,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{const s=new Set,a=o=>{var i,l,c;n.includes((l=(i=e[o])==null?void 0:i.type)!=null?l:0)||(c=e[o])==null||c.subNodes.forEach(u=>{s.add(u),a(u)})};return a(t),s},{memoizeOptions:{maxSize:100}});Ai((e,t)=>e.blocks,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{const s=new Set,a=o=>{var i,l,c;n.includes((l=(i=e[o])==null?void 0:i.type)!=null?l:0)&&((c=e[o])==null||c.subNodes.forEach(u=>{s.add(u),a(u)}))};return a(t),s},{memoizeOptions:{maxSize:100}});const Qw=()=>{const e=(t,n=[])=>PS(le(),t,n);return F.useCallback(e,[])};var go=(e=>(e.SPACE="aside-space",e.FAVORITE="aside-favorite",e.SHARE="aside-share",e.PRIVATE="aside-private",e.BOTTOM="aside-bottom",e))(go||{}),Ou=(e=>(e.MIDDLE="main-panel-middle",e.LEFT="main-panel-left",e.RIGHT="main-panel-right",e.BOTTOM="main-panel-bottom",e))(Ou||{}),Zo=(e=>(e.MIDDLE="right-panel-middle",e.LEFT="right-panel-left",e.RIGHT="right-panel-right",e.BOTTOM="right-panel-bottom",e))(Zo||{}),Jw=(e=>(e.ALL="drive-all",e))(Jw||{});const Do=No(()=>{}),OS=()=>Do.getState(),W1=()=>{Do.setState(void 0)},H$=e=>{Do.setState(e)},$$=()=>Do(e=>e,rn),MS=()=>Do(e=>!!e),G$=e=>Do(t=>{if((t==null?void 0:t.cursorArea)===Jw.ALL)return e===(t==null?void 0:t.dropId)}),B0e=()=>Do(e=>{if(e&&e.cursorArea===go.BOTTOM)return!0}),z$=e=>Do(t=>{if((t==null?void 0:t.dropId)===e)return t.position},rn),L0e=()=>Do(e=>e==null?void 0:e.cursorArea,rn),Px=()=>{const e=Wc(),t=MS(),n=rx(),s=Dd();return e||t||n||s},US="toc-container",w2="aside-private",VS="aside-space",W$="aside-favorite",K$="aside-share",cg="hoverMenu",Y$="hoverMenuContainer",P0e="recordHoverMenu",Ud="drive",O0e="TOC_PRIVATE",K1=e=>{var t;return(t=document.getElementById(e))==null?void 0:t.getBoundingClientRect()},C_=(e,t)=>{const n=K1(t);return n&&e>=n.top&&e<=n.bottom},X$=e=>{var t,n;return e>=0&&e<((n=(t=K1(US))==null?void 0:t.right)!=null?n:-1)},Q$=e=>e===go.FAVORITE||e===go.SPACE||e===go.SHARE||e===go.PRIVATE,J$=e=>Q$(e)||e===go.BOTTOM,Z$=e=>e===Zo.BOTTOM||e===Zo.LEFT||e===Zo.MIDDLE||e===Zo.RIGHT,M0e=e=>e===Ou.LEFT||e===Ou.RIGHT||e===Zo.LEFT||e===Zo.RIGHT,eG=e=>{var n,s;const t=(s=(n=document.querySelector(".right-panel"))==null?void 0:n.getBoundingClientRect().left)!=null?s:0;return t>0&&e>=t},VT=e=>`${e?"right":"main"}-panel`,U0e=(e,t,n)=>{var a,o,i;const s=n?Zo.MIDDLE:Ou.MIDDLE;if(X$(e)){const l=K1(w2);if(l&&t>l.bottom)return go.BOTTOM;if(C_(t,W$))return go.FAVORITE;if(C_(t,VS))return go.SPACE;if(C_(t,K$))return go.SHARE;if(C_(t,w2))return go.PRIVATE}else{if(K1(Ud))return Jw.ALL;const c=document.querySelector(`.${VT(n)} .page-footer`),u=c==null?void 0:c.getBoundingClientRect();if(u&&t>u.top)return n?Zo.BOTTOM:Ou.BOTTOM;const d=(a=document.querySelector(`.${VT(n)} .block-content`))==null?void 0:a.firstElementChild,f=(o=d==null?void 0:d.getBoundingClientRect().left)!=null?o:0,h=(i=d==null?void 0:d.getBoundingClientRect().right)!=null?i:0,p=200;if(e<f)return e<f-p?s:n?Zo.LEFT:Ou.LEFT;if(e>h)return e>h+p?s:n?Zo.RIGHT:Ou.RIGHT}return s},V0e=e=>{var n;const t=((n=OS())==null?void 0:n.tocInfo)||{};H$(e?{...e,tocInfo:{...t,...e.tocInfo}}:{})},tG=(e,t)=>{var n;return!t||e===t||!!((n=K.blocks[e])!=null&&n.subNodes.some(s=>tG(s,t)))},qS=e=>Zw(e,document.body),Zw=(e,t)=>{const n={left:0,top:0};for(;e!==t&&e;)n.left+=e.offsetLeft||0,n.top+=e.offsetTop||0,e=e.offsetParent;return n},jn=(e,t)=>t?document.querySelector(`.right-panel ${e}`):document.querySelector(`.main-panel ${e}`),ug=(e,t)=>t?document.querySelectorAll(`.right-panel ${e}`):document.querySelectorAll(`.main-panel ${e}`),ka=e=>{var t;(t=document.activeElement)==null||t.blur(),e&&(window.getSelection().removeAllRanges(),document.dispatchEvent(new Event("_clearTextSelection")))},dg=e=>{if(!e)return;const t=document.createElement("a");t.setAttribute("target","_blank"),t.setAttribute("href",e),t.click()},nG=e=>e?e.type===m.BlockType.CODE:!1,fg=e=>{if(!e)return!1;switch(e.type){case m.BlockType.DIVIDER:return!1;case m.BlockType.REFERENCE:return!1;case m.BlockType.PAGE:return!1;case m.BlockType.SYNC_REFERENCE:return!1;case m.BlockType.SYNC_CONTAINER:return!1;case m.BlockType.FOLDER:return!1;default:return!0}},sG=(e,t)=>e===m.BlockType.PAGE?t?"MIcPageBlank":"MIcPage":e===m.BlockType.FOLDER?t?"MIcFolderBlank":"MIcFolder":e===m.BlockType.FILE?"IcBlockFile":e===m.BlockType.COLLECTION_VIEW_PAGE||e===m.BlockType.COLLECTION_VIEW||e===m.BlockType.REFERENCE_COLLECTION||e===m.BlockType.REFERENCE_COLLECTION_PAGE?"IcTableNew":e===m.BlockType.MIND_MAPPING||e===m.BlockType.MIND_MAPPING_PAGE?"MIcInsertMindMap":"",Vd=e=>{var n;const t=K.blocks[e];if(ki(t)&&t){const s=(n=t.data.ref)==null?void 0:n.uuid;if(s){const a=K.blocks[s];if(a)return a}}},dp=e=>{var c;const{ancestorId:t,findTypes:n,filterTypes:s,filterIds:a}=e,{blocks:o}=le(),i=[];let l=(c=o[t])==null?void 0:c.subNodes;return a&&l&&(l=l.filter(u=>a.indexOf(u)===-1)),n&&l&&(l=l.filter(u=>{const d=o[u];return d&&n.includes(d.type)})),s&&l&&(l=l.filter(u=>{const d=o[u];return d&&!s.includes(d.type)})),l==null||l.forEach(u=>{const d=Ax(o[u]);d&&i.push(d)}),i},rG=e=>{var t;return localStorage.getItem(`viewId:${e.uuid}`)||((t=e.views)==null?void 0:t[0])},aG=(e,t)=>{const n=new Set;let s=e[t];for(;s;){const a=pn(s.subNodes);a?(n.add(a),s=e[a]):s=void 0}return n},cr=e=>{if(e===Et.freePersonal)return"个人版";if(e===Et.personal)return"个人专业版";if(e===Et.freeTeam)return"小组试用版";if(e===Et.smallTeam)return"小组版";if(e===Et.team)return"团队版"},oG=e=>{var a;const t=(a=K.blocks[e])==null?void 0:a.parentId;if(!t)return;const n=K.blocks[t];if(!n)return;let s;for(const o of n.subNodes){if(o===e)break;s=o}if(s)return K.blocks[s]},iG=e=>e.filter(t=>!lG(e,t)),lG=(e,t)=>{var s,a,o,i;let n=K.blocks[(a=(s=K.blocks[t.blockId])==null?void 0:s.parentId)!=null?a:""];for(;n;){if(e.findIndex(l=>l.blockId===(n==null?void 0:n.uuid))>-1)return!0;n=K.blocks[n.parentId]}for(const l of e){let c=K.blocks[l.blockId];if((c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION){const u=rG(c);if(c=K.blocks[(i=(o=c.data.ref)==null?void 0:o.uuid)!=null?i:""],!c)continue;if(PS(K,c.uuid,[]).has(t.blockId)&&u===t.viewId)return!0}}return!1},q0e=e=>{const t=[],n=ug(`.block-content [data-block-id]:not(#${cg})`,e),{blocks:s}=K;for(const a of n){const{blockId:o,viewId:i,syncId:l}=a.dataset;if(!o)return;const c=s[o];!c||!s[c.parentId]||t.push({blockId:o,viewId:i,syncId:l})}return t},_d=e=>{var a;const t=[],n=ug(".block-content [data-block-id] [data-editor]",e),{blocks:s}=K;for(const o of n){const i=o.closest("[data-block-id]");if(!i)continue;const{editor:l}=o.dataset,{blockId:c,viewId:u,syncId:d}=i.dataset;if(!c||Xt((a=K.blocks[c])==null?void 0:a.type))continue;const f=s[c];!f||!s[f.parentId]||t.push({blockId:c,viewId:u,syncId:d,editorKey:l})}return t},cG=(e,t)=>{var a;let n;e===m.BlockType.ORDER_LIST?n=LS.map(o=>o.value):n=BS.map(o=>o.value);const s=(n.indexOf(t)+1)%n.length;return(a=n[s])!=null?a:"numbers"},uG=(e,t,n)=>{const s=t[e];if(!s)return;const a=t[s.parentId];if(!a)return;let o=a.subNodes.indexOf(e);if(o<=0)return{firstBlock:s,firstBlockIndex:0};let i;for(;o>0;){o--;const l=a.subNodes[o];if(!l)break;const c=t[l];if(c){if(c.type!==n)break;i=c}}if(i)return{firstBlock:i,firstBlockIndex:a.subNodes.indexOf(i.uuid)}},dG=(e,t,n)=>{var l,c;const s=t[e];if(!s)return;const a=t[s.parentId];if(!a)return;let o=a.subNodes.indexOf(e);if(o<=0)return{firstBlock:s,firstBlockIndex:0};let i;for(;o>0;){o--;const u=a.subNodes[o];if(!u)break;const d=t[u];if(d){if(d.type!==n)break;if(n===m.BlockType.ORDER_LIST&&((l=d.data.format)!=null&&l.orderListFormat)){i=d;break}else if(n===m.BlockType.LIST&&((c=d.data.format)!=null&&c.listFormat)){i=d;break}}}if(i)return{firstBlock:i,firstBlockIndex:a.subNodes.indexOf(i.uuid)}},mg=(e,t,n)=>{var f,h,p,g,_,x;const s=t[e];if(!s)return;let a=((f=s.data.format)==null?void 0:f.listStartIndex)||1;const o=n===m.BlockType.ORDER_LIST?(h=s.data.format)==null?void 0:h.orderListFormat:(p=s.data.format)==null?void 0:p.listFormat,i=n===m.BlockType.ORDER_LIST?"numbers":"disc",l=t[s.parentId];if(!l)return;const c=uG(e,t,n),u=dG(e,t,n);if(c){const{firstBlock:y,firstBlockIndex:b}=c;a=l.subNodes.indexOf(e)-b+1,(g=y.data.format)!=null&&g.listStartIndex&&(a=a+y.data.format.listStartIndex-1)}if(o)return{format:o,listNo:a,defaultFormat:i};let d;if(n===m.BlockType.ORDER_LIST?d=(_=u==null?void 0:u.firstBlock.data.format)==null?void 0:_.orderListFormat:d=(x=u==null?void 0:u.firstBlock.data.format)==null?void 0:x.listFormat,d)return{format:d,listNo:a,defaultFormat:i};if(l.type===n){const y=mg(s.parentId,t,n);if(y)return y.format?{format:y.format,listNo:a,defaultFormat:i}:{format:o,listNo:a,defaultFormat:cG(n,y.defaultFormat)}}return{format:o,listNo:a,defaultFormat:i}},fG=(e,t,n=le().blocks)=>{let s=n[e];if(!s)return;s=n[s.parentId];let a;for(;s;){if(t.includes(s.type)){a=s;break}s=n[s.parentId]}return a},mG=(e,t,n=le().blocks)=>!!fG(e,t,n),HS=(e,t=le().blocks)=>{const n=t[e];if(!n)return;const s=t[n.parentId];if(!s)return;const a=s.subNodes.indexOf(e);if(!(a<=0))return s.subNodes[a-1]},H0e=(e,t=le().blocks)=>{const n=t[e];if(!n)return;const s=t[n.parentId];if(!s)return;const a=s.subNodes.indexOf(e);return s.subNodes[a+1]},hG=e=>{ee(nt.update({selectedBlocks:[{blockId:e}]})),document.execCommand("copy")},qT=(e,t)=>{const n=[];return e.forEach(o=>{var i;if(((i=K.blocks[o.blockId])==null?void 0:i.type)===m.BlockType.SYNC_CONTAINER||t){const l=document.querySelector(`[data-block-id="${o.blockId}"]`);l instanceof HTMLElement&&l.dataset.syncCount&&n.push(parseFloat(l.dataset.syncCount))}}),n.length===0||!n.some(o=>o>0)?void 0:{onlyOne:n.reduce((o,i)=>o+i,0)===1}},$S=e=>{const t=K.blocks[e];return t?t.type===m.BlockType.SYNC_CONTAINER||t.type===m.BlockType.SYNC_REFERENCE?!0:Xt(t.type)?!1:t.subNodes.some(n=>$S(n)):!1},pG=e=>e===m.BlockType.SYNC_CONTAINER||e===m.BlockType.SYNC_REFERENCE,GS=e=>{const t=e.slice(1);if(!Q0(t))return;const n=K.blocks[t];if(n&&!Xt(n.type))return t},Y1=e=>{if(!e)return 0;const t=n=>{switch(n.type){case m.TextType.DATE:case m.TextType.DATETIME:return 0;default:return de([n]).length}};return e.reduce((n,s)=>n+t(s),0)},gG=(e,t=K.blocks)=>{const n=t[e];if((n==null?void 0:n.type)!==m.BlockType.TABLE)return 0;const s=a=>{var l,c;const o=t[a];return(o==null?void 0:o.type)!==m.BlockType.TABLE_ROW?0:((c=(l=n.data.format)==null?void 0:l.tableBlockColumnOrder)!=null?c:[]).reduce((u,d)=>{var h;const f=(h=o.data.collectionProperties)==null?void 0:h[d];return u+Y1(f)},0)};return n.subNodes.reduce((a,o)=>a+s(o),0)},k2=(e,t=K.blocks,n={})=>{var o,i;if(!e)return 0;const s=t[e];if(!s||n[e])return 0;if([m.BlockType.PAGE,m.BlockType.FOLDER,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW].includes(s.type))return de(s.data.segments).length+de(s.data.description).length;n[e]=!0;let a=0;return yD(s.type)&&(a+=Y1(s.data.segments)),nm(s)&&(a+=Y1(s.data.caption)),s.subNodes.length>0&&(a+=s.subNodes.reduce((l,c)=>l+k2(c,t,n),0)),a>1e5||((ki(s)||s.type===m.BlockType.SYNC_REFERENCE)&&(a+=k2((i=(o=s.data.ref)==null?void 0:o.uuid)!=null?i:"",t,n)),s.type===m.BlockType.TABLE&&(a+=gG(s.uuid))),a},zS=(e,t,n,s=le().blocks)=>{const a=[],o=s[e];return(o==null?void 0:o.type)!==void 0&&t.includes(o==null?void 0:o.type)&&(!n||n!=null&&n(o))&&a.push(e),o==null||o.subNodes.forEach(i=>{var l;if(!Xt((l=s[i])==null?void 0:l.type)){const c=zS(i,t,n);a.push(...c)}}),a},$0e=e=>{let t=e;for(;t;){const n=K.blocks[t];if(!n)return;const{type:s}=n;if(s===m.BlockType.SYNC_CONTAINER||s===m.BlockType.SYNC_REFERENCE)return!0;t=n.parentId}return!1},Dl=(e,t)=>{const{blocks:n}=le();return[...ji(e,n,t)].some(o=>{var i;return((i=n[o])==null?void 0:i.type)===m.BlockType.COLUMN_LIST})},_G=e=>e.filter(n=>{var l;const s=K.blocks[n.blockId],a=(s==null?void 0:s.type)===m.BlockType.REFERENCE&&s.data.display==="image",o=(s==null?void 0:s.type)===m.BlockType.EXTERNAL_FILE&&s.data.display==="image";return a||o||(s==null?void 0:s.type)===m.BlockType.FILE&&s.data.display==="image"||[m.BlockType.TEXTAREA,m.BlockType.HEADER].includes((l=s==null?void 0:s.type)!=null?l:0)}).map(n=>n.blockId),hg=()=>localStorage.getItem(Bx),WS=(e,t=le().blocks)=>{var s;const n=t[e];if(n){switch(n.type){case m.BlockType.TODO:case m.BlockType.MARK:case m.BlockType.HEADER:case m.BlockType.TEXTAREA:case m.BlockType.LIST:case m.BlockType.ORDER_LIST:case m.BlockType.FOLD_LIST:case m.BlockType.QUOTE:{if(de(n.data.segments).trim())return e;break}}for(const a of n.subNodes){if(Xt((s=t[a])==null?void 0:s.type))continue;const o=WS(a);if(o)return o}}},as=e=>{var i;const{uuid:t,size:n,...s}=e,a=ae(l=>{var u;const c=l.blocks[(u=e.uuid)!=null?u:""];if(c)return{type:c.type,hasContent:c.subNodes.length>0}},{equalityFn:Cn});if(!a||!e.uuid)return r.jsx(H,{name:"MIcPage",size:n,...s});let o;if(a.type===m.BlockType.FILE){const{extName:l}=up((i=K.blocks[e.uuid])==null?void 0:i.data.segments);o=pa(l)}return o?r.jsx(H,{name:o,size:n,...s}):(o=sG(a.type,!a.hasContent),r.jsx(H,{name:o,size:n,...s}))},Di=(e,t)=>{let n;return Is.unstable_batchedUpdates(()=>{const{state:s,noThrottle:a}=t||{};ee(mx({state:s})),n=e(),ee(xw()),ee(a?Er():eg())}),n},ke=()=>F.useCallback(Di,[]),pg=()=>{const e=(t,n=!1,s)=>{let a;return Is.unstable_batchedUpdates(async()=>{ee(mx({state:s})),a=await t(),ee(xw()),ee(n?Er():eg())}),a};return F.useCallback(e,[])};var Xe=(e=>(e.AD_ERROR="AD_ERROR",e.MAXIMUM_CAPACITY_DIALOG="MAXIMUM_CAPACITY_DIALOG",e.AI_EDITOR="AI_EDITOR",e.CHECK_SPACE="CHECK_SPACE",e.SERVICE_CENTER="SERVICE_CENTER",e.TRASH="TRASH",e.SETTING="SETTING",e.DRIVE_FILE_CONTEXTMENU="DRIVE_FILE_CONTEXTMENU",e.FILE_PREVIEW="FILE_PREVIEW",e.PAGE_HEADER_MENU_LIST="PAGE_HEADER_MENU_LIST",e.BITABLE_PROPERTY_WIDGET="BITABLE_PROPERTY_WIDGET",e.DRIVE_UPLOAD_MENU="DRIVE_UPLOAD_MENU",e.TEMPLATE_PREVIEW="TEMPLATE_PREVIEW",e.TEMPLATE_CENTER="TEMPLATE_CENTER",e.MESSAGE_NOTIFICATION="MESSAGE_NOTIFICATION",e.HEADER_COVER_IMAGE="HEADER_COVER_IMAGE",e.COMMENTS="COMMENTS_AT_CARET",e.SELECT_UPDATE_PLAN="SELECT_UPDATE_PLAN",e.SINGLE_CAPACITY="SINGLE_CAPACITY",e.QUICK_SEARCH="QUICK_SEARCH",e.TABLE_HEADER_MENU_LIST="TABLE_HEADER_MENU_LIST",e.PREVIEW_FORM="PREVIEW_FORM",e.BITABLE_OPTION_MENU="BITABLE_OPTION_MENU",e.BITABLE_TEMPLATE_RECORDS="BITABLE_TEMPLATE_RECORDS",e.INLINE_PANEL="INLINE_PANEL",e.CLEAR_TEMPLATE="CLEAR_TEMPLATE",e.DOC_HISTORY_MODAL_ID="DOC_HISTORY_MODAL_ID",e.CONTEXT_DISCUSSIONS="CONTEXT_DISCUSSIONS",e.HIGH_PERFORMANCE_MODE="HIGH_PERFORMANCE_MODE",e.SYNC_UP_FAULT="SYNC_UP_FAULT",e.ANNIVERSARY="ANNIVERSARY",e.SYNC_BLACK_LINK="SYNC_BLACK_LINK",e.UPGRADE_CAPACITY="UPGRADE_CAPACITY",e.CAPACITY_ORDER_LIST_ID="CAPACITY_ORDER_LIST_ID",e))(Xe||{}),Fc=(e=>(e.UPLOAD_ICON="UPLOAD_ICON",e.NO_PERMISSION_SYNC_WARNING_ID="NO_PERMISSION_SYNC_WARNING_ID",e))(Fc||{});const fp=()=>({updatedBy:K.user.uuid,updatedAt:Date.now()}),Ox=(e,t=!1,n)=>{var d;const s=n?n.getState.bind(n):le,a=n?n.dispatch.bind(n):ee,{blocks:o}=s(),i=o[e];if(!i||t)return;const c=ls(i.uuid),u=Wr((d=o[c!=null?c:""])==null?void 0:d.type);if(!Xt(i.type)||u){const f=o[c!=null?c:""];f&&hn(f.uuid).role!==m.PermissionRole.READER&&a(mn({uuid:f.uuid,patch:fp()}))}a(mn({uuid:e,patch:fp()}))},xd=(e,t)=>{Ox(e),ee(fx({uuid:e,permission:t}))},ga=(e,t)=>{Ox(e),ee(dx({uuid:e,permission:t}))},Uf=(e,t)=>{const n={role:t.role,type:t.type};t.type===m.PermissionType.GROUP&&(n.groupId=t.groupId),t.type===m.PermissionType.USER&&(t.isGuest&&(n.isGuest=t.isGuest),n.userId=t.userId),t.role===m.PermissionRole.NONE?xd(e,n):ga(e,n)},o1=(e,t)=>e.type===m.PermissionType.SPACE&&e.type===t.type||e.type===m.PermissionType.GROUP&&e.groupId===t.groupId||e.type===m.PermissionType.USER&&e.userId===t.userId,KS=e=>{const t=_e(e,["data"],["segments"]),n=Md(t==null?void 0:t.spaceId),s=`
${id}${de(t==null?void 0:t.data.segments)}`,a=`${Sn()}${n}/share/${e}`;return{url:a,text:s,textAndUrl:`${a}${s}`}},YS=e=>e.filter(t=>t.type===m.PermissionType.SPACE||t.type===m.PermissionType.USER||t.type===m.PermissionType.GROUP),ek=e=>({spacePermission:e.find(t=>t.type===m.PermissionType.SPACE),groupPermissions:e.filter(t=>t.type===m.PermissionType.GROUP),userPermissions:e.filter(t=>t.type===m.PermissionType.USER)}),XS=e=>{var s;const t=_e(e,["permissions"]),{permissions:n}=it((s=t==null?void 0:t.parentId)!=null?s:"");return F.useCallback(()=>{if(!t)return;YS(t.permissions).filter(o=>n.some(i=>!!(o1(o,i)&&i.role&&o.role&&Jl[o.role]<Jl[i.role]))).forEach(o=>Uf(e,{...o,role:m.PermissionRole.NONE})),xd(e,{type:m.PermissionType.RESTRICTED}),xd(e,{type:m.PermissionType.PUBLIC})},[t,n,e])},xG=e=>{const{shared:t,allowDuplicate:n,allowShowSidebar:s,isRestricted:a,parentId:o,password:i,permissions:l}=it(e);return F.useCallback(()=>{var u;const c=l.find(d=>d.type===m.PermissionType.PUBLIC);c&&t&&(a||!o)&&(ce.event("allow_copy",{is_open:!n}),ga(e,{type:m.PermissionType.PUBLIC,role:(u=c.role)!=null?u:m.PermissionRole.READER,allowDuplicate:!n,password:i,shareShowSidebar:s}),ee(Er()))},[n,s,a,o,i,l,t,e])},FG=e=>{const{shared:t,allowDuplicate:n,allowShowSidebar:s,isRestricted:a,parentId:o,permissions:i,password:l}=it(e);return F.useCallback(()=>{var u;const c=i.find(d=>d.type===m.PermissionType.PUBLIC);c&&t&&(a||!o)&&(ee(mx({})),ga(e,{type:m.PermissionType.PUBLIC,role:(u=c.role)!=null?u:m.PermissionRole.READER,shareShowSidebar:!s,password:l,allowDuplicate:n}),ee(Er()))},[n,s,a,o,l,i,t,e])},yG=e=>{const{shared:t,allowDuplicate:n,allowShowSidebar:s,isRestricted:a,parentId:o,password:i,permissions:l}=it(e);return F.useCallback(c=>{l.find(d=>d.type===m.PermissionType.PUBLIC)&&t&&(a||!o)&&(ga(e,{type:m.PermissionType.PUBLIC,role:c,password:i,allowDuplicate:n,shareShowSidebar:s}),ee(Er()))},[n,s,a,o,i,l,t,e])},gg=e=>{var a;const t=_e(e,[]),{role:n}=it((a=t==null?void 0:t.parentId)!=null?a:""),s=Ui();return t?t.parentId===t.spaceId?!s:n===m.PermissionRole.EDITOR||n===m.PermissionRole.WRITER:!1},Mx=e=>{const{role:t,isRestricted:n}=it(e),s=gg(e),a=ae(({blocks:i})=>{var l,c;return(c=(l=i[e])==null?void 0:l.isTemplate)!=null?c:!1}),o=n?t===m.PermissionRole.WRITER||t===m.PermissionRole.EDITOR:t===m.PermissionRole.EDITOR;return s&&o&&!a},Ui=()=>{const e=Ft();return Ux(e)},Ux=e=>!(e!=null&&e.permissions),G0e=e=>({none:e===m.PermissionRole.NONE,commenter:e===m.PermissionRole.COMMENTER,reader:e===m.PermissionRole.READER,editor:e===m.PermissionRole.EDITOR||e===m.PermissionRole.WRITER,writer:e===m.PermissionRole.WRITER}),qd=()=>{const e=Ft();return F.useCallback(t=>{var s;const n=(s=e.permissions)==null?void 0:s.find(a=>a.userId===t);return{reader:(n==null?void 0:n.role)==="reader",writer:(n==null?void 0:n.role)==="writer",editor:(n==null?void 0:n.role)==="editor"}},[e.permissions])},bG=e=>{var s;const n=(s=Tn().permissions)==null?void 0:s.find(a=>a.userId===e);return{reader:(n==null?void 0:n.role)==="reader",writer:(n==null?void 0:n.role)==="writer",editor:(n==null?void 0:n.role)==="editor"}},tk=e=>{var s;const{user:t,spaceViews:n}=le();return(s=n[t.currentSpaceViewId])==null?void 0:s.favoritePages.includes(e)},nk=e=>ae(t=>{var n;return(n=t.spaceViews[t.user.currentSpaceViewId])==null?void 0:n.favoritePages.includes(e)}),QS=()=>F.useCallback(()=>{ee(Ci.clear()),T1.remove("next_auth"),localStorage.clear(),Ja.removeItem(fl)},[]),Qt=()=>ae(e=>e.user),Vx=()=>K.user,JS=()=>ae(e=>Object.values(e.users).find(t=>t.uuid===e.user.uuid)),EG=()=>F.useCallback(()=>{const{user:e}=le();if(e.uuid){if(!pt.print&&(!e.nickname||!e.occupation))return ma(Rt.login)?!1:(Bs(Rt.login),!0);if(e.spaceViews.length===0)return ma(Rt.create)?!1:(Bs(Rt.create),!0)}else return ma(Rt.login)?!1:(Bs(Rt.login,!0),!0);return pt.from?(cp(pt.from),!0):!1},[]),qx=()=>{const e=QS();return F.useCallback(async()=>{const{user:t}=le();await Ce.infra.logoutUser(t.uuid),e(),Bs(Rt.login)},[e])},Hx=()=>F.useCallback(async(e,t)=>{var s,a;ee(Ci.update(e));const{user:n}=le();if(n.uuid&&Nn(cd,n.uuid),t){const{spaceViews:o,...i}=e;return await Ce.infra.updateUser(n.uuid,{...i,setting:{...(s=n.setting)!=null?s:{},...(a=i.setting)!=null?a:{}}})}},[]),X1=No(()=>({})),$h=(e,t)=>{const n=X1.getState();n[e]||(n[e]={spacePlans:[]}),X1.setState(s=>(s[e]||(s[e]={spacePlans:[]}),s[e]=sd(s[e],t),{...s}))},Qc=()=>ZS(),ZS=e=>{const t=Ft(),n=e!=null?e:t.uuid;return X1(()=>e6(n),rn)},e6=(e=Ut())=>{const t=X1.getState()[e];return wG(e,t)},wG=(e,t)=>{var a;const n=Lm(e),s=(a=t==null?void 0:t.spacePlans)==null?void 0:a.find(o=>o.planType===n.planType);return{...t,currentSpacePlanConfig:s}},kG=async e=>{const t=await Ce.infra.getSpacePlans(),n=await Ce.infra.getUserPlanConfig(Vx().uuid),s=t.map(a=>{const o=n[a.planType];return o&&Object.assign(a,o),a});return $h(e,{spacePlans:s}),s},C2=async()=>{const e=Tn();if(Ux(e))return;const n=await Ce.infra.getSpacePlan(e.uuid);return $h(e.uuid,{spacePlan:n}),n},HT=async e=>{const t=Tn(),n=Vx(),s=bG(n.uuid).editor;if(e){$h(t.uuid,{spaceShareInfo:{inviterId:e.inviterId,createdAt:e.createdAt,expirationAt:e.expirationAt}});return}if(s){const a=await Ce.infra.getSpaceInvitation(t.uuid);$h(t.uuid,{spaceShareInfo:{inviterId:a.uuid,createdAt:a.createdAt,expirationAt:a.expirationAt}})}else $h(t.uuid,{spaceShareInfo:{inviterId:"",createdAt:0,expirationAt:0}})},CG=e=>Ht(t=>{var n,s;return(s=(n=t.$subscriptionData[e])==null?void 0:n.users)!=null?s:[]}),TG=({spaceId:e,data:t})=>{Ye(Object.assign(wt.$subscriptionData,{[e]:t}))},vG=e=>Ht(t=>t.$subscriptionData[e],rn),sk=async(e=Ut())=>{const t=await Ce.infra.getSpaceSubscriptionData(e);return TG({spaceId:e,data:t}),t},_g=(e=Ut())=>{const t=vG(e),n=ZS(e);return xg(e,{subscriptionData:t,spacePlanInfo:n})},T_={maxBlockLimit:-1,blockUsage:0,mindMapMaxLimit:-1,guestMaxLimit:-1},qy=e=>e===-1?1/0:e,xg=(e=Ut(),t)=>{var u,d,f,h,p,g,_,x,y;const{subscriptionData:n=wt.$subscriptionData[e],spacePlanInfo:s=e6(e)}=t||{},a=qy((d=(u=s==null?void 0:s.currentSpacePlanConfig)==null?void 0:u.block.max)!=null?d:T_.maxBlockLimit),o=(f=n==null?void 0:n.blockUsage)!=null?f:T_.blockUsage,i=qy((p=(h=s==null?void 0:s.currentSpacePlanConfig)==null?void 0:h.mapNodes.max)!=null?p:T_.mindMapMaxLimit),l=qy((x=(_=(g=s==null?void 0:s.currentSpacePlanConfig)==null?void 0:g.guest)==null?void 0:_.max)!=null?x:T_.guestMaxLimit),c=((y=s.spacePlan)==null?void 0:y.maxPeople)||5;return{blocksMaxLimit:a,blocksUsage:o,blocksStock:Math.max(a-o,0),blocksIsMax:o>=a,mindMapMaxLimit:i,guestMaxLimit:l,membersMaxLimit:c}},Sl=(e=Ut())=>{const t=e===Ut();if(xg(e).blocksIsMax)throw t?In.emit("modalId",Xe.MAXIMUM_CAPACITY_DIALOG):ye.error("目标空间容量已达到上限"),new Error("blocks 数量达到最高限制")},z0e={[m.BlockType.PAGE]:"创建子页面",[m.BlockType.FOLDER]:"创建子文件夹",[m.BlockType.COLLECTION_VIEW_PAGE]:"创建记录"};var cs=(e=>(e[e.PRIVATE=0]="PRIVATE",e[e.SPACE=1]="SPACE",e[e.SHARE=2]="SHARE",e[e.FAVORITE=3]="FAVORITE",e))(cs||{});const NG={[0]:"private",[1]:"space",[2]:"share",[3]:"favorite"},IG="toc_group_hidden";var Q1=(e=>(e.FIXED="fixed",e.AUTO="auto",e))(Q1||{});const rk=()=>{var e;return(((e=K.user.setting)==null?void 0:e.pageWidthMode)||"fixed")==="fixed"},Hd=()=>{const e=ke(),t=Qt(),n=(s,a,o)=>{Sl();const{blocks:i}=le(),l=i[a.parentId];if(!l)return;const c=qe(),u=[];return o===cs.PRIVATE&&u.push({role:m.PermissionRole.EDITOR,type:m.PermissionType.USER,userId:t.uuid}),o===cs.SPACE&&u.push({role:m.PermissionRole.EDITOR,type:m.PermissionType.SPACE}),e(()=>{var f,h,p;const d=Date.now();ee(Ia({block:{uuid:c,spaceId:l.spaceId,parentId:a.parentId,textColor:"",backgroundColor:"",type:s,version:0,status:1,local:!0,data:{segments:[],pageFixedWidth:rk(),directoryMenu:(f=K.user.setting)==null?void 0:f.directoryMenu,format:{pageLayout:(h=cm())==null?void 0:h.setting.pageLayout,fontFormat:(p=cm())==null?void 0:p.setting.fontFormat}},subNodes:[],permissions:u,updatedBy:K.user.uuid,createdAt:d,updatedAt:d}})),a.first||a.before?ee(Ii({uuid:c,parentId:a.parentId,before:a.before,ignoreUpdateTime:!0})):ee(Wn({uuid:c,parentId:a.parentId,after:a.after,ignoreUpdateTime:!0}))},{noThrottle:!0}),c};return F.useCallback(n,[t.uuid,e])},Fd=(e,t)=>{const{blocks:n}=le();if(!n[e])return;const a=n[t];if(!a||a.type!==m.BlockType.COLUMN)return;const o=n[a.parentId];if(!o)return;const i=[],l=o.subNodes.filter(c=>{const u=n[c];return(u==null?void 0:u.subNodes.length)===0?(i.push({uuid:c,type:"remove"}),!1):!0});if(l.length===1){const[c]=l;if(!c)return;const u=n[c];u==null||u.subNodes.forEach(d=>{var p;const f=u.subNodes.indexOf(d),h=(p=u.subNodes[f-1])!=null?p:o.uuid;i.push({type:"move",uuid:d,target:o.parentId,after:h})}),i.push({type:"remove",uuid:o.uuid}),i.push({type:"remove",uuid:c})}i.forEach(c=>{ee(tr({uuid:c.uuid})),c.type==="remove"&&ee(mn({uuid:c.uuid,patch:{status:-1}})),c.type==="move"&&ee(Wn({uuid:c.uuid,parentId:c.target,after:c.after}))})},jG=e=>{const t=Array.isArray(e)?e:[e],{blocks:n}=le();t.forEach(s=>{n[s]&&(ee(mn({uuid:s,patch:{status:-2,...fp()}})),ee(tr({uuid:s})))})},t6=(e,t,n=!1)=>{e===t.parentId||!t.parentId||(t.first||t.before?ee(am({uuid:e,parentId:t.parentId,before:t.before,ignoreOp:n})):ee(om({uuid:e,parentId:t.parentId,after:t.after,ignoreOp:n})))},Gh=(e,t,n=!1)=>{e===t.parentId||!t.parentId||ee(hd({parentId:t.parentId,uuid:e,ignoreOp:n}))},DG=()=>{const e=ke(),t=async n=>{const{blocks:s,user:a}=le(),o=Array.isArray(n)?n:[n],[i]=o;if(!i)return;const l={};o.forEach(c=>{e(()=>{jG(c)},{noThrottle:!0});const u=s[c];if(!u)return;l[c]={tag:"NOT_FOUND"};const d=f=>{var p;const h=s[f];ee(Zp({uuid:f})),h&&Xt(h.type)&&ee(Pu.update({[f]:{tag:"NOT_FOUND"}})),tk(f)&&e(()=>{Gh(f,{parentId:a.currentSpaceViewId})}),(p=s[f])==null||p.subNodes.forEach(d)};d(c),Fd(u.uuid,u.parentId)}),ee(Pu.update(l)),await oa(()=>{})};return F.useCallback(t,[e])},SG=()=>{const e=t=>{const{blocks:n}=le();if(!n[t])return;const a=o=>{var i;ee(Zp({uuid:o})),(i=n[o])==null||i.subNodes.forEach(a)};a(t)};return F.useCallback(e,[])},yh={},La=e=>{const t=SG(),n=(s,a)=>{var c,u;let o=yh[s];const i=(c=a==null?void 0:a.force)!=null?c:!1,l=(u=a==null?void 0:a.prefetch)!=null?u:!1;return o||(o=oa(async()=>{var f;ht()&&s===location.pathname.slice(1)&&ee(Gn.clear());const d=await Ce.editor.getDoc.raw(s);if(l||(yh[s]=void 0),[1406,1405].includes(d.code))ee(Pu.update({[s]:{tag:"NEED_PASSWORD"}}));else if(d.code===1403)t(s),ee(Pu.update({[s]:{tag:"NO_PERMISSION"}}));else if(d.code===3005)ee(Pu.update({[s]:{tag:"NOT_FOUND"}}));else if(d.code===1600)e||Ye({$fileIllegal:!0});else if(d.code===200){const{blocks:h,collectionViews:p,discussions:g,comments:_}=d.data;p&&ee(Am.update(p)),g&&ee(n$.update(g)),_&&ee(ZH.update(_)),ee(Gn.update({blocks:h,force:i})),ee(Pu.update({[s]:void 0}))}(f=a==null?void 0:a.callback)==null||f.call(a,d)}),yh[s]=o,o.catch(()=>{yh[s]=void 0})),l?o:o.then(()=>{yh[s]=void 0})};return F.useCallback(n,[e,t])},RG=()=>{const e=async t=>{var o,i;const n=(i=le().blocks[(o=t[0])!=null?o:""])==null?void 0:i.spaceId;if(!n)return;const s={spaceId:n,blockIds:t},{blocks:a}=await Ce.editor.docsPreviewBatch(s);ee(Gn.update({blocks:a}))};return F.useCallback(e,[])},ui=e=>{const t=Ft(),n=Od(e!=null?e:t.uuid);return n.planType===Et.team||n.planType===Et.personal||n.planType===Et.smallTeam},AG=e=>{const t=Ft(),n=Od(e!=null?e:t.uuid);return n.planType===Et.team||n.planType===Et.personal},n6=e=>{const t=e?Lm(e):Tn();return t.planType===Et.team||t.planType===Et.personal||t.planType===Et.smallTeam},s6=e=>(e?Lm(e):Tn()).planType===Et.freePersonal,di=e=>{const t=Ft();return Od(e!=null?e:t.uuid).planType===Et.freePersonal},ak=e=>{const t=Ft();e=e!=null?e:t.uuid;const n=di(e),{isShowAd:s}=Od(e);return n?!0:s},$x=No(()=>({})),ok={currentCapacity:0,maxCapacity:2*Iy,singleFileMaxSize:2*Iy,dataBaseSingleFileMaxSize:2*Iy,isNovice:!1,peopleCapacity:0,buyCapacity:0,expirationCapacity:0,baseCapacity:0,giveCapacity:0},yd=(e=Ut())=>{const t=$x(s=>s[e],rn);return F.useMemo(()=>{let s=ok;return t&&(s=t),n6(e)&&(s.isNovice=!1),s},[t,e])},Mm=(e,t)=>{const{isDatabase:n}=t||{};let s=ok;const a=$x.getState()[e];return a&&(s=a),n&&(s.singleFileMaxSize=s.dataBaseSingleFileMaxSize),s},BG=e=>!!$x.getState()[e],LG=(e,t)=>{$x.setState(n=>({...n,[e]:{...t}}))},fi=()=>F.useCallback(r6,[]),r6=async(e=Ut())=>{const t=await Ce.editor.capacityBlock(e);return LG(e,sd(ok,t)),t},Um=()=>{const e=fi(),t=async(n,s)=>{const a=await Ce.infra.getSpaceRoot.raw(n);if(a.code===200){const{blocks:o,spaces:i,collectionViews:l,users:c}=a.data,u={...Vp(i,d=>({spaceId:d.uuid,type:"SPACE",data:{icon:d.icon},permissions:[],...d})),...o};if(ee(Gn.update({blocks:u})),l&&ee(Am.update(l)),c&&i){ee(ip.update(i));const d=i[n];d!=null&&d.permissions&&ee(El.updateSpaceUsers({users:c,space:d}))}await e(n)}else if(!(s!=null&&s.notJumpLocation)&&(a.code===1403||a.code===3005)){ye.error("空间不存在");const o=y2().filter(i=>i.uuid!==Ut())[0];o?(kS(o.uuid),Bs(Rt.main)):Bs(Rt.create)}};return F.useCallback(t,[e])},Rl=e=>{var i;const t=ht(),n=On(),s=ae(l=>{var u,d,f;const c=(u=l.blocks[e])==null?void 0:u.spaceId;return(f=(d=l.spaces[c!=null?c:""])==null?void 0:d.domain)!=null?f:""});let a=t?`/share/${e}`:`/${e}`,o=s&&!ud()?`/${s}`:"";return((i=K.blocks[e])==null?void 0:i.type)===m.BlockType.FILE&&!t&&(a=`/preview${a}`,o=""),n||(a=`${o}${a}`),a};var Tt=(e=>(e.MAIN="main",e.PAGE_HISTORY="page_history",e.PAGE_FEEDS="page_feeds",e.TEMPLATE="template",e.SHARE="share",e.NOTIFICATION="notification",e.UPDATE_LOG="update_log",e.FORM_ENG_PAGE="form_end_page",e.PAGE_LITE_PREVIEW="page-lite-preview",e.ONLY_IMAGE="only-image",e))(Tt||{});const Al=F.createContext(void 0),Vn=()=>F.useContext(Al),So=e=>ae(t=>{var n,s;return e?(s=(n=t.blocks[e])==null?void 0:n.data.format)==null?void 0:s.locked:!1}),a6=F.createContext(!1),bd=F.createContext(!1),ik=F.createContext(!1),Ve=(e,t=!0,n=!1)=>{const s=Vn();let a=s===Tt.PAGE_HISTORY||s===Tt.PAGE_FEEDS||s===Tt.TEMPLATE||s===Tt.NOTIFICATION||s===Tt.UPDATE_LOG||s===Tt.FORM_ENG_PAGE||s===Tt.PAGE_LITE_PREVIEW;n&&s&&[Tt.NOTIFICATION,Tt.PAGE_FEEDS].includes(s)&&(a=!1);const o=F.useContext(a6),i=F.useContext(bd),{role:l}=it(e!=null?e:"");return i||!!pt.print||a||!Fs(l,n?m.PermissionRole.COMMENTER:m.PermissionRole.WRITER)||t&&o},o6=()=>{const e=ke(),t=Qt(),n=async s=>{const{blocks:a}=le(),o=a[s];o&&e(()=>{var u;ee(mn({uuid:s,patch:{updatedAt:Date.now(),status:m.BlockStatus.NORMAL}})),o.status!==m.BlockStatus.DELETED&&ee(tr({uuid:s,parentId:o.parentId}));const i=a[o.parentId];let l=i,c=!l;for(;l;){if(l.status===m.BlockStatus.DELETED){c=!0;break}const d=l.type!=="SPACE";l=a[l.parentId],!l&&d&&(c=!0)}if(c||((i==null?void 0:i.type)===m.BlockType.FOLDER&&[m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE].includes(o.type)||(i==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW_PAGE&&[m.BlockType.FOLDER,m.BlockType.COLLECTION_VIEW_PAGE].includes(o.type))&&(c=!0),c)o.type===m.BlockType.COLLECTION_VIEW&&ee(mn({uuid:s,patch:{type:m.BlockType.COLLECTION_VIEW_PAGE}})),o.type===m.BlockType.MIND_MAPPING&&ee(mn({uuid:s,patch:{type:m.BlockType.MIND_MAPPING_PAGE}})),o.isTemplate&&ee(mn({uuid:s,patch:{isTemplate:!1}})),ee(mn({uuid:s,patch:{permissions:[{type:m.PermissionType.USER,userId:t.uuid,role:m.PermissionRole.EDITOR}]}})),ee(Wn({uuid:s,parentId:o.spaceId}));else if(o.isTemplate&&i!=null){const d=(u=i.templatePages)!=null?u:[];ee(mn({uuid:i.uuid,patch:{templatePages:[...d,o.uuid]}}))}else if((i==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW_PAGE){const d=i.uuid;ee(Wn({uuid:s,parentId:d}))}else ee(Wn({uuid:s,parentId:o.parentId}))})};return F.useCallback(n,[t.uuid,e])},i6=new jo(sessionStorage,"page_layout",30),PG=(e,t)=>{i6.put(e,t)},OG=e=>i6.get(e),Yu={lastGoBackPath:"",tmpDisable:!1},l6=(e,t)=>{const n=Vc(),s=On(),a=F.useRef();a.current=n;const o=Un(),i=Vn();F.useEffect(()=>{var h;if(!t.current||ht()||[i&&Tt.PAGE_HISTORY,Tt.TEMPLATE].includes(i))return;let l;const u=$n(()=>{var p,g;PG(e,{scrollTop:(g=(p=t.current)==null?void 0:p.scrollTop)!=null?g:0})},300);t.current.addEventListener("scroll",u);const d=()=>{var p;l&&clearTimeout(l),(p=t.current)==null||p.removeEventListener("scroll",u)};if(!Yu.lastGoBackPath||Yu.lastGoBackPath!==((h=a.current)==null?void 0:h.pathname))return d;const f=OG(e);return f&&(l=setTimeout(()=>{t.current&&t.current.scrollTo({top:f.scrollTop})},100)),d},[o,s,e,i,t])},W0e=e=>ae(t=>{if(!e)return[];const n=vD(t.cache);let s=n.get(e);return s==null&&(s=Gx(t.blocks,e),u2(t.cache,n.set(e,s))),s},{equalityFn:Cn}),Gx=(e,t)=>{const n=new Set,s=a=>{var i;const o=e[a];o&&(a!==t&&((i=o.data.segments)==null||i.forEach(l=>{if(l.type===m.TextType.LINK_PAGE){const c=l.uuid;if(!c)return;const u=e[c];if(!u||u.status===m.BlockStatus.DELETED)return;u&&u.parentId===a&&n.add(c)}})),o.subNodes.forEach(l=>{const c=e[l];if(!c)return;const u=ki(c);if(Xt(c.type)||u){const{role:d}=hn(c.uuid);d!==m.PermissionRole.NONE&&n.add(l)}Xt(c.type)||c.type===m.BlockType.TEMPLATE||s(l)}))};return s(t),[...n]},lk=e=>{const{loader:t,unloader:n,className:s,...a}=e,{imgUrl:o,onError:i,isProxyUrl:l,proxyLoading:c}=kU(e),u=gc(o),d=c?`${s} rounded brightness-50 animate__animated animate__infinite animate__flash animate__slower`:s,f=["ownerBlockId","onError","src"];(l.current||!u)&&f.push("sizes","srcSet");const h={...Jn(a,f),className:d,referrerPolicy:u?"strict-origin-when-cross-origin":"no-referrer",crossOrigin:u?"anonymous":void 0,src:c?Zb:o,onError:i};return t&&l.current&&!c?r.jsx(jI,{"data-image":!0,...h,loader:r.jsx(r.Fragment,{children:t}),unloader:r.jsx(r.Fragment,{children:n==null?void 0:n(e)})}):r.jsx("img",{"data-image":!0,...h})},T2=e=>{const{trigger:t,emojiSize:n,hasOverlay:s,className:a,onClick:o,src:i}=e;return r.jsxs("span",{className:B("items-center justify-center relative inline-flex align-sub flex-shrink-0",{"rounded animate-hover":t},a,s&&"p-0"),style:{fontSize:n},children:[r.jsx(lk,{onClick:o,className:B("object-cover object-center rounded-sm",{"cursor-pointer ":t}),style:{height:"1em",width:"1em"},src:i}),s&&r.jsx(H,{className:"absolute right-[-1px] bottom-[0]",name:"MIcBadgePagelink",style:{fontSize:"0.65em",color:"black"}})]})},MG="oss_images";class UG{constructor(){q(this,"lruCache");q(this,"paddingFetchUrl");q(this,"fetchers",{});q(this,"padding");this.lruCache=new jo(localStorage,MG,100),this.paddingFetchUrl={},this.padding=!1}putCache(t,n,s){const a=this.getCacheKey("image",t);this.lruCache.put(a,{url:n,expireTime:s-1e3*60*10});const o=this.getCacheKey("download",t);this.lruCache.put(o,{url:n,expireTime:s-1e3*60*10})}async getUrl(){if(this.padding)return;this.padding=!0,await Za(300),this.padding=!1;const t=Ei(this.paddingFetchUrl);if(!t.length)return;this.paddingFetchUrl={};const n=await Ce.infra.createUrls.raw({batch:t.map(s=>Jn(s,"callback"))});n.code===200?n.data.forEach((s,a)=>{var o,i;typeof s!="string"?(o=t[a])==null||o.callback(s):(i=t[a])==null||i.callback()}):t.forEach(s=>{s.callback()}),Ei(this.paddingFetchUrl).length&&this.getUrl()}async addPaddingFetchUrl(t,n){const s=new jx;return this.paddingFetchUrl[t]={...n,callback:a=>{a?s.resolve(a):s.resolve({url:"",ttl:0})}},this.getUrl(),s.promise}async fetchUrl(t,n,s,a,o){const{shareId:i}=o||{};if(!s)return"";const l=this.getCacheKey(t,s,a);this.tryClearCache(l);const c=this.lruCache.get(l);if(c)return c.url;const u=this.fetchers[l];if(u)return u;const f=(async()=>{const h=await this.addPaddingFetchUrl(l,{blockId:n,ossName:s,download:a,shareId:i});return delete this.fetchers[l],h.url?(this.lruCache.put(l,{url:h.url,expireTime:he().add(1,"hours").valueOf()}),h.url):(console.warn("urlFetcher:",h),"")})();return this.fetchers[l]=f,f}async fetchImageUrl(t,n,s,a){return this.fetchUrl("image",t,n,s,a)}async fetchDownloadUrl(t,n,s){return this.fetchUrl("download",t,n,s)}getCacheKey(t,n,s){return`${t}${n}${s}`}tryClearCache(t){const n=this.lruCache.get(t);n&&n.expireTime<=Date.now()&&(this.lruCache.delete(t),delete this.fetchers[t]),n&&n.expireTime>Date.now()+1e3*2*60*60&&this.lruCache.delete(t)}}const Ls=new UG,Vi=(e,t)=>{var x,y;const n=_e(e,["data"],["segments","caption","ossName","localUrl"]),s=(n==null?void 0:n.type)===m.BlockType.PDF_ANNOTATION,a=(x=t==null?void 0:t.ossName)!=null?x:n==null?void 0:n.data.ossName,[o,i]=F.useState(!!a),[l,c]=F.useState(),[u,d]=F.useState(!1),f=a!=null?a:de(n==null?void 0:n.data.segments),{extName:h}=sn(f),p=cn.office.test(h),g=(t==null?void 0:t.isImage)||cn.image.test(h),_=(t==null?void 0:t.disableLocalUrl)||p||tw.includes(h);return F.useEffect(()=>{const b=K.blocks[e];if(!b){i(!1);return}if(b.type===m.BlockType.EXTERNAL_FILE){Is.unstable_batchedUpdates(()=>{i(!1),b.data.link?c(JE(b.data.link)):c(void 0)});return}if(s){i(!0);const E=de(b==null?void 0:b.data.segments)||f;oa(async()=>{var k,C;if(!((k=b.data.pdfAnnotation)!=null&&k.ossName))return;const w=await Ls.fetchDownloadUrl(e,(C=b.data.pdfAnnotation)==null?void 0:C.ossName,E);w&&c(w),d(!0),i(!1)},"oss");return}if(!a&&b.data.localUrl&&!_){Is.unstable_batchedUpdates(()=>{i(!1),c(void 0)});return}b!=null&&b.data.localUrl||i(!0),(async()=>{if(!a){i(!1);return}for(let E=0;E<2;E++){let w="";if(g)w=await Ls.fetchImageUrl(b.uuid,a);else{const k=de(b==null?void 0:b.data.segments)||f;w=await Ls.fetchDownloadUrl(b.uuid,a,k)}if(w){c(w),d(!0);break}await Za(3e3)}i(!1)})()},[_,s,g,f,a,e]),{imageUrl:l?bo(l,h):(y=n==null?void 0:n.data.localUrl)!=null?y:"",url:l||(n==null?void 0:n.data.localUrl)||"",loading:o,isOssNameUrl:u}},VG=async e=>{const t=K.blocks[e];if(!t||!t.data.ossName)return;const n=de(t==null?void 0:t.data.segments);return await Ls.fetchDownloadUrl(t.uuid,t.data.ossName,n)},qG=e=>{const{imageUrl:t,loading:n}=Vi(e.blockId,{disableLocalUrl:!0,isImage:!0,ossName:e.ossName}),{extName:s}=ac(e.ossName);let a="";return Rd.test(s)&&(a=`&img_process=/resize,w_${Math.floor(256*Math.ceil(window.devicePixelRatio))}/`),n?r.jsx(hs,{className:e.className,size:"middle"}):r.jsx(T2,{...e,src:bo(`${t}${a}`,s)})},ck=(e,t)=>{const{ui:n}=le(),{selectedBlocks:s}=n;t&&s.findIndex(a=>a.blockId===t)===-1?pe(t,e):s.forEach(a=>pe(a.blockId,e))},pe=(e,t,n=!1,s)=>{const a=s?s.getState.bind(s):le,o=s?s.dispatch.bind(s):ee,{blocks:i}=a();i[e]&&(Ox(e,n,s),o(mn({uuid:e,patch:t,ignoreOp:n})))},c6=e=>{var t,n;e&&e.uuid&&((n=(t=e.data)==null?void 0:t.localUrl)!=null&&n.startsWith("blob"))&&(e.data.localUrl.startsWith("blob")&&URL.revokeObjectURL(e.data.localUrl),pe(e.uuid,{data:{localUrl:void 0}},!0))};let Zl={request:{infra:{},editor:{}},ossCallbackHost:"http://dev.allflow.cn",onError:()=>{}};const HG=e=>{Zl=e};class $G{constructor(t){q(this,"pendingTask",[]);q(this,"runningTaskSize",0);q(this,"poolSize");this.poolSize=t}enqueueTask(t){const n=qe();return this.pendingTask.push({...t,taskId:n}),this.notifyTaskChange(),n}removeTask(t){const n=this.pendingTask.findIndex(s=>s.taskId===t);if(n!==-1)return this.pendingTask.splice(n,1),!0}notifyTaskChange(){if(this.pendingTask.length===0)return;const t=this.poolSize-this.runningTaskSize;for(let n=0;this.pendingTask.length>0&&n<t;n++){const s=this.pendingTask.shift();if(!s)return;this.runningTaskSize++,s.run().then(s.onSuccess).catch(s.onFailed).finally(()=>{this.runningTaskSize--,this.notifyTaskChange()})}}}var Xs=(e=>(e[e.CODE_NOT_FOUND_TASK=1e3]="CODE_NOT_FOUND_TASK",e[e.UPLOAD_FAILED=1001]="UPLOAD_FAILED",e[e.GET_TOKEN_FAILED=1002]="GET_TOKEN_FAILED",e[e.UPLOAD_CANCEL=1003]="UPLOAD_CANCEL",e[e.UPLOAD_MAX_CAPACITY_LIMIT=1004]="UPLOAD_MAX_CAPACITY_LIMIT",e[e.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT=1005]="UPLOAD_SINGLE_FILE_CAPACITY_LIMIT",e))(Xs||{});const GG=e=>new Promise(t=>{setTimeout(t,e)}),Hy=5,zG=1*1024*1024;class WG{constructor(t="yunshanglvzhou",n="https://oss.flowus.cn"){q(this,"bucket");q(this,"endpoint");q(this,"ossClientMap");q(this,"getUrlForDownload",(t,n)=>{let s="";return t.data&&t.data.url&&(s=`${t.data.url}&filename=${encodeURIComponent(n)}`),s});this.bucket=t,this.endpoint=n,this.ossClientMap=new Map}async upload(t){await KG();const{OSS:n}=window,s=new n({bucket:this.bucket,cname:!0,endpoint:this.endpoint,...t.tokenInfo,refreshSTSTokenInterval:Number.MAX_VALUE,timeout:2*60*1e3});return this.ossClientMap.set(t.uploadId,{...t,ossClient:s}),t.file.size<=zG?this.uploadSmallFile(t.uploadId):this.uploadBigFile(t.uploadId)}abort(t){var s;const n=this.ossClientMap.get(t);try{n&&n.ossClient.abortMultipartUpload(n.path,(s=n.checkPoint)==null?void 0:s.uploadId)}catch(a){this.ossClientMap.delete(t)}}async uploadSmallFile(t){var s,a,o;const n=this.ossClientMap.get(t);if(!n)return{success:!1,errCode:Xs.CODE_NOT_FOUND_TASK,errMsg:"找不到上传任务"};try{(s=n.onProgress)==null||s.call(n,0);const i=await n.ossClient.put(n.path,n.file,{callback:n.callback});if(i.res.status===200)return(a=n.onProgress)==null||a.call(n,100),{success:!0,ossName:i.name,expireTime:Date.now()+1e3*60*60*1.5,url:this.getUrlForDownload(i,n.file.name)}}catch(i){(o=Zl.onError)==null||o.call(Zl,i);const l=await this.handleError(i,Hy);if(l)return l}return{success:!1,errCode:Xs.UPLOAD_FAILED,errMsg:"上传失败"}}async uploadBigFile(t){var a;const n=this.ossClientMap.get(t);if(!n)return{success:!1,errCode:Xs.CODE_NOT_FOUND_TASK,errMsg:"找不到上传任务"};const s=1024*1024;(a=n.onProgress)==null||a.call(n,0);for(let o=0;o<Hy;o++)try{const i=await n.ossClient.multipartUpload(n.path,n.file,{parallel:3,checkpoint:n.checkPoint,partSize:s,progress:(l,c)=>{var u;n.checkPoint=c,(u=n.onProgress)==null||u.call(n,Math.round(l*100))},callback:n.callback});if(i.res.status===200)return{success:!0,ossName:i.name,expireTime:Date.now()+1e3*60*60*1.5,url:this.getUrlForDownload(i,n.file.name)}}catch(i){const l=await this.handleError(i,o);if(l)return l;await GG(2*(o+1)*1e3)}finally{this.ossClientMap.delete(t)}return{success:!1,errCode:Xs.UPLOAD_FAILED,errMsg:"上传失败"}}async handleError(t,n){if(!t)return;console.warn(t);let s="上传失败";if(t.name==="cancel")return{success:!1,errCode:Xs.UPLOAD_CANCEL,errMsg:"已取消"};if(!(n<Hy-1))return t.name==="RequestError"&&(s="网络连接异常，上传失败，请稍后再试"),{success:!1,errCode:Xs.UPLOAD_FAILED,errMsg:s}}}let $y;const KG=async()=>($y||($y=new Promise(e=>{const t=document.createElement("script");t.setAttribute("src","https://cdn.staticfile.org/ali-oss/6.17.1/aliyun-oss-sdk.js"),t.addEventListener("load",()=>e(void 0)),document.head.appendChild(t)})),$y),YG="bucket=${bucket}&object=${object}&etag=${etag}&size1=${size}&mimeType=${mimeType}&imageInfo.height=${imageInfo.height}&imageInfo.width=${imageInfo.width}&imageInfo.format=${imageInfo.format}",XG=3,QG="bucket=${bucket}&object=${object}&etag=${etag}&size=${size}&mimeType=${mimeType}&imageInfo.height=${imageInfo.height}&imageInfo.width=${imageInfo.width}&imageInfo.format=${imageInfo.format}";class JG{constructor(){q(this,"taskPools",{});q(this,"ossUploader");q(this,"uploadIdMappingTaskId",new Map);q(this,"generateSavePath",(t,n)=>{const s=`${qe()}/${n}`;return`${t}${s}`});this.ossUploader=new WG}getTaskPool(t){return this.taskPools[t]||(this.taskPools[t]=new $G(XG)),this.taskPools[t]}upload(t){const n=this.getTaskPool(t.type),s=qe(),a=n.enqueueTask({run:async()=>{var i,l,c;const o=await Zl.request.infra.getFileUploadInfo.raw({fileName:t.file.name,spaceId:t.spaceId,type:t.type,size:t.file.size,dataBaseSingleFileMaxSize:t==null?void 0:t.isDatabase});if(o.code===200){(i=t.onCapacitySuccess)==null||i.call(t);const u=o.data,d=new URLSearchParams;return d.append("fileName",t.file.name),d.append("spaceId",t.spaceId),d.append("userId",t.userId),d.append("type",t.type),d.append("fileSecret",u.fileSecret),t.searchType&&d.append("recentlyImgType",t.searchType),this.uploadIdMappingTaskId.delete(s),this.ossUploader.upload({uploadId:s,file:t.file,path:u.ossName,tokenInfo:{accessKeyId:u.token.accessKeyId,accessKeySecret:u.token.accessKeySecret,stsToken:u.token.securityToken},callback:{url:`${Zl.ossCallbackHost}/api/upload/v2/callback`,body:`${d.toString()}&${QG}`},onProgress:f=>{var h;(h=t.onProgress)==null||h.call(t,f)}})}if(o.code===2103){(l=t.onComplete)==null||l.call(t,{success:!1,errCode:Xs.UPLOAD_MAX_CAPACITY_LIMIT,errMsg:o.msg});return}if(o.code===2104){(c=t.onComplete)==null||c.call(t,{success:!1,errCode:Xs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT,errMsg:o.msg});return}if(o!==200)throw Error(o.msg)},onFailed:o=>{var i,l;o.name==="cancel"?(i=t.onComplete)==null||i.call(t,{success:!1,errCode:Xs.UPLOAD_CANCEL,errMsg:"上传取消"}):(console.warn(o),(l=t.onComplete)==null||l.call(t,{success:!1,errCode:Xs.UPLOAD_FAILED,errMsg:`上传失败[${o.message}]`}))},onSuccess:o=>{var i;o&&((i=t.onComplete)==null||i.call(t,o))}});return this.uploadIdMappingTaskId.set(s,{taskId:a,params:t}),s}uploadWithoutLogin(t){const n=this.getTaskPool(t.type),s=qe();return n==null||n.enqueueTask({run:async()=>{var o,i,l;const a=await Zl.request.infra.getUnsignedInfo.raw({spaceId:t.spaceId,viewId:t.viewId,dataBaseSingleFileMaxSize:!0});if(a.code===200){if(a.data.currentCapacity+t.file.size>a.data.maxCapacity){(o=t.onComplete)==null||o.call(t,{success:!1,errCode:Xs.UPLOAD_MAX_CAPACITY_LIMIT,errMsg:a.msg});return}if(t.file.size>t.singleFileMaxCapacity){(i=t.onComplete)==null||i.call(t,{success:!1,errCode:Xs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT,errMsg:a.msg});return}}if(a.code===200){(l=t.onCapacitySuccess)==null||l.call(t);const c=this.generateSavePath(a.data.token.prefix,t.file.name),u=a.data,d=new URLSearchParams;return d.append("size",t.file.size.toString()),d.append("saveName",c),d.append("fileName",t.file.name),d.append("spaceId",t.spaceId),d.append("fileType",t.type),this.ossUploader.upload({uploadId:s,file:t.file,path:c,tokenInfo:{accessKeyId:u.token.accessKeyId,accessKeySecret:u.token.accessKeySecret,stsToken:u.token.securityToken},callback:{url:`${Zl.ossCallbackHost}/api/upload/callback`,body:`${d.toString()}&${YG}`},onProgress:f=>{var h;(h=t.onProgress)==null||h.call(t,f)}})}if(a!==200)throw Error(a.msg)},onFailed:a=>{var o,i;a.name==="cancel"?(o=t.onComplete)==null||o.call(t,{success:!1,errCode:Xs.UPLOAD_CANCEL,errMsg:"上传取消"}):(i=t.onComplete)==null||i.call(t,{success:!1,errCode:Xs.UPLOAD_FAILED,errMsg:`上传失败[${JSON.stringify(a)}]`})},onSuccess:a=>{var o;a&&((o=t.onComplete)==null||o.call(t,a))}}),s}abort(t){const n=this.uploadIdMappingTaskId.get(t);n?this.getTaskPool(n.params.type).removeTask(n.taskId)&&n.params.onComplete({success:!1,errCode:Xs.UPLOAD_CANCEL,errMsg:"已取消"}):this.ossUploader.abort(t)}}const Fg=new JG,ZG=(e,t)=>{var o,i;if(!e[0])return null;const n={name:"",files:[],folders:[]};let s="";const a=new Set;for(const l of e){if(!t&&l.name.startsWith(".")||(l.webkitRelativePath&&(l.fullPath=(o=l.webkitRelativePath)!=null?o:""),l.fullPath||(l.fullPath=un?"":(i=l.path)!=null?i:""),l.fullPath===void 0))continue;const c=l.fullPath.indexOf("/"),u=l.fullPath.lastIndexOf("/");if(c>=0?(s=l.fullPath.slice(0,c),a.add(s)):a.add(0),c===u)n.files.push(l);else{const d=l.fullPath.slice(0,u),f=ez(d);f.shift();let h=n;for(const p of f){const g=h.folders.find(_=>_.name===p);if(g)h=g;else{const _={name:p,files:[],folders:[]};h.folders.push(_),h=_}}h.files.push(l)}}return a.size===1&&(n.name=s),n},ez=e=>e.split("/");var Ae=(e=>(e.GUIDE_FIRST_TIME_CREATED_SPACE="a648640a-a3d9-4335-86d6-eaa03d79b859",e.GUIDE_FIRST_TIME_CREATED_PAGE="d453314a-36f6-1603-8116-28ca9efdd08d",e.GUIDE_FIRST_TIME_CREATED_COLLECTION="9f888320-ae4c-f2b0-a0dd-028153e0e4b3",e.GUIDE_FIRST_TIME_CREATED_FOLDER="746d9e52-3fa2-7676-91a8-f7e457dd9bfb",e.GUIDE_FIRST_TIME_CREATED_TABLE="946607c0-beac-041f-fd76-45c5ef2591eb",e.GUIDE_FIRST_TIME_UPLOAD="99e2b29e-0429-fe53-0b38-776dd4b6c867",e.GUIDE_FIRST_TIME_UPLOAD_COVER="bd44fb8f-646d-4187-40f1-c8daa9ccb1ad",e.GUIDE_FIRST_TIME_CREATED_COLUMN_LIST="55db4312-3dfd-79fd-0e7c-e7ef4c977648",e.GUIDE_FIRST_TIME_APP_DRAG="b640bd28-e14c-4f50-7e52-b2d3b2c58653",e.GUIDE_FIRST_TIME_COPY_TEMPLATE="193a8c4b-cec3-74de-16b0-2e35556be323",e.GUIDE_FIRST_TIME_SHORTCUT_CREATED="8f8ddded-5d80-0c15-b5b5-9952c3b922a8",e.GUIDE_FIRST_TIME_LINK_PAGE="596f293a-5f5d-0536-9c07-aa7b1e5b970d",e.GUIDE_FIRST_TIME_BOARD_VIEW="2cd872ab-3a29-6d2d-7b42-ed2f1d81d82a",e.GUIDE_FIRST_TIME_TIMELINE_VIEW="4e8e03f5-d2a6-4c12-b05b-321c1a57e72d",e.GUIDE_FIRST_TIME_CALENDAR_VIEW="3bad6862-9134-47e4-8b3a-9dd2dc093274",e.GUIDE_FIRST_TIME_COLLECTION_VIEW="deb678d3-6742-cdfc-1e61-adc1f153600e",e.GUIDE_FIRST_TIME_CREATED_SYNC="d2661165-b02a-f819-bff6-c6619db0e33a",e.GUIDE_FIRST_TIME_CREATED_TEMPLATE="8c148290-db9a-e791-0430-3cd3e776fa8a",e.GUIDE_FIRST_TIME_SHARE="1d767026-0143-98fb-8e54-ed607f91d7a1",e.GUIDE_FIRST_TIME_APP_PIC_SHARE="18d24e67-b984-2b59-4e1b-9ee5d24839e3",e.LIMITED_TIME_COLLECTION_TABLE="7869de9c-2f3b-402c-3568-7ab59edbffca",e.LIMITED_TIME_SHARE_COPY="d6b61f9c-4d11-b62a-fff1-7e742c28c5fd",e.STANDING_IMPORT="6a7a0241-65f5-41f5-b7f2-cafc3cb8409e",e.NEW_USER_START="b7c9dd44-0881-41ec-a759-7094ff22b2c8",e.START_FROM_HERE="cd87ff03-0ee4-4f7a-8e91-45ccb8290202",e.EXPLORE_MORE_FEATURE="38c7a0bb-d4c8-43b7-bbd5-bc83f1f96ec8",e.USE_FLOWUS_EVERYWHERE="2414889b-2926-407a-9f05-04c0b8f9fb67",e.CREATE_PAGE="f799091c-afcf-47ab-a7b6-e2d5bb990dcc",e.CREATE_AND_DRAG_BLOC="0c9f0d66-eee8-472d-a681-84248923ea60",e.WRITE_AND_EDIT="3115bbf6-e96f-41b4-93b0-a859738346ef",e.CREATE_FILE_BLOCK="8f56d945-2a36-42df-8348-9deca0381124",e.CREATE_FOLDER_BLOCK="37a1ee22-aebc-4d2d-9089-ea3ffe2fae09",e.CREATE_BITABLE_BLOCK="f18babc4-a068-41be-a10f-c17a6982a605",e.CREATE_BITABLE_VIEW="be2e0d41-ac83-47a5-9884-197d88d8ec1d",e.CREATE_SYNC_BLOCK="2ed6a364-8c33-4a6d-bd94-385029ee562a",e.COOPERATION_AND_SHARE="3556aa6b-f53a-4ac3-9338-b74cffe8bb2f",e.EXPORT_PAGE="fba1d4b7-e7d6-41a6-89a5-f45ab9af6c90",e.LEARN_WORKSPACE="b06459f2-938b-4042-b992-05a8c2c548e7",e.WRITE_BLOG="6bf4d8f3-7213-4d87-bdd3-5da503caa38b",e.PLAN="ea5b4fcd-2ef9-4e85-a908-a2178910812d",e.WIKI="d76cde1a-735f-4555-a859-9fee6befef23",e.CREATE_SITE="a9958a95-afc6-4c35-9e85-c61b3fde6935",e.LOGIN_IN_MAC_OR_WINDOWS="f1b4c928-e762-469c-9e90-8ffcf723a120",e.LOGIN_IN_ANDROID_OR_IOS="b7c58a5f-b2ab-4379-8171-979e979a50e5",e.LOGIN_IN_FLOWUS="7c01f540-49ce-40bd-bdc4-6f02a5a6ed5f",e.USE_WECHAT_CLIP="be5f2ab7-6ab2-4c41-a7ac-04dbb028e1b1",e.CREATE_NEW_PAGE="97bef546-5ea4-45c1-a0ea-f1b095dfbfea",e.CONVERT_TEXT_BLOCK="67d716a5-4197-4410-903c-8eaeff17518c",e.CREATE_TODO_BLOCK="f65334a1-152e-4f94-bf97-91f0d3774007",e.CREATE_HEADER_BLOCK="a2307b14-b4b0-48eb-b052-35c3c257ba89",e.CREATE_QUOTE_BLOCK="646cd033-46eb-4cba-9078-253528040465",e.CREATE_MARK_BLOCK="17ade11e-3e17-4cce-ba68-255178caeadb",e.CREATE_IMAGE_BLOCK="c8b745a7-f48f-46a9-8e98-e5e1229f303b",e.CREATE_SIMPLE_TABLE="61956fe0-7c03-41c8-be9c-636ebcb46a23",e.CREATE_BITABLE_EXPLORE="3d65d673-c124-4d01-8ca8-20c4d9f0a862",e.CREATE_DATE_MENTION="861dccfa-7154-4b02-b368-b2ca3cc6e72c",e.MOBILE_SORT_BLOCK="2ff9c2aa-cdbe-46a5-998d-b2c3d728be44",e.CREATE_COLUMNS_BLOCK="0968ccb9-e1a2-4a58-a96c-baf1f5b1c523",e.CREATE_FOLDER_AND_UPLOAD="a1de73e3-56ab-4f16-a07a-4733e23dff38",e.COPY_PAGE_FROM_TEMPLATE="7f32f8fb-8b3c-4b02-b58f-6cdad6466200",e.CREATE_WEB_BOOKMARK="09428d57-ef33-4381-80da-a619a4d3c943",e.CREATE_LINK="1640a973-431d-4907-9fef-60e71570c695",e.CREATE_REF_PAGE="711ed60d-f524-4c57-a318-a4860acb5e42",e.CREATE_MIND_MAP="bc9fe5b5-d903-4d17-89b1-ec343fcc0945",e.CREATE_GALLERY_VIEW="4567bedd-c092-4d37-9db2-6d81dd4a82d7",e.CREATE_TIMELINE_VIEW="9c7fbb62-878e-4573-a320-91e5a0388925",e.CREATE_CALENDAR_VIEW="a02a9b57-4745-41e0-b3e7-7f4b214bd194",e.CREATE_FORM_VIEW="4ac0096b-e2d5-47cd-a0b0-d255985fd32b",e.ADD_TO_FAVORITE="e0ee5c10-0fd5-4c86-b2e2-d514b755eae9",e.CREATE_SYNC_BLOCK_NEW="bb67a765-a7f0-442f-9263-377eea2c8082",e.CREATE_TEMPLATE_BUTTON="f1a64622-9365-4700-98e2-84ec192d9210",e.OPEN_SHARE="aa1c3568-5018-41be-be93-d655747e79c9",e.CONVERT_TO_TEMPLATE="7c82410b-8f63-4d0b-a9f0-7be9ed6030bc",e.MOBILE_SHARE_LONG_PAGE_IMAGE="dae39919-242f-44e0-ac97-cff567711c4c",e.INVITE_REGISTER="d8c323b3-b5b7-4ec4-a219-218f6b80fe08",e))(Ae||{});const tz=new Set(["a2307b14-b4b0-48eb-b052-35c3c257ba89","c8b745a7-f48f-46a9-8e98-e5e1229f303b","a1de73e3-56ab-4f16-a07a-4733e23dff38","4567bedd-c092-4d37-9db2-6d81dd4a82d7","bb67a765-a7f0-442f-9263-377eea2c8082","861dccfa-7154-4b02-b368-b2ca3cc6e72c"]),$T=new Set(["a2307b14-b4b0-48eb-b052-35c3c257ba89","c8b745a7-f48f-46a9-8e98-e5e1229f303b","3d65d673-c124-4d01-8ca8-20c4d9f0a862","4567bedd-c092-4d37-9db2-6d81dd4a82d7","9c7fbb62-878e-4573-a320-91e5a0388925","a02a9b57-4745-41e0-b3e7-7f4b214bd194","4ac0096b-e2d5-47cd-a0b0-d255985fd32b","bb67a765-a7f0-442f-9263-377eea2c8082","f1a64622-9365-4700-98e2-84ec192d9210"]),GT={["a2307b14-b4b0-48eb-b052-35c3c257ba89"]:"标题",["c8b745a7-f48f-46a9-8e98-e5e1229f303b"]:"图片",["3d65d673-c124-4d01-8ca8-20c4d9f0a862"]:"多维表",["4567bedd-c092-4d37-9db2-6d81dd4a82d7"]:"画廊视图",["9c7fbb62-878e-4573-a320-91e5a0388925"]:"时间轴视图",["a02a9b57-4745-41e0-b3e7-7f4b214bd194"]:"日历视图",["4ac0096b-e2d5-47cd-a0b0-d255985fd32b"]:"表单视图",["bb67a765-a7f0-442f-9263-377eea2c8082"]:"同步块",["f1a64622-9365-4700-98e2-84ec192d9210"]:"模板按钮"},Qe=(e,t,n=!1,s=!0)=>{var l,c,u,d,f,h,p,g,_,x,y,b,E,w,k,C,T,v,I;const a=(l=e.uuid)!=null?l:qe(),o=K.blocks[t.parentId];if(!o&&!t.spaceId)throw new Error("parent not found");Sl(t.spaceId||(o==null?void 0:o.spaceId));const i={uuid:a,spaceId:(u=(c=t.spaceId)!=null?c:o==null?void 0:o.spaceId)!=null?u:"",parentId:(f=(d=o==null?void 0:o.uuid)!=null?d:t.spaceId)!=null?f:"",type:m.BlockType.TEXTAREA,textColor:"",backgroundColor:"",status:1,version:0,subNodes:[],permissions:[],...e,createdAt:Date.now(),createdBy:K.user.uuid,...fp(),data:{...(h=e.data)!=null?h:{},pageFixedWidth:(g=(p=e.data)==null?void 0:p.pageFixedWidth)!=null?g:rk(),directoryMenu:(_=K.user.setting)==null?void 0:_.directoryMenu,format:{...(x=e.data)==null?void 0:x.format,pageLayout:(w=(b=(y=e.data)==null?void 0:y.format)==null?void 0:b.pageLayout)!=null?w:(E=cm())==null?void 0:E.setting.pageLayout,fontFormat:(v=(C=(k=e.data)==null?void 0:k.format)==null?void 0:C.fontFormat)!=null?v:(T=cm())==null?void 0:T.setting.fontFormat}}};if(!i.spaceId)throw new Error("not spaceId");if(!i.parentId)throw new Error("not parentId");if(ee(Ia({block:i,ignoreOp:n,local:s})),t.inline)return a;if(t.templatePages){const j=(I=K.blocks[t.parentId])==null?void 0:I.templatePages,D=[...j!=null?j:[],a];ee(mn({uuid:t.parentId,patch:{templatePages:D}}))}else t.first||t.before?ee(Ii({uuid:a,parentId:t.parentId,before:t.before,ignoreOp:n})):ee(Wn({uuid:a,parentId:t.parentId,after:t.after,ignoreOp:n}));return a},zT=No(()=>({})),uk=()=>F.useCallback(async e=>{const t=zT.getState();if(t[e])return t[e];const s=(await Ce.infra.getSpacesPublicData({spaceIds:[e]})).spaces[e];return s&&sd(zT,{[e]:s}),s},[]);var We=(e=>(e.activityList="activityList",e.advancedList="advancedList",e.basicList="basicList",e))(We||{});const nz=e=>Hc(t=>t.basicList.concat(t.advancedList).concat(t.activityList).find(n=>n.uuid===e)),yg=e=>{const t=Uh();return t.basicList.concat(t.advancedList).concat(t.activityList).find(n=>n.uuid===e)},sz=()=>Hc(rz),rz=e=>{const{basicList:t,advancedList:n}=e,s=t.filter(l=>l.status==="completed"),a=n.filter(l=>l.status==="completed"),o=s.length+a.length,i=t.length+n.length;return{basicList:t,advancedList:n,completedTaskLength:o,allTaskLength:i,progress:o/i}},Vm=()=>{let e=document.getElementById("ActivityModalAnchor");return e||(e=document.createElement("div"),e.id="ActivityModalAnchor",e.setAttribute("style","position:fixed; bottom:40px; right:20px; z-index:-1; height:50px; width:50px;"),document.body.appendChild(e)),{popcorn:e,reCreate:()=>{document.body.appendChild(e)},remove:()=>{document.body.removeChild(e)}}};var Vt=(e=>(e.pay="pay",e.group="group",e.package="package",e.file="file",e.pageHistory="page_history",e.extMember="ext_member",e.spaceSetFile="spaceset_file",e.spaceSetBlock="spaceset_block",e.cataFile="cata_file",e.cataBlock="cata_block",e.temp_max="temp_max",e.homepage="homepage",e.order="order",e.members="members",e.bulk_download="bulk_download",e.link_suggest="link_suggest",e.mind_node_limit="mindmap_number",e.anniversary="anniversary",e.importMember="import_member",e.custom_font_layout="font_layout",e.message_board="message_board",e.dashboard_plan="dashboard_plan",e.dashboard_file="dashboard_file",e.dashboard_member="dashboard_member",e.notification_inbox="notification_inbox",e.activity="activity",e.export_watermark="export_watermark",e.capacity_header="capacity_header",e.inbox="inbox",e.new_user_task="new_user_task",e.notification_normal="notification_normal",e.tip="tip",e.page_card="page_card",e))(Vt||{}),Jt=(e=>(e[e.account=0]="account",e[e.integral=1]="integral",e[e.space=2]="space",e[e.spaceInfo=3]="spaceInfo",e[e.members=4]="members",e[e.upgrade=5]="upgrade",e[e.line=6]="line",e[e.order=7]="order",e[e.general=8]="general",e[e.notificationsAndSetting=9]="notificationsAndSetting",e))(Jt||{});const az={$settingState:{open:!1}},u6=No(()=>az),dk=(e,t)=>{u6.setState(n=>(n[e]=t,{...n}))},oz=()=>u6(t=>t.$settingState),Pa=()=>F.useCallback(e=>{dk("$settingState",{open:!0,...e})},[]),Ro=()=>{const e=Pa();return F.useCallback(t=>{e({defaultMenuType:Jt.upgrade,from:t})},[e])},Oa=()=>F.useCallback(()=>{dk("$settingState",{open:!1})},[]);var d6=(e=>(e.FINISH_BASIC_TASK="FINISH_BASIC_TASK",e.NOTIFICATION="NOTIFICATION",e))(d6||{});const iz=({type:e,onCloseModal:t})=>{const n=Pa(),s=()=>{t(),n({defaultMenuType:Jt.integral,from:Vt.new_user_task})};return r.jsxs("div",{className:"next-modal w-[332px] rounded p-[30px]",children:[r.jsxs("div",{className:"text-t1-medium",children:[e==="FINISH_BASIC_TASK"&&r.jsxs(r.Fragment,{children:["👏 从入门到精通，就差这一步！ 恭喜完成 FlowUs 「基础入门」继续挑战",r.jsx("span",{className:"text-active_color",children:"「进阶任务」"})]}),e==="NOTIFICATION"&&r.jsx(r.Fragment,{children:"🤑 新手特惠！ 1元即可升级个人专业版会员！ 限时活动，手慢无！"})]}),r.jsxs("div",{className:"flex items-center mt-[30px]",children:[r.jsx(je,{colorType:"black",onClick:t,className:"border-grey5",children:"自我探索"}),r.jsx(je,{colorType:"active",className:"ml-2.5",onClick:s,children:"马上出发"})]})]})},f6=()=>{const e=me(),t=Pa();return F.useCallback(n=>new Promise(s=>{const a=yg(n);e.modal({closeAfterCallBack:()=>{s(0)},content:({onCloseModal:o})=>r.jsxs("div",{className:"next-modal w-[400px] p-[30px] flex flex-col",children:[r.jsx("p",{className:"text-center text-[70px] leading-[70px]",children:"😀"}),r.jsx("p",{className:"text-t1-medium mt-2.5 text-center",children:"恭喜你"}),r.jsxs("p",{className:"text-t2 text-center mt-2.5",children:["成功解锁首个「新手任务」并获得 ⭐+",a==null?void 0:a.score," 积分 ",r.jsx("br",{}),"（积分可累积抵现兑换个人专业版会员）"]}),r.jsx(je,{colorType:"active",className:"mt-10 flex-1 p-1",onClick:()=>{o(),s(0),t({defaultMenuType:Jt.integral,from:Vt.new_user_task})},children:"解锁更多"})]})})}).catch(s=>{Hp(s)}),[e,t])},lz=()=>{const e=me();return F.useCallback(t=>{const n=Vm();e.dropdown({popcorn:n.popcorn,placement:"top-start",offset:[-50,0],closeAfterCallBack:n.remove,content:({onCloseModal:s})=>r.jsx(iz,{type:t,onCloseModal:s})})},[e])},cz=({resolve:e,onCloseModal:t,taskId:n})=>{var d,f;const[s,a]=F.useState(0),o=yg(n),[i,l]=F.useState(0);if(!o)return null;const c=(d=o.resourceList)!=null?d:[],u=()=>{i<c.length-1?l(i+1):a(2)};if(s===0)return r.jsxs("div",{className:"next-modal w-[360px] rounded p-[30px]",children:[r.jsxs("div",{className:"text-t1-medium",children:["是否一起学习如何更好的使用",r.jsx("br",{}),GT[n]," 功能吗？"]}),r.jsxs("div",{className:"flex items-center mt-[30px]",children:[r.jsx(je,{colorType:"black",onClick:()=>{t(),e(0)},className:"border-grey5",children:"自我探索"}),r.jsx(je,{colorType:"active",className:"ml-2.5",onClick:()=>a(1),children:"马上行动"})]})]});if(s===1){const h=(f=o.resourceList)==null?void 0:f[i];return r.jsxs("div",{className:"next-modal w-[320px] rounded p-[30px]",children:[r.jsx("p",{className:"text-t1-medium",children:GT[n]}),r.jsx("p",{className:"text-t2 mt-1",children:h==null?void 0:h.content}),r.jsx("img",{src:h==null?void 0:h.imgUrl,className:"mt-2.5",alt:""}),r.jsxs("div",{className:"flex items-center mt-[30px]",children:[r.jsx(je,{colorType:"black",onClick:()=>l(i-1),disable:i===0,className:"border-grey5",children:"上一步"}),r.jsx(je,{colorType:"active",className:"ml-2.5",onClick:u,children:i===c.length-1?"完成":"下一步"})]})]})}return r.jsxs("div",{className:"next-modal w-[320px] rounded p-[30px]",children:[r.jsx("p",{className:"text-t1-medium",children:"想要了解更多FlowUs使用方法？"}),r.jsx("p",{className:"text-t2 mt-1",children:"前往「帮助中心」get更多实用小妙招"}),r.jsx("img",{src:"https://cdn.allflow.cn/activity/task/web/help.png ",className:"mt-2.5",alt:""}),r.jsxs("div",{className:"flex items-center mt-[30px]",children:[r.jsx(je,{colorType:"black",onClick:t,className:"border-grey5",children:"稍后了解"}),r.jsx(je,{colorType:"active",className:"ml-2.5",onClick:()=>{t(),window.open(An.helpCenter)},children:"马上出发"})]})]})},uz=()=>{const e=me(),t=f6();return F.useCallback((n,s)=>new Promise(a=>{const o=Vm();e.dropdown({popcorn:o.popcorn,placement:"top-start",offset:[-50,0],closeAfterCallBack:async()=>{o.remove(),s&&await t(n),a(0)},content:({onCloseModal:i})=>r.jsx(cz,{onCloseModal:i,taskId:n,resolve:a})})}).catch(a=>{Hp(a)}),[e,t])};const dz=({taskId:e,resolve:t})=>{const n=yg(e),s=Kt(),[a,o]=F.useState(0),[i,l]=F.useState({right:0,bottom:0});return F.useEffect(()=>{a>0?setTimeout(()=>{s("score-modal"),t(0)},600):Za(1700).then(()=>{var d;const c=document.querySelector(".service-center");if(!c)return;const u=c.getBoundingClientRect();l({right:window.innerWidth-u.left-u.width/2,bottom:window.innerHeight-u.top}),o((d=n==null?void 0:n.score)!=null?d:0)})},[a,n==null?void 0:n.score,s,t]),a>0?r.jsxs("div",{className:"text-t4-medium text-[#FFC408] flex items-center translate-x-1/2 absolute",style:{right:`${i.right}px`,bottom:`${i.bottom}px`},children:[r.jsx("img",{src:Dn.littleMedal,alt:"",className:"w-6"}),"+",a]}):r.jsxs("div",{className:"lazyhidden relative h-[300px] w-[300px] overflow-hidden",children:[r.jsx("img",{className:"fadein absolute left-1/2 h-[100px] w-[100px] -translate-x-1/2 -translate-y-1/2 ",src:Dn.medal}),r.jsx("img",{className:"lazyshow absolute left-1/2 top-1/2 h-[150px] w-[150px] -translate-x-1/2 -translate-y-1/2 ",src:Dn.medalBg})]})},fz=()=>{const e=me();return F.useCallback(t=>new Promise(n=>{e.modal({modalId:"score-modal",closeAfterCallBack:()=>{n(0)},containerClassName:"bg-transparent",className:"shadow-none border-none bg-transparent",content:()=>r.jsx(dz,{taskId:t,resolve:n})})}).catch(n=>{Hp(n)}),[e])},WT=new jo(localStorage,"newUserTaskStorage",50),mz=()=>{const e=me(),t=Pa();return F.useCallback(()=>{const n=Vm();e.dropdown({popcorn:n.popcorn,modalId:"openFirstTaskModal",placement:"top-end",offset:[4,10],autoClose:!1,keyboard:!1,closeAfterCallBack:n.remove,content:({onCloseModal:s})=>r.jsxs("div",{className:"p-7 next-modal rounded-md w-80",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-h3 mb-2.5",children:"成功解锁新任务！"}),r.jsx("div",{className:"text-t1-medium",children:"你已解锁首个新用户专享任务，积分已到手，来看看还有那些任务吧。"})]}),r.jsxs("div",{className:"mt-7 flex items-center",children:[r.jsx(je,{className:"mr-2.5",onClick:()=>s(),children:"稍后了解"}),r.jsx(je,{colorType:"active",onClick:()=>{s(),t({defaultMenuType:Jt.integral,from:Vt.package})},children:"立即查看"})]})]})})},[e,t])},hz=()=>{const e=me(),t=Pa();return F.useCallback(()=>{const n=Vm();e.dropdown({popcorn:n.popcorn,modalId:"openStageTaskModal",placement:"top-end",offset:[4,10],closeAfterCallBack:n.remove,content:({onCloseModal:s})=>r.jsxs("div",{className:"p-7 next-modal rounded-md w-80",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-h3 mb-2.5",children:"完成阶段性任务！"}),r.jsx("div",{className:"text-t1-medium",children:"你已完成阶段性新手任务，再接再厉哦"})]}),r.jsx("div",{className:"mt-7 flex items-center",children:r.jsx(je,{colorType:"active",onClick:()=>{s(),t({defaultMenuType:Jt.integral,from:Vt.package})},children:"查看剩余任务"})})]})})},[e,t])},pz=()=>{const e=me();return F.useCallback(()=>{const t=Vm();e.dropdown({popcorn:t.popcorn,modalId:"openStageTaskModal",placement:"top-end",offset:[4,10],closeAfterCallBack:t.remove,content:()=>r.jsxs("div",{className:"p-7 next-modal rounded-md w-80",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-h3 mb-2.5",children:"完成所有新手任务！"}),r.jsx("div",{className:"text-t1-medium",children:"恭喜！你已完成所有新手任务！"}),r.jsx("div",{className:"text-t1-medium",children:"后续使用过程中若遇到问题，随时点击我查看帮助哦~"})]}),r.jsx("div",{className:"mt-7 flex items-center"})]})})},[e])},zx=()=>{const e=mz(),t=hz(),n=pz();return F.useCallback(async s=>{var l,c,u,d;const{completeListType:a}=s||{},o=!!Uh().basicList.find(f=>f.uuid===Ae.CREATE_NEW_PAGE);if(s!=null&&s.openCompleteModal&&!o){const f=Uh().basicList.every(p=>p.status==="completed"),h=Uh().advancedList.every(p=>p.status==="completed");(f&&h||a===We.advancedList&&h||a===We.basicList&&f)&&(s.openCompleteModal=!1)}const i=await Ce.infra.getActivityList("all","all");if(GU(i),s!=null&&s.openCompleteModal&&!o){const f=((l=i.advancedList)==null?void 0:l.filter(_=>_.status==="completed").length)||0,h=((c=i.basicList)==null?void 0:c.filter(_=>_.status==="completed").length)||0;if(f+h===0)return;if(f+h===1){e();return}const p=f===((u=i.advancedList)==null?void 0:u.length),g=h===((d=i.basicList)==null?void 0:d.length);if((a===We.advancedList&&p||a===We.basicList&&g)&&!(p&&g)){t();return}p&&g&&n()}},[n,e,t])},ks=()=>{const e=zx(),t=uz(),n=lz(),s=fz(),a=f6();return F.useCallback(async(o,i,l)=>{var d,f;const c=yg(o);if(!c||["abandoned","completed"].includes(c.status||""))return;if(tz.has(o)){const h=(d=WT.get(o))!=null?d:{};if(l!=null&&l.step1&&(h.step1=!0),l!=null&&l.step2&&(h.step2=!0),WT.put(o,h),!(h!=null&&h.step1)||!(h!=null&&h.step2))return}if((await Ce.infra.completedActivity.raw(o,{completed:(f=l==null?void 0:l.completed)!=null?f:!0,viewed:!0,createdBy:l==null?void 0:l.createdBy})).code===200){await s(o),$T.has(o)&&await t(o,l==null?void 0:l.isFirstTask),l!=null&&l.isFirstTask&&!$T.has(o)&&await a(o),await e({openCompleteModal:!0,completeListType:i});const h=Uh();h.basicList.every(p=>p.status==="completed")&&h.basicList.find(p=>p.uuid===o)&&h.advancedList.find(p=>p.status!=="completed")&&n(d6.FINISH_BASIC_TASK)}else e()},[e,t,s,a,n])},fk=()=>F.useCallback(async e=>mp(e),[]),mp=async e=>{try{const{extName:t}=sn(e.name);if(cn.image.test(t))return await zw(e);if(cn.video.test(t))return await DS(e)}catch(t){return{}}return{}},J1=e=>{const{percent:t,size:n=20,ringWidth:s=3,className:a,ringColorClassName:o,bgColor:i,ringColor:l}=e,c=Math.min(1,t);return r.jsx("div",{className:B("relative rounded-full border-solid",a),style:{width:n,height:n,borderWidth:s},children:r.jsxs("div",{className:"absolute inset-0",style:{width:n,height:n,top:-s,left:-s,clipPath:c<.5?"inset(0 0 0 50%)":"unset"},children:[r.jsx("div",{className:B("absolute w-full h-full rounded-full border-solid",o),style:{borderWidth:s,borderColor:l,clipPath:"inset(0 50% 0 0)",transform:`rotate(${c<=.5?c/.5*180:180}deg)`}}),c>.5&&r.jsx("div",{className:B("absolute w-full h-full rounded-full border-solid",o),style:{borderWidth:s,clipPath:"inset(0 0 0 50%)",transform:`rotate(${(c-.5)/.5*180}deg)`,borderColor:l}})]})})},m6={"b7c9dd44-0881-41ec-a759-7094ff22b2c8":{id:"b7c9dd44-0881-41ec-a759-7094ff22b2c8",subNodes:["cd87ff03-0ee4-4f7a-8e91-45ccb8290202","38c7a0bb-d4c8-43b7-bbd5-bc83f1f96ec8","2414889b-2926-407a-9f05-04c0b8f9fb67"]},"cd87ff03-0ee4-4f7a-8e91-45ccb8290202":{id:"cd87ff03-0ee4-4f7a-8e91-45ccb8290202",parentId:"b7c9dd44-0881-41ec-a759-7094ff22b2c8",subNodes:["f799091c-afcf-47ab-a7b6-e2d5bb990dcc","0c9f0d66-eee8-472d-a681-84248923ea60","3115bbf6-e96f-41b4-93b0-a859738346ef","8f56d945-2a36-42df-8348-9deca0381124","37a1ee22-aebc-4d2d-9089-ea3ffe2fae09","f18babc4-a068-41be-a10f-c17a6982a605","be2e0d41-ac83-47a5-9884-197d88d8ec1d","2ed6a364-8c33-4a6d-bd94-385029ee562a","3556aa6b-f53a-4ac3-9338-b74cffe8bb2f","fba1d4b7-e7d6-41a6-89a5-f45ab9af6c90","b06459f2-938b-4042-b992-05a8c2c548e7"]},"38c7a0bb-d4c8-43b7-bbd5-bc83f1f96ec8":{id:"38c7a0bb-d4c8-43b7-bbd5-bc83f1f96ec8",parentId:"b7c9dd44-0881-41ec-a759-7094ff22b2c8",subNodes:["6bf4d8f3-7213-4d87-bdd3-5da503caa38b","ea5b4fcd-2ef9-4e85-a908-a2178910812d","d76cde1a-735f-4555-a859-9fee6befef23","a9958a95-afc6-4c35-9e85-c61b3fde6935"]},"2414889b-2926-407a-9f05-04c0b8f9fb67":{id:"2414889b-2926-407a-9f05-04c0b8f9fb67",parentId:"b7c9dd44-0881-41ec-a759-7094ff22b2c8",subNodes:["f1b4c928-e762-469c-9e90-8ffcf723a120","b7c58a5f-b2ab-4379-8171-979e979a50e5","7c01f540-49ce-40bd-bdc4-6f02a5a6ed5f","be5f2ab7-6ab2-4c41-a7ac-04dbb028e1b1"]}},gz=["cd87ff03-0ee4-4f7a-8e91-45ccb8290202","38c7a0bb-d4c8-43b7-bbd5-bc83f1f96ec8","2414889b-2926-407a-9f05-04c0b8f9fb67"],_z=["🏄🏻‍♂️","👀","💻"],xz=()=>{const e=Oj();return F.useMemo(()=>Fz(e),[e])},Fz=e=>gz.map(t=>e[t]).filter(t=>!!t).map((t,n)=>{var i,l;const{uuid:s=""}=t,a=((l=(i=m6[s])==null?void 0:i.subNodes)!=null?l:[]).map(c=>e[c]).filter(c=>!!c),o=a.filter(c=>c.status==="completed");return{...t,icon:_z[n],progress:o.length/a.length}}),yz=e=>{var s;const t=Oj(),n=(s=m6[e])==null?void 0:s.subNodes;return n?n.map(a=>t[a]).filter(a=>!!a):[]},bz=()=>F.useCallback(e=>{Ce.infra.completedActivity.raw(e,{completed:!0,viewed:!0}),zU({uuid:e,patch:{status:"completed",viewed:!0}})},[]),KT={"6bf4d8f3-7213-4d87-bdd3-5da503caa38b":"查看页面","ea5b4fcd-2ef9-4e85-a908-a2178910812d":"查看页面","d76cde1a-735f-4555-a859-9fee6befef23":"查看页面","a9958a95-afc6-4c35-9e85-c61b3fde6935":"查看页面","f1b4c928-e762-469c-9e90-8ffcf723a120":"去登录","b7c58a5f-b2ab-4379-8171-979e979a50e5":"去登录","7c01f540-49ce-40bd-bdc4-6f02a5a6ed5f":"去登录","be5f2ab7-6ab2-4c41-a7ac-04dbb028e1b1":"去微信绑定"},fa=(e,t=2)=>String((e*100).toFixed(t)).concat("%"),bg=e=>{var s,a;const t=(s=e.split("%")[0])!=null?s:"";if(!t)return 0;const n=Math.pow(10,((a=t.split(".")[1])!=null?a:"").length);return Number(t)*n/(100*n)},YT=e=>String(e).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),h6=e=>/^[-0-9+() ]+$/.test(`${e}`),mk=e=>{const t=e.toString(),n=t.lastIndexOf("."),s=t.length-n-1;if(n>=0&&s>=10){const a=Math.max(10,s-6),o=Math.pow(10,a),i=`${Math.round(e*o)/o}`;return t.length-i.length>=s-12&&t.length-i.length>=4?i:`${Math.round(e*1e12)/1e12}`}return p6(Number(t))},p6=e=>{const t=e.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);if(!t)return`${e}`;const n=Number(t[2])||0;return Math.abs(n)>20?`${e}`:e.toFixed(Math.max(0,(t[1]||"").length-n))},Ez=({parentId:e})=>{var f,h,p;const t=yz(e),n=me(),s=WU(e),[a,o]=F.useState(t[0]),i=bz(),l=g=>{if(!(a!=null&&a.uuid))return;const{uuid:_,link:x}=a;(_===Ae.WRITE_BLOG||_===Ae.PLAN||_===Ae.WIKI||_===Ae.CREATE_SITE)&&window.open(x),(_===Ae.LOGIN_IN_ANDROID_OR_IOS||_===Ae.LOGIN_IN_MAC_OR_WINDOWS)&&window.open(An.appDownload),_===Ae.LOGIN_IN_FLOWUS&&window.open(Mt),_===Ae.USE_WECHAT_CLIP&&n.dropdown({popcorn:g.currentTarget,placement:"top",offset:[0,10],content:()=>r.jsx("img",{src:Dn.bindWechatClip,className:"w-[120px] h-[120px] p-1 rounded bg-white1",style:{boxShadow:"0px 12px 20px rgba(0, 0, 0, 0.16)"}})})};F.useEffect(()=>{(a==null?void 0:a.status)!=="completed"&&((a==null?void 0:a.uuid)===Ae.LOGIN_IN_ANDROID_OR_IOS||(a==null?void 0:a.uuid)===Ae.LOGIN_IN_MAC_OR_WINDOWS||(a==null?void 0:a.uuid)===Ae.LOGIN_IN_FLOWUS||a!=null&&a.uuid&&i(a.uuid))},[a==null?void 0:a.status,a==null?void 0:a.uuid,i]);const{imgUrl:c,videoUrl:u}=(h=(f=a==null?void 0:a.resourceList)==null?void 0:f[0])!=null?h:{},d=(p=a==null?void 0:a.uuid)!=null?p:"";return r.jsxs("div",{className:"next-modal w-[960px]",children:[r.jsx("div",{className:"flex items-center h-[80px] pl-[30px] border-b",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h2",{className:"text-t1-medium flex items-center",children:s==null?void 0:s.name}),r.jsx("p",{className:"text-t2 text-grey3 mt-0.5",children:a==null?void 0:a.synopsis})]})}),r.jsxs("div",{className:"py-2.5 min-h-[440px] flex ",children:[r.jsx("div",{className:"w-[240px]",children:t.map(g=>{const{uuid:_="",name:x,status:y}=g;return r.jsx("div",{className:"px-2 h-10",children:r.jsxs("div",{onClick:()=>o(g),className:B("flex items-center h-full rounded animate-hover-black3 pl-[42px] relative",d===_&&"bg-black_006"),children:[y==="completed"&&r.jsx(H,{name:"IcCircleCheck",size:"middle",className:"absolute left-5 top-2.5 text-active_color"}),r.jsx("span",{className:"text-t2-medium text-grey2",children:x})]})},_)})}),r.jsxs("div",{className:"pt-4 px-[60px]",children:[c&&r.jsx("img",{src:c,className:"width-600 h-[338px] border rounded-md"}),u&&r.jsx("video",{src:u,autoPlay:!0,className:"width-600 h-[338px] border rounded-md"}),KT[d]&&r.jsxs("div",{className:"flex items-center mt-4",children:[r.jsx(je,{colorType:"active",onClick:l,children:KT[d]}),(a==null?void 0:a.uuid)===Ae.LOGIN_IN_MAC_OR_WINDOWS&&r.jsx("p",{className:"text-t3 text-grey3 ml-2",children:"完成任意 FlowUs 电脑端 App 登录"}),(a==null?void 0:a.uuid)===Ae.LOGIN_IN_ANDROID_OR_IOS&&r.jsx("p",{className:"text-t3 text-grey3 ml-2",children:"完成任意 FlowUs 移动端 App 登录"}),(a==null?void 0:a.uuid)===Ae.LOGIN_IN_FLOWUS&&r.jsx("p",{className:"text-t3 text-grey3 ml-2",children:"完成 FlowUs 桌面端登录"})]})]})]})]})},wz=({onCloseModal:e})=>{const t=me(),n=xz(),s=o=>{t.modal({content:()=>r.jsx(Ez,{parentId:o})})},a=n.filter(o=>o.progress===1).length;return r.jsxs("div",{className:"next-modal w-[960px] h-[478px]",children:[r.jsx("div",{className:"flex items-center h-[80px] pl-[30px] border-b",children:r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"text-t1",children:"👏"}),r.jsxs("div",{className:"flex flex-col ml-2",children:[r.jsxs("h2",{className:"text-t1-medium flex items-center",children:["新手入门",r.jsxs("span",{className:"text-t4 text-grey3 ml-2",children:[a,"/",n.length,"已完成"]})]}),r.jsx("p",{className:"text-t4 text-grey3 mt-0.5",children:a===n.length?"我们将在这里向你介绍探索 FlowUs 所需要的基本知识。":"简单几步，个人版存储空间免费扩容 200MB->2GB。"})]})]})}),r.jsx("div",{className:"bg-grey9 h-1 relative",children:r.jsx("div",{className:"bg-active_color absolute top-0 left-0 h-full",style:{width:fa(a/n.length)}})}),r.jsx("div",{className:"flex justify-between px-[30px] mt-10",children:n.map((o,i)=>{var p,g,_;const{uuid:l="",resourceList:c,name:u,synopsis:d}=o,f=(g=(p=n[i])==null?void 0:p.progress)!=null?g:0,{imgUrl:h}=(_=c==null?void 0:c[0])!=null?_:{};return r.jsxs("div",{className:"flex flex-col w-[284px] h-[303px] cursor-pointer",onClick:()=>s(l!=null?l:""),children:[r.jsx("img",{src:h,className:"h-[160px] rounded-md",style:{boxShadow:"0px 1px 3px var(--black_006)"}}),r.jsx("p",{className:"text-t1-medium mt-5",children:u}),r.jsx("p",{className:"mt-1 text-t3 text-grey3 w-full",children:d}),r.jsxs("div",{className:"flex mt-auto justify-between items-center",children:[f===1?r.jsx(je,{colorType:"secondary",className:"border-grey5",children:"重新开始"}):r.jsx(je,{colorType:"active",children:"开始"}),f>0&&r.jsx(J1,{percent:f,className:"border-grey9",ringColorClassName:"border-active_color"})]})]},l)})})]})},hk=()=>{const e=me();return F.useCallback(()=>{e.modal({content:({onCloseModal:t})=>r.jsx(wz,{onCloseModal:t})})},[e])},Gy=new Map;function es(e=0,t=1){const n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(e===0)return"0B";const{value:s,index:a}=kz(e,t);return`${s}${n[a]}`}function kz(e=0,t=1){const n=`${e}-${t}`;if(Gy.has(n))return Gy.get(n);if(e===0)return{value:0,index:0};let s=0,a=Math.max(1,e);for(;a>1024;)a=a/1024,s++;const o={value:Number(a.toFixed(t).replace(/\.0+$/,"")),index:s};return Gy.set(n,o),o}const g6=()=>{const{uuid:e}=Qt();return!!e},Jc=()=>{const e=me(),t=Rm(Xe.SINGLE_CAPACITY),n=Ro(),s=g6(),a=hk();return F.useCallback(o=>{const{title:i,maxCapacity:l,singleFile:c,planType:u=Tn().planType,readonly:d,isNovice:f,spaceId:h}=o;if(t)return;const p=es(l,0),g=s&&!d&&u!==Et.personal,_=`当前为${cr(u)}空间`,x=`${_}，单文件大小上限为${p}。`,y=`${_}，总容量为${p}，如需提升上限，请升级空间。`;let b=c?x:y;if(f&&g&&u==="freePersonal"){ce.event("storage_unlock_show"),e.warning({modalId:Xe.SINGLE_CAPACITY,title:"超过空间存储上限制200MB",colorType:"secondary",noCancel:!0,confirmText:"之后再说",content:r.jsxs("div",{className:"mb-5",children:[r.jsxs("div",{className:"text-t2 ",children:[r.jsx("div",{children:"1.简单几步，免费扩容至2GB"}),r.jsx("div",{className:"cursor-pointer text-active_color shrink-0",onClick:()=>{if(ce.event("go_new_user_task"),ht()&&h){const k=new URLSearchParams(window.location.search);k.set(ms.openDialog,"tutorial"),window.location.href=`${window.origin}?${k.toString()}`}else a()},children:"去做任务"})]}),r.jsxs("div",{className:"text-t2",children:[r.jsx("div",{children:"2.升级至个人专业版，扩容至200GB"}),r.jsx("div",{className:"cursor-pointer text-active_color shrink-0",onClick:()=>{if(ce.event("go_upgrade"),ht()&&h){const k=new URLSearchParams(window.location.search);k.set(ms.spaceId,h),k.set(ms.openDialog,"upgrade"),window.location.href=`${window.origin}?${k.toString()}`}else n(Vt.file)},children:"立即升级"})]})]})});return}const E=g?"升级扩容":"知道了";f&&(c?b=`新手期单文件大小上限为${p}，做任务解锁免费容量，或立即升级空间。`:b="新手期存储容量已达上限，做任务解锁免费容量，或立即升级空间。"),ce.event("single_files_show");const w={modalId:Xe.SINGLE_CAPACITY,title:r.jsxs("div",{className:"mb-5",children:[r.jsx("p",{className:"text-t1-medium mb-2.5",children:i}),r.jsx("p",{className:"text-t2",children:b})]}),colorType:"active",confirmText:E,confirm:()=>{g&&n(Vt.file)}};if(f&&g){e.warning({...w,cancelText:"解锁免费容量",cancel:()=>{a()}});return}e.warning({...w})},[t,s,e,a,n])},_6=()=>{const e=Jc(),t=uk();return F.useCallback(async n=>{const s=qe(),{spaceId:a,isDatabase:o,fileSize:i,onComplete:l,key:c,fileName:u,inTransferList:d,blockId:f,pageId:h}=n,{singleFileMaxSize:p,maxCapacity:g,currentCapacity:_,isNovice:x}=Mm(a,{isDatabase:o});let{planType:y}=Tn();if(a!==Tn().uuid){const w=await t(a);y=w==null?void 0:w.planType}const b=i>p,E=_+i>g;return E||b?(E?e({title:"有文件上传失败",maxCapacity:g,planType:y,isNovice:x}):b&&e({title:"有文件上传失败",maxCapacity:p,singleFile:!0,planType:y,isNovice:x}),cl({name:u,size:i,key:c!=null?c:"",inTransferList:d,progress:-1,blockId:f,pageId:h,status:Yn.failure,uploadId:s}),l==null||l({success:!1,errCode:Xs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT,errMsg:""}),!1):!0},[t,e])},pk=new Map,Cz=(e,t)=>{pk.set(e,t)},Tz=e=>{pk.delete(e)},K0e=e=>{if(e)return pk.get(e)},gk=new Map,vz=(e,t)=>{gk.set(e,t)},Y0e=e=>{if(!e)return;const t=gk.get(e);if(t){if(t.expireTime>Date.now())return t.url;Nz(e)}},Nz=e=>{gk.delete(e)};HG({request:Ce,ossCallbackHost:{}.VITE_OSS_CALLBACK_PREFIX||`http://${window.location.host}`,onError:e=>{Hp(e)}});const Iz=e=>{e&&cl({key:e,progress:-1,status:Yn.failure})},x6=()=>{const e=Jc();return F.useCallback((t,n)=>{const{key:s,singleFileMaxSize:a,planType:o,maxCapacity:i,isNovice:l}=n;if(t.errCode===Xs.UPLOAD_SINGLE_FILE_CAPACITY_LIMIT)e({title:"上传失败",maxCapacity:a,singleFile:!0,planType:o,isNovice:l});else if(t.errCode===Xs.UPLOAD_MAX_CAPACITY_LIMIT)e({title:"上传失败",maxCapacity:i,planType:o,isNovice:l});else if(t.errCode===Xs.UPLOAD_CANCEL){ye.success("已取消"),s&&Mw(s);return}else ye.error(t.errMsg);Iz(s)},[e])},Ma=()=>{const e=ks(),t=fi(),n=uk(),s=_6(),a=x6(),o=gt();return F.useCallback(async i=>{var v,I,j;const{onCapacitySuccess:l,onComplete:c,onProgress:u,handleFail:d,userId:f=K.user.uuid,spaceId:h=Ut(),key:p,isDatabase:g,inTransferList:_,blockId:x,...y}=i;try{BG(h)||await t(h)}catch(D){return cl({name:i.file.name,size:i.file.size,key:p!=null?p:"",progress:-1,inTransferList:_,blockId:x,pageId:(v=i.pageId)!=null?v:o,status:Yn.failure,uploadId:""}),c==null||c({success:!1,errCode:Xs.UPLOAD_FAILED,errMsg:""}),""}let{planType:b}=Tn();if(h!==Tn().uuid){const D=await n(h);b=D==null?void 0:D.planType}const{singleFileMaxSize:E,maxCapacity:w,isNovice:k}=Mm(h,{isDatabase:g});if(!await s({fileName:i.file.name,fileSize:i.file.size,key:p,inTransferList:_,blockId:x,pageId:(I=i.pageId)!=null?I:o,onComplete:c,spaceId:h,isDatabase:g}))return"";const T=Fg.upload({...y,isDatabase:g,spaceId:h,userId:f,onCapacitySuccess:l,onProgress:D=>{u==null||u(D),p&&cl({key:p,progress:D,status:Yn.uploading})},onComplete:D=>{var S,R;if(c==null||c(D),D.success){_&&(D.url&&vz(T,{expireTime:(S=D.expireTime)!=null?S:Date.now()+1.5*60*uw,url:D.url}),Tz(T)),p&&cl({key:p,progress:100,inTransferList:_,blockId:x,pageId:(R=i.pageId)!=null?R:o,status:Yn.success,url:D.url}),e(Ae.GUIDE_FIRST_TIME_UPLOAD,We.basicList),e(Ae.GUIDE_FIRST_TIME_CREATED_FOLDER,We.basicList);return}d!=null&&d(D)||a(D,{maxCapacity:w,planType:b,singleFileMaxSize:E,key:p,isNovice:k})}});return p&&cl({key:p,progress:0,name:i.file.name,createdAt:Date.now(),uploadId:T,inTransferList:_,blockId:x,pageId:(j=i.pageId)!=null?j:o,size:i.file.size,status:Yn.uploading}),_&&Cz(T,i),T},[t,n,o,e,s,a])},jz=()=>{const e=uk(),t=_6(),n=x6(),s=fi();return F.useCallback(async a=>{const o=await e(a.spaceId);if(!o)return"";await s(a.spaceId);const{onCapacitySuccess:i,onComplete:l,onProgress:c,handleFail:u,key:d,...f}=a,{planType:h}=o,{singleFileMaxSize:p,maxCapacity:g,isNovice:_}=Mm(o.uuid,{isDatabase:a.isDatabase});if(!await t({fileName:a.file.name,fileSize:a.file.size,key:d,inTransferList:a.inTransferList,onComplete:l,spaceId:a.spaceId,isDatabase:a.isDatabase}))return"";const y=Fg.uploadWithoutLogin({...f,singleFileMaxCapacity:p,onCapacitySuccess:i,onProgress:b=>{c==null||c(b),d&&cl({key:d,progress:b,status:Yn.uploading})},onComplete:b=>{if(l==null||l(b),b.success){b.url&&b.expireTime&&Ls.putCache(b.ossName,b.url,b.expireTime),d&&cl({key:d,progress:100,status:Yn.success,url:b.url});return}u!=null&&u(b)||n(b,{maxCapacity:g,planType:h,singleFileMaxSize:p,key:d,isNovice:_})}});return d&&cl({key:d,progress:0,name:a.file.name,createdAt:Date.now(),uploadId:y,size:a.file.size,status:Yn.uploading}),y},[s,e,t,n])},F6=()=>{const e=fi(),t=Jc(),n=Ma(),s=ke(),a=fk();return F.useCallback(async(o,i)=>{const{files:l,onComplete:c,ownerPageId:u,onCapacitySuccess:d,...f}=o,h=w=>{if(!i)return w;const k={parentId:w.parentId};if(i){const{dropId:C,position:T}=i;if(C){const v=K.blocks[C];if(v){const I=K.blocks[v.parentId];(I==null?void 0:I.type)===m.BlockType.COLUMN_LIST?k.parentId=u:k.parentId=v.parentId}}T==="bottom"||T==="right"?k.after=C:(T==="top"||T==="left")&&(k.before=C)}return k};let p=d;const g=(w,k,C)=>{const{extName:T}=sn(k.name),v={segments:mt(k.name),size:k.size,extName:T,display:C$(T),localUrl:tw.includes(T)?void 0:URL.createObjectURL(k)};if(i)s(()=>{const I=Qe({type:m.BlockType.FILE,data:v,updatedAt:Date.now()},C);n({...f,pageId:w,blockId:I,key:`${w}_${I}`,file:k,onCapacitySuccess:p,async onComplete(j){if(c(j),j.success){j.url&&j.expireTime&&Ls.putCache(j.ossName,j.url,j.expireTime);const D=await a(k);pe(I,{data:{ossName:j.ossName,...D}}),ee(Er())}}})});else{const I=qe();n({...f,pageId:w,blockId:I,key:`${w}_${I}`,file:k,onCapacitySuccess:p,async onComplete(j){if(c(j),j.success){j.url&&j.expireTime&&Ls.putCache(j.ossName,j.url,j.expireTime);const D=await a(k);s(()=>{Qe({uuid:I,type:m.BlockType.FILE,data:{...v,ossName:j.ossName,...D},updatedAt:Date.now()},C)})}}})}};if(l.length===1){g(u,l[0],h({parentId:u,first:!0}));return}const _=await e(Ut()),x=l.reduce((w,k)=>w+k.size,0);if(_.currentCapacity+x>_.maxCapacity){t({title:"有文件上传失败",maxCapacity:_.maxCapacity,isNovice:_.isNovice});return}const y=ZG(l);if(!y)return;p=void 0,d==null||d();const b=(w,k,C,T=!1)=>{k.name&&s(()=>{w=Qe({type:m.BlockType.FOLDER,data:{segments:mt(k.name)}},C),k.blockId=w,T&&(C.parentId=w)},{noThrottle:!0}),k.files.forEach(v=>{g(w,v,T?C:{parentId:w,first:!0})});for(const v of k.folders)b(w,v,T?C:{parentId:w,last:!0});return k.blockId},E=h({parentId:u,last:!0});return b(E.parentId,y,E,!0)},[e,a,t,s,n])},Dz=()=>{const e=fi(),t=Jc(),n=Ma();return F.useCallback(async s=>{const{files:a,onComplete:o,onCapacitySuccess:i,keys:l,blockIds:c,...u}=s;let d=i;const f=(g,_,x)=>{n({...u,blockId:x,key:g,file:_,onCapacitySuccess:d,async onComplete(y){y.success?(y.url&&y.expireTime&&Ls.putCache(y.ossName,y.url,y.expireTime),o({...y,key:g})):o(y)}})};if(a.length===1){f(l[0],a[0],c[0]);return}const h=await e(Ut()),p=a.reduce((g,_)=>g+_.size,0);if(h.currentCapacity+p>h.maxCapacity){t({title:"有文件上传失败",maxCapacity:h.maxCapacity,isNovice:h.isNovice});return}if(a.length!==l.length)throw Error("files length is not equal fileBlockId length");d=void 0,i==null||i(),a.forEach((g,_)=>{f(l[_],g,c[_])})},[e,t,n])};function Sz(e){const t=[];return F.Children.toArray(e).forEach(n=>{zt.isValidElement(n)&&t.push({key:n.key,...n.props,node:n})}),t}const $d=({className:e,children:t,defaultActiveIndex:n=0,customButtons:s,onChangeTab:a,active:o,displayMode:i="lazyLoad",style:l,border:c=!0})=>{var g;const[u,d]=F.useState(n),f=F.useRef(null),h=F.useRef(new Set([u]));F.useEffect(()=>{o!==void 0&&d(o)},[o]);const p=Sz(t);return h.current.add(u),r.jsxs("div",{className:e,style:l,"data-no-cancel-selected":!0,children:[r.jsxs("div",{ref:f,className:B("h-[50px] flex py-2.5 justify-between",{"border-b border-grey6 ":c}),children:[r.jsx("span",{className:"flex items-center",children:p.map((_,x)=>{var y;return F.createElement("span",{..._,...bn(_.title),key:(y=_.key)!=null?y:x,onClick:()=>{d(x),a==null||a(x)},className:B("text-t2 py-1 px-2 mx-2 rounded-sm",u===x?"bg-black_006 cursor-pointer":"animate-hover")},_.icon&&r.jsx(H,{name:_.icon,className:"mr-1"}),_.title)})}),s==null?void 0:s()]}),i==="singleNode"&&((g=p[u])==null?void 0:g.node),i!=="singleNode"&&p.map((_,x)=>h.current.has(x)||i==="preview"?r.jsx("div",{className:B({hidden:x!==u}),children:_.node},_.key||x):null)]})},Zs=({children:e})=>r.jsx(r.Fragment,{children:e}),Rz=e=>e.trim()?!0:(ye.warning("链接不能为空"),!1),_k=e=>{var a;const{validate:t=Rz}=e,[n,s]=F.useState((a=e.defaultValue)!=null?a:"");return r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx(xt,{autoFocus:!e.defaultValue,defaultValue:e.defaultValue,className:"h-8 rounded-sm mt-4 w-[calc(100%-20px)]",placeholder:e.placeholder,onChange:s,onEnter:()=>{n&&t(n)&&e.onInputUrl(n)}}),r.jsx(je,{disable:!n,size:"large",colorType:"active",className:"mt-4 text-t4-medium w-[300px] mb-4",onClick:()=>{t(n)&&e.onInputUrl(n)},style:{transform:"translateX(50%) translate(-150px)"},children:"提交"})]})},Az=({desc:e,style:t})=>r.jsxs("div",{className:"flex flex-col items-center pointer-events-none relative",style:{...t,top:"calc(50% - 116px + 50px)"},children:[r.jsx("div",{className:"text-[70px] leading-[80px]",children:"👀"}),r.jsx("div",{className:"text-grey4 text-t1",children:e})]}),v2=e=>{const{url:t,description:n,onClick:s,illegal:a,node:o}=e;return a?r.jsx("div",{className:"flex relative w-[24%] mx-[0.5%] h-20 mb-2 overflow-hidden text-t4 text-grey3 bg-grey6 p-2",children:"图片无法查看"}):r.jsxs(Fe,{equalWidth:!0,popupClass:"whitespace-pre-wrap w-full break-words line-clamp-none",placement:"bottom",popup:n,offset:[-1,8],className:B("relative w-[24%] mx-[0.5%] overflow-hidden cursor-pointer flex flex-col mb-2",o?"h-[104px]":"h-20"),children:[r.jsx("img",{alt:n,src:t,onClick:s,className:"object-cover w-full h-20 transition rounded cursor-pointer hover:brightness-[0.8]"}),o]},n)},Bz=e=>{const{imageList:t,hasMore:n,onSelect:s,customFooter:a,loadMore:o=()=>{},style:i}=e,l=F.useRef(null);return r.jsxs("div",{ref:l,className:"px-3 py-1 h-[35vh] overflow-y-auto",style:i,children:[r.jsx(Il,{pageStart:1,initialLoad:!0,useWindow:!1,loadMore:o,getScrollParent:()=>l.current,hasMore:n,className:"flex flex-wrap",children:t.map((c,u)=>{let{url:d}=c;if(d&&d.includes("?token=")){const[f]=d.split("?token="),{extName:h}=sn(f);Rd.test(h)&&(d=`${d}&img_process=/resize,w_640/quality,q_80/`)}return r.jsx(v2,{description:c.fileName,url:d,illegal:c.illegal,onClick:()=>{c.illegal?ye.error("图片无法使用"):s(u)}},`${c.url}${u}`)})}),a]})},os=F.forwardRef(({fixed:e,size:t,style:n,className:s,description:a},o)=>r.jsx("div",{ref:o,className:B("flex items-center justify-center h-full w-full overflow-hidden",e&&"fixed top-0 right-0 z-50 bg-white1 w-screen h-screen",s),style:n,children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx(hs,{size:t}),a&&r.jsx("div",{className:"text-t2 mt-2.5",children:a})]})})),Lz=e=>{const t=F.useRef({async search(c,u,d){var h;return(h=(await Ce.editor.querySpaceRecentlyImages(Ut(),e.fileType,c,d)).list)!=null?h:[]},async convert(c){return c.map(u=>{var d;return{url:u.url,ossName:u.ossName,fileName:(d=u.description)!=null?d:""}})},canSearchWithEmpty:!0}),{firstTime:n,resultList:s,loading:a,hasMore:o,search:i}=FD(t.current),l=c=>{i(c,"")};return F.useEffect(()=>{i(1,"")},[]),n?r.jsx(os,{style:e.style}):r.jsx(Bz,{onSelect:c=>{var d;const u=s[c];u&&u.ossName&&((d=e.onSelect)==null||d.call(e,u))},imageList:s,hasMore:o,loadMore:l,style:e.style,customFooter:r.jsxs(r.Fragment,{children:[s.length===0&&r.jsx(Az,{desc:"最近未上传过图片",style:e.style}),a&&o&&r.jsxs("div",{className:"relative flex flex-col items-center justify-center",children:[r.jsx(hs,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"加载更多..."})]})]})})},xk=e=>{const{singleFile:t=!1,labelClassName:n="w-[300px]"}=e,s=a=>{var i;const o=a.target.files;o&&((i=e.onSelect)==null||i.call(e,Array.from(o)))};return r.jsx("div",{className:"flex justify-center items-center h-[62px] w-[full]",style:e.style,children:r.jsxs("label",{className:Yt("h-8 w-full",n),children:[r.jsx("div",{className:"flex justify-center items-center text-t4-medium rounded active:opacity-50 text-align-center h-8 px-3.5 bg-active_color text-white hover:bg-active_color/90 cursor-pointer",children:e.title||"请选择一个文件"}),r.jsx("input",{type:"file",multiple:!t,...e.inputAttribute,className:"hidden",onChange:s})]})})},y6=e=>{const{showRecently:t=!0}=e;return r.jsxs("div",{className:"pb-1",children:[r.jsx(xk,{singleFile:!0,title:"请选择一张图片",inputAttribute:{accept:"image/*"},onSelect:n=>{var a;const s=n[0];s&&((a=e.onUploadFile)==null||a.call(e,s))},style:{height:"37px",marginTop:"15px"}}),r.jsx("span",{className:"text-t4 text-grey3 flex justify-center mt-2",children:e.tip}),t&&r.jsx("div",{className:"px-3 py-1 text-t2 text-grey3 mt-3",children:"最近上传"}),t&&r.jsx(Lz,{onSelect:e.onSelectImage,fileType:e.fileType,style:e.style})]})},Pz=0,Fk=e=>{const t=me(),n=F.useRef(!0),[s,a]=F.useState(0),{showRecently:o=!0}=e;return r.jsxs($d,{onChangeTab:a,className:Yt("next-modal h-[426px] w-[418px]",{"overflow-scroll":s===2}),customButtons:()=>r.jsxs("div",{className:"mr-2 flex",children:[s===Pz&&r.jsxs("div",{className:"animate-hover cursor-pointer items-center rounded py-1.5 px-1",style:{display:e.hideRandom?"none":"flex"},onClick:()=>{const i=Ex(n.current);n.current=!1,e.onSelectEmoji&&e.onSelectEmoji(i,!0)},children:[r.jsx(H,{size:"middle",name:"MIcEmojiRandom"}),r.jsx("div",{className:"text-t2 text-grey3",children:"随机选择"})]}),r.jsxs("div",{className:"animate-hover ml-3 cursor-pointer items-center rounded py-1.5 px-1",style:{display:e.hideRemoveBtn?"none":"flex"},onClick:e.onRemoveBtnClick,children:[r.jsx(H,{size:"middle",name:"MIcClear"}),r.jsx("div",{className:"text-t2 text-grey3",children:"清除"})]})]}),children:[r.jsx(Zs,{title:"Emoji",children:r.jsx(g2,{useButton:!0,onSelect:(i,l,c)=>{if(!c&&l&&i.skin)return t.dropdown({popcorn:l.currentTarget,placement:"bottom",content:({onCloseModal:u})=>r.jsx(_2,{emoji:i,onSelect:d=>{e.onSelectEmoji&&(u(),e.onSelectEmoji(d.native),$u.add(d))}})}),!0;e.onSelectEmoji&&i.native&&e.onSelectEmoji(i.native)}})}),r.jsx(Zs,{title:"Icons",children:r.jsx(g2,{emojiSize:20,useCustomIcon:!0,useButton:!0,onSelect:(i,l,c)=>{if(!c&&l&&i.skin)return t.dropdown({popcorn:l.currentTarget,placement:"bottom",content:({onCloseModal:u})=>r.jsx(_2,{emoji:i,onSelect:d=>{e.onSelectEmoji&&(u(),e.onSelectEmoji(d.native),$u.add(d))}})}),!0;e.onSelectEmoji&&!i.imgPath&&e.onSelectEmoji(i.native),e.onSelectCustomIcon&&i.imgPath&&e.onSelectCustomIcon(i.imgPath)}})}),r.jsx(Zs,{title:"上传",children:r.jsx(y6,{tip:"建议上传 280 x 280 像素的图片",showRecently:o,onSelectImage:e.onSelectRecentlyImage,fileType:"icon",onUploadFile:e.onUploadFile,style:{height:"283px"}})}),r.jsx(Zs,{title:"链接",children:r.jsx(_k,{defaultValue:e.inputValue,placeholder:"输入图标链接",onInputUrl:i=>{var l;return(l=e.onInputUrl)==null?void 0:l.call(e,i)}})})]})},Oz=(e,t={})=>{const n=F.useRef(t);n.current=t;const s=ke(),a=me(),o=Ma(),i=ae(l=>{var u;const c=l.blocks[e];if(((u=c==null?void 0:c.data.icon)==null?void 0:u.type)==="http")return c.data.icon.value});return F.useEffect(()=>()=>{c6(le().blocks[e])}),F.useCallback(l=>{const c=n.current;l.preventDefault(),l.stopPropagation();const d=(c.popcorn||l.currentTarget).getBoundingClientRect(),f=p=>{pe(e,{data:{icon:{type:"upload",value:""},iconUrl:URL.createObjectURL(p)}},!0),ye.loading({key:Fc.UPLOAD_ICON,content:"上传中..."}),o({file:p,type:"file",searchType:"icon",onComplete:g=>{ye.closeMessage(Fc.UPLOAD_ICON),g.success&&(ye.success("更换成功"),s(()=>{var _;pe(e,{data:{icon:{type:"upload",value:(_=g.ossName)!=null?_:""}}})}))}})},h=p=>{s(()=>{pe(e,{data:{icon:{type:"upload",value:p.ossName},iconUrl:p.url}})})};a.dropdown({popcorn:{getBoundingClientRect:()=>d},placement:c.placement||"bottom",modifiers:c.modifiers,offset:c.offset,content:({onCloseModal:p})=>r.jsx(Fk,{onSelectCustomIcon:(g,_)=>{_||p(),s(()=>{pe(e,{data:{icon:{type:"icon",value:g},iconUrl:""}})})},onSelectEmoji:(g,_)=>{var x;_||p(),(x=c.onSelectEmoji)==null||x.call(c,g),s(()=>{pe(e,{data:{icon:{type:"emoji",value:g},iconUrl:""}})})},onUploadFile:g=>{if(g.size>=20*1024*1024){ye.error("不支持超过20M的图标");return}p(),f(g)},onSelectRecentlyImage:g=>{p(),h(g)},hideRemoveBtn:c.hideRemoveBtn,onRemoveBtnClick:()=>{s(()=>{pe(e,{data:{icon:{},iconUrl:void 0}})}),p()},inputValue:i,onInputUrl:g=>{s(()=>{pe(e,{data:{icon:{type:"http",value:g},iconUrl:g}})}),p()}})})},[e,i,a,s,o])},tn=e=>{const{illegal:t}=it(e.blockId),n=Ve(e.blockId),s=r.jsx($s,{hasOverlay:e.hasOverlay,disableHover:!0,className:e.className,iconSize:e.iconSize,emojiStr:e.defaultEmoji,defaultIcon:e.defaultIcon}),a=e.trigger===!1||n;return t?s:r.jsx(F.Suspense,{fallback:s,children:a?r.jsx(b6,{...e,className:B(e.className,e.tooltipClassName)}):r.jsx(Mz,{...e})})},Mz=e=>{const t=Oz(e.blockId,e);return r.jsx(Fe,{popup:"更换图标",className:B("inline-flex flex-shrink-0",e.tooltipClassName),children:r.jsx(b6,{...e,onClick:t})})},b6=e=>{const t=Lr(),n=ae(({blocks:a})=>{var o;return(o=a[e.blockId])==null?void 0:o.data.icon}),s=e.onClick==null;return(n==null?void 0:n.type)==="http"&&n.value!=null?r.jsx(T2,{onClick:e.onClick,trigger:!s,src:n.value,className:e.className,emojiSize:e.iconSize,hasOverlay:e.hasOverlay}):(n==null?void 0:n.type)==="upload"&&n.value!=null?r.jsx(qG,{onClick:e.onClick,trigger:!s,blockId:e.blockId,ossName:n.value,className:e.className,emojiSize:e.iconSize,hasOverlay:e.hasOverlay}):(n==null?void 0:n.type)==="icon"&&n.value?r.jsx(T2,{onClick:e.onClick,trigger:!s,src:sw(t,n.value),className:e.className,emojiSize:e.iconSize,hasOverlay:e.hasOverlay}):r.jsx($s,{onClick:e.onClick,hasOverlay:e.hasOverlay,disableHover:s,className:e.className,iconSize:e.iconSize,emojiStr:((n==null?void 0:n.type)==="emoji"?n.value:"")||e.defaultEmoji,defaultIcon:e.defaultIcon})},E6=(e="",t)=>qr(e).mix(qr("black"),t).hex(),hp=function(e){if(XD)return;const t=document.createElement("link"),n=document.getElementById("dynamic-favicon");t.id="dynamic-favicon",t.rel="shortcut icon",t.href=e,n&&document.head.removeChild(n),document.head.appendChild(t)},XT=(e,t)=>{const n=e.getContext("2d");if(!n)return;n.font="64px serif",n.fillText(t,0,54);const s=e.toDataURL();hp(s)},Uz=(e,t)=>{const n=e.getContext("2d");if(!n)return;const s=new Image;s.setAttribute("crossOrigin","anonymous"),s.onload=()=>{const a=s.width/57;n.drawImage(s,t.sheet_x*a,t.sheet_y*a,a,a,0,0,e.width,e.height);const o=e.toDataURL();hp(o)},s.src="https://cdn.allflow.cn/assets/google_emoji.5dd44719.png"},Vz=function(e=""){if(!e){hp(Dn.favicon);return}const t=document.createElement("canvas");if(t.height=64,t.width=64,Fi){XT(t,e);return}const n=PD(e,"google",wx());n?Uz(t,n):XT(t,e)},qz=e=>Zf(e,"")[0],Z1=e=>{var o;const{title:t,icon:n}=e,s=(o=n==null?void 0:n.type)!=null?o:"emoji",a=n==null?void 0:n.value;if(XD)s==="upload"||s==="http"||s==="icon"||un?document.title=t:document.title=`${a?`${a} `:""}${t}`;else{if((s==="upload"||s==="http"||s==="icon")&&a){const i=s==="icon"?sw(Wa(),a):a;vd(i)?hp(i):hp(Dn.favicon)}else Vz(a);document.title=t}},Ps=e=>{var f,h;const{name:t="",color:n=to.grey3,icon:s,imgClassName:a,iconSize:o}=e,i=qz(t),l=(s==null?void 0:s.type)==="upload"&&s.value,c=(s==null?void 0:s.type)==="emoji"&&s.value,u=(s==null?void 0:s.type)==="icon"&&s.value,d=Lr();return r.jsxs("span",{className:B("text-h4 flex h-6 w-6 flex-shrink-0 select-none items-center justify-center rounded uppercase leading-none text-black2",e.className),style:{...e.style,backgroundColor:c||l||u||!n?"":E6(n,d?.15:0)},onClick:e.onClick,children:[!l&&!u&&(c?r.jsx($s,{iconSize:o!=null?o:24,emojiStr:(s==null?void 0:s.value)||i,disableHover:!0}):i),l&&r.jsx("img",{src:(f=s.value)!=null&&f.startsWith("http")?s.value:AV((h=s.value)!=null?h:""),className:B("h-full w-full rounded object-cover",a)}),u&&s&&s.value&&r.jsx("img",{src:sw(Wa(),s.value),className:B("h-full w-full rounded object-cover",a)})]})},Hz=e=>{const t=e.listItem.data;if(!t)return null;const n=t.navs&&t.navs.length>0;return r.jsxs("div",{...e.attribute,onClick:s=>{e.onItemClick&&e.onItemClick(e.listItem,e.index,s)},className:B(Xc,"flex items-center rounded cursor-pointer active-bg animate-hover",n?"h-[58px]":"h-10",{"normal-bg":e.selected}),children:[r.jsxs("div",{className:"flex flex-col flex-1 text-ellipsis",children:[r.jsxs("div",{className:"flex flex-row items-center",children:[["SPACE","PRIVATE"].some(s=>s===t.type)?r.jsx(Ps,{className:"!text-t3-medium m-0.5",icon:t.icon,name:t.avatarTitle||t.title,color:t.backgroundColor,style:{width:"20px",height:"20px"}}):r.jsx(tn,{blockId:t.uuid,iconSize:20,trigger:!1,defaultIcon:r.jsx(as,{uuid:t.uuid,size:"middle"})}),r.jsx("span",{className:"ml-2 text-black text-t2 text-ellipsis",children:t.title})]}),r.jsx("div",{className:"flex flex-col ml-7",children:t.navs&&t.navs.length>0&&r.jsx(lg,{navs:t.navs})})]}),t.renderRight&&t.renderRight()]})},$z=e=>{const t=e.listItem.data;return t?r.jsxs("div",{...e.attribute,onClick:n=>{var s,a;(s=t.onClick)==null||s.call(t),(a=e.onItemClick)==null||a.call(e,e.listItem,e.index,n)},className:B(Xc,"h-auto flex items-center justify-between py-[9px] rounded cursor-pointer active-bg animate-hover",{"normal-bg":e.selected}),children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("div",{className:"text-black text-t2",children:t.title}),t.description&&r.jsx("div",{className:"text-t4 text-grey3",children:t.description})]}),t.selected&&r.jsx(H,{name:"IcSelectedSpace",size:"middle"})]}):null},wn=e=>r.jsx("button",{disabled:e.disabled,onClick:t=>{var n;t.stopPropagation(),(n=e.onSwitch)==null||n.call(e,!e.open)},className:B({"opacity-20":e.disabled,"cursor-not-allowed":e.disabled},"w-[30px] h-[18px] flex items-center rounded-full transition-all px-0.5",e.open?"bg-active_color":"bg-grey4",e.bgClassName),children:r.jsx("span",{className:B("bg-white w-3.5 h-3.5 rounded-full transform-gpu transition",e.open?"translate-x-full -ml-0.5":"translate-x-0",e.switchClassName),style:{transition:"inherit"}})}),Gz=e=>{const t=e.listItem.data;return t?r.jsx("div",{...e.attribute,className:B(Xc,"flex items-center justify-between rounded cursor-pointer active-bg animate-hover",{"normal-bg":e.selected}),onClick:()=>t.onSwitch(!t.switch),"data-no-cancel-selected":t.noCancelSelected,children:r.jsxs(Fe,{className:B("flex items-center justify-between h-full w-full"),placement:"right",theme:"none",offset:[0,16],popup:t.context,children:[r.jsxs("div",{className:"flex items-center",children:[t.icon&&r.jsx(H,{name:t.icon,className:"mr-2.5",size:"middle"}),r.jsx("span",{className:"text-black text-t2",children:t.title})]}),r.jsx(wn,{open:t.switch,onSwitch:t.onSwitch,disabled:t.disabled})]})}):null};var $=(e=>(e.OPERATION="operation",e.SEARCH="search",e.SEARCH_FILE="search_file",e.LINE="line",e.HISTORY="history",e.TEXT_SWITCH="textSwitch",e.BLOCK_ITEM="blockItem",e.BLOCK_TEXT="blockText",e.OPERABLE_BLOCK_TEXT="operableBlockText",e.BLOCK_TRANSFORM="blockTransform",e.TEXT_DESCRIPTION="textDescription",e.CUSTOM_RENDER="custom_render",e))($||{});Oi($.OPERATION,P$);Oi($.SEARCH,Hz);Oi($.SEARCH_FILE,U$);Oi($.LINE,B$,!0);Oi($.BLOCK_ITEM,j$);Oi($.TEXT_SWITCH,Gz);Oi($.BLOCK_TEXT,S$,!0);Oi($.OPERABLE_BLOCK_TEXT,R$);Oi($.BLOCK_TRANSFORM,A$);Oi($.TEXT_DESCRIPTION,$z);const zz=e=>{const{loadMore:t=()=>{},keyDownPriority:n=Tr,onGlobalCaptureKeydown:s,defaultActiveIndex:a=-1,activeIndex:o,onSelectedActiveIndex:i}=e,l=F.useMemo(()=>e.items.filter(y=>!y.isHidden),[e.items]),c=F.useRef(null),u=F.useRef(null),d=F.useRef(qe()),f=F.useRef(null),h=y=>{var b,E;return(E=(b=u.current)==null?void 0:b.querySelector(`[data-list-item="${d.current}-${y}"]`))!=null?E:null},p=(y,b)=>i1(l,y,b),[g,_]=kw(l.length,h,p,n,{scrollContainer:u,defaultActiveIndex:a,activeIndex:o,onGlobalCaptureKeydown:s,onSelectedActiveIndex:i,virtuoso:f}),x=(y,b)=>{var k,C,T,v;if(y.isHidden)return null;const E={onMouseDown:I=>I.preventDefault(),"data-list-item":`${d.current}-${b}`,...bn(((k=y.data)==null?void 0:k.dataTestId)||((C=y.data)==null?void 0:C.title)),...y.attribute,onMouseEnter:()=>_(b)};if(y.render){const I=y.render();return r.jsx(I.type,{...E,key:(T=y.key)!=null?T:b,...I.props,className:B(I.props.className,b===g&&!y.disableCustomHoverBg&&"normal-bg rounded")})}const w=SS[y.type];return w===void 0?r.jsx("div",{children:`不支持该类型(${y.type}),请先注册`}):r.jsx(w,{attribute:E,listItem:y,index:b,onItemClick:y.disableClick?void 0:e.onItemClick,selected:b===g},(v=y.key)!=null?v:b)};return r.jsxs("div",{className:e.className,ref:u,"data-no-cancel-selected":!0,style:e.style,children:[e.customHeader,e.virtualList?r.jsxs(r.Fragment,{children:[e.loadingView,r.jsx(v$,{className:e.scrollClassName,virtuosoRef:f,items:l,renderItem:x,maxHeight:e.virtualListHeight,computeItemKey:y=>{var b,E;return(E=(b=l[y])==null?void 0:b.key)!=null?E:`${y}`}})]}):r.jsx("div",{ref:c,className:B(e.scrollClassName,e.loadMore&&"absolute bottom-0 w-full overflow-auto flex-1"),style:{...e.scrollContainerStyle},children:r.jsxs(Il,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:t,getScrollParent:()=>c.current,hasMore:e.hasMore,children:[e.loadingView,l.map((y,b)=>x(y,b))]})}),e.customFooter]})};function i1(e,t,n){if(n==="left"||n==="right")return-1;const s=n==="up",a=s?t-1:t+1,o=e[a];return o?o.isHidden||RS.has(o.type)?i1(e,a,n):a:i1(e,s?e.length:-1,n)}const ze=F.memo(zz),Wz={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Kz={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3},Yz={DISABLE:0,ENABLE:1,ENABLE_ENHANCE:2};var at=(e=>(e.RECTANGLE="rectangle",e.ELLIPSE="ellipse",e.POLYGON="polygon",e.HIGHLIGHT="highlight",e.UNDERLINE="underline",e.STRIKETHROUGH="strikethrough",e.PENCIL="pencil",e.ERASER="eraser",e.MOVE="move",e.NONE="none",e))(at||{});const Gl={BLUE:"#3EC1FA",GREEN:"#00E79B",YELLOW:"#FAE143",ORANGE:"#FFB94E",PINK:"#FF5682",PURPLE:"#E76BEC"};var Ca=(e=>(e.CATALOGUE="catalogue",e.THUMBNAIL_VIEW="thumbnailView",e.ANNOTATION="annotation",e.NONE="none",e))(Ca||{}),e0=(e=>(e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e))(e0||{}),t0=(e=>(e.SINGLE="single",e.DOUBLE="double",e))(t0||{}),Ga=(e=>(e.ADD="add",e.UPDATE="update",e.DELETE="delete",e))(Ga||{});const w6=(e,t)=>e.map(n=>{const[s,a]=t.convertToPdfPoint(n.x,n.y),[o,i]=t.convertToPdfPoint(n.x+n.width,n.y+n.height);return{x:s,y:a,xMax:o,yMax:i}}),Xz=(e,t)=>e.map(n=>{const[s,a,o,i]=t.convertToViewportRectangle([n.x,n.y,n.xMax,n.yMax]);return{x:s,y:a,width:o-s,height:i-a}}),QT=(e,t)=>({x:e.left-t.left,y:e.top-t.top,width:e.width,height:e.height}),Qz=(e,t)=>e.top>t.top&&e.left>t.left&&e.bottom<t.bottom&&e.right<t.right,Jz=(e,t,n=10)=>Math.abs(e.top-t.top)<n&&Math.abs(e.height-t.height)<n,Zz=(e,t)=>e.left<=t.left&&t.left<=e.right,eW=(e,t,n=10)=>e.left<=t.left&&e.right<=t.right&&t.left-e.right<=n,tW=(e,t)=>{let n=e.filter(a=>a.width>.1&&a.height>.1&&Math.abs(a.width-t)>10).sort((a,o)=>{const i=a.top-o.top;return i===0?a.left-o.left:i});n=n.filter(a=>n.every(o=>!Qz(a,o)));const s=new Set;return n.forEach((a,o)=>{s.has(a)||n.slice(o+1).forEach(i=>{s.has(i)||Jz(a,i)&&(Zz(a,i)||eW(a,i))&&(a.width=Math.max(a.width,i.width-(a.left-i.left)),a.height=Math.max(a.height,i.height),s.add(i))})}),n.filter(a=>!s.has(a))},nW=e=>e.sort((t,n)=>{const s=um(t),a=um(n);return!s||!(a!=null&&a.point)?1:!a||!(s!=null&&s.point)?-1:s.pageNumber!==a.pageNumber?s.pageNumber-a.pageNumber:a.point.y-s.point.y}),um=e=>{var i,l;const{type:t,pageNumber:n,pdfRects:s}=e;let{path:a}=e;if(t===at.RECTANGLE||t===at.HIGHLIGHT||t===at.UNDERLINE||t===at.STRIKETHROUGH){if(!s)return;const c=Object.keys(s);c.sort((h,p)=>Number(h)-Number(p));const u=c[0];if(!u)return;const d=[...(i=s[u])!=null?i:[]].sort((h,p)=>Math.max(p.y,p.yMax)-Math.max(h.y,h.yMax)),f=d==null?void 0:d[0];return f?{pageNumber:Number(u),point:{x:f.x,y:f.y}}:void 0}if(t===at.ELLIPSE){const c=(l=s==null?void 0:s[n])==null?void 0:l[0];if(!c)return;a=[{x:c.x,y:c.y},{x:c.xMax,y:c.yMax}]}if(!a)return;const o=[...a].sort((c,u)=>c.y!==u.y?u.y-c.y:c.x-u.x);return{pageNumber:n,point:o[0]}},N2=e=>e===at.RECTANGLE||e===at.ELLIPSE||e===at.POLYGON,Wx=e=>{const t=ae(a=>{var i,l;const o=a.blocks[e.id];return(l=(i=o==null?void 0:o.data.ref)==null?void 0:i.uuid)!=null?l:e.id}),n=Rl(t),s=r.jsxs(r.Fragment,{children:[r.jsxs("span",{className:"relative ",style:{fontSize:"20px"},children:[r.jsx(H,{name:"MIcPageUnable",size:"middle"}),r.jsx(H,{className:"absolute right-[-1px] bottom-[0]",name:"MIcBadgePagelink",style:{fontSize:"0.65em",color:"black"}})]}),r.jsx("span",{className:"relative ml-1 w-full font-medium underline decoration-grey5 underline-offset-2",children:"无法访问"})]});return e.disable?r.jsx("span",{className:Yt("px-0.5 items-center rounded p-1",e.className),children:s}):r.jsx(pc,{to:n,className:"px-0.5 items-center rounded p-1 animate-hover cursor-pointer",children:s})},JT=[{title:"跟随系统",value:bi.system},{title:"浅色",value:bi.light},{title:"深色",value:bi.dark}];var yk=(e=>(e.JUMP="jump",e.RIGHT_PAGE="rightPage",e))(yk||{});const ZT=[{title:"跳转",value:"jump"},{title:"右侧打开",value:"rightPage"}],ev=[{title:"固定宽度",value:Q1.FIXED},{title:"自适应宽度",value:Q1.AUTO}],tv=[{title:"默认字体",value:"default"},{title:"霞鹜文楷",value:"lxgwWenKai"},{title:"思源宋体",value:"sourceHanSerif"}],nv=[{title:"紧密布局",value:"compact"},{title:"默认布局",value:"default"},{title:"宽松布局",value:"loose"}],Gd=()=>{const e=$c();return F.useCallback((t,n={})=>{e.push({...e.location,search:tx.stringify({"right-page-id":t}),...n})},[e])},Cs=()=>{const e=$c(),t=Gd(),{setting:n={}}=Qt(),s=gt(),a=Vn(),o=(i,l={})=>{const{domain:c="",hash:u="",illegal:d,onOpenInRight:f,forceOpenInRight:h,forceOpenNewTab:p}=l;if(p){ht()?window.open(`${c}/share/${i}${u}`):window.open(`${Sn()}/${i}${u}`);return}if(a===Tt.FORM_ENG_PAGE){window.open(`${c}/share/${i}${u}`);return}if(ht()){e.push(`${c}/share/${i}${u}`);return}if(s!==i&&!wt.$isMobileSize&&(h||n.openPageMode===yk.RIGHT_PAGE)){t(i,{hash:u}),f==null||f();return}e.push(`${c}/${i}${u}`)};return F.useCallback(o,[e,t,s,a,n.openPageMode])};var Ss=(e=>(e.Log="flowus:log",e.CheckForUpdates="flowus:check-for-updates",e.UpdateNotAvailable="flowus:update-not-available",e.UpdateAvailable="flowus:update-available",e.CanHistoryBackAndForward="flowus:can-history-back-and-forward",e.OnOpenSetting="flowus:on-open-setting",e.Reload="flowus:reload",e.Zoom="flowus:zoom",e.IsFullScreen="flowus:is-full-screen",e.OnFullScreenToggle="flowus:on-full-screen-toggle",e.GetAppVersion="flowus:get-app-version",e.OnFind="flowus:on-find",e.GetWebContents="flowus:get-web-contents",e.DownloadUrl="flowus:download-url",e.DownloadMessage="flowus:download-message",e.WebDownloaded="flowus:web-downloaded",e.CopyText="flowus:copy-text",e.CopyImage="flowus:copy-image",e.UpdateReload="flowus:update-reload",e.UpdateDownloadComplete="flowus:update-download-complete",e.UpdateError="flowus:update-error",e.HotUpdateComplete="flowus:hot-update-complete",e.HotUpdateDowning="flowus:hot-update-downing",e.NotHotUpdate="flowus:no-hot-update",e.Message="flowus:message",e.ClearCacheAndReload="flowus:clear-cache-and-reload",e))(Ss||{});const Kx=()=>(window.flowUsIpcRenderer,window.flowUsIpcRenderer),n0=(e,...t)=>new Promise(n=>{const s=Kx();s==null||s.invoke(e,...t).then(n)}),yu=(e,t)=>{const n=Kx();n==null||n.on(e,t)},ri=(e,...t)=>{const n=Kx();n==null||n.send(e,...t)},on=async(e,t)=>{var n;un&&ri(Ss.CopyText,e),await tM(e),(t==null?void 0:t.message)!=="none"&&ye.success((n=t==null?void 0:t.message)!=null?n:"复制成功")},X0e=async e=>{if(un){const n=require("fs"),a=`${require("os").tmpdir()}/${Date.now()}.png`,o=await e.arrayBuffer();return n.writeFileSync(a,Buffer.from(o)),ri(Ss.CopyImage,a)}const t=new ClipboardItem({[e.type]:e});navigator.clipboard.write([t])},qm=F.createContext({interactable:!0,readonly:!1}),mi=F.createContext(void 0),Hm=e=>{const{children:t,...n}=e,{state:s,isInit:a}=_$(n);return r.jsx(F2.Provider,{value:{$state:s,isInit:a},children:t})},ur=Symbol("Page Scope"),Yx=ia("");let k6;const sW=e=>{k6=e},pp=e=>{const{pageId:t,blockId:n,loading:s}=e;let a=Rl(t);n&&(a+=`#${n}`);const o=dr(()=>DI({initialEntries:[a]}));return F.useEffect(()=>o.block(()=>!1),[o]),r.jsx(Hm,{wait:1e3,waitMode:"debounce",children:r.jsx(SI,{history:o,children:r.jsx(Nd,{scope:ur,initialValues:[[Yx,t]],children:r.jsx(Al.Provider,{value:Tt.PAGE_LITE_PREVIEW,children:r.jsx(mi.Provider,{value:zc.PAGE_LITE,children:r.jsx(jl,{children:s?r.jsx(os,{className:"flex-1"}):r.jsx(k6,{uuid:t})})})})})})})},rW=()=>{var i,l;const e=Vn(),t=NH(),n=!!F.useContext(_l),s=e===Tt.MAIN||e===Tt.SHARE||e===void 0,o=(l=(i=Qt().setting)==null?void 0:i.previewDialog)!=null?l:!0;return s&&!n&&o&&!t},Eg=(e,t)=>{const n=La(),[s,a]=F.useState(()=>!aW(e));return F.useLayoutEffect(()=>{(async()=>{s&&t&&(await n(e,{prefetch:!0}),a(!1))})()},[n,s,e,t]),s},aW=e=>{var a,o;const t=K.blocks[e];return((a=t==null?void 0:t.subNodes.reduce((i,l)=>{const c=K.blocks[l];return c&&!Xt(c==null?void 0:c.type)?i+1:i},0))!=null?a:0)*1/((o=t==null?void 0:t.subNodes.length)!=null?o:1)>.3};let C6;const T6=e=>{C6=e},wl=e=>{var w;const{isLink:t,pageId:n,blockId:s,mentionBlockMenuProps:a,showMoreBtn:o,hideOpenRightBtn:i}=e,l=_e(n,["data"]),c=F.useRef(),u=F.useMemo(()=>de(l==null?void 0:l.data.segments)||Ot(l==null?void 0:l.type),[l==null?void 0:l.data.segments,l==null?void 0:l.type]),[d,f]=Li(),h=rW(),p=Eg(n,d&&h),g=Rl(n),_=Cs(),x=ht(),y=me(),b=Kt(),E=F.useRef();return F.useEffect(()=>()=>{E.current&&b(E.current)},[b]),F.useLayoutEffect(()=>{var v,I,j,D,S;if(!d||p)return;const k=(v=c.current)==null?void 0:v.querySelector(".page-header");k instanceof HTMLElement&&(k.hidden=!0);const C=(I=c.current)==null?void 0:I.querySelector(".footer");C instanceof HTMLElement&&(C.hidden=!0);const T=(S=(j=c.current)==null?void 0:j.querySelector(`#${Ud}`))!=null?S:(D=c.current)==null?void 0:D.querySelector(".next-space-page");T instanceof HTMLElement&&T.childNodes.forEach(R=>{R instanceof HTMLElement&&R.setAttribute("style","padding-left:12px;padding-right:12px")})},[p,d]),h?r.jsxs("div",{id:"modalContent",ref:k=>{f(k),k&&(c.current=k)},className:B("page-preview rounded w-[500px] h-[300px] flex flex-col",e.className),style:e.style,children:[r.jsxs("div",{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(tn,{trigger:!1,iconSize:20,tooltipClassName:"flex-shrink-0",hasOverlay:t,blockId:n,offset:[100,0],defaultIcon:r.jsx(as,{uuid:n})}),r.jsx("div",{className:"ml-2 text-t2 h-6 overflow-hidden break-words",children:u})]}),!x&&r.jsxs("div",{className:"flex items-center shrink-0",children:[!o&&r.jsx(Fe,{popup:"复制链接",onClick:()=>{let k="";s&&(k=`#${s}`),on(`${Sn()}${g}${k}`)},children:r.jsx(H,{name:"IcUrl",size:"middle",className:"cursor-pointer mr-4"})}),!i&&r.jsx(Fe,{popup:"侧边栏窗口打开",onClick:()=>{var k;_(n,{forceOpenInRight:!0,hash:s?`#${s}`:void 0}),(k=e.onCloseOutsideModel)==null||k.call(e)},children:r.jsx(H,{name:"IcInSidePeek",size:"middle",className:B("cursor-pointer",{"mr-4":o})})}),o&&a&&r.jsx(Fe,{popup:"更多菜单",onClick:k=>{E.current=y.dropdown({popcorn:Br(k.currentTarget),content:({onCloseModal:C})=>r.jsx(C6,{...a,onCloseOutModel:()=>{var T;C(),(T=e.onCloseOutsideModel)==null||T.call(e)}})}).modalId},children:r.jsx(H,{name:"IcMore",size:"middle",className:"cursor-pointer"})})]})]}),r.jsx("div",{className:"h-px mx-4 bg-grey6"}),(w=e.children)!=null?w:r.jsx(pp,{pageId:n,blockId:s,loading:p})]}):null};var Rs=(e=>(e[e.LOGIN=0]="LOGIN",e[e.FORGET_PASSWORD=1]="FORGET_PASSWORD",e[e.REGISTER=2]="REGISTER",e[e.BIND_PHONE=3]="BIND_PHONE",e[e.WECHAT_LOGIN=4]="WECHAT_LOGIN",e[e.QQ_LOGIN=5]="QQ_LOGIN",e[e.COMPLETE=6]="COMPLETE",e[e.JOIN_TEAM_SPACE=7]="JOIN_TEAM_SPACE",e[e.LOGIN_VERIFY_CODE=8]="LOGIN_VERIFY_CODE",e))(Rs||{}),ir=(e=>(e[e.CAN_SIGN=0]="CAN_SIGN",e[e.CAN_LOGIN=1]="CAN_LOGIN",e[e.NEED_BIND_PHONE=2]="NEED_BIND_PHONE",e[e.BIND_FAIL=3]="BIND_FAIL",e))(ir||{});const wg=e=>F.useCallback(n=>{if(!n.nickname||!n.occupation){e({type:Rs.COMPLETE,props:{userId:n.uuid}});return}return!0},[e]),Nt={event:()=>{},message:{success:()=>{},error:()=>{},warning:()=>{}},request:{},setBrowserTitle:()=>{},EmojiIcon:e=>{var t;return r.jsx("div",{className:"flex items-center emoji",style:{fontSize:(t=e.size)!=null?t:24},children:e.value})},afterLogin:()=>{},wechatId:"",origin:"https://flowus.cn"},oW=e=>{var t,n,s;e.event&&(Nt.event=e.event),(t=e.message)!=null&&t.success&&(Nt.message.success=e.message.success),(n=e.message)!=null&&n.error&&(Nt.message.error=e.message.error),(s=e.message)!=null&&s.warning&&(Nt.message.warning=e.message.warning),e.request&&(Nt.request=e.request),e.setBrowserTitle&&(Nt.setBrowserTitle=e.setBrowserTitle),e.EmojiIcon&&(Nt.EmojiIcon=e.EmojiIcon),e.afterLogin&&(Nt.afterLogin=e.afterLogin),e.wechatId&&(Nt.wechatId=e.wechatId),e.origin&&(Nt.origin=e.origin)},Xx=Jf,iW="userId",Xu=(e,t="flowus",n=!0)=>{const s=nM.hash(e+t);return n?s.toUpperCase():s},Qr={Email:/^([A-Za-z0-9_\-.])+@([A-Za-z0-9_\-.])+\.([A-Za-z]{2,4})$/,Mobile:/^1[3456789]\d{9}$/,Password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d!@#$%^&*()_+-~|\\}\\{\\"\\:\\?\\>\\<,.;'\\[\]]{6,16}$/,VerifyCode:/^[0-9]{6}$/},s0=qe();function Ua(e){return new Proxy({},{get(t,n){return F.lazy(()=>e().then(s=>({default:s[n]})))}})}const sv=e=>new Promise(t=>{setTimeout(t,e)}),lW="https://flowus.cn/share/c7e03855-8742-4453-abea-ab0625209955",Q0e=()=>navigator.userAgent.toLowerCase().indexOf("micromessenger")!==-1,J0e=()=>window.__wxjs_environment==="miniprogram",cW="9118367871f44629ab8eb16d6e274280",v6="fl_account",Z0e=e=>{sessionStorage.setItem(v6,e)},exe=()=>{sessionStorage.setItem(v6,"")},uW=()=>RI?{x_device_type:"desktop",x_platform:z3?"mac":"windows",platform:z3?"mac":"windows"}:{x_device_type:"web",x_platform:"web",platform:"web"},dW=(e="")=>e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),{Login:fW}=Ua(()=>ve(()=>import("./login-9d802d9d.js"),["assets/login-9d802d9d.js","assets/vendor-72681657.js","assets/verify-code-login-0011cf49.js"])),{ForgetPassword:mW}=Ua(()=>ve(()=>import("./forget-password-058573e8.js"),["assets/forget-password-058573e8.js","assets/vendor-72681657.js"])),{BindPhone:hW}=Ua(()=>ve(()=>Promise.resolve().then(()=>zpe),void 0)),{WechatLogin:pW}=Ua(()=>ve(()=>Promise.resolve().then(()=>Bpe),void 0)),{WechatLoginElectron:gW}=Ua(()=>ve(()=>Promise.resolve().then(()=>Lpe),void 0)),{QQLogin:_W}=Ua(()=>ve(()=>import("./qq-login-678d644f.js"),["assets/qq-login-678d644f.js","assets/vendor-72681657.js"])),{Complete:xW}=Ua(()=>ve(()=>import("./complete-e1120dd0.js"),["assets/complete-e1120dd0.js","assets/vendor-72681657.js","assets/occupation-list-72590010.js"])),{Register:FW}=Ua(()=>ve(()=>import("./register-c5890ec0.js"),["assets/register-c5890ec0.js","assets/vendor-72681657.js","assets/verify-code-login-0011cf49.js"])),{Login:yW}=Ua(()=>ve(()=>import("./login-1b1c00bf.js"),["assets/login-1b1c00bf.js","assets/vendor-72681657.js","assets/title-7cd28da9.js","assets/verify-code-login-9c5aa2d5.js","assets/captcha-9aa1da4b.js"])),{Register:bW}=Ua(()=>ve(()=>import("./register-2b6b6358.js"),["assets/register-2b6b6358.js","assets/vendor-72681657.js","assets/verify-code-login-9c5aa2d5.js","assets/captcha-9aa1da4b.js","assets/title-7cd28da9.js"])),{VerifyCodeLogin:EW}=Ua(()=>ve(()=>import("./verify-code-login-9c5aa2d5.js"),["assets/verify-code-login-9c5aa2d5.js","assets/vendor-72681657.js","assets/captcha-9aa1da4b.js","assets/title-7cd28da9.js"])),{ForgetPassword:wW}=Ua(()=>ve(()=>import("./forget-password-4fa8dd76.js"),["assets/forget-password-4fa8dd76.js","assets/vendor-72681657.js","assets/captcha-9aa1da4b.js","assets/title-7cd28da9.js"])),{Complete:kW}=Ua(()=>ve(()=>import("./complete-9a51ddfd.js"),["assets/complete-9a51ddfd.js","assets/vendor-72681657.js","assets/occupation-list-72590010.js","assets/title-7cd28da9.js"])),{BindPhone:CW}=Ua(()=>ve(()=>import("./bind-phone-a89c9f08.js"),["assets/bind-phone-a89c9f08.js","assets/vendor-72681657.js","assets/captcha-9aa1da4b.js","assets/title-7cd28da9.js"])),TW=(e,t)=>{switch(e){case Rs.LOGIN:return t==="default"?fW:yW;case Rs.FORGET_PASSWORD:return t==="default"?mW:wW;case Rs.REGISTER:return t==="default"?FW:bW;case Rs.BIND_PHONE:return t==="default"?hW:CW;case Rs.WECHAT_LOGIN:return RI?gW:pW;case Rs.COMPLETE:return t==="default"?xW:kW;case Rs.QQ_LOGIN:return _W;case Rs.LOGIN_VERIFY_CODE:return EW;default:return()=>null}},r0=e=>{var g;const{complete:t=!0,styleType:n="default"}=e,[s,a]=F.useState((g=e.defaultViewState)!=null?g:{type:Rs.LOGIN}),{onSuccess:o,onStep:i,onFooterChange:l,...c}=e,u=F.useRef();u.current=e.onSuccess;const d=F.useRef();d.current=e.onFooterChange;const f=F.useCallback(_=>{a(x=>({...x,..._}))},[]),h=wg(f);F.useEffect(()=>{e.autoLogin&&Nt.request.infra.getMyUserInfo.raw().then(_=>{var x;_.code===200&&(!t||h(_.data))&&((x=u.current)==null||x.call(u,_.data))})},[h,t,e.autoLogin]),F.useEffect(()=>{var _;(_=e.onStep)==null||_.call(e,s.type)},[e,s.type]);const p=TW(s.type,n);return typeof document<"u"?r.jsx(F.Suspense,{fallback:r.jsx("div",{}),children:r.jsx(p,{...c,...s.props,switchViewType:f,complete:t,styleType:n,onSuccess:u.current,onFooterChange:d.current})}):r.jsx(p,{...c,...s.props,switchViewType:f,complete:t,styleType:n,onSuccess:u.current,onFooterChange:d.current})},fo="https://cdn.flowus.cn/fe-web-app-images/packges-login",kl={qqLogo:`${fo}/qq_logo.svg`,wechatBtn:`${fo}/wechat_btn.svg`,wechatLogoLogin:`${fo}/wechat_login_logo.svg`,IcTitleClose:`${fo}/ic_title_close.svg`,IcMenuItemShow:`${fo}/ic_menu_item_show.svg`,IcMenuItemHide:`${fo}/ic_menu_item_hide.svg`,IcLoginCode:`${fo}/ic_login_code.svg`,IcArrow:`${fo}/ic_arrow.svg`,IcArrowRight:`${fo}/ic_arrow_right.svg`,IcSelectedSpace:`${fo}/ic_space_selected.svg`,IcInviteInfo:`${fo}/ic_invite_info.svg`,IcWarning:`${fo}/ic_warning.svg`},N6=e=>r.jsx("div",{className:"my-3 tracking-wide text-center text-t4 h-md:text-t2 text-black",children:e.showScoreRule?r.jsxs("div",{className:"flex items-center justify-center w-full",children:[r.jsx("img",{src:kl.IcInviteInfo,className:"w-5 h-5 mr-1"}),r.jsx("a",{className:"underline",target:"_blank",href:lW,rel:"noreferrer",children:"了解积分规则"})]}):r.jsxs(r.Fragment,{children:["点击",e.isJoinTeam?"加入团队":"继续"," 代表您同意 ",r.jsx("a",{className:"underline",target:"_blank",href:An.userAgreement,rel:"noreferrer",children:"用户协议"})," 和 ",r.jsx("a",{className:"underline",target:"_blank",href:An.privacyPolicy,rel:"noreferrer",children:"隐私政策"})]})}),I6=()=>{const e=gt(),t=_e(e,["createdBy","updatedBy"]),n=Qt();return n.uuid===(t==null?void 0:t.createdBy)||n.uuid===(t==null?void 0:t.updatedBy)},vW=()=>{const e=Qt();return F.useCallback(t=>{const n=K.blocks[t];return e.uuid===(n==null?void 0:n.createdBy)||e.uuid===(n==null?void 0:n.updatedBy)},[e.uuid])},j6=e=>[Et.freeTeam,Et.team,Et.smallTeam].includes(e),Ao=()=>{const e=Ft();return j6(e.planType)},bk=({type:e,onCloseModal:t,success:n,email:s})=>{const a=e==="justice";return r.jsxs("div",{className:"flex w-[400px] sm:w-full items-center flex-col p-7",children:[r.jsx("div",{className:"text-7xl",children:n?"😀":"😔"}),r.jsxs("div",{className:"my-2.5 font-medium",children:[a&&(n?"提交成功，预计 3 个工作日内完成申诉审核":"申诉失败，您已申诉过该页面"),!a&&(n?"举报已提交，预计12小时内受理":"举报失败，您已举报过该页面")]}),r.jsxs("div",{className:"text-t2 text-center mb-7",children:[r.jsxs("div",{children:[a&&(n?"申诉结果会以邮件形式发送至您的邮箱":"72 小时内至多可提交 1 次申诉，请耐心等待复审结果"),!a&&(n?"我们会尽快进行人工审核，感谢您的支持":"一个分享链接7天内仅能举报一次，请耐心等待复审结果，感谢您的支持")]}),r.jsx("div",{className:"text-center text-active_color",children:a&&n&&s})]}),r.jsx("div",{onClick:t,className:"w-full animate-click bg-black text-center text-t2 py-1.5 text-white1 rounded",children:"知道了"})]})},NW=["请选择","色情低俗","垃圾广告","造谣传谣","政治不实信息","涉嫌欺诈","涉嫌赌博","涉嫌非法集资","涉暴涉恐","邪教迷信","宣扬不良价值观","内容引人不适","危险行为","涉嫌侵权（交由我司人工审核）","其他违法违规"],rv=200,D6=({onCloseModal:e,uuid:t,type:n,blockType:s})=>{const a=me(),[o,i]=F.useState({email:"",phone:"",complainType:0,description:"",pictureLinks:[],type:s!=null?s:"block"}),[l,c]=F.useState([]),[u,d]=F.useState(!1),f=Ma(),h=n==="justice",p=h?!(o.email.trim()&&o.description.trim()):!(o.email.trim()&&o.complainType!==0),g=b=>E=>{b==="email"&&typeof E=="string"&&(E=E.replace(/\s+/g,"")),i(w=>({...w,[b]:E}))},_=b=>E=>{const w=E.target.files;if(!w||!w[0])return;const k=w[0];if(k.size>=1024*1024){ye.error({content:"文件已超过 1M 大小"});return}f({file:k,type:"private",onComplete:C=>{C.success&&(i(T=>{const v=T.pictureLinks.slice();return v[b]=C.ossName,{...T,pictureLinks:v}}),c(T=>{const v=T.slice();return v[b]=URL.createObjectURL(k),v}))}})},x=b=>{a.modal({content:({onCloseModal:E})=>r.jsx(bk,{success:b,email:o.email,type:n,onCloseModal:E})})},y=async()=>{const b={...o,pictureLinks:o.pictureLinks.filter(Boolean)};if(!(p||u)){d(!0);try{if(h){const E=await Ce.editor.shareAppeal.raw(t,b);E.code===200?(e(),x(!0)):E.code===1111&&(e(),x(!1))}else{const E=await Ce.editor.shareComplain.raw(t,b);E.code===200?(e(),x(!0)):E.code===1110&&(e(),x(!1))}}finally{d(!1)}}};return r.jsxs("div",{className:"p-4 width-600 sm:fixed sm:inset-0 sm:w-auto sm:h-auto sm:rounded-none sm:border-none next-modal text-t2",children:[r.jsx("div",{className:"text-grey3",children:h?"申诉服务":"举报分享内容"}),r.jsxs("div",{className:"my-4",children:["针对本文档发起",h?"申诉":"举报"]}),!h&&r.jsxs("div",{className:"flex relative items-center",children:[r.jsx("div",{className:"text-red",children:"*"}),r.jsx("div",{className:"mr-2 ml-1",children:"举报理由"}),r.jsx("select",{value:o.complainType,className:B("flex-1 py-1.5 px-3 border appearance-none rounded-sm border-grey06 bg-white1",{"text-grey2":o.complainType===0}),onChange:b=>g("complainType")(+b.target.value),children:NW.map((b,E)=>r.jsx("option",{value:E,children:b},E))}),r.jsx(H,{name:"IcArrow",size:"xxsmall",className:"absolute right-3 text-grey4"})]}),h?r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"mr-1 text-red",children:"*"}),r.jsx("div",{children:"申诉理由（如平台发生误判情况，请简要描述误判内容、提供相应材料依据）"})]}):r.jsx("div",{children:"举报描述"}),r.jsxs("div",{className:"relative my-2",children:[r.jsx("textarea",{className:"py-2 px-3 w-full bg-grey9 rounded border border-grey6 focus-within-border",rows:8,maxLength:rv,onChange:b=>g("description")(b.target.value)}),r.jsxs("div",{className:"absolute right-3 bottom-2",children:[o.description.length," ",r.jsx("span",{className:"text-grey3",children:`/ ${rv}`})]})]}),r.jsx("div",{className:"text-grey3",children:"添加图片（单张小于1M，至多上传3张）"}),r.jsx("div",{className:"flex my-2 space-x-5",children:Array.from(Array(3)).map((b,E)=>r.jsxs("label",{className:"flex object-contain overflow-hidden justify-center items-center w-9 h-9 bg-grey8 border border-black_006 border-dashed animate-click",children:[l[E]?r.jsx("img",{src:l[E],className:"w-full"}):r.jsx(H,{name:"IcBtnNew",size:"normal",className:"text-grey4"}),r.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:_(E)})]},E))}),r.jsxs("div",{className:"flex space-x-5 sm:block sm:space-x-0",children:[r.jsxs("div",{className:"flex-1 mt-4",children:[r.jsxs("div",{children:[r.jsx("span",{className:"mr-1 text-red",children:"*"}),"联系邮箱"]}),r.jsx(xt,{value:o.email,onChange:g("email"),className:"mt-2 h-9"})]}),r.jsxs("div",{className:"flex-1 mt-4",children:[r.jsx("div",{children:"手机号"}),r.jsx(xt,{maxLength:11,onChange:g("phone"),className:"mt-2 h-9"})]})]}),r.jsxs("div",{className:"flex justify-end mt-2.5",children:[r.jsx(je,{colorType:"primary",className:"mr-5",disable:p,onClick:y,children:"提交"}),r.jsx(je,{onClick:()=>e(),children:"取消"})]})]})},IW=({uuid:e})=>{const{parentId:t,isRestricted:n,illegal:s,title:a,role:o}=it(e),{illegal:i}=it(t!=null?t:e),l=Ve(e),c=Ek(e),u=XS(e),d=me(),f=_e(e,[]),h=wk(e),p=Md(f==null?void 0:f.spaceId);if(!n&&!s||!f||f.parentId===f.spaceId)return null;const g=()=>{d.warning({title:r.jsxs("div",{className:"px-5 w-80",children:[r.jsx("div",{children:"确认恢复权限继承？"}),r.jsx("div",{children:"将继承上级页面的协作分享设置，同时保留已有协作者"})]}),confirmText:"确认",confirm:()=>{u(),ee(Er()),ce.event("restore_to_inherit")}})};return r.jsxs("div",{className:"flex justify-between items-center py-4 px-3 text-grey3 bg-grey9 border-t border-grey6 text-t2",children:[r.jsxs("div",{className:"flex items-center text-t4",children:[(s||t)&&r.jsx(H,{name:"IcShareDanger",size:"small",className:"mr-1"}),s?r.jsxs("span",{children:["该页面涉嫌违反",r.jsx(pc,{to:`${p}/${e}`,className:"ml-1 text-active_color underline animate-click",children:"平台分享政策"}),"，无法继续分享"]}):t&&r.jsxs("div",{className:"flex font-medium text-grey3 text-t4",children:[n?"已限制上级页面":"🔗 继承上级页面",r.jsx(pc,{to:`${p}/${t}`,className:B("text-black animate-click max-w-[80px] line-clamp-1"),children:i?rs:a}),n?"的权限继承":"的分享"]})]}),!l&&(s&&h?r.jsx("div",{onClick:c,className:"shrink-0 font-medium text-black text-t4-medium animate-click",children:"我要申诉"}):n&&o===m.PermissionRole.EDITOR&&r.jsx("div",{onClick:g,className:"shrink-0 self-start mr-1 text-black text-t4-medium animate-click",children:"恢复权限继承"}))]})},Ek=(e,t)=>{const n=me();return F.useCallback(()=>{let s;(a=>{a.report="complain",a.justice="appeal"})(s||(s={})),Ce.editor.shareCheck(e,"appeal").then(a=>{a===!1?n.modal({content:({onCloseModal:o})=>r.jsx(bk,{success:!1,type:"justice",onCloseModal:o})}):n.modal({content:({onCloseModal:o})=>r.jsx(D6,{blockType:t==null?void 0:t.blockType,type:"justice",uuid:e,onCloseModal:o})})})},[e,n,t==null?void 0:t.blockType])},wk=e=>{const t=Ao(),{role:n}=it(e),s=vW();return t&&[m.PermissionRole.COMMENTER,m.PermissionRole.READER,m.PermissionRole.EDITOR,m.PermissionRole.WRITER].includes(n)||s(e)},S6=e=>{const{icon:t,title:n,description:s,children:a,className:o}=e;return r.jsxs("div",{className:`login-wrapper ${o}`,children:[t&&r.jsx("p",{className:"text-[70px] leading-[80px] mb-2",children:r.jsx($s,{disableHover:!0,emojiStr:t})}),n&&r.jsx("div",{className:"text-h4 mb-2",children:n}),s&&r.jsx("div",{className:"text-t2 mb-5 text-grey3",children:s}),a]})},jW=()=>{const e=me(),t=Qt(),n=ae(f=>f.spaces),s=!!t.uuid,a=gt(),[o,i]=F.useState(),l=s;F.useEffect(()=>{a&&Ce.editor.getDocPublicData.raw(a).then(f=>{f.code===200&&i(f.data)}).catch(f=>f)},[a]);const c=()=>{on(window.location.href.replace("/share",""))},u=()=>{e.modal({content:()=>r.jsxs("div",{className:"overflow-y-auto w-[450px] px-14 py-[30px] next-modal",children:[r.jsx(r0,{defaultTitle:o==null?void 0:o.spaceTitle,onSuccess:()=>location.reload()}),r.jsx("div",{className:"h-5"}),r.jsx(N6,{})]})})},d=f=>`${f==null?void 0:f.nickname}（${jd(f==null?void 0:f.phone)}）`;return r.jsx(r.Fragment,{children:r.jsx("div",{className:Yt(l?"flex flex-col items-center justify-center h-full":"login-wrapper"),children:r.jsxs("div",{className:"text-center w-full",children:[r.jsx("p",{className:"text-[70px] leading-[80px]",children:"✋"}),l?r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"text-h0",children:aV}),o&&r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"text-t2 text-grey3 py-4",children:"本页面来自空间"}),r.jsxs("div",{className:"flex justify-center items-center mx-auto",children:[r.jsx(Ps,{className:"flex-shrink-0 mr-3 w-[26px] h-[26px]",icon:o.spaceIcon,name:o.spaceTitle,color:o.spaceBackgroundColor}),r.jsx("span",{className:"text-t2-medium text-ellipsis",children:o.spaceTitle})]}),r.jsx("div",{className:"mt-9 rounded border border-grey6 bg-grey9 p-3 width-600 mx-auto sm:w-10/12",children:o.spaceId&&n[o.spaceId]?r.jsxs("div",{className:"text-left",children:[r.jsx("p",{children:"请发送页面链接给以下成员开通权限："}),r.jsx("p",{children:d(o.ownerUser)}),r.jsxs("div",{className:"flex justify-between items-center mt-12",children:[r.jsxs("div",{className:"text-t2 text-grey3",children:["当前登录账号：",d(t)]}),r.jsx("div",{onClick:c,className:"w-40 text-center font-medium h-9 leading-8 bg-white1 rounded border border-grey6 text-t2 animate-click",children:"复制链接"})]})]}):r.jsxs("div",{className:"text-center",children:[r.jsx("p",{children:"您不是空间成员或访客，无法访问。"}),r.jsx("p",{children:"请联系管理员添加。"}),r.jsxs("div",{className:"mt-8 text-t2 text-grey3",children:["当前登录账号：",d(t)]})]})})]})]}):r.jsx("p",{className:"text-t2 text-grey3 my-2",children:"当前页面未开启分享"}),!s&&r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"mb-4 text-t3 text-grey4",children:"如您拥有访问权限，请尝试登录后查看"}),r.jsx(je,{colorType:"primary",size:"large",className:"mt-2 w-32 mx-auto",onClick:u,children:"登录"})]})]})})})},Qx=({uuid:e,className:t})=>{const n=Ek(e),s=wk(e);return r.jsx(S6,{icon:"🚫",title:"当前页面违反平台分享条例，已禁止访问",className:t,children:s&&r.jsx(je,{size:"large",onClick:n,colorType:"primary",className:"mt-3",children:"我要申诉"})})},$m=({title:e,description:t,showBackButton:n=!0,children:s})=>{const a=Un(),o=()=>{a.replace(Rt.main)},i=On();return F.useEffect(()=>{i||Z1({title:"访问的页面不存在",icon:{type:"emoji",value:"🌚"}})},[i]),r.jsxs("div",{className:"cursor-default login-wrapper w-full",style:{height:"calc(100% - 144px)"},children:[r.jsx("p",{className:"text-[70px] leading-[80px]",children:"🌚"}),r.jsx("p",{className:"mb-2 text-grey4 text-t1",children:e!=null?e:"访问的页面不存在"}),t?r.jsx("p",{className:"text-t2 text-grey3",children:t}):n?r.jsx(je,{colorType:"primary",onClick:o,children:"返回到空间"}):null,s]})};const DW=({downloadUrl:e})=>{const[t,n]=F.useState("");return r.jsx(AI,{autoPlay:!1,preload:"none",autoPlayAfterSrcChange:!1,src:e,onError:s=>{const{error:a}=s.target;if(!(!a||!e))switch(a.code){case MediaError.MEDIA_ERR_DECODE:n("视频解码时发生错误");break;case MediaError.MEDIA_ERR_NETWORK:n("加载失败");break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:n("浏览器不支持播放该音频源");break}},onPlayError:s=>{t?ye.warning(t):ye.warning(s.message)}})},SW=zt.memo(DW);function RW(){return typeof window<"u"?window.innerWidth:0}const bh=new Map,av=40,AW=0,I2=({downloadUrl:e})=>{const t=F.useRef(null),n=F.useRef(null),s=F.useRef(null),a=F.useRef(),o=F.useRef(),i=F.useRef(),[l,c]=F.useState(!1),[u,d]=F.useState(""),f=Kt(),h=F.useCallback((E,w)=>{let k=o.current.height-AW*2,C=o.current.width-av*2;k=Math.min(k,w),C=Math.min(C,E);const T=C/k,v=E/w;return T>v?{width:E*k/w,height:k}:{width:C,height:w*C/E}},[]),p=F.useCallback(async()=>new Promise(E=>{if(bh.has(e)){E();return}const w=new Image;w.onload=()=>{bh.set(e,{width:w.width,height:w.height}),E()},w.src=e}),[e]),g=F.useCallback(({zoom:E=1})=>{const{width:w,height:k}=bh.get(e),{width:C}=h(w,k);let T=0;const v=RW();w>v&&(T+=(v-w)/2);const I=E*(C/w);a.current={x:T,scaleFactor:I,maxScaleFactor:(o.current.width-av*2)/w},d(`translate3d(${T}px,0px,0) scale3d(${I},${I},1)`)},[h,e]),_=F.useCallback(async()=>{await p(),g({})},[g,p]),x=F.useCallback(E=>{var v,I;const w=(v=n.current)==null?void 0:v.style.transform.split("scale3d(");if(!w)return;const k=(I=w[1])==null?void 0:I.split(",")[0];let C=Number(k);E==="in"?C=Math.max(Number(k)*.8,a.current.scaleFactor/3):C=Math.min(Number(k)*1.2,a.current.maxScaleFactor);let T=0;bh.get(e).height*C+16>o.current.height&&(T=(bh.get(e).height*C+16-o.current.height)/2),d(`translate3d(${a.current.x}px,${T}px,0) scale3d(${C},${C},1)`)},[e]);F.useEffect(()=>{var E;return o.current=(E=t.current)==null?void 0:E.getBoundingClientRect(),_(),()=>y()},[_]);const y=()=>{i.current&&clearTimeout(i.current)},b=E=>{var k;if((k=s.current)!=null&&k.contains(E.target)){y();return}const w=()=>{i.current=setTimeout(()=>{y(),c(!1)},1e3)};l?(y(),w()):(c(!0),w())};return r.jsx("div",{className:"absolute top-2 bottom-2 left-0 w-full overflow-y-auto py-2",ref:t,onMouseMove:b,onClick:E=>{var w;(w=s.current)!=null&&w.contains(E.target)||f(Xe.FILE_PREVIEW)},children:u?r.jsxs(r.Fragment,{children:[r.jsxs("div",{ref:s,className:B("fixed z-50 flex items-center px-1 py-1 -translate-x-1/2 bg-black-base/90 left-1/2 bottom-1 rounded transition-opacity duration-150",l?"opacity-100":"opacity-0"),children:[r.jsx("button",{onClick:()=>x("in"),className:"flex items-center justify-center p-2 mr-1 rounded animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(H,{name:"MIcZoomIn",size:"large"})}),r.jsx("button",{onClick:()=>x("out"),className:"flex items-center justify-center p-2 rounded animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(H,{name:"MIcZoomOut",size:"large"})})]}),r.jsx("img",{className:"absolute top-0 bottom-0 left-0 right-0 mx-auto my-auto max-w-none",src:e,alt:"大图预览",style:{transform:u},ref:n})]}):r.jsx(hs,{className:"absolute top-0 bottom-0 left-0 right-0 mx-auto my-auto"})})},BW=({downloadUrl:e})=>{const t=`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(e)}`;return e?r.jsx("iframe",{title:"office",src:t,width:"100%",height:"100%",frameBorder:"1"}):null},R6=()=>r.jsxs("div",{className:"w-full h-full pointer-events-none flex flex-col items-center justify-center",children:[r.jsx("p",{className:"text-[70px] leading-[80px] text-center",children:"👀"}),r.jsx("p",{className:"text-white",children:"当前格式不支持预览"})]});const A6=()=>{const e=ke(),t=(n,s,a)=>e(()=>{e(()=>{const{blocks:o}=le(),i=o[n];i&&i.data.pdfAnnotation&&pe(n,{data:{localUrl:a,pdfAnnotation:{...i.data.pdfAnnotation,...s}}})})});return F.useCallback(t,[e])},B6=()=>{const e=ke(),t=(n,s,a=!1)=>{const o=()=>{var c;const{blocks:i}=le(),l=i[n];l&&pe(n,{data:{format:{pdfFormat:{...(c=l.data.format)==null?void 0:c.pdfFormat,...s}}}})};a?o():e(o)};return F.useCallback(t,[e])},LW=(e,t,n=!1)=>{e===t.parentId||!t.parentId||(t.first||t.before?ee(rp({uuid:e,parentId:t.parentId,before:t.before,ignoreOp:n})):ee(ap({uuid:e,parentId:t.parentId,after:t.after,ignoreOp:n})))},kk=(e,t,n=!1)=>{e===t.parentId||!t.parentId||ee(op({parentId:t.parentId,uuid:e,ignoreOp:n}))},a0=e=>{var o;const{blocks:t,collectionViews:n}=le(),s=t[e];if(!s)return;const a=t[s.parentId];a&&(a.type===m.BlockType.COLLECTION_VIEW||a.type===m.BlockType.COLLECTION_VIEW_PAGE)&&((o=a.views)==null||o.forEach(i=>{n[i]&&ee(_c({viewId:i,uuid:e}))}))},Gs=e=>{const t=Array.isArray(e)?e:[e],{blocks:n,user:s}=le();t.forEach(a=>{var l,c;const o=n[a];if(!o)return;if(a0(a),ee(mn({uuid:a,patch:{status:-1,...fp()}})),o.isTemplate){const u=o.parentId,d=le().blocks[u];if(d!=null){const f=(l=d.templatePages)!=null?l:[],h=BI(f,a);ee(mn({uuid:u,patch:{templatePages:h}}))}}else ee(tr({uuid:a}));tk(a)&&ee(hd({parentId:s.currentSpaceViewId,uuid:a}));const i=Tn();(c=i==null?void 0:i.customTemplates)==null||c.forEach(u=>{ji(u).has(a)&&kk(u,{parentId:i.uuid})}),Ox(a),Fd(o.uuid,o.parentId)})},j2=e=>{var l;const[t,n]=e.split(",");if(!t||!n)return;const s=atob(n),a=(l=t.split(":")[1])==null?void 0:l.split(";")[0],o=new ArrayBuffer(s.length),i=new Uint8Array(o);for(let c=0;c<s.length;c++)i[c]=s.charCodeAt(c);return new Blob([o],{type:a})},o0=[{name:"蓝色",value:Gl.BLUE},{name:"绿色",value:Gl.GREEN},{name:"黄色",value:Gl.YELLOW},{name:"橙色",value:Gl.ORANGE},{name:"粉红色",value:Gl.PINK},{name:"粉紫色",value:Gl.PURPLE}],PW=({closeModal:e,color:t,setColor:n})=>{const s=o0.map(o=>({type:$.OPERATION,data:{title:o.name,value:o.value,icon:r.jsx("span",{className:"rounded-full w-[18px] h-[18px]",style:{backgroundColor:o.value}}),arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:t===o.value}})),a=({data:o})=>{In.emit("pdfCursorColor",o.value),n(o.value),e()};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:s,onItemClick:a})},OW=({className:e,pdfViewer:t})=>{const n=me(),[s,a]=F.useState(Gl.YELLOW),o=i=>{n.dropdown({popcorn:i.currentTarget,placement:"bottom",offset:[0,10],content:({onCloseModal:l})=>r.jsx(PW,{closeModal:l,pdfViewer:t,color:s,setColor:a})})};return r.jsxs("div",{className:B("flex items-center animate-hover p-1",e),onClick:o,children:[r.jsx("span",{className:"rounded-full w-[18px] h-[18px]",style:{backgroundColor:s}}),r.jsx(H,{size:"xxsmall",name:"IcArrow",className:"ml-1"})]})},Ck=()=>r.jsx("div",{className:"text-t2 text-grey4 flex justify-center w-full h-10 items-center",children:"正在搜索..."}),ov=40,MW=58,iv=256,yc=e=>r.jsx(Tk,{...e,className:"relative py-2.5 overflow-hidden next-modal w-60"}),Tk=e=>{const t=!!e.footer,{filterItems:n=[]}=e,{resultList:s,loading:a,hasMore:o,loadMore:i,onInputChange:l,firstTime:c}=Sx({defaultList:e.defaultValue,type:e.searchType,source:e.source,parentId:e.parentId,canSearchWithEmpty:e.canSearchWithEmpty,fileType:e.fileType,spaceId:e.spaceId});F.useEffect(()=>{e.canSearchWithEmpty&&l("")},[e.canSearchWithEmpty]);const u=(h,p)=>{var _;const g=s[p];g&&((_=e.onSelect)==null||_.call(e,g))},d=F.useMemo(()=>s.map(h=>({type:$.SEARCH,data:{uuid:h.uuid,title:de(h.data.segments)||h.title||Ot(h.type),avatarTitle:h.avatarTitle,icon:h.data.icon,navs:h.navs,type:h.type,backgroundColor:h.backgroundColor,...bn(Bn.moveToItem)}})).filter(h=>!n.includes(h.data.uuid)),[n,s]),f=F.useMemo(()=>{const h=t?40:0,p=e.header?30:0;if(d.length===0)return iv/2;if(d.length>5)return iv+ov/2+h;let g=0;return d.forEach(_=>{_.data.navs&&_.data.navs.length>0?g+=MW:g+=ov}),g+32+20+10+h+p},[d,t,e.header]);return r.jsxs("div",{className:B("relative",e.className),style:{height:f},children:[e.header,r.jsx(ze,{items:d,hasMore:o,loadMore:i,scrollContainerStyle:{top:e.header?"80px":"52px",paddingBottom:t?"40px":"0px"},onItemClick:u,customHeader:r.jsx(xt,{autoFocus:!0,className:"h-8 mx-2.5",...bn(Bn.moveToInput),placeholder:e.placeholder||"搜索页面",onChange:l}),loadingView:a&&r.jsx(Ck,{}),customFooter:r.jsxs(r.Fragment,{children:[a&&o&&r.jsxs("div",{className:"relative flex flex-row items-center justify-center h-10",children:[r.jsx(hs,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"正在加载..."})]}),!c&&!a&&d.length===0&&r.jsx("div",{className:"relative flex justify-center items-center h-10 text-t2 text-grey4",children:"没有找到相关结果"})]})}),e.footer]})},D2={filter:""},L6=e=>ae(({blocks:n})=>{const s=n[e];if(!s)return;const a={};return s==null||s.subNodes.forEach(o=>{var f;const i=n[o];if(!i)return;const{pdfAnnotation:l,localUrl:c}=i.data;if(!l)return;const u={...l,localUrl:c,uuid:o},{pageNumber:d}=l;a[d]=[...(f=a[d])!=null?f:[],u]}),Object.keys(a).forEach(o=>{const i=a[o];i&&(a[o]=nW(i))}),a}),lv=[{name:"所有标注",type:"all"},{name:"当前筛选范围",type:"filter"}],cv=[{name:"带引用链接的标注",type:"refBlock"},{name:"仅导出标注内容",ype:"AnnotationContent"}],P6=({onCloseModal:e,uuid:t})=>{const n=me(),s=ke(),a=Qt(),o=L6(t),[i,l]=F.useState(lv[0]),[c,u]=F.useState(cv[0]),[d,f]=F.useState({id:"",title:"创建新页面"}),h=y=>{n.dropdown({popcorn:y.currentTarget,placement:"bottom-end",offset:[0,10],content:({onCloseModal:b})=>r.jsx(ze,{className:"next-modal w-[180px] py-[5px] bg-white4",onItemClick:()=>b(),items:lv.map(E=>({type:$.OPERATION,data:{title:E.name,arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:(i==null?void 0:i.type)===E.type,onClick:()=>l(E)}}))})})},p=y=>{n.dropdown({popcorn:y.currentTarget,placement:"bottom-end",offset:[0,10],content:({onCloseModal:b})=>r.jsx(ze,{className:"next-modal w-[180px] py-[5px] bg-white4",onItemClick:()=>b(),items:cv.map(E=>({type:$.OPERATION,data:{title:E.name,arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:(c==null?void 0:c.type)===E.type,onClick:()=>u(E)}}))})})},g=async y=>{const b=y.currentTarget,E=Ut();(()=>{var T,v;const{blocks:k}=le(),C=((v=(T=k[E])==null?void 0:T.subNodes)!=null?v:[]).map(I=>{const j=k[I];if(j&&(j.type===m.BlockType.PAGE||j.type===m.BlockType.COLLECTION_VIEW||j.type===m.BlockType.COLLECTION_VIEW_PAGE))return Ax(j)}).filter(I=>!!I);n.dropdown({popcorn:b,placement:"bottom-end",offset:[0,10],content:({onCloseModal:I})=>r.jsx(yc,{onSelect:j=>{if(j.type!==m.BlockType.PAGE){ye.warning("不支持该页面类型");return}f({id:j.uuid,title:j.title}),I()},defaultValue:C,searchType:"page",footer:r.jsx("div",{className:"absolute bottom-0 w-full h-10 bg-white2 border-t border-grey6",children:r.jsxs("div",{className:"flex items-center justify-center h-full animate-hover",onClick:()=>{f({id:"",title:"创建新页面"}),I()},children:[r.jsx(H,{name:"MIcAddNew",size:"middle"}),r.jsx("div",{className:"ml-1.5 text-t2 text-grey3",children:"创建新页面"})]})}),source:"move"})})})()},_=[{title:"导出范围",name:i==null?void 0:i.name,onClick:h},{title:"导出内容",name:c==null?void 0:c.name,onClick:p},{title:"导出至页面",name:d.title,onClick:g}],x=()=>{ce.event("export_pdf_highlight",{file_id:t}),s(()=>{const y=Ut(),b=d.id||Qe({type:m.BlockType.PAGE,permissions:[{role:m.PermissionRole.EDITOR,type:m.PermissionType.USER,userId:a.uuid}]},{parentId:y,last:!0});Object.keys(o!=null?o:{}).sort((w,k)=>Number(w)-Number(k)).forEach(w=>{const k=o==null?void 0:o[w];k&&k.forEach(C=>{var T;if(!((i==null?void 0:i.type)==="filter"&&D2.filter&&C.color!==D2.filter))if(C.type===at.HIGHLIGHT){const v={enhancer:{},type:m.TextType.TEXT,text:(T=C.text)!=null?T:""};(c==null?void 0:c.type)==="refBlock"&&(v.type=m.TextType.MENTION_BLOCK,v.uuid=C.uuid),Qe({type:m.BlockType.TEXTAREA,data:{segments:[v]}},{parentId:b,last:!0})}else{const v={enhancer:{},type:m.TextType.TEXT,text:"图片标注.png"};(c==null?void 0:c.type)==="refBlock"?Qe({type:m.BlockType.REFERENCE,data:{ref:{uuid:C.uuid},display:"image",segments:[v]}},{parentId:b,last:!0}):Qe({type:m.BlockType.FILE,data:{display:"image",segments:[v],extName:"png",height:C.height,ossName:C.ossName,size:C.size,width:C.width}},{parentId:b,last:!0})}})}),window.open(`${Sn()}/${b}`),e()})};return r.jsxs("div",{className:"next-modal w-[360px] py-4",children:[_.map(({title:y,name:b,onClick:E})=>r.jsxs("div",{className:"flex justify-between items-center h-10 px-8",children:[r.jsx("span",{className:"text-t2 text-grey3",children:y}),r.jsxs("button",{className:B("flex items-center animate-hover p-1 text-t2 text-black"),onClick:E,children:[b,r.jsx(H,{size:"xxsmall",name:"IcArrow",className:"ml-2"})]})]},b)),r.jsxs("div",{className:"flex items-center justify-end mt-3.5 pr-8",children:[r.jsx(je,{onClick:e,className:"mr-2.5 text-t2",children:"取消"}),r.jsx(je,{colorType:"active",className:"text-t2-medium text-white",onClick:x,children:"导出"})]})]})},UW=({filterColor:e,setFilterColor:t,colorOptions:n})=>{const[s,a]=F.useState(e),o=n.map(l=>({type:$.OPERATION,data:{title:l.name,value:l.value,icon:r.jsx("span",{className:"rounded-full w-[18px] h-[18px]",style:{backgroundColor:l.value}}),arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:s===l.value}})),i=({data:l})=>{a(l.value),D2.filter=l.value,t(l.value)};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:o,onItemClick:i})},VW=({uuid:e,pdfViewer:t})=>{var h,p;const n=me(),[s,a]=F.useState(),o=L6(e),i=Ve(e),l=Object.keys(o!=null?o:{}).length===0,c=g=>{const _=new Set;Object.values(o!=null?o:{}).flat().forEach(y=>{_.add(y.color)});const x=[{type:$.OPERATION,data:{title:"所有标注",onClick:()=>a(void 0)}},{type:$.OPERATION,data:{title:"按颜色筛选",hasArrow:!0,disable:l,renderSubMenu:()=>r.jsx(UW,{filterColor:s,setFilterColor:a,colorOptions:o0.filter(y=>_.has(y.value))})}}];n.dropdown({popcorn:g.currentTarget,placement:"bottom-end",content:({onCloseModal:y})=>r.jsx(ze,{className:"next-modal w-[160px] py-[5px] bg-white4",items:x,onItemClick:()=>y()})})},u=g=>{const _=[{type:$.OPERATION,data:{icon:"IcUploadDocMenu",title:"导出标注",label:r.jsx("span",{className:"bg-grey6 text-t4 text-grey3 ml-1 rounded-sm px-1.5 py-0.5",children:"限免"}),onClick:()=>{n.modal({content:({onCloseModal:x})=>r.jsx(P6,{onCloseModal:x,uuid:e})})}}}];n.dropdown({popcorn:g.currentTarget,placement:"bottom",content:({onCloseModal:x})=>r.jsx(ze,{className:"next-modal w-[180px] py-[5px] bg-white4",items:_,onItemClick:()=>x()})})};if(!o)return null;const d=Object.keys(o!=null?o:{}).sort((g,_)=>Number(g)-Number(_)),f=(p=(h=o0.find(g=>g.value===s))==null?void 0:h.name)!=null?p:"所有标注";return r.jsxs("div",{className:"px-3",children:[r.jsx("div",{className:"text-grey3",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("button",{className:"text-t2 h-9 animate-hover flex items-center p-1",onClick:c,children:[f,r.jsx(H,{name:"IcArrow",className:"ml-1.5",size:"xxxsmall"})]}),!i&&r.jsx("button",{className:"p-1 animate-hover flex",onClick:u,children:r.jsx(H,{name:"IcMore",size:"middle"})})]})}),l&&r.jsx("div",{className:"text-center mt-2 text-grey3 text-t2",children:"当前暂无标注"}),d.map(g=>{const _=o[g];return _?r.jsx(zt.Fragment,{children:_.map(x=>{if(s&&x.color!==s)return null;const{uuid:y}=x;return r.jsx(qW,{uuid:y,pdfViewer:t},y)})},g):null})]})},qW=({uuid:e,pdfViewer:t})=>{var b;const n=ae(({blocks:E})=>E[e]),{pdfAnnotation:s,localUrl:a}=(b=n==null?void 0:n.data)!=null?b:{},{height:o,width:i,pageNumber:l,color:c,ossName:u,text:d,type:f}=s!=null?s:{},[h,p]=F.useState(a!=null?a:u),g=f&&N2(f),_=F.useRef(null),x=F.useRef(!1);F.useEffect(()=>{a?p(a):u&&x.current&&Ls.fetchDownloadUrl(e,u).then(E=>{p(E)})},[a,u,e]),F.useEffect(()=>{if(!g||!_.current||a||x.current)return;const E=new IntersectionObserver(async([w])=>{if(w!=null&&w.isIntersecting&&(x.current=!0,E.disconnect(),u)){const k=await Ls.fetchDownloadUrl(e,u);p(k)}},{rootMargin:"200px"});return E.observe(_.current),()=>{E.disconnect()}},[g,a,u,e]);const y=E=>{var C;const{pageNumber:w,point:k}=(C=um(E))!=null?C:{};!k||!w||t.scrollPageIntoView({pageNumber:w,destArray:[null,{name:"XYZ"},k.x,k.y+5,null]})};return s?r.jsxs("div",{ref:_,className:"animate-hover p-2 hover:bg-active_color_10",onClick:()=>y(s),children:[r.jsxs("p",{className:"text-t2-medium",children:["页面",l]}),r.jsx("div",{className:Yt("my-2 cursor-pointer rounded",g?"pl-1.5":"p-2 pl-3.5"),style:{background:`linear-gradient(to right, ${c} 6px, var(--white1) 6px)`},children:g?((h==null?void 0:h.startsWith("http"))||(h==null?void 0:h.startsWith("data:")))&&r.jsx("img",{src:h,width:i,height:o,className:"max-w-[calc(100%-6px)]"}):r.jsx("p",{className:"text-t2 line-clamp-3 text-ellipsis whitespace-pre-wrap",children:d})})]}):null},HW=({pdfViewer:e})=>{const[t,n]=F.useState([]),[s,a]=F.useState(!0);return F.useEffect(()=>{e.pdfDocument&&e.pdfDocument.getOutline().then(o=>{o&&n(o)}).catch(o=>{console.log(o)})},[e.pdfDocument]),F.useEffect(()=>{In.on("showOutline",o=>{a(o)})},[]),s?r.jsx("div",{className:"select-none px-2",children:r.jsx(O6,{outlines:t,deep:0,pdfViewer:e})}):null},O6=({outlines:e,deep:t,pdfViewer:n})=>r.jsx("div",{children:e.map(s=>r.jsx($W,{outline:s,pdfViewer:n,deep:t},s.title))}),$W=({outline:e,pdfViewer:t,deep:n})=>{const[s,a]=F.useState(!1),{title:o,items:i,dest:l}=e,c=()=>{l&&t.linkService.goToDestination(l)},u=i.length>0,d=r.jsx(H,{size:"middle",name:u?"IcNaviFold":"IcNaviDot",className:B(s&&"rotate-90"),onClick:f=>{f.stopPropagation(),a(!s)}});return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex cursor-pointer items-center pl-1 hover:bg-active_color_10 p-2 rounded",style:{paddingLeft:`${n*16}px`},onClick:c,children:[d,r.jsx("p",{className:"flex-1 text-t2-medium text-ellipsis",children:o})]}),u&&s&&r.jsx(O6,{outlines:i,deep:n+1,pdfViewer:t})]})},GW=({reason:e,onPassword:t,onCancel:n,uuid:s})=>{const a=F.useRef(null),o=Ve(s),[i,l]=F.useState(!0);return r.jsxs("div",{className:"flex flex-col next-modal px-[30px] w-[400px] pb-[30px]",children:[r.jsx("p",{className:"text-t1-medium mt-[30px] text-center",children:"请输入 PDF 访问密码"}),r.jsx("input",{autoFocus:!0,type:"text",ref:a,className:B("border border-black/5 text-t2 rounded px-3 py-1.5 mt-5 bg-grey8",e===2&&"border-red"),onKeyDown:c=>{be("enter")(c)&&t(c.target.value,i)}}),e===2&&r.jsx("span",{className:"text-red text-t4 mt-1",children:"密码输入错误"}),!o&&r.jsxs("button",{className:"flex text-t4 h-8 items-center",onClick:()=>l(!i),children:[r.jsx(H,{size:"large",name:i?"IcCheckboxCheck":"IcCheckbox",className:"mr-1 text-active_color"}),"记住密码"]}),r.jsxs("div",{className:"flex justify-end mt-2",children:[r.jsx(je,{onClick:n,children:"取消"}),r.jsx(je,{colorType:"active",className:"ml-2.5",onClick:()=>{a.current&&t(a.current.value,i)},children:"确定"})]})]})},zW=({pdfId:e,annotation:t,application:n,closeModal:s})=>{const a=ke(),o=t.type!==at.HIGHLIGHT,i=[{type:$.OPERATION,data:{icon:"IcMenuColor",title:"高亮颜色",hasArrow:!0,renderSubMenu:()=>r.jsx(WW,{application:n,annotation:t})}},{type:$.LINE},{type:$.OPERATION,isHidden:!o,data:{title:"复制为图片块引用",onClick:()=>{const c=`{"annotationId": "${t.uuid}", "type": "imageBlock"}`;on(c)}}},{type:$.OPERATION,data:{title:o?"复制为行内图片引用":"复制为行内引用",onClick:()=>{ce.event("copy_pdf_quote",{file_id:e});const c=`{"annotationId": "${t.uuid}"}`;on(c)}}},{type:$.OPERATION,data:{title:"复制标注内容",onClick:async()=>{var c,u;if(ce.event("copy_highlight_content",{file_id:e}),t.type===at.HIGHLIGHT)on((c=t.text)!=null?c:"");else if((u=t.url)!=null&&u.startsWith("data:")){const d=j2(t.url);if(!d)return;const f=new ClipboardItem({"image/png":d});navigator.clipboard.write([f])}else{if(!t.ossName)return;const d=await Ls.fetchDownloadUrl(t.uuid,t.ossName),h=await(await fetch(d)).blob(),p=new ClipboardItem({"image/png":h});navigator.clipboard.write([p])}ye.success("复制成功！"),s==null||s()}}},{type:$.OPERATION,data:{title:"复制访问链接",onClick:async()=>{var u,d;ce.event("copy_highlight_link",{file_id:e});const c=um(t);c&&(on(`${Sn()}/preview/${e}?annotationPos=${t.pageNumber},${(u=c.point)==null?void 0:u.x},${(d=c.point)==null?void 0:d.y}`),s==null||s())}}},{type:$.LINE},{type:$.OPERATION,data:{title:"清除高亮",onClick:()=>{a(()=>{Gs(t.uuid),n.deleteAnnotation(t)}),s==null||s()}}}],l=()=>{};return r.jsx(ze,{className:"next-modal w-[210px] py-[5px]",items:i,onItemClick:l})},WW=({annotation:e,application:t})=>{const n=ke(),s=A6(),[a,o]=F.useState(e.color),i=o0.map(c=>({type:$.OPERATION,data:{title:c.name,value:c.value,icon:r.jsx("span",{className:"rounded-full w-[18px] h-[18px]",style:{backgroundColor:c.value}}),arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:a===c.value}})),l=({data:c})=>{o(c.value),t.updateAnnotation({...e,color:c.value}),n(()=>{s(e.uuid,{color:c.value})})};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:i,onItemClick:l})},Bl=({fileName:e,className:t,addonAfter:n})=>{const{name:s,extName:a}=sn(e),[o,i]=T$(s);return r.jsxs("div",{className:B("flex w-full whitespace-nowrap",t),children:[o?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-ellipsis sm:min-w-[2em]",children:o}),r.jsx("span",{children:i}),r.jsx("span",{children:`${s?".":""}${a}`})]}):r.jsx("span",{className:"text-ellipsis sm:min-w-[2em]",children:e}),n]})},Jx=async e=>{var s;const{results:t,recordMap:n}=await Ce.infra.getSpaceGuests(e);Ye({$guestsList:t}),ee(El.updateSpaceUsers({users:(s=n.users)!=null?s:{},space:Tn()})),ee(Gn.update({blocks:n.blocks}))},Ka=(e,t,n=!1)=>{const s=qe(),a=le().blocks[t.parentId];if(!a)return;const o=Date.now(),i={uuid:s,spaceId:a.spaceId,status:1,parentId:t.parentId,createdAt:o,updatedAt:o,version:0,...e};return ee(jm({collectionView:i,ignoreOp:n})),t.first||t.before?ee(sm({uuid:s,parentId:t.parentId,before:t.before,ignoreOp:n})):ee(fd({uuid:s,parentId:t.parentId,after:t.after,ignoreOp:n})),s},M6=e=>{const{collectionViews:t}=le(),n=t[e];n&&(ee(oc({uuid:e,patch:{status:-1}})),ee(rm({uuid:e,parentId:n.parentId})))};function Zt(e,t=le().blocks,n=le().collectionViews){var i,l,c,u,d,f,h,p,g,_,x,y,b,E;let s;typeof e=="string"?s=n[e]:s=e;let a=t[(i=s==null?void 0:s.parentId)!=null?i:""];if(a&&(a.type===m.BlockType.REFERENCE_COLLECTION||a.type===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(a=t[(c=(l=a.data.ref)==null?void 0:l.uuid)!=null?c:""]),!s||!a)return;const o={view:s,collection:a};switch(s.type){case m.CollectionViewType.BOARD:return{...o,propertiesName:"boardProperties",groupBy:s.format.boardGroupBy,subGroupBy:s.format.collectionGroupBy,groups:s.format.boardGroups,subGroups:s.format.collectionGroups,cardSize:(u=s.format.boardCardSize)!=null?u:m.CardSize.MEDIUM,coverType:s.format.boardCoverType,properties:(d=s.format.boardProperties)!=null?d:[],coverAspectType:s.format.boardCoverAspect};case m.CollectionViewType.GALLERY:return{...o,propertiesName:"galleryProperties",groupBy:s.format.collectionGroupBy,groups:s.format.collectionGroups,cardSize:(f=s.format.galleryCardSize)!=null?f:m.CardSize.MEDIUM,coverType:s.format.galleryCoverType,properties:(h=s.format.galleryProperties)!=null?h:[],coverAspectType:s.format.galleryCoverAspect};case m.CollectionViewType.LIST:return{...o,propertiesName:"listProperties",groupBy:s.format.collectionGroupBy,groups:s.format.collectionGroups,properties:(p=s.format.listProperties)!=null?p:[]};case m.CollectionViewType.TIMELINE:return{...o,propertiesName:"timelineProperties",groupBy:s.format.collectionGroupBy,groups:s.format.collectionGroups,properties:(g=s.format.timelineProperties)!=null?g:[],timelineTableProperties:(_=s.format.timelineTableProperties)!=null?_:[],timelineBy:s.format.timelineBy,timelineByEnd:s.format.timelineByEnd,timelineShowTable:s.format.timelineShowTable!==!1};case m.CollectionViewType.CALENDAR:return{...o,propertiesName:"calendarProperties",properties:(x=s.format.calendarProperties)!=null?x:[],calendarBy:s.format.calendarBy,calendarByEnd:s.format.calendarByEnd};case m.CollectionViewType.FORM:return{...o,propertiesName:"formProperties",properties:(y=s.format.formProperties)!=null?y:[],formLogic:(b=s.format.formLogic)!=null?b:[]};default:return{...o,propertiesName:"tableProperties",groupBy:s.format.collectionGroupBy,groups:s.format.collectionGroups,properties:(E=s.format.tableProperties)!=null?E:[]}}}const Kn=(e,t,n)=>{const s=Zt(e);if(!s)return;const{view:a}=s;n||pe(a.parentId,{}),ee(oc({uuid:e,patch:{...t,updatedAt:Date.now()},ignoreOp:n}))},Zc=(e,t)=>{Di(()=>{Kn(e,t)})},yt=(e,t,n=!1)=>{Di(()=>{Kn(e,{format:t},n)})},vk=(e,t)=>{var s;const n={};return(s=e.permissions)==null||s.forEach(a=>{if(a.type==="user"&&a.userId){const o=t[a.userId];o&&(n[a.userId]=o)}}),n},Va=()=>{const e=Ft();return ae(t=>vk(e,t.users))},KW=()=>{const e=Ft();return ae(t=>{const n=vk(e,t.users);return Object.keys(n).length})},txe=()=>{const e=Tn();return vk(e,K.users)},Ta={invitePage:`${Mt}/share/a84fff54-ca15-4516-8959-e1b50890dde0`,sharePageLink:`${Mt}/share/478fbe3f-8074-48ac-9357-6f0af02b894b`,shareFormLink:`${Mt}/share/6e310b4f-cf88-4a02-8092-1a6a7b0240e0`,bitableLink:`${Mt}/share/689e1d3e-04ab-4388-bba4-8e6085b15b26`,tableViewLink:`${Mt}/share/e3041662-4374-4169-b5a8-60347781b879`,boardViewLink:`${Mt}/share/8646a5e1-ba30-4de4-8c40-03842dbf7bb3`,galleryViewLink:`${Mt}/share/875d347e-10e6-43c0-bed2-f56764946f2f`,listViewLink:`${Mt}/share/d6926b36-62cf-4f65-95d8-5af9550ac6c8`,timeViewLink:`${Mt}/share/e2d0c9d4-ca1d-4993-a2ab-ed75ff3cf86c`,calendarViewLink:`${Mt}/share/09b243c8-d310-4230-9a8a-882af611b281`,formViewLink:`${Mt}/share/3f4e57ad-ecdc-4a48-877a-519484cfaf09`,cancelAccount:`${Mt}/share/3c4d3d0e-f0d3-4ed3-a70c-ee0e7d44ae7d`,upgradeSpace:`${Mt}/share/769d984e-40b0-416b-9046-573439737dd0`},Nk=({className:e,link:t,popup:n})=>r.jsx(Fe,{popup:n,children:r.jsx("a",{href:t,target:"_blank",rel:"noreferrer",onClick:s=>{s.stopPropagation()},children:r.jsx(H,{name:"IcInviteHelp",size:"small",className:B("ml-1 text-grey4 animate-click",e)})})}),eu=({iconClassName:e,className:t,children:n,link:s,beforeIcon:a,popup:o,linkContainer:i})=>{const l=r.jsx(Nk,{popup:o,link:s,className:B("text-grey4 flex items-center",a?"mr-1":"ml-1",i&&"pointer-events-none",e)}),c=r.jsxs(r.Fragment,{children:[a&&l,n,!a&&l]});return i?r.jsx(Fe,{popup:o,children:r.jsx("div",{className:B("flex items-center animate-click",t),onClick:()=>{s&&dg(s)},children:c})}):r.jsx("div",{className:B("flex items-center",t),children:c})},S2=[{groupCn:"常量",groupEn:"Constants",list:[{description:"自然常数，自然对数的底数",examples:"e == 2.718281828459045",resultType:"number",syntax:"e",title:"e"},{description:"圆周率",examples:"pi == 3.141592653589793",resultType:"number",syntax:"pi",title:"pi"},{description:"真（true）",examples:'(true ? "是" : "否") == "是"',resultType:"boolean",syntax:"true",title:"true"},{description:"假（false）",examples:'(false ? "是" : "否") == "否"',resultType:"boolean",syntax:"false",title:"false"}]},{groupCn:"运算",groupEn:"Operators",list:[{description:"根据条件判断，在两个选项中返回值",examples:`(true ? 1 : -1) == 1
if(false, "是", "否") == "否"`,resultType:"string",syntax:`boolean ? value_if_true : value_if_false
if(boolean, value_if_true, value_if_false)`,title:"if"},{description:"将两个数字相加返回和",examples:`1 + 1 == 2
add(2, 2) == 4`,resultType:"number",syntax:`number + number
add(number, number)`,title:"add"},{description:"将两个数字相减返回差",examples:`100 - 99 == 1
subtract(1, 2) == -1`,resultType:"number",syntax:`number - number
subtract(number, number)`,title:"subtract"},{description:"将两个数字相乘返回乘积",examples:`9 * 9 == 81
multiply(5, 100) == 500`,resultType:"number",syntax:`number * number
multiply(number, number)`,title:"multiply"},{description:"将两个数字相除返回商",examples:`12 / 4 == 3
divide(12, 3) == 4`,resultType:"number",syntax:`number / number
divide(number, number)`,title:"divide"},{description:"将底数根据指数进行乘方，返回乘幂",examples:`5 ^ 3 == 125
pow(2, 6) == 64`,resultType:"number",syntax:`number ^ number
pow(number, number)`,title:"pow"},{description:"将两个数字相除返回余数",examples:`7 % 5 == 2
mod(3, 3) == 0`,resultType:"number",syntax:`number % number
mod(number, number)`,title:"mod"},{description:"返回数字负数",examples:`-1 + 2 == 1
unaryMinus(42) == -42`,resultType:"number",syntax:`- number
unaryMinus(number)`,title:"unaryMinus"},{description:"返回数字本身",examples:"+ 42 == 42",resultType:"number",syntax:`+ value
unaryPlus(value)`,title:"unaryPlus"},{description:"将条件参数进行逻辑“非”运算，取反",examples:`(not true) == false
not(false) == true`,resultType:"boolean",syntax:`not boolean
not (boolean)`,title:"not"},{description:"将两个参数进行逻辑”与”运算，若均为真（true），则返回真（true）；否则反之",examples:`(true and false) == false
and(true, true) == true`,resultType:"boolean",syntax:`boolean and boolean
and(boolean, boolean)`,title:"and"},{description:"将两个参数进行逻辑“或”运算，若均为假（false），则返回假（false）；否则反之",examples:`(false or true) == true
or(false, false) == false`,resultType:"boolean",syntax:`boolean or boolean
or(boolean, boolean)`,title:"or"},{description:"判断两个参数是否相等，若相等，则返回真（true）；否则反之",examples:`(1 == 1) == true
equal(1, 0) == false`,resultType:"boolean",syntax:`value == value
equal(value, value)`,title:"equal"},{description:"判断两个参数是否不相等，若不相等，则返回（true）；否则反之",examples:`(6 * 9 != 42) == true
unequal(true, not false) == false`,resultType:"boolean",syntax:`value != value
unequal(value, value)`,title:"unequal"},{description:"比较两个参数大小，如果首个参数大于第二个参数，则返回真（true）；否则反之",examples:"(5 > 3) == true",resultType:"boolean",syntax:`text > text
boolean > boolean
date > date
number > number
larger(text, text)
larger(boolean, boolean)
larger(date, date)
larger(number, number)`,title:"larger"},{description:"比较两个参数大小，如果首个参数大于等于第二个参数，则返回真（true）；否则反之",examples:`(5 >= 3) == true
(4 >= 4) == true`,resultType:"boolean",syntax:`text >= text
boolean >= boolean
date >= date
number >= number
largerEq(text, text)
largerEq(boolean, boolean)
largerEq(date, date)
largerEq(number, number)`,title:"largerEq"},{description:"比较两个参数大小，如果首个参数小于第二个参数，则返回真（true）；否则反之",examples:"(10 < 8) == false",resultType:"boolean",syntax:`text < text
boolean < boolean
date < date
number < number
smaller(text, text)
smaller(boolean, boolean)
smaller(date, date)
smaller(number, number)`,title:"smaller"},{description:"比较两个参数大小，如果首个参数小于等于第二个参数，则返回真（true）；否则反之",examples:`(10 <= 8) == false
(8 <= 8) == true`,resultType:"boolean",syntax:`text <= text
boolean <= boolean
date <= date
number <= number
smallerEq(text, text)
smallerEq(boolean, boolean)
smallerEq(date, date)
smallerEq(number, number)`,title:"smallerEq"}]},{groupCn:"函数",groupEn:"Functions",list:[{description:"将多个字符串相连返回结果",examples:`"Flow" + "Us" == "FlowUs"
concat("Flow", "Us") == "FlowUs"`,resultType:"string",syntax:"concat(text...)",title:"concat"},{description:"将首个字符串插入到其它字符串之间相连，返回结果",examples:'join("!", "大", "家", "好") == "大!家!好"',resultType:"string",syntax:"join(text...)",title:"join"},{description:"将字符串进行切割，通过指定的开始/结束索引提取并返回子字符串",examples:`slice("FlowUs", 4, 5) == "Us"
slice("FlowUs", 2) == "owUs"`,resultType:"string",syntax:`slice(text, number)
slice(text, number, number)`,title:"slice"},{description:"返回字符串长度",examples:'length("FlowUs") == 6',resultType:"number",syntax:"length(text)",title:"length"},{description:"将参数转换为字符串",examples:`format(true) == "true"
format(111) === "111"
format(now()) == "2022-04-19 12:56:45"`,resultType:"string",syntax:"format(value)",title:"format"},{description:"将参数转换为数字",examples:`toNumber(true) == 1
toNumber("111") == 111`,resultType:"number",syntax:"toNumber(value)",title:"toNumber"},{description:"判断字符串是否包含另一个字符串，如果第一个参数包含第二个参数，则返回真（true）；否则反之",examples:'contains("FlowUs", "Us") == true',resultType:"boolean",syntax:"contains(text, text)",title:"contains"},{description:"将参数中首位匹配正则表达式的内容替换为其它内容，返回结果",examples:'replace("a-b-c", "-", "&") == "a&b-c"',resultType:"string",syntax:`replace(value, text, text)
`,title:"replace"},{description:"将参数中全部匹配正则表达式的内容替换为其它内容，返回结果",examples:'replaceAll("a-b-c", "-", "&") == "a&b&c"',resultType:"string",syntax:"replaceAll(value, text, text)",title:"replaceAll"},{description:"判断字符串是否匹配正则表达式，若是则返回真（true），否则反之",examples:'test("a-b-c","-") == true',resultType:"boolean",syntax:"test(value, text)",title:"test"},{description:"判断值是否为空，若是则返回真（true）",examples:'empty(prop("姓名")) == true',resultType:"boolean",syntax:"empty(value)",title:"empty"},{description:"返回数字绝对值",examples:"abs(-1) == 1",resultType:"number",syntax:"abs(number)",title:"abs"},{description:"返回数字的立方根",examples:"cbrt(27) == 3",resultType:"number",syntax:"cbrt(number)",title:"cbrt"},{description:"将数字向上取整返回结果",examples:"ceil(18.1) == 19",resultType:"number",syntax:"ceil(number)",title:"ceil"},{description:"将自然常数 e 根据指数进行乘方，返回乘幂",examples:"exp(1) == 2.718281828459045",resultType:"number",syntax:"exp(number)",title:"exp"},{description:"将数字向下取整返回结果",examples:"floor(3.9) == 3",resultType:"number",syntax:"floor(number)",title:"floor"},{description:"返回数字的自然对数",examples:"ln(e) == 1",resultType:"number",syntax:"ln(number)",title:"ln"},{description:"返回数字以10为底数的对数",examples:"log10(10000) == 4",resultType:"number",syntax:"log10(number)",title:"log10"},{description:"返回数字以2为底数的对数",examples:"log2(8) == 3",resultType:"number",syntax:"log2(number)",title:"log2"},{description:"将多个数字比较，返回最大值",examples:"max(9, 2, 100, 89) == 100",resultType:"number",syntax:"max(number...)",title:"max"},{description:"将多个数字比较，返回最小值",examples:"min(9, 2, 100, 89) == 2",resultType:"number",syntax:"min(number...)",title:"min"},{description:"将数字四舍五入取整返回结果",examples:`round(0.4) == 0
round(0.5) == 1`,resultType:"number",syntax:"round(number)",title:"round"},{description:"判断数字的符号位，返回正数（1），负数（-1）或 0",examples:`sign(100) == 1
sign(-2) == -1
sign(0) == 0`,resultType:"number",syntax:"sign(number)",title:"sign"},{description:"返回数字的平方根",examples:"sprt(81) == 9 ",resultType:"number",syntax:"sprt(number)",title:"sqrt"},{description:"返回当时前日期和时间",examples:"now() == 2022/01/01 00:00",resultType:"date",syntax:"now()",title:"now"},{description:"返回指定日期时间值的时间戳，即从 1970 年 1 月 1 日开始计的 UNIX 毫秒数",examples:"timestamp(now()) == 1650467710637",resultType:"number",syntax:"timestamp(date)",title:"timestamp"},{description:"返回指定时间戳对应的日期时间",examples:'format(fromTimestamp(1614127553)) == "2022-04-20 23:15:10"',resultType:"date",syntax:"fromTimestamp(number)",title:"fromTimestamp"},{description:"在日期时间中增加时间间隔。最后的参数为“单位”，可选值为“years”（年），“quarters”(季度)，“months”（月），“weeks”（周），“days”（日），“hours”（小时），“minutes”（分钟），“seconds”（秒），“milliseconds”（毫秒）。",examples:'dateAdd(prop("开始时间"),  50, "hours")',resultType:"date",syntax:"dateAdd(date, number, text)",title:"dateAdd"},{description:"在日期时间中减去时间间隔。最后的参数为“单位”，可选值为“years”（年），“quarters”(季度)，“months”（月），“weeks”（周），“days”（日），“hours”（小时），“minutes”（分钟），“seconds”（秒），“milliseconds”（毫秒）。",examples:'dateSubtract(prop("开始时间"),  2, "months")',resultType:"date",syntax:"dateSubtract(date, number, text)",title:"dateSubtract"},{description:"对两个日期时间进行运算，返回时间间隔。最后的参数为“单位”，可选值为“years”（年），“quarters”(季度)，“months”（月），“weeks”（周），“days”（日），“hours”（小时），“minutes”（分钟），“seconds”（秒），“milliseconds”（毫秒）。",examples:'dateBetween(prop("开始时间"),  prop("结束时间"), "months") == 2',resultType:"number",syntax:"dateBetween(date, date, text)",title:"dateBetween"},{description:"对日期时间进行格式化，返回对应格式的字符串",examples:`formatDate(now(), "MMMM D YYYY, HH:mm") == "二月 24 2021, 08:45"
formatDate(now(), "YYYY/MM/DD, HH:mm") == "2021/02/24, 08:45"
formatDate(now(), "MM/DD/YYYY, HH:mm") == "02/24/2021, 08:45"
formatDate(now(), "HH:mm A") == "08:45 AM"
formatDate(now(), "M/D/YY") == "2/24/21"`,resultType:"string",syntax:"formatDate(date, text)",title:"formatDate"},{description:"返回日期时间中的 0 - 59 整数分钟数",examples:"minute(now()) == 45",resultType:"number",syntax:"minute(date)",title:"minute"},{description:"返回日期时间中的 0 - 23 整数小时数",examples:"hour(now()) == 8",resultType:"number",syntax:"hour(date)",title:"hour"},{description:"返回日期时间为星期中的第几天，0 - 6 整数，0 表示星期日，以此类推",examples:"day(now()) == 2",resultType:"number",syntax:"day(date)",title:"day"},{description:"返回日期时间为月中的第几天",examples:"date(now()) == 24",resultType:"number",syntax:"date(date)",title:"date"},{description:"返回日期时间中的月份",examples:"month(now()) == 2",resultType:"number",syntax:"month(date)",title:"month"},{description:"返回日期时间中的年份",examples:"year(now()) == 2021",resultType:"number",syntax:"year(date)",title:"year"},{description:"返回记录的唯一 id",examples:'id() == "e68380be-23cf-42c4-9b95-23a52713213d"',resultType:"string",syntax:"id()",title:"id"}]}],R2={};(function(e,t){e.formula=e.formula||{};var n=function(){return D.__string_rec(this,"")},s=s||{},a;function o(N,O){var G=Object.create(N);for(var J in O)G[J]=O[J];return O.toString!==Object.prototype.toString&&(G.toString=O.toString),G}var i=function(){};i.__name__=!0,i.__format_get=function(N,O){switch(O){case"%":return"%";case"A":return i.DAY_NAMES[N.getDay()];case"B":return i.MONTH_NAMES[N.getMonth()];case"C":return f.lpad(d.string(N.getFullYear()/100|0),"0",2);case"D":return i.__format(N,"%m/%d/%y");case"F":return i.__format(N,"%Y-%m-%d");case"I":case"l":var G=N.getHours()%12;return f.lpad(d.string(G==0?12:G),O=="I"?"0":" ",2);case"M":return f.lpad(d.string(N.getMinutes()),"0",2);case"R":return i.__format(N,"%H:%M");case"S":return f.lpad(d.string(N.getSeconds()),"0",2);case"T":return i.__format(N,"%H:%M:%S");case"Y":return d.string(N.getFullYear());case"a":return i.DAY_SHORT_NAMES[N.getDay()];case"b":case"h":return i.MONTH_SHORT_NAMES[N.getMonth()];case"d":return f.lpad(d.string(N.getDate()),"0",2);case"e":return d.string(N.getDate());case"H":case"k":return f.lpad(d.string(N.getHours()),O=="H"?"0":" ",2);case"m":return f.lpad(d.string(N.getMonth()+1),"0",2);case"n":return`
`;case"p":return N.getHours()>11?"PM":"AM";case"r":return i.__format(N,"%I:%M:%S %p");case"s":return d.string(N.getTime()/1e3|0);case"t":return"	";case"u":var J=N.getDay();return J==0?"7":J==null?"null":""+J;case"w":return d.string(N.getDay());case"y":return f.lpad(d.string(N.getFullYear()%100),"0",2);default:throw new R("Date.format %"+O+"- not implemented yet.",null,{fileName:"DateTools.hx",lineNumber:101,className:"DateTools",methodName:"__format_get"})}},i.__format=function(N,O){for(var G="",J=0;;){var se=O.indexOf("%",J);if(se<0)break;var xe=se-J;G+=xe==null?c.substr(O,J,null):c.substr(O,J,xe),G+=d.string(i.__format_get(N,c.substr(O,se+1,1))),J=se+2}var xe=O.length-J;return G+=xe==null?c.substr(O,J,null):c.substr(O,J,xe),G},i.format=function(N,O){return i.__format(N,O)};var l=function(N,O){this.r=new RegExp(N,O.split("u").join(""))};l.__name__=!0,l.prototype={match:function(N){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(N),this.r.s=N,this.r.m!=null},matched:function(N){if(this.r.m!=null&&N>=0&&N<this.r.m.length)return this.r.m[N];throw I.thrown("EReg::matched")},matchedPos:function(){if(this.r.m==null)throw I.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(N,O,G){if(G==null&&(G=-1),this.r.global){this.r.lastIndex=O,this.r.m=this.r.exec(G<0?N:c.substr(N,0,O+G));var J=this.r.m!=null;return J&&(this.r.s=N),J}else{var J=this.match(G<0?c.substr(N,O,null):c.substr(N,O,G));return J&&(this.r.s=N,this.r.m.index+=O),J}},map:function(N,O){for(var G=0,J="";!(G>=N.length);){if(!this.matchSub(N,G)){J+=d.string(c.substr(N,G,null));break}var se=this.matchedPos();if(J+=d.string(c.substr(N,G,se.pos-G)),J+=d.string(O(this)),se.len==0?(J+=d.string(c.substr(N,se.pos,1)),G=se.pos+1):G=se.pos+se.len,!this.r.global)break}return!this.r.global&&G>0&&G<N.length&&(J+=d.string(c.substr(N,G,null))),J}};var c=function(){};c.__name__=!0,c.dateStr=function(N){var O=N.getMonth()+1,G=N.getDate(),J=N.getHours(),se=N.getMinutes(),xe=N.getSeconds();return N.getFullYear()+"-"+(O<10?"0"+O:""+O)+"-"+(G<10?"0"+G:""+G)+" "+(J<10?"0"+J:""+J)+":"+(se<10?"0"+se:""+se)+":"+(xe<10?"0"+xe:""+xe)},c.cca=function(N,O){var G=N.charCodeAt(O);if(G==G)return G},c.substr=function(N,O,G){if(G==null)G=N.length;else if(G<0)if(O==0)G=N.length+G;else return"";return N.substr(O,G)},c.now=function(){return Date.now()};var u=function(){};u.__name__=!0,u.fold=function(N,O,G){for(var J=It(N);J.hasNext();)G=O(J.next(),G);return G},Math.__name__=!0;var d=function(){};d.__name__=!0,d.string=function(N){return D.__string_rec(N,"")},d.parseInt=function(N){if(N!=null)for(var O=0,G=N.length;O<G;){var J=O++,se=N.charCodeAt(J);if(se<=8||se>=14&&se!=32&&se!=45){var xe=N.charCodeAt(J+1),Be=parseInt(N,xe==120||xe==88?16:10);return isNaN(Be)?null:Be}}return null};var f=function(){};f.__name__=!0,f.isSpace=function(N,O){var G=c.cca(N,O);return G>8&&G<14?!0:G==32},f.ltrim=function(N){for(var O=N.length,G=0;G<O&&f.isSpace(N,G);)++G;return G>0?c.substr(N,G,O-G):N},f.rtrim=function(N){for(var O=N.length,G=0;G<O&&f.isSpace(N,O-G-1);)++G;return G>0?c.substr(N,0,O-G):N},f.trim=function(N){return f.ltrim(f.rtrim(N))},f.lpad=function(N,O,G){if(O.length<=0)return N;var J="";for(G-=N.length;J.length<G;)J+=O==null?"null":""+O;return J+=N==null?"null":""+N,J};var h=s["datetime.DTPeriod"]={__ename__:!0,__constructs__:null,Year:(a=function(N){return{_hx_index:0,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Year",a.__params__=["n"],a),Month:(a=function(N){return{_hx_index:1,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Month",a.__params__=["n"],a),Day:(a=function(N){return{_hx_index:2,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Day",a.__params__=["n"],a),Hour:(a=function(N){return{_hx_index:3,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Hour",a.__params__=["n"],a),Minute:(a=function(N){return{_hx_index:4,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Minute",a.__params__=["n"],a),Second:(a=function(N){return{_hx_index:5,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Second",a.__params__=["n"],a),Week:(a=function(N){return{_hx_index:6,n:N,__enum__:"datetime.DTPeriod",toString:n}},a._hx_name="Week",a.__params__=["n"],a)};h.__constructs__=[h.Year,h.Month,h.Day,h.Hour,h.Minute,h.Second,h.Week];var p=s["datetime.DTSnap"]={__ename__:!0,__constructs__:null,Year:(a=function(N){return{_hx_index:0,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Year",a.__params__=["direction"],a),Month:(a=function(N){return{_hx_index:1,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Month",a.__params__=["direction"],a),Day:(a=function(N){return{_hx_index:2,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Day",a.__params__=["direction"],a),Hour:(a=function(N){return{_hx_index:3,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Hour",a.__params__=["direction"],a),Minute:(a=function(N){return{_hx_index:4,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Minute",a.__params__=["direction"],a),Second:(a=function(N){return{_hx_index:5,direction:N,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Second",a.__params__=["direction"],a),Week:(a=function(N,O){return{_hx_index:6,direction:N,day:O,__enum__:"datetime.DTSnap",toString:n}},a._hx_name="Week",a.__params__=["direction","day"],a)};p.__constructs__=[p.Year,p.Month,p.Day,p.Hour,p.Minute,p.Second,p.Week];var g={};g.now=function(){return Math.floor(new Date().getTime()/1e3)+62135596800},g.local=function(){return Math.floor(new Date().getTime()/1e3)+62135596800-62135596800+g.getLocalOffset()+62135596800},g.make=function(N,O,G,J,se,xe){return xe==null&&(xe=0),se==null&&(se=0),J==null&&(J=0),G==null&&(G=1),O==null&&(O=1),N==null&&(N=1970),w.yearToStamp(N)+b.toSeconds(O,N%4==0&&(N%100==0?N%400==0:!0))+(G-1)*86400+J*3600+se*60+xe-62135596800+62135596800},g.fromTime=function(N){return N+62135596800},g.fromString=function(N){return w.fromString(N)},g.fromDate=function(N){return Math.floor(N.getTime()/1e3)+62135596800},g.daysInMonth=function(N,O){return O==null&&(O=!1),b.days(N,O)},g.weeksInYear=function(N){var O=w.yearToStamp(N)-62135596800+62135596800,G=g.getWeekDay(O);return G==4||G==3&&g.isLeapYear(O)?53:52},g.isLeap=function(N){return N%4==0?N%100==0?N%400==0:!0:!1},g.getLocalOffset=function(){var N=new Date,O=N.getFullYear(),G=N.getMonth()+1,J=N.getDate(),se=N.getHours(),xe=N.getMinutes(),Be=N.getSeconds();return Be==null&&(Be=0),xe==null&&(xe=0),se==null&&(se=0),J==null&&(J=1),G==null&&(G=1),O==null&&(O=1970),w.yearToStamp(O)+b.toSeconds(G,O%4==0&&(O%100==0?O%400==0:!0))+(J-1)*86400+se*3600+xe*60+Be-62135596800+62135596800-62135596800-(N.getTime()/1e3|0)|0},g._new=function(N){return N+62135596800},g.utc=function(N){return N-62135596800-g.getLocalOffset()+62135596800},g.getYear=function(N){var O=(N/12622780800|0)*12622780800,G=((N-O)/3155673600|0)*3155673600;G>9467020800&&(G-=3155673600);var J=((N-O-G)/126230400|0)*126230400,se=(N-O-G-J)/31536e3|0;return(O/12622780800|0)*400+(G/3155673600|0)*100+(J/126230400|0)*4+(se==4?se:se+1)},g.yearStart=function(N){var O=(N/12622780800|0)*12622780800,G=((N-O)/3155673600|0)*3155673600;G>9467020800&&(G-=3155673600);var J=((N-O-G)/126230400|0)*126230400,se=(N-O-G-J)/31536e3|0;return se==4&&--se,O+G+J+se*31536e3-62135596800},g.monthStart=function(N,O){return O==null&&(O=0),O==0&&(O=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))),g.yearStart(N)+b.toSeconds(O,g.isLeapYear(N))},g.getMonthStart=function(N,O){return g.monthStart(N,O)+62135596800},g.isLeapYear=function(N){var O=g.getYear(N);return O%4==0?O%100==0?O%400==0:!0:!1},g.getMonth=function(N){return b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))},g.getDay=function(N){return b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))},g.daysInThisMonth=function(N){var O=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N));return b.days(O,O==2&&g.isLeapYear(N))},g.getYearDay=function(N){return((N-62135596800-g.yearStart(N))/86400|0)+1},g.weeksInThisYear=function(N){return g.weeksInYear(g.getYear(N))},g.getWeekDay=function(N,O){O==null&&(O=!1);var G=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),J=(14-G)/12|0,se=g.getYear(N)-J,xe=(7e3+(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+se+(se/4|0)-(se/100|0)+(se/400|0)+(31*(G+12*J-2)/12|0)))%7;return O&&xe==0?7:xe},g.getWeekDayNum=function(N,O,G){return G==null&&(G=1),w.getWeekDayNum(N-62135596800+62135596800,O,G)+62135596800},g.getWeek=function(N){var O=(((N-62135596800-g.yearStart(N))/86400|0)+1-g.getWeekDay(N,!0)+10)/7|0,G=g.getYear(N);return O<1?g.weeksInYear(G-1):O>52&&O>g.weeksInYear(G)?1:O},g.getHour=function(N){return(N-Math.floor(N/86400)*86400)/3600|0},g.getHour12=function(N){var O=(N-Math.floor(N/86400)*86400)/3600|0;return O==0?12:O>12?O-12:O},g.getMinute=function(N){return(N-Math.floor(N/3600)*3600)/60|0},g.getSecond=function(N){return N-Math.floor(N/60)*60|0},g.add=function(N,O){var G;switch(O._hx_index){case 0:G=w.addYear(N-62135596800+62135596800,O.n);break;case 1:G=w.addMonth(N-62135596800+62135596800,O.n);break;case 2:G=N-62135596800+O.n*86400;break;case 3:G=N-62135596800+O.n*3600;break;case 4:G=N-62135596800+O.n*60;break;case 5:G=N-62135596800+O.n;break;case 6:G=N-62135596800+O.n*7*86400;break}return G+62135596800},g.sub=function(N,O){var G;switch(O._hx_index){case 0:G=w.addYear(N-62135596800+62135596800,-O.n);break;case 1:G=w.addMonth(N-62135596800+62135596800,-O.n);break;case 2:G=N-62135596800-O.n*86400;break;case 3:G=N-62135596800-O.n*3600;break;case 4:G=N-62135596800-O.n*60;break;case 5:G=N-62135596800-O.n;break;case 6:G=N-62135596800-O.n*7*86400;break}return G+62135596800},g.snap=function(N,O){var G;switch(O._hx_index){case 0:G=E.snapYear(N-62135596800+62135596800,O.direction);break;case 1:G=E.snapMonth(N-62135596800+62135596800,O.direction);break;case 2:G=E.snapDay(N-62135596800+62135596800,O.direction);break;case 3:G=E.snapHour(N-62135596800+62135596800,O.direction);break;case 4:G=E.snapMinute(N-62135596800+62135596800,O.direction);break;case 5:G=O.direction==1?N-62135596800+1:N-62135596800;break;case 6:G=E.snapWeek(N-62135596800+62135596800,O.direction,O.day);break}return G+62135596800},g.toString=function(N){var O=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),G=b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),J=(N-Math.floor(N/86400)*86400)/3600|0,se=(N-Math.floor(N/3600)*3600)/60|0,xe=N-Math.floor(N/60)*60|0;return""+g.getYear(N)+"-"+(O<10?"0"+O:""+O)+"-"+(G<10?"0"+G:""+G)+" "+(J<10?"0"+J:""+J)+":"+(se<10?"0"+se:""+se)+":"+(xe<10?"0"+xe:""+xe)},g.format=function(N,O){return w.strftime(N-62135596800+62135596800,O)},g.getTime=function(N){return N-62135596800},g.getDate=function(N){return new Date((N-62135596800)*1e3)},g.gt=function(N,O){return N-62135596800>O-62135596800},g.gte=function(N,O){return N-62135596800>=O-62135596800},g.lt=function(N,O){return N-62135596800<O-62135596800},g.lte=function(N,O){return N-62135596800<=O-62135596800},g.eq=function(N,O){return N-62135596800==O-62135596800},g.neq=function(N,O){return N-62135596800!=O-62135596800},g.mathPlus1=function(N,O){return g.add(N,O)},g.mathPlus2=function(N,O){return g.add(N,O)},g.mathPlus3=function(N,O){return N=g.add(N,O)-62135596800+62135596800,N+62135596800},g.mathMinus1=function(N,O){return g.sub(N,O)},g.mathMinus2=function(N,O){return N=g.sub(N,O)-62135596800+62135596800,N+62135596800},g.dtiCreate=function(N,O){return _.create(O,N-62135596800+62135596800)},g.dtiMinus=function(N,O){return _.subFrom(O,N-62135596800+62135596800)},g.dtiPlus1=function(N,O){return _.addTo(O,N-62135596800+62135596800)},g.dtiPlus2=function(N,O){return _.addTo(O,N-62135596800+62135596800)},g.dtiMinus2=function(N,O){return N=_.subFrom(O,N-62135596800+62135596800)-62135596800+62135596800,N+62135596800},g.dtiPlus3=function(N,O){return N=_.addTo(O,N-62135596800+62135596800)-62135596800+62135596800,N+62135596800};var _={};_.create=function(N,O){var G=new x;return G.begin=O-62135596800<N-62135596800?O:N,G.end=O-62135596800<N-62135596800?N:O,G.negative=O-62135596800<N-62135596800,G},_._new=function(N){return N},_.invert=function(N){return N.negative=!N.negative,N},_.addTo=function(N,O){return O-62135596800+(N.negative?-1:1)*(N.end-62135596800-(N.begin-62135596800))+62135596800},_.subFrom=function(N,O){return O-62135596800-(N.negative?-1:1)*(N.end-62135596800-(N.begin-62135596800))+62135596800},_.toString=function(N){var O=N.getYears(),G=N.getMonths(),J=N.getDays(),se=N.getHours(),xe=N.getMinutes(),Be=N.getSeconds(),Re=[];return O!=0&&Re.push(""+O+"y"),G!=0&&Re.push(""+G+"m"),J!=0&&Re.push(""+J+"d"),se!=0&&Re.push(""+se+"hrs"),xe!=0&&Re.push(""+xe+"min"),Be!=0&&Re.push(""+Be+"sec"),(N.negative?"-":"")+"("+(Re.length==0?"0sec":Re.join(", "))+")"},_.sign=function(N){return N.negative?-1:1},_.format=function(N,O){return y.strftime(N,O)},_.formatPartial=function(N,O){return y.formatPartial(N,O)},_.eq=function(N,O){return N.negative==O.negative?N.getTotalSeconds()==O.getTotalSeconds():!1},_.gt=function(N,O){if(N.negative!=O.negative)return O.negative;var G=N.getTotalSeconds()-O.getTotalSeconds();return N.negative?G<0:G>0},_.gte=function(N,O){if(N.negative==O.negative&&N.getTotalSeconds()==O.getTotalSeconds())return!0;if(N.negative!=O.negative)return O.negative;var G=N.getTotalSeconds()-O.getTotalSeconds();return N.negative?G<0:G>0},_.lt=function(N,O){var G;if(N.negative==O.negative&&N.getTotalSeconds()==O.getTotalSeconds())G=!0;else if(N.negative!=O.negative)G=O.negative;else{var J=N.getTotalSeconds()-O.getTotalSeconds();G=N.negative?J<0:J>0}return!G},_.lte=function(N,O){var G;if(N.negative!=O.negative)G=O.negative;else{var J=N.getTotalSeconds()-O.getTotalSeconds();G=N.negative?J<0:J>0}return!G},_.neq=function(N,O){return!(N.negative==O.negative&&N.getTotalSeconds()==O.getTotalSeconds())};var x=function(){this.seconds=-1,this.minutes=-1,this.hours=-1,this.days=-1,this.months=-1,this.years=-1,this.negative=!1};x.__name__=!0,x.prototype={getYears:function(){if(this.years<0){this.years=g.getYear(this.end)-g.getYear(this.begin);var O=this.begin,N=b.getMonth(((O-62135596800-g.yearStart(O))/86400|0)+1,g.isLeapYear(O)),O=this.end,G=b.getMonth(((O-62135596800-g.yearStart(O))/86400|0)+1,g.isLeapYear(O));if(G<N)this.years--;else if(N==G){var O=this.begin,J=b.getMonthDay(((O-62135596800-g.yearStart(O))/86400|0)+1,g.isLeapYear(O)),O=this.end,se=b.getMonthDay(((O-62135596800-g.yearStart(O))/86400|0)+1,g.isLeapYear(O));if(se<J)this.years--;else if(J==se){var O=this.begin,xe=(O-Math.floor(O/86400)*86400)/3600|0,O=this.end,Be=(O-Math.floor(O/86400)*86400)/3600|0;if(Be<xe)this.years--;else if(Be==xe){var O=this.begin,N=(O-Math.floor(O/3600)*3600)/60|0,O=this.end,G=(O-Math.floor(O/3600)*3600)/60|0;if(G<N)this.years--;else{var Re;if(G==N){var O=this.end,vt=this.begin;Re=(O-Math.floor(O/60)*60|0)<(vt-Math.floor(vt/60)*60|0)}else Re=!1;Re&&this.years--}}}}}return this.years},getMonths:function(){if(this.months<0){var J=this.begin,N=b.getMonth(((J-62135596800-g.yearStart(J))/86400|0)+1,g.isLeapYear(J)),J=this.end,O=b.getMonth(((J-62135596800-g.yearStart(J))/86400|0)+1,g.isLeapYear(J));this.months=N<=O?O-N:12-N+O;var J=this.begin,G=b.getMonthDay(((J-62135596800-g.yearStart(J))/86400|0)+1,g.isLeapYear(J)),J=this.end,se=b.getMonthDay(((J-62135596800-g.yearStart(J))/86400|0)+1,g.isLeapYear(J));if(se<G)this.months--;else if(G==se){var J=this.begin,xe=(J-Math.floor(J/86400)*86400)/3600|0,J=this.end,Be=(J-Math.floor(J/86400)*86400)/3600|0;if(Be<xe)this.months--;else if(Be==xe){var J=this.begin,Re=(J-Math.floor(J/3600)*3600)/60|0,J=this.end,vt=(J-Math.floor(J/3600)*3600)/60|0;if(vt<Re)this.months--;else{var _n;if(vt==Re){var J=this.end,rr=this.begin;_n=(J-Math.floor(J/60)*60|0)<(rr-Math.floor(rr/60)*60|0)}else _n=!1;_n&&this.months--}}}}return this.months},getTotalMonths:function(){return this.getYears()*12+this.getMonths()},getDays:function(){if(this.days<0){var se=this.begin,N=b.getMonthDay(((se-62135596800-g.yearStart(se))/86400|0)+1,g.isLeapYear(se)),se=this.end,O=b.getMonthDay(((se-62135596800-g.yearStart(se))/86400|0)+1,g.isLeapYear(se)),G;if(N<=O)G=O-N;else{var se=this.begin;G=b.days(b.getMonth(((se-62135596800-g.yearStart(se))/86400|0)+1,g.isLeapYear(se)),g.isLeapYear(this.begin))-N+O}this.days=G;var se=this.begin,J=(se-Math.floor(se/86400)*86400)/3600|0,se=this.end,xe=(se-Math.floor(se/86400)*86400)/3600|0;if(xe<J)this.days--;else if(xe==J){var se=this.begin,Be=(se-Math.floor(se/3600)*3600)/60|0,se=this.end,Re=(se-Math.floor(se/3600)*3600)/60|0;if(Re<Be)this.days--;else{var G;if(Re==Be){var se=this.end,vt=this.begin;G=(se-Math.floor(se/60)*60|0)<(vt-Math.floor(vt/60)*60|0)}else G=!1;G&&this.days--}}}return this.days},getTotalDays:function(){return(this.end-62135596800-(this.begin-62135596800))/86400|0},getHours:function(){if(this.hours<0){var J=this.begin,N=(J-Math.floor(J/86400)*86400)/3600|0,J=this.end,O=(J-Math.floor(J/86400)*86400)/3600|0;this.hours=N<=O?O-N:24-N+O;var J=this.begin,G=(J-Math.floor(J/3600)*3600)/60|0,J=this.end,se=(J-Math.floor(J/3600)*3600)/60|0;if(se<G)this.hours--;else{var xe;if(se==G){var J=this.end,Be=this.begin;xe=(J-Math.floor(J/60)*60|0)<(Be-Math.floor(Be/60)*60|0)}else xe=!1;xe&&this.hours--}}return this.hours},getTotalHours:function(){return(this.end-62135596800-(this.begin-62135596800))/3600|0},getMinutes:function(){if(this.minutes<0){var G=this.begin,N=(G-Math.floor(G/3600)*3600)/60|0,G=this.end,O=(G-Math.floor(G/3600)*3600)/60|0;this.minutes=N<=O?O-N:60-N+O;var G=this.end,J=this.begin;(G-Math.floor(G/60)*60|0)<(J-Math.floor(J/60)*60|0)&&this.minutes--}return this.minutes},getTotalMinutes:function(){return(this.end-62135596800-(this.begin-62135596800))/60|0},getSeconds:function(){if(this.seconds<0){var O=this.begin,N=O-Math.floor(O/60)*60|0,O=this.end,G=O-Math.floor(O/60)*60|0;this.seconds=N<=G?G-N:60-N+G}return this.seconds},getTotalSeconds:function(){return this.end-62135596800-(this.begin-62135596800)},getTotalWeeks:function(){return(this.end-62135596800-(this.begin-62135596800))/604800|0}};var y=function(){};y.__name__=!0,y.strftime=function(N,O){for(var G=0,J=O.indexOf("%"),se="";J>=0;){switch(se+=O.substring(G,J),++J,O.charCodeAt(J)){case 37:se+="%";break;case 68:se+=f.lpad(N.getDays()+"","0",2);break;case 72:se+=f.lpad(N.getHours()+"","0",2);break;case 73:se+=f.lpad(N.getMinutes()+"","0",2);break;case 77:se+=f.lpad(N.getMonths()+"","0",2);break;case 82:se+=N.negative?"-":"+";break;case 83:se+=f.lpad(N.getSeconds()+"","0",2);break;case 89:se+=f.lpad(N.getYears()+"","0",2);break;case 97:se+=N.getTotalDays()+"";break;case 98:se+=N.getTotalMonths()+"";break;case 99:se+=N.getTotalHours()+"";break;case 100:se+=N.getDays()+"";break;case 101:se+=N.getTotalMinutes()+"";break;case 102:se+=N.getTotalSeconds()+"";break;case 104:se+=N.getHours()+"";break;case 105:se+=N.getMinutes()+"";break;case 109:se+=N.getMonths()+"";break;case 114:se+=N.negative?"-":"";break;case 115:se+=N.getSeconds()+"";break;case 121:se+=N.getYears()+"";break}G=J+1,J=O.indexOf("%",J+1)}return se+=O.substring(G),se},y.formatPartial=function(N,O){for(var G=[],J=0,se="",xe=0,Be=O.length;xe<Be;){var Re=xe++;if(J=O[Re].indexOf("%"),J>=0){switch(O[Re].charCodeAt(J+1)){case 68:if(N.getDays()==0)continue;se=O[Re].substring(0,J)+f.lpad(N.getDays()+"","0",2)+O[Re].substring(J+2);break;case 72:if(N.getHours()==0)continue;se=O[Re].substring(0,J)+f.lpad(N.getHours()+"","0",2)+O[Re].substring(J+2);break;case 73:if(N.getMinutes()==0)continue;se=O[Re].substring(0,J)+f.lpad(N.getMinutes()+"","0",2)+O[Re].substring(J+2);break;case 77:if(N.getMonths()==0)continue;se=O[Re].substring(0,J)+f.lpad(N.getMonths()+"","0",2)+O[Re].substring(J+2);break;case 83:if(N.getSeconds()==0)continue;se=O[Re].substring(0,J)+f.lpad(N.getSeconds()+"","0",2)+O[Re].substring(J+2);break;case 89:if(N.getYears()==0)continue;se=O[Re].substring(0,J)+f.lpad(N.getYears()+"","0",2)+O[Re].substring(J+2);break;case 97:if(N.getTotalDays()==0)continue;se=O[Re].substring(0,J)+N.getTotalDays()+O[Re].substring(J+2);break;case 98:if(N.getTotalMonths()==0)continue;se=O[Re].substring(0,J)+N.getTotalMonths()+O[Re].substring(J+2);break;case 99:if(N.getTotalHours()==0)continue;se=O[Re].substring(0,J)+N.getTotalHours()+O[Re].substring(J+2);break;case 100:if(N.getDays()==0)continue;se=O[Re].substring(0,J)+N.getDays()+O[Re].substring(J+2);break;case 101:if(N.getTotalMinutes()==0)continue;se=O[Re].substring(0,J)+N.getTotalMinutes()+O[Re].substring(J+2);break;case 102:if(N.getTotalSeconds()==0)continue;se=O[Re].substring(0,J)+N.getTotalSeconds()+O[Re].substring(J+2);break;case 104:if(N.getHours()==0)continue;se=O[Re].substring(0,J)+N.getHours()+O[Re].substring(J+2);break;case 105:if(N.getMinutes()==0)continue;se=O[Re].substring(0,J)+N.getMinutes()+O[Re].substring(J+2);break;case 109:if(N.getMonths()==0)continue;se=O[Re].substring(0,J)+N.getMonths()+O[Re].substring(J+2);break;case 115:if(N.getSeconds()==0)continue;se=O[Re].substring(0,J)+N.getSeconds()+O[Re].substring(J+2);break;case 121:if(N.getYears()==0)continue;se=O[Re].substring(0,J)+N.getYears()+O[Re].substring(J+2);break;default:continue}G.push(se)}}return G};var b=function(){};b.__name__=!0,b.days=function(N,O){return O==null&&(O=!1),N==1?31:N==2&&O?29:N==2?28:N==3?31:N==4?30:N==5?31:N==6?30:N==7||N==8?31:N==9?30:N==10?31:N==11?30:31},b.getMonth=function(N,O){return O==null&&(O=!1),N<32?1:O?N<61?2:N<92?3:N<122?4:N<153?5:N<183?6:N<214?7:N<245?8:N<275?9:N<306?10:N<336?11:12:N<60?2:N<91?3:N<121?4:N<152?5:N<182?6:N<213?7:N<244?8:N<274?9:N<305?10:N<335?11:12},b.getMonthDay=function(N,O){return O==null&&(O=!1),N<32?N:O?N<61?N-31:N<92?N-60:N<122?N-91:N<153?N-121:N<183?N-152:N<214?N-182:N<245?N-213:N<275?N-244:N<306?N-274:N<336?N-305:N-335:N<60?N-31:N<91?N-59:N<121?N-90:N<152?N-120:N<182?N-151:N<213?N-181:N<244?N-212:N<274?N-243:N<305?N-273:N<335?N-304:N-334},b.toSeconds=function(N,O){return O==null&&(O=!1),86400*(N==1?0:O?N==2?31:N==3?60:N==4?91:N==5?121:N==6?152:N==7?182:N==8?213:N==9?244:N==10?274:N==11?305:335:N==2?31:N==3?59:N==4?90:N==5?120:N==6?151:N==7?181:N==8?212:N==9?243:N==10?273:N==11?304:334)};var E=function(){};E.__name__=!0,E.snapYear=function(N,O){switch(O){case-1:return g.yearStart(N);case 0:var G=g.yearStart(w.addYear(N,1)+62135596800),J=g.yearStart(N);return G-(N-62135596800)>N-62135596800-J?J:G;case 1:return g.yearStart(w.addYear(N,1)+62135596800)}},E.snapMonth=function(N,O){var G=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),J=g.isLeapYear(N);switch(O){case-1:return g.yearStart(N)+b.toSeconds(G,J);case 0:var se=g.yearStart(N)+b.toSeconds(G,J),xe=g.yearStart(N)+b.toSeconds(G,J)+b.days(G,J)*86400;return xe-(N-62135596800)>N-62135596800-se?se:xe;case 1:return g.yearStart(N)+b.toSeconds(G,J)+b.days(G,J)*86400}},E.snapDay=function(N,O){var G=(N-62135596800)/86400;switch(O){case-1:return Math.floor(G)*86400;case 0:return Math.round(G)*86400;case 1:return Math.ceil(G)*86400}},E.snapHour=function(N,O){var G=(N-62135596800)/3600;switch(O){case-1:return Math.floor(G)*3600;case 0:return Math.round(G)*3600;case 1:return Math.ceil(G)*3600}},E.snapMinute=function(N,O){var G=(N-62135596800)/60;switch(O){case-1:return Math.floor(G)*60;case 0:return Math.round(G)*60;case 1:return Math.ceil(G)*60}},E.snapWeek=function(N,O,G){var J=g.getWeekDay(N),se=Math.floor((N-62135596800)/86400);switch(O){case-1:return(se-(J>=G?J-G:J+7-G))*86400;case 0:var xe=(se-(J>=G?J-G:J+7-G))*86400,Be=(se+(G>J?G-J:G+7-J))*86400;return Be-(N-62135596800)>N-62135596800-xe?xe:Be;case 1:return(se+(G>J?G-J:G+7-J))*86400}};var w=function(){};w.__name__=!0,w.fromString=function(N){if(N.length==10||N.charCodeAt(10)==32)return w.parse(N);if(N.charCodeAt(10)==84)return w.fromIsoString(N);throw I.thrown("`"+N+"` - incorrect date/time format. Should be either `YYYY-MM-DD hh:mm:ss` or `YYYY-MM-DD` or `YYYY-MM-DDThh:mm:ss[.SSS]Z`")},w.parse=function(N){var O=N.indexOf("-");if(O<1||N.length-O!=6&&N.length-O!=15)throw I.thrown("`"+N+"` - incorrect date/time format. Should be either `YYYY-MM-DD hh:mm:ss` or `YYYY-MM-DD`");N.length-O==6&&(N+=" 00:00:00");var G=d.parseInt(c.substr(N,0,O)),J=d.parseInt(c.substr(N,O+1,2)),se=d.parseInt(c.substr(N,O+4,2)),xe=d.parseInt(c.substr(N,O+7,2)),Be=d.parseInt(c.substr(N,O+10,2)),Re=d.parseInt(c.substr(N,O+13,2));if(G==null||J==null||se==null||xe==null||Be==null||Re==null)throw I.thrown("`"+N+"` - incorrect date/time format. Should be either `YYYY-MM-DD hh:mm:ss` or `YYYY-MM-DD`");var vt=G,_n=J,rr=se,Ks=xe,Le=Be,fe=Re;return Re==null&&(fe=0),Be==null&&(Le=0),xe==null&&(Ks=0),se==null&&(rr=1),J==null&&(_n=1),G==null&&(vt=1970),w.yearToStamp(vt)+b.toSeconds(_n,vt%4==0&&(vt%100==0?vt%400==0:!0))+(rr-1)*86400+Ks*3600+Le*60+fe-62135596800+62135596800},w.fromIsoString=function(N){if(N.charCodeAt(N.length-1)!=90)throw I.thrown("`"+N+"` - incorrect date/time format. Not an ISO 8601 UTC/Zulu string: Z not found.");if(N.length>20){if(N.charCodeAt(19)!=46)throw I.thrown("`"+N+"` - incorrect date/time format. Not an ISO 8601 string: Millisecond specification erroneous.");if(N.charCodeAt(23)!=90)throw I.thrown("`"+N+"` - incorrect date/time format. Not an ISO 8601 string: Timezone specification erroneous.")}return w.parse(c.substr(N,0,10)+" "+c.substr(N,11,8))},w.clamp=function(N,O,G){return N<O?O:N>G?G:N},w.yearToStamp=function(N){--N;var O=N/400|0,G=(N-O*400)/4|0;return O*12622780800+G*126230400-(G/25|0)*86400+(N-O*400-G*4)*31536e3},w.addYear=function(N,O){var G=g.getYear(N)+O;return w.yearToStamp(G)+b.toSeconds(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),G%4==0&&(G%100==0?G%400==0:!0))+(N-62135596800-(g.yearStart(N)+b.toSeconds(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),g.isLeapYear(N))))-62135596800},w.addMonth=function(N,O){var G=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+O;if(G>12){var J=G/12|0;N=w.addYear(N,J)+62135596800,G-=J*12}else if(G<=0){var J=(G/12|0)-1;N=w.addYear(N,J)+62135596800,G-=J*12}var se=g.isLeapYear(N),xe=b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N)),Be=b.days(G,se);return g.yearStart(N)+b.toSeconds(G,se)+((xe<1?1:xe>Be?Be:xe)-1)*86400+((N-Math.floor(N/86400)*86400)/3600|0)*3600+((N-Math.floor(N/3600)*3600)/60|0)*60+(N-Math.floor(N/60)*60|0)},w.getWeekDayNum=function(N,O,G){var J=b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N));return G>0?g.add(g.snap(g.monthStart(N,J)-1+62135596800,p.Week(1,O)),h.Week(G-1))-62135596800:G<0?g.add(g.snap(g.monthStart(N,J+1)-1+62135596800,p.Week(-1,O)),h.Week(G+1))-62135596800:N-62135596800},w.strftime=function(N,O){for(var G=0,J=O.indexOf("%"),se="";J>=0;){switch(se+=O.substring(G,J),++J,O.charCodeAt(J)){case 37:se+="%";break;case 67:se+=f.lpad((g.getYear(N)/100|0)+"","0",2);break;case 68:se+=f.lpad(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"/","0",3)+f.lpad(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"/","0",3)+f.lpad(c.substr(g.getYear(N)+"",-2,null),"0",2);break;case 70:se+=g.getYear(N)+"-"+f.lpad(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"-","0",3)+f.lpad(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"","0",2);break;case 72:se+=f.lpad(((N-Math.floor(N/86400)*86400)/3600|0)+"","0",2);break;case 73:se+=f.lpad(g.getHour12(N)+"","0",2);break;case 77:se+=f.lpad(((N-Math.floor(N/3600)*3600)/60|0)+"","0",2);break;case 80:se+=((N-Math.floor(N/86400)*86400)/3600|0)<12?"am":"pm";break;case 82:se+=f.lpad(((N-Math.floor(N/86400)*86400)/3600|0)+":","0",3)+f.lpad(((N-Math.floor(N/3600)*3600)/60|0)+"","0",2);break;case 83:se+=f.lpad((N-Math.floor(N/60)*60|0)+"","0",2);break;case 84:se+=f.lpad(((N-Math.floor(N/86400)*86400)/3600|0)+":","0",3)+f.lpad(((N-Math.floor(N/3600)*3600)/60|0)+":","0",3)+f.lpad((N-Math.floor(N/60)*60|0)+"","0",2);break;case 86:se+=f.lpad(g.getWeek(N)+"","0",2);break;case 89:se+=g.getYear(N)+"";break;case 100:se+=f.lpad(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"","0",2);break;case 101:se+=f.lpad(b.getMonthDay(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+""," ",2);break;case 106:se+=f.lpad(""+(((N-62135596800-g.yearStart(N))/86400|0)+1),"0",3);break;case 107:se+=f.lpad(((N-Math.floor(N/86400)*86400)/3600|0)+""," ",2);break;case 108:se+=f.lpad(g.getHour12(N)+""," ",2);break;case 109:se+=f.lpad(b.getMonth(((N-62135596800-g.yearStart(N))/86400|0)+1,g.isLeapYear(N))+"","0",2);break;case 112:se+=((N-Math.floor(N/86400)*86400)/3600|0)<12?"AM":"PM";break;case 114:se+=f.lpad(g.getHour12(N)+":","0",3)+f.lpad(((N-Math.floor(N/3600)*3600)/60|0)+":","0",3)+f.lpad((N-Math.floor(N/60)*60|0)+"","0",2);break;case 115:se+=N-62135596800+"";break;case 117:se+=g.getWeekDay(N,!0)+"";break;case 119:se+=g.getWeekDay(N)+"";break;case 121:se+=f.lpad(c.substr(g.getYear(N)+"",-2,null),"0",2);break}G=J+1,J=O.indexOf("%",J+1)}return se+=O.substring(G),se};var k=s["formula.TypeSlot"]={__ename__:!0,__constructs__:null,TCon:(a=function(N){return{_hx_index:0,type:N,__enum__:"formula.TypeSlot",toString:n}},a._hx_name="TCon",a.__params__=["type"],a),TVar:(a=function(N){return{_hx_index:1,id:N,__enum__:"formula.TypeSlot",toString:n}},a._hx_name="TVar",a.__params__=["id"],a)};k.__constructs__=[k.TCon,k.TVar];var C=s["formula.ValueType"]={__ename__:!0,__constructs__:null,TNumber:{_hx_name:"TNumber",_hx_index:0,__enum__:"formula.ValueType",toString:n},TString:{_hx_name:"TString",_hx_index:1,__enum__:"formula.ValueType",toString:n},TBoolean:{_hx_name:"TBoolean",_hx_index:2,__enum__:"formula.ValueType",toString:n},TDate:{_hx_name:"TDate",_hx_index:3,__enum__:"formula.ValueType",toString:n}};C.__constructs__=[C.TNumber,C.TString,C.TBoolean,C.TDate];var T=s["formula.Value"]={__ename__:!0,__constructs__:null,VNumber:(a=function(N){return{_hx_index:0,value:N,__enum__:"formula.Value",toString:n}},a._hx_name="VNumber",a.__params__=["value"],a),VString:(a=function(N){return{_hx_index:1,value:N,__enum__:"formula.Value",toString:n}},a._hx_name="VString",a.__params__=["value"],a),VBoolean:(a=function(N){return{_hx_index:2,value:N,__enum__:"formula.Value",toString:n}},a._hx_name="VBoolean",a.__params__=["value"],a),VDate:(a=function(N){return{_hx_index:3,value:N,__enum__:"formula.Value",toString:n}},a._hx_name="VDate",a.__params__=["value"],a)};T.__constructs__=[T.VNumber,T.VString,T.VBoolean,T.VDate];var v=e.formula.ValueTool=function(){};v.__name__=!0,v.typeOf=function(N){switch(N._hx_index){case 0:return C.TNumber;case 1:return C.TString;case 2:return C.TBoolean;case 3:return C.TDate}},v.number=function(N){return T.VNumber(N)},v.string=function(N){return T.VString(N)},v.boolean=function(N){return T.VBoolean(N)},v.date=function(N){return T.VDate(N)},v.fromDynamic=function(N){return N instanceof Date?T.VDate(N):typeof N=="string"?T.VString(N):typeof N=="boolean"?T.VBoolean(N):T.VNumber(N)},v.toDynamic=function(N){switch(N._hx_index){case 0:return N.value;case 1:return N.value;case 2:return N.value;case 3:return N.value}},v.asNumber=function(N){if(N._hx_index==0)return N.value;throw new I("")},v.asString=function(N){if(N==null)return"";if(N._hx_index==1)return N.value;throw new I("")},v.asBoolean=function(N){if(N==null)return!1;if(N._hx_index==2)return N.value;throw new I("")},v.asDate=function(N){if(N._hx_index==3)return N.value;throw new I("")},v.formatFloat=function(N){var O=N==null?"null":""+N,G=O.lastIndexOf("."),J=O.length-G-1;if(G>=0&&J>=10){var se=Math.pow(10,Math.max(10,J-6)),xe=d.string(Math.round(N*se)/se);if(O.length-xe.length>=J-12&&O.length-xe.length>=4)return xe}return d.string(Math.round(N*1e12)/1e12)},v.toString=function(N){if(N==null)return"";switch(N._hx_index){case 0:var O=N.value;return isNaN(O)?"":v.formatFloat(O);case 1:return N.value;case 2:return N.value?"true":"false";case 3:return c.dateStr(N.value)}},v.nameOfType=function(N){switch(N._hx_index){case 0:return"number";case 1:return"string";case 2:return"boolean";case 3:return"date"}};var I=function(N,O,G){Error.call(this,N),this.message=N,this.__previousException=O,this.__nativeException=G!=null?G:this};I.__name__=!0,I.caught=function(N){return N instanceof I?N:N instanceof Error?new I(N.message,null,N):new Ke(N,null,N)},I.thrown=function(N){if(N instanceof I)return N.get_native();if(N instanceof Error)return N;var O=new Ke(N);return O},I.__super__=Error,I.prototype=o(Error.prototype,{unwrap:function(){return this.__nativeException},toString:function(){return this.get_message()},get_message:function(){return this.message},get_native:function(){return this.__nativeException}});var j=function(){};j.__name__=!0,j.compareNumber=function(N,O){return N-O},j.compareString=function(N,O){for(var G=Math.min(N.length,O.length)|0,J=0;J<G;){var se=J++,xe=c.cca(N,se),Be=c.cca(O,se);if(xe<Be)return-1;if(xe>Be)return 1}return N.length-O.length},j.compareBoolean=function(N,O){return N?O?0:1:O?-1:0},j.compareDate=function(N,O){return j.compareNumber(N.getTime(),O.getTime())};var D=function(){};D.__name__=!0,D.__string_rec=function(N,O){if(N==null)return"null";if(O.length>=5)return"<...>";var G=typeof N;switch(G=="function"&&(N.__name__||N.__ename__)&&(G="object"),G){case"function":return"<function>";case"object":if(N.__enum__){var J=s[N.__enum__],se=J.__constructs__[N._hx_index],xe=se._hx_name;return se.__params__?(O=O+"	",xe+"("+function(st){for(var St,Pt=[],en=0,dn=se.__params__;en<dn.length;){var Ms=dn[en];en=en+1,Pt.push(D.__string_rec(N[Ms],O))}return St=Pt,St}().join(",")+")"):xe}if(N instanceof Array){var Ks="[";O+="	";for(var Be=0,Re=N.length;Be<Re;){var vt=Be++;Ks+=(vt>0?",":"")+D.__string_rec(N[vt],O)}return Ks+="]",Ks}var _n;try{_n=N.toString}catch(st){return"???"}if(_n!=null&&_n!=Object.toString&&typeof _n=="function"){var rr=N.toString();if(rr!="[object Object]")return rr}var Ks=`{
`;O+="	";var Le=N.hasOwnProperty!=null,fe=null;for(fe in N)Le&&!N.hasOwnProperty(fe)||fe=="prototype"||fe=="__class__"||fe=="__super__"||fe=="__interfaces__"||fe=="__properties__"||(Ks.length!=2&&(Ks+=`, 
`),Ks+=O+fe+" : "+D.__string_rec(N[fe],O));return O=O.substring(1),Ks+=`
`+O+"}",Ks;case"string":return N;default:return String(N)}};var S=function(N,O,G){I.call(this,N,O),G==null?this.posInfos={fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:this.posInfos=G};S.__name__=!0,S.__super__=I,S.prototype=o(I.prototype,{toString:function(){return""+I.prototype.toString.call(this)+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber}});var R=function(N,O,G){N==null&&(N="Not implemented"),S.call(this,N,O,G)};R.__name__=!0,R.__super__=S,R.prototype=o(S.prototype,{});var A=function(){};A.__name__=!0,A.getTotalMonthsFix=function(N){var O=N.begin,G=N.end,J=(g.getYear(G)-g.getYear(O))*12+(b.getMonth(((G-62135596800-g.yearStart(G))/86400|0)+1,g.isLeapYear(G))-b.getMonth(((O-62135596800-g.yearStart(O))/86400|0)+1,g.isLeapYear(O))),se=b.getMonthDay(((O-62135596800-g.yearStart(O))/86400|0)+1,g.isLeapYear(O)),xe=b.getMonthDay(((G-62135596800-g.yearStart(G))/86400|0)+1,g.isLeapYear(G));if(xe<se)--J;else if(se==xe){var Be=(O-Math.floor(O/86400)*86400)/3600|0,Re=(G-Math.floor(G/86400)*86400)/3600|0;if(Re<Be)--J;else if(Re==Be){var vt=(O-Math.floor(O/3600)*3600)/60|0,_n=(G-Math.floor(G/3600)*3600)/60|0;(_n<vt||_n==vt&&(G-Math.floor(G/60)*60|0)<(O-Math.floor(O/60)*60|0))&&--J}}return J},A.getLocalWeek=function(N){return g.getWeek(N-62135596800+g.getLocalOffset()+62135596800)};var L=function(){this.constMap=new ut,this.funcMap=new ut;var N=k.TCon(C.TNumber),O=k.TCon(C.TString),G=k.TCon(C.TBoolean),J=k.TCon(C.TDate);this.constMap.h.e=T.VNumber(2.718281828459045),this.constMap.h.pi=T.VNumber(3.141592653589793),this.constMap.h.true=T.VBoolean(!0),this.constMap.h.false=T.VBoolean(!1),this.funcMap.h.prop={type:L.fnTy(null,[O]),eval:null};var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(-v.asNumber(fe[0]))}};this.funcMap.h.unaryMinus=Le,this.funcMap.h.unaryPlus={type:L.fnTy(N,[N]),eval:function(fe){return fe[0]}};var Le={type:L.fnTy(N,[N,N]),eval:function(fe){return T.VNumber(v.asNumber(fe[0])+v.asNumber(fe[1]))}};this.funcMap.h.add=Le;var Le={type:L.fnTy(N,[N,N]),eval:function(fe){return T.VNumber(v.asNumber(fe[0])-v.asNumber(fe[1]))}};this.funcMap.h.subtract=Le;var Le={type:L.fnTy(N,[N,N]),eval:function(fe){return T.VNumber(v.asNumber(fe[0])*v.asNumber(fe[1]))}};this.funcMap.h.multiply=Le;var Le={type:L.fnTy(N,[N,N]),eval:function(fe){return T.VNumber(v.asNumber(fe[0])/v.asNumber(fe[1]))}};this.funcMap.h.divide=Le;var Le={type:L.fnTy(N,[N,N]),eval:function(fe){return T.VNumber(v.asNumber(fe[0])%v.asNumber(fe[1]))}};this.funcMap.h.mod=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){var st=v.asNumber(fe[0]);return T.VNumber(st>0?1:st<0?-1:0)}};this.funcMap.h.sign=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(Math.abs(v.asNumber(fe[0])))}};this.funcMap.h.abs=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(Math.floor(v.asNumber(fe[0])))}};this.funcMap.h.floor=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(Math.ceil(v.asNumber(fe[0])))}};this.funcMap.h.ceil=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(Math.round(v.asNumber(fe[0])))}};this.funcMap.h.round=Le;var Le={type:L.vaFnTy(N,[N],N),eval:function(fe){for(var st=new Array(fe.length),St=0,Pt=fe.length;St<Pt;){var en=St++;st[en]=v.asNumber(fe[en])}return T.VNumber(u.fold(st.slice(1),Math.max,st[0]))}};this.funcMap.h.max=Le;var Le={type:L.vaFnTy(N,[N],N),eval:function(fe){for(var st=new Array(fe.length),St=0,Pt=fe.length;St<Pt;){var en=St++;st[en]=v.asNumber(fe[en])}return T.VNumber(u.fold(st.slice(1),Math.min,st[0]))}};this.funcMap.h.min=Le;var Le={type:L.fnTy(N,[N,N]),eval:function(fe){return T.VNumber(Math.pow(v.asNumber(fe[0]),v.asNumber(fe[1])))}};this.funcMap.h.pow=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(Math.exp(v.asNumber(fe[0])))}};this.funcMap.h.exp=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(Math.log(v.asNumber(fe[0])))}};this.funcMap.h.ln=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(Math.log(v.asNumber(fe[0]))*1.4426950408889634)}};this.funcMap.h.log2=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(Math.log(v.asNumber(fe[0]))*.4342944819032518)}};this.funcMap.h.log10=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){return T.VNumber(Math.sqrt(v.asNumber(fe[0])))}};this.funcMap.h.sqrt=Le;var Le={type:L.fnTy(N,[N]),eval:function(fe){var st=v.asNumber(fe[0]);return T.VNumber(st<0?-Math.pow(-st,.3333333333333333):Math.pow(st,.3333333333333333))}};this.funcMap.h.cbrt=Le;var xe=new $e;xe.h[0]=null;var Le={type:L.genFnTy(xe,N,[k.TVar(0)]),eval:function(fe){var st=fe[0];switch(st._hx_index){case 0:return T.VNumber(st.value);case 1:var St=st.value;if(St=="")return null;var Pt=parseFloat(f.trim(St));return isNaN(Pt)?null:T.VNumber(Pt);case 2:return T.VNumber(st.value?1:0);case 3:return T.VNumber(st.value.getTime())}}};this.funcMap.h.toNumber=Le;var xe=new $e;xe.h[0]=null,this.funcMap.h.if={type:L.genFnTy(xe,k.TVar(0),[G,k.TVar(0),k.TVar(0)]),eval:null},this.funcMap.h.and={type:L.fnTy(G,[G,G]),eval:null},this.funcMap.h.or={type:L.fnTy(G,[G,G]),eval:null};var Le={type:L.fnTy(G,[G]),eval:function(fe){return T.VBoolean(!v.asBoolean(fe[0]))}};this.funcMap.h.not=Le;var xe=new $e;xe.h[0]=null;var Le={type:L.genFnTy(xe,G,[k.TVar(0)]),eval:function(fe){var st=fe[0],St;if(st==null)St=!0;else switch(st._hx_index){case 0:St=isNaN(st.value);break;case 1:St=st.value=="";break;case 2:St=st.value==!1;break;default:St=!1}return T.VBoolean(St)}};this.funcMap.h.empty=Le;var se=function(fe,st){switch(fe._hx_index){case 0:return j.compareNumber(v.asNumber(fe),v.asNumber(st));case 1:return j.compareString(v.asString(fe),v.asString(st));case 2:return j.compareBoolean(v.asBoolean(fe),v.asBoolean(st));case 3:return j.compareDate(v.asDate(fe),v.asDate(st))}},xe=new $e;xe.h[0]=null;var Le={type:L.genFnTy(xe,G,[k.TVar(0),k.TVar(0)]),eval:function(fe){return T.VBoolean(se(fe[0],fe[1])==0)}};this.funcMap.h.equal=Le;var xe=new $e;xe.h[0]=null;var Le={type:L.genFnTy(xe,G,[k.TVar(0),k.TVar(0)]),eval:function(fe){return T.VBoolean(se(fe[0],fe[1])!=0)}};this.funcMap.h.unequal=Le;var xe=new $e;xe.h[0]=null;var Le={type:L.genFnTy(xe,G,[k.TVar(0),k.TVar(0)]),eval:function(fe){return T.VBoolean(se(fe[0],fe[1])<0)}};this.funcMap.h.smaller=Le;var xe=new $e;xe.h[0]=null;var Le={type:L.genFnTy(xe,G,[k.TVar(0),k.TVar(0)]),eval:function(fe){return T.VBoolean(se(fe[0],fe[1])<=0)}};this.funcMap.h.smallerEq=Le;var xe=new $e;xe.h[0]=null;var Le={type:L.genFnTy(xe,G,[k.TVar(0),k.TVar(0)]),eval:function(fe){return T.VBoolean(se(fe[0],fe[1])>0)}};this.funcMap.h.larger=Le;var xe=new $e;xe.h[0]=null;var Le={type:L.genFnTy(xe,G,[k.TVar(0),k.TVar(0)]),eval:function(fe){return T.VBoolean(se(fe[0],fe[1])>=0)}};this.funcMap.h.largerEq=Le;var Le={type:L.fnTy(N,[O]),eval:function(fe){return T.VNumber(v.asString(fe[0]).length)}};this.funcMap.h.length=Le;var Le={type:L.fnTy(O,[O,N],[N]),eval:function(fe){var st=v.asString(fe[0]),St=v.asNumber(fe[1])|0;if(St<0&&(St=Math.max(0,st.length+St)|0),fe.length==2)return T.VString(st.substring(St,st.length));var Pt=v.asNumber(fe[2])|0;return Pt<0&&(Pt=Math.max(0,st.length+Pt)|0),T.VString(St>=Pt?"":st.substring(St,Pt))}};this.funcMap.h.slice=Le;var xe=new $e;xe.h[0]=null;var Le={type:L.genFnTy(xe,O,[k.TVar(0)]),eval:function(fe){return T.VString(v.toString(fe[0]))}};this.funcMap.h.format=Le;var Le={type:L.vaFnTy(O,[],O),eval:function(fe){if(fe.length==2)return T.VString(v.asString(fe[0])+v.asString(fe[1]));for(var st=new Array(fe.length),St=0,Pt=fe.length;St<Pt;){var en=St++;st[en]=v.asString(fe[en])}return T.VString(st.join(""))}};this.funcMap.h.concat=Le;var Le={type:L.vaFnTy(O,[O],O),eval:function(fe){for(var st=fe.slice(1),St=new Array(st.length),Pt=0,en=st.length;Pt<en;){var dn=Pt++;St[dn]=v.asString(st[dn])}return T.VString(St.join(v.asString(fe[0])))}};this.funcMap.h.join=Le;var Le={type:L.fnTy(G,[O,O]),eval:function(fe){var st=v.asString(fe[0]),St=v.asString(fe[1]);return T.VBoolean(st.length<=0?!1:st.indexOf(St)>=0)}};this.funcMap.h.contains=Le;var Le={type:L.fnTy(O,[O,O,O]),eval:function(fe){var st=new RegExp(v.asString(fe[1]),"".split("u").join("")),St=v.asString(fe[0]),Pt=v.asString(fe[2]);return T.VString(St.replace(st,Pt))}};this.funcMap.h.replace=Le;var Le={type:L.fnTy(O,[O,O,O]),eval:function(fe){var st=new RegExp(v.asString(fe[1]),"g".split("u").join("")),St=v.asString(fe[0]),Pt=v.asString(fe[2]);return T.VString(St.replace(st,Pt))}};this.funcMap.h.replaceAll=Le;var Le={type:L.fnTy(G,[O,O]),eval:function(fe){return T.VBoolean(new l(v.asString(fe[1]),"").match(v.asString(fe[0])))}};this.funcMap.h.test=Le,this.funcMap.h.now={type:L.fnTy(J,[]),eval:null};var Be=function(fe,st){var St="0000"+(fe==null?"null":""+fe);return St.substring(St.length-st)},Re=function(fe){switch(fe%10){case 1:return fe!=11?""+fe+"st":""+fe+"th";case 2:return fe!=12?""+fe+"nd":""+fe+"th";case 3:return fe!=13?""+fe+"rd":""+fe+"th";default:return""+fe+"th"}},vt=function(fe,st){var St=Math.abs(fe);return(fe<0?"-":"+")+Be(Math.floor(St/60),2)+(st?":":"")+Be(St%60|0,2)},_n=function(fe,st){return new l("YYYY|YY|Qo|Q|MMMM|MMM|MM|Mo|M|ww|wo|w|DDDD|DDDo|DDD|DD|Do|D|dddd|ddd|dd|d|HH|H|hh|h|mm|m|ss|s|A|a|ZZ|Z|SSS|SS|S|X|x","g").map(st,function(St){switch(St.matched(0)){case"A":return fe.getHours()<12?"AM":"PM";case"D":return d.string(fe.getDate());case"DD":return Be(fe.getDate(),2);case"DDD":var Pt=Math.floor(fe.getTime()/1e3)+62135596800;return d.string(((Pt-62135596800-g.yearStart(Pt))/86400|0)+1);case"DDDD":var Pt=Math.floor(fe.getTime()/1e3)+62135596800;return Be(((Pt-62135596800-g.yearStart(Pt))/86400|0)+1,3);case"DDDo":var Pt=Math.floor(fe.getTime()/1e3)+62135596800;return Re(((Pt-62135596800-g.yearStart(Pt))/86400|0)+1);case"Do":return Re(fe.getDate());case"H":return d.string(fe.getHours());case"HH":return Be(fe.getHours(),2);case"M":return d.string(fe.getMonth()+1);case"MM":return Be(fe.getMonth()+1,2);case"MMM":return i.format(fe,"%b");case"MMMM":return i.format(fe,"%B");case"Mo":return Re(fe.getMonth()+1);case"Q":return d.string(Math.floor(fe.getMonth()/3)+1);case"Qo":return Re(Math.floor(fe.getMonth()/3)+1);case"S":return d.string(Math.floor(fe.getTime()%1e3/100));case"SS":return d.string(Math.floor(fe.getTime()%1e3/10));case"SSS":return d.string(fe.getTime()%1e3);case"X":return d.string(Math.floor(fe.getTime()/1e3));case"XX":return d.string(fe.getTime());case"YY":return Be(fe.getFullYear(),2);case"YYYY":return Be(fe.getFullYear(),4);case"Z":return vt(-fe.getTimezoneOffset(),!0);case"ZZ":return vt(-fe.getTimezoneOffset(),!1);case"a":return fe.getHours()<12?"am":"pm";case"d":return d.string(fe.getDay());case"dd":return c.substr(i.format(fe,"%a"),0,2);case"ddd":return i.format(fe,"%a");case"dddd":return i.format(fe,"%A");case"do":return Re(fe.getDay());case"h":return d.string(fe.getHours()%12);case"hh":return Be(fe.getHours()%12,2);case"m":return d.string(fe.getMinutes());case"mm":return Be(fe.getMinutes(),2);case"s":return d.string(fe.getSeconds());case"ss":return Be(fe.getSeconds(),2);case"w":return d.string(A.getLocalWeek(Math.floor(fe.getTime()/1e3)+62135596800));case"wo":return Re(A.getLocalWeek(Math.floor(fe.getTime()/1e3)+62135596800));case"ww":return Be(A.getLocalWeek(Math.floor(fe.getTime()/1e3)+62135596800),2);default:throw new I("")}})},Le={type:L.fnTy(O,[J,O]),eval:function(fe){return T.VString(_n(v.asDate(fe[0]),v.asString(fe[1])))}};this.funcMap.h.formatDate=Le;var Le={type:L.fnTy(J,[N]),eval:function(fe){return T.VDate(new Date(v.asNumber(fe[0])))}};this.funcMap.h.fromTimestamp=Le;var Le={type:L.fnTy(N,[J]),eval:function(fe){return T.VNumber(Math.round(v.asDate(fe[0]).getTime()))}};this.funcMap.h.timestamp=Le;var Le={type:L.fnTy(N,[J]),eval:function(fe){return T.VNumber(v.asDate(fe[0]).getFullYear())}};this.funcMap.h.year=Le;var Le={type:L.fnTy(N,[J]),eval:function(fe){return T.VNumber(v.asDate(fe[0]).getMonth()+1)}};this.funcMap.h.month=Le;var Le={type:L.fnTy(N,[J]),eval:function(fe){return T.VNumber(v.asDate(fe[0]).getDate())}};this.funcMap.h.date=Le;var Le={type:L.fnTy(N,[J]),eval:function(fe){return T.VNumber(v.asDate(fe[0]).getDay())}};this.funcMap.h.day=Le;var Le={type:L.fnTy(N,[J]),eval:function(fe){return T.VNumber(v.asDate(fe[0]).getHours())}};this.funcMap.h.hour=Le;var Le={type:L.fnTy(N,[J]),eval:function(fe){return T.VNumber(v.asDate(fe[0]).getMinutes())}};this.funcMap.h.minute=Le;var rr=function(fe,st,St){if(St=="milliseconds"){var en=fe.getTime()%1e3+st,Pt=Math.floor(en/1e3);return en-=Pt*1e3,new Date((g.add(Math.floor(fe.getTime()/1e3)+62135596800,h.Second(Pt))-62135596800)*1e3+en)}var en=fe.getTime()%1e3,dn=Math.floor(fe.getTime()/1e3)+62135596800,Ms;switch(St){case"days":Ms=h.Day(st);break;case"hours":Ms=h.Hour(st);break;case"minutes":Ms=h.Minute(st);break;case"months":Ms=h.Month(st);break;case"quarters":Ms=h.Month(st*3);break;case"seconds":Ms=h.Second(st);break;case"weeks":Ms=h.Week(st);break;case"years":Ms=h.Year(st);break;default:throw new I("")}return new Date((g.add(dn,Ms)-62135596800)*1e3+en)},Le={type:L.fnTy(J,[J,N,O]),eval:function(fe){return T.VDate(rr(v.asDate(fe[0]),v.asNumber(fe[1])|0,v.asString(fe[2])))}};this.funcMap.h.dateAdd=Le;var Le={type:L.fnTy(J,[J,N,O]),eval:function(fe){return T.VDate(rr(v.asDate(fe[0]),-(v.asNumber(fe[1])|0),v.asString(fe[2])))}};this.funcMap.h.dateSubtract=Le;var Ks=function(fe,st,St){var Pt=fe.getTime()%1e3-st.getTime()%1e3,en=Math.floor(fe.getTime()/1e3)+62135596800;Pt<0&&(Pt+=1e3,en=g.add(en,h.Second(-1)));var dn=_.create(Math.floor(st.getTime()/1e3)+62135596800,en),Ms=dn.negative?-1:1,js;switch(St){case"days":js=dn.getTotalDays();break;case"hours":js=dn.getTotalHours();break;case"milliseconds":js=dn.getTotalSeconds()*1e3+Pt;break;case"minutes":js=dn.getTotalMinutes();break;case"months":js=A.getTotalMonthsFix(dn);break;case"quarters":js=A.getTotalMonthsFix(dn)/3;break;case"seconds":js=dn.getTotalSeconds();break;case"weeks":js=dn.getTotalWeeks();break;case"years":js=dn.getYears();break;default:throw new I("")}return Ms*js},Le={type:L.fnTy(N,[J,J,O]),eval:function(fe){return T.VNumber(Ks(v.asDate(fe[0]),v.asDate(fe[1]),v.asString(fe[2])))}};this.funcMap.h.dateBetween=Le,this.funcMap.h.id={type:L.fnTy(O,[]),eval:null}};L.__name__=!0,L.fnTy=function(N,O,G){return{typeVars:null,params:O,optParams:G,variadic:null,ret:N}},L.vaFnTy=function(N,O,G){return{typeVars:null,params:O,optParams:null,variadic:G,ret:N}},L.genFnTy=function(N,O,G,J){return{typeVars:N,params:G,optParams:J,variadic:null,ret:O}},L.prototype={findFuncDef:function(N){return this.funcMap.h[N]},findConstDef:function(N){return this.constMap.h[N]}};var P=s["formula.ExpectedKind"]={__ename__:!0,__constructs__:null,EkExpr:{_hx_name:"EkExpr",_hx_index:0,__enum__:"formula.ExpectedKind",toString:n},EkUnknown:{_hx_name:"EkUnknown",_hx_index:1,__enum__:"formula.ExpectedKind",toString:n},EkRparen:{_hx_name:"EkRparen",_hx_index:2,__enum__:"formula.ExpectedKind",toString:n}};P.__constructs__=[P.EkExpr,P.EkUnknown,P.EkRparen];var M=s["formula.Error"]={__ename__:!0,__constructs__:null,UnclosedStringLiteral:(a=function(N){return{_hx_index:0,pos:N,__enum__:"formula.Error",toString:n}},a._hx_name="UnclosedStringLiteral",a.__params__=["pos"],a),InvalidStringLiteral:(a=function(N){return{_hx_index:1,pos:N,__enum__:"formula.Error",toString:n}},a._hx_name="InvalidStringLiteral",a.__params__=["pos"],a),UnexpectedChar:(a=function(N,O){return{_hx_index:2,char:N,pos:O,__enum__:"formula.Error",toString:n}},a._hx_name="UnexpectedChar",a.__params__=["char","pos"],a),UnexpectedToken:(a=function(N,O){return{_hx_index:3,token:N,expected:O,__enum__:"formula.Error",toString:n}},a._hx_name="UnexpectedToken",a.__params__=["token","expected"],a),UnbalancedParen:(a=function(N){return{_hx_index:4,pos:N,__enum__:"formula.Error",toString:n}},a._hx_name="UnbalancedParen",a.__params__=["pos"],a),UnknownError:(a=function(N){return{_hx_index:5,pos:N,__enum__:"formula.Error",toString:n}},a._hx_name="UnknownError",a.__params__=["pos"],a),UndefinedConstant:(a=function(N,O){return{_hx_index:6,name:N,pos:O,__enum__:"formula.Error",toString:n}},a._hx_name="UndefinedConstant",a.__params__=["name","pos"],a),FunctionAsConstant:(a=function(N,O){return{_hx_index:7,name:N,pos:O,__enum__:"formula.Error",toString:n}},a._hx_name="FunctionAsConstant",a.__params__=["name","pos"],a),UndefinedFunction:(a=function(N,O){return{_hx_index:8,name:N,pos:O,__enum__:"formula.Error",toString:n}},a._hx_name="UndefinedFunction",a.__params__=["name","pos"],a),UndefinedProp:(a=function(N,O){return{_hx_index:9,name:N,pos:O,__enum__:"formula.Error",toString:n}},a._hx_name="UndefinedProp",a.__params__=["name","pos"],a),TypeMismatch:(a=function(N,O){return{_hx_index:10,expr:N,types:O,__enum__:"formula.Error",toString:n}},a._hx_name="TypeMismatch",a.__params__=["expr","types"],a),TooManyArguments:(a=function(N,O,G){return{_hx_index:11,actual:N,expected:O,pos:G,__enum__:"formula.Error",toString:n}},a._hx_name="TooManyArguments",a.__params__=["actual","expected","pos"],a),TooFewArguments:(a=function(N,O,G){return{_hx_index:12,actual:N,expected:O,pos:G,__enum__:"formula.Error",toString:n}},a._hx_name="TooFewArguments",a.__params__=["actual","expected","pos"],a)};M.__constructs__=[M.UnclosedStringLiteral,M.InvalidStringLiteral,M.UnexpectedChar,M.UnexpectedToken,M.UnbalancedParen,M.UnknownError,M.UndefinedConstant,M.FunctionAsConstant,M.UndefinedFunction,M.UndefinedProp,M.TypeMismatch,M.TooManyArguments,M.TooFewArguments];var U=e.formula.ErrorTool=function(){};U.__name__=!0,U.getPosition=function(N){switch(N._hx_index){case 0:return N.pos;case 1:return N.pos;case 2:return N.pos;case 3:return N.token.pos;case 4:return N.pos;case 5:return N.pos;case 6:return N.pos;case 7:return N.pos;case 8:return N.pos;case 9:return N.pos;case 10:return N.expr.pos;case 11:return N.pos;case 12:return N.pos}},U.reprType=function(N){switch(N._hx_index){case 0:return"数值";case 1:return"文本";case 2:return"布尔";case 3:return"日期"}},U.toString=function(N){switch(N._hx_index){case 0:return"缺少成对的引号";case 1:return"字符串语法错误";case 2:return"语法错误";case 3:return"语法错误";case 4:return"缺少成对的括号";case 5:return"语法错误";case 6:return"找不到常量`"+N.name+"`";case 7:return"`"+N.name+"`是一个函数而不是常量";case 8:return"找不到函数`"+N.name+"`";case 9:return"找不到属性`"+N.name+"`";case 10:for(var O=N.types,G=U.reprType,J=new Array(O.length),se=0,xe=O.length;se<xe;){var Be=se++;J[Be]=G(O[Be])}return"类型错误，期望"+J.join("或")+"类型";case 11:return"参数过多，期望"+N.expected+"个，传入"+N.actual+"个";case 12:return"参数过少，期望"+N.expected+"个，传入"+N.actual+"个"}};var V=s["formula.EvalError"]={__ename__:!0,__constructs__:null};V.__constructs__=[];var W=e.formula.EvalContext=function(){};W.__name__=!0;var z=function(N){this.ctx=N};z.__name__=!0,z.prototype={eval:function(N,O){var G=this,J=new Date,se=null;se=function(Be){for(;;){var Re=Be.desc;switch(Re._hx_index){case 0:return T.VNumber(Re.value);case 1:return T.VString(Re.value);case 2:return L.singleton.findConstDef(Re.$const);case 3:var vt=Re.fn,_n=Re.args;if(vt=="id")return T.VString(O);if(vt=="prop")return G.ctx.readProp(O,re.getStringValue(_n[1]),Be.type);if(vt=="if"){var rr=_n[1],Ks=_n[2];return v.asBoolean(se(_n[0]))?se(rr):se(Ks)}else if(vt=="and"){var Le=_n[1];return T.VBoolean(v.asBoolean(se(_n[0]))&&v.asBoolean(se(Le)))}else if(vt=="or"){var fe=_n[1];return T.VBoolean(v.asBoolean(se(_n[0]))||v.asBoolean(se(fe)))}else if(vt=="now")return T.VDate(J);for(var st=new Array(_n.length),St=0,Pt=_n.length;St<Pt;){var en=St++;st[en]=se(_n[en])}return L.singleton.findFuncDef(vt).eval(st);case 4:Be=Re.exp;continue;case 5:var dn=[se(Re.arg)],Ms;switch(Re.op._hx_index){case 0:Ms="unaryPlus";break;case 1:Ms="unaryMinus";break;case 2:Ms="not";break}return L.singleton.findFuncDef(Ms).eval(dn);case 6:var js=Re.arg1,cf=Re.arg2,xh=[se(js),se(cf)],Mr;switch(Re.op._hx_index){case 0:Mr=js.type==C.TNumber?"add":"concat";break;case 1:Mr="subtract";break;case 2:Mr="multiply";break;case 3:Mr="divide";break;case 4:Mr="mod";break;case 5:Mr="pow";break;case 6:Mr="equal";break;case 7:Mr="unequal";break;case 8:Mr="smaller";break;case 9:Mr="smallerEq";break;case 10:Mr="larger";break;case 11:Mr="largerEq";break;case 12:Mr="and";break;case 13:Mr="or";break}return Mr=="and"?T.VBoolean(v.asBoolean(se(js))&&v.asBoolean(se(cf))):Mr=="or"?T.VBoolean(v.asBoolean(se(js))||v.asBoolean(se(cf))):L.singleton.findFuncDef(Mr).eval(xh);case 7:if(v.asBoolean(se(Re.test))){Be=Re.then;continue}else{Be=Re.else_;continue}}}};var xe=se;try{return xe(N)}catch(Be){return null}}};var Q=s["formula.UnOp"]={__ename__:!0,__constructs__:null,OpUnaryPlus:{_hx_name:"OpUnaryPlus",_hx_index:0,__enum__:"formula.UnOp",toString:n},OpUnaryMinus:{_hx_name:"OpUnaryMinus",_hx_index:1,__enum__:"formula.UnOp",toString:n},OpNot:{_hx_name:"OpNot",_hx_index:2,__enum__:"formula.UnOp",toString:n}};Q.__constructs__=[Q.OpUnaryPlus,Q.OpUnaryMinus,Q.OpNot];var Z=s["formula.BinOp"]={__ename__:!0,__constructs__:null,OpAdd:{_hx_name:"OpAdd",_hx_index:0,__enum__:"formula.BinOp",toString:n},OpSub:{_hx_name:"OpSub",_hx_index:1,__enum__:"formula.BinOp",toString:n},OpMul:{_hx_name:"OpMul",_hx_index:2,__enum__:"formula.BinOp",toString:n},OpDiv:{_hx_name:"OpDiv",_hx_index:3,__enum__:"formula.BinOp",toString:n},OpMod:{_hx_name:"OpMod",_hx_index:4,__enum__:"formula.BinOp",toString:n},OpPow:{_hx_name:"OpPow",_hx_index:5,__enum__:"formula.BinOp",toString:n},OpEq:{_hx_name:"OpEq",_hx_index:6,__enum__:"formula.BinOp",toString:n},OpNeq:{_hx_name:"OpNeq",_hx_index:7,__enum__:"formula.BinOp",toString:n},OpLt:{_hx_name:"OpLt",_hx_index:8,__enum__:"formula.BinOp",toString:n},OpLeq:{_hx_name:"OpLeq",_hx_index:9,__enum__:"formula.BinOp",toString:n},OpGt:{_hx_name:"OpGt",_hx_index:10,__enum__:"formula.BinOp",toString:n},OpGeq:{_hx_name:"OpGeq",_hx_index:11,__enum__:"formula.BinOp",toString:n},OpAnd:{_hx_name:"OpAnd",_hx_index:12,__enum__:"formula.BinOp",toString:n},OpOr:{_hx_name:"OpOr",_hx_index:13,__enum__:"formula.BinOp",toString:n}};Z.__constructs__=[Z.OpAdd,Z.OpSub,Z.OpMul,Z.OpDiv,Z.OpMod,Z.OpPow,Z.OpEq,Z.OpNeq,Z.OpLt,Z.OpLeq,Z.OpGt,Z.OpGeq,Z.OpAnd,Z.OpOr];var te=s["formula.ExprDesc"]={__ename__:!0,__constructs__:null,ENumber:(a=function(N){return{_hx_index:0,value:N,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="ENumber",a.__params__=["value"],a),EString:(a=function(N){return{_hx_index:1,value:N,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EString",a.__params__=["value"],a),EConst:(a=function(N){return{_hx_index:2,$const:N,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EConst",a.__params__=["$const"],a),ECall:(a=function(N,O,G){return{_hx_index:3,fn:N,fnPos:O,args:G,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="ECall",a.__params__=["fn","fnPos","args"],a),EParen:(a=function(N){return{_hx_index:4,exp:N,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EParen",a.__params__=["exp"],a),EUnary:(a=function(N,O,G){return{_hx_index:5,op:N,opPos:O,arg:G,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EUnary",a.__params__=["op","opPos","arg"],a),EBinary:(a=function(N,O,G,J){return{_hx_index:6,op:N,opPos:O,arg1:G,arg2:J,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="EBinary",a.__params__=["op","opPos","arg1","arg2"],a),ETernary:(a=function(N,O,G){return{_hx_index:7,test:N,then:O,else_:G,__enum__:"formula.ExprDesc",toString:n}},a._hx_name="ETernary",a.__params__=["test","then","else_"],a)};te.__constructs__=[te.ENumber,te.EString,te.EConst,te.ECall,te.EParen,te.EUnary,te.EBinary,te.ETernary];var re=e.formula.ExprTool=function(){};re.__name__=!0,re.getStringValue=function(N){var O=N.desc;return O._hx_index==1?O.value:null},re.typeOf=function(N){return N.type},o(W.prototype,{readProp:function(N,O,G){return T.VNumber(10)}});var ne=e.formula.Formula=function(){};ne.__name__=!0,ne.main=function(){},ne.toServer=function(N,O){var G={};return{text:ne.regex.map(N,function(J){var se=JSON.parse(J.matched(1)),xe=O.findPropDefByName(se);G[xe.id]=se;var Be=new RegExp('"(?:[^\\\\"]|\\\\.)*"',"".split("u").join("")),Re=J.matched(0),vt=JSON.stringify(xe.id);return Re.replace(Be,vt)}),refProps:G}},ne.fromServer=function(N,O){return ne.regex.map(N.text==null?"":N.text,function(G){var J=JSON.parse(G.matched(1)),se=O.findPropDefById(J),xe=se==null?N.refProps[J]:se.name,Be=new RegExp('"(?:[^\\\\"]|\\\\.)*"',"".split("u").join("")),Re=G.matched(0),vt=JSON.stringify(xe);return Re.replace(Be,vt)})},ne.parse=function(N,O){var G=new ue(new oe(N),O);try{return ge.Ok(G.parse())}catch(Be){var J=I.caught(Be),se=J.unwrap();if(J instanceof X)return ge.Error(J.error);if(se instanceof $t)return ge.Error(M.UnexpectedToken(se.token,P.EkUnknown));if(se instanceof Ze)return ge.Error(M.UnexpectedToken(se.token,P.EkUnknown));if(se instanceof jt){var xe=se;return ge.Error(M.UnexpectedChar(xe.char,xe.pos))}else{if(se instanceof et)return ge.Error(M.UnknownError(se.pos));throw Be}}},ne.eval=function(N,O,G){return new z(O).eval(N,G)},ne.objc_parse=function(N,O){for(var G=new De,J=0;J<O.length;){var se=O[J];++J;var xe;switch(se.type){case"boolean":xe=C.TBoolean;break;case"date":xe=C.TDate;break;case"number":xe=C.TNumber;break;case"string":xe=C.TString;break;default:xe=C.TString}G.defineProp(se.id,se.name,xe)}var Be=ne.parse(N,G);return{ok:Ne.isOk(Be)?Ne.getOk(Be):null,error:Ne.isError(Be)?U.toString(Ne.getError(Be)):null}},ne.objc_eval=function(N,O){var G=ne.eval(N,Y.singleton,O),J=v.toString(G),se;switch(G._hx_index){case 0:se="number";break;case 1:se="string";break;case 2:se="boolean";break;case 3:se="date";break}return{value:J,type:se}},ne.objc_expr_type=function(N){switch(N.type._hx_index){case 0:return"number";case 1:return"string";case 2:return"boolean";case 3:return"date"}};var Y=function(){};Y.__name__=!0,Y.__super__=W,Y.prototype=o(W.prototype,{readProp:function(N,O,G){var J=objc_read_prop(N,O);return typeof J=="string"?T.VString(J):typeof J=="number"?T.VNumber(J):typeof J=="boolean"?T.VBoolean(J):J instanceof Date?T.VDate(J):null}});var X=function(N){I.call(this,U.toString(N)),this.error=N};X.__name__=!0,X.__super__=I,X.prototype=o(I.prototype,{});var oe=function(N,O){O==null&&(O="(none)"),this.cursor=0,this.input=N,this.source=O};oe.__name__=!0,oe.prototype={token:function(){var N=this;this.skip(new l(`^[ 	\r
]+`,""));var O=this.cursor,G=function(Re){return{tok:Re,pos:new tt(N.source,O,N.cursor)}};if(this.cursor==this.input.length)return G(Se.TkEof);var J=new l('(?:"([^"\\\\]|\\\\.)*"?|(0|[1-9][0-9]*)([.][0-9]+)?([eE][\\\\+\\\\-]?0|[1-9][0-9]*)?|[A-Za-z_][A-Za-z0-9_]*|\\(|\\)|\\+|\\-|\\*|/|%|\\^|==|!=|<>|<=|<|>=|>|,|\\?|:)',"");if(J.match(this.input.substring(this.cursor))){var se=J.matched(0);switch(this.cursor+=J.matchedPos().len,se){case"!=":return G(Se.TkBinOp(Z.OpNeq));case"%":return G(Se.TkBinOp(Z.OpMod));case"(":return G(Se.TkLparen);case")":return G(Se.TkRparen);case"*":return G(Se.TkBinOp(Z.OpMul));case"+":return G(Se.TkBinOp(Z.OpAdd));case",":return G(Se.TkComma);case"-":return G(Se.TkBinOp(Z.OpSub));case"/":return G(Se.TkBinOp(Z.OpDiv));case":":return G(Se.TkColon);case"<":return G(Se.TkBinOp(Z.OpLt));case"<=":return G(Se.TkBinOp(Z.OpLeq));case"<>":return G(Se.TkBinOp(Z.OpNeq));case"==":return G(Se.TkBinOp(Z.OpEq));case">":return G(Se.TkBinOp(Z.OpGt));case">=":return G(Se.TkBinOp(Z.OpGeq));case"?":return G(Se.TkQuestion);case"^":return G(Se.TkBinOp(Z.OpPow));default:var xe=se.charAt(0);if(xe=='"')if(se.length>1&&se.charAt(se.length-1)=='"')try{return G(Se.TkStr(JSON.parse(se)))}catch(Re){var Be=this.cursor-J.matchedPos().len;throw new X(M.InvalidStringLiteral(new tt(this.source,Be,this.cursor)))}else{var Be=this.cursor-J.matchedPos().len;throw new X(M.UnclosedStringLiteral(new tt(this.source,Be,Be+1)))}else return xe>="0"&&xe<="9"?G(Se.TkNum(parseFloat(se))):G(Se.TkIdent(se))}}else throw new X(M.UnexpectedChar(this.input.charAt(this.cursor),new tt(this.source,this.cursor,this.cursor+1)))},skip:function(N){N.match(this.input.substring(this.cursor))&&(this.cursor+=N.matchedPos().len)},curPos:function(){return new tt(this.source,this.cursor,this.cursor)}};var ie=function(N){this.stream=N};ie.__name__=!0,ie.prototype={peek:function(N){this.token==null&&(this.token=new dt(this.stream.token(),null),--N);for(var O=this.token;N>0;)O.next==null&&(O.next=new dt(this.stream.token(),null)),O=O.next,--N;return O.elt},junk:function(){this.last=this.token.elt,this.token=this.token.next},curPos:function(){return this.stream.curPos()},parseSeparated:function(N,O){for(var G=[];;){try{G.push(O())}catch(se){var J=I.caught(se).unwrap();if(I.caught(J).unwrap()instanceof $t)break;throw I.thrown(J)}if(N(this.peek(0)))this.last=this.token.elt,this.token=this.token.next;else break}return G},parseOptional:function(N){try{return N()}catch(G){var O=I.caught(G).unwrap();if(I.caught(O).unwrap()instanceof $t)return null;throw I.thrown(O)}},parseRepeat:function(N){for(var O=[];;)try{O.push(N())}catch(J){var G=I.caught(J).unwrap();if(I.caught(G).unwrap()instanceof $t)return O;throw I.thrown(G)}},parseExpect:function(N){try{return N()}catch(G){var O=I.caught(G).unwrap();throw I.caught(O).unwrap()instanceof $t?I.thrown(I.thrown(new Ze(this.peek(0),this.stream.curPos()))):I.thrown(O)}},noMatch:function(){return new $t(this.stream.curPos(),this.peek(0))},unexpected:function(){throw I.thrown(I.thrown(new Ze(this.peek(0),this.stream.curPos())))}};var ue=function(N,O){ie.call(this,N),this.schema=O,this.typer=new Ie(O)};ue.__name__=!0,ue.punion=function(N,O){return new tt(N.psource,N.pmin<O.pmin?N.pmin:O.pmin,N.pmax>O.pmax?N.pmax:O.pmax)},ue.__super__=ie,ue.prototype=o(ie.prototype,{mk:function(N,O){return{desc:N,pos:O,type:null}},mkUnary:function(N,O,G){var J=G.desc;switch(J._hx_index){case 6:var se=J.op,xe=J.arg1;return N!=Q.OpNot||this.precedence(se).p>=7?this.mk(te.EBinary(se,J.opPos,this.mkUnary(N,O,xe),J.arg2),ue.punion(O,xe.pos)):this.mk(te.EUnary(N,O,G),ue.punion(O,G.pos));case 7:return this.mk(te.ETernary(this.mkUnary(N,O,J.test),J.then,J.else_),ue.punion(O,G.pos));default:return this.mk(te.EUnary(N,O,G),ue.punion(O,G.pos))}},mkBinary:function(N,O,G,J){var se=J.desc;switch(se._hx_index){case 6:var Re=se.op,xe=se.arg2;if(this.swap(N,Re)){var Be=this.mkBinary(N,O,G,se.arg1);return this.mk(te.EBinary(Re,se.opPos,Be,xe),ue.punion(Be.pos,xe.pos))}else return this.mk(te.EBinary(N,O,G,J),ue.punion(G.pos,J.pos));case 7:var Re=se.else_,vt=this.mkBinary(N,O,G,se.test);return this.mk(te.ETernary(vt,se.then,Re),ue.punion(vt.pos,Re.pos));default:return this.mk(te.EBinary(N,O,G,J),ue.punion(G.pos,J.pos))}},psep:function(N,O){for(var G=[];;)try{if(G.push(O()),this.peek(0).tok==N)this.last=this.token.elt,this.token=this.token.next;else throw I.thrown(new $t(this.stream.curPos(),this.peek(0)))}catch(se){var J=I.caught(se);if(J.unwrap()instanceof $t)break;if(J instanceof X)break;throw se}return G},precedence:function(N){switch(N._hx_index){case 0:case 1:return{p:3,left:!0};case 2:case 3:case 4:return{p:2,left:!0};case 5:return{p:1,left:!0};case 6:case 7:case 8:case 9:case 10:case 11:return{p:6,left:!0};case 12:case 13:return{p:7,left:!0}}},swap:function(N,O){var G=this.precedence(N),J=this.precedence(O);return G.left?G.p<=J.p:!1},parse:function(){var N=this.expr();if(this.peek(0).tok._hx_index==9)this.last=this.token.elt,this.token=this.token.next;else throw I.thrown(new Ze(this.peek(0),this.stream.curPos()));return this.typer.infer(N),N},expr:function(){var N=this.peek(0),O=N.pos,G=N.tok;switch(G._hx_index){case 0:return this.last=this.token.elt,this.token=this.token.next,this.exprNext(this.mk(te.ENumber(G.value),O));case 1:return this.last=this.token.elt,this.token=this.token.next,this.exprNext(this.mk(te.EString(G.value),O));case 2:this.last=this.token.elt,this.token=this.token.next;var J=this.expr(),N=this.peek(0);if(N.tok._hx_index==3)return this.last=this.token.elt,this.token=this.token.next,this.exprNext(this.mk(te.EParen(J),ue.punion(O,N.pos)));throw new X(M.UnbalancedParen(O));case 4:var N=G.name;if(N=="not")return this.last=this.token.elt,this.token=this.token.next,this.mkUnary(Q.OpNot,O,this.expr());this.last=this.token.elt,this.token=this.token.next;var se=this.peek(0),xe=se.pos;if(se.tok._hx_index==2){this.last=this.token.elt,this.token=this.token.next;var Be=this.psep(Se.TkComma,nn(this,this.expr)),se=this.peek(0);if(se.tok._hx_index==3)return this.last=this.token.elt,this.token=this.token.next,this.exprNext(this.mk(te.ECall(N,O,Be),ue.punion(O,se.pos)));var Re=this.peek(0);throw Re.tok==Se.TkEof?new X(M.UnbalancedParen(xe)):new X(M.UnexpectedToken(Re,P.EkRparen))}else return this.exprNext(this.mk(te.EConst(N),O));case 8:switch(G.op._hx_index){case 0:return this.last=this.token.elt,this.token=this.token.next,this.mkUnary(Q.OpUnaryPlus,O,this.expr());case 1:return this.last=this.token.elt,this.token=this.token.next,this.mkUnary(Q.OpUnaryMinus,O,this.expr());default:throw new X(M.UnexpectedToken(this.peek(0),P.EkExpr))}default:throw new X(M.UnexpectedToken(this.peek(0),P.EkExpr))}},exprNext:function(N){var O=this.peek(0),G=O.pos,J=O.tok;switch(J._hx_index){case 4:switch(J.name){case"and":return this.last=this.token.elt,this.token=this.token.next,this.mkBinary(Z.OpAnd,G,N,this.expr());case"or":return this.last=this.token.elt,this.token=this.token.next,this.mkBinary(Z.OpOr,G,N,this.expr());default:return N}case 6:this.last=this.token.elt,this.token=this.token.next;var se=this.expr();if(this.peek(0).tok._hx_index==7){this.last=this.token.elt,this.token=this.token.next;var xe=this.expr();return this.mk(te.ETernary(N,se,xe),ue.punion(N.pos,xe.pos))}else throw I.thrown(new Ze(this.peek(0),this.stream.curPos()));case 8:return this.last=this.token.elt,this.token=this.token.next,this.mkBinary(J.op,G,N,this.expr());default:return N}}});var ge=s["formula.Result"]={__ename__:!0,__constructs__:null,Ok:(a=function(N){return{_hx_index:0,value:N,__enum__:"formula.Result",toString:n}},a._hx_name="Ok",a.__params__=["value"],a),Error:(a=function(N){return{_hx_index:1,error:N,__enum__:"formula.Result",toString:n}},a._hx_name="Error",a.__params__=["error"],a)};ge.__constructs__=[ge.Ok,ge.Error];var Ne=e.formula.ResultTool=function(){};Ne.__name__=!0,Ne.isOk=function(N){switch(N._hx_index){case 0:return!0;case 1:return!1}},Ne.isError=function(N){switch(N._hx_index){case 0:return!1;case 1:return!0}},Ne.getOk=function(N){switch(N._hx_index){case 0:return N.value;case 1:throw new I("Invalid argument")}},Ne.getError=function(N){switch(N._hx_index){case 0:throw new I("Invalid argument");case 1:return N.error}};var De=e.formula.Schema=function(){this.byNameMap=new ut,this.byIdMap=new ut};De.__name__=!0,De.prototype={defineProp:function(N,O,G){var J={id:N,name:O,type:G};this.byIdMap.h[N]=J,this.byNameMap.h[O]=J},findPropDefById:function(N){return this.byIdMap.h[N]},findPropDefByName:function(N){return this.byNameMap.h[N]}};var Se=s["formula.TokenDesc"]={__ename__:!0,__constructs__:null,TkNum:(a=function(N){return{_hx_index:0,value:N,__enum__:"formula.TokenDesc",toString:n}},a._hx_name="TkNum",a.__params__=["value"],a),TkStr:(a=function(N){return{_hx_index:1,value:N,__enum__:"formula.TokenDesc",toString:n}},a._hx_name="TkStr",a.__params__=["value"],a),TkLparen:{_hx_name:"TkLparen",_hx_index:2,__enum__:"formula.TokenDesc",toString:n},TkRparen:{_hx_name:"TkRparen",_hx_index:3,__enum__:"formula.TokenDesc",toString:n},TkIdent:(a=function(N){return{_hx_index:4,name:N,__enum__:"formula.TokenDesc",toString:n}},a._hx_name="TkIdent",a.__params__=["name"],a),TkComma:{_hx_name:"TkComma",_hx_index:5,__enum__:"formula.TokenDesc",toString:n},TkQuestion:{_hx_name:"TkQuestion",_hx_index:6,__enum__:"formula.TokenDesc",toString:n},TkColon:{_hx_name:"TkColon",_hx_index:7,__enum__:"formula.TokenDesc",toString:n},TkBinOp:(a=function(N){return{_hx_index:8,op:N,__enum__:"formula.TokenDesc",toString:n}},a._hx_name="TkBinOp",a.__params__=["op"],a),TkEof:{_hx_name:"TkEof",_hx_index:9,__enum__:"formula.TokenDesc",toString:n}};Se.__constructs__=[Se.TkNum,Se.TkStr,Se.TkLparen,Se.TkRparen,Se.TkIdent,Se.TkComma,Se.TkQuestion,Se.TkColon,Se.TkBinOp,Se.TkEof];var Ie=function(N){this.schema=N};Ie.__name__=!0,Ie.prototype={inferResult:function(N,O,G,J){var se=L.singleton.findFuncDef(N);if(se==null)throw new X(M.UndefinedFunction(N,G));var xe=se.type,Be={},Re=function(dn,Ms){switch(Ms._hx_index){case 0:var js=Ms.type;if(dn.type!=js)throw new X(M.TypeMismatch(dn,[js]));break;case 1:var js=Ms.id;if(Be.hasOwnProperty(js)){var cf=Be[js];if(dn.type!=cf)throw new X(M.TypeMismatch(dn,[cf]))}else{var xh=xe.typeVars.h[js];if(xh!=null&&xh.indexOf(dn.type)==-1)throw new X(M.TypeMismatch(dn,xh));Be[js]=dn.type}break}};if(O.length<xe.params.length)throw new X(M.TooFewArguments(O.length,xe.params.length,J));var vt=xe.optParams==null?0:xe.optParams.length;if(O.length>xe.params.length+vt&&xe.variadic==null)throw new X(M.TooManyArguments(O.length,xe.params.length,J));for(var _n=xe.params,rr=0;rr<_n.length;){var Ks=_n[rr++];Re(O[rr-1],Ks)}if(xe.optParams!=null&&O.length>xe.params.length)for(var en=xe.params.length,Le=xe.params.length+vt;en<Le;){var fe=en++;Re(O[fe],xe.optParams[fe-xe.params.length])}if(xe.variadic!=null&&O.length>xe.params.length+vt)for(var en=xe.params.length+vt,Le=O.length;en<Le;)Re(O[en++],xe.variadic);if(N=="prop"){var st=O[0],St=re.getStringValue(st),Pt=this.schema.findPropDefByName(St);if(Pt==null)throw new X(M.UndefinedProp(St,st.pos));return O[1]={desc:te.EString(Pt.id),pos:st.pos,type:C.TString},Pt.type}var en=xe.ret;switch(en._hx_index){case 0:return en.type;case 1:return Be[en.id]}},infer:function(N){if(N.type!=null)return N.type;var O=N.desc,G;switch(O._hx_index){case 0:G=C.TNumber;break;case 1:G=C.TString;break;case 2:var Be=O.$const,J=L.singleton.findConstDef(Be);if(J==null)throw L.singleton.findFuncDef(Be)!=null?new X(M.FunctionAsConstant(Be,N.pos)):new X(M.UndefinedConstant(Be,N.pos));switch(J._hx_index){case 0:G=C.TNumber;break;case 1:G=C.TString;break;case 2:G=C.TBoolean;break;case 3:G=C.TDate;break}break;case 3:for(var Be=O.fn,Re=O.fnPos,vt=O.args,se=0;se<vt.length;)this.infer(vt[se++]);G=this.inferResult(Be,vt,Re,N.pos);break;case 4:G=this.infer(O.exp);break;case 5:var Be=O.opPos,Re=O.arg;this.infer(Re);var xe;switch(O.op._hx_index){case 0:xe="unaryPlus";break;case 1:xe="unaryMinus";break;case 2:xe="not";break}G=this.inferResult(xe,[Re],Be,N.pos);break;case 6:var Be=O.opPos,Re=O.arg1,vt=O.arg2;this.infer(Re),this.infer(vt);var xe;switch(O.op._hx_index){case 0:xe=Re.type==C.TNumber?"add":"concat";break;case 1:xe="subtract";break;case 2:xe="multiply";break;case 3:xe="divide";break;case 4:xe="mod";break;case 5:xe="pow";break;case 6:xe="equal";break;case 7:xe="unequal";break;case 8:xe="smaller";break;case 9:xe="smallerEq";break;case 10:xe="larger";break;case 11:xe="largerEq";break;case 12:xe="and";break;case 13:xe="or";break}G=this.inferResult(xe,[Re,vt],Be,N.pos);break;case 7:var Be=O.test,Re=O.then,vt=O.else_;this.infer(Be),this.infer(Re),this.infer(vt),G=this.inferResult("if",[Be,Re,vt],null,N.pos);break}return N.type=G},check:function(){}};var Ke=function(N,O,G){I.call(this,String(N),O,G),this.value=N};Ke.__name__=!0,Ke.__super__=I,Ke.prototype=o(I.prototype,{unwrap:function(){return this.value}});var dt=function(N,O){this.elt=N,this.next=O};dt.__name__=!0;var $e=function(){this.h={}};$e.__name__=!0;var ut=function(){this.h=Object.create(null)};ut.__name__=!0;var Ee=s["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}};Ee.__constructs__=[Ee.UTF8,Ee.RawNative];var Ge=s["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(a=function(N){return{_hx_index:3,e:N,__enum__:"haxe.io.Error",toString:n}},a._hx_name="Custom",a.__params__=["e"],a)};Ge.__constructs__=[Ge.Blocked,Ge.Overflow,Ge.OutsideBounds,Ge.Custom];var Je=function(N){this.current=0,this.array=N};Je.__name__=!0,Je.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]}};var et=function(N){this.pos=N};et.__name__=!0,et.prototype={toString:function(){return"Parser error"}};var $t=function(N,O){et.call(this,N),this.token=O};$t.__name__=!0,$t.__super__=et,$t.prototype=o(et.prototype,{toString:function(){return"No match: "+d.string(this.token)}});var tt=function(N,O,G){this.psource=N,this.pmin=O,this.pmax=G};tt.__name__=!0,tt.union=function(N,O){return new tt(N.psource,N.pmin<O.pmin?N.pmin:O.pmin,N.pmax>O.pmax?N.pmax:O.pmax)},tt.prototype={toString:function(){return""+this.psource+":characters "+this.pmin+"-"+this.pmax},getLinePosition:function(N){for(var O=1,G=1,J=0,se=0,xe=0;xe<this.pmin;)N.b[xe]==10&&(++O,J=xe+1),++xe;for(G=O,se=J,J=xe-J;xe<this.pmax;)N.b[xe]==10&&(++G,se=xe+1),++xe;return se=xe-se,{lineMin:O,lineMax:G,posMin:J,posMax:se}},format:function(N){var O=this.getLinePosition(N);return O.lineMin!=O.lineMax?""+this.psource+":lines "+O.lineMin+"-"+O.lineMax:""+this.psource+":"+O.lineMin+": characters "+O.posMin+"-"+O.posMax}};var Ze=function(N,O){et.call(this,O),this.token=N};Ze.__name__=!0,Ze.__super__=et,Ze.prototype=o(et.prototype,{toString:function(){return"Unexpected "+d.string(this.token)}});var jt=function(N,O){et.call(this,O),this.char=N};jt.__name__=!0,jt.__super__=et,jt.prototype=o(et.prototype,{toString:function(){return"Unexpected "+this.char}});function It(N){return N instanceof Array?new Je(N):N.iterator()}function nn(N,O){if(O==null)return null;O.__id__==null&&(O.__id__=t.$haxeUID++);var G;return N.hx__closures__==null?N.hx__closures__={}:G=N.hx__closures__[O.__id__],G==null&&(G=O.bind(N),N.hx__closures__[O.__id__]=G),G}t.$haxeUID|=0,typeof performance<"u"&&typeof performance.now=="function"&&(c.now=performance.now.bind(performance)),String.fromCodePoint==null&&(String.fromCodePoint=function(N){return N<65536?String.fromCharCode(N):String.fromCharCode((N>>10)+55232)+String.fromCharCode((N&1023)+56320)}),String.__name__=!0,Array.__name__=!0,Date.__name__="Date",D.__toStr={}.toString,i.DAY_SHORT_NAMES=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i.DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i.MONTH_SHORT_NAMES=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i.MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"],g.UNIX_EPOCH_DIFF=62135596800,g.SECONDS_IN_MINUTE=60,g.SECONDS_IN_HOUR=3600,g.SECONDS_IN_DAY=86400,g.SECONDS_IN_WEEK=604800,g.SECONDS_IN_YEAR=31536e3,g.SECONDS_IN_LEAP_YEAR=31622400,g.SECONDS_IN_3_YEARS=94608e3,g.SECONDS_IN_QUAD=126230400,g.SECONDS_IN_HALF_QUAD=63072e3,g.SECONDS_IN_HALF_QUAD_LEAP=63158400,g.SECONDS_IN_3_PART_QUAD=94694400,g.SECONDS_IN_CQUAD=12622780800,g.SECONDS_IN_CENTURY=3155673600,g.SECONDS_IN_LEAP_CENTURY=315576e4,v.numberType=C.TNumber,v.stringType=C.TString,v.booleanType=C.TBoolean,v.dateType=C.TDate,L.singleton=new L,ne.regex=new l('\\bprop\\s*\\(\\s*("(?:[^\\\\"]|\\\\.)*")\\s*\\)',"g"),Y.singleton=new Y,ne.main()})(typeof R2<"u"?R2:typeof window<"u"?window:typeof self<"u"?self:globalThis,typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:globalThis);const He=R2.formula,Ur=[{type:m.AggregationAction.NONE,title:"不展示"},{type:m.AggregationAction.COUNT_ALL,title:"记录数"},{type:m.AggregationAction.COUNT_VALUE,title:"值数"},{type:m.AggregationAction.COUNT_UNIQUE_VALUE,title:"唯一值"},{type:m.AggregationAction.COUNT_EMPTY,title:"未填写"},{type:m.AggregationAction.COUNT_NOT_EMPTY,title:"已填写"},{type:m.AggregationAction.PERCENT_EMPTY,title:"未填写占比"},{type:m.AggregationAction.PERCENT_NOT_EMPTY,title:"已填写占比"}],l1=[...Ur,{type:m.AggregationAction.EARLIEST_DATE,title:"最早"},{type:m.AggregationAction.LATEST_DATE,title:"最晚"},{type:m.AggregationAction.DATE_RANGE,title:"日期范围"}],YW=[{type:m.AggregationAction.NONE,title:"不展示"},{type:m.AggregationAction.COUNT_ALL,title:"记录数"},{type:m.AggregationAction.CHECKED,title:"已完成"},{type:m.AggregationAction.UNCHECKED,title:"未完成"},{type:m.AggregationAction.PERCENT_CHECKED,title:"已完成占比"},{type:m.AggregationAction.PERCENT_UNCHECKED,title:"未完成占比"}],U6=[...Ur,{type:m.AggregationAction.SUM,title:"求和"},{type:m.AggregationAction.AVERAGE,title:"平均值"},{type:m.AggregationAction.MEDIAN,title:"中位数"},{type:m.AggregationAction.MIN,title:"最小"},{type:m.AggregationAction.MAX,title:"最大"},{type:m.AggregationAction.RANGE,title:"范围"}],uv={[m.CollectionSchemaType.TITLE]:Ur,[m.CollectionSchemaType.TEXT]:Ur,[m.CollectionSchemaType.SELECT]:Ur,[m.CollectionSchemaType.MULTI_SELECT]:Ur,[m.CollectionSchemaType.NUMBER]:U6,[m.CollectionSchemaType.CHECKBOX]:YW,[m.CollectionSchemaType.DATE]:l1,[m.CollectionSchemaType.CREATED_AT]:l1,[m.CollectionSchemaType.UPDATED_AT]:l1,[m.CollectionSchemaType.CREATED_BY]:Ur,[m.CollectionSchemaType.UPDATED_BY]:Ur,[m.CollectionSchemaType.PERSON]:Ur,[m.CollectionSchemaType.FILE]:Ur,[m.CollectionSchemaType.URL]:Ur,[m.CollectionSchemaType.EMAIL]:Ur,[m.CollectionSchemaType.PHONE]:Ur,[m.CollectionSchemaType.FORMULA]:Ur,[m.CollectionSchemaType.RELATION]:Ur,[m.CollectionSchemaType.ROLLUP]:Ur},V6={none:"不展示",countAll:"记录数",countValue:"值数",countUniqueValue:"唯一值",countEmpty:"未填写",countNotEmpty:"已填写",percentEmpty:"未填写占比",percentNotEmpty:"已填写占比",sum:"求和",average:"平均值",median:"中位数",min:"最小",max:"最大",range:"范围",checked:"已完成",unchecked:"未完成",percentChecked:"已完成占比",percentUnchecked:"未完成占比",earliestDate:"最早",latestDate:"最晚",dateRange:"日期范围",showUnique:"显示 唯一值",showOrigin:"显示 原始值"},XW=(e,t)=>so(t)?Ur:(e===m.CollectionSchemaType.DATE||e===m.CollectionSchemaType.CREATED_AT||e===m.CollectionSchemaType.UPDATED_AT)&&ai(t)?l1:U6,so=e=>!e||e===m.AggregationAction.SHOW_UNIQUE||e===m.AggregationAction.SHOW_ORIGIN,ai=e=>e===m.AggregationAction.EARLIEST_DATE||e===m.AggregationAction.LATEST_DATE||e===m.AggregationAction.DATE_RANGE,Vf=e=>e===m.AggregationAction.SUM||e===m.AggregationAction.AVERAGE||e===m.AggregationAction.MEDIAN||e===m.AggregationAction.MIN||e===m.AggregationAction.MAX||e===m.AggregationAction.RANGE,zd=e=>e===m.AggregationAction.PERCENT_EMPTY||e===m.AggregationAction.PERCENT_NOT_EMPTY||e===m.AggregationAction.PERCENT_CHECKED||e===m.AggregationAction.PERCENT_UNCHECKED,q6=e=>ai(e)?"date":Vf(e)||e===m.AggregationAction.COUNT_ALL||e===m.AggregationAction.COUNT_VALUE||e===m.AggregationAction.COUNT_UNIQUE_VALUE||e===m.AggregationAction.COUNT_EMPTY||e===m.AggregationAction.COUNT_NOT_EMPTY||e===m.AggregationAction.CHECKED||e===m.AggregationAction.UNCHECKED?"number":"string";class tu{isEmpty(t){return t===void 0||this.isNonNullEmpty(t)}useRender(t){return null}}class Zx extends tu{isNonNullEmpty(t){return t.length===0}compare(t,n){const s=t[Symbol.iterator](),a=n[Symbol.iterator]();for(;;){const o=s.next(),i=a.next();if(o.done&&i.done)return 0;if(o.done)return-1;if(i.done)return 1;const l=this.compareElement(o.value,i.value);if(l!==0)return l}}}class H6 extends tu{fromSegments(t){return t===void 0?!1:t.map(n=>n.text).join("").toUpperCase()==="YES"}toSegments(t){if(t)return[{type:m.TextType.TEXT,text:"YES",enhancer:{}}]}isNonNullEmpty(t){return t===!1}compare(t,n){return t===n?0:t?1:-1}}const QW=new H6,JW="YYYY/MM/DD HH:mm",zy="YYYY/MM/DD",ZW="HH:mm";class eK extends tu{fromSegments(t){if(t===void 0)return;const n=t.find(s=>s.type===m.TextType.DATE||s.type===m.TextType.DATETIME);if(n!==void 0)return n.type===m.TextType.DATE?{timestamp:he(`${n.startDate}`,zy).startOf("day").valueOf(),noTimePart:!0}:{timestamp:he(`${n.startDate} ${n.startTime}`,JW).startOf("minute").valueOf(),noTimePart:!1}}toSegments(t){return t.noTimePart?[{type:m.TextType.DATE,enhancer:{},text:"@",startDate:he(t.timestamp).format(zy)}]:[{type:m.TextType.DATETIME,enhancer:{},text:"@",startDate:he(t.timestamp).format(zy),startTime:he(t.timestamp).format(ZW)}]}isNonNullEmpty(t){return!1}compare(t,n){const s=t.timestamp-n.timestamp;return s===0?t.noTimePart===n.noTimePart?0:t.noTimePart?-1:1:s}}const tK=new eK;class nK extends Zx{fromSegments(t){if(t===void 0)return;const n=t.filter(s=>s.type===m.TextType.URL&&s.fileStorageType==="internal");if(n.length!==0)return n}toSegments(t){return t}compareElement(t,n){return ol(t.text,n.text)}}const sK=new nK;class $6 extends tu{constructor(n){super();q(this,"optionValueToIndex");this.options=n,this.optionValueToIndex=new Map(n.map(({value:s},a)=>[s,a]))}fromSegments(n){const a=de(n).split(/\s*,\s*/g);for(const o of a){const i=this.optionValueToIndex.get(o);if(i!==void 0)return i}}toSegments(n){const s=this.options[n];if(s!==void 0)return mt(s.value)}isNonNullEmpty(n){return n<0||n>=this.options.length}compare(n,s){return n-s}}class rK extends Zx{constructor(n){super();q(this,"optionValueToIndex");this.options=n,this.optionValueToIndex=new Map(this.options.map(({value:s},a)=>[s,a]))}get elementType(){return new $6(this.options)}fromSegments(n){const a=de(n).split(/\s*,\s*/g),o=[];for(const i of a){const l=this.optionValueToIndex.get(i);l!==void 0&&o.push(l)}if(o.length!==0)return o}toSegments(n){return mt(n.map(s=>this.options[s].value).join(", "))}compareElement(n,s){return this.elementType.compare(n,s)}}class aK extends tu{constructor(t){super(),this.format=t}fromSegments(t){return oK(de(t))}toSegments(t){if(!this.isNonNullEmpty(t))return mt(`${t}`)}isNonNullEmpty(t){return isNaN(t)}compare(t,n){return t-n}}function oK(e){var n,s;if(e==="")return;let t=parseFloat(e);if(Number.isNaN(t)&&(t=parseFloat((s=(n=e.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:n[0])!=null?s:"")),!isNaN(t))return t}class iK extends Zx{constructor(t,n){super(),this.relCollId=t,this.resolver=n}fromSegments(t){if(t===void 0)return;const n=[];for(const s of t)s.type===m.TextType.LINK_PAGE&&s.uuid!==void 0&&n.push(s.uuid);if(n.length!==0)return n}toSegments(t){return t.map(n=>({type:m.TextType.LINK_PAGE,enhancer:{},text:"@",uuid:n}))}isNonNullEmpty(t){return t.every(n=>{var s;return de((s=this.resolver.findRecord(this.relCollId,n))==null?void 0:s.data.segments)===""})}compare(t,n){return super.compare(t.map(s=>{var a;return de((a=this.resolver.findRecord(this.relCollId,s))==null?void 0:a.data.segments)}).filter(s=>s!==""),n.map(s=>{var a;return de((a=this.resolver.findRecord(this.relCollId,s))==null?void 0:a.data.segments)}).filter(s=>s!==""))}compareElement(t,n){return ol(t,n)}}class lK extends tu{fromSegments(t){if(t!==void 0&&t.length!==0&&!t.every(n=>n.type===m.TextType.TEXT&&n.text===""))return t}toSegments(t){return t}isNonNullEmpty(t){return de(t)===""}compare(t,n){return ol(de(t),de(n))}}const cK=new lK;class uK extends tu{fromSegments(t){}toSegments(t){}isNonNullEmpty(t){return!0}compare(t,n){return 0}}const Wy=new uK;class G6 extends tu{constructor(t){super(),this.resolver=t}fromSegments(t){var n;return(n=t==null?void 0:t.find(s=>s.type===m.TextType.USER))==null?void 0:n.uuid}toSegments(t){return[{type:m.TextType.USER,text:"@",enhancer:{},uuid:t}]}isNonNullEmpty(t){return this.resolver.findUser(t)===void 0}compare(t,n){const s=ss(t),a=ss(n);return ol(s,a)}}class dK extends Zx{constructor(t){super(),this.resolver=t}get elementType(){return new G6(this.resolver)}fromSegments(t){if(t===void 0)return;const n=[];for(const s of t)s.type===m.TextType.USER&&s.uuid!==void 0&&n.push(s.uuid);if(n.length!==0)return n}toSegments(t){return t.map(n=>({type:m.TextType.USER,enhancer:{},text:"@",uuid:n}))}compareElement(t,n){return this.elementType.compare(t,n)}}function fK(e,t,n){var a,o;const s=n.findSchema(e,t);if(s===void 0)return Wy;switch(s.type){case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.PHONE:return cK;case m.CollectionSchemaType.NUMBER:return new aK(s.numberFormat);case m.CollectionSchemaType.SELECT:return new $6((a=s.options)!=null?a:[]);case m.CollectionSchemaType.MULTI_SELECT:return new rK((o=s.options)!=null?o:[]);case m.CollectionSchemaType.CHECKBOX:return QW;case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:return tK;case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.CREATED_BY:return new G6(n);case m.CollectionSchemaType.PERSON:return new dK(n);case m.CollectionSchemaType.FILE:return sK;case m.CollectionSchemaType.RELATION:return new iK(s.collectionId,n);case m.CollectionSchemaType.FORMULA:case m.CollectionSchemaType.ROLLUP:return Wy;default:return Wy}}function dv(e,t,n,s,a){var l;const o=a.findSchema(e,n);if(o==null)return;const i=a.findRecord(e,t);if(i!==void 0)switch(o.type){case m.CollectionSchemaType.TITLE:return s.fromSegments(i.data.segments);case m.CollectionSchemaType.CREATED_AT:return{timestamp:i.createdAt,noTimePart:!1};case m.CollectionSchemaType.UPDATED_AT:return{timestamp:i.updatedAt,noTimePart:!1};case m.CollectionSchemaType.CREATED_BY:return i.createdBy;case m.CollectionSchemaType.UPDATED_BY:return i.updatedBy;case m.CollectionSchemaType.FORMULA:case m.CollectionSchemaType.ROLLUP:return;default:return s.fromSegments((l=i.data.collectionProperties)==null?void 0:l[n])}}function mK(e,t,n){var a,o;const s=n.findSchema(e,t);if((s==null?void 0:s.type)===m.CollectionSchemaType.FORMULA)return Object.keys((o=(a=s.formula)==null?void 0:a.refProps)!=null?o:{}).filter(i=>n.findSchema(e,i)!=null).map(i=>[e,i]);if((s==null?void 0:s.type)===m.CollectionSchemaType.ROLLUP){const i=[];if(s.relationProperty!=null){i.push([e,s.relationProperty]);const l=n.findSchema(e,s.relationProperty);if((l==null?void 0:l.collectionId)!=null){const c=l.collectionId;if(s.targetProperty!=null){const u=n.findSchema(c,s.targetProperty);(u==null?void 0:u.type)===s.targetPropertyType&&i.push([c,s.targetProperty])}}}return i}return[]}function z6(e,t,n,s,a){const o=new Set,i=(l,c)=>{if(o.has(`${l}/${c}`))return!1;if(l===e&&c===t)return!0;o.add(`${l}/${c}`);for(const u of mK(l,c,a))if(i(u[0],u[1]))return!0;return!1};return i(n,s)}const Gm=Symbol("Block Scope"),zm=ia(void 0),W6=Symbol("Row Scope"),K6=ia(void 0),A2="comment/discussion-",Y6=[qr.rgb("#FFC408").alpha(.1).toString(),qr.rgb("#FFC408").alpha(.2).toString(),qr.rgb("#FFC408").alpha(.3).toString(),qr.rgb("#FFC408").alpha(.4).toString(),qr.rgb("#FFC408").alpha(.5).toString()],X6="#FFC408";gn({backgroundColor:Y6[0],textDecoration:"underline",textUnderlineOffset:"0.15em",textDecorationColor:X6});const el=e=>{if(e.customs==null)return[];const t=Object.keys(e.customs),n=[];for(const s of t)s.startsWith(A2)&&e.customs[s]===!0&&n.push(s.slice(A2.length));return n},Ik=(e,t,n=le())=>{var o;const s=[];if(e==null)return s;const a=n.blocks[e];if(t.noTable&&(a==null?void 0:a.type)===m.BlockType.TABLE)return s;for(const i of(o=a==null?void 0:a.discussions)!=null?o:[]){const l=n.discussions[i];l&&l.status===m.BlockStatus.NORMAL&&(t.noResolved?!(l!=null&&l.resolved):de(l.context)==="")&&s.push(l.uuid)}return s},hK=e=>{const t=Ar(zm,Gm);return ae(n=>{var s,a;return t==null?[]:Ik(t,{noTable:(s=e==null?void 0:e.noTable)!=null?s:!1,noResolved:(a=e==null?void 0:e.noResolved)!=null?a:!1},n)},{equalityFn:Cn})},Q6=()=>{const e=Ar(zm,Gm);return ae(t=>e==null?!1:Ik(e,{noTable:!1,noResolved:!0},t).length>0)},J6=e=>({[`${A2}${e}`]:!0}),eF=e=>{const n=[...hK({noTable:!0}),...el(e)],s=ae(a=>{const o=n.map(i=>a.discussions[i]).filter(i=>i!=null&&i.status===m.BlockStatus.NORMAL&&!i.resolved);return o.length>=5?5:o.length});return s>=1?{backgroundColor:Y6[s-1],textDecoration:"underline",textUnderlineOffset:"0.15em",textDecorationColor:X6}:{}},pK={elementMeta:{tag:"comment"},initialize:e=>{e.overrideTextComponent(t=>({format:s,className:a,...o})=>{const i=eF(s);return r.jsx(t,{className:B(a,gn(i)),...o,format:s})})}},jr="code",_o="link",zo="select-inline",bc="inline-date",Wd="inline-person",oi="inline-link-page",kg="inline-mention-block",vi="inline-equation",Ed="emoji",Z6="inline-link-suggest",eR={tag:_o,hasBoundary:!1,hasContent:!0},jk={tag:jr,hasBoundary:!0,hasContent:!0,allowContentElementTags:new Set([_o,zo,oi,bc,Wd,vi,Ed])},gK=new RegExp("\\u{1F3F4}\\u{E0067}\\u{E0062}(?:\\u{E0077}\\u{E006C}\\u{E0073}|\\u{E0073}\\u{E0063}\\u{E0074}|\\u{E0065}\\u{E006E}\\u{E0067})\\u{E007F}|(?:\\u{1F9D1}\\u{1F3FF}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FF}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FB}-\\u{1F3FE}]|(?:\\u{1F9D1}\\u{1F3FE}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FE}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FB}-\\u{1F3FD}\\u{1F3FF}]|(?:\\u{1F9D1}\\u{1F3FD}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FD}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FB}\\u{1F3FC}\\u{1F3FE}\\u{1F3FF}]|(?:\\u{1F9D1}\\u{1F3FC}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FC}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FB}\\u{1F3FD}-\\u{1F3FF}]|(?:\\u{1F9D1}\\u{1F3FB}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F9D1}|\\u{1F469}\\u{1F3FB}\\u200D\\u{1F91D}\\u200D[\\u{1F468}\\u{1F469}])[\\u{1F3FC}-\\u{1F3FF}]|\\u{1F468}(?:\\u{1F3FB}(?:\\u200D(?:\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D\\u{1F468}[\\u{1F3FB}-\\u{1F3FF}]|\\u{1F468}[\\u{1F3FB}-\\u{1F3FF}])|\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FC}-\\u{1F3FF}]|[\\u2695\\u2696\\u2708]\\uFE0F|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]))?|[\\u{1F3FC}-\\u{1F3FF}]\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D\\u{1F468}[\\u{1F3FB}-\\u{1F3FF}]|\\u{1F468}[\\u{1F3FB}-\\u{1F3FF}])|\\u200D(?:\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D)?\\u{1F468}|[\\u{1F468}\\u{1F469}]\\u200D(?:\\u{1F466}\\u200D\\u{1F466}|\\u{1F467}\\u200D[\\u{1F466}\\u{1F467}])|\\u{1F466}\\u200D\\u{1F466}|\\u{1F467}\\u200D[\\u{1F466}\\u{1F467}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FF}\\u200D(?:\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FB}-\\u{1F3FE}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FE}\\u200D(?:\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FB}-\\u{1F3FD}\\u{1F3FF}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FD}\\u200D(?:\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FB}\\u{1F3FC}\\u{1F3FE}\\u{1F3FF}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FC}\\u200D(?:\\u{1F91D}\\u200D\\u{1F468}[\\u{1F3FB}\\u{1F3FD}-\\u{1F3FF}]|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|(?:\\u{1F3FF}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FE}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FD}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FC}\\u200D[\\u2695\\u2696\\u2708]|\\u200D[\\u2695\\u2696\\u2708])\\uFE0F|\\u200D(?:[\\u{1F468}\\u{1F469}]\\u200D[\\u{1F466}\\u{1F467}]|[\\u{1F466}\\u{1F467}])|\\u{1F3FF}|\\u{1F3FE}|\\u{1F3FD}|\\u{1F3FC})?|(?:\\u{1F469}(?:\\u{1F3FB}\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D[\\u{1F468}\\u{1F469}]|[\\u{1F468}\\u{1F469}])|[\\u{1F3FC}-\\u{1F3FF}]\\u200D\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D[\\u{1F468}\\u{1F469}]|[\\u{1F468}\\u{1F469}]))|\\u{1F9D1}[\\u{1F3FB}-\\u{1F3FF}]\\u200D\\u{1F91D}\\u200D\\u{1F9D1})[\\u{1F3FB}-\\u{1F3FF}]|\\u{1F469}\\u200D\\u{1F469}\\u200D(?:\\u{1F466}\\u200D\\u{1F466}|\\u{1F467}\\u200D[\\u{1F466}\\u{1F467}])|\\u{1F469}(?:\\u200D(?:\\u2764\\uFE0F\\u200D(?:\\u{1F48B}\\u200D[\\u{1F468}\\u{1F469}]|[\\u{1F468}\\u{1F469}])|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FF}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FE}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FD}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FC}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FB}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F9D1}(?:\\u200D(?:\\u{1F91D}\\u200D\\u{1F9D1}|[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F3FF}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FE}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FD}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FC}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}]|\\u{1F3FB}\\u200D[\\u{1F33E}\\u{1F373}\\u{1F37C}\\u{1F384}\\u{1F393}\\u{1F3A4}\\u{1F3A8}\\u{1F3EB}\\u{1F3ED}\\u{1F4BB}\\u{1F4BC}\\u{1F527}\\u{1F52C}\\u{1F680}\\u{1F692}\\u{1F9AF}-\\u{1F9B3}\\u{1F9BC}\\u{1F9BD}])|\\u{1F469}\\u200D\\u{1F466}\\u200D\\u{1F466}|\\u{1F469}\\u200D\\u{1F469}\\u200D[\\u{1F466}\\u{1F467}]|\\u{1F469}\\u200D\\u{1F467}\\u200D[\\u{1F466}\\u{1F467}]|(?:\\u{1F441}\\uFE0F\\u200D\\u{1F5E8}|\\u{1F9D1}(?:\\u{1F3FF}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FE}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FD}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FC}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FB}\\u200D[\\u2695\\u2696\\u2708]|\\u200D[\\u2695\\u2696\\u2708])|\\u{1F469}(?:\\u{1F3FF}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FE}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FD}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FC}\\u200D[\\u2695\\u2696\\u2708]|\\u{1F3FB}\\u200D[\\u2695\\u2696\\u2708]|\\u200D[\\u2695\\u2696\\u2708])|\\u{1F636}\\u200D\\u{1F32B}|\\u{1F3F3}\\uFE0F\\u200D\\u26A7|\\u{1F43B}\\u200D\\u2744|(?:[\\u{1F3C3}\\u{1F3C4}\\u{1F3CA}\\u{1F46E}\\u{1F470}\\u{1F471}\\u{1F473}\\u{1F477}\\u{1F481}\\u{1F482}\\u{1F486}\\u{1F487}\\u{1F645}-\\u{1F647}\\u{1F64B}\\u{1F64D}\\u{1F64E}\\u{1F6A3}\\u{1F6B4}-\\u{1F6B6}\\u{1F926}\\u{1F935}\\u{1F937}-\\u{1F939}\\u{1F93D}\\u{1F93E}\\u{1F9B8}\\u{1F9B9}\\u{1F9CD}-\\u{1F9CF}\\u{1F9D4}\\u{1F9D6}-\\u{1F9DD}][\\u{1F3FB}-\\u{1F3FF}]|[\\u{1F46F}\\u{1F93C}\\u{1F9DE}\\u{1F9DF}])\\u200D[\\u2640\\u2642]|[\\u26F9\\u{1F3CB}\\u{1F3CC}\\u{1F575}][\\uFE0F\\u{1F3FB}-\\u{1F3FF}]\\u200D[\\u2640\\u2642]|\\u{1F3F4}\\u200D\\u2620|[\\u{1F3C3}\\u{1F3C4}\\u{1F3CA}\\u{1F46E}\\u{1F470}\\u{1F471}\\u{1F473}\\u{1F477}\\u{1F481}\\u{1F482}\\u{1F486}\\u{1F487}\\u{1F645}-\\u{1F647}\\u{1F64B}\\u{1F64D}\\u{1F64E}\\u{1F6A3}\\u{1F6B4}-\\u{1F6B6}\\u{1F926}\\u{1F935}\\u{1F937}-\\u{1F939}\\u{1F93D}\\u{1F93E}\\u{1F9B8}\\u{1F9B9}\\u{1F9CD}-\\u{1F9CF}\\u{1F9D4}\\u{1F9D6}-\\u{1F9DD}]\\u200D[\\u2640\\u2642]|[\\xA9\\xAE\\u203C\\u2049\\u2122\\u2139\\u2194-\\u2199\\u21A9\\u21AA\\u2328\\u23CF\\u23ED-\\u23EF\\u23F1\\u23F2\\u23F8-\\u23FA\\u24C2\\u25AA\\u25AB\\u25B6\\u25C0\\u25FB\\u25FC\\u2600-\\u2604\\u260E\\u2611\\u2618\\u2620\\u2622\\u2623\\u2626\\u262A\\u262E\\u262F\\u2638-\\u263A\\u2640\\u2642\\u265F\\u2660\\u2663\\u2665\\u2666\\u2668\\u267B\\u267E\\u2692\\u2694-\\u2697\\u2699\\u269B\\u269C\\u26A0\\u26A7\\u26B0\\u26B1\\u26C8\\u26CF\\u26D1\\u26D3\\u26E9\\u26F0\\u26F1\\u26F4\\u26F7\\u26F8\\u2702\\u2708\\u2709\\u270F\\u2712\\u2714\\u2716\\u271D\\u2721\\u2733\\u2734\\u2744\\u2747\\u2763\\u27A1\\u2934\\u2935\\u2B05-\\u2B07\\u3030\\u303D\\u3297\\u3299\\u{1F170}\\u{1F171}\\u{1F17E}\\u{1F17F}\\u{1F202}\\u{1F237}\\u{1F321}\\u{1F324}-\\u{1F32C}\\u{1F336}\\u{1F37D}\\u{1F396}\\u{1F397}\\u{1F399}-\\u{1F39B}\\u{1F39E}\\u{1F39F}\\u{1F3CD}\\u{1F3CE}\\u{1F3D4}-\\u{1F3DF}\\u{1F3F5}\\u{1F3F7}\\u{1F43F}\\u{1F4FD}\\u{1F549}\\u{1F54A}\\u{1F56F}\\u{1F570}\\u{1F573}\\u{1F576}-\\u{1F579}\\u{1F587}\\u{1F58A}-\\u{1F58D}\\u{1F5A5}\\u{1F5A8}\\u{1F5B1}\\u{1F5B2}\\u{1F5BC}\\u{1F5C2}-\\u{1F5C4}\\u{1F5D1}-\\u{1F5D3}\\u{1F5DC}-\\u{1F5DE}\\u{1F5E1}\\u{1F5E3}\\u{1F5E8}\\u{1F5EF}\\u{1F5F3}\\u{1F5FA}\\u{1F6CB}\\u{1F6CD}-\\u{1F6CF}\\u{1F6E0}-\\u{1F6E5}\\u{1F6E9}\\u{1F6F0}\\u{1F6F3}])\\uFE0F|\\u{1F3F3}\\uFE0F\\u200D\\u{1F308}|\\u{1F469}\\u200D\\u{1F467}|\\u{1F469}\\u200D\\u{1F466}|\\u{1F635}\\u200D\\u{1F4AB}|\\u{1F62E}\\u200D\\u{1F4A8}|\\u{1F415}\\u200D\\u{1F9BA}|\\u{1F9D1}(?:\\u{1F3FF}|\\u{1F3FE}|\\u{1F3FD}|\\u{1F3FC}|\\u{1F3FB})?|\\u{1F469}(?:\\u{1F3FF}|\\u{1F3FE}|\\u{1F3FD}|\\u{1F3FC}|\\u{1F3FB})?|\\u{1F1FD}\\u{1F1F0}|\\u{1F1F6}\\u{1F1E6}|\\u{1F1F4}\\u{1F1F2}|\\u{1F408}\\u200D\\u2B1B|\\u2764\\uFE0F\\u200D[\\u{1F525}\\u{1FA79}]|\\u{1F441}\\uFE0F|\\u{1F3F3}\\uFE0F|\\u{1F1FF}[\\u{1F1E6}\\u{1F1F2}\\u{1F1FC}]|\\u{1F1FE}[\\u{1F1EA}\\u{1F1F9}]|\\u{1F1FC}[\\u{1F1EB}\\u{1F1F8}]|\\u{1F1FB}[\\u{1F1E6}\\u{1F1E8}\\u{1F1EA}\\u{1F1EC}\\u{1F1EE}\\u{1F1F3}\\u{1F1FA}]|\\u{1F1FA}[\\u{1F1E6}\\u{1F1EC}\\u{1F1F2}\\u{1F1F3}\\u{1F1F8}\\u{1F1FE}\\u{1F1FF}]|\\u{1F1F9}[\\u{1F1E6}\\u{1F1E8}\\u{1F1E9}\\u{1F1EB}-\\u{1F1ED}\\u{1F1EF}-\\u{1F1F4}\\u{1F1F7}\\u{1F1F9}\\u{1F1FB}\\u{1F1FC}\\u{1F1FF}]|\\u{1F1F8}[\\u{1F1E6}-\\u{1F1EA}\\u{1F1EC}-\\u{1F1F4}\\u{1F1F7}-\\u{1F1F9}\\u{1F1FB}\\u{1F1FD}-\\u{1F1FF}]|\\u{1F1F7}[\\u{1F1EA}\\u{1F1F4}\\u{1F1F8}\\u{1F1FA}\\u{1F1FC}]|\\u{1F1F5}[\\u{1F1E6}\\u{1F1EA}-\\u{1F1ED}\\u{1F1F0}-\\u{1F1F3}\\u{1F1F7}-\\u{1F1F9}\\u{1F1FC}\\u{1F1FE}]|\\u{1F1F3}[\\u{1F1E6}\\u{1F1E8}\\u{1F1EA}-\\u{1F1EC}\\u{1F1EE}\\u{1F1F1}\\u{1F1F4}\\u{1F1F5}\\u{1F1F7}\\u{1F1FA}\\u{1F1FF}]|\\u{1F1F2}[\\u{1F1E6}\\u{1F1E8}-\\u{1F1ED}\\u{1F1F0}-\\u{1F1FF}]|\\u{1F1F1}[\\u{1F1E6}-\\u{1F1E8}\\u{1F1EE}\\u{1F1F0}\\u{1F1F7}-\\u{1F1FB}\\u{1F1FE}]|\\u{1F1F0}[\\u{1F1EA}\\u{1F1EC}-\\u{1F1EE}\\u{1F1F2}\\u{1F1F3}\\u{1F1F5}\\u{1F1F7}\\u{1F1FC}\\u{1F1FE}\\u{1F1FF}]|\\u{1F1EF}[\\u{1F1EA}\\u{1F1F2}\\u{1F1F4}\\u{1F1F5}]|\\u{1F1EE}[\\u{1F1E8}-\\u{1F1EA}\\u{1F1F1}-\\u{1F1F4}\\u{1F1F6}-\\u{1F1F9}]|\\u{1F1ED}[\\u{1F1F0}\\u{1F1F2}\\u{1F1F3}\\u{1F1F7}\\u{1F1F9}\\u{1F1FA}]|\\u{1F1EC}[\\u{1F1E6}\\u{1F1E7}\\u{1F1E9}-\\u{1F1EE}\\u{1F1F1}-\\u{1F1F3}\\u{1F1F5}-\\u{1F1FA}\\u{1F1FC}\\u{1F1FE}]|\\u{1F1EB}[\\u{1F1EE}-\\u{1F1F0}\\u{1F1F2}\\u{1F1F4}\\u{1F1F7}]|\\u{1F1EA}[\\u{1F1E6}\\u{1F1E8}\\u{1F1EA}\\u{1F1EC}\\u{1F1ED}\\u{1F1F7}-\\u{1F1FA}]|\\u{1F1E9}[\\u{1F1EA}\\u{1F1EC}\\u{1F1EF}\\u{1F1F0}\\u{1F1F2}\\u{1F1F4}\\u{1F1FF}]|\\u{1F1E8}[\\u{1F1E6}\\u{1F1E8}\\u{1F1E9}\\u{1F1EB}-\\u{1F1EE}\\u{1F1F0}-\\u{1F1F5}\\u{1F1F7}\\u{1F1FA}-\\u{1F1FF}]|\\u{1F1E7}[\\u{1F1E6}\\u{1F1E7}\\u{1F1E9}-\\u{1F1EF}\\u{1F1F1}-\\u{1F1F4}\\u{1F1F6}-\\u{1F1F9}\\u{1F1FB}\\u{1F1FC}\\u{1F1FE}\\u{1F1FF}]|\\u{1F1E6}[\\u{1F1E8}-\\u{1F1EC}\\u{1F1EE}\\u{1F1F1}\\u{1F1F2}\\u{1F1F4}\\u{1F1F6}-\\u{1F1FA}\\u{1F1FC}\\u{1F1FD}\\u{1F1FF}]|[#\\*0-9]\\uFE0F\\u20E3|\\u2764\\uFE0F|[\\u{1F3C3}\\u{1F3C4}\\u{1F3CA}\\u{1F46E}\\u{1F470}\\u{1F471}\\u{1F473}\\u{1F477}\\u{1F481}\\u{1F482}\\u{1F486}\\u{1F487}\\u{1F645}-\\u{1F647}\\u{1F64B}\\u{1F64D}\\u{1F64E}\\u{1F6A3}\\u{1F6B4}-\\u{1F6B6}\\u{1F926}\\u{1F935}\\u{1F937}-\\u{1F939}\\u{1F93D}\\u{1F93E}\\u{1F9B8}\\u{1F9B9}\\u{1F9CD}-\\u{1F9CF}\\u{1F9D4}\\u{1F9D6}-\\u{1F9DD}][\\u{1F3FB}-\\u{1F3FF}]|[\\u26F9\\u{1F3CB}\\u{1F3CC}\\u{1F575}][\\uFE0F\\u{1F3FB}-\\u{1F3FF}]|\\u{1F3F4}|[\\u270A\\u270B\\u{1F385}\\u{1F3C2}\\u{1F3C7}\\u{1F442}\\u{1F443}\\u{1F446}-\\u{1F450}\\u{1F466}\\u{1F467}\\u{1F46B}-\\u{1F46D}\\u{1F472}\\u{1F474}-\\u{1F476}\\u{1F478}\\u{1F47C}\\u{1F483}\\u{1F485}\\u{1F48F}\\u{1F491}\\u{1F4AA}\\u{1F57A}\\u{1F595}\\u{1F596}\\u{1F64C}\\u{1F64F}\\u{1F6C0}\\u{1F6CC}\\u{1F90C}\\u{1F90F}\\u{1F918}-\\u{1F91C}\\u{1F91E}\\u{1F91F}\\u{1F930}-\\u{1F934}\\u{1F936}\\u{1F977}\\u{1F9B5}\\u{1F9B6}\\u{1F9BB}\\u{1F9D2}\\u{1F9D3}\\u{1F9D5}][\\u{1F3FB}-\\u{1F3FF}]|[\\u261D\\u270C\\u270D\\u{1F574}\\u{1F590}][\\uFE0F\\u{1F3FB}-\\u{1F3FF}]|[\\u270A\\u270B\\u{1F385}\\u{1F3C2}\\u{1F3C7}\\u{1F408}\\u{1F415}\\u{1F43B}\\u{1F442}\\u{1F443}\\u{1F446}-\\u{1F450}\\u{1F466}\\u{1F467}\\u{1F46B}-\\u{1F46D}\\u{1F472}\\u{1F474}-\\u{1F476}\\u{1F478}\\u{1F47C}\\u{1F483}\\u{1F485}\\u{1F48F}\\u{1F491}\\u{1F4AA}\\u{1F57A}\\u{1F595}\\u{1F596}\\u{1F62E}\\u{1F635}\\u{1F636}\\u{1F64C}\\u{1F64F}\\u{1F6C0}\\u{1F6CC}\\u{1F90C}\\u{1F90F}\\u{1F918}-\\u{1F91C}\\u{1F91E}\\u{1F91F}\\u{1F930}-\\u{1F934}\\u{1F936}\\u{1F977}\\u{1F9B5}\\u{1F9B6}\\u{1F9BB}\\u{1F9D2}\\u{1F9D3}\\u{1F9D5}]|[\\u{1F3C3}\\u{1F3C4}\\u{1F3CA}\\u{1F46E}\\u{1F470}\\u{1F471}\\u{1F473}\\u{1F477}\\u{1F481}\\u{1F482}\\u{1F486}\\u{1F487}\\u{1F645}-\\u{1F647}\\u{1F64B}\\u{1F64D}\\u{1F64E}\\u{1F6A3}\\u{1F6B4}-\\u{1F6B6}\\u{1F926}\\u{1F935}\\u{1F937}-\\u{1F939}\\u{1F93D}\\u{1F93E}\\u{1F9B8}\\u{1F9B9}\\u{1F9CD}-\\u{1F9CF}\\u{1F9D4}\\u{1F9D6}-\\u{1F9DD}]|[\\u{1F46F}\\u{1F93C}\\u{1F9DE}\\u{1F9DF}]|[\\u231A\\u231B\\u23E9-\\u23EC\\u23F0\\u23F3\\u25FD\\u25FE\\u2614\\u2615\\u2648-\\u2653\\u267F\\u2693\\u26A1\\u26AA\\u26AB\\u26BD\\u26BE\\u26C4\\u26C5\\u26CE\\u26D4\\u26EA\\u26F2\\u26F3\\u26F5\\u26FA\\u26FD\\u2705\\u2728\\u274C\\u274E\\u2753-\\u2755\\u2757\\u2795-\\u2797\\u27B0\\u27BF\\u2B1B\\u2B1C\\u2B50\\u2B55\\u{1F004}\\u{1F0CF}\\u{1F18E}\\u{1F191}-\\u{1F19A}\\u{1F201}\\u{1F21A}\\u{1F22F}\\u{1F232}-\\u{1F236}\\u{1F238}-\\u{1F23A}\\u{1F250}\\u{1F251}\\u{1F300}-\\u{1F320}\\u{1F32D}-\\u{1F335}\\u{1F337}-\\u{1F37C}\\u{1F37E}-\\u{1F384}\\u{1F386}-\\u{1F393}\\u{1F3A0}-\\u{1F3C1}\\u{1F3C5}\\u{1F3C6}\\u{1F3C8}\\u{1F3C9}\\u{1F3CF}-\\u{1F3D3}\\u{1F3E0}-\\u{1F3F0}\\u{1F3F8}-\\u{1F407}\\u{1F409}-\\u{1F414}\\u{1F416}-\\u{1F43A}\\u{1F43C}-\\u{1F43E}\\u{1F440}\\u{1F444}\\u{1F445}\\u{1F451}-\\u{1F465}\\u{1F46A}\\u{1F479}-\\u{1F47B}\\u{1F47D}-\\u{1F480}\\u{1F484}\\u{1F488}-\\u{1F48E}\\u{1F490}\\u{1F492}-\\u{1F4A9}\\u{1F4AB}-\\u{1F4FC}\\u{1F4FF}-\\u{1F53D}\\u{1F54B}-\\u{1F54E}\\u{1F550}-\\u{1F567}\\u{1F5A4}\\u{1F5FB}-\\u{1F62D}\\u{1F62F}-\\u{1F634}\\u{1F637}-\\u{1F644}\\u{1F648}-\\u{1F64A}\\u{1F680}-\\u{1F6A2}\\u{1F6A4}-\\u{1F6B3}\\u{1F6B7}-\\u{1F6BF}\\u{1F6C1}-\\u{1F6C5}\\u{1F6D0}-\\u{1F6D2}\\u{1F6D5}-\\u{1F6D7}\\u{1F6EB}\\u{1F6EC}\\u{1F6F4}-\\u{1F6FC}\\u{1F7E0}-\\u{1F7EB}\\u{1F90D}\\u{1F90E}\\u{1F910}-\\u{1F917}\\u{1F91D}\\u{1F920}-\\u{1F925}\\u{1F927}-\\u{1F92F}\\u{1F93A}\\u{1F93F}-\\u{1F945}\\u{1F947}-\\u{1F976}\\u{1F978}\\u{1F97A}-\\u{1F9B4}\\u{1F9B7}\\u{1F9BA}\\u{1F9BC}-\\u{1F9CB}\\u{1F9D0}\\u{1F9E0}-\\u{1F9FF}\\u{1FA70}-\\u{1FA74}\\u{1FA78}-\\u{1FA7A}\\u{1FA80}-\\u{1FA86}\\u{1FA90}-\\u{1FAA8}\\u{1FAB0}-\\u{1FAB6}\\u{1FAC0}-\\u{1FAC2}\\u{1FAD0}-\\u{1FAD6}]","u"),tR=new RegExp(gK.source,"ug"),_K=(e,t)=>e.type!==m.TextType.TEXT||t.type!==m.TextType.TEXT||!hc(e.discussions)||!hc(t.discussions)?!1:Cn(e.enhancer,t.enhancer),Dk=e=>{const t=[];let n=!1,s;return e.forEach(a=>{var o,i;if(a.type!==m.TextType.TEXT)t.push({...a});else{let l,c,u=0;const d=(o=a.text)!=null?o:"";for(;(l=tR.exec(d))!=null;){const f=l[0];f&&(c=d.slice(u,l.index),u=l.index+f.length,c&&t.push({...a,text:c}),t.push({...a,type:m.TextType.EMOJI,text:f}),n=!0)}if(u===0&&s&&_K(s,a)){const f=t.pop();t.push({...a,text:((i=f==null?void 0:f.text)!=null?i:"")+a.text})}else{const f=d.slice(u,d.length);f&&t.push({...a,text:f})}}s=a}),{wrapSegments:t,hasNewEmoji:n}},xK=e=>{const t=[];let n;for(const s of e){const a={...s,enhancer:{...s.enhancer}};let o=!1;a.type===m.TextType.EMOJI&&(a.type=m.TextType.TEXT,(n==null?void 0:n.type)===m.TextType.TEXT&&Cn(n.enhancer,a.enhancer)&&(n.text+=a.text,o=!0)),o||(n=a,t.push(n))}return t},nxe=e=>{if(e!==void 0&&(e=e.filter(t=>!(t.type===m.TextType.TEXT&&t.text==="")),e.length!==0))return e},Ec=e=>{let t;if(e.type===m.TextType.DATETIME){const n=he(`${e.startDate} ${e.startTime}`,us).startOf("minute");t=n.isValid()?n.toDate():he().toDate()}else if(e.type===m.TextType.DATE){const n=he(`${e.startDate}`,Ct).startOf("day");t=n.isValid()?n.toDate():he().toDate()}else t=he().toDate();return t},FK=e=>{const t=(e!=null?e:[]).find(n=>n.type===m.TextType.DATE||n.type===m.TextType.DATETIME);return t&&Ec(t).getTime()},B2=e=>{var s,a;const t=de(e);let n=parseFloat(t);return Number.isNaN(n)&&(n=parseFloat((a=(s=t.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:s[0])!=null?a:"")),isNaN(n)?void 0:n},Fn=(e,t={})=>{let n;return he(e.from).isValid()&&(n=he(e.from).format(Ct)),{type:e.includeTime?m.TextType.DATETIME:m.TextType.DATE,enhancer:t,text:"‣",startDate:n,startTime:he(e.from).format(s2),dateFormat:e.dateFormat,timeFormat:e.timeFormat,reminder:e.reminder}},yK=e=>{const t=(e!=null?e:[]).filter(n=>n.type===m.TextType.USER&&n.uuid!=null).map(n=>n.uuid);if(t.length!==0)return t},wc=(e,t={})=>({type:m.TextType.USER,enhancer:t,text:"",uuid:e}),bK=(e,t={})=>({type:m.TextType.EQUATION,enhancer:t,text:e!=null?e:""}),qo=e=>{const{enhancer:t,discussions:n}=e,s={};for(const a of n!=null?n:[]){const o=J6(a);Object.assign(s,o)}return{bold:t==null?void 0:t.bold,backgroundColor:t==null?void 0:t.backgroundColor,italic:t==null?void 0:t.italic,lineThrough:t==null?void 0:t.lineThrough,color:(t==null?void 0:t.textColor)||"",underline:t==null?void 0:t.underline,customs:s}},Go=e=>e===!0?!0:void 0,bu=e=>e.length===0?void 0:e,Eu=e=>{var t;return{bold:Go(e.bold),italic:Go(e.italic),underline:Go(e.underline),lineThrough:Go(e.lineThrough),textColor:e.color||void 0,backgroundColor:(t=e.backgroundColor)!=null?t:void 0}},Qs=e=>nR(e,!0).unwrapSegments;function nR(e,t){const n=[],s=o=>{var l;const i=(l=n[n.length-1])!=null?l:null;i===null?n.push({type:m.TextType.TEXT,text:o,enhancer:{}}):i.text+=o},a=(o,i)=>{var c,u,d,f,h,p,g,_,x,y,b,E,w,k,C,T;const l=v=>i.find(I=>I.tag===v);for(const v of o.items)if(v.type==="element")v.tag===zo?s("@"):v.tag===bc?n.push({...Fn({from:new Date(v.props.datetime),dateFormat:v.props.dateFormat,timeFormat:v.props.timeFormat,includeTime:v.props.includeTime,reminder:v.props.reminder},{...Eu((c=v.props.textFormat)!=null?c:{}),code:Go(l(jr)!==void 0)}),discussions:bu(el((u=v.props.textFormat)!=null?u:{}))}):v.tag===oi?n.push({type:m.TextType.LINK_PAGE,enhancer:{...Eu((d=v.props.textFormat)!=null?d:{}),code:Go(l(jr)!==void 0)},text:"",uuid:v.props.pageId,discussions:bu(el((f=v.props.textFormat)!=null?f:{}))}):v.tag===kg?n.push({type:m.TextType.MENTION_BLOCK,enhancer:{...Eu((h=v.props.textFormat)!=null?h:{}),code:Go(l(jr)!==void 0)},text:(p=v.props.text)!=null?p:"",uuid:v.props.blockId,discussions:bu(el((g=v.props.textFormat)!=null?g:{}))}):v.tag===Wd?n.push({...wc(v.props.userId,{...Eu((_=v.props.textFormat)!=null?_:{}),code:Go(l(jr)!==void 0)}),discussions:bu(el((x=v.props.textFormat)!=null?x:{}))}):v.tag===vi&&v.props.text&&n.push({...bK(v.props.text,{...Eu((y=v.props.textFormat)!=null?y:{}),code:Go(l(jr)!==void 0)}),discussions:bu(el((b=v.props.textFormat)!=null?b:{}))}),v.tag===Ed?n.push({type:m.TextType.EMOJI,text:(E=v.props.text)!=null?E:"",enhancer:{...Eu((w=v.props.textFormat)!=null?w:{}),code:Go(l(jr)!==void 0)},discussions:bu(el((k=v.props.textFormat)!=null?k:{}))}):v.content!==null&&a(v.content,[...i,v]);else{const I=l(_o),j={type:I!==void 0?m.TextType.URL:m.TextType.TEXT,text:(C=v.content)!=null?C:"",enhancer:{...Eu(v.format),code:Go(l(jr)!==void 0)},discussions:bu(el(v.format)),...(T=I==null?void 0:I.props)!=null?T:{}};n.push(j)}};return a(e,[]),t?{unwrapSegments:xK(n),segments:n}:{unwrapSegments:[],segments:n}}const Ky=new WeakMap,EK=yn([]),gp=e=>{var i,l,c,u,d,f,h;if(e==null)return EK;if(Ky.has(e))return Ky.get(e);const t=[];let n=null;const s=p=>{n!==null&&n.type==="element"&&n.content!==null&&n.tag===_o&&p.type==="element"&&p.content!==null&&p.tag===_o&&Cn(p.props,n.props)?n.content=sM(n.content,p.content):(t.push(p),n=p)},{wrapSegments:a}=Dk(e);for(const p of a){let g;if(p.type===m.TextType.DATE||p.type===6){const _=Ec(p);g=zn(bc,{datetime:_.getTime(),includeTime:p.type===6,dateFormat:p.dateFormat,timeFormat:p.timeFormat,textFormat:qo(p),reminder:p.reminder})}else if(p.type===m.TextType.USER)g=zn(Wd,{userId:p.uuid,textFormat:qo(p)});else if(p.type===m.TextType.LINK_PAGE)g=zn(oi,{pageId:p.uuid,textFormat:qo(p)});else if(p.type===m.TextType.MENTION_BLOCK){const _=ls((i=p.uuid)!=null?i:"");Xt((c=K.blocks[(l=p.uuid)!=null?l:""])==null?void 0:c.type)?g=zn(oi,{pageId:p.uuid,textFormat:qo(p)}):g=zn(kg,{pageId:_,blockId:p.uuid,textFormat:qo(p),text:(u=p.text)!=null?u:""})}else if(p.type===m.TextType.EQUATION)g=zn(vi,{text:(d=p.text)!=null?d:"",textFormat:qo(p)});else if(p.type===m.TextType.EMOJI)g=zn(Ed,{text:(f=p.text)!=null?f:"",textFormat:qo(p)});else if(p.type==="suggest")g=zn(Z6,{pageId:p.uuid,textFormat:qo(p)});else{const _=qo(p);try{g=eo(p.text,_)}catch(x){g=eo("�",_)}p.type===m.TextType.URL&&(g=zn(_o,{url:p.url,fileStorageType:p.fileStorageType,width:p.width,height:p.height,textFormat:qo(p)},yn([g])))}(h=p==null?void 0:p.enhancer)!=null&&h.code&&(g=zn(jr,{},yn([g]))),s(g)}const o=yn(t);return Ky.set(e,o),o},wK=function*(e){if(e!==void 0)for(const t of e)t.discussions!==void 0&&(yield*t.discussions)},kK=function(e,t){return e==null?e:Mh(e,n=>{for(const s of n)if(s.discussions!=null){const a=s.discussions.indexOf(t);a>=0&&s.discussions.splice(a)}})},fv=function(e){return e==null?e:Mh(e,t=>{for(const n of t)n.discussions!=null&&(n.discussions=void 0)})};let sR;const CK=e=>{sR=e},TK=(...e)=>sR(...e);class vK extends He.EvalContext{constructor(t=le){super(),this.getState=t}readProp(t,n){var f,h,p,g,_,x;const s=this.getState(),{blocks:a,users:o}=s,i=a[t];if(i==null)return null;const l=i.parentId,c=a[l];if(c==null)return null;const u=(f=c.data.schema)==null?void 0:f[n];if(u==null)return null;if(u.type===m.CollectionSchemaType.FORMULA)return Ln(l).getBoxedValue(t,n);if(u.type===m.CollectionSchemaType.ROLLUP){const{dateStartTimestamp:y,dateEndTimestamp:b,aggregationValue:E,originValues:w,originValueToStringFunc:k}=(h=TK(t,n))!=null?h:{};if(so(u.aggregation))return He.ValueTool.string((p=w==null?void 0:w.map(C=>k==null?void 0:k(C)).join(", "))!=null?p:"");if(ai(u.aggregation)){if(u.aggregation===m.AggregationAction.DATE_RANGE)return y==null?null:He.ValueTool.string(`${he(y).format(us)} - ${he(b).format(us)}`);const C=he(y);return y!==void 0&&C.isValid()?He.ValueTool.date(C.toDate()):null}else if(zd(u.aggregation))return typeof E=="string"?He.ValueTool.number(bg(E)):null;return He.ValueTool.number(Number(E))}if(u.type===m.CollectionSchemaType.CREATED_AT)return i.createdAt==null?null:He.ValueTool.date(new Date(i.createdAt));if(u.type===m.CollectionSchemaType.UPDATED_AT)return i.updatedAt==null?null:He.ValueTool.date(new Date(i.updatedAt));if(u.type===m.CollectionSchemaType.CREATED_BY){const y=i.createdBy==null?"":ss(i.createdBy);return He.ValueTool.string(y)}if(u.type===m.CollectionSchemaType.UPDATED_BY){const y=i.updatedBy==null?"":ss(i.updatedBy);return He.ValueTool.string(y)}const d=u.type===m.CollectionSchemaType.TITLE?i.data.segments:(g=i.data.collectionProperties)==null?void 0:g[n];if(u.type===m.CollectionSchemaType.CHECKBOX)return He.ValueTool.boolean(de(d).toUpperCase()==="YES");if(u.type===m.CollectionSchemaType.NUMBER){const y=de(d);let b=parseFloat(y);return Number.isNaN(b)&&(b=parseFloat((x=(_=y.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:_[0])!=null?x:"")),Number.isNaN(b)?null:He.ValueTool.number(b)}if(u.type===m.CollectionSchemaType.DATE){if(d==null)return null;const y=d.find(E=>E.type===m.TextType.DATE||E.type===m.TextType.DATETIME);if(y==null)return null;const b=Ec(y);return he(b).isValid()?He.ValueTool.date(b):null}if(u.type===m.CollectionSchemaType.PERSON){const y=(d!=null?d:[]).filter(b=>b.type===m.TextType.USER).map(b=>b.uuid==null?"":ss(b.uuid)).join(", ");return He.ValueTool.string(y)}if(u.type===m.CollectionSchemaType.FILE){const y=(d!=null?d:[]).filter(b=>b.type===m.TextType.URL&&b.fileStorageType==="internal").map(b=>b.text).join(", ");return He.ValueTool.string(y)}if(u.type===m.CollectionSchemaType.MULTI_SELECT){const y=de(d);return He.ValueTool.string(y.replace(/\s*,\s*/g,", "))}return He.ValueTool.string(de(d))}}const NK=(e,t,n,s)=>{const a=t!=null?t:{},o=new He.Schema;for(const[g,_]of Object.entries(a))o.defineProp(g,_.name,null);const i=g=>{try{return He.Formula.fromServer(g,o)}catch(_){return console.warn(_),""}},l=g=>{const _=new Set;for(const[x]of Object.entries(a))z6(e,g,e,x,n)||_.add(x);return _},c=new Map,u=g=>{const _=new He.Schema;for(const x of g){const y=a[x];if(y!=null)if(y.type===m.CollectionSchemaType.FORMULA){const b=c.get(x);_.defineProp(x,y.name,b==null?He.ValueTool.stringType:He.ExprTool.typeOf(b))}else y.type===m.CollectionSchemaType.ROLLUP?so(y.aggregation)?_.defineProp(x,y.name,He.ValueTool.stringType):ai(y.aggregation)?y.aggregation===m.AggregationAction.DATE_RANGE?_.defineProp(x,y.name,He.ValueTool.stringType):_.defineProp(x,y.name,He.ValueTool.dateType):_.defineProp(x,y.name,He.ValueTool.numberType):y.type===m.CollectionSchemaType.NUMBER?_.defineProp(x,y.name,He.ValueTool.numberType):y.type===m.CollectionSchemaType.DATE||y.type===m.CollectionSchemaType.CREATED_AT||y.type===m.CollectionSchemaType.UPDATED_AT?_.defineProp(x,y.name,He.ValueTool.dateType):y.type===m.CollectionSchemaType.CHECKBOX?_.defineProp(x,y.name,He.ValueTool.booleanType):_.defineProp(x,y.name,He.ValueTool.stringType)}return _},d=g=>{const _=a[g];if(_==null||_.type!==m.CollectionSchemaType.FORMULA||c.has(g))return;const x=()=>{c.set(g,null)};if(_.formula==null)return x();const y=_.formula,b=l(g),E=Object.keys(y.refProps);if(!E.every(v=>b.has(v)))return x();for(const v of E)d(v);const w=u(b),k=i(y),C=He.Formula.parse(k,w);if(He.ResultTool.isError(C))return x();const T=He.ResultTool.getOk(C);c.set(g,T)};for(const g of Object.keys(a))d(g);const f=(g,_)=>{if(!c.has(_))return s.readProp(g,_);const x=c.get(_);return x==null?null:He.Formula.eval(x,s,g)},h=(g,_)=>{const x=f(g,_);if(x==null)return null;const y=He.ValueTool.typeOf(x);return y===He.ValueTool.numberType?He.ValueTool.asNumber(x):y===He.ValueTool.stringType?He.ValueTool.asString(x):y===He.ValueTool.booleanType?He.ValueTool.asBoolean(x):y===He.ValueTool.dateType?He.ValueTool.asDate(x):null},p=g=>{const _=c.get(g);return _==null?null:He.ExprTool.typeOf(_)};return{fromServer:i,toServer(g){return He.Formula.toServer(g,o)},getType:p,getTypeAsCollectionSchemaType(g){const _=p(g);return _===He.ValueTool.numberType?m.CollectionSchemaType.NUMBER:_===He.ValueTool.booleanType?m.CollectionSchemaType.CHECKBOX:_===He.ValueTool.dateType?m.CollectionSchemaType.DATE:m.CollectionSchemaType.TEXT},getBoxedValue:f,getValue:h,getValueAsSegments(g,_){const x=f(g,_);if(x==null)return;const y=He.ValueTool.typeOf(x);if(y===He.ValueTool.numberType)return[{type:m.TextType.TEXT,text:`${He.ValueTool.asNumber(x)}`,enhancer:{}}];if(y===He.ValueTool.stringType)return[{type:m.TextType.TEXT,text:He.ValueTool.asString(x),enhancer:{}}];if(y===He.ValueTool.booleanType)return He.ValueTool.asBoolean(x)?[{type:m.TextType.TEXT,text:"YES",enhancer:{}}]:void 0;if(y===He.ValueTool.dateType)return[Fn({from:He.ValueTool.asDate(x)})]},getAvailablePropIds(g){return l(g)},render(g,_){const x=c.get(_),y=x==null?null:He.Formula.eval(x,s,g);return He.ValueTool.toString(y)},validate(g,_,x){const y=l(x),b=u(y),E=He.Formula.parse(g,b);if(He.ResultTool.isError(E)){const C=He.ResultTool.getError(E);return{type:"error",pos:He.ErrorTool.getPosition(C),message:He.ErrorTool.toString(C)}}const w=He.ResultTool.getOk(E),k=He.Formula.eval(w,s,_);return{type:"preview",preview:k==null?"":He.ValueTool.typeOf(k)===He.ValueTool.numberType?mk(He.ValueTool.asNumber(k)):He.ValueTool.toString(k)}}}},mv=Symbol("Formula Tools"),IK=(e,t)=>{var o,i;const n=(i=(o=t.blocks[e])==null?void 0:o.data.schema)!=null?i:{},s=new vK(()=>t);return NK(e,n,{findSchema(l,c){var u,d;return(d=(u=t.blocks[l])==null?void 0:u.data.schema)==null?void 0:d[c]}},s)},Ln=(e,t=le)=>{const n=t();let s=n[mv];s==null&&(s=new Map,n[mv]=s);let a=s.get(e);return a==null&&(a=IK(e,n),s.set(e,a)),a},qa=(e,t)=>ae(({blocks:n})=>nu(e,t,n),{equalityFn:kn}),nu=(e,t,n=le().blocks)=>{var l,c,u,d,f,h;const s=n[e],a=(l=s==null?void 0:s.data.schema)==null?void 0:l[t];let o,i;if((a==null?void 0:a.type)===m.CollectionSchemaType.ROLLUP){o=(u=s==null?void 0:s.data.schema)==null?void 0:u[(c=a.relationProperty)!=null?c:""];const p=n[(d=o==null?void 0:o.collectionId)!=null?d:""];i=(h=p==null?void 0:p.data.schema)==null?void 0:h[(f=a.targetProperty)!=null?f:""]}return{propertySchema:a,relationPropertySchema:o,targetPropertySchema:i}},rR=(e,t,n)=>!n||!t?!1:!!Ln(e).getType(t),kc=(e,t)=>{var a;if(!t)return;const{propertySchema:n}=nu(e,t);if(!n)return;let s=n.type;return n.type===m.CollectionSchemaType.FORMULA&&rR(e,t,n.formula)&&((a=le().blocks[e])!=null&&a.data.schema)&&(s=Ln(e).getTypeAsCollectionSchemaType(t)),s===m.CollectionSchemaType.TITLE||s===m.CollectionSchemaType.TEXT||s===m.CollectionSchemaType.PHONE||s===m.CollectionSchemaType.EMAIL||s===m.CollectionSchemaType.RELATION||s===m.CollectionSchemaType.URL?"text":s===m.CollectionSchemaType.DATE||s===m.CollectionSchemaType.UPDATED_AT||s===m.CollectionSchemaType.CREATED_AT?"date":s===m.CollectionSchemaType.NUMBER?"number":s},Sk=e=>{var o;const{blocks:t,collectionViews:n}=le(),s=n[e];if(!s)return;const a=t[s.parentId];if(a){if(a.type===m.BlockType.COLLECTION_VIEW_PAGE||a.type===m.BlockType.COLLECTION_VIEW)return a.uuid;if(a.type===m.BlockType.REFERENCE_COLLECTION||a.type===m.BlockType.REFERENCE_COLLECTION_PAGE)return(o=a.data.ref)==null?void 0:o.uuid}},jK=e=>e===m.CollectionSchemaType.SELECT||e===m.CollectionSchemaType.MULTI_SELECT,tF=(e,t,n=!1)=>ae(({collectionViews:s,blocks:a})=>{var i;const o=aR(e,n,a,s);if(o&&jK(o.type))return(i=o.options)==null?void 0:i.find(l=>l.value===t)}),su=(e,t=!1)=>ae(({collectionViews:n,blocks:s})=>aR(e,t,s,n)),aR=(e,t=!1,n=le().blocks,s=le().collectionViews)=>{var d,f,h,p,g,_,x,y;const a=s[e];if(!a)return;const o=Sk(e);if(!o)return;const i=n[o],l=a.type===m.CollectionViewType.BOARD,c={...(h=i==null?void 0:i.data.schema)==null?void 0:h[(f=(d=a.format.boardGroupBy)==null?void 0:d.property)!=null?f:""],propertyId:(p=a.format.boardGroupBy)==null?void 0:p.property},u={...(x=i==null?void 0:i.data.schema)==null?void 0:x[(_=(g=a.format.collectionGroupBy)==null?void 0:g.property)!=null?_:""],propertyId:(y=a.format.collectionGroupBy)==null?void 0:y.property};return l&&t?u:l?c:u},ps=e=>ae(({collectionViews:t})=>t[e]),Cg=e=>ae(({collectionViews:t})=>{const n=t[e];return(n==null?void 0:n.format.tableWrap)&&n.type!==m.CollectionViewType.TIMELINE}),oR=e=>ae(({collectionViews:t})=>{const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.CALENDAR&&n.format.showLunarCalendar===!0}),Bo=e=>ae(({collectionViews:t})=>{const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD?(n.format.boardCoverType===m.CoverType.PAGE_COVER||n.format.boardCoverType===m.CoverType.PAGE_CONTENT)&&n.format.boardImageDir===m.CollectionCardImageDir.VERTICAL?m.CollectionCardImageDir.VERTICAL:m.CollectionCardImageDir.HORIZONTAL:((n==null?void 0:n.format.galleryCoverType)===m.CoverType.PAGE_COVER||(n==null?void 0:n.format.galleryCoverType)===m.CoverType.PAGE_CONTENT)&&n.format.galleryImageDir===m.CollectionCardImageDir.VERTICAL?m.CollectionCardImageDir.VERTICAL:m.CollectionCardImageDir.HORIZONTAL}),Lo=e=>ae(({collectionViews:t})=>{var s,a;const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD?(s=n.format.boardCardSize)!=null?s:m.CardSize.MEDIUM:(a=n==null?void 0:n.format.galleryCardSize)!=null?a:m.CardSize.MEDIUM}),nF=e=>ae(({collectionViews:t})=>{var s,a;const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD?(s=n.format.boardCoverAspect)!=null?s:m.CoverAspectType.COVER:(a=n==null?void 0:n.format.galleryCoverAspect)!=null?a:m.CoverAspectType.COVER}),iR=e=>ae(({collectionViews:t})=>{var s,a;const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD?(s=n==null?void 0:n.format.boardShowPropertyName)!=null?s:!0:(a=n==null?void 0:n.format.galleryShowPropertyName)!=null?a:!0}),sF=e=>ae(({collectionViews:t})=>{const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.TIMELINE?n==null?void 0:n.format.timelineColorSetting:n==null?void 0:n.format.calendarColorSetting}),Kd=e=>ae(()=>lR(e),{equalityFn:kn}),lR=e=>{var i,l,c,u,d;const{blocks:t,collectionViews:n}=le(),s=n[e];let a,o;if((s==null?void 0:s.type)===m.CollectionViewType.BOARD?a=(i=s.format.boardCoverType)!=null?i:m.CoverType.NONE:a=(l=s==null?void 0:s.format.galleryCoverType)!=null?l:m.CoverType.NONE,a===m.CoverType.FILE_PROPERTY){const f=Sk(e),h=(u=(c=t[f!=null?f:""])==null?void 0:c.data.schema)!=null?u:{};let p;(s==null?void 0:s.type)===m.CollectionViewType.BOARD?p=s.format.boardCoverProperty:p=s==null?void 0:s.format.galleryCoverProperty,((d=h[p!=null?p:""])==null?void 0:d.type)===m.CollectionSchemaType.FILE?o=p:a=m.CoverType.NONE}return{previewType:a,previewProperty:o}},Tg=e=>ae(({collectionViews:t})=>{var n;if(e)return(n=t[e])==null?void 0:n.parentId}),DK=e=>ae(({collectionViews:t})=>{var n,s,a;return(a=(s=(n=t[e])==null?void 0:n.format.timelinePreference)==null?void 0:s.zoomLevel)!=null?a:"month"}),rF=e=>ae(({collectionViews:t})=>{var n,s;return(s=(n=t[e])==null?void 0:n.format.calendarType)!=null?s:"month"}),Wm=e=>ae(({collectionViews:t})=>{var n;return((n=t[e])==null?void 0:n.format.timelineShowTable)!==!1},{equalityFn:Cn}),ru=(e,t)=>ae(({collectionViews:n})=>{const s=n[e];return t||(s==null?void 0:s.type)!==m.CollectionViewType.BOARD?s==null?void 0:s.format.collectionGroupBy:s.format.boardGroupBy},{equalityFn:Cn}),Rk=e=>{const{collectionId:t,viewId:n}=Te(),s=ru(n,e),a=su(n,e),o=kc(t,s==null?void 0:s.property);return(a==null?void 0:a.type)===m.CollectionSchemaType.SELECT||(a==null?void 0:a.type)===m.CollectionSchemaType.MULTI_SELECT||(a==null?void 0:a.type)===m.CollectionSchemaType.CHECKBOX||(a==null?void 0:a.type)===m.CollectionSchemaType.PERSON||(a==null?void 0:a.type)===m.CollectionSchemaType.CREATED_BY||(a==null?void 0:a.type)===m.CollectionSchemaType.UPDATED_BY||o==="text"&&(s==null?void 0:s.sort)===m.GroupSortType.MANUAL||o==="checkbox"},hv=new Map,pv=new Map;function Cc(e,t,n){return e.filter(s=>L2(s,t,n))}function L2(e,t,n){var d;const{includePhoneNumber:s=!0}=n!=null?n:{},a=t.replace(/\s+/g,"").toLowerCase();let o=gv(e.nickname||ni);s&&(o=`${o}${e.phone}`);const i=_v(e.nickname),l=`${e.nickname.replace(/\s+/g,"").toLowerCase()} ${o} ${i}`,c=(d=Tn().userRemark)==null?void 0:d[e.uuid];let u="";if(c){const f=gv(c),h=_v(c);u=`${c.replace(/\s+/g,"").toLowerCase()} ${f} ${h}`}return l.includes(a)||u.includes(a)}const gv=e=>{if(!e)return"";let t=hv.get(e);return t||(t=yl(e),hv.set(e,t)),t},_v=e=>{if(!e)return"";let t=pv.get(e);return t||(t=sg(e),pv.set(e,t)),t},P2=async e=>(await Lj("https://cdn.staticfile.org/jschardet/3.0.0/jschardet.min.js","script"),new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.onload=async()=>{var l;const s=n.result;if(typeof s!="string"){t(s);return}const a=atob((l=s.split(";base64,")[1])!=null?l:"");let o="UTF-8";try{o=window.jschardet.detect(a).encoding}catch(c){try{const u=await rM(e);u.encoding&&(o=u.encoding)}catch(u){console.warn(u)}}const i=new FileReader;i.readAsText(e,o),i.onload=()=>{t(i.result)}}})),SK=({downloadUrl:e})=>{const t=Cr(),n=F.useRef(null),[s,a]=F.useState(!0),o=async i=>{fetch(i).then(l=>l.blob()).then(l=>{if(l.type.startsWith("video")){n.current&&(n.current.innerText="预览失败！"),a(!1);return}P2(l).then(c=>{if(!n.current||typeof c!="string"){a(!1);return}n.current.innerText=c,a(!1)})})};return F.useEffect(()=>{o(e)},[e]),r.jsxs("div",{className:"h-full overflow-auto",style:{width:t?"calc(100vw - 40px)":"860px"},children:[r.jsx("pre",{ref:n,className:"pl-2 pt-2 text-t4 min-h-full min-w-full text-black bg-white1",style:{width:"max-content",height:"max-height"}}),s&&r.jsx(hs,{className:"absolute top-0 bottom-0 left-0 right-0 mx-auto my-auto z-50"})]})},RK=zt.memo(SK),i0=2e3,AK=3*1024*1024,BK=async e=>{if(e.size>AK)throw Error("文件大小不能超过3Mb");if(e.name.endsWith(".txt")){const t=await P2(e);if(typeof t=="string")return PK(t)}else if(e.name.endsWith(".csv")){const t=await P2(e);if(typeof t=="string")return LK(t)}return[]},LK=e=>{let t;try{t=aM(e)}catch(s){throw Error("csv文件格式不对")}const n=new Map;if(t instanceof Array){if(t.length>i0)throw Error(`csv文件不能超过${i0}行`);return t.forEach((a,o)=>{if(a instanceof Array&&a.length===2){const i=a[0],l=a[1];if(!i||!l)throw Error("csv格式不对");if(!R1.Mobile.test(l))throw new Error(`第${o+1}行 [${a.join(",")}] 手机号码格式不对`);n.set(l,i)}else throw Error("csv格式不对")}),Array.from(n,([a,o])=>({phone:a,name:o}))}throw Error("csv格式不对")},PK=e=>{let t=e.split(/[\r\n]+/g);t=t.filter(a=>a.trim());const n=new Map;if(t.length>i0)throw Error(`txt文件不能超过${i0}行`);return t.forEach((a,o)=>{const i=a.split(",");if(i.length!==2)throw new Error(`第${o+1}行 [${a}] 格式不对`);const l=i[0],c=i[1];if(!l||!c)throw new Error(`第${o+1}行 [${a}] 格式不对`);if(!R1.Mobile.test(c))throw new Error(`第${o+1}行 [${a}] 手机号码格式不对`);n.set(c,l)}),Array.from(n,([a,o])=>({phone:a,name:o}))},cR=e=>r.jsxs("div",{className:"next-modal px-7 pb-4 w-[480px]",children:[r.jsxs("div",{className:"flex justify-between mt-7 items-center",children:[r.jsxs("div",{className:"text-h2 ",children:["批量导入",e.isGuest?"外部协作者":"空间成员"]}),r.jsxs("a",{className:"flex items-center",target:"_blank",href:An.importGuest,children:[r.jsx(H,{name:"IcInviteHelp",size:"small",className:B("ml-1 text-grey4")}),r.jsx("div",{className:"ml-1 text-t4 text-grey4",children:"查看帮助"})]})]}),r.jsxs("div",{className:"text-t3-medium mt-7",children:["支持批量导入姓名和手机号，快速添加",e.isGuest?"外部协作者至当前页面":"成员至当前空间"]}),r.jsxs("div",{className:"text-t4 text-grey3 mt-2.5 flex items-center",children:[r.jsx("span",{className:"w-1 h-1 rounded-full bg-grey3 ml-1 mr-1.5"}),"请使用 UTF-8 编码格式，上传后缀为 .csv 或 .txt 格式的文件"]}),r.jsxs("div",{className:"text-t4 text-grey3 flex items-center",children:[r.jsx("span",{className:"w-1 h-1 rounded-full bg-grey3 ml-1 mr-1.5"}),"每行一个对应关系，以英文逗号分割。对应关系为：姓名,手机号"]}),r.jsxs("div",{className:"flex justify-between mt-5",children:[r.jsx("img",{className:"w-[200px]",src:Dn.importGuestLeft}),r.jsx("img",{className:"w-[200px]",src:Dn.importGuestRight})]}),r.jsx(xk,{singleFile:!0,labelClassName:"w-full",style:{width:"100%"},title:"选择本地文件",onSelect:async t=>{const n=t[0];if(!n)return;if(!n.name.endsWith(".txt")&&!n.name.endsWith(".csv")){ye.warning("文件格式不对");return}const s=ye.loading({content:"解析中..."});try{const a=await BK(n);if(a.length===0)throw Error("解析到的列表为空，请检查文本格式是否正确");e.onReceiveGuestList(a)}catch(a){a instanceof Error?ye.error(a.message):ye.error(a)}finally{ye.closeMessage(s)}},inputAttribute:{accept:".csv,.txt"}}),r.jsx("div",{className:"text-t4 text-grey3 text-center mt-[-6px]",children:"内容应小于2000行，文件大小不超过3MB；若超过空间限制人数将导入失败"})]}),O2={[m.PermissionRole.EDITOR]:"所有权限",[m.PermissionRole.WRITER]:"可编辑",[m.PermissionRole.COMMENTER]:"可评论",[m.PermissionRole.READER]:"可查看",[m.PermissionRole.NONE]:"无权限"},uR=({isGuest:e,showRight:t,role:n,onChange:s,isSpaceType:a,noRemove:o,isForm:i})=>{const l=me();let c=[];e||c.push({type:$.TEXT_DESCRIPTION,data:{title:"所有权限",description:"可编辑，可管理协作及分享",selected:n===m.PermissionRole.EDITOR,onClick:()=>s==null?void 0:s(m.PermissionRole.EDITOR)}}),c.push({type:$.TEXT_DESCRIPTION,data:{title:"可编辑",description:"仅可编辑，不可管理协作及分享",selected:n===m.PermissionRole.WRITER,onClick:()=>s==null?void 0:s(m.PermissionRole.WRITER)}}),c.push({type:$.TEXT_DESCRIPTION,data:{title:"可评论",description:"仅可查看及评论，不可编辑",selected:n===m.PermissionRole.COMMENTER,onClick:()=>s==null?void 0:s(m.PermissionRole.COMMENTER)}}),c.push({type:$.TEXT_DESCRIPTION,data:{title:"可查看",description:"仅可查看，不可编辑及评论",selected:n===m.PermissionRole.READER,onClick:()=>s==null?void 0:s(m.PermissionRole.READER)}}),o||(c.push({type:$.LINE}),c.push({type:$.TEXT_DESCRIPTION,data:{title:r.jsx("div",{className:"text-red",children:a?" 无权限":"移除"}),selected:a&&(!n||n===m.PermissionRole.NONE),onClick:()=>s==null?void 0:s(m.PermissionRole.NONE)}})),i&&(c=[{type:$.TEXT_DESCRIPTION,data:{title:r.jsx("div",{className:"text-red",children:"移除"}),onClick:()=>s==null?void 0:s(m.PermissionRole.NONE)}}]);const u=d=>{l.dropdown({placement:"bottom",offset:[0,4],popcorn:d.currentTarget,content:({onCloseModal:f})=>r.jsx(ze,{className:"py-2 w-[270px] next-modal",onItemClick:()=>f(),items:c})})};return r.jsxs("div",{hidden:!s&&!t,className:B("self-center shrink-0 flex items-center text-t4 text-grey3",s?"cursor-pointer":"cursor-not-allowed",s&&"animate-click"),onClick:d=>s&&u(d),children:[i?"可填写":r.jsx(r.Fragment,{children:n?O2[n]:O2[m.PermissionRole.NONE]}),s&&r.jsx(H,{name:"IcArrow",className:"ml-1",size:"xxxsmall"})]})},qf=({filterUserNoInSpace:e,searchText:t="",activeIndex:n,permissions:s,onChange:a,showRight:o,noRemove:i,selectUser:l,isForm:c})=>{const u=Ft(),d=ae(_=>_.users),f=Qp(),h=F.useRef(!1),p=Va(),g=F.useCallback(_=>{var y,b,E,w;const x={index:(y=_.index)!=null?y:0,type:_.type,role:_.role,isGuest:_.isGuest};if(_.type===m.PermissionType.SPACE){if(x.id="space",x.backgroundColor=u.backgroundColor,x.name=u.title,x.usersNum=(E=(b=u.permissions)==null?void 0:b.length)!=null?E:0,x.icon=u.icon,t){const k=Object.entries(d).map(([C,T])=>T);x.userNames=Cc(k,t).map(C=>ss(C.uuid))}}else if(_.type===m.PermissionType.USER&&_.userId){const k=d[_.userId];if(!k||e&&!p[k.uuid]&&!_.isGuest)return null;x.id=k.uuid,x.name=ss(k.uuid),x.backgroundColor=k.backgroundColor,x.icon={type:"upload",value:k.avatar},x.phone=k.phone,x.isGuest=_.isGuest||!!t&&!p[k.uuid],x.isGuestInSpace=f.some(C=>C.userId===k.uuid)}else if(_.type===m.PermissionType.GROUP&&_.groupId){const k=(w=u.permissionGroups)==null?void 0:w.find(C=>C.id===_.groupId);if(!k)return null;if(x.id=k.id,x.name=k.name||nV,x.usersNum=k.userIds.length,x.icon=k.icon,t){const C=k.userIds.map(T=>d[T]).filter(T=>!!T);x.userNames=Cc(C,t).map(T=>ss(T.uuid))}}return x},[u,f,p,t,d,e]);return F.useEffect(()=>{const _=b=>{if(b.code==="Enter"){if(b.preventDefault(),b.stopPropagation(),h.current)return;if((n!=null?n:-1)>=0){const E=s.find(w=>w.index===n);if(E){const w=g(E);w&&!w.role&&(l==null||l({...E,name:w.name||w.phone}))}}}},x=()=>{h.current=!0},y=()=>{h.current=!1};return document.addEventListener("keydown",_),document.addEventListener("compositionstart",x),document.addEventListener("compositionend",y),()=>{document.removeEventListener("keydown",_),document.removeEventListener("compositionstart",x),document.removeEventListener("compositionend",y)}},[n,s,g,l]),r.jsx("div",{className:"max-h-64 overflow-y-auto",children:s.map(_=>{var w,k,C;const x=g(_);if(!x)return null;const y=(k=(w=x.userNames)==null?void 0:w.length)!=null?k:0,b=_.type===m.PermissionType.USER?"rounded-full":"",E=!x.isGuest&&!!t&&x.role&&x.role!==m.PermissionRole.NONE;return r.jsxs("div",{className:B("relative flex items-center justify-between h-[58px] rounded px-1",!E&&l&&"cursor-pointer animate-click",x.index===n&&"normal-bg"),onClick:()=>!E&&l&&l({..._,name:x.name||x.phone}),children:[E&&r.jsx("div",{className:"absolute inset-0 bg-white1 opacity-70 cursor-not-allowed"}),r.jsxs("div",{className:B("flex items-center w-full",E&&x.role&&"w-60"),children:[r.jsx(Ps,{color:x.backgroundColor||to.grey,name:x.name||(x.isGuest?"客":ni),icon:x.icon,className:`mr-2 w-[30px] h-[30px] text-white !text-t1 ${b}`,imgClassName:b}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex text-t2",children:[r.jsxs("div",{className:"flex items-center max-w-[160px] text-ellipsis",children:[r.jsx("div",{children:x.name||(x.isGuest?x.phone:ni)}),x.isGuest&&r.jsx("div",{className:"rounded-sm ml-2 bg-grey6 w-10 text-t2 text-grey3 text-center",children:"外部"})]}),x.usersNum!==void 0&&r.jsx("div",{className:"flex-shrink-0",children:`（${x.usersNum} 人）`})]}),x.name&&x.phone&&r.jsx("span",{className:"text-grey3 text-t4",children:jd(x.phone)}),!!y&&r.jsxs("span",{className:"text-t4 text-grey3 line-clamp-1",children:[r.jsx("span",{className:"mr-1",children:"包含:"}),(C=x.userNames)==null?void 0:C.map((T,v)=>r.jsxs("span",{className:B(v!==y-1&&"mr-1"),children:[r.jsx(Rx,{text:T,search:t}),v!==y-1&&","]},`${T}-${v}`))]})]})]}),E&&x.role&&r.jsx("div",{className:"text-t4 flex-shrink-0",children:c?"可填写":`已设置${O2[x.role]}`}),!o&&x.isGuest&&!x.isGuestInSpace&&r.jsx("div",{className:"text-t4 text-grey3 flex-shrink-0",children:"未加入该空间"}),r.jsx(uR,{isForm:c,isGuest:x.isGuest,noRemove:i,isSpaceType:x.type===m.PermissionType.SPACE,role:x.role,onChange:a?T=>a(T,_):void 0,showRight:o})]},x.id)})})},dR=async e=>{var c;const t=[],n={},s=new Map,a=[];for(const u of e)s.set(u.phone,u.name),a.push(u.phone);const{users:o,relations:i}=await Ce.infra.temporaryBatch(a);if(!i)return{userIds:t,markNames:n};const l=o.reduce((u,d)=>(u[d.uuid]=d,u),{});ee(El.updateSpaceUsers({users:l}));for(const u of i)t.push(u.uuid),n[u.uuid]=(c=s.get(u.phone))!=null?c:"";return{userIds:t,markNames:n}},zh="batch_guest",OK=({uuid:e,backToMainPanel:t,role:n,setRole:s,onConfirm:a,selectUser:o,selectedUsers:i,isForm:l,isAIMember:c,setBatchGuestGroups:u,batchGuestGroups:d})=>{const f=me(),h=Ft(),p=F.useRef(null),[g,_]=F.useState(""),[x,y]=F.useState(0),b=Va(),E=ae(re=>re.users),w=Qp(),k=ps(e),{permissions:C}=it(e),T=l?(k==null?void 0:k.format.formInviteUserPermissions)||[]:C,v=Ao(),{userPermissions:I,groupPermissions:j,spacePermission:D}=ek(T),{permissionGroups:S=[]}=h,R=wt.$aiMembers,A=new Set;R.forEach(re=>A.add(re.uuid));const L=Object.values(E).map(re=>I.find(Y=>Y.userId===re.uuid)||{type:m.PermissionType.USER,userId:re.uuid}).slice(0,g?void 0:5).filter(re=>!i.some(ne=>ne.userId===re.userId)).filter(re=>{if(!g)return I.every(Y=>Y.userId!==re.userId);if(!re.userId)return!1;const ne=E[re.userId];return ne?!!(L2(ne,g)||g.length===11&&/^1\d{10}$/.test(g)&&ne.pinyin.includes(g)):!1}).map((re,ne)=>({...re,index:ne})),M=(!g&&D&&D.role!==m.PermissionRole.NONE?[]:[{groupId:"",type:m.PermissionType.SPACE,name:h.title,userIds:Object.keys(b),role:D?D.role:m.PermissionRole.NONE}]).concat(S.map(re=>{const ne={...re,groupId:re.id,type:m.PermissionType.GROUP,name:re.name,userIds:re.userIds},Y=j.find(X=>X.groupId===re.id);return Y?{...ne,role:Y.role}:ne})).filter(re=>!i.some(ne=>ne.groupId===re.groupId)).filter(re=>c&&A.has(re.groupId)?!1:g?re.name.toLowerCase().includes(g.toLowerCase())||yl(re.name).includes(g.replace("'",""))?!0:re.userIds.some(ne=>{const Y=b[ne];return Y?!!L2(Y,g):!1}):j.every(ne=>ne.groupId!==re.groupId)).map((re,ne)=>({...re,index:ne+L.length})),U=re=>{if(re.code==="Backspace"){if(!i.length||g.length)return;re.preventDefault();const ne=pn(i);ne&&o(ne)}},V=re=>{var ne;o(re),_(""),(ne=p.current)==null||ne.focus()},W=L.length+M.length;F.useEffect(()=>{setTimeout(()=>{var re;(re=p.current)==null||re.focus()},100)},[]),F.useEffect(()=>{const re=Y=>{if(Y.code==="ArrowUp")return y(X=>X<=0?W-1:--X),Y.preventDefault(),!0;if(Y.code==="ArrowDown")return y(X=>X>=W-1?0:++X),Y.preventDefault(),!0};return qt.addEventListener("keydown",re,Tr+1,!0)},[W]);const z=L.filter(({userId:re})=>re&&g.length===11&&/^1\d{10}$/.test(g)?!b[re]:w.some(ne=>ne.userId===re)),Q=L.filter(({userId:re})=>c&&A.has(re)?!1:re&&b[re]),Z=i.some(re=>{var ne;return((ne=re.groupId)==null?void 0:ne.startsWith(zh))||re.userId&&!b[re.userId]}),te=i.length===0||!l&&n===m.PermissionRole.EDITOR&&Z;return r.jsxs(r.Fragment,{children:[!c&&r.jsxs("div",{className:"p-4 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:"IcArrowBack",size:"middle",className:"animate-click",onClick:t}),r.jsx("span",{className:"text-t2 ml-1",children:l?"邀请填写者":r.jsx(eu,{popup:"了解协作权限",link:Ta.invitePage,children:"邀请协作"})})]}),r.jsx("div",{className:"text-t4 text-active_color cursor-pointer",onClick:re=>{f.dropdown({placement:"bottom-start",popcorn:re.currentTarget,content:({onCloseModal:ne})=>r.jsx(cR,{isGuest:!0,onReceiveGuestList:async Y=>{const{userIds:X,markNames:oe}=await dR(Y),ie=`${zh}${qe()}`;u([...d,{id:ie,name:"批量外部协作者",userIds:X,markNames:oe}]);const ue={id:ie,name:"批量外部协作者",index:-1,groupId:ie,type:m.PermissionType.GROUP};V(ue),ne()}})})},children:"批量导入"})]}),r.jsxs("div",{className:"flex flex-wrap px-3 mb-4 space-x-1.5 items-center mx-4 min-h-8 border border-grey6 bg-grey9 focus-within-border rounded text-t2",children:[i.length?i.map(re=>{let ne=S.find(Y=>Y.id===re.groupId);return ne||(ne=d.find(Y=>Y.id===re.groupId)),r.jsxs("div",{className:"flex h-5 bg-grey6 rounded-sm items-center px-1.5 my-1.5",children:[r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"max-w-[210px] text-ellipsis",children:re.name}),ne&&r.jsx("div",{className:"flex-shrink-0",children:`（${ne.userIds.length} 人）`})]}),r.jsx(H,{size:"small",onClick:()=>V(re),name:"IcToastClose",className:"ml-2 animate-click cursor-pointer"})]},`${re.userId}${re.groupId}`)}):r.jsx(H,{name:"IcTitleSearch",size:"small",className:"mr-1 text-grey4"}),r.jsx("input",{ref:p,className:"bg-transparent my-1.5 flex-1",placeholder:c?"搜索成员名/成员组名":"搜索人员、组、手机号",onKeyDown:U,onChange:re=>{const{value:ne}=re.target;_(ne),ne.length===11&&/^1\d{10}$/.test(ne)&&Ce.infra.findUser(ne).then(({user:Y})=>{ee(Y?El.updateSpaceUsers({users:{[Y.uuid]:{...Y,phone:ne}}}):El.updateSpaceUsers({users:{[ne]:{uuid:ne,nickname:"",phone:ne}}}))})},value:g})]}),r.jsxs("div",{className:"p-4 pt-0 max-h-120 overflow-y-auto",children:[!!Q.length&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 text-grey3",children:"选择空间成员"}),r.jsx(qf,{isForm:l,searchText:g,activeIndex:x,selectUser:V,permissions:Q})]}),v&&!!M.length&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 text-grey3 mt-2",children:"选择空间成员组"}),r.jsx(qf,{isForm:l,searchText:g,activeIndex:x,selectUser:V,permissions:M})]}),!!z.length&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 text-grey3",children:"邀请外部协作者"}),r.jsx(qf,{isForm:l,searchText:g,activeIndex:x,selectUser:V,permissions:z})]}),!L.length&&!M.length&&r.jsx("span",{className:"text-t2 text-grey3",children:"无搜索结果"})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 border-t",children:[!c&&r.jsx("div",{className:"flex items-center",children:!l&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"ml-1 text-t2 mr-3",children:"统一设置权限为"}),r.jsx(uR,{noRemove:!0,role:n,onChange:s,isGuest:Z})]})}),r.jsxs("div",{className:"flex items-center ml-auto",children:[r.jsx(je,{onClick:t,className:"mr-4 text-t2-medium",children:"取消"}),r.jsx(Fe,{popup:te&&r.jsx("div",{className:"p-2",children:i.length===0?"请先选择一个成员":"外部协作者不可以设置所有权限"}),children:r.jsx(je,{disable:te,colorType:"active",onClick:a,className:"text-t2-medium text-white",children:"确定"})})]})]})]})},Ak=({backToMainPanel:e,uuid:t,searchType:n})=>{const s=n==="form",a=n==="aiMember",[o,i]=F.useState([]),[l,c]=F.useState(m.PermissionRole.EDITOR),u=me(),d=Ft(),f=Va(),h=ae(k=>k.users),p=Ro(),g=Pa(),_=ui(),[x,y]=F.useState([]);F.useEffect(()=>{o.some(C=>{var T;return((T=C.groupId)==null?void 0:T.startsWith(zh))||C.userId&&!f[C.userId]})&&l===m.PermissionRole.EDITOR&&c(m.PermissionRole.WRITER)},[l,o,f]);const b=F.useMemo(()=>{const k=[];return o.forEach(C=>{var T;if(C.type===m.PermissionType.GROUP&&((T=C.groupId)!=null&&T.startsWith(zh))){const v=x.find(I=>I.id===C.groupId);v==null||v.userIds.forEach(I=>{k.push({userId:I,type:m.PermissionType.USER,role:l})})}else k.push({...C,role:l})}),k},[x,l,o]),E=F.useCallback(async()=>{var T;if(a){const v=wt.$aiMembers,I=[];o.forEach(j=>{if(j.type==="user"||j.type==="group"||j.type==="space"){const D=j.type==="user"?j.userId:j.type==="group"?j.groupId:d.uuid;D&&I.push({type:j.type,uuid:D})}}),Ce.infra.postSpaceAiMembers(d.uuid,{members:I}),Ye({$aiMembers:v.concat(I)}),e();return}if(s){const v=(T=le().collectionViews)==null?void 0:T[t];if(!v)return;yt(t,{formInviteUserPermissions:[...v.format.formInviteUserPermissions||[],...b]}),e();return}const k=b.filter(v=>v.type===m.PermissionType.USER&&v.userId&&!f[v.userId]);let C={};if(o.forEach(v=>{var I;if(v.type===m.PermissionType.GROUP&&((I=v.groupId)!=null&&I.startsWith(zh))){const j=x.find(D=>D.id===v.groupId);if(!j)return;C={...C,...j.markNames}}}),Object.entries(C).length>0){await Ce.infra.addSpaceUserRemark(Tn().uuid,C);const v=Object.entries(C).map(([I,j])=>({userId:I,markName:j}));ee(hx({uuid:Tn().uuid,patch:v}))}if(k.length>0){if(!_){const{results:v}=await Ce.infra.getSpaceGuests(d.uuid),I=new Set(k.map(D=>D.userId));v.forEach(({userId:D})=>I.add(D));const{mindMapMaxLimit:j}=xg();if(I.size>j){u.warning({title:"邀请失败",content:`外部协作者数量已达上限${j}人，若需继续邀请， 可尝试升级空间`,confirmText:"升级空间",colorType:"active",confirm:()=>{d.planType===Et.freePersonal?g({defaultMenuType:Jt.upgrade,from:Vt.extMember}):p(Vt.extMember)}});return}}for(const v of k){v.isGuest=!0;const I=h[v.userId];if(I&&I.uuid.length<12){const j=await Ce.infra.temporary({phone:I.phone});v.userId=j.user.uuid,ee(El.updateSpaceUsers({users:{[j.user.uuid]:{...I,...j}}}))}}}e(),b.forEach(v=>Uf(t,v)),ee(Er()),ce.event("invite_space_member")},[h,e,x,d.planType,d.uuid,a,s,_,u,g,p,b,o,f,t]);F.useEffect(()=>{const k=()=>{o.length&&u.warning({title:r.jsx("div",{className:"w-80",children:"是否发送协作邀请？"}),content:"若取消，则当前邀请不会生效",confirmText:"发送邀请",colorType:"active",confirm:()=>{E()}})};return In.on("inviteConfirmModal",k),()=>{In.off("inviteConfirmModal",k)}},[e,E,u,o.length]);const w=(k,C)=>{i(T=>C?T.map(v=>k.type===m.PermissionType.SPACE&&v.type===k.type||k.type===m.PermissionType.USER&&v.userId===k.userId||k.type===m.PermissionType.GROUP&&v.groupId===k.groupId?{...v,role:C}:v):k.type===m.PermissionType.SPACE&&T.some(v=>v.type===m.PermissionType.SPACE)?T.filter(v=>v.type!==m.PermissionType.SPACE):k.type===m.PermissionType.USER&&T.some(v=>v.userId===k.userId)?T.filter(v=>v.userId!==k.userId):k.type===m.PermissionType.GROUP&&T.some(v=>v.groupId===k.groupId)?T.filter(v=>v.groupId!==k.groupId):T.concat({...k,role:m.PermissionRole.EDITOR}))};return r.jsx(OK,{uuid:t,selectUser:w,selectedUsers:o,backToMainPanel:e,onConfirm:E,role:l,setRole:c,isForm:s,isAIMember:a,setBatchGuestGroups:y,batchGuestGroups:x})};class MK{constructor(){q(this,"mainMgr");q(this,"_tasks",[]);q(this,"change$",new Up);q(this,"pollTimer");q(this,"allowStopSince",-1/0);if(!un)return;const{port1:t,port2:n}=new MessageChannel,s=Kx();s==null||s.postMessage("comlink-download-manager-port",null,[t]),ve(()=>import("./index-cb1b951e.js"),[]).then(a=>{this.mainMgr=a.wrap(n),this.startPoll()})}get tasks(){return this._tasks}get onChange(){return this.change$.asObservable()}startPoll(t=1e3){this.allowStopSince=Math.max(this.allowStopSince,Date.now()+t),!(this.pollTimer||this.mainMgr==null)&&(this.pollTimer=window.setInterval(async()=>{const n=await this.mainMgr.getTasks();rn(n,this._tasks)||(this._tasks=n,this.change$.next()),!this._tasks.some(s=>s.state==="progressing")&&Date.now()>=this.allowStopSince&&(clearInterval(this.pollTimer),this.pollTimer=void 0)},50))}async download(t){var n;await((n=this.mainMgr)==null?void 0:n.download(t)),this.startPoll()}async downloadMany(t){var n;await((n=this.mainMgr)==null?void 0:n.downloadMany(t)),this.startPoll()}async cancel(t){var n;await((n=this.mainMgr)==null?void 0:n.cancel(t)),this.startPoll()}async remove(t){var n;await((n=this.mainMgr)==null?void 0:n.remove(t)),this.startPoll()}}const Bk=new MK,Tc=async(e,t)=>{if(un){Bk.download({id:qe(),url:e,fileName:t==null?void 0:t.replace("/","-")});return}if(LU()){fR(e,t);return}const n=window.document.createElement("a");n.target="_blank",n.href=e,t&&(n.download=t),document.body.appendChild(n),n.click(),document.body.removeChild(n)},UK=e=>{const t=e.indexOf("?");if(t>0&&(e=e.substring(0,t)),!e.endsWith("/")){const n=e.lastIndexOf("/")+1;if(n>0)return e.substring(n)}return"未知文件名"},fR=(e,t)=>{if(un){Bk.download({id:qe(),url:e,fileName:t==null?void 0:t.replace("/","-")});return}const n=document.createElement("a");t&&(n.download=t),n.href=e,n.click()},mR=qe(),xv=new jo(localStorage,"short-url"),Fv=new jo(localStorage,"mini-program"),VK=async e=>{const t=xv.get(e);if(t)return t;const n=await Ce.infra.createShortUrl({url:e});return xv.put(e,n),n},qK=async e=>{const n="pages/webview/index",s="release",a=`${s}-${n}-${e}`,o=Fv.get(a);if(o)return o;const i=await Ce.infra.createMiniProgramQr({check_path:!0,env_version:s,page:n,scene:e});return Fv.put(a,i),i},HK=e=>{const{url:t}=e,[n,s]=F.useState(""),a=Kt();F.useEffect(()=>{(async()=>{var c,u;const l=await VK(t);if(l){const d=await qK(`shortId=${(u=(c=Jp(l))==null?void 0:c.pathname.replace("/",""))!=null?u:l}`);s(d)}})()},[t]);const o=()=>{a(mR)},i=()=>{Tc(n,`${Date.now()}.jpeg`)};return F.useEffect(()=>{s("")},[]),r.jsxs("div",{className:"next-modal w-96",children:[r.jsx("div",{className:"h-20 flex items-center px-8",children:"小程序分享"}),r.jsx("div",{className:"flex items-center justify-center px-20",children:n?r.jsx("img",{src:n,className:"w-full p-4 bg-white-base rounded-md",alt:"小程序二维码"}):r.jsx(os,{className:"w-56 h-56"})}),r.jsxs("div",{className:"flex items-center justify-end h-20 px-8",children:[r.jsx(je,{className:"mr-2.5",onClick:()=>o(),children:"取消"}),r.jsx(je,{colorType:"active",onClick:i,children:"下载图片"})]})]})},$K=()=>{const e=me();return F.useCallback(t=>{e.modal({modalId:mR,content:()=>r.jsx(HK,{...t})})},[e])},GK={auto:"h-full w-full text-t1",middle:"w-80 h-12 text-t1",large:"h-8 px-3.5 text-t2"},zK={primary:"bg-black1 border-black text-white dark:border-grey6",secondary:"bg-white dark:bg-transparent text-black border-grey6",red:"bg-white1 text-red border-red",white:"bg-transparent text-black border-grey5 dark:border-grey6",active:"bg-active_color text-white border-transparent"},WK={primary:"hover:opacity-90 dark:hover:brightness-110",secondary:"hover:brightness-90 dark:hover:bg-black_003",red:"hover:bg-red/10",white:"hover:bg-black_003",active:"hover:brightness-90 text-t2-bold dark:hover:brightness-110"},ii=zt.memo(e=>{const{colorType:t="secondary",disable:n,onClick:s,autoFocus:a=!1,size:o="large",className:i,children:l,...c}=e;return r.jsx("button",{...c,onClick:s,autoFocus:a,disabled:n,className:Xx("flex justify-center items-center rounded border outline-none",GK[o],zK[t],n?"opacity-30 cursor-not-allowed":WK[t],i),children:l})}),hR=qe(),KK=e=>{const{url:t,title:n}=e,[s,a]=F.useState(""),[o,i]=F.useState(""),l=Qt(),c=Yr(l.uuid),u=F.useRef(null),d=Kt(),f=()=>{d(hR)};F.useEffect(()=>{(async()=>{const p=await Kb.toDataURL(`${t}`,{errorCorrectionLevel:"H"});a(p)})()},[l.avatar,l.backgroundColor,l.nickname,t]),F.useEffect(()=>{u.current&&oM(u.current,{useCORS:!0,scale:5,backgroundColor:null}).then(p=>{const g=p.toDataURL("image/png",1);i(g)})},[s]);const h=()=>{Tc(o,`${Date.now()}.jpeg`)};return r.jsxs("div",{className:"next-modal w-125",children:[r.jsx("div",{className:"h-20 flex items-center px-8",children:"二维码分享"}),r.jsxs("div",{className:"flex justify-center px-20 min-h-[500px]",children:[o&&r.jsx("img",{className:"absolute z-10 w-[340px]",src:o,alt:""}),s?r.jsxs("div",{className:Yt("relative w-[350px] mt-2",o&&"opacity-0"),ref:u,children:[r.jsx("img",{className:"",src:Dn.shareFormQr}),r.jsxs("div",{className:"absolute inset-0 px-12 py-6",children:[r.jsx("div",{className:"flex py-2.5 text-t2-medium mb-5",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-black-base text-t1-medium",children:c}),r.jsx("div",{className:"text-grey3-base text-t3",children:n})]})}),r.jsx("img",{src:s,className:"w-60 h-60 mx-auto"})]})]}):r.jsx(os,{style:{minHeight:500}})]}),r.jsxs("div",{className:"flex items-center justify-end h-24 px-8",children:[r.jsx(ii,{className:"mr-2.5",onClick:()=>f(),children:"取消"}),r.jsx(ii,{colorType:"active",onClick:h,children:"下载图片"})]})]})},YK=()=>{const e=me();return F.useCallback(t=>{e.modal({modalId:hR,content:()=>r.jsx(KK,{...t})})},[e])},pR=e=>{var u;const{url:t,onCopyLink:n,uuid:s}=e,a=_e(s,["data"],["segments"]),o=ps(s),i=$K(),l=YK();let c=`分享了${(u=de(a==null?void 0:a.data.segments))!=null?u:aa}`;return(o==null?void 0:o.type)===m.CollectionViewType.FORM&&(c="邀请你填写收集表"),r.jsxs("div",{className:"px-4 border-t border-grey6 text-t2 bg-grey9 flex items-center text-active_color h-12",children:[r.jsx("span",{className:"mr-4 text-black",children:"分享方式"}),r.jsx(Fe,{popup:rV,className:"animate-click mr-4",children:r.jsx(H,{name:"IcUrl",size:"middle",onClick:n})}),r.jsx(Fe,{popup:"小程序分享",onClick:()=>i({url:t}),className:"animate-click mr-4",children:r.jsx(H,{name:"IcMenuMiniProgramQrcode",size:"middle"})}),r.jsx(Fe,{popup:"二维码分享",className:"animate-click",onClick:()=>l({url:t,title:c}),children:r.jsx(H,{name:"IcMenuQrcode",size:"middle"})})]})};var ec=(e=>(e[e.SEARCH_USER=0]="SEARCH_USER",e[e.ALL_USERS=1]="ALL_USERS",e[e.PASSWORD=2]="PASSWORD",e))(ec||{});const gR=({uuid:e,onClick:t,className:n=""})=>{const{role:s}=it(e),a=s===m.PermissionRole.EDITOR;return r.jsx("div",{onClick:a?t:void 0,className:B(n,a&&"animate-click"),children:r.jsx(xt,{readonly:!0,inputClassName:B("h-8 text-grey4 px-0",a?"cursor-pointer":"cursor-not-allowed"),addonBefore:r.jsx(H,{name:"IcTitleSearch",size:"small",className:"ml-3 mr-1 text-grey4"}),placeholder:"搜索人员、组、手机号",addonAfter:r.jsx("span",{className:B("flex justify-center items-center w-8 h-8 rounded-r-sm border-l border-grey6",a?"animate-click":"cursor-not-allowed"),children:r.jsx(H,{name:"IcAddBoard",className:"text-grey3",size:"middle"})})})})},yv={[m.PermissionRole.EDITOR]:"can edit",[m.PermissionRole.WRITER]:"can write",[m.PermissionRole.READER]:"can view",[m.PermissionRole.NONE]:"no access",[m.PermissionRole.COMMENTER]:"can comment"},_R=e=>{var b;const t=Kt(),n=Ft(),s=Qt(),a=_e(e,["permissions"]),o=me(),{permissions:i,role:l,isRestricted:c}=it(e),{permissions:u}=it((b=a==null?void 0:a.parentId)!=null?b:e),d=Ui(),f=Ao(),{spacePermission:h,groupPermissions:p,userPermissions:g}=ek(i);if(!a)return null;let _=[...p];(f||g.length>1)&&(_=[...p,...g]),!d&&f&&(h?_.unshift(h):_.unshift({type:m.PermissionType.SPACE,role:m.PermissionRole.NONE}));const x=(E,w,k)=>{const C=u.find(v=>o1(v,w)),T=()=>{if(!k)return;const v=a.permissions.some(I=>I.userId===s.uuid);if(w.role===m.PermissionRole.EDITOR&&!v){ga(e,{type:m.PermissionType.USER,role:m.PermissionRole.EDITOR,userId:s.uuid});return}E===m.PermissionRole.EDITOR&&v&&xd(e,{type:m.PermissionType.USER,role:m.PermissionRole.NONE,userId:s.uuid})};if(!c&&a.parentId!==n.uuid&&C&&C.role&&Jl[E]<Jl[C.role]){const v=()=>{T(),i.forEach(I=>{o1(I,w)?Uf(e,{...w,role:E}):Uf(e,I)}),ga(e,{type:m.PermissionType.RESTRICTED}),ee(Er()),ce.event("change_authority",{change_to:yv[E]})};o.warning({title:r.jsxs("div",{className:"px-5 mb-5 w-80",children:[r.jsx("div",{children:"确认进行权限变更？"}),r.jsx("div",{children:"变更后，将不再继承上级页面的协作及分享设置"})]}),confirmText:"确认",confirm:v});return}T(),Uf(e,{...w,role:E}),ee(Er()),ce.event("change_authority",{change_to:yv[E]})};return{role:l,block:a,onChange:(E,w)=>{var T;const k=i.filter(v=>v.role===m.PermissionRole.EDITOR);if(w.type===m.PermissionType.USER&&k.length===1){const v=k[0];if(v&&o1(v,w)){o.warning({title:r.jsx("div",{className:"px-5 mb-5 w-80",children:r.jsx("div",{children:"需要至少指定1名成员或成员组为「所有权限」才能进行此操作"})}),noCancel:!0,confirmText:"知道了",colorType:"secondary"});return}}let C=w.type===m.PermissionType.SPACE;if(w.type===m.PermissionType.GROUP){const{groupId:v}=w;if(v){const I=(T=n.permissionGroups)==null?void 0:T.find(j=>j.id===v);I&&(C=I.userIds.includes(s.uuid))}}if(w.userId===s.uuid){const v=()=>{x(E,w,C),t("inviteConfirmModal")};o.warning({title:r.jsx("div",{className:"px-5 mb-5 w-80",children:r.jsx("div",{children:"确认更改自己协作权限？"})}),confirmText:"确认",confirm:v});return}x(E,w,C)},permissions:_}},bv=5,XK=({uuid:e,onChangeTab:t})=>{const n=_R(e),s=async()=>{on(`${Sn()}/${e}`)};if(!n)return null;const{role:a,permissions:o,onChange:i}=n;return r.jsxs("div",{className:"pt-4 pb-2 mx-4 border-b border-grey6 text-t2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(eu,{popup:"了解协作权限",link:Ta.invitePage,children:"邀请协作"}),r.jsxs("div",{className:"flex items-center animate-click",onClick:s,children:[r.jsx(H,{className:"mr-1",size:"middle",name:"IcUrl"}),"复制页面链接"]})]}),r.jsx(gR,{uuid:e,onClick:()=>t(ec.SEARCH_USER),className:"mt-4 mb-2"}),r.jsx(qf,{showRight:!0,filterUserNoInSpace:!0,onChange:a===m.PermissionRole.EDITOR?i:void 0,permissions:o.slice(0,bv)}),o.length>bv&&r.jsxs("div",{onClick:()=>t(ec.ALL_USERS),className:"flex items-center animate-click animate-hover p-1",children:[r.jsx(H,{size:"middle",className:"text-grey4",name:"IcShareAnyone"}),r.jsx("div",{className:"text-t3 text-grey4 pl-4",children:`查看所有协作者（${o.length} 个）`})]})]})},QK=({uuid:e,onChangeTab:t})=>{const n=me(),s=ks(),{permissions:a,shared:o,illegal:i,role:l,publicRole:c,allowDuplicate:u,isRestricted:d,parentId:f,allowShowSidebar:h,password:p}=it(e),g=xG(e),_=FG(e),x=yG(e),y=_e(e,["data"],["segments"]),b=Ve(e),E=F.useRef(!1),{url:w,text:k,textAndUrl:C}=KS(e),T=async()=>{await on(p?`${w}${k}
访问密码${p}`:C,{message:p?"已复制链接和密码":"已复制链接"}),ce.event("share_copylink",{is_share:o})};if(F.useEffect(()=>()=>{if(E.current){const{publicRole:A}=hn(e);ce.event("share_authority",{authority_type:A===m.PermissionRole.COMMENTER?"can_comment":"can_read"})}},[e]),!y)return null;const v=l===m.PermissionRole.EDITOR,I=()=>{b||!v||(!d&&o&&f?n.warning({title:r.jsxs("div",{className:"px-5 mb-5 w-80",children:[r.jsx("div",{children:"确定关闭该分享?"}),r.jsx("div",{children:"关闭后将无法从分享的上级页面继续访问此页面"})]}),confirmText:"关闭分享",confirm:()=>{ce.event("share_switch",{is_open:!1}),f&&(a.forEach(A=>Uf(e,A)),ga(e,{type:m.PermissionType.RESTRICTED})),xd(e,{type:m.PermissionType.PUBLIC}),ee(Er())}}):(ce.event("share_switch",{is_open:!o}),o?xd(e,{type:m.PermissionType.PUBLIC}):(E.current=!0,ga(e,{role:m.PermissionRole.READER,type:m.PermissionType.PUBLIC}),Xt(y.type)&&(s(Ae.GUIDE_FIRST_TIME_SHARE,We.advancedList),s(Ae.OPEN_SHARE,We.advancedList))),ee(Er())))},j=()=>{v&&(!d&&f?ye.error("继承上级页面的设置，不支持单独关闭"):g())},D=()=>{v&&(!d&&f?ye.error("继承上级页面的设置，不支持单独关闭"):_())},S=!v||!d&&!!f,R=A=>{if(v){if(!d&&f){ye.error("继承上级页面的设置，不支持单独关闭");return}n.dropdown({offset:[0,5],popcorn:A.target,content:({onCloseModal:L})=>r.jsx(ze,{className:"next-modal py-1",items:[{type:$.TEXT_DESCRIPTION,data:{title:r.jsxs(r.Fragment,{children:["任何获得此链接的人都",r.jsx("span",{className:B("ml-1 text-t2-medium"),children:"可查看"})]}),selected:c!==m.PermissionRole.COMMENTER,onClick:()=>{c===m.PermissionRole.COMMENTER&&(E.current=!0,x(m.PermissionRole.READER)),L()}}},{type:$.TEXT_DESCRIPTION,data:{title:r.jsxs(r.Fragment,{children:["任何获得此链接的人都",r.jsx("span",{className:"ml-1 text-t2-medium",children:"可评论"})]}),selected:c===m.PermissionRole.COMMENTER,onClick:()=>{c!==m.PermissionRole.COMMENTER&&(E.current=!0,x(m.PermissionRole.COMMENTER)),L()}}}]})})}};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx(XK,{onChangeTab:t,uuid:e}),r.jsxs("div",{className:"flex items-center justify-between p-4",children:[r.jsx("div",{children:r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"text-t2 mr-2",children:Wj}),o&&!i&&r.jsx(JK,{onChangeTab:t,uuid:e})]})}),!ht()&&r.jsx(wn,{disabled:!v,onSwitch:I,open:i?!1:o})]}),o&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center h-8 bg-grey9 rounded border-[1px] border-grey6 mx-4",children:[r.jsxs("div",{className:"relative ml-3 text-t2 w-full cursor-pointer",onClick:R,children:["任何获得此链接的人都",r.jsx("span",{className:B("ml-1 text-t2-medium",{"opacity-20":S,"cursor-not-allowed":S}),children:`可${c===m.PermissionRole.COMMENTER?"评论":"查看"}`}),r.jsx(H,{name:"IcArrow",size:"xxxsmall",className:"absolute right-2 top-[7px]",style:{color:"var(--grey3)"}})]}),r.jsx("div",{className:"w-[1.5px] h-full bg-grey6"}),r.jsx("div",{onClick:T,className:"flex h-full  flex-shrink-0 items-center px-3 font-medium bg-white2 text-t2 animate-click",children:r.jsx("div",{className:"text-t2-medium",children:p?"复制链接和密码":"复制链接"})})]}),r.jsxs("div",{onClick:j,className:B("flex justify-between items-center mt-1 px-4 py-3 text-t2",!b&&v&&"animate-hover rounded-none animate-click"),children:[r.jsx("div",{children:"允许查看者拷贝页面副本、下载和打印"}),r.jsx(wn,{disabled:!v||!d&&!!f,onSwitch:j,open:u})]}),r.jsxs("div",{onClick:D,className:B("flex justify-between items-center px-4 py-3 text-t2",!b&&v&&"animate-hover rounded-none animate-click"),children:[r.jsx("div",{children:"分享页显示侧边栏目录"}),r.jsx(wn,{disabled:!v||!d&&!!f,onSwitch:D,open:h})]}),r.jsx(pR,{uuid:e,url:w,onCopyLink:T})]})]}),r.jsx(IW,{uuid:e})]})},JK=({uuid:e,onChangeTab:t})=>{const{password:n}=it(e);return r.jsx("div",{children:r.jsxs("div",{className:"flex items-center text-t3 text-grey3",children:[r.jsx(H,{name:n?"IcLock":"IcUnlock",size:"middle"}),r.jsxs("div",{className:"mr-2",children:[n?"已启用":"未启用","密码"]}),r.jsx("div",{className:"text-active_color cursor-pointer",onClick:s=>{s.stopPropagation(),ce.event("share_pw"),t(ec.PASSWORD)},children:"设置"})]})})},Ra=e=>{const{checked:t,className:n,size:s="middle",name:a,checkbox2:o,...i}=e;return r.jsx(H,{size:s,className:B("todo",t?"text-active_color":"dark:text-white",n),name:a!=null?a:t?o?"IcCheckbox2Check":"IcCheckboxCheck":o?"IcCheckbox2":"IcCheckbox",...i})},ZK=e=>{const{uuid:t,backToMainPanel:n}=e,{url:s,text:a}=KS(t),{role:o,shared:i,isRestricted:l,parentId:c,password:u,publicRole:d,allowDuplicate:f,allowShowSidebar:h}=it(t),p=[m.PermissionRole.EDITOR].includes(o)&&(l||!c),[g,_]=F.useState(!!u),[x,y]=F.useState(u||""),[b,E]=F.useState(""),w=pg(),k=()=>{if(!p)return;const v=CU();y(v)},C=async()=>{p&&w(async()=>{g&&x&&u!==x&&ye.success("设置成功"),u&&!g&&ye.success("取消成功"),g?u!==x&&ce.event("share_pw_open"):u&&ce.event("share_pw_cancel"),g?ga(t,{allowDuplicate:f,shareShowSidebar:h,type:m.PermissionType.PUBLIC,role:d,password:x}):i&&ga(t,{allowDuplicate:f,shareShowSidebar:h,type:m.PermissionType.PUBLIC,role:d}),i&&x&&g&&(await on(`${s}${a}
 访问密码${x}`,{message:"已复制链接和密码"}),ce.event("share_copylink",{is_share:i})),n()})},T=v=>{_(v),!x&&v&&k()};return F.useEffect(()=>{!/^(([A-z]|[0-9]){4})+$/.test(x)&&x?E("仅支持设置4位英文、数字密码"):(x&&_(!0),E(""))},[x]),r.jsxs("div",{className:"select-none",children:[r.jsxs("div",{className:"p-4 flex items-center text-t2",children:[r.jsx(H,{name:"IcArrowBack",className:"mr-2",size:"middle",onClick:n}),"设置分享访问密码"]}),r.jsxs("div",{className:B(!p&&"pointer-events-none opacity-30"),children:[r.jsxs("div",{className:"px-4 py-2.5",children:[r.jsx("div",{className:"w-52 rounded border border-grey6",children:r.jsx(xt,{readonly:!p,value:x,onChange:y,maxLength:4,className:"h-8",showBorder:!1,addonAfter:r.jsxs("div",{className:"h-full items-center flex justify-center bg-white1 px-3 border-l border-grey6 animate-hover rounded-l-none text-t2-medium",onClick:k,children:[r.jsx(H,{name:"IcMenuReplace",size:"middle",className:"mr-2"}),"随机生成"]})})}),b&&r.jsxs("div",{className:"text-t4 text-red mt-2.5 pointer-events-none px-1",children:[r.jsx($s,{inline:!0,emojiStr:"⚠️"})," 仅支持设置4位英文、数字密码"]})]}),r.jsxs("div",{className:"px-4 border-t border-grey6 mt-2.5 h-14 flex items-center text-t3 justify-between",children:[r.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>T(!g),children:[r.jsx(Ra,{checked:g,size:"large"}),r.jsx("span",{className:"ml-0.5",children:"启用密码"})]}),r.jsx(je,{colorType:"active",onClick:C,disable:!!b,children:"确定"})]})]})]})},xR=e=>{const{back:t,permissions:n,role:s,title:a,onChange:o,onlyUserList:i,isForm:l}=e;return i?r.jsx(qf,{showRight:!0,isForm:l,onChange:s===m.PermissionRole.EDITOR?o:void 0,permissions:n}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{onClick:t,className:"p-4 flex items-center animate-click",children:[r.jsx(H,{name:"IcArrowBack",size:"middle"}),r.jsx("span",{className:"text-t2 ml-1",children:a})]}),r.jsx("div",{className:"pl-4 text-t3 text-grey4",children:`共 ${n.length} 个协作者`}),r.jsx("div",{className:"p-4",children:r.jsx(qf,{showRight:!0,isForm:l,onChange:s===m.PermissionRole.EDITOR?o:void 0,permissions:n})})]})},eY=({uuid:e,backToMainPanel:t})=>{const n=_R(e);if(!n)return null;const{role:s,permissions:a,onChange:o}=n;return r.jsx(xR,{back:t,permissions:a,role:s,title:"所有协作者",onChange:o})},FR=({uuid:e,backToMainPanel:t,num:n=0,onlyUserList:s})=>{const a=ps(e),{formInviteUserPermissions:o=[]}=(a==null?void 0:a.format)||{},i=(l,c)=>{var d,f;const u=(d=le().collectionViews)==null?void 0:d[e];u&&yt(e,{formInviteUserPermissions:(f=u.format.formInviteUserPermissions)==null?void 0:f.filter(h=>h.groupId!==c.groupId||h.userId!==c.userId)})};return r.jsx(xR,{isForm:!0,onlyUserList:s,back:t,permissions:[...o].splice(0,n),role:m.PermissionRole.EDITOR,title:"所有填写者",onChange:i})},c1=400,tY=({uuid:e})=>{const[t,n]=F.useState(0),[s,a]=F.useState(ec.SEARCH_USER),o=i=>{a(i),n(-c1)};return r.jsx("div",{className:"sm:mx-3 sm:w-[calc(100vw-24px)] next-modal overflow-hidden",style:{width:c1},children:r.jsxs("div",{className:"flex transition-transform duration-100 ease-in-out",style:{transform:`translateX(${t}px)`},children:[r.jsx(Ev,{active:t===0,children:r.jsx(QK,{uuid:e,onChangeTab:o})}),r.jsxs(Ev,{active:t===-c1,children:[s===ec.SEARCH_USER&&r.jsx(Ak,{uuid:e,backToMainPanel:()=>n(0)}),s===ec.ALL_USERS&&r.jsx(eY,{uuid:e,backToMainPanel:()=>n(0)}),s===ec.PASSWORD&&r.jsx(ZK,{uuid:e,backToMainPanel:()=>n(0)})]})]})})},Ev=({active:e,children:t})=>r.jsx("div",{className:"flex-shrink-0",style:{width:c1},children:e&&t}),vg=({uuid:e,color:t,className:n,pos:s,showType:a="icon"})=>{const o=me(),i=gt(),l=e||i,{shared:c,illegal:u}=it(l),d=Ve(e),f=Ft(),h=_e(l,["permissions"]);if(!h)return null;const p=()=>r.jsx(tY,{uuid:l}),g=async _=>{_.stopPropagation(),_.preventDefault(),ce.event("share",{is_share:d});const x=lm(_);if(f.permissions)Jx(f.uuid);else{const{permissions:y}=h,b=y.filter(E=>E.type===m.PermissionType.USER&&E.isGuest&&E.userId).map(E=>({id:E.userId,table:"user"}));if(b.length){const{users:E}=await Ce.editor.queryRecords({requests:b});E&&ee(El.updateSpaceUsers({users:E}))}}o.dropdown({modalId:"inviteConfirmModal",popcorn:_.currentTarget||x,offset:[20,15],closeBeforeCallBack:()=>{In.emit("inviteConfirmModal")},content:p})};return a==="button"?r.jsx(je,{onClick:g,...bn(Bn.driveFileShare),colorType:c?"active":"secondary",className:B("relative flex items-center justify-center h-8 rounded text-t2-medium flex-shrink-0 whitespace-nowrap",c?"px-2":"px-3",n),children:c?"分享中":"分享"}):r.jsxs("div",{...bn(Bn.driveFileShare),onClick:g,className:B("relative flex items-center justify-center w-5 h-5 mr-5 rounded animate-hover",n),children:[r.jsx(Fe,{popup:"分享",children:r.jsx(H,{size:"middle",name:"IcTitleShare",className:c?"text-active_color":t||""})}),u&&s!=="fileItem"&&r.jsx(H,{name:"IcBadgeDanger",size:"tiny",className:"absolute -right-1 -top-1"})]})},Yd=e=>{const t=ae(({blocks:s})=>{var a;return(a=s[e])==null?void 0:a.spaceId}),n=F$(t);return ht()&&(n==null?void 0:n.isOfficialSpace)},nY={isFullscreen:!1,isUpdateReload:!1,isUpdateAvailable:!1},aF=No(()=>nY),v_=e=>{aF.setState(t=>({...t,...e}))},Lk=()=>aF(e=>e.isFullscreen),sY=()=>aF(e=>e.isUpdateReload),rY=()=>aF(e=>e.isUpdateAvailable),Pk=Wb&&un,oF=({uuid:e,style:t,className:n})=>{const s=ks(),a=nk(e),o=ke();return r.jsx(Fe,{popup:a?"取消快速访问":"添加到快速访问",className:B("flex items-center justify-center animate-hover flex-shrink-0 p-1",n),onClick:()=>{a?ce.event("favorite_cancel_pageclick"):ce.event("favorite_pageclick"),o(()=>{a?Gh(e,{parentId:le().user.currentSpaceViewId}):t6(e,{first:!0,parentId:le().user.currentSpaceViewId})}),a||s(Ae.ADD_TO_FAVORITE,We.advancedList)},children:r.jsx(H,{name:a?"IcTitleQuickAccessed":"IcQuickAccess",size:"middle",style:t,className:B(a&&"text-yellow")})})};function aY(e){return he(e).format("YYYY.MM.DD")}function yR(e){return he(e).format("YYYY-M-D H:mm")}function bR(e){if(e<=0)return"刚刚";const n=e*1/1e3,s=Math.floor(n/60);if(s===0)return"刚刚";const a=Math.floor(s/60);if(a===0)return`${s.toFixed(0)}分钟前`;const o=Math.floor(a/24);if(o===0)return`${a.toFixed(0)}小时前`;const i=Math.floor(o/30);if(i===0)return`${o.toFixed(0)}天前`;const l=Math.floor(i/12);return l===0?`${i.toFixed(0)}个月前`:`${l.toFixed(0)}年前`}const oY=e=>{if(!e)return null;const t=Date.now();return iM(e)?`今天 ${Fh(e,"HH:mm")}`:lM(e)?`昨天 ${Fh(e,"HH:mm")}`:cM(e,t)===-2?`前天 ${Fh(e,"HH:mm")}`:uM(e,t)===0?Fh(e,"M月d日 HH:mm"):Fh(e,"yyyy年M月d日")},iY=e=>ae(t=>{const{blocks:n}=t,s=n[e];return s?Y1(s.data.segments)+s.subNodes.reduce((a,o)=>n[o]?a+k2(o,n,{}):a,0):0}),ER=e=>{const t=lY(e.blockId,e.mindMapId);return r.jsx(r.Fragment,{children:t})},lY=(e,t)=>{const n=F.useCallback(s=>Ok(s,e,t),[e,t]);return ae(n)},Ok=Ai(e=>e.blocks,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{let s=-1;const a=o=>{var l;const i=e[o];i&&i.type!==m.BlockType.PDF_ANNOTATION&&(s++,!(Xt(i.type)&&n!==t)&&([m.BlockType.TABLE].includes(i.type)||(l=e[o])==null||l.subNodes.forEach(a)))};return a(t),s}),Km=({className:e,name:t,updatedAt:n,showWordCount:s})=>{var i;const a=gt(),o=xo((i=K.blocks[a])==null?void 0:i.type);return r.jsxs("div",{className:B("px-4 py-1 text-t4 text-grey3",e),children:[s&&r.jsx(cY,{pageId:a}),o&&r.jsxs("div",{children:[r.jsx("span",{children:"节点统计: "}),r.jsx(ER,{blockId:a,mindMapId:a})]}),r.jsx("div",{className:B("text-ellipsis",{"mt-3":s||o}),children:t||ni}),r.jsxs("div",{children:["最后编辑于 ",oY(n)]})]})},cY=({pageId:e})=>{const t=iY(e);return r.jsxs("div",{children:["字数统计: ",t]})},uY=async(e,t,n,s)=>{const a=await fetch(e).then(o=>o.arrayBuffer());try{const o=await dM.load(a),i=o.getPages();Object.values(s).forEach(({pageNumber:c,type:u,pdfRects:d,color:f,path:h})=>{var b;const p=i[Number(c)-1];if(!p)return;const[g,_,x]=qr(f).rgb().array();if(typeof g>"u"||typeof _>"u"||typeof x>"u")return;const y=fM(g/255,_/255,x/255);if(u===at.HIGHLIGHT||u===at.UNDERLINE||u===at.RECTANGLE||u===at.STRIKETHROUGH){if(!d)return;Object.keys(d).forEach(E=>{const w=i[Number(E)-1],k=d[E];!w||!k||k.forEach(C=>{w.drawRectangle({x:C.x,y:C.y,width:C.xMax-C.x,height:C.yMax-C.y,color:y,opacity:.4,borderWidth:0,borderOpacity:0})})})}else if(u===at.ELLIPSE){const E=(b=d==null?void 0:d[c])==null?void 0:b[0];if(!E||(h=[{x:E.x,y:E.y},{x:E.xMax,y:E.yMax}],!h))return;const[w,k]=h;if(!w||!k)return;const C=Math.abs(w.x-k.x),T=Math.abs(w.y-k.y);p.drawEllipse({x:Math.min(w.x,k.x)+C/2,y:Math.min(w.y,k.y)+T/2,xScale:C/2,yScale:T/2,color:y,opacity:.4,borderOpacity:0})}else{if(!h)return;const E=p.getHeight();let w="";h.forEach((k,C)=>{C===0?w+=`M ${k.x},${E-k.y}`:w+=` L ${k.x},${E-k.y}`}),p.moveTo(0,p.getHeight()),p.drawSvgPath(w,{color:y,opacity:.4})}}),n!==0&&i.forEach(c=>{c.setRotation(mM(n))});const l=await o.save();hM(l,t,"application/pdf")}catch(o){ye.warning("下载失败，暂不支持加密文档！")}},Ir=new jo(localStorage,"pdfPreviewStatus",50),dY=({uuid:e,pdfViewer:t})=>{var c;const n=B6(),s=me(),a=Ve(e),o=_e(e,["updatedBy","updatedAt"]),i=Yr((c=o==null?void 0:o.updatedBy)!=null?c:""),l=[{type:$.OPERATION,data:{icon:"IcArrowPageFirst",title:"跳转第一页",onClick:()=>t.currentPageNumber=1}},{type:$.OPERATION,data:{icon:"IcArrowPageLast",title:"跳转最后一页",onClick:()=>t.currentPageNumber=t.pagesCount}},{type:$.LINE},{type:$.OPERATION,data:{icon:"IcMenuSinglePage",title:"单页",onClick:()=>{var u;if(t.spreadMode=0,e){const d=(u=Ir.get(e!=null?e:""))!=null?u:{};Ir.put(e,{...d,spreadMode:t0.SINGLE})}}}},{type:$.OPERATION,data:{icon:"IcMenuDoublePage",title:"双页",onClick:()=>{var u;if(t.spreadMode=1,e){const d=(u=Ir.get(e!=null?e:""))!=null?u:{};Ir.put(e,{...d,spreadMode:t0.DOUBLE})}}}},{type:$.LINE},{type:$.OPERATION,data:{icon:"IcMenuFlipHorizontal",title:"水平翻页",onClick:()=>{var u;if(t.scrollMode=1,e){const d=(u=Ir.get(e!=null?e:""))!=null?u:{};Ir.put(e,{...d,scrollMode:e0.HORIZONTAL})}}}},{type:$.OPERATION,data:{icon:"IcMenuFlipVertical",title:"垂直翻页",onClick:()=>{var u;if(t.scrollMode=0,e){const d=(u=Ir.get(e!=null?e:""))!=null?u:{};Ir.put(e,{...d,scrollMode:e0.VERTICAL})}}}},{type:$.LINE},{type:$.OPERATION,data:{icon:"IcMenuRotateClockwise",title:"顺时针",onClick:()=>{t.pagesRotation+=90,e&&!a&&n(e,{rotation:t.pagesRotation})}}},{type:$.OPERATION,data:{icon:"IcMenuRotateAnti",title:"逆时针",onClick:()=>{t.pagesRotation-=90,e&&!a&&n(e,{rotation:t.pagesRotation})}}},{type:$.LINE,isHidden:!e},{type:$.OPERATION,isHidden:!e,data:{icon:"IcUploadDocMenu",title:"导出标注",label:r.jsx("span",{className:"bg-grey6 text-t4 text-grey3 ml-1 rounded-sm px-1.5 py-0.5",children:"限免"}),onClick:()=>{e&&s.modal({content:({onCloseModal:u})=>r.jsx(P6,{onCloseModal:u,uuid:e})})}}},{type:$.OPERATION,isHidden:!e,data:{icon:"IcMenuDownload",title:"下载含标注的 PDF",onClick:async()=>{var _,x,y,b;if(!e)return;ce.event("pdf_edited_download",{file_id:e});const{blocks:u}=le(),d=u[e];if(!d)return;const f={};d.subNodes.forEach(E=>{const w=u[E];if(!w)return;const{pdfAnnotation:k}=w.data;k&&(f[E]={...k,uuid:E})});const h=de(d.data.segments),p=(y=(x=(_=d.data.format)==null?void 0:_.pdfFormat)==null?void 0:x.rotation)!=null?y:0,g=await Ls.fetchDownloadUrl(e,(b=d.data.ossName)!=null?b:"");uY(g,h,p,f)}}},{type:$.LINE,isHidden:!e}];return r.jsxs("div",{className:"next-modal w-[200px] py-[5px]",children:[r.jsx(ze,{items:l}),o&&r.jsx(Km,{name:i,updatedAt:o.updatedAt})]})},fY=({uuid:e,className:t,pdfViewer:n})=>{const s=me(),a=o=>{s.dropdown({popcorn:o.currentTarget,placement:"bottom-start",offset:[-10,6],content:({onCloseModal:i})=>r.jsx(dY,{uuid:e,closeModal:i,pdfViewer:n})})};return r.jsx("button",{className:B("flex items-center animate-hover p-1 justify-center",t),onClick:a,children:r.jsx(H,{size:"middle",name:"IcMore"})})},wv="presentationMode",mY=({pdfViewer:e,uuid:t,className:n})=>{F.useEffect(()=>{const a=o=>{if(e.presentationModeState!==3)return;if(o.metaKey||o.ctrlKey){switch(o.keyCode){case 38:e.currentPageNumber=1;break;case 40:e.currentPageNumber=e.pagesCount;break}return}let i=0;switch(o.keyCode){case 38:case 33:i=-1;break;case 8:i=-1;break;case 37:i=-1;break;case 40:case 34:i=1;break;case 13:case 32:i=1;break;case 39:i=1;break}i!==0&&(i>0?e.nextPage():e.previousPage())};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[e]);const s=()=>{ce.event("presentation_mode",{file_id:t});const a=new pM({container:e.container,pdfViewer:e,eventBus:e.eventBus});e.eventBus.on("presentationmodechanged",({state:o})=>{var i,l;e.presentationModeState=o,o===Kz.FULLSCREEN?(i=e.viewer)==null||i.classList.add(wv):(l=e.viewer)==null||l.classList.remove(wv)}),a.request()};return r.jsx(Fe,{placement:"bottom",className:B("ml-4",n),popup:"演示",children:r.jsx("button",{className:"animate-hover p-1 flex justify-center items-center",onClick:s,children:r.jsx(H,{size:"middle",name:"IcMenuPresent"})})})};class hY{constructor(t,n){q(this,"pdfDocument");q(this,"pagesOverview");q(this,"printContainer",document.createElement("div"));q(this,"canvas",document.createElement("canvas"));q(this,"cancelPrint",!1);q(this,"onProgress");this.pdfDocument=t,this.pagesOverview=n,this.printContainer.id="printContainer",document.body.appendChild(this.printContainer)}async print(){await this.renderAllPages(),this.cancelPrint||window.print()}async renderAllPages(){var s;const t=document.querySelector("body");if(t&&t.setAttribute("data-pdfjs-printing","true"),this.pdfDocument.isPureXfa)return gM(this.printContainer,this.pdfDocument),Promise.resolve();const n=this.pagesOverview.length;for(let a=1;a<=n;a++){if(this.cancelPrint)return;(s=this.onProgress)==null||s.call(this,a,n),await this.renderPage(a),await this.convertPageToImage()}}async renderPage(t){const n=150/ep.PixelsPerInch.PDF,s=this.pagesOverview[t-1];this.canvas.width=Math.floor(s.width*n),this.canvas.height=Math.floor(s.height*n);const a=this.canvas.getContext("2d");if(!a)return;a.save(),a.fillStyle="rgb(255, 255, 255)",a.fillRect(0,0,this.canvas.width,this.canvas.height),a.restore();const o=await this.pdfDocument.getPage(t),i={canvasContext:a,transform:[n,0,0,n,0,0],viewport:o.getViewport({scale:1,rotation:s.rotation}),intent:"print",annotationMode:ep.AnnotationMode.ENABLE_STORAGE,optionalContentConfigPromise:this.pdfDocument.getOptionalContentConfig()};return o.render(i).promise}convertPageToImage(){var s;const t=document.createElement("img");"toBlob"in this.canvas?this.canvas.toBlob(a=>{t.src=URL.createObjectURL(a)}):t.src=this.canvas.toDataURL();const n=document.createElement("div");return n.className="printedPage",n.appendChild(t),(s=this.printContainer)==null||s.appendChild(n),new Promise((a,o)=>{t.onload=a,t.onerror=o})}abort(){this.cancelPrint=!0,this.destroy()}destroy(){var n;(n=this.printContainer)==null||n.remove();const t=document.querySelector("body");t&&t.removeAttribute("data-pdfjs-printing")}}const Yy="PDF-PRINT",pY=({pdfViewer:e,className:t,uuid:n})=>{const s=F.useRef(),a=me(),o=Kt(),i=F.useRef(null),l=F.useRef(null);F.useEffect(()=>{const u=()=>{var d;o(Yy),(d=s.current)==null||d.destroy()};return window.addEventListener("afterprint",u),()=>{window.removeEventListener("afterprint",u)}},[o]);const c=async()=>{if(ce.event("pdf_print",{file_id:n}),!e.pageViewsReady){window.alert("PDF 尚未载入完成！");return}a.modal({keyboard:!1,modalId:Yy,content:({onCloseModal:f})=>r.jsxs("div",{className:"flex flex-col next-modal px-[30px] w-[400px] pb-[30px]",children:[r.jsx("p",{className:"text-t1-medium mt-[30px] text-center",children:"正在准备打印文档..."}),r.jsx("p",{className:"text-t2 text-active_color",ref:i,children:"打印准备中"}),r.jsx("div",{className:"rounded-sm h-1 bg-grey5 mt-2 relative",children:r.jsx("div",{ref:l,className:"rounded-sm h-1 bg-active_color w-0"})}),r.jsx("div",{className:"flex justify-end mt-5",children:r.jsx(je,{onClick:()=>{var h;(h=s.current)==null||h.abort(),f()},children:"取消"})})]})});const u=e.getPagesOverview(),d=s.current=new hY(e.pdfDocument,u);d.onProgress=(f,h)=>{var _;const p=f/h;if(p>.99){o(Yy);return}if(!i.current||!l.current)return;i.current.innerText=`打印准备中${fa(Number(p.toFixed(2)))}`;const g=(_=l.current.parentElement)==null?void 0:_.clientWidth;g&&(l.current.style.width=`${g*p}px`)},d.print()};return r.jsx(Fe,{placement:"bottom",className:t,popup:"打印",children:r.jsx("button",{onClick:c,className:"animate-hover p-1 flex",children:r.jsx(H,{size:"middle",name:"IcMenuPrint"})})})},wR=[{name:"自动缩放",value:"auto"},{name:"实际大小",value:"page-actual"},{name:"适合页面",value:"page-fit"},{name:"适合页宽",value:"page-width"},{name:"50%",value:"0.5"},{name:"75%",value:"0.75"},{name:"100%",value:"1"},{name:"125%",value:"1.25"},{name:"150%",value:"1.5"},{name:"200%",value:"2"},{name:"300%",value:"3"},{name:"400%",value:"4"}],gY=({closeModal:e,pdfViewer:t,scale:n})=>{const s=wR.map(o=>({type:$.OPERATION,data:{title:o.name,value:o.value,arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:o.value===n}})),a=({data:o})=>{t.currentScaleValue=o.value,e()};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px] bg-white4",items:s,onItemClick:a})},_Y=({className:e,pdfViewer:t})=>{var c,u;const n=me(),[s,a]=F.useState(t.currentScaleValue),o=F.useRef(s);o.current=s,F.useEffect(()=>{t.eventBus.on("scalechanging",()=>{t.update(),o.current!==t.currentScaleValue&&a(String(t.currentScaleValue))})},[t]);const i=d=>{n.dropdown({popcorn:d.currentTarget,placement:"bottom",offset:[0,10],content:({onCloseModal:f})=>r.jsx(gY,{pdfViewer:t,closeModal:f,scale:s,setScale:a})})};let l="";return s==="auto"||s==="page-actual"||s==="page-fit"||s==="page-width"?l=(u=(c=wR.find(d=>d.value===s))==null?void 0:c.name)!=null?u:"":l=fa(Number(s),0),r.jsxs("button",{className:B("flex items-center w-20 p-1 animate-hover",e),onClick:i,children:[r.jsx("span",{className:"flex-1 mr-1 text-t2 text-ellipsis",children:l}),r.jsx(H,{size:"xxsmall",name:"IcArrow"})]})},xY=({pdfViewer:e,uuid:t,className:n})=>{const s=F.useRef(null),a=F.useRef(null),[o,i]=F.useState(!1),[l,c]=F.useState(),[u]=F.useState({highlightAll:!1,caseSensitive:!1,entireWord:!1});F.useEffect(()=>{const g=({matchesCount:x})=>{if(!a.current)return;const{current:y,total:b}=x;a.current.innerHTML=`第 ${y} 项，共匹配 ${b} 项`},_=x=>{if(!a.current)return;const{state:y,previous:b,matchesCount:E}=x;if(y===1)a.current.innerHTML="未找到";else if(y===2){const{total:w}=E;a.current.innerHTML=`第 ${b?w:1} 项，共匹配 ${w} 项`}else if(y===0){const{current:w,total:k}=E;a.current.innerHTML=`第 ${w} 项，共匹配 ${k} 项`}};e.eventBus.on("updatefindmatchescount",g),e.eventBus.on("updatefindcontrolstate",_)},[e.eventBus]);const d=(g,_=!1,x=u)=>{if(!s.current)return;const y=s.current.value.trim();e.eventBus.dispatch("find",{type:g,query:y,caseSensitive:x.caseSensitive,entireWord:x.entireWord,highlightAll:!0,findPrevious:_})},f=()=>{s.current&&d("again",!0)},h=async()=>{s.current&&d("again")},p=g=>{o?e.eventBus.dispatch("findbarclose",{}):ce.event("pdf_search",{file_id:t});const _=g.currentTarget.getBoundingClientRect();c({top:_.bottom+10,left:_.left}),i(!o)};return r.jsx(r.Fragment,{children:r.jsxs("div",{className:n,children:[r.jsx(Fe,{placement:"bottom",popup:"搜索",children:r.jsx("button",{className:"animate-hover p-1 flex",onClick:p,children:r.jsx(H,{size:"middle",name:"IcTitleSearch"})})}),o&&r.jsxs("div",{className:"w-[360px] px-1.5 pb-1.5 items-center fixed z-10 pt-3 next-modal bg-white4 -translate-x-1/3",style:{top:l==null?void 0:l.top,left:l==null?void 0:l.left},children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("div",{className:"text-t3 text-grey3",ref:a,children:"搜索"}),r.jsx("button",{className:"flex animate-hover",onClick:p,children:r.jsx(H,{size:"middle",name:"IcToastClose",className:"text-grey4"})})]}),r.jsx("div",{className:"mt-4",children:r.jsxs("div",{className:"flex items-center bg-grey9 border border-grey6 rounded-sm h-7 pl-2",children:[r.jsx(H,{name:"IcTitleSearch",className:"mr-1 w-[18px] h-[18px] text-grey4"}),r.jsx("input",{type:"text",className:"text-t2 text-black bg-transparent flex-1",placeholder:"搜索文本",ref:s,autoFocus:!0,onChange:()=>d(""),onKeyDown:g=>{be("enter")(g)&&d("again",g.shiftKey)}}),r.jsxs("div",{className:"px-2.5 flex items-center h-full text-black bg-white4 border-l",children:[r.jsx("button",{onClick:f,className:"flex items-center",children:r.jsx(H,{size:"middle",name:"IcArrowDateBack"})}),r.jsx("span",{className:"w-[1px] mx-2.5 bg-grey6 h-4"}),r.jsx("button",{onClick:h,className:"flex items-center",children:r.jsx(H,{size:"middle",name:"IcArrowDateNext"})})]})]})})]})]})})},kR=[{name:"矩形",value:at.RECTANGLE,icon:"IcPreviewRectangle"},{name:"圆形",value:at.ELLIPSE,icon:"IcPreviewEllipse"},{name:"不规则形状",value:at.POLYGON,icon:"IcPreviewShape"}],FY=({operatorType:e,closeModal:t,onChangeOperator:n})=>{const s=kR.map(o=>({type:$.OPERATION,data:{icon:o.icon,title:o.name,value:o.value,arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:o.value===e}})),a=({data:o})=>{n(o.value),t()};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:s,onItemClick:a})},yY=({className:e,operatorType:t,onChangeOperator:n})=>{var i;const s=me(),a=l=>{s.dropdown({popcorn:l.currentTarget,placement:"bottom",offset:[0,10],content:({onCloseModal:c})=>r.jsx(FY,{closeModal:c,operatorType:t,onChangeOperator:n})})},o=kR.find(l=>l.value===t);return r.jsx(Fe,{placement:"bottom",popup:"区域高亮",className:e,children:r.jsxs("button",{className:B("flex items-center animate-hover-black3 p-1",o&&"bg-black_006"),onClick:a,children:[r.jsx(H,{size:"middle",name:(i=o==null?void 0:o.icon)!=null?i:"IcPreviewSelection"}),r.jsx(H,{size:"xxsmall",name:"IcArrow",className:"ml-1"})]})})},Js=({children:e,size:t=20,className:n,onClick:s,popup:a,disabled:o})=>r.jsx(Fe,{disabled:o,popup:a,className:B("flex items-center justify-center",n),onClick:s,style:{width:t,height:t},children:e}),kv=[{name:"文字目录",type:Ca.CATALOGUE},{name:"缩略图目录",type:Ca.THUMBNAIL_VIEW},{name:"高亮标注",type:Ca.ANNOTATION},{name:"隐藏边栏",type:Ca.NONE}],bY=({uuid:e,closeModal:t,sideBarViews:n})=>{var c,u;const s=(c=Ir.get(e!=null?e:""))!=null?c:{},[a,o]=F.useState((u=s==null?void 0:s.sideBarType)!=null?u:Ca.THUMBNAIL_VIEW),i=n.map(d=>({type:$.OPERATION,data:{title:d.name,type:d.type,arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:d.type===a}})),l=({data:d})=>{In.emit("sidebarType",d.type),o(d.type),t()};return r.jsx(ze,{className:"next-modal w-[160px] py-[5px] bg-white4",items:i,onItemClick:l})},EY=({uuid:e,className:t,pdfViewer:n})=>{const s=me(),a=e?kv:kv.filter(c=>c.type!==Ca.ANNOTATION),[o,i]=F.useState(a);F.useEffect(()=>{n.pdfDocument&&n.pdfDocument.getOutline().then(c=>{(!c||(c==null?void 0:c.length)===0)&&i(a.slice(1))}).catch(c=>{console.log(c)})},[a,n.pdfDocument]);const l=c=>{s.dropdown({popcorn:c.currentTarget,placement:"bottom-start",offset:[0,10],content:({onCloseModal:u})=>r.jsx(bY,{sideBarViews:o,uuid:e,closeModal:u})})};return r.jsxs(r.Fragment,{children:[un&&r.jsx(Js,{size:26,className:"mr-1 animate-hover",popup:"后退",onClick:()=>{Bs(Rt.main)},children:r.jsx(H,{size:"xlarge",name:"IcArrowBack"})}),r.jsx(Fe,{placement:"bottom",popup:"侧边栏",children:r.jsxs("button",{className:B("flex items-center animate-hover p-1",t),onClick:l,children:[r.jsx(H,{size:"middle",name:"IcPreviewCatalog"}),r.jsx(H,{size:"xxsmall",name:"IcArrow",className:"ml-1"})]})})]})},wY=e=>{const{pdfViewer:t,uuid:n,embed:s}=e,a=Lk(),{illegal:o,allowDuplicate:i}=it(n),l=Ve(n),c=_e(n,["data"],["ossName","segments","size"]),u=Cr(),d=ht(),f=o?rs:de(c==null?void 0:c.data.segments),h=Yd(n!=null?n:""),p=nk(n!=null?n:""),g=Pk&&!a,_=i&&!h&&!o,x=async()=>{var b;if(!n||!c)return;const y=await Ls.fetchDownloadUrl(n,(b=c.data.ossName)!=null?b:"",f);window.open(y)};return r.jsxs("div",{className:"flex items-center justify-between h-[55px] border-b border-grey6 bg-white3 text-black px-4 relative overflow-x-auto",children:[r.jsxs("div",{className:B("flex items-center mr-1",g&&"ml-16"),children:[r.jsx(EY,{pdfViewer:t,uuid:n}),!s&&c&&r.jsx(Bl,{fileName:f,className:"text-t2 ml-4 max-w-[300px]",addonAfter:u?null:r.jsx("span",{className:"ml-2 text-grey3",children:es(c.data.size)})})]}),r.jsx(kY,{...e}),r.jsxs("div",{className:"flex h-full items-center",children:[r.jsx(xY,{uuid:n,pdfViewer:t,className:"ml-4"}),!s&&n&&r.jsxs(r.Fragment,{children:[!d&&!o&&!h&&r.jsx(vg,{showType:"button",className:"ml-4",uuid:n,color:"text-white"}),_&&r.jsx(Fe,{popup:"下载",className:"ml-4",children:r.jsx("button",{className:"animate-hover-black3 p-1 flex justify-center items-center",onClick:x,children:r.jsx(H,{name:"IcMenuDownload",size:"middle"})})}),!d&&!o&&r.jsx(oF,{uuid:n,style:{color:p?to.yellow:void 0},className:"ml-4"})]}),r.jsx(mY,{uuid:n,pdfViewer:t,className:"ml-4"}),_&&r.jsx(pY,{pdfViewer:t,uuid:n,className:"ml-4"}),!l&&r.jsx(fY,{uuid:n,pdfViewer:t,className:"ml-4"})]})]})},kY=e=>{const{pdfViewer:t,application:n,embed:s,uuid:a}=e,o=Ve(a),i=F.useRef(null),[l,c]=F.useState(!1),[u,d]=F.useState(!1),[f,h]=F.useState(t.currentPageNumber),[p,g]=F.useState(at.NONE);F.useEffect(()=>{n.onHistoryChange=T=>{c(T.redoStack.length>0),d(T.undoStack.length>0)}},[n]),F.useEffect(()=>{t.eventBus.on("pagechanging",()=>{const{pdfThumbnailViewer:T}=t.renderingQueue;T.scrollThumbnailIntoView(t.currentPageNumber),h(t.currentPageNumber)})},[]);const _=T=>{if(be("enter")(T)){const v=Number(f);v&&v<=t.pagesCount&&v>0?t.linkService.goToPage(v):h(t.currentPageNumber)}},x=T=>{In.emit("pdfCursor",T),g(T),T===at.MOVE?n.pdfCursorTools.switchTool(n.pdfCursorTools.active===0?1:0):n.pdfCursorTools.switchTool(0)},y=()=>t.increaseScale(),b=()=>t.decreaseScale(),E=()=>t.previousPage(),w=()=>t.nextPage(),k=()=>{ee(Dm()),n.redo()},C=()=>{ee(Ad()),n.undo()};return r.jsxs("div",{className:"flex h-full items-center overflow-auto",children:[r.jsxs("div",{className:"flex",children:[r.jsx(Fe,{placement:"bottom",popup:"上一页",children:r.jsx("button",{onClick:E,className:B("animate-hover-black3 p-1 flex justify-center items-center"),children:r.jsx(H,{size:"middle",name:"IcArrowDateBack"})})}),r.jsxs("div",{className:"flex rounded-sm bg-black/5 items-center pr-2 mx-2 text-t4",children:[r.jsx("input",{ref:i,type:"number",className:"w-[30px] mx-0.5 overflow-hidden h-full border-none bg-transparent px-0 text-center focus:border-0",style:{backgroundColor:"transparent"},value:f,onKeyDown:_,onChange:T=>h(T.target.value)}),r.jsx("span",{className:"w-1.5 flex justify-center",children:"/"}),r.jsx("span",{className:"w-[30px] flex justify-center",children:t.pagesCount})]}),r.jsx(Fe,{placement:"bottom",popup:"下一页",children:r.jsx("button",{onClick:w,className:B("animate-hover-black3 p-1 flex justify-center items-center"),children:r.jsx(H,{size:"middle",name:"IcArrowDateNext"})})})]}),r.jsx("span",{className:"min-w-[1px] mx-4 bg-grey6 h-4"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx(Fe,{placement:"bottom",popup:"放大",children:r.jsx("button",{onClick:y,className:B("animate-hover-black3 p-1 flex justify-center items-center"),children:r.jsx(H,{size:"middle",name:"IcPreviewZoomIn"})})}),r.jsx(Fe,{placement:"bottom",className:"ml-4",popup:"缩小",children:r.jsx("button",{onClick:b,className:B("animate-hover-black3 p-1 flex justify-center items-center"),children:r.jsx(H,{size:"middle",name:"IcPreviewZoomOut"})})})]}),r.jsx("span",{className:"min-w-[1px] mx-4 bg-grey6 h-4"}),r.jsx(_Y,{pdfViewer:t}),r.jsx("span",{className:"min-w-[1px] mx-4 bg-grey6 h-4"}),r.jsx(Fe,{placement:"bottom",popup:"文本选择",children:r.jsx("button",{onClick:()=>x(at.NONE),className:B("animate-hover-black3 p-1 flex justify-center items-center",p===at.NONE&&"bg-black_006"),children:r.jsx(H,{size:"middle",name:"IcPreviewCursor"})})}),r.jsx(Fe,{placement:"bottom",className:"ml-4",popup:"抓手工具",children:r.jsx("button",{onClick:()=>x(at.MOVE),className:B("animate-hover-black3 p-1 flex justify-center items-center",p===at.MOVE&&"bg-black_006"),children:r.jsx(H,{size:"middle",name:"IcPreviewMove"})})}),a&&!o&&!s&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"min-w-[1px] mx-4 bg-grey6 h-4"}),r.jsx(Fe,{placement:"bottom",popup:"文字高亮",children:r.jsx("button",{onClick:()=>x(at.HIGHLIGHT),className:B("animate-hover-black3 p-1 flex justify-center items-center",p===at.HIGHLIGHT&&"bg-black_006"),children:r.jsx(H,{size:"middle",name:"IcPreviewCursorText"})})}),r.jsx(yY,{operatorType:p,onChangeOperator:x,className:"ml-4"}),r.jsx(OW,{pdfViewer:t,className:"ml-4"}),r.jsx(Fe,{placement:"bottom",className:"ml-4",popup:"橡皮擦",children:r.jsx("button",{onClick:()=>x(at.ERASER),className:B("animate-hover-black3 p-1 flex justify-center items-center",p===at.ERASER&&"bg-black_006"),children:r.jsx(H,{size:"middle",name:"IcPreviewEraser"})})}),r.jsx("span",{className:"min-w-[1px] mx-4 bg-grey6 h-4"}),r.jsx(Fe,{placement:"bottom",popup:"撤销",children:r.jsx("button",{className:B("animate-hover-black3 p-1 flex justify-center items-center",!u&&"opacity-30 cursor-not-allowed"),disabled:!u,onClick:C,children:r.jsx(H,{size:"middle",name:"IcMenuUndo"})})}),r.jsx(Fe,{placement:"bottom",className:"ml-4",popup:"重做",children:r.jsx("button",{className:B("animate-hover-black3 p-1 flex justify-center items-center",!l&&"opacity-30 cursor-not-allowed"),disabled:!l,onClick:k,children:r.jsx(H,{size:"middle",name:"IcMenuRedo"})})})]})]})},Cv=2,Tv=3,vv=0,CY=180;var Qf;class Mk{static getCanvas(t,n){const s=Ty(this,Qf)||vy(this,Qf,document.createElement("canvas"));s.width=t,s.height=n;const a=s.getContext("2d",{alpha:!1});return a.save(),a.fillStyle="rgb(255, 255, 255)",a.fillRect(0,0,t,n),a.restore(),[s,s.getContext("2d")]}static destroyCanvas(){const t=Ty(this,Qf);t&&(t.width=0,t.height=0),vy(this,Qf,null)}}Qf=new WeakMap,h_(Mk,Qf,null);class TY{constructor({container:t,id:n,defaultViewport:s,optionalContentConfigPromise:a,linkService:o,renderingQueue:i,checkSetImageDisabled:l,l10n:c}){this.id=n,this.renderingId="thumbnail"+n,this.pageLabel=null,this.pdfPage=null,this.rotation=0,this.viewport=s,this.pdfPageRotate=s.rotation,this._optionalContentConfigPromise=a||null,this.linkService=o,this.renderingQueue=i,this.renderTask=null,this.renderingState=ya.INITIAL,this.resume=null,this._checkSetImageDisabled=l||function(){return!1};const u=this.viewport.width,d=this.viewport.height,f=u/d;this.canvasWidth=CY,this.canvasHeight=this.canvasWidth/f|0,this.scale=this.canvasWidth/u,this.l10n=c;const h=document.createElement("a");h.href=o.getAnchorUrl("#page="+n),this._thumbPageTitle.then(x=>{h.title=x}),h.onclick=function(){return o.goToPage(n),!1},this.anchor=h;const p=document.createElement("div");p.className="thumbnail",p.setAttribute("data-page-number",this.id),this.div=p;const g=document.createElement("div");g.className="thumbnailSelectionRing";const _=2*vv;g.style.width=this.canvasWidth+_+"px",g.style.height=this.canvasHeight+_+"px",this.ring=g,p.appendChild(g),h.appendChild(p),t.appendChild(h)}setPdfPage(t){this.pdfPage=t,this.pdfPageRotate=t.rotate;const n=(this.rotation+this.pdfPageRotate)%360;this.viewport=t.getViewport({scale:1,rotation:n}),this.reset()}reset(){this.cancelRendering(),this.renderingState=ya.INITIAL;const t=this.viewport.width,n=this.viewport.height,s=t/n;this.canvasHeight=this.canvasWidth/s|0,this.scale=this.canvasWidth/t,this.div.removeAttribute("data-loaded");const a=this.ring;a.textContent="";const o=2*vv;a.style.width=this.canvasWidth+o+"px",a.style.height=this.canvasHeight+o+"px",this.canvas&&(this.canvas.width=0,this.canvas.height=0,delete this.canvas),this.image&&(this.image.removeAttribute("src"),delete this.image)}update({rotation:t=null}){typeof t=="number"&&(this.rotation=t);const n=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:1,rotation:n}),this.reset()}cancelRendering(){this.renderTask&&(this.renderTask.cancel(),this.renderTask=null),this.resume=null}_getPageDrawContext(t=1){const n=document.createElement("canvas"),s=n.getContext("2d",{alpha:!1}),a=new _M;n.width=t*this.canvasWidth*a.sx|0,n.height=t*this.canvasHeight*a.sy|0;const o=a.scaled?[a.sx,0,0,a.sy,0,0]:null;return{ctx:s,canvas:n,transform:o}}_convertCanvasToImage(t){if(this.renderingState!==ya.FINISHED)throw new Error("_convertCanvasToImage: Rendering has not finished.");const n=this._reduceImage(t),s=document.createElement("img");s.className="thumbnailImage",this._thumbPageCanvas.then(a=>{s.setAttribute("aria-label",a)}),s.style.width=this.canvasWidth+"px",s.style.height=this.canvasHeight+"px",s.src=n.toDataURL(),this.image=s,this.div.setAttribute("data-loaded",!0),this.ring.appendChild(s),n.width=0,n.height=0}draw(){if(this.renderingState!==ya.INITIAL)return console.error("Must be in new state before drawing"),Promise.resolve();const{pdfPage:t}=this;if(!t)return this.renderingState=ya.FINISHED,Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=ya.RUNNING;const n=async(f=null)=>{if(u===this.renderTask&&(this.renderTask=null),!(f instanceof ep.RenderingCancelledException)&&(this.renderingState=ya.FINISHED,this._convertCanvasToImage(a),f))throw f},{ctx:s,canvas:a,transform:o}=this._getPageDrawContext(Cv),i=this.viewport.clone({scale:Cv*this.scale}),l=f=>{if(!this.renderingQueue.isHighestPriority(this)){this.renderingState=ya.PAUSED,this.resume=()=>{this.renderingState=ya.RUNNING,f()};return}f()},c={canvasContext:s,transform:o,viewport:i,optionalContentConfigPromise:this._optionalContentConfigPromise},u=this.renderTask=t.render(c);u.onContinue=l;const d=u.promise.then(function(){return n(null)},function(f){return n(f)});return d.finally(()=>{var h;a.width=0,a.height=0,this.linkService.isPageCached(this.id)||(h=this.pdfPage)==null||h.cleanup()}),d}setImage(t){if(this._checkSetImageDisabled()||this.renderingState!==ya.INITIAL)return;const{canvas:n,pdfPage:s}=t;n&&(this.pdfPage||this.setPdfPage(s),this.renderingState=ya.FINISHED,this._convertCanvasToImage(n))}_reduceImage(t){const{ctx:n,canvas:s}=this._getPageDrawContext();if(t.width<=2*s.width)return n.drawImage(t,0,0,t.width,t.height,0,0,s.width,s.height),s;let a=s.width<<Tv,o=s.height<<Tv;const[i,l]=Mk.getCanvas(a,o);for(;a>t.width||o>t.height;)a>>=1,o>>=1;for(l.drawImage(t,0,0,t.width,t.height,0,0,a,o);a>2*s.width;)l.drawImage(i,0,0,a,o,0,0,a>>1,o>>1),a>>=1,o>>=1;return n.drawImage(i,0,0,a,o,0,0,s.width,s.height),s}get _thumbPageTitle(){var t;return this.l10n.get("thumb_page_title",{page:(t=this.pageLabel)!=null?t:this.id})}get _thumbPageCanvas(){var t;return this.l10n.get("thumb_page_canvas",{page:(t=this.pageLabel)!=null?t:this.id})}setPageLabel(t){this.pageLabel=typeof t=="string"?t:null,this._thumbPageTitle.then(n=>{this.anchor.title=n}),this.renderingState===ya.FINISHED&&this._thumbPageCanvas.then(n=>{var s;(s=this.image)==null||s.setAttribute("aria-label",n)})}}const vY=-19,Xy="selected";var Y0,CR,X0,TR;class NY{constructor({container:t,eventBus:n,linkService:s,renderingQueue:a,l10n:o}){h_(this,Y0);h_(this,X0);this.container=t,this.linkService=s,this.renderingQueue=a,this.l10n=o,this.scroll=xM(this.container,this._scrollUpdated.bind(this)),this._resetView(),n._on("optionalcontentconfigchanged",()=>{this._setImageDisabled=!0})}_scrollUpdated(){this.renderingQueue.renderHighestPriority()}getThumbnail(t){return this._thumbnails[t]}_getVisibleThumbs(){return FM({scrollEl:this.container,views:this._thumbnails})}scrollThumbnailIntoView(t){if(!this.pdfDocument)return;const n=this._thumbnails[t-1];if(!n){console.error('scrollThumbnailIntoView: Invalid "pageNumber" parameter.');return}t!==this._currentPageNumber&&(this._thumbnails[this._currentPageNumber-1].div.classList.remove(Xy),n.div.classList.add(Xy));const{first:s,last:a,views:o}=this._getVisibleThumbs();if(o.length>0){let i=!1;if(t<=s.id||t>=a.id)i=!0;else for(const{id:l,percent:c}of o)if(l===t){i=c<100;break}i&&yM(n.div,{top:vY})}this._currentPageNumber=t}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!bM(t))throw new Error("Invalid thumbnails rotation angle.");if(!this.pdfDocument||this._pagesRotation===t)return;this._pagesRotation=t;const n={rotation:t};for(const s of this._thumbnails)s.update(n)}cleanup(){for(const t of this._thumbnails)t.renderingState!==ya.FINISHED&&t.reset();Mk.destroyCanvas()}_resetView(){this._thumbnails=[],this._currentPageNumber=1,this._pageLabels=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._setImageDisabled=!1,this.container.textContent=""}setDocument(t){if(this.pdfDocument&&(this._cancelRendering(),this._resetView()),this.pdfDocument=t,!t)return;const n=t.getPage(1),s=t.getOptionalContentConfig();n.then(a=>{this._optionalContentConfigPromise=s;const o=t.numPages,i=a.getViewport({scale:1}),l=()=>this._setImageDisabled;for(let d=1;d<=o;++d){const f=new TY({container:this.container,id:d,defaultViewport:i.clone(),optionalContentConfigPromise:s,linkService:this.linkService,renderingQueue:this.renderingQueue,checkSetImageDisabled:l,l10n:this.l10n});this._thumbnails.push(f)}const c=this._thumbnails[0];c&&c.setPdfPage(a),this._thumbnails[this._currentPageNumber-1].div.classList.add(Xy)}).catch(a=>{console.error("Unable to initialize thumbnail viewer",a)})}_cancelRendering(){for(const t of this._thumbnails)t.cancelRendering()}setPageLabels(t){var n,s;if(this.pdfDocument){t?Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:(this._pageLabels=null,console.error("PDFThumbnailViewer_setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let a=0,o=this._thumbnails.length;a<o;a++)this._thumbnails[a].setPageLabel((s=(n=this._pageLabels)==null?void 0:n[a])!=null?s:null)}}forceRendering(){const t=this._getVisibleThumbs(),n=Ny(this,X0,TR).call(this,t),s=this.renderingQueue.getHighestPriority(t,this._thumbnails,n);return s?(Ny(this,Y0,CR).call(this,s).then(()=>{this.renderingQueue.renderView(s)}),!0):!1}}Y0=new WeakSet,CR=async function(t){if(t.pdfPage)return t.pdfPage;try{const n=await this.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(n),n}catch(n){return console.error("Unable to get page for thumb view",n),null}},X0=new WeakSet,TR=function(t){var n,s;return((n=t.first)==null?void 0:n.id)===1?!0:((s=t.last)==null?void 0:s.id)===this._thumbnails.length?!1:this.scroll.down};const dm=()=>window.devicePixelRatio,l0=e=>{let t=1/0,n=1/0,s=0,a=0;return e.forEach(o=>{o.x<t&&(t=o.x),o.y<n&&(n=o.y),o.x>s&&(s=o.x),o.y>a&&(a=o.y)}),{left:t,top:n,right:s,bottom:a,width:s-t,height:a-n}};var c0=(e=>(e[e.RECTANGLE=0]="RECTANGLE",e[e.POLYGON=1]="POLYGON",e[e.ELLIPSE=2]="ELLIPSE",e))(c0||{});const IY=async(e,t,n)=>{const s=document.createElement("canvas");s.width=e.width,s.height=e.height;const a=s.getContext("2d");if(!a)return;a.putImageData(e,0,0);const o=s.toDataURL();return t?await jY(o,t,n):o},jY=async(e,t,n=1)=>{const s=o=>{const i=new Image,l=()=>{const c=document.createElement("canvas");c.width=i.width,c.height=i.height;const u=c.getContext("2d");if(!u){o(void 0);return}const{left:d,top:f}=l0(t),h=dm();if(t=t.map(g=>({x:(g.x-d)*h,y:(g.y-f)*h})),u.beginPath(),n===2){const[g,_]=t;if(!g||!_)return;const{x,y}=g,{x:b,y:E}=_,w=Math.abs(b-x),k=Math.abs(E-y),C=Math.min(b,x)+w/2,T=Math.min(E,y)+k/2;u.ellipse(C,T,w/2,k/2,0,0,2*Math.PI)}else t.forEach((g,_)=>{_===0?u.moveTo(g.x,g.y):u.lineTo(g.x,g.y)});u.closePath(),u.clip(),u.drawImage(i,0,0);const p=c.toDataURL();o(p)};i.onload=l,i.src=e};return await new Promise(s)},Uk=async(e,t,n,s)=>{const a=e.width/e.clientWidth,o=e.getContext("2d");if(!o)return;const{x:i,y:l,width:c,height:u}=t,d=o.getImageData(i*a,l*a,c*a,u*a);return await IY(d,n,s)},Hf=(e,t,n,s)=>{const a=e.getContext("2d");if(!a)return;const{x:o,y:i}=t,{x:l,y:c}=n,u=Math.abs(l-o),d=Math.abs(c-i),f=Math.min(l,o)+u/2,h=Math.min(c,i)+d/2;s!=null&&s.fillStyle&&(a.fillStyle=s.fillStyle),s!=null&&s.lineWidth&&(a.lineWidth=s.lineWidth),a.beginPath(),a.ellipse(f,h,u/2,d/2,0,0,2*Math.PI),a.fill()},Mu=(e,t,n)=>{n&&(n!=null&&n.lineWidth&&(e.lineWidth=n==null?void 0:n.lineWidth),n!=null&&n.strokeStyle&&(e.strokeStyle=n==null?void 0:n.strokeStyle),n!=null&&n.fillStyle&&(e.fillStyle=n==null?void 0:n.fillStyle),n!=null&&n.lineCap&&(e.lineCap=n==null?void 0:n.lineCap),n!=null&&n.lineJoin&&(e.lineJoin=n==null?void 0:n.lineJoin));const s=a=>{e.beginPath(),e.arc(a.x,a.y,5,0,2*Math.PI),e.fill()};(n==null?void 0:n.joinShape)==="round"&&(t.forEach(s),e.lineJoin="round"),e.beginPath(),t.forEach((a,o)=>{o===0?e.moveTo(a.x,a.y):e.lineTo(a.x,a.y)}),n!=null&&n.closePath&&e.closePath(),n!=null&&n.isFill?e.fill():e.stroke()},Nv=e=>{const{source:t,onResizeEnd:n,onResizing:s,container:a=document.body}=e,o=document.createElement("div");o.classList.add("resizeContainer"),o.style.cursor="move",o.innerHTML=`
    <div style="position: absolute; user-select: none; width: 100%; height: 10px; top: -5px; left: 0px; cursor: row-resize;"></div>
    <div style="position: absolute; user-select: none; width: 10px; height: 100%; top: 0px; right: -5px; cursor: col-resize;"></div>
    <div style="position: absolute; user-select: none; width: 100%; height: 10px; bottom: -5px; left: 0px; cursor: row-resize;"></div>
    <div style="position: absolute; user-select: none; width: 10px; height: 100%; top: 0px; left: -5px; cursor: col-resize;"></div>
    <div style="position: absolute; user-select: none; width: 20px; height: 20px; right: -10px; top: -10px; cursor: ne-resize;"></div>
    <div style="position: absolute; user-select: none; width: 20px; height: 20px; right: -10px; bottom: -10px; cursor: se-resize;"></div>
    <div style="position: absolute; user-select: none; width: 20px; height: 20px; left: -10px; bottom: -10px; cursor: sw-resize;"></div>
    <div style="position: absolute; user-select: none; width: 20px; height: 20px; left: -10px; top: -10px; cursor: nw-resize;"></div>
  `;const i=l=>{if(l.button!==0)return;l.stopPropagation(),l.preventDefault();const c=l.target,{cursor:u}=c.style,d={x:l.clientX,y:l.clientY},f={x:parseInt(t.style.left,10),y:parseInt(t.style.top,10),width:parseInt(t.style.width,10),height:parseInt(t.style.height,10),bottom:parseInt(t.style.height,10)+parseInt(t.style.top,10),right:parseInt(t.style.width,10)+parseInt(t.style.left,10)},h=a.getBoundingClientRect(),p=_=>{const x=Zn(_.clientY,h.top,h.bottom),b=Zn(_.clientX,h.left,h.right)-d.x,E=x-d.y,w=()=>{const j=Zn(f.y+E,0,f.bottom);t.style.top=`${j}px`,t.style.height=`${Math.abs(f.height-E)}px`},k=()=>{const j=E<0&&Math.abs(E)>f.height?f.y-(Math.abs(E)-f.height):f.y;t.style.top=`${j}px`,t.style.height=`${Math.abs(f.height+E)}px`},C=()=>{const j=Zn(f.x+b,0,f.right);t.style.left=`${j}px`,t.style.width=`${Math.abs(f.width-b)}px`},T=()=>{const j=b<0&&Math.abs(b)>f.width?f.x-(Math.abs(b)-f.width):f.x;t.style.left=`${j}px`,t.style.width=`${Math.abs(f.width+b)}px`},v=()=>{const j=Zn(f.y+E,0,h.height-f.height),D=Zn(f.x+b,0,h.width-f.width);t.style.top=`${j}px`,t.style.left=`${D}px`};switch(u){case"row-resize":{c.style.top?w():k();break}case"col-resize":{c.style.left?C():T();break}case"ne-resize":{w(),T();break}case"se-resize":{T(),k();break}case"sw-resize":{C(),k();break}case"nw-resize":{w(),C();break}case"move":{v();break}}const I={x:parseInt(t.style.left,10),y:parseInt(t.style.top,10),width:parseInt(t.style.width,10),height:parseInt(t.style.height,10)};s==null||s(I)},g=()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g);const _={x:parseInt(t.style.left,10),y:parseInt(t.style.top,10),width:parseInt(t.style.width,10),height:parseInt(t.style.height,10)};Math.abs(_.x-f.x)<2&&Math.abs(_.y-f.y)<2&&Math.abs(_.width*_.height-f.width*f.height)<4||n==null||n(_)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)};o.addEventListener("mousedown",i),t.appendChild(o)};class DY{constructor(t,n,s,a,o,i){q(this,"containers",{});q(this,"remove",()=>{Object.values(this.containers).forEach(t=>{t.removeEventListener("click",this.handleClick),t.remove()})});q(this,"update",t=>{this.annotation=t,Object.values(this.containers).forEach(n=>{for(;n.firstChild;)n.removeChild(n.firstChild)}),this.renderAnnotation(t)});q(this,"handleClick",()=>{this.getAnnotationType()===at.ERASER&&(this.onDeleteAnnotation(this.annotation,!1),this.remove())});q(this,"renderAnnotation",t=>{const{type:n}=t;n===at.RECTANGLE||n===at.HIGHLIGHT||n===at.UNDERLINE||n===at.STRIKETHROUGH?this.renderRect():(n===at.POLYGON||n===at.ELLIPSE)&&this.renderShape()});q(this,"renderRect",()=>{const{type:t,pdfRects:n,color:s}=this.annotation;n&&Object.keys(n).forEach(a=>{const{viewport:o,div:i}=this.pdfViewer.getPageView(Number(a)-1),l=n[a];if(!l)return;Xz(l,o).forEach(u=>{var f;const d=document.createElement("div");d.style.cssText=`
          position: absolute;
          left: ${u.width>0?u.x:u.x-Math.abs(u.width)}px;
          width: ${Math.abs(u.width)}px;
          background: ${qr(s).alpha(.4).toString()};
        `,t===at.UNDERLINE?(d.style.top=`${u.y+u.height}px`,d.style.height="2px"):t===at.STRIKETHROUGH?(d.style.top=`${u.y+u.height/2}px`,d.style.height="2px"):(d.style.top=`${u.height>0?u.y:u.y-Math.abs(u.height)}px`,d.style.height=`${Math.abs(u.height)}px`,d.style.background=`${qr(s).alpha(.4).toString()}`,t===at.RECTANGLE&&Nv({source:d,onResizeEnd:async p=>{const g=await this.getBlobUrl(Number(a),p),_={...this.annotation,url:g,width:p.width,height:p.height,pdfRects:{[a]:w6([p],o)}};this.annotation=_,this.onUpdateAnnotation(_,!1)},container:i})),(f=this.containers[a])==null||f.appendChild(d)})})});q(this,"renderShape",()=>{var k;const{pageNumber:t,pdfRects:n,type:s,color:a}=this.annotation;let{path:o}=this.annotation;const i=s===at.ELLIPSE,l=s===at.POLYGON;if(i){const C=(k=n==null?void 0:n[t])==null?void 0:k[0];if(!C)return;o=[{x:C.x,y:C.y},{x:C.xMax,y:C.yMax}]}if(!o)return;const{viewport:c,div:u}=this.pdfViewer.getPageView(t-1),d=document.createElement("canvas"),f=o.map(C=>{const[T,v]=c.convertToViewportPoint(C.x,C.y);return{x:T,y:v}}),h=l0(f),p=dm();d.width=h.width*p,d.height=h.height*p,d.style.width=`${h.width}px`,d.style.height=`${h.height}px`;const g=this.containers[t];if(!g)return;g.style.cssText=`
      position: absolute;
      left: ${h.left}px;
      top: ${h.top}px;
      width: ${h.width}px;
      height: ${h.height}px;
    `,g.appendChild(d);const _=d.getContext("2d");if(!_)return;_.scale(p,p),_.fillStyle=qr(a).alpha(.4).toString();const x=[],y=f.map(C=>{const T={x:C.x-h.left,y:C.y-h.top};return x.push({x:T.x/h.width,y:T.y/h.height}),T});if(l)Mu(_,y,{closePath:!0,isFill:!0});else{const[C,T]=y;if(!C||!T)return;Hf(d,C,T)}const b=f;Nv({source:g,onResizeEnd:async C=>{const{pageNumber:T,color:v}=this.annotation,I=dm(),j=[],D=b.map((P,M)=>{const U=x[M];if(U)return j.push({x:U.x*C.width,y:U.y*C.height}),{x:C.x+U.x*C.width,y:C.y+U.y*C.height}}).filter(P=>!!P),S=d.getContext("2d");if(!S)return;if(S.clearRect(0,0,d.width,d.height),d.width=C.width*I,d.height=C.height*I,d.style.width=`${C.width}px`,d.style.height=`${C.height}px`,S.fillStyle=qr(v).alpha(.4).toString(),S.scale(I,I),l)Mu(S,j,{closePath:!0,isFill:!0});else{const[P,M]=j;if(!P||!M)return;Hf(d,P,M)}const R=await this.getBlobUrl(T,C,D,l?c0.POLYGON:c0.ELLIPSE),A=D.map(P=>{const[M,U]=c.convertToPdfPoint(P.x,P.y);return{x:M,y:U}}),L={...this.annotation,url:R,width:C.width,height:C.height};if(i){const P=A[0],M=A[1];if(!P||!M)return;const U={x:Math.min(P.x,M.x),y:Math.max(P.y,M.y)},V={x:Math.max(P.x,M.x),y:Math.min(P.y,M.y)};L.pdfRects={[String(T)]:[{x:U.x,y:U.y,xMax:V.x,yMax:V.y}]}}else L.path=A;this.annotation=L,this.onUpdateAnnotation(L,!1)},onResizing:C=>{d.width=C.width*p,d.height=C.height*p,d.style.width=`${C.width}px`,d.style.height=`${C.height}px`;const T=d.getContext("2d");if(!T)return;T.clearRect(0,0,d.width,d.height),T.scale(p,p),T.fillStyle=qr(a).alpha(.4).toString();const v=[];if(b.forEach((I,j)=>{const D=x[j];D&&v.push({x:D.x*C.width,y:D.y*C.height})}),l)Mu(T,v,{closePath:!0,isFill:!0});else{const[I,j]=v;if(!I||!j)return;Hf(d,I,j)}},container:u})});q(this,"getBlobUrl",async(t,n,s,a)=>{if(!this.pdfViewer)return;const{canvas:o}=this.pdfViewer.getPageView(t-1);return Uk(o,n,s,a)});q(this,"getAnnotationLayer",t=>{const{div:n}=this.pdfViewer.getPageView(t-1);let s=n.querySelector(".next-space-annotationLayer");return s||(s=document.createElement("div"),s.className="next-space-annotationLayer",n.appendChild(s)),s});var c;this.pdfViewer=t,this.annotation=n,this.getAnnotationType=s,this.onUpdateAnnotation=a,this.onDeleteAnnotation=o,this.onContextMenu=i;let l=[n.pageNumber];n.type===at.HIGHLIGHT&&(l=Object.keys((c=n.pdfRects)!=null?c:{}).map(Number)),l.forEach(u=>{const d=document.createElement("div");this.containers[u]=d,d.addEventListener("click",this.handleClick),d.addEventListener("contextmenu",h=>{var p;(p=this.onContextMenu)==null||p.call(this,h,this.annotation)});const f=this.getAnnotationLayer(u);f&&f.appendChild(d)}),this.renderAnnotation(n)}}class SY{constructor(t){q(this,"delay",1e3);q(this,"maxStack",100);q(this,"userOnly",!1);q(this,"lastRecorded",0);q(this,"redoStack",[]);q(this,"undoStack",[]);this.pdfApplication=t}record(t,n){var a,o;const s=this.inverse(t,n);s&&(this.undoStack.push(s),(o=(a=this.pdfApplication)==null?void 0:a.onHistoryChange)==null||o.call(a,this))}inverse(t,n){switch(t.type){case Ga.ADD:return{type:Ga.DELETE,uuid:t.uuid};case Ga.DELETE:return{type:Ga.ADD,uuid:t.uuid};case Ga.UPDATE:{if(!t.patch)return;const s=gl(n,Object.keys(t.patch));return{type:Ga.UPDATE,uuid:t.uuid,patch:s}}}}redo(){var s,a;const t=this.redoStack.pop();if(!t)return;const n=this.inverse(t,this.pdfApplication.annotations[t==null?void 0:t.uuid]);n&&(this.undoStack.push(n),this.undoStack.length>this.maxStack&&this.undoStack.shift()),(a=(s=this.pdfApplication)==null?void 0:s.onHistoryChange)==null||a.call(s,this),this.pdfApplication.applyOP(t)}undo(){var s,a,o;const t=this.undoStack.pop();if(!t)return;const n=this.inverse(t,this.pdfApplication.annotations[(s=t==null?void 0:t.uuid)!=null?s:""]);n&&(this.redoStack.push(n),this.redoStack.length>this.maxStack&&this.redoStack.shift()),(o=(a=this.pdfApplication)==null?void 0:a.onHistoryChange)==null||o.call(a,this),this.pdfApplication.applyOP(t)}clear(){this.redoStack=[],this.undoStack=[]}}function RY(e,t){var n,s;try{const a=(s=(n=t.nodeValue)==null?void 0:n.length)!=null?s:t.childNodes.length;return e.comparePoint(t,0)<=0&&e.comparePoint(t,a)>=0}catch(a){return!1}}function AY(e){if(e.collapsed)return[];let t=e.commonAncestorContainer;if(t.nodeType!==Node.ELEMENT_NODE&&(t=t.parentElement),!t)return[];const{ownerDocument:n}=t;if(!n)return[];const s=[],a=n.createNodeIterator(t,NodeFilter.SHOW_TEXT);let o;for(;o=a.nextNode();){if(!RY(e,o))continue;const i=o;if(i instanceof Text){if(i===e.startContainer&&e.startOffset>0){i.splitText(e.startOffset);continue}i===e.endContainer&&e.endOffset<i.data.length&&i.splitText(e.endOffset),s.push(i)}}return s}function BY(e,t="hypothesis-highlight"){const n=AY(e);let s=[],a=null,o=null;n.forEach(u=>{a&&a.nextSibling===u?o.push(u):(o=[u],s.push(o)),a=u});const i=/^\s*$/;s=s.filter(u=>u.some(d=>!i.test(d.data)));const l=[];s.forEach(u=>{const d=document.createElement("hypothesis-highlight");d.className=t;const f=u[0];if(!f)return;const h=f.parentNode;h&&(h.replaceChild(d,f),u.forEach(p=>d.appendChild(p)),l.push(d))});const c=l.map(u=>u.getBoundingClientRect());return PY(e.commonAncestorContainer),c}function LY(e,t){const n=e.parentNode;n&&(t.forEach(s=>n.insertBefore(s,e)),e.remove())}function PY(e){const t=Array.from(e.querySelectorAll("hypothesis-highlight"));OY(t)}function OY(e){for(const t of e)if(t.parentNode){const n=Array.from(t.childNodes);LY(t,n)}}class MY{constructor(t,n,s,a,o,i){q(this,"getPageView",t=>{if(this.pdfViewer)return this.pdfViewer.getPageView(t-1)});q(this,"bindEvent",()=>{const t=n=>{if(n.button!==0)return;const s=this.getAnnotationType();s===at.RECTANGLE?this.addAreaAnnotation(this.pageNumber,n):(s===at.HIGHLIGHT||s===at.UNDERLINE||s===at.STRIKETHROUGH)&&this.addHighlight(n,this.pageNumber)};this.textDiv.addEventListener("mousedown",t)});q(this,"addHighlight",(t,n)=>{const s=this.getPageView(n);if(!s)return;[n-1,n+1].forEach(u=>{var f,h;const d=this.getPageView(u);d&&((h=(f=d.textLayer)==null?void 0:f.textLayerRenderTask)==null||h.expandTextDivs(!0))});const a={x:t.clientX,y:t.clientY};let o=!1;const{div:i}=s,l=u=>{!o&&(Math.abs(u.clientX-a.x)>5||Math.abs(u.clientY-a.y)>5)&&(o=!0)},c=()=>{if(document.removeEventListener("mouseup",c),document.removeEventListener("mousemove",l),!o)return;[n-1,n+1].forEach(b=>{var w,k;const E=this.getPageView(b);E&&((k=(w=E.textLayer)==null?void 0:w.textLayerRenderTask)==null||k.expandTextDivs(!1))});const u=window.getSelection();if(!u||u.isCollapsed)return;const d=u.getRangeAt(0);if(!d)return;const f=u.toString().replace(/\n/g,""),h=i.getBoundingClientRect(),p=tW(BY(d),h.width),g=(b,E)=>{const w=this.getPageView(E);if(!w)return;const{div:k}=w,C=k.getBoundingClientRect();return b.x>=C.left&&b.x<=C.right&&b.y>=C.top&&b.y<=C.bottom?E:b.y<=C.top||b.x<=C.left?g(b,E-1):g(b,E+1)},_={};p.forEach(b=>{var w;const E=g(b,n);if(typeof E<"u"){const k=this.getPageView(E);if(!k)return;const{viewport:C,div:T}=k,v=T.getBoundingClientRect(),I=QT(b,v),[j,D]=C.convertToPdfPoint(I.x,I.y),[S,R]=C.convertToPdfPoint(I.x+I.width,I.y+I.height);_[E]=[...(w=_[E])!=null?w:[],{x:j,y:D,xMax:S,yMax:R}]}});const x=this.getAnnotationType();if(!x)return;const y={text:f,type:x,pageNumber:n,pdfRects:_,uuid:qe(),color:this.getColor()};this.onAddAnnotation(y),setTimeout(()=>{var b;(b=window.getSelection())==null||b.removeAllRanges()},0)};document.addEventListener("mouseup",c),document.addEventListener("mousemove",l)});q(this,"addAreaAnnotation",(t,n)=>{n.preventDefault();const s=this.getPageView(t);if(!s)return;const{viewport:a,div:o}=s,i={x:n.clientX,y:n.clientY};let l=!1;const c=document.createElement("div");c.style.position="fixed",c.style.zIndex="99999",c.style.background=`${qr(this.getColor()).alpha(.4)}`;const u=o.getBoundingClientRect(),f=fs(p=>{l||(l=!0,document.body.appendChild(c));const g=Zn(Math.min(p.clientX,i.x),u.left,u.right),_=Zn(Math.min(p.clientY,i.y),u.top,u.bottom),x=Math.abs(Zn(p.clientX,u.left,u.right)-i.x),y=Math.abs(Zn(p.clientY,u.top,u.bottom)-i.y);c.style.left=`${g}px`,c.style.top=`${_}px`,c.style.width=`${x}px`,c.style.height=`${y}px`},60),h=async()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",h);const p=c.getBoundingClientRect();if(c.remove(),p.width<5||p.height<5)return;const g=o.getBoundingClientRect(),_=QT(p,g),x=w6([_],a),b={url:await this.getBlobUrl(t,_),width:_.width,height:_.height,type:at.RECTANGLE,pdfRects:{[t]:x},pageNumber:t,uuid:qe(),color:this.getColor()};this.onAddAnnotation(b)};document.addEventListener("mousemove",f),document.addEventListener("mouseup",h)});q(this,"getBlobUrl",async(t,n,s,a)=>{const o=this.getPageView(t);if(o)return Uk(o.canvas,n,s,a)});this.pdfViewer=t,this.textDiv=n,this.pageNumber=s,this.getColor=a,this.getAnnotationType=o,this.onAddAnnotation=i,this.bindEvent()}}const N_=e=>dm()*e;class UY{constructor(t,n,s,a){q(this,"pathStack",{redo:[],undo:[]});q(this,"drawingPoints",[]);q(this,"isPolygonDrawing",!1);q(this,"editorLayer",document.createElement("div"));q(this,"canvas",document.createElement("canvas"));q(this,"ctx");q(this,"color","#000");q(this,"annotationType");q(this,"removeEscEvent");q(this,"onAnnotationLayerRendered",t=>{if(t.pageNumber!==this.pageNumber||(t.source.div.appendChild(this.editorLayer),this.canvas.width=Math.floor(N_(this.canvas.clientWidth)),this.canvas.height=Math.floor(N_(this.canvas.clientHeight)),this.ctx=this.canvas.getContext("2d"),!this.ctx))return;const s=dm();this.ctx.scale(s,s),this.ctx.fillStyle=qr(this.color).alpha(.4).toString(),this.ctx.strokeStyle=this.color});q(this,"getPageView",t=>this.pdfViewer.getPageView(t-1));q(this,"bindEvent",()=>{if(!this.ctx)return;const t=n=>{n.button===0&&(n.preventDefault(),this.annotationType===at.POLYGON?this.drawPolygon(n):this.annotationType===at.ELLIPSE?this.drawCircle(n):this.annotationType===at.PENCIL&&this.drawFreeLine(n))};this.removeEscEvent=this.bindEscEvent(),this.canvas.addEventListener("mousedown",t)});q(this,"bindEscEvent",()=>{const t=n=>{be("esc")(n)&&(this.annotationType===at.POLYGON&&(n.stopPropagation(),this.closePolygonPath()),this.drawingPoints=[])};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}});q(this,"drawPolygon",t=>{if(!this.isPolygonDrawing){this.isPolygonDrawing=!0;const s=o=>{if(!this.isPolygonDrawing){document.removeEventListener("keydown",a,!0),document.removeEventListener("mousemove",s);return}this.drawingPoints=this.drawingPoints.filter(c=>!c.isTemp);const i=this.getPoint(o),l=this.drawingPoints[0];this.drawingPoints.length>=3&&l&&Math.abs(l.x-i.x)<8&&Math.abs(l.y-i.y)<8?this.drawingPoints.push({...l,isTemp:!0}):this.drawingPoints.push({...i,isTemp:!0}),this.clearBoard(),this.ctx&&this.drawingPoints.length!==1&&Mu(this.ctx,this.drawingPoints,{lineCap:"round",joinShape:"round"})},a=o=>{if(this.isPolygonDrawing){if(be("mod+z")(o)){o.preventDefault(),o.stopPropagation();const i=this.pathStack.undo.pop();if(i){this.pathStack.redo.push([...this.drawingPoints.filter(c=>!c.isTemp)]);const l=this.drawingPoints.find(c=>c.isTemp);if(this.drawingPoints=l?i.concat(l):i,this.ctx){if(this.clearBoard(),this.drawingPoints.length===1)return;Mu(this.ctx,this.drawingPoints,{lineCap:"round",joinShape:"round"})}}}if(be("mod+shift+z")(o)){o.preventDefault(),o.stopPropagation();const i=this.pathStack.redo.pop();if(i){this.pathStack.undo.push([...this.drawingPoints.filter(c=>!c.isTemp)]);const l=this.drawingPoints.find(c=>c.isTemp);if(this.drawingPoints=l?i.concat(l):i,this.ctx){if(this.clearBoard(),this.drawingPoints.length===1)return;Mu(this.ctx,this.drawingPoints,{lineCap:"round",joinShape:"round"})}}}}};document.addEventListener("keydown",a,!0),document.addEventListener("mousemove",s)}if(this.drawingPoints.length>=4){const s=this.drawingPoints[0],a=this.drawingPoints[this.drawingPoints.length-1];if(s&&a&&s.x===a.x&&s.y===a.y){this.closePolygonPath();return}}const n=this.getPoint(t);this.ctx&&(this.ctx.beginPath(),this.ctx.arc(n.x,n.y,5,0,2*Math.PI),this.ctx.fill(),this.pathStack.undo.push([...this.drawingPoints.filter(s=>!s.isTemp)]),this.drawingPoints.push(n))});q(this,"drawCircle",t=>{let n=!1;this.drawingPoints.push(this.getPoint(t));const s=(c,u)=>{const d=u.x-c.x,f=u.y-c.y,h=Math.max(Math.abs(d),Math.abs(f));return{x:d>0?c.x+h:c.x-h,y:f>0?c.y+h:c.y-h}},a=c=>{if(!this.ctx)return;this.drawingPoints.length>1&&this.drawingPoints.pop(),this.drawingPoints.push(this.getPoint(c)),this.clearBoard();const[u,d]=this.drawingPoints;!u||!d||Hf(this.canvas,u,n?s(u,d):d)},o=c=>{if(c.shiftKey){n=!0,this.clearBoard();const[u,d]=this.drawingPoints;if(!u||!d)return;Hf(this.canvas,u,s(u,d))}},i=()=>{n=!1,this.clearBoard();const[c,u]=this.drawingPoints;!c||!u||Hf(this.canvas,c,u)},l=async()=>{if(document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l),document.removeEventListener("keydown",o),document.removeEventListener("keyup",i),!!this.ctx){if(this.drawingPoints.length>1){if(n){const[E,w]=this.drawingPoints;if(!E||!w)return;this.drawingPoints[1]=s(E,w)}const c=this.drawingPoints,u=l0(c),d=this.getPageView(this.pageNumber),f=c.map(E=>{const[w,k]=d.viewport.convertToPdfPoint(E.x,E.y);return{x:w,y:k}}),h=f[0],p=f[1];if(!h||!p)return;const g={x:Math.min(h.x,p.x),y:Math.max(h.y,p.y)},_={x:Math.max(h.x,p.x),y:Math.min(h.y,p.y)},x={x:g.x,y:g.y,xMax:_.x,yMax:_.y},y={width:u.width,height:u.height,type:at.ELLIPSE,pdfRects:{[String(this.pageNumber)]:[x]},pageNumber:this.pageNumber,color:this.color,uuid:qe()},b=await this.getBlobUrl(this.pageNumber,{...u,x:u.left,y:u.top},c,c0.ELLIPSE);y.url=b,this.onAddAnnotation(y)}this.clearBoard(),this.drawingPoints=[]}};document.addEventListener("mousemove",a),document.addEventListener("mouseup",l),document.addEventListener("keydown",o),document.addEventListener("keyup",i)});q(this,"drawFreeLine",t=>{let n=this.getPoint(t);const s=o=>{if(!this.ctx)return;const i=this.getPoint(o);Mu(this.ctx,[n,i],{lineCap:"round",lineJoin:"round"}),n=i,this.drawingPoints.push(i)},a=()=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",a)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",a)});q(this,"closePolygonPath",async()=>{if(this.ctx){if(this.isPolygonDrawing=!1,this.pathStack={redo:[],undo:[]},this.drawingPoints.pop(),this.drawingPoints.length>2){const t=this.drawingPoints,n=l0(t),s=this.getPageView(this.pageNumber),a=t.map(l=>{const[c,u]=s.viewport.convertToPdfPoint(l.x,l.y);return{x:c,y:u}}),o={width:n.width,height:n.height,type:at.POLYGON,path:a,pageNumber:this.pageNumber,color:this.color,uuid:qe()},i=await this.getBlobUrl(this.pageNumber,{...n,x:n.left,y:n.top},t);o.url=i,this.onAddAnnotation(o)}this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawingPoints=[]}});q(this,"getBlobUrl",async(t,n,s,a)=>{const o=this.getPageView(t);return Uk(o.canvas,n,s,a)});q(this,"getPoint",t=>{const n=this.canvas.getBoundingClientRect(),s=Zn(t.clientX,n.left,n.right),a=Zn(t.clientY,n.top,n.bottom);return{x:s-n.x,y:a-n.y}});q(this,"setColor",t=>{this.color!==t&&this.ctx&&(this.color=t,this.ctx.strokeStyle=t,this.ctx.fillStyle=qr(t).alpha(.4).toString())});q(this,"clearBoard",()=>{this.ctx&&this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)});q(this,"disable",()=>{var t;this.annotationType===at.POLYGON&&this.closePolygonPath(),this.drawingPoints=[],this.annotationType=at.NONE,this.isPolygonDrawing=!1,this.clearBoard(),(t=this.removeEscEvent)==null||t.call(this),this.editorLayer.style.pointerEvents="none"});q(this,"enable",(t,n)=>{this.setColor(n),t!==this.annotationType&&(this.annotationType===at.POLYGON&&this.closePolygonPath(),this.annotationType!==t&&(this.drawingPoints=[]),this.bindEscEvent(),this.annotationType=t,this.editorLayer.style.pointerEvents="auto")});var c;this.pdfViewer=t,this.pageNumber=n,this.onAddAnnotation=s,this.color=(c=a==null?void 0:a.color)!=null?c:"#000",this.annotationType=a==null?void 0:a.annotationType;const i=this.getPageView(n).div;this.editorLayer.className="annotationEditorLayer",i.appendChild(this.editorLayer),this.editorLayer.appendChild(this.canvas),this.canvas.width=Math.floor(N_(this.canvas.clientWidth)),this.canvas.height=Math.floor(N_(this.canvas.clientHeight)),this.ctx=this.canvas.getContext("2d");const l=dm();this.ctx&&(this.ctx.scale(l,l),this.ctx.strokeStyle=this.color,this.ctx.fillStyle=qr(this.color).alpha(.4).toString(),this.bindEvent(),this.pdfViewer.eventBus.on("annotationlayerrendered",this.onAnnotationLayerRendered))}}class VY{constructor(t,n){q(this,"shapeEditorMap",{});q(this,"getLoadedPage",()=>{if(!this.pdfViewer)return[];const t=[];for(let n=0;n<this.pdfViewer.pagesCount;n++){const s=this.pdfViewer.getPageView(n);s.renderingState===ya.FINISHED&&t.push(s)}return t});q(this,"enableAll",(t,n)=>{const s=this.getLoadedPage(),a=new Set;s.forEach(o=>{a.add(o.id),this.ensureShapeEditor(o,t,n)}),Object.entries(this.shapeEditorMap).forEach(([o,i])=>{a.has(Number(o))||i.enable(t,n)})});q(this,"disableAll",()=>{Object.values(this.shapeEditorMap).forEach(t=>{t.disable()})});q(this,"ensureShapeEditor",(t,n,s)=>{const a=t.id;let o=this.shapeEditorMap[a];if(o)o==null||o.enable(n,s);else{if(!this.pdfViewer)return;o=new UY(this.pdfViewer,a,this.onAddShape,{annotationType:n,color:s}),this.shapeEditorMap[t.id]=o}});q(this,"setEditorColor",t=>{Object.values(this.shapeEditorMap).forEach(n=>{n.setColor(t)})});this.pdfViewer=t,this.onAddShape=n}}let Sh=null;const qY=()=>{Sh&&clearTimeout(Sh),Sh=setTimeout(()=>{Sh=null},1e3)};class HY{constructor(t,n){q(this,"wheelUnusedTicks",0);q(this,"destroy",()=>{this.container.removeEventListener("wheel",this.webViewerWheel)});q(this,"accumulateWheelTicks",t=>{(this.wheelUnusedTicks>0&&t<0||this.wheelUnusedTicks<0&&t>0)&&(this.wheelUnusedTicks=0),this.wheelUnusedTicks+=t;const n=Math.sign(this.wheelUnusedTicks)*Math.floor(Math.abs(this.wheelUnusedTicks));return this.wheelUnusedTicks-=n,n});q(this,"webViewerWheel",t=>{if(this.pdfViewer&&!this.pdfViewer.isInPresentationMode)if(t.ctrlKey||t.metaKey){if(t.preventDefault(),Sh||document.visibilityState==="hidden")return;const{deltaMode:n}=t,s=EM(t),a=this.pdfViewer.currentScale;let o=0;if(n===WheelEvent.DOM_DELTA_LINE||n===WheelEvent.DOM_DELTA_PAGE?Math.abs(s)>=1?o=Math.sign(s):o=this.accumulateWheelTicks(s):o=this.accumulateWheelTicks(s/30),o<0)this.pdfViewer.decreaseScale(-o);else if(o>0){if(this.pdfViewer.currentScale>=4)return;this.pdfViewer.increaseScale(o)}const{currentScale:i}=this.pdfViewer;if(a!==i){const l=i/a-1,c=this.pdfViewer.container.getBoundingClientRect(),u=t.clientX-c.left,d=t.clientY-c.top;this.pdfViewer.container.scrollLeft+=u*l,this.pdfViewer.container.scrollTop+=d*l}}else qY()});this.pdfViewer=t,this.container=n,this.container.addEventListener("wheel",this.webViewerWheel,{passive:!1})}}ep.GlobalWorkerOptions.workerSrc="https://cdn.allflow.cn/assets/pdf/pdf.worker.min.js";const $Y="https://cdn.allflow.cn/assets/cmaps/";class GY{constructor(t,n,s,a,o){q(this,"pdfDocument");q(this,"loadingTask");q(this,"pdfViewer");q(this,"pdfThumbnailViewer");q(this,"pdfLinkService");q(this,"findController");q(this,"pdfRenderingQueue");q(this,"eventBus");q(this,"pdfCursorTools");q(this,"isThumbnailViewEnabled",!0);q(this,"shapeEditorManager");q(this,"annotationType",at.NONE);q(this,"annotationColor","#000");q(this,"annotationLineWidth",1);q(this,"annotations",{});q(this,"annotationRenders",{});q(this,"disposed",!1);q(this,"history");q(this,"wheelUnusedTicks",0);q(this,"webViewerWheel");q(this,"onPassword");q(this,"onProgress");q(this,"onCopyPermission");q(this,"onPagesInit");q(this,"onAddAnnotation");q(this,"onUpdateAnnotation");q(this,"onDeleteAnnotation");q(this,"onAnnotationContextMenu");q(this,"onHistoryChange");q(this,"initialize",()=>{const t=new _u.EventBus;this.eventBus=t;const n=new wM;n.onIdle=this.cleanup,n.isThumbnailViewEnabled=this.isThumbnailViewEnabled,this.pdfRenderingQueue=n;const s=new _u.PDFLinkService({eventBus:t});this.pdfLinkService=s;const a=new _u.PDFFindController({eventBus:t,linkService:s});this.findController=a,this.pdfViewer=new _u.PDFViewer({container:this.scrollContainer,viewer:this.pageContainer,l10n:_u.NullL10n,eventBus:t,linkService:s,findController:a,renderingQueue:n,textLayerMode:Yz.ENABLE_ENHANCE}),n.setViewer(this.pdfViewer),s.setViewer(this.pdfViewer),this.pdfThumbnailViewer=new NY({container:this.thumbnailContainer,eventBus:t,renderingQueue:n,linkService:s,l10n:_u.NullL10n}),n.setThumbnailViewer(this.pdfThumbnailViewer);const o=new _u.PDFHistory({linkService:s,eventBus:t});s.setHistory(o);const i=new kM({container:this.scrollContainer,eventBus:t,cursorToolOnLoad:0});this.pdfCursorTools=i});q(this,"loadViewer",()=>{var a,o;const{pdfDocument:t,pdfViewer:n,eventBus:s}=this;!t||!n||!s||(n.setDocument(t),(a=this.pdfLinkService)==null||a.setDocument(t,null),(o=this.pdfThumbnailViewer)==null||o.setDocument(t),n.firstPagePromise.then(()=>{var i;s.on("pagerendered",this.onPageRendered),s.on("textlayerrendered",this.onTextLayerRendered),s.on("rotationchanging",l=>{this.pdfThumbnailViewer&&(this.pdfThumbnailViewer.pagesRotation=l.pagesRotation),this.pdfRenderingQueue.renderHighestPriority(),n.currentPageNumber=l.pageNumber}),s.on("resize",()=>{if(!n)return;n.updateContainerHeightCss();const{currentScaleValue:l}=n;(l==="auto"||l==="page-fit"||l==="page-width")&&(n.currentScaleValue=l),n.update()}),s.on("annotationlayerrendered",l=>{var c;n&&(this.annotationType===at.PENCIL||this.annotationType===at.POLYGON||this.annotationType===at.ELLIPSE)&&((c=this.shapeEditorManager)==null||c.ensureShapeEditor(l.source,this.annotationType,this.annotationColor))}),(i=this.onPagesInit)==null||i.call(this),this.checkPermissions(),window.addEventListener("resize",this.handleResize),this.webViewerWheel=new HY(n,this.scrollContainer),this.shapeEditorManager=new VY(n,this.addAnnotation)}).catch(()=>{}).then(()=>{n.update()}))});q(this,"checkPermissions",async()=>{if(!this.pdfDocument)return;const t=await this.pdfDocument.getPermissions();if(t&&!t.includes(Wz.COPY)){const n=s=>{var a;if(be("mod+a")(s)){s.preventDefault();return}if(be("mod+c")(s)){const o=window.getSelection();if(!o)return;const i=o.getRangeAt(0);if(i.collapsed)return;const l=i.commonAncestorContainer,{endContainer:c}=i,{startContainer:u}=i;(this.pageContainer.contains(l)||this.pageContainer.contains(c)||this.pageContainer.contains(u))&&(s.preventDefault(),(a=this.onCopyPermission)==null||a.call(this))}};window.addEventListener("keydown",n)}});q(this,"handleResize",fs(()=>{var t,n;this.pdfViewer&&((n=(t=this.pdfViewer)==null?void 0:t.eventBus)==null||n.dispatch("resize",{}))},60));q(this,"onPageRendered",t=>{if(!this.pdfViewer)return;const{pageNumber:n}=t,{div:s,textLayer:{textLayerDiv:a}}=this.pdfViewer.getPageView(n-1),o=s.querySelector(".next-space-annotationLayer");o&&(o.style.transform=a.style.transform,o.style.transformOrigin=a.style.transformOrigin)});q(this,"onTextLayerRendered",t=>{const{pageNumber:n,source:s}=t;Object.values(this.annotations).forEach(i=>{i.pageNumber===n&&i.live!==!1&&this.renderAnnotation(i)});const a=s.textLayerDiv;if(!this.pdfViewer)return;const o=()=>{this.pageContainer.classList.add("disableAnnotation"),document.addEventListener("mouseup",()=>{this.pageContainer.classList.remove("disableAnnotation")})};a.addEventListener("mousedown",o),new MY(this.pdfViewer,a,n,this.getAnnotationColor,this.getAnnotationType,this.addAnnotation)});q(this,"renderAnnotation",t=>{this.pdfViewer&&(this.annotationRenders[t.uuid]=new DY(this.pdfViewer,t,this.getAnnotationType,this.updateAnnotation,this.deleteAnnotation,this.onAnnotationContextMenu))});q(this,"addAnnotation",t=>{var n,s;this.annotations[t.uuid]=t,(n=this.onAddAnnotation)==null||n.call(this,t),this.renderAnnotation(t),(s=this.history)==null||s.record({type:Ga.ADD,uuid:t.uuid})});q(this,"updateAnnotation",(t,n=!0)=>{var s,a,o;(s=this.history)==null||s.record({type:Ga.UPDATE,uuid:t.uuid,patch:t},this.annotations[t.uuid]),this.annotations[t.uuid]=t,(a=this.onUpdateAnnotation)==null||a.call(this,t),n&&((o=this.annotationRenders[t.uuid])==null||o.update(t))});q(this,"deleteAnnotation",(t,n=!0)=>{var a,o,i;const s=this.annotations[t.uuid];s&&(s.live=!1,(a=this.onDeleteAnnotation)==null||a.call(this,t),(o=this.history)==null||o.record({type:Ga.DELETE,uuid:t.uuid}),n&&((i=this.annotationRenders[t.uuid])==null||i.remove(),delete this.annotationRenders[t.uuid]))});q(this,"syncAddAnnotation",t=>{this.annotations[t.uuid]=t,this.renderAnnotation(t)});q(this,"syncUpdateAnnotation",t=>{var n;this.annotations[t.uuid]=t,(n=this.annotationRenders[t.uuid])==null||n.update(t)});q(this,"setAnnotationType",t=>{var n,s;this.annotationType!==t&&(this.annotationType=t,this.pageContainer.classList.remove(at.ERASER,at.POLYGON,at.RECTANGLE,at.HIGHLIGHT,at.ELLIPSE),(t===at.ERASER||t===at.POLYGON||t===at.ELLIPSE||t===at.RECTANGLE||t===at.HIGHLIGHT)&&this.pageContainer.classList.add(t),t===at.POLYGON||t===at.ELLIPSE?(n=this.shapeEditorManager)==null||n.enableAll(t,this.annotationColor):(s=this.shapeEditorManager)==null||s.disableAll())});q(this,"setAnnotationColor",t=>{var n;this.annotationColor=t,(n=this.shapeEditorManager)==null||n.setEditorColor(t)});q(this,"getAnnotationType",()=>this.annotationType);q(this,"getAnnotationColor",()=>this.annotationColor);q(this,"getAnnotations",()=>this.annotations);q(this,"redo",()=>{var t;return(t=this.history)==null?void 0:t.redo()});q(this,"undo",()=>{var t;return(t=this.history)==null?void 0:t.undo()});q(this,"applyOP",t=>{var s,a;const n=this.annotations[t.uuid];if(n)switch(t.type){case Ga.ADD:{n.live=!0,this.renderAnnotation(n);break}case Ga.DELETE:{n.live=!1,(s=this.annotationRenders[t.uuid])==null||s.remove(),delete this.annotationRenders[t.uuid];break}case Ga.UPDATE:{if(!t.patch)return;const o={...n,...t.patch};this.annotations[t.uuid]=o,(a=this.annotationRenders[t.uuid])==null||a.update(o);break}}});this.fileUrl=t,this.scrollContainer=n,this.thumbnailContainer=s,this.pageContainer=a,o!=null&&o.annotations&&(this.annotations=o==null?void 0:o.annotations),o!=null&&o.color&&(this.annotationColor=o.color),o!=null&&o.annotationType&&this.setAnnotationType(o.annotationType),this.history=new SY(this)}async loadPDF(t){var s;this.initialize();let n;if(typeof this.fileUrl=="string"?n={url:this.fileUrl,cMapUrl:$Y,cMapPacked:!0,rangeChunkSize:65536,disableAutoFetch:!1,disableStream:!0,password:t}:n=this.fileUrl,this.loadingTask=ep.getDocument(n),!!this.loadingTask){if(this.onPassword&&(this.loadingTask.onPassword=this.onPassword),this.loadingTask.onProgress=({loaded:a,total:o})=>{var i;return(i=this.onProgress)==null||i.call(this,a,o),a/o},this.pdfDocument=await this.loadingTask.promise,this.disposed){(s=this.loadingTask)==null||s.destroy(),this.pdfDocument.destroy();return}this.loadViewer()}}cleanup(){var t,n;(t=this.pdfViewer)==null||t.cleanup(),(n=this.pdfThumbnailViewer)==null||n.cleanup()}dispose(){var t;window.removeEventListener("resize",this.handleResize),this.disposed=!0,(t=this.webViewerWheel)==null||t.destroy(),this.loadingTask&&this.loadingTask.destroy(),this.pdfDocument&&this.pdfDocument.destroy()}}const Iv=e=>e.type===at.HIGHLIGHT?{pageNumber:e.pageNumber,type:e.type,color:e.color,pdfRects:e.pdfRects,text:e.text}:{pageNumber:e.pageNumber,type:e.type,color:e.color,pdfRects:e.pdfRects,path:e.path,text:e.text,width:e.width,height:e.height},zY=({uuid:e,downloadUrl:t,embed:n})=>{var C,T,v,I;const s=F.useRef(),a=Ve(e),o=F.useRef(),i=B6(),l=F.useRef(),c=ke(),u=A6(),d=Ma(),f=F.useRef(null),h=F.useRef(null),p=F.useRef(null),g=F.useRef(null),_=F.useRef(null),x=me(),[y,b]=F.useState("loading"),E=(C=Ir.get(e!=null?e:""))!=null?C:{},[w,k]=F.useState((T=E.sideBarType)!=null?T:Ca.THUMBNAIL_VIEW);return F.useEffect(()=>{if(!n&&e){const{blocks:j}=le(),D=j[e];if(!D)return;const S=de(D==null?void 0:D.data.segments),{name:R,extName:A}=sn(S);document.title=`${R}.${A}`}},[n,e]),F.useEffect(()=>{var j;w===Ca.THUMBNAIL_VIEW&&((j=s.current)==null||j.update())},[w]),F.useEffect(()=>{var L;if(!h.current||!p.current||!f.current)return;let j;if(e){const P=le().blocks[e];j=(L=P==null?void 0:P.data.format)==null?void 0:L.pdfFormat}const D={};if(e){const{blocks:P}=le(),M=P[e];l.current=j==null?void 0:j.password,M==null||M.subNodes.forEach(U=>{const V=P[U];if(!V)return;const{pdfAnnotation:W}=V.data;if(!W)return;const z={...W,uuid:U};D[U]=z})}const S=o.current=new GY(t,h.current,p.current,f.current,{color:Gl.YELLOW,annotations:D,annotationType:at.NONE});S.onPassword=async(P,M)=>{x.modal({keyboard:!1,closeBeforeCallBackForClickOutSide:()=>{b("fail")},content:({onCloseModal:U})=>r.jsx(GW,{uuid:e,onCancel:()=>{U(),b("fail")},onPassword:(V,W)=>{U(),P(V),W?l.current=V:l.current=void 0},reason:M})})},S.onCopyPermission=()=>{ye.warning("用户设置了密码保护，无法复制！")},S.onPagesInit=()=>{if(!S.pdfViewer)return;s.current=S.pdfViewer;const{pdfViewer:P}=S;j!=null&&j.rotation&&(P.pagesRotation=j.rotation);const M=new URLSearchParams(location.search).get("annotationPos");if(M){const[U,V,W]=M.split(",");U&&V&&W?P.linkService.setHash(`page=${U}&zoom=page-actual,${V},${Number(W)+10}`):P.currentScaleValue="page-actual"}else{const U=Ir.get(e!=null?e:"");U&&(P.scrollMode=U.scrollMode===e0.HORIZONTAL?1:0,P.spreadMode=U.spreadMode===t0.DOUBLE?1:0),U!=null&&U.lastViewPos?P.linkService.setHash(U.lastViewPos):P.currentScaleValue="page-actual"}e&&l.current&&!a&&i(e,{password:l.current}),b("success")},S.onAddAnnotation=P=>{if(e){const M=Iv(P);if(N2(P.type)){if(ce.event("highlight_shape",{file_id:e}),!P.url)return;const U=j2(P.url);if(!U)return;d({file:new File([U],"图片标注.png"),type:"file",onComplete:V=>{V.success&&c(()=>{M.ossName=V.ossName,M.size=U.size,Qe({uuid:P.uuid,type:m.BlockType.PDF_ANNOTATION,data:{pdfAnnotation:M,localUrl:P.url}},{parentId:e,last:!0});const W=`{"annotationId": "${P.uuid}", "type": "imageBlock"}`;on(W)})}})}else ce.event("highlight_text",{file_id:e}),c(()=>{Qe({uuid:P.uuid,type:m.BlockType.PDF_ANNOTATION,data:{pdfAnnotation:M}},{parentId:e,last:!0});const U=`{"annotationId": "${P.uuid}"}`;on(U)})}},S.onDeleteAnnotation=P=>{c(()=>{Gs(P.uuid)})},S.onUpdateAnnotation=P=>{const M=Iv(P);if(N2(P.type)){if(!P.url)return;const U=j2(P.url);if(!U)return;d({file:new File([U],"图片标注.png"),type:"file",onComplete:V=>{if(V.success){M.ossName=V.ossName,M.size=U.size,u(P.uuid,M,P.url);const W=`{"annotationId": "${P.uuid}", "type": "imageBlock"}`;on(W)}}})}else{u(P.uuid,M);const U=`{"annotationId": "${P.uuid}"}`;on(U)}},S.onAnnotationContextMenu=(P,M)=>{if(!e)return null;P.preventDefault(),P.stopPropagation(),x.dropdown({popcorn:lm(P),placement:"right",content:({onCloseModal:U})=>r.jsx(zW,{pdfId:e,application:S,annotation:M,closeModal:U})})},S.loadPDF(l.current),In.on("pdfCursor",(...P)=>{const M=P[0];(M===at.RECTANGLE||M===at.ELLIPSE||M===at.POLYGON||M===at.ERASER||M===at.HIGHLIGHT||M===at.NONE)&&S.setAnnotationType(M)}),In.on("pdfCursorColor",(...P)=>{S.setAnnotationColor(P[0])}),In.on("sidebarType",(...P)=>{var U;const M=P[0];if(M){if(e){const V=(U=Ir.get(e!=null?e:""))!=null?U:{};Ir.put(e,{...V,sideBarType:M})}k(M)}});const R=P=>{be("mod+z")(P)&&(ee(Ad()),S.undo()),be("mod+shift+z")(P)&&(ee(Dm()),S.redo())};document.addEventListener("keydown",R);const A=()=>{var P,M;if(e&&S.pdfViewer){const U=(P=S.pdfViewer._location)==null?void 0:P.pdfOpenParams.slice(1);if(U){const V=(M=Ir.get(e!=null?e:""))!=null?M:{};Ir.put(e,{...V,lastViewPos:U})}}};return window.addEventListener("beforeunload",A),()=>{A(),document.removeEventListener("keydown",R,!0),S.dispose()}},[t]),F.useEffect(()=>{const j=_.current,D=g.current;if(!j||!D)return;const S=R=>{R.preventDefault(),R.stopPropagation();const A=P=>{D.style.width=`${Zn(P.clientX,200,300)}px`},L=()=>{var P;if(document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",L),j.style.transform="none",e){const M=(P=Ir.get(e!=null?e:""))!=null?P:{};Ir.put(e,{...M,sideBarWidth:D.clientWidth})}};document.addEventListener("mousemove",A),document.addEventListener("mouseup",L)};j.addEventListener("mousedown",S)},[e]),r.jsxs("div",{className:"relative h-full w-full text-black flex flex-col",children:[y==="success"&&s.current&&o.current&&r.jsx(wY,{uuid:e,application:o.current,pdfViewer:s.current,embed:n}),r.jsxs("div",{className:"relative flex overflow-auto border bg-grey7 flex-1",children:[r.jsxs("div",{className:B("relative",w===Ca.NONE&&"hidden"),ref:g,style:{width:`${(I=(v=Ir.get(e!=null?e:""))==null?void 0:v.sideBarWidth)!=null?I:220}px`},children:[r.jsxs("div",{className:B("w-full h-full bg-grey8 overflow-auto py-2 ",w===Ca.THUMBNAIL_VIEW&&"hidden"),children:[s.current&&w===Ca.CATALOGUE&&r.jsx(HW,{pdfViewer:s.current}),s.current&&w===Ca.ANNOTATION&&e&&r.jsx(VW,{pdfViewer:s.current,uuid:e})]}),r.jsx("div",{id:"thumbnailView",ref:p,className:B("w-full h-full bg-grey8 overflow-auto relative py-4",w!==Ca.THUMBNAIL_VIEW&&"hidden")}),r.jsx("div",{className:"absolute w-0.5 animate-hover cursor-col-resize right-0 top-0 h-full z-10",ref:_})]}),r.jsx("div",{className:"relative flex-1 border-l",children:r.jsx("div",{ref:h,className:"absolute h-full w-full overflow-auto  py-2",children:r.jsx("div",{ref:f,className:B("pdfViewer",n&&"embedPreview")})})})]}),y==="loading"&&r.jsx("div",{className:"flex h-full w-full items-center justify-center absolute left-0 top-0",children:r.jsx(hs,{})}),y==="fail"&&r.jsx("div",{className:"flex h-full w-full items-center justify-center absolute left-0 top-0",children:"预览失败"})]})},WY=F.lazy(()=>ve(()=>import("./_video-dda20a69.js"),["assets/_video-dda20a69.js","assets/vendor-72681657.js","assets/_video-dc2bc366.css"]).then(({VideoJS:e})=>({default:e}))),Vk=e=>r.jsx(F.Suspense,{fallback:r.jsx(os,{style:e.style}),children:r.jsx(WY,{...e})}),KY=({downloadUrl:e,style:t})=>r.jsx(Vk,{videoUrl:e,style:t}),vR=(e="")=>cn.image.test(e)?I2:cn.office.test(e)?BW:cn.txt.test(e)?RK:cn.pdf.test(e)?zY:cn.video.test(e)?KY:cn.audio.test(e)?SW:R6,iF=(e="")=>cn.image.test(e)?"image":cn.office.test(e)?"office":cn.txt.test(e)?"txt":cn.pdf.test(e)?"pdf":cn.video.test(e)?"video":cn.audio.test(e)?"audio":null,qk=({uuid:e,downloadUrl:t,useSimpleImg:n,embed:s,style:a,forceImage:o})=>{const i=_e(e,["data"],["segments"]),{illegal:l}=it(e);if(l)return r.jsx(Qx,{uuid:e});if(!i||!t)return null;const c=i.type===m.BlockType.PDF_ANNOTATION,u=de(i.data.segments),{extName:d}=sn(u),f=o||c?I2:vR(d);return n&&f===I2?r.jsx("img",{style:a,src:t,className:"h-full max-h-full w-full max-w-full object-contain",alt:"图片预览"}):r.jsx(f,{uuid:e,downloadUrl:t,embed:s,style:a})},Hk=e=>{const{uuid:t,ownerBlockId:n,onCloseOutsideModel:s}=e,a=ae(u=>{var d;return de((d=u.blocks[t])==null?void 0:d.data.segments)}),{extName:o}=sn(a),{url:i}=Vi(t),l=F.useMemo(()=>bo(i,o),[o,i]),c=ae(u=>ls(t,u));return F.useEffect(()=>{var d;if(c)return;const u=(d=K.blocks[t])==null?void 0:d.spaceId;u&&Ce.editor.getAncestorBlocks({spaceId:u,blockIds:[t]}).then(f=>{ee(Gn.update({blocks:f.blocks}))})},[c,t]),!c&&n?null:n?r.jsx(wl,{pageId:c!=null?c:"",isLink:!0,blockId:t,onCloseOutsideModel:s}):r.jsx(wl,{hideOpenRightBtn:!0,pageId:t,onCloseOutsideModel:s,className:"min-h-[300px]",children:r.jsx("div",{className:"overflow-y-auto h-full",children:r.jsx(qk,{uuid:t,downloadUrl:l,useSimpleImg:!0,embed:!0,style:{width:"100%",height:"inherit"}})})})},vc=({deep:e=0,uuid:t})=>{const{segments:n,isLinkTable:s,blockType:a}=ae(({blocks:l})=>{var h,p;const c=l[t],u=ki(c);let d=c==null?void 0:c.data.segments;const f=c==null?void 0:c.type;if(u&&c){const g=l[(p=(h=c.data.ref)==null?void 0:h.uuid)!=null?p:""];d=g==null?void 0:g.data.segments}return{blockType:f,segments:d,isLinkTable:(c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION||(c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION_PAGE}},{});if(!de(n))return r.jsxs(r.Fragment,{children:[Ot(a),s&&" 的视图"]});const i=n==null?void 0:n.map((l,c)=>{var u,d,f,h;if(l.type===m.TextType.LINK_PAGE&&l.uuid)return e>z1?"":r.jsxs("span",{children:["@",r.jsx(vc,{uuid:l.uuid,deep:e+1})]},`${e}_${c}`);if([m.TextType.DATETIME,m.TextType.DATE].includes(l.type))return de([l]);if(l.type===m.TextType.USER&&l.uuid)return`@${ss((u=l.uuid)!=null?u:"","")}`;if(l.type===m.TextType.MENTION_BLOCK&&l.uuid){if(e>z1)return"@块引用";if(l.text)return r.jsxs("span",{children:["@",l.text]},`${e}_${c}`);const p=K.blocks[l.uuid];if(!p)return"@块引用";if(p.type===m.BlockType.PDF_ANNOTATION)return r.jsxs("span",{children:["@",(f=(d=p.data.pdfAnnotation)==null?void 0:d.text)!=null?f:""]},`${e}_${c}`);const{showPage:g}=$w(p==null?void 0:p.type),_=ls(l.uuid);return _?r.jsxs("span",{children:["@",r.jsx(vc,{uuid:g?_:l.uuid,deep:e+1})]},`${e}_${c}`):"@块引用"}return(h=l.text)==null?void 0:h.replaceAll(/\s+/g," ")});return r.jsxs(r.Fragment,{children:[i,s&&" 的视图"]})},NR=e=>{const{content:t}=e,n=F.useRef(null),s=F.useMemo(()=>typeof t=="string"?t:de(t),[t]);return F.useEffect(()=>{var a;(a=n.current)==null||a.select()},[]),r.jsxs("div",{className:"w-[524px] px-5 py-5 next-modal",children:[r.jsx("textarea",{ref:n,className:"text-t1 whitespace-pre-wrap h-[112px] w-full bg-transparent outline-none resize-none",defaultValue:s,onChange:a=>{e.onTextChange(a.target.value)},onKeyDown:a=>{be("Enter")(a)&&e.onEnter(a)}}),e.tip&&r.jsxs("div",{className:"flex items-center justify-end mt-1",children:[r.jsx(H,{name:"IcShareDanger",size:"small"}),r.jsx("span",{className:"text-t4 text-grey4",children:e.tip})]})]})},Aa=({uuid:e,editIcon:t=!1,isLinkPage:n=!1,interactable:s=!1,className:a,autoIconSize:o=!1,showUnderLine:i=!0,getEditorModal:l=()=>{},blockId:c,format:u,baseOffset:d,aliasText:f})=>{var A,L,P,M,U;const h=gt(),p=Un(),g=_e(e,["data"],["icon","segments"]),_=_e(c,["data","createdBy","status"],["icon","segments","pdfAnnotation","description"]),x=!!(c?_:g),{showPageIcon:y,showPage:b}=F.useMemo(()=>{var V;return(_==null?void 0:_.type)===m.BlockType.PDF_ANNOTATION?((V=_.data.pdfAnnotation)==null?void 0:V.type)===m.PDFAnnotationType.HIGHLIGHT?{showPageIcon:!1,showPage:!1}:{showPageIcon:!0,showPage:!1}:$w(_==null?void 0:_.type)},[(A=_==null?void 0:_.data.pdfAnnotation)==null?void 0:A.type,_==null?void 0:_.type]),E=F.useRef(null),[w,k]=F.useState(o?void 0:20),{illegal:C,role:T}=it(c||e),v=Cs(),I=F.useRef();let j=!1,D=Rl(e);if(c&&(D=`${D}#${c}`),(_==null?void 0:_.type)===m.BlockType.PDF_ANNOTATION&&(_!=null&&_.parentId)){const V=_.data.pdfAnnotation;if(V){const W=um(V);W&&(j=!0,D=`/preview/${_==null?void 0:_.parentId}?annotationPos=${V.pageNumber},${(L=W.point)==null?void 0:L.x},${(P=W.point)==null?void 0:P.y}#${c}`)}}(g==null?void 0:g.type)===m.BlockType.FILE&&!_&&(j=!0,D=`/preview/${e}`);const S=F.useMemo(()=>{var V;return f||(!b&&(_==null?void 0:_.type)===m.BlockType.CODE?de(_.data.description)||lw:(_==null?void 0:_.type)===m.BlockType.PDF_ANNOTATION?((V=_.data.pdfAnnotation)==null?void 0:V.type)===m.PDFAnnotationType.HIGHLIGHT?_.data.pdfAnnotation.text:"图片标注.png":x?r.jsx(vc,{uuid:b?e:c!=null?c:e}):"无法访问")},[f,_==null?void 0:_.data.pdfAnnotation,_==null?void 0:_.data.description,_==null?void 0:_.type,c,x,b,e]);F.useEffect(()=>{if(!o||!E.current)return;const{fontSize:V}=getComputedStyle(E.current);k(parseFloat(V)*1.25)},[o,w]);let R;if(((M=g==null?void 0:g.data.icon)==null?void 0:M.type)==="emoji"?R="align-middle":((U=g==null?void 0:g.data.icon)==null||U.type,R="align-sub"),T===m.PermissionRole.NONE)return r.jsx(Wx,{id:e,inline:!0});if(c){let V=null;return(_==null?void 0:_.type)===m.BlockType.PDF_ANNOTATION?V=r.jsx(H,{name:"MIcPdf"}):V=r.jsx(as,{uuid:(_==null?void 0:_.type)===m.BlockType.FILE?c:e}),r.jsx(Fe,{lazyLoad:!0,onShow:W=>{I.current=W},className:"inline",theme:"none",interactive:!0,popupClass:"next-modal",offset:[0,5],placement:"top",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:(_==null?void 0:_.status)!==m.BlockStatus.DELETED?(_==null?void 0:_.type)===m.BlockType.PDF_ANNOTATION?r.jsx(Hk,{uuid:_==null?void 0:_.parentId,onCloseOutsideModel:()=>{var W;(W=I.current)==null||W.hide()}}):r.jsx(wl,{pageId:e,isLink:n,blockId:c,showMoreBtn:!!c,onCloseOutsideModel:()=>{var W;(W=I.current)==null||W.hide()},mentionBlockMenuProps:{pageId:e,blockId:c,baseOffset:d!=null?d:0,format:u,showPage:b,getEditorModal:l,aliasText:f!=null?f:""}}):r.jsx("div",{className:"next-modal p-2 text-t2 text-center",children:"该引用源已被删除"}),children:r.jsxs("div",{ref:E,className:B("inline rounded p-1",C&&"opacity-30",s?"animate-hover cursor-pointer":gn({cursor:"inherit !important"}),a),contentEditable:!1,onClick:W=>{if(s||W.preventDefault(),j){W.preventDefault(),window.open(Sn()+D);return}if((_==null?void 0:_.status)===m.BlockStatus.DELETED&&ye.warning("该引用源已被删除"),h===e){p.push(D);return}v(e,{forceOpenInRight:W.altKey,hash:`#${c}`,forceOpenNewTab:W.ctrlKey||W.metaKey})},children:[y&&r.jsx(tn,{iconSize:w,className:B("inline-flex !p-0 transition-none",R),trigger:t,hasOverlay:n,blockId:e,offset:[100,0],defaultIcon:V}),r.jsx("span",{className:B("relative ml-1 font-medium",{"underline decoration-grey5 underline-offset-2":i,"underline decoration-grey5 underline-offset-2 decoration-dashed":c}),children:C?rs:S})]})})}return r.jsx(Fe,{lazyLoad:!0,className:"inline",theme:"none",onShow:V=>{I.current=V},interactive:!0,popupClass:"next-modal",offset:[0,5],placement:(_==null?void 0:_.status)!==m.BlockStatus.DELETED?"right-end":"top",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(wl,{showMoreBtn:!!c,pageId:e,isLink:n,blockId:c,onCloseOutsideModel:()=>{var V;(V=I.current)==null||V.hide()}}),children:r.jsxs("div",{ref:E,className:B("inline rounded p-1",C&&"opacity-30",s?"animate-hover cursor-pointer":gn({cursor:"inherit !important"}),a),contentEditable:!1,onClick:V=>{if(j){V.preventDefault(),window.open(Sn()+D);return}s||V.preventDefault(),v(e,{forceOpenInRight:V.altKey,forceOpenNewTab:V.ctrlKey||V.metaKey})},children:[r.jsx(tn,{iconSize:w,className:B("inline-flex !p-0 transition-none",R),trigger:t,hasOverlay:n,blockId:e,offset:[100,0],defaultIcon:r.jsx(as,{uuid:e})}),r.jsx("span",{className:B("relative ml-1 font-medium",{"underline decoration-grey5 underline-offset-2":i,"underline decoration-grey5 underline-offset-2 decoration-dashed":c}),children:C?rs:S})]})})},IR=e=>{var x,y;const{pageId:t,blockId:n,getEditorModal:s,baseOffset:a,format:o,showPage:i,aliasText:l}=e,c=_e(t,["status","data"],["segments","description"]),u=_e(n,["status","data"],["segments","pdfAnnotation"]),d=me(),f=F.useRef(),h=(u==null?void 0:u.type)===m.BlockType.PDF_ANNOTATION;let p=Rl(t);const g=p;if(n&&(p=`${p}#${n}`,h)){const b=u.data.pdfAnnotation,E=um(b);E&&(p=`/preview/${u==null?void 0:u.parentId}?annotationPos=${b==null?void 0:b.pageNumber},${(x=E.point)==null?void 0:x.x},${(y=E.point)==null?void 0:y.y}#${n}`)}const _=[{type:$.BLOCK_TRANSFORM,data:{title:"复制行内块引用链接",icon:"IcUrl",onClick:()=>{on(`${Sn()}${p}`)}}},{type:$.BLOCK_TRANSFORM,data:{title:"清除链接",icon:"IcMenuDelete",onClick:()=>{var w,k,C;let b=l;b||((u==null?void 0:u.type)===m.BlockType.PDF_ANNOTATION?b=(C=(k=(w=u.data)==null?void 0:w.pdfAnnotation)==null?void 0:k.text)!=null?C:"":b=de(i?c==null?void 0:c.data.segments:u==null?void 0:u.data.segments));const E=s();E==null||E.performChange(T=>{T.select(a,a+1).replace(yn([eo(b,o)]))})}}},{type:$.BLOCK_TRANSFORM,data:{title:"修改引用文字",icon:"IcBtnEdit",onClick:b=>{var E;(E=e.onCloseOutModel)==null||E.call(e),d.dropdown({placement:"right",popcorn:Br(b.currentTarget),closeBeforeCallBack:()=>{if(f.current===void 0)return;const w=e.getEditorModal();w==null||w.performChange(k=>{k.select(a,a+1).replace(yn([zn(kg,{pageId:t,blockId:n,text:f.current})]))})},content:w=>{var C,T,v,I,j,D,S;let k=l;if(!k)if(i)k=(C=c==null?void 0:c.data.segments)!=null?C:[];else if((u==null?void 0:u.type)===m.BlockType.CODE)k=(T=c==null?void 0:c.data.description)!=null?T:lw;else if((u==null?void 0:u.type)===m.BlockType.PDF_ANNOTATION){const R=(v=u.data)==null?void 0:v.pdfAnnotation;(R==null?void 0:R.type)===m.PDFAnnotationType.HIGHLIGHT?k=(D=(j=(I=u.data)==null?void 0:I.pdfAnnotation)==null?void 0:j.text)!=null?D:"":k="图片标注.png"}else k=(S=u==null?void 0:u.data.segments)!=null?S:[];return r.jsx(NR,{tip:"修改引用文字将仍继续保留引用链接",content:k,onTextChange:R=>{f.current=R},onEnter:R=>{w.onCloseModal(),R.stopPropagation()}})}})}}},{type:$.LINE,data:{},disableClick:!0},{type:$.BLOCK_TRANSFORM,data:{title:"复制页面访问链接",icon:"IcUrl",onClick:()=>{on(`${Sn()}${g}`)}}}];return r.jsx(ze,{className:"next-modal py-2 w-52",items:_,keyDownPriority:Cx})};T6(IR);const zs=()=>{const e=ke(),t=YY(),n=(s,a,o)=>{e(()=>{t(s,a,o)})};return F.useCallback(n,[e,t])},YY=()=>{const e=Jc(),t=XY(),n=(s,a,o)=>{s=CM(s)?s:[s];const i=(l,c)=>{let u=[];if(typeof o=="string"){const g=mt(o);u=Array.from({length:c.length},()=>g)}else Array.isArray(o)?Array.isArray(o[0])?u=o:u=Array.from({length:c.length},()=>o):u=Array.from({length:c.length},()=>[]);if(u.length!==c.length)return;const d=le().blocks[l],f=ls(l);if(!f)return;const h=le().blocks[f];if(!d||!h)return;const p=c.reduce((g,_,x)=>{var b,E;const y=(E=(b=h.data.schema)==null?void 0:b[_])==null?void 0:E.type;return y===m.CollectionSchemaType.TITLE?(pe(l,{data:{segments:u[x]}}),g):(y&&im.includes(y)||(g[_]=u[x]),g)},{});if(Object.entries(p).length>0){const g=d.data.collectionProperties,_=t(p),x=Mm(Ut(),{isDatabase:!0});if(_>0&&_*s.length+x.currentCapacity>x.maxCapacity){e({title:"复制块失败",maxCapacity:x.maxCapacity,isNovice:x.isNovice});return}pe(l,{data:{collectionProperties:{...g,...p}}})}};s.forEach(l=>{Array.isArray(a)?i(l,a):i(l,[a])})};return F.useCallback(n,[t,e])},XY=()=>F.useCallback(e=>{let t=0;return Yb(Ei(e)).forEach(n=>{t+=n.size||0}),t},[]),au=F.createContext(void 0),u0=F.createContext(void 0),jR=F.createContext(void 0),sr=()=>{const e=F.useContext(au);if(!e)throw new Error("no usePageScrollRef");return e},ou=()=>{const e=F.useContext(au),t=F.useContext(u0);return t!=null?t:e},QY=()=>{const e=ou(),t=F.useContext(jR);return t!=null?t:e},DR=ia(!1),$k=()=>Ar(DR,ur),SR=ia(0),JY=()=>Ar(SR,ur),RR=ia(0),ZY=()=>Ar(RR,ur),AR=ia(0),eX=()=>Ar(AR,ur),BR=ia(!1),lF=()=>Ar(BR,ur),tX=()=>sa(BR,ur),LR=ia({isVirtualListMode:!1,virtualRef:void 0,subNodes:[]}),PR=()=>Ar(LR,ur),nX=()=>sa(LR,ur),jv=(e,t,n=le().blocks)=>{var s,a;return(a=(s=n[e])==null?void 0:s.data.collectionProperties)==null?void 0:a[t]},OR=e=>{const{children:t,className:n}=e;return r.jsx(TM,{items:[t],config:{duration:200},from:{opacity:.3},enter:{opacity:1},leave:{opacity:0},to:{opacity:1},children:(s,a)=>a&&r.jsx(ME.div,{className:n,style:s,children:a})})},$f=e=>{var c;const{disableSpring:t,children:n,config:s,springProp:a,tagName:o,domRef:i,...l}=e;if(t){const u=(c=e.tagName)!=null?c:"div";return r.jsx(u,{ref:i,...l,children:n})}return r.jsx(sX,{...Jn(e,"disableSpring")})},sX=e=>{const{children:t,className:n,domRef:s,style:a={},tagName:o="div",config:i={},springProp:l={},...c}=e,u=LI({...a,...l,config:{...i}}),d=ME[o];return r.jsx(d,{ref:s,className:n,style:u,...c,children:t})},Ng=e=>{var f,h;const t=ae(p=>{var g;return(g=p.blocks[e])==null?void 0:g.type}),n=ae(p=>{var g;return(g=p.blocks[e])==null?void 0:g.data.display}),s=gt(),a=F.useMemo(()=>Dl(e,s),[s,e]),o=t===m.BlockType.EXTERNAL_FILE&&n==="image",l=t===m.BlockType.REFERENCE&&n==="image"||o||t===m.BlockType.FILE&&n==="image";let c=m.ContentGravity.LEFT;l&&!a&&(c=m.ContentGravity.CENTER);const u=(f=ae(p=>{var g,_;return(_=(g=p.blocks[e])==null?void 0:g.data.format)==null?void 0:_.contentGravity}))!=null?f:c,d=(h=ae(p=>{var g,_;return(_=(g=p.blocks[e])==null?void 0:g.data.format)==null?void 0:_.captionGravity}))!=null?h:c;return{contentGravity:u,captionGravity:d}},MR=e=>{const{captionGravity:t}=Ng(e);return t?{textAlign:UR[t]}:{}},rX=e=>{const{contentGravity:t}=Ng(e);return t?{alignItems:lX[t]}:{}},aX=(e,t,n)=>{var o;const{contentGravity:s}=Ng(e),a=(o=ae(i=>{var l,c,u,d;return(d=(c=(l=i.blocks[e])==null?void 0:l.data.format)==null?void 0:c.width)!=null?d:(u=i.blocks[e])==null?void 0:u.data.width}))!=null?o:0;return!n||!s?{}:t<0?{}:a>=t?{}:{alignSelf:iX[s]}},oX=e=>{const{contentGravity:t}=Ng(e),n=ae(s=>{var a;return(a=s.blocks[e])==null?void 0:a.type});return!t||n===m.BlockType.FILE?{}:{textAlign:UR[t]}},UR={[m.ContentGravity.LEFT]:"left",[m.ContentGravity.RIGHT]:"right",[m.ContentGravity.CENTER]:"center"},iX={[m.ContentGravity.LEFT]:"self-start",[m.ContentGravity.RIGHT]:"self-end",[m.ContentGravity.CENTER]:"center"},lX={[m.ContentGravity.LEFT]:"start",[m.ContentGravity.RIGHT]:"end",[m.ContentGravity.CENTER]:"center"},Ig=e=>{const t=Lr(),n=ae(({blocks:s})=>{const a=s[e];if(!a)return;const o=s[a.parentId];if(!((o==null?void 0:o.type)===m.BlockType.COLLECTION_VIEW||(o==null?void 0:o.type)===m.BlockType.COLLECTION_VIEW_PAGE))return{type:a.type,textColor:a.textColor,backgroundColor:a.backgroundColor}},{equalityFn:Cn});return F.useMemo(()=>{if(n===void 0)return{};let s=Rn(n.backgroundColor);return n.type===m.BlockType.MARK&&(s=gj(n.backgroundColor)),{color:Us(n.textColor),backgroundColor:s}},[n,t])},VR=F.createContext(void 0),Os=()=>F.useContext(VR),cX=()=>{const e=Os(),t=cD(),n=ae(s=>s.ui.selectedBlocks.findIndex(o=>o.syncId&&e&&o.syncId===e)!==-1?!0:e&&e===t);return!(!e||n)},cF=e=>ae(({blocks:t})=>M2(e,t)),M2=(e,t=K.blocks)=>{var a;const n=t[e];if(!n)return!1;const s=(a=t[n.parentId])==null?void 0:a.type;return s===m.BlockType.COLLECTION_VIEW_PAGE||s===m.BlockType.COLLECTION_VIEW},uX=e=>ae(({blocks:t})=>{var a,o;const n=t[e];if(!n)return{isTemplate:!1,collectionId:null,templatePages:[]};const s=t[n.parentId];return{isTemplate:(a=n.isTemplate)!=null?a:!1,collectionId:s==null?void 0:s.uuid,templatePages:((o=s==null?void 0:s.templatePages)!=null?o:[]).filter(i=>{const{role:l}=hn(i);return l!==m.PermissionRole.NONE})}},{equalityFn:kn}),Xr=()=>MS(),Xd=e=>Do(t=>t?!!t.empty&&t.empty.viewId===e:!1),qi=()=>{const e=Kt();return F.useCallback(()=>{const{$createBlockMenuListId:t}=wt;t&&e(t,()=>{Ye({$createBlockMenuListId:"",$menuListKeywords:"",$slashSelection:{},$textareaPlaceHolder:void 0})})},[e])},jg=()=>{const e=Kt();return F.useCallback(()=>{e(wt.$blockMenuListId),Ye({$blockMenuListId:""})},[e])},qR=()=>F.useCallback(e=>{Ye({$createBlockMenuListId:e,$textareaPlaceHolder:{blockId:e,placeHolder:"搜索插入内容",alwaysShow:!1},$focusedInSyncBlockId:""})},[]),iu=(e,t,n,s)=>{const a=Os();return ae(({ui:{selectedBlocks:o},blocks:i})=>{const l=i[e!=null?e:""];if(!l)return;const c=i[l.parentId];return(c==null?void 0:c.type)===m.BlockType.COLLECTION_VIEW&&o.find(u=>u.blockId===l.parentId)?!1:!!o.find(u=>{var h;return u.blockId===e&&u.viewId===t&&u.syncId===a?!n||!u.groupValues?!0:Object.keys(u.groupValues).includes(n)?s?(h=u.groupValues[n])==null?void 0:h.includes(s):!0:!1:!1})})},Gk=()=>{const e=Pw(),t=qR(),n=jg(),s=qi();return F.useCallback(()=>{t(""),n(),s(),e({})},[e,n,s,t])},dX="https://cdn.allflow.cn/assets/ic_insert_emoji-c560346a.png",fX="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAYAAADFeBvrAAAItElEQVRoge2aW2xcxRnHfzPn4t21jWMndnAcE9tAgoMMRqVCpVBiStxCG6nhohaF5KVqVR7KC1LVhz4ilUq0quABUSRUVRUIiTaqhFAStzICUYW0FQinIaEQG0EuDU7s2N7ds2dufZizvkDTZh3bxBJ/aXT2zMzZ/X47M998M2fgC13eEhcqGB4e3gZ0raAttWhsYGDg1f9W8Bmg4eHhfmvtXqArl8stu2W1SmuN1hpgzBizc3Bw8O355QuAMpi3Wltb6e3tJQzDlbT1opUkCaOjo5w6dQpjzE3zoeT8itbave3t7fT19V22MAC5XI7e3l5aW1sJgmDv/LJZoOqY6e7uXnEDF6ve3l6ArqGhoW3VvFkga21XGIZcjuPmQqraK6WcdV7y0xVWu+T/r7K6tDqAjLnoqqsDKAguuuqyDBozdQJO7seVDkNyHGfPI5xDyCaIOnDNX0GsvYWg5Vr+R7CyKC0dkHOo0VcQo08S8A9EWwHWfxkKmyFsBgToCSiNwsTPcW99grY34noeIezZgRBLA7YkQGb6FOaNh4mDYei6ETY8DvnbgBgImGsFC00O2qcR3e8QnnkB3t+FOnYb8qvPEjRtvGRbLhkoPXGQ6NAegtYSXPdjWPN1EHlwM0AMIsQDCcCC00AKuWvgqp9C8zaifz6J+8sdpF96jnjTHZ8fUPrha4R/exDR3QqbH4F8BzANLgEiEBG4gDnfYwENTvkrChquhv7HEO8/R3jou1T076i7enDlgdTZ94ne2I3obobu3RBFYM+BCPDdLAIXZi1UBTLgjAfBZHAaAgOb7kWqF4ne/D6qYT/R+q0rB+Ssxu3bhVgzBZ0PgCiDTTPjg+xrq5+rLeR8chnILJABazzYlbcjx3+POrAL9+CbiDBeGaDK358h596GjXeCSMGcAy1968gqRAbiJFQ9mHP4bmczIOMnTW3AWBAaOm6h7tx+kkNPkbv10eUHsroCbz8BnVdC3RrvimUAIjM+CjyAkPOgql5uHpAzYJwH0QZ0do3roHUjYuTX2JsfRsaF5QWqjL5O7E5CQz/oKdCBbxkhQUimPinz8m9H6Nzcwu33b83AwHs5B9bw2ktH+PhfE9z3o37qcrGHSa2/KgOFKwnFmyTH9lHou3d5gdTRPxLn6nwrqGkIwlkYELz6h/f4eOQUo++coffmNazrbJibhhyMfzTN6y8dJRSWoRcCvr3rGtDOpzQDIoV8AfPhECw3UHryIPmGiECXIFU+zhLVyVMweWqa9jbJ1Ixl8t8TrGtzC4AmTk/QXO9oaJBMnZkGXQSVASkLqQGtcFFM6YM/01ijfTUBGZ2iJkaxjRJMmnWVMBv0ApyguS1i4gOfdUWzAF1mtrsBjWsEQeQJm9ZGoBIPpBykLhtPCovBFU+i0zJhnL9oG2uKtk15CpOWvNtWldkfJ01BKVCKWwfbiNua6BvspG2d9K2osvJU0bZWsvlr7cRtTdz6jdbZ59AKjAKtcTrFGoUxClOcqMXEGrucNRjr0MYSW4OwgJWZF/aebW2943s/7PTeq2Izj5c97xzSwcBdLeBafPcyIvNw2XdYhzMGYy3GOrBq+YBEnEcbiVEWqxXSAEaCFD4BIKFs5/KqYRx49+3w3cs6/2cYBzbw98Z7QWcURlmUkRDXLx9QlG9EB00oNYNVCqcVIqwDKbPOK3yLOJcFBnLhcsdlV2t9mcE7A0M2JzmcUtg0RSmHjdYS5ZtqAqpxxSqINtxCpezQqcaqMk4rHyXowLeWlmACn7TIUjVf+nsTzt1Xn9ESpxVOlVGpoVJ2yJZeZBgtJxAUum4nKfoftGkKquQHdAb14XvT2LKdg9SfBvP3LhUcPzw1B6kUqBImrZAmjqRoyfcM1Gpe7UBNN36HpCQolyyVxGDTMk4VQVVAQSILPP30GCMHx6lMqWyOyWAU2JJh7PAkzzx1jJMzMSgBKsXpEi4tk1YsScmQzDiabthZM1DNE2t+/bXUdd9N8cw+wjggCA11FBHOgrNsWZ+ndc8WXt53kr2vHKMQWdY1xwghmJxSnPokZdPW9dz70A2sz1UgLYEq4lSJNNGUipaZ85r4qruo77h++YEANnzrMT548gBBrJGhD3liWyKwGkxKSxCzZ0cbpR2dnD6bcm7Su96mxoiNG/LkdQnUJCQp6DJGpajUUixZZiY15fOCnoceW4xpiwMqdGyl+bZHOf/XXxDEEikkzgpimxJEBhH4CKAgQ3oaAnoawUcSKcxM+xWr8ckojVKOctlQnNKUJ1Ma+39A/VU3rRwQCDru+Rlm6mNKR5/3uwUmwtmASDuC0CBlBSFD79Krvlv45YJzBmssxjiUciSJoTijKZ2tkL/2PjY98MTizFo8EIggouO+X/HRixVm3nsJoyxaReTykigMCANBEKSza7tqOOecX9MZ41DaUk4MybSmfD4l7tpB5wNP+bltpYFAEOauoOvB3zD6QkzxyPNYZdEqJK6zhJEkDKQPFuZNrtaCNg6tLGlFUykaSpOa+r7dbLr/l8i6Ri5l8/ESt7EkIi7Qs+dZJo/u4sSffkJy+jC5QkhUJwliSRCK2U1E5xzWOExqSSuWtGiwDdfRsftxmq/fPm8ZsngtwUajABGypvdOmrYcZOLwAcYPPU/pxEHsmRNEUbbN4HzrKOWwYTNXbBmkrf9+Wvq+6ceamDfWLkFLuLctETKm5YZ7aOm7G2sqlM+MkZwdQ81MgICo0Eyh/Rpya7sQIphbRy3h/vYybNb7gFSGeeo39FLfft3C4gVeYum1jK/sqq56eQy/kFbH+6EatOqBskMYs5r/FnwsSZLPVLicVbXXWjtWzZsF2r59+6vA2JEjRz4X4xaj48ePA4xltgOf6nLGmJ3j4+O8++67JEmy0vZdtLTWjIyMcPr0aaSUCxZNn3FBBw4c6M+Om3SFYXhZnl3I/uwxKeXOgYGBCx9emq+hoaFt809oXE6y1i7oZl9oNek/YCkvwizLqAoAAAAASUVORK5CYII=",zk={title:"文字颜色",items:[{color:Rn(Pe.white),desc:"默认",isBgColor:!0,colorkey:""},{color:Us(Pe.black),desc:"黑色",colorkey:Pe.black},{color:Us(Pe.grey),desc:"灰色",colorkey:Pe.grey},{color:Us(Pe.brown),desc:"棕色",colorkey:Pe.brown},{color:Us(Pe.orange),desc:"橘色",colorkey:Pe.orange},{color:Us(Pe.pink),desc:"粉色",colorkey:Pe.pink},{color:Us(Pe.yellow),desc:"黄色",colorkey:Pe.yellow},{color:Us(Pe.green),desc:"绿色",colorkey:Pe.green},{color:Us(Pe.blue),desc:"蓝色",colorkey:Pe.blue},{color:Us(Pe.purple),desc:"紫色",colorkey:Pe.purple},{color:Us(Pe.red),desc:"红色",colorkey:Pe.red}]},_p={title:"背景颜色",items:[{color:Rn(Pe.white),desc:"默认",isBgColor:!0,colorkey:""},{color:Rn(Pe.grey),desc:"灰色",isBgColor:!0,colorkey:Pe.grey},{color:Rn(Pe.brown),desc:"棕色",isBgColor:!0,colorkey:Pe.brown},{color:Rn(Pe.orange),desc:"橘色",isBgColor:!0,colorkey:Pe.orange},{color:Rn(Pe.pink),desc:"粉色",isBgColor:!0,colorkey:Pe.pink},{color:Rn(Pe.yellow),desc:"黄色",isBgColor:!0,colorkey:Pe.yellow},{color:Rn(Pe.green),desc:"绿色",isBgColor:!0,colorkey:Pe.green},{color:Rn(Pe.blue),desc:"蓝色",isBgColor:!0,colorkey:Pe.blue},{color:Rn(Pe.purple),desc:"紫色",isBgColor:!0,colorkey:Pe.purple},{color:Rn(Pe.red),desc:"红色",isBgColor:!0,colorkey:Pe.red}]},mX=[{color:Rn(Pe.yellow_green),desc:"黄至绿",isBgColor:!0,colorkey:Pe.yellow_green},{color:Rn(Pe.green_blue),desc:"绿至蓝",isBgColor:!0,colorkey:Pe.green_blue},{color:Rn(Pe.blue_purple),desc:"蓝至紫",isBgColor:!0,colorkey:Pe.blue_purple},{color:Rn(Pe.purple_red),desc:"紫至红",isBgColor:!0,colorkey:Pe.purple_red},{color:Rn(Pe.red_orange),desc:"红至橘",isBgColor:!0,colorkey:Pe.red_orange}],HR=[{color:Rn(Pe.light_yellow),desc:"荧光黄",isBgColor:!0,colorkey:Pe.light_yellow},{color:Rn(Pe.light_green),desc:"荧光绿",isBgColor:!0,colorkey:Pe.light_green},{color:Rn(Pe.light_blue),desc:"荧光蓝",isBgColor:!0,colorkey:Pe.light_blue},{color:Rn(Pe.light_purple),desc:"荧光紫",isBgColor:!0,colorkey:Pe.light_purple},{color:Rn(Pe.light_red),desc:"荧光红",isBgColor:!0,colorkey:Pe.light_red}],hX={..._p,items:[..._p.items,...HR]},pX={..._p,items:[..._p.items,...HR,...mX]},Dg=[zk,hX],gX=[zk,pX],_X=qe(),Dv="AI_WARNING";var ct=(e=>(e.PageEmpty="PageEmpty",e.PageHasContent="PageHasContent",e.PageContentWroteByAI="PageContentWroteWithAi",e.TextSelected="TextSelected",e.TextSelectedAndWroteByAI="TextSelectedWithWrote",e.BlockSelected="BlockSelected",e.BlockSelectedAndWroteByAI="BlockSelectedAndWroteByAI",e))(ct||{}),Ll=(e=>(e.BlockMenu="block_menu",e.ContextMenu="context_menu",e.RtfMenu="rtf_menu",e.EmptyAi="empty_ai",e))(Ll||{}),we=(e=>(e.Brainstorm="Brainstorm",e.Blog="Blog",e.Outline="Outline",e.Story="Story",e.DailyNotes="DailyNotes",e.ProsAndConsList="ProsAndConsList",e.ActionItems="ActionItems",e.Explain="explain",e.Chinese="simplified chinese",e.ClassicalChinese="classical chinese",e.English="english",e.Korean="korean",e.Japanese="japanese",e.French="french",e.German="german",e.OtherLanguage="OtherLanguage",e.ContinueWrite="ContinueWrite",e.Summarize="Summarize",e.TryAgain="TryAgain",e.Close="Close",e.Improve="Improve",e.Insert="Insert",e.Replace="Replace",e.Discard="Discard",e.Summary="keySummary",e.Simpler="makeShorter",e.Longer="makeLonger",e.Professional="professional",e.Casual="casual",e.Straightforward="straightforward",e.Confident="confident",e.Friendly="friendly",e.Comment="commenting",e.BugFix="bugFix",e.CPlus="C++",e.Java="Java",e.JavaScript="JavaScript",e.TypeScript="TypeScript",e.Python="Python",e.OtherCodeLanguage="OtherCodeLanguage",e))(we||{});const xX=new Set(["ContinueWrite","Summarize","simplified chinese","classical chinese","english","korean","japanese","french","german"]),FX=[we.Blog,we.Brainstorm,we.Outline,we.Story,we.DailyNotes,we.ProsAndConsList,we.OtherLanguage],u1={[we.Blog]:{prompt:"写文章，关于",type:"blog"},[we.Brainstorm]:{prompt:"头脑风暴，关于",type:"brainstorm"},[we.Outline]:{prompt:"写大纲，关于",type:"outline"},[we.Story]:{prompt:"写故事，关于",type:"story"},[we.DailyNotes]:{prompt:"日常小记，关于",type:"daily"},[we.ProsAndConsList]:{prompt:"分析优缺点，关于",type:"prosConsList"},[we.ActionItems]:{prompt:"列出执行步骤，关于"},[we.Explain]:{prompt:"解释一下，关于"},[we.OtherLanguage]:{prompt:"把当前语言翻译成："}},Wk=[{editType:we.Chinese,title:"中文（简体）",en:"simplified chinese"},{editType:we.ClassicalChinese,title:"中文（文言文）",en:"classical chinese"},{editType:we.English,title:"英语",en:"english"},{editType:we.Korean,title:"韩语",en:"korean"},{editType:we.Japanese,title:"日语",en:"japanese"},{editType:we.French,title:"法语",en:"french"},{editType:we.German,title:"德语",en:"german"},{editType:we.OtherLanguage,title:"翻译成...",en:"other"}],$R=[{icon:"IcContinueWriting",title:"头脑风暴...",editType:we.Brainstorm,uuid:"bc56080a-edb8-46e2-8584-7be4c4cc5d05"},{icon:"IcContinueWriting",title:"写文章",editType:we.Blog,uuid:"1ee4dcf6-b00d-49b3-b4d5-ec55d102fd40"},{icon:"IcContinueWriting",title:"写大纲",editType:we.Outline,uuid:"0fcb00ae-f47b-426f-9045-25798361ccc4"},{icon:"IcContinueWriting",title:"写故事",editType:we.Story,uuid:"a15c829b-8861-47d8-a085-10e7b36d1841"},{icon:"IcContinueWriting",title:"日常小记",editType:we.DailyNotes,uuid:"b3d48333-ead2-4692-ab51-1f16019500cd"},{icon:"IcContinueWriting",title:"分析优缺点",editType:we.ProsAndConsList,uuid:"e7e1df60-bd16-47d9-a2fa-e4fec4c114cf"},{icon:"IcContinueWriting",title:"列出执行步骤",editType:we.ActionItems,uuid:"f2eb1bda-7e1f-4ece-91d1-4c2c2d1f06cf"},{icon:"IcContinueWriting",title:"解释一下",editType:we.Explain,uuid:"788f06ec-1ed2-47f9-be37-a9a908ca8c7e"}],yX=[{type:$.BLOCK_TEXT,data:{title:"按页面的内容"}},{type:$.OPERATION,data:{icon:"IcContinueWriting",title:"继续写作",editType:we.ContinueWrite,uuid:"9aab88e9-ba1b-4201-a9f3-483e814493db"}},{type:$.LINE},{type:$.OPERATION,data:{icon:"IcSummarize",title:"总结",editType:we.Summarize,uuid:"7aec37fa-f6be-4b6e-a870-6a54b430131a"}},{type:$.OPERATION,data:{icon:"IcSummary",title:"摘要",editType:we.Summary,uuid:"c0e29509-ca71-4bc0-9a96-fa338a2b05ce"}},{type:$.OPERATION,data:{icon:"IcExplain",title:"解释",editType:we.Explain,uuid:"5e936d14-2331-468b-af24-31433992451d"}},{type:"Translate",data:{uuid:"4767a567-da89-4781-92ab-8a8d5faf8e0e"}}],bX=[{type:$.OPERATION,data:{icon:"IcSelectedSpace",title:"完成",editType:we.Close}},{type:$.OPERATION,data:{icon:"IcContinueWriting",title:"继续写作",editType:we.ContinueWrite}},{type:$.LINE},{type:$.OPERATION,data:{icon:"IcTitleClose",title:"关闭",editType:we.Close}}],EX=[{type:$.BLOCK_TEXT,data:{title:"按选择的内容"}},{type:$.OPERATION,data:{icon:"IcContinueWriting",title:"继续写作",editType:we.ContinueWrite,uuid:"9aab88e9-ba1b-4201-a9f3-483e814493db"}},{type:$.LINE},{type:$.OPERATION,data:{icon:"IcSummarize",title:"总结",editType:we.Summarize,uuid:"7aec37fa-f6be-4b6e-a870-6a54b430131a"}},{type:$.OPERATION,data:{icon:"IcSummary",title:"摘要",editType:we.Summary,uuid:"c0e29509-ca71-4bc0-9a96-fa338a2b05ce"}},{type:$.OPERATION,data:{icon:"IcExplain",title:"解释",editType:we.Explain,uuid:"5e936d14-2331-468b-af24-31433992451d"}},{type:"Translate"},{type:"Code"},{type:$.LINE},{type:$.OPERATION,data:{icon:"IcChangeWriting",title:"改进写作",editType:we.Improve,uuid:"7edcb487-2041-4ade-8483-71b9e1caba35"}},{type:$.OPERATION,data:{icon:"IcSimpler",title:"更简短",editType:we.Simpler,uuid:"1a8812df-9395-4eed-84be-59b5e148e7c1"}},{type:$.OPERATION,data:{icon:"IcMoreDetail",title:"更详细",editType:we.Longer,uuid:"63c58833-d02c-4a15-8039-949c78bcc9f2"}},{type:"AiStyle",data:{uuid:"7613737d-eb65-4464-a596-167d1e3f0c00"}}],wX=[{type:$.OPERATION,data:{icon:"IcMenuReplace",title:"替换",editType:we.Replace}},{type:$.OPERATION,data:{icon:"IcBtnNew",title:"插入",editType:we.Insert}},{type:$.OPERATION,data:{icon:"IcContinueWriting",title:"继续写作",editType:we.ContinueWrite}},{type:$.LINE},{type:$.OPERATION,data:{icon:"IcTryAgain",title:"重试",editType:we.TryAgain}},{type:$.OPERATION,data:{icon:"IcMenuDelete",title:"放弃",editType:we.Discard}}],kX=({handleEditType:e})=>{const t=Wk.map(n=>({type:$.BLOCK_ITEM,data:n}));return r.jsx(ze,{className:Mi,items:t,keyDownPriority:Tr+1,onItemClick:({data:n})=>{e(n.editType)}})},CX=[{title:"更专业的",editType:we.Professional,uuid:"32faf939-cb35-479f-95e8-3a234791a75d"},{title:"非正式的",editType:we.Casual,uuid:"68dc99f8-ebda-440e-bd9d-b1d431b24e0a"},{title:"更直接的",editType:we.Straightforward,uuid:"f57e6b90-d5c3-453a-87ab-e6ed9d2c175f"},{title:"更自信的",editType:we.Confident,uuid:"06d15689-21c4-446d-89b0-fa5cc33c3d96"},{title:"更友好的",editType:we.Friendly,uuid:"6a8e29b8-e6ee-4af1-87da-212f01b7925a"}],TX=({handleEditType:e})=>{const t=CX.map(n=>({type:$.BLOCK_ITEM,data:n}));return r.jsx(ze,{className:Mi,items:t,keyDownPriority:Tr+1,onItemClick:({data:n})=>{e(n.editType)}})},vX=[{title:"C++",editType:we.CPlus,uuid:"1d408267-b814-4a47-9202-8e7e3e3fe228"},{title:"Java",editType:we.Java,uuid:"69adc1be-750b-4770-a543-c505e3673c07"},{title:"JavaScript",editType:we.JavaScript,uuid:"059f0231-2c1b-499c-91fd-75bacafe756e"},{title:"TypeScript",editType:we.TypeScript,uuid:"f402a9c0-d0af-4cd6-8d5d-1d68e90e27ad"},{title:"Python",editType:we.Python,uuid:"9d2d1638-becc-4b74-9f08-26dd5d873c23"},{title:"改写成",editType:we.OtherCodeLanguage,uuid:"2ed3ed7c-6867-437d-8da5-4f36300b44d2"}],NX=({handleEditType:e})=>{const t=vX.map(n=>({type:$.BLOCK_ITEM,data:n}));return r.jsx(ze,{className:Mi,items:t,keyDownPriority:Tr+1,onItemClick:({data:n})=>{e(n.editType)}})},Qy=e=>{const{$aiCommands:t}=wt,n=new Set(t.map(s=>s.uuid));return e.filter(s=>{var a;return s.type==="line"?!0:n.has((a=s==null?void 0:s.data)==null?void 0:a.uuid)})},Sv=(e,t,n)=>{const s={type:$.OPERATION,data:{icon:"IcTranslate",title:"翻译",uuid:"4767a567-da89-4781-92ab-8a8d5faf8e0e",hasArrow:!0,renderSubMenu:()=>r.jsx(kX,{handleEditType:t})}},a={type:$.OPERATION,data:{icon:"IcAiStyle",title:"切换风格",uuid:"7613737d-eb65-4464-a596-167d1e3f0c00",hasArrow:!0,renderSubMenu:()=>r.jsx(TX,{handleEditType:t})}};switch(e){case ct.PageEmpty:{const o=$R.map(i=>({type:$.OPERATION,data:i}));return o.unshift({type:$.BLOCK_TEXT,data:{title:"让AI写作"}}),Qy(o)}case ct.PageHasContent:return Qy(yX.map(o=>o.type==="Translate"?s:o));case ct.PageContentWroteByAI:return bX;case ct.TextSelected:case ct.BlockSelected:{const{blocks:o}=K,i=n.current.find(c=>{var u;return((u=o[c])==null?void 0:u.type)===m.BlockType.CODE}),l=[];return EX.forEach(c=>{if(c.type==="AiStyle")return l.push(a);if(c.type==="Translate")return l.push(s);if(c.type==="Code"){i&&l.push({type:$.LINE},{type:$.OPERATION,data:{icon:"IcNote",title:"代码注释",editType:we.Comment,uuid:"67f734b6-020d-47db-b6f1-81d718af72ad"}},{type:$.OPERATION,data:{icon:"IcRepair",title:"程序修复",editType:we.BugFix,uuid:"9c0fa67f-39b7-472c-9114-55736adab50e"}},{type:$.OPERATION,data:{icon:"IcCodeRewriting",title:"代码改写",uuid:"6b4887d4-2f0f-4cbc-a005-3c6ca9a009c5",hasArrow:!0,renderSubMenu:()=>r.jsx(NX,{handleEditType:t})}});return}l.push(c)}),Qy(l)}case ct.TextSelectedAndWroteByAI:case ct.BlockSelectedAndWroteByAI:return wX;default:return[]}},Qd=()=>{var l,c;const e=dw(),t=Ft(),n=Qt(),s=dD(),{permissionGroups:a=[]}=t,o=new Map;a.forEach(u=>{o.set(u.id,new Set(u.userIds))});let i=!1;for(const u of s)if(u.type==="space"||u.type==="user"&&n.uuid===u.uuid||u.type==="group"&&((l=o.get(u.uuid))!=null&&l.has(n.uuid))){i=!0;break}return((c=t.setting)==null?void 0:c.enableAI)===!0&&e&&i},IX=F.forwardRef(({singleLine:e,readonly:t,...n},s)=>e?r.jsx("input",{...n,ref:s,disabled:!!t}):r.jsx("textarea",{...n,ref:s,disabled:!!t})),oo=F.forwardRef(({value:e,className:t,fontClassName:n,boxClassName:s,singleLine:a,style:o,onKeyDown:i,autoSelectAll:l,shiftEnter:c,defaultValue:u,...d},f)=>(F.useEffect(()=>{const h=f==null?void 0:f.current;l&&setTimeout(()=>h.select())},[l,f]),r.jsxs("div",{className:B("relative",s),children:[!a&&r.jsxs("div",{className:B("invisible break-words pointer-events-none",n),style:{fontWeight:"inherit",whiteSpace:"pre-line"},children:[e,r.jsx("br",{})]}),r.jsx(IX,{singleLine:a,spellCheck:!1,ref:f,style:{...o,fontWeight:"inherit"},value:e,defaultValue:u,className:B("w-full h-full bg-transparent resize-none block overflow-hidden appearance-none outline-none placeholder-grey4 overscroll-none",a?"":"absolute top-0 left-0 break-words",t,n),...d,onKeyDown:h=>{be(["Enter","Shift+Enter"])(h)&&(c||h.preventDefault()),i==null||i(h)}})]}))),GR=Symbol("Editor Model"),wd=new Map,nr=e=>{var t,n;return(n=wd.get(e))!=null?n:(t=document.querySelector(`[data-editor="${e}"]`))==null?void 0:t[GR]},Si=(e,t,n)=>{const s=[];return t&&(s.push(t),s.push("::")),n&&(s.push(n),s.push("::")),s.push(e),s.join("")},Kk=e=>vM({extensions:[{id:"editable",initialize:n=>{e.forEach(s=>{s.initialize(n)})}}]}),zR=(e,t)=>{wd.set(e,t)},Yk=e=>{wd.delete(e)},jX=F.createContext(void 0),Pl=e=>{const t=Os(),n=F.useContext(mi);return Si(e,n,t)};let Xk;const DX=e=>{Xk=e},WR=(e=Xk,t)=>{var a;const n=Kk(e),s=new n(t);for(const o of e)(a=o.postInit)==null||a.call(o,s);return s},xn=()=>{const e=Os(),t=F.useContext(mi);function n(s,a,o=Xk){const i=Si(s,t,e);return SX(i,!!a,o)}return F.useCallback(n,[t,e])},SX=(e,t,n)=>{let s=wd.get(e);return!s&&t&&(s=WR(n,e),wd.set(e,s)),s},ha=(e,t)=>{var o;const n=le().blocks[e];if(!n)return;if(ee(mn({uuid:e,patch:{status:-1},ignoreOp:t})),n.isTemplate){const i=n.parentId,l=le().blocks[i];if(l!=null){const c=(o=l.templatePages)!=null?o:[],u=BI(c,e);ee(mn({uuid:i,patch:{templatePages:u},ignoreOp:t}))}}else ee(tr({uuid:e,ignoreOp:t}));const s=Tn();s.customTemplates.includes(e)&&kk(e,{parentId:s.uuid},t),Fd(e,n.parentId)},Es=e=>e.map(t=>t.blockId),kd=(e,t,n)=>Array.isArray(e)?e.map(s=>({blockId:s,viewId:t,syncId:n})):[{blockId:e,viewId:t,syncId:n}],RX=e=>{switch(e){case"bold":return"**";case"code":return"`";case"italic":return"*";case"lineThrough":return"~~";default:return""}},Ml=e=>{const t=[];let n={type:m.TextType.TEXT,enhancer:{},text:""};const s=e.concat(n),a=["code","lineThrough","italic","bold"];for(const o of s){const{type:i,enhancer:l}=o,c={head:[],tail:[],pre:new Set,text:""};switch(a.forEach(u=>{if(!n.enhancer[u]&&l[u]&&c.pre.add(u),n.enhancer[u]&&!l[u])for(let d=t.length-1;d>=0;d--){const f=t[d];if(f&&f.pre.has(u)){const h=RX(u);f.pre.delete(u),f.head.unshift(h),c.tail.push(h);break}}}),i){case m.TextType.DATE:c.text=`@${o.startDate}`;break;case m.TextType.USER:o.uuid&&(c.text=`@${ss(o.uuid)}`);break;case m.TextType.DATETIME:c.text=`@${o.startDate} ${o.startTime}`;break;case m.TextType.EQUATION:c.text=`$${o.text}$`;break;case m.TextType.URL:c.text=`[${o.text}](${o.url})`;break;case m.TextType.LINK_PAGE:if(o.uuid){const u=K.blocks[o.uuid],d=de(u==null?void 0:u.data.segments);c.text=`[${d}](${Sn()}/${o.uuid})`}break;default:c.text=o.text}t.push(c),n=o}return t.reduce((o,i)=>{var l;return o=`${o.replace(/(\s*)$/,(c,u)=>`${i.tail.join("")}${u}`)}`,o+=`${(l=i.text)==null?void 0:l.replace(/^(\s*)/,(c,u)=>`${u}${i.head.join("")}`)}`,o},"")},KR=(e,t=0)=>{const{blocks:n}=K;let s=1;return e.reduce((a,o)=>{var T,v,I,j;const i=n[o];if(!i)return a;const{type:l,data:c,uuid:u,parentId:d,subNodes:f}=i,{segments:h=[],link:p,checked:g,format:_,level:x,display:y,caption:b,ref:E,collectionProperties:w,linkInfo:k}=c;t&&l!==m.BlockType.TABLE_ROW&&(a+=`${Array(t*2).fill(" ").join("")}`);const C=Sn();switch(l){case m.BlockType.PAGE:case m.BlockType.FOLDER:case m.BlockType.COLLECTION_VIEW:case m.BlockType.COLLECTION_VIEW_PAGE:a+=`[${de(h)}](${C}/${u})`;break;case m.BlockType.TEXTAREA:case m.BlockType.MARK:a+=Ml(h);break;case m.BlockType.BOOKMARK:a+=`[${de(k)||mD(p!=null?p:"")}](${p})`;break;case m.BlockType.EMBED:a+=`[${p}](${p})`;break;case m.BlockType.TODO:a+=`- [${g?"x":" "}] ${Ml(h)}`;break;case m.BlockType.CODE:a+=`\`\`\`${(T=_==null?void 0:_.language)!=null?T:""}
${de(h)}
\`\`\`
`;break;case m.BlockType.DIVIDER:a+="---";break;case m.BlockType.HEADER:a+=`${Array(x).fill("#").join("")} ${Ml(h)}`;break;case m.BlockType.QUOTE:a+=`> ${Ml(h)}`;break;case m.BlockType.TOGGLE_HEADER:case m.BlockType.FOLD_LIST:case m.BlockType.LIST:a+=`- ${Ml(h)}`;break;case m.BlockType.ORDER_LIST:a+=`${s}. ${Ml(h)}`,s++;break;case m.BlockType.EQUATION:a+=`$${de(h)}$`;break;case m.BlockType.REFERENCE:case m.BlockType.REFERENCE_COLLECTION:case m.BlockType.REFERENCE_COLLECTION_PAGE:{if(E!=null&&E.uuid){const D=n[E.uuid];if(!D)break;a+=`[${de(D.data.segments)}](${C}/${E.uuid})`}break}case m.BlockType.EXTERNAL_FILE:case m.BlockType.FILE:{const D=de(h);if(y==="folder")a+=`[${D}](${C}/${u})`;else{const S=y==="image",R=b?`${de(b)}`:S&&p||D,A=S?"!":"";p?a+=`${A}[${R}](${p})`:a+=`${A}[${R}](${C}/preview/${u})`}break}case m.BlockType.TABLE_ROW:{const D=n[d];if(!D)break;const S=(v=D.data.format)==null?void 0:v.tableBlockRowHeader,R=(j=(I=D.data.format)==null?void 0:I.tableBlockColumnOrder)!=null?j:[],A=o===(D==null?void 0:D.subNodes[0]),L=o===(D==null?void 0:D.subNodes[(D==null?void 0:D.subNodes.length)-1]);A&&!S&&(a+=`${Array.from(Array(R.length+1)).fill("|").join("")}
${Array.from(Array(R.length)).fill("|-").join("")}|
`),a+=R.reduce((P,M)=>{const U=w==null?void 0:w[M];return U&&(P+=Ml(U)),`${P}|`},"|"),A&&S&&(a+=`
${Array.from(Array(R.length)).fill("|-").join("")}|`),a+=L?`

`:`
`;break}default:s=1}if(b&&(a+=`
${Ml(b)}`),l!==m.BlockType.TABLE&&l!==m.BlockType.TABLE_ROW&&(a+=`

`),!Xt(l)&&f.length){const D=l===m.BlockType.COLUMN_LIST||l===m.BlockType.COLUMN;D||++t,a+=KR(f,t),D||--t}return a},"")},Qk=new Set([m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.COLUMN_LIST,m.BlockType.COLUMN,m.BlockType.TABLE,m.BlockType.CODE,m.BlockType.EQUATION,m.BlockType.DIVIDER]),tl=e=>{const{blocks:t}=le(),n=e.filter(s=>{const a=t[s];return a?Qk.has(a.type):!1});return KR(n)},YR=e=>{var w,k,C,T,v,I;const{pageId:t,blockId:n,tempPageId:s,allLine:a,archiveResult:o,selectedText:i,selectedBlockIds:l,editTypeRef:c,editType:u,scene:d,fetchAIResult:f,setPrompt:h,getSelectedContent:p,removeTempPage:g,closeSelf:_,selection:x,model:y}=e;if(u!==we.TryAgain&&(c.current=u),d===ct.PageEmpty){h((w=u1[u])==null?void 0:w.prompt);return}const{blocks:b}=le(),E=b[t];if(E)switch(u){case we.ContinueWrite:{let j="",D="";if(d===ct.PageHasContent){const S=nr(n);if(!S)return;const R=E.subNodes.indexOf(n);j=tl(E.subNodes.slice(0,R))+br(yr(S.content,0,(k=x==null?void 0:x.start)!=null?k:0)),D=br(yr(S.content,(C=x==null?void 0:x.start)!=null?C:0,S.content.length))+tl(E.subNodes.slice(R+1))}if((d===ct.PageContentWroteByAI||d===ct.BlockSelectedAndWroteByAI||d===ct.TextSelectedAndWroteByAI)&&(j=a.current.join(""),j.trim()||(j=o.current.join(""))),d===ct.BlockSelected){const S=E.subNodes.indexOf(n);j=tl(E.subNodes.slice(0,S+l.current.length)),D=tl(E.subNodes.slice(S+l.current.length))}if(d===ct.TextSelected){const S=E.subNodes.indexOf(n),R=de((T=b[n])==null?void 0:T.data.segments);j=tl(E.subNodes.slice(0,S))+R.slice(0,(v=x==null?void 0:x.end)!=null?v:0),D=`${R.slice((I=x==null?void 0:x.end)!=null?I:0)}

${tl(E.subNodes.slice(S+1))}`}f({type:"continue",previousText:j,restText:D});break}case we.Summarize:{const j=d===ct.PageHasContent?tl(E.subNodes):i.current;f({type:"summarize",selectedText:j});break}case we.Improve:{(d===ct.BlockSelected||d===ct.TextSelected)&&f({type:"improve",selectedText:i.current});break}case we.OtherLanguage:{h("把当前语言翻译成：");break}case we.Comment:case we.BugFix:{f({type:u,selectedText:p()});break}case we.CPlus:case we.Java:case we.TypeScript:case we.Python:case we.JavaScript:{f({type:"rewriting",language:u,selectedText:p()});break}case we.OtherCodeLanguage:{h("把当前代码改写成：");break}case we.Summary:case we.Explain:case we.Chinese:case we.ClassicalChinese:case we.English:case we.Korean:case we.Japanese:case we.French:case we.German:{u===we.Summary||u===we.Explain?f({type:u,selectedText:p()}):f({type:"translate",language:u,selectedText:p()});break}case we.Simpler:case we.Longer:case we.Professional:case we.Casual:case we.Straightforward:case we.Confident:case we.Friendly:{f({type:u,selectedText:i.current});break}case we.Close:{g(),_();break}case we.Replace:{if(d===ct.BlockSelectedAndWroteByAI&&Di(()=>{const j=[];let D=n;const S=K.blocks[s.current];S&&(S.subNodes.forEach(R=>{const A=K.blocks[R];if(A){if(D=Qe({type:A.type,data:A.data},{parentId:t,after:D}),A.subNodes.length>0){let L="";A.subNodes.forEach(P=>{const M=K.blocks[P];M&&(L=Qe({type:M.type,data:M.data},{parentId:D,after:L}))})}j.push({blockId:D})}}),l.current.forEach(R=>ha(R)),g(),ee(nt.update({selectedBlocks:j})),_())}),d===ct.TextSelectedAndWroteByAI){if(!y)return;const j=K.blocks[s.current];if(!j)return;const D=[];let S=n;j.subNodes.forEach((R,A)=>{var P;const L=K.blocks[R];if(L){if(A===0&&L.type===m.BlockType.TEXTAREA){const M=((P=L.data.segments)!=null?P:[]).map(U=>{const V=qo(U);try{return eo(U.text,V)}catch(W){return eo("�",V)}});y.performChange(U=>{var V,W;U.shadow().select((V=x==null?void 0:x.start)!=null?V:0,(W=x==null?void 0:x.end)!=null?W:0).replace(yn(M))}),y.requestFocus();return}if(L.type===m.BlockType.TEXTAREA&&de(L.data.segments)!==""||L.type!==m.BlockType.TEXTAREA){if(S=Qe({type:L.type,data:L.data},{parentId:t,after:S}),L.subNodes.length>0){let M="";L.subNodes.forEach(U=>{const V=K.blocks[U];V&&(M=Qe({type:V.type,data:V.data},{parentId:S,after:M}))})}D.push({blockId:S})}}}),g(),D.length>0&&ee(nt.update({selectedBlocks:D})),_()}break}case we.Insert:{Di(()=>{var R,A,L;let j=n;if(d===ct.BlockSelectedAndWroteByAI){const P=(A=(R=K.blocks[t])==null?void 0:R.subNodes)!=null?A:[];let M=0;l.current.forEach(U=>{M=Math.max(P.indexOf(U),M)}),j=(L=P[M])!=null?L:n}const D=K.blocks[s.current];if(!D)return;const S=[];D.subNodes.forEach(P=>{const M=K.blocks[P];if(M){if(j=Qe({type:M.type,data:M.data},{parentId:t,after:j}),M.subNodes.length>0){let U="";M.subNodes.forEach(V=>{const W=K.blocks[V];W&&(U=Qe({type:W.type,data:W.data},{parentId:j,after:U}))})}S.push({blockId:j})}}),g(),ee(nt.update({selectedBlocks:S})),_()});break}case we.Discard:{g(),_();break}case we.TryAgain:{g(),c.current&&YR({...e,editType:c.current});break}}},XR=Qo.keyMap,Jd={...XR.default};delete Jd["Ctrl-Z"];delete Jd["Ctrl-Y"];delete Jd["Ctrl-D"];delete Jd["Cmd-Z"];delete Jd["Cmd-Y"];delete Jd["Cmd-D"];XR.modified=Jd;const AX=async e=>{switch(e){case"apl":return ve(()=>import("./apl-5b02eec7.js").then(t=>t.a),["assets/apl-5b02eec7.js","assets/vendor-72681657.js"]);case"asciiarmor":return ve(()=>import("./asciiarmor-d42021dc.js").then(t=>t.a),["assets/asciiarmor-d42021dc.js","assets/vendor-72681657.js"]);case"asn.1":return ve(()=>import("./asn.1-bd282795.js").then(t=>t.a),["assets/asn.1-bd282795.js","assets/vendor-72681657.js"]);case"asterisk":return ve(()=>import("./asterisk-053883d4.js").then(t=>t.a),["assets/asterisk-053883d4.js","assets/vendor-72681657.js"]);case"brainfuck":return ve(()=>import("./brainfuck-e889049c.js").then(t=>t.b),["assets/brainfuck-e889049c.js","assets/vendor-72681657.js"]);case"clike":return ve(()=>import("./clike-a34d4775.js").then(t=>t.c),["assets/clike-a34d4775.js","assets/vendor-72681657.js"]);case"cobol":return ve(()=>import("./cobol-33431c9b.js").then(t=>t.c),["assets/cobol-33431c9b.js","assets/vendor-72681657.js"]);case"clojure":return ve(()=>import("./clojure-2c2b09ed.js").then(t=>t.c),["assets/clojure-2c2b09ed.js","assets/vendor-72681657.js"]);case"css":return ve(()=>import("./css-14f5aaf0.js").then(t=>t.c),["assets/css-14f5aaf0.js","assets/vendor-72681657.js"]);case"cmake":return ve(()=>import("./cmake-d9fd8297.js").then(t=>t.c),["assets/cmake-d9fd8297.js","assets/vendor-72681657.js"]);case"coffeescript":return ve(()=>import("./coffeescript-5249f244.js").then(t=>t.c),["assets/coffeescript-5249f244.js","assets/vendor-72681657.js"]);case"commonlisp":return ve(()=>import("./commonlisp-b18abe5e.js").then(t=>t.c),["assets/commonlisp-b18abe5e.js","assets/vendor-72681657.js"]);case"cypher":return ve(()=>import("./cypher-38e786d4.js").then(t=>t.c),["assets/cypher-38e786d4.js","assets/vendor-72681657.js"]);case"python":return ve(()=>import("./python-86dc476b.js").then(t=>t.p),["assets/python-86dc476b.js","assets/vendor-72681657.js"]);case"crystal":return ve(()=>import("./crystal-60f9168e.js").then(t=>t.c),["assets/crystal-60f9168e.js","assets/vendor-72681657.js"]);case"sql":return ve(()=>import("./sql-072c3acb.js").then(t=>t.s),["assets/sql-072c3acb.js","assets/vendor-72681657.js"]);case"d":return ve(()=>import("./d-491597c0.js").then(t=>t.d),["assets/d-491597c0.js","assets/vendor-72681657.js"]);case"dart":return ve(()=>import("./dart-6bdcc4c8.js").then(t=>t.d),["assets/dart-6bdcc4c8.js","assets/vendor-72681657.js","assets/clike-a34d4775.js"]);case"diff":return ve(()=>import("./diff-0e59f531.js").then(t=>t.d),["assets/diff-0e59f531.js","assets/vendor-72681657.js"]);case"django":return ve(()=>import("./django-8efbbedb.js").then(t=>t.d),["assets/django-8efbbedb.js","assets/vendor-72681657.js","assets/htmlmixed-4729c668.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js","assets/css-14f5aaf0.js","assets/overlay-13762f57.js"]);case"dockerfile":return ve(()=>import("./dockerfile-7a657f71.js").then(t=>t.d),["assets/dockerfile-7a657f71.js","assets/vendor-72681657.js"]);case"dtd":return ve(()=>import("./dtd-554a444a.js").then(t=>t.d),["assets/dtd-554a444a.js","assets/vendor-72681657.js"]);case"dylan":return ve(()=>import("./dylan-32d07055.js").then(t=>t.d),["assets/dylan-32d07055.js","assets/vendor-72681657.js"]);case"ebnf":return ve(()=>import("./ebnf-75eaae12.js").then(t=>t.e),["assets/ebnf-75eaae12.js","assets/vendor-72681657.js"]);case"ecl":return ve(()=>import("./ecl-b14c8f2a.js").then(t=>t.e),["assets/ecl-b14c8f2a.js","assets/vendor-72681657.js"]);case"eiffel":return ve(()=>import("./eiffel-d121f594.js").then(t=>t.e),["assets/eiffel-d121f594.js","assets/vendor-72681657.js"]);case"elm":return ve(()=>import("./elm-5596f561.js").then(t=>t.e),["assets/elm-5596f561.js","assets/vendor-72681657.js"]);case"htmlembedded":return ve(()=>import("./htmlembedded-3878e012.js").then(t=>t.h),["assets/htmlembedded-3878e012.js","assets/vendor-72681657.js","assets/htmlmixed-4729c668.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js","assets/css-14f5aaf0.js","assets/multiplex-0f830e72.js"]);case"erlang":return ve(()=>import("./erlang-70c0d9fe.js").then(t=>t.e),["assets/erlang-70c0d9fe.js","assets/vendor-72681657.js"]);case"factor":return ve(()=>import("./factor-bab73deb.js").then(t=>t.f),["assets/factor-bab73deb.js","assets/vendor-72681657.js"]);case"fcl":return ve(()=>import("./fcl-12c6393f.js").then(t=>t.f),["assets/fcl-12c6393f.js","assets/vendor-72681657.js"]);case"forth":return ve(()=>import("./forth-97ce51a1.js").then(t=>t.f),["assets/forth-97ce51a1.js","assets/vendor-72681657.js"]);case"fortran":return ve(()=>import("./fortran-2c629693.js").then(t=>t.f),["assets/fortran-2c629693.js","assets/vendor-72681657.js"]);case"mllike":return ve(()=>import("./mllike-7c4110cb.js").then(t=>t.m),["assets/mllike-7c4110cb.js","assets/vendor-72681657.js"]);case"gas":return ve(()=>import("./gas-0551d356.js").then(t=>t.g),["assets/gas-0551d356.js","assets/vendor-72681657.js"]);case"gherkin":return ve(()=>import("./gherkin-c93e673c.js").then(t=>t.g),["assets/gherkin-c93e673c.js","assets/vendor-72681657.js"]);case"gfm":return ve(()=>import("./gfm-a33d9653.js").then(t=>t.g),["assets/gfm-a33d9653.js","assets/vendor-72681657.js","assets/markdown-e3a9f34b.js","assets/xml-425bcb6b.js","assets/overlay-13762f57.js"]);case"go":return ve(()=>import("./go-35cde2f1.js").then(t=>t.g),["assets/go-35cde2f1.js","assets/vendor-72681657.js"]);case"groovy":return ve(()=>import("./groovy-1c9f8f18.js").then(t=>t.g),["assets/groovy-1c9f8f18.js","assets/vendor-72681657.js"]);case"haml":return ve(()=>import("./haml-0d8dc813.js").then(t=>t.h),["assets/haml-0d8dc813.js","assets/vendor-72681657.js","assets/htmlmixed-4729c668.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js","assets/css-14f5aaf0.js","assets/ruby-18c8f201.js"]);case"haskell":return ve(()=>import("./haskell-c4e2b63c.js").then(t=>t.h),["assets/haskell-c4e2b63c.js","assets/vendor-72681657.js"]);case"haskell-literate":return ve(()=>import("./haskell-literate-21728ac1.js").then(t=>t.h),["assets/haskell-literate-21728ac1.js","assets/vendor-72681657.js","assets/haskell-c4e2b63c.js"]);case"haxe":return ve(()=>import("./haxe-c131f0aa.js").then(t=>t.h),["assets/haxe-c131f0aa.js","assets/vendor-72681657.js"]);case"htmlmixed":return ve(()=>import("./htmlmixed-f2a48cc4.js").then(t=>t.h),["assets/htmlmixed-f2a48cc4.js","assets/vendor-72681657.js","assets/htmlmixed-4729c668.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js","assets/css-14f5aaf0.js"]);case"http":return ve(()=>import("./http-ffd5bb4b.js").then(t=>t.h),["assets/http-ffd5bb4b.js","assets/vendor-72681657.js"]);case"idl":return ve(()=>import("./idl-2644275d.js").then(t=>t.i),["assets/idl-2644275d.js","assets/vendor-72681657.js"]);case"pug":return ve(()=>import("./pug-86781cd0.js").then(t=>t.p),["assets/pug-86781cd0.js","assets/vendor-72681657.js","assets/javascript-683ef49f.js","assets/css-14f5aaf0.js","assets/htmlmixed-4729c668.js","assets/xml-425bcb6b.js"]);case"javascript":return ve(()=>import("./javascript-42492484.js").then(t=>t.j),["assets/javascript-42492484.js","assets/vendor-72681657.js","assets/javascript-683ef49f.js"]);case"jsx":return ve(()=>import("./jsx-27a92703.js").then(t=>t.j),["assets/jsx-27a92703.js","assets/vendor-72681657.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js"]);case"jinja2":return ve(()=>import("./jinja2-5a3c870d.js").then(t=>t.j),["assets/jinja2-5a3c870d.js","assets/vendor-72681657.js"]);case"julia":return ve(()=>import("./julia-470d3dc7.js").then(t=>t.j),["assets/julia-470d3dc7.js","assets/vendor-72681657.js"]);case"livescript":return ve(()=>import("./livescript-e696ba06.js").then(t=>t.l),["assets/livescript-e696ba06.js","assets/vendor-72681657.js"]);case"lua":return ve(()=>import("./lua-d04077b8.js").then(t=>t.l),["assets/lua-d04077b8.js","assets/vendor-72681657.js"]);case"markdown":return ve(()=>import("./markdown-3756b96c.js").then(t=>t.m),["assets/markdown-3756b96c.js","assets/vendor-72681657.js","assets/markdown-e3a9f34b.js","assets/xml-425bcb6b.js"]);case"mirc":return ve(()=>import("./mirc-d71acbad.js").then(t=>t.m),["assets/mirc-d71acbad.js","assets/vendor-72681657.js"]);case"mathematica":return ve(()=>import("./mathematica-ad1097e4.js").then(t=>t.m),["assets/mathematica-ad1097e4.js","assets/vendor-72681657.js"]);case"modelica":return ve(()=>import("./modelica-5b1e5f63.js").then(t=>t.m),["assets/modelica-5b1e5f63.js","assets/vendor-72681657.js"]);case"mumps":return ve(()=>import("./mumps-78c1778c.js").then(t=>t.m),["assets/mumps-78c1778c.js","assets/vendor-72681657.js"]);case"mbox":return ve(()=>import("./mbox-a1b165c5.js").then(t=>t.m),["assets/mbox-a1b165c5.js","assets/vendor-72681657.js"]);case"nginx":return ve(()=>import("./nginx-a3217f99.js").then(t=>t.n),["assets/nginx-a3217f99.js","assets/vendor-72681657.js"]);case"nsis":return ve(()=>import("./nsis-4f876b1d.js").then(t=>t.n),["assets/nsis-4f876b1d.js","assets/vendor-72681657.js"]);case"ntriples":return ve(()=>import("./ntriples-54838926.js").then(t=>t.n),["assets/ntriples-54838926.js","assets/vendor-72681657.js"]);case"octave":return ve(()=>import("./octave-3a14dce9.js").then(t=>t.o),["assets/octave-3a14dce9.js","assets/vendor-72681657.js"]);case"oz":return ve(()=>import("./oz-5f4433f9.js").then(t=>t.o),["assets/oz-5f4433f9.js","assets/vendor-72681657.js"]);case"pascal":return ve(()=>import("./pascal-4c560801.js").then(t=>t.p),["assets/pascal-4c560801.js","assets/vendor-72681657.js"]);case"pegjs":return ve(()=>import("./pegjs-01684d19.js").then(t=>t.p),["assets/pegjs-01684d19.js","assets/vendor-72681657.js","assets/javascript-683ef49f.js"]);case"perl":return ve(()=>import("./perl-64e1b663.js").then(t=>t.p),["assets/perl-64e1b663.js","assets/vendor-72681657.js"]);case"php":return ve(()=>import("./php-4c5cf91d.js").then(t=>t.p),["assets/php-4c5cf91d.js","assets/vendor-72681657.js","assets/htmlmixed-4729c668.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js","assets/css-14f5aaf0.js","assets/clike-a34d4775.js"]);case"pig":return ve(()=>import("./pig-af40e5b6.js").then(t=>t.p),["assets/pig-af40e5b6.js","assets/vendor-72681657.js"]);case"null":return;case"powershell":return ve(()=>import("./powershell-133c42a9.js").then(t=>t.p),["assets/powershell-133c42a9.js","assets/vendor-72681657.js"]);case"ini":case"properties":return ve(()=>import("./properties-3643eb65.js").then(t=>t.p),["assets/properties-3643eb65.js","assets/vendor-72681657.js"]);case"protobuf":return ve(()=>import("./protobuf-11425390.js").then(t=>t.p),["assets/protobuf-11425390.js","assets/vendor-72681657.js"]);case"puppet":return ve(()=>import("./puppet-8a41bf51.js").then(t=>t.p),["assets/puppet-8a41bf51.js","assets/vendor-72681657.js"]);case"q":return ve(()=>import("./q-2f0563bc.js").then(t=>t.q),["assets/q-2f0563bc.js","assets/vendor-72681657.js"]);case"r":return ve(()=>import("./r-c92067ba.js").then(t=>t.r),["assets/r-c92067ba.js","assets/vendor-72681657.js"]);case"rst":return ve(()=>import("./rst-5451a3e8.js").then(t=>t.r),["assets/rst-5451a3e8.js","assets/vendor-72681657.js","assets/python-86dc476b.js","assets/stex-009e7529.js","assets/overlay-13762f57.js"]);case"rpm":return ve(()=>import("./rpm-70467550.js").then(t=>t.r),["assets/rpm-70467550.js","assets/vendor-72681657.js"]);case"ruby":return ve(()=>import("./ruby-ddf0d0c8.js").then(t=>t.r),["assets/ruby-ddf0d0c8.js","assets/vendor-72681657.js","assets/ruby-18c8f201.js"]);case"rust":return ve(()=>import("./rust-cdd8ed42.js").then(t=>t.r),["assets/rust-cdd8ed42.js","assets/vendor-72681657.js"]);case"sas":return ve(()=>import("./sas-e6f1af78.js").then(t=>t.s),["assets/sas-e6f1af78.js","assets/vendor-72681657.js"]);case"sass":return ve(()=>import("./sass-1058d427.js").then(t=>t.s),["assets/sass-1058d427.js","assets/vendor-72681657.js","assets/css-14f5aaf0.js"]);case"scheme":return ve(()=>import("./scheme-3ff26fe7.js").then(t=>t.s),["assets/scheme-3ff26fe7.js","assets/vendor-72681657.js"]);case"shell":return ve(()=>import("./shell-d068ef96.js").then(t=>t.s),["assets/shell-d068ef96.js","assets/vendor-72681657.js"]);case"sieve":return ve(()=>import("./sieve-c7436681.js").then(t=>t.s),["assets/sieve-c7436681.js","assets/vendor-72681657.js"]);case"slim":return ve(()=>import("./slim-b956c91f.js").then(t=>t.s),["assets/slim-b956c91f.js","assets/vendor-72681657.js","assets/htmlmixed-4729c668.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js","assets/css-14f5aaf0.js","assets/ruby-18c8f201.js"]);case"smalltalk":return ve(()=>import("./smalltalk-2d037a71.js").then(t=>t.s),["assets/smalltalk-2d037a71.js","assets/vendor-72681657.js"]);case"smarty":return ve(()=>import("./smarty-4f41333e.js").then(t=>t.s),["assets/smarty-4f41333e.js","assets/vendor-72681657.js"]);case"solr":return ve(()=>import("./solr-44ad3fce.js").then(t=>t.s),["assets/solr-44ad3fce.js","assets/vendor-72681657.js"]);case"soy":return ve(()=>import("./soy-50ca71d5.js").then(t=>t.s),["assets/soy-50ca71d5.js","assets/vendor-72681657.js","assets/htmlmixed-4729c668.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js","assets/css-14f5aaf0.js"]);case"sparql":return ve(()=>import("./sparql-77ba1cbe.js").then(t=>t.s),["assets/sparql-77ba1cbe.js","assets/vendor-72681657.js"]);case"spreadsheet":return ve(()=>import("./spreadsheet-55decc50.js").then(t=>t.s),["assets/spreadsheet-55decc50.js","assets/vendor-72681657.js"]);case"stylus":return ve(()=>import("./stylus-2a7a86bb.js").then(t=>t.s),["assets/stylus-2a7a86bb.js","assets/vendor-72681657.js"]);case"swift":return ve(()=>import("./swift-0b49034b.js").then(t=>t.s),["assets/swift-0b49034b.js","assets/vendor-72681657.js"]);case"stex":return ve(()=>import("./stex-ee55d532.js").then(t=>t.s),["assets/stex-ee55d532.js","assets/vendor-72681657.js","assets/stex-009e7529.js"]);case"verilog":return ve(()=>import("./verilog-1be5b7ea.js").then(t=>t.v),["assets/verilog-1be5b7ea.js","assets/vendor-72681657.js"]);case"tcl":return ve(()=>import("./tcl-de10759c.js").then(t=>t.t),["assets/tcl-de10759c.js","assets/vendor-72681657.js"]);case"textile":return ve(()=>import("./textile-bfd38b8f.js").then(t=>t.t),["assets/textile-bfd38b8f.js","assets/vendor-72681657.js"]);case"tiddlywiki":return ve(()=>import("./tiddlywiki-56ff0d44.js").then(t=>t.t),["assets/tiddlywiki-56ff0d44.js","assets/vendor-72681657.js"]);case"tiki":return ve(()=>import("./tiki-8ef6d034.js").then(t=>t.t),["assets/tiki-8ef6d034.js","assets/vendor-72681657.js"]);case"toml":return ve(()=>import("./toml-2798d8a3.js").then(t=>t.t),["assets/toml-2798d8a3.js","assets/vendor-72681657.js"]);case"tornado":return ve(()=>import("./tornado-7afbb941.js").then(t=>t.t),["assets/tornado-7afbb941.js","assets/vendor-72681657.js","assets/htmlmixed-4729c668.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js","assets/css-14f5aaf0.js","assets/overlay-13762f57.js"]);case"troff":return ve(()=>import("./troff-c8437abe.js").then(t=>t.t),["assets/troff-c8437abe.js","assets/vendor-72681657.js"]);case"ttcn":return ve(()=>import("./ttcn-d65ed2ad.js").then(t=>t.t),["assets/ttcn-d65ed2ad.js","assets/vendor-72681657.js"]);case"ttcn-cfg":return ve(()=>import("./ttcn-cfg-f4d0d5b7.js").then(t=>t.t),["assets/ttcn-cfg-f4d0d5b7.js","assets/vendor-72681657.js"]);case"turtle":return ve(()=>import("./turtle-7051f54b.js").then(t=>t.t),["assets/turtle-7051f54b.js","assets/vendor-72681657.js"]);case"twig":return ve(()=>import("./twig-d5b82bda.js").then(t=>t.t),["assets/twig-d5b82bda.js","assets/vendor-72681657.js","assets/multiplex-0f830e72.js"]);case"webidl":return ve(()=>import("./webidl-986bf49a.js").then(t=>t.w),["assets/webidl-986bf49a.js","assets/vendor-72681657.js"]);case"vb":return ve(()=>import("./vb-d13017bd.js").then(t=>t.v),["assets/vb-d13017bd.js","assets/vendor-72681657.js"]);case"vbscript":return ve(()=>import("./vbscript-5f8c0091.js").then(t=>t.v),["assets/vbscript-5f8c0091.js","assets/vendor-72681657.js"]);case"velocity":return ve(()=>import("./velocity-dec08125.js").then(t=>t.v),["assets/velocity-dec08125.js","assets/vendor-72681657.js"]);case"vhdl":return ve(()=>import("./vhdl-fadc9fae.js").then(t=>t.v),["assets/vhdl-fadc9fae.js","assets/vendor-72681657.js"]);case"vue":return ve(()=>import("./vue-5c790ad3.js").then(t=>t.v),["assets/vue-5c790ad3.js","assets/vendor-72681657.js","assets/overlay-13762f57.js","assets/xml-425bcb6b.js","assets/javascript-683ef49f.js","assets/coffeescript-5249f244.js","assets/css-14f5aaf0.js","assets/sass-1058d427.js","assets/stylus-2a7a86bb.js","assets/pug-86781cd0.js","assets/htmlmixed-4729c668.js","assets/multiplex-0f830e72.js"]);case"xml":return ve(()=>import("./xml-4998c250.js").then(t=>t.x),["assets/xml-4998c250.js","assets/vendor-72681657.js","assets/xml-425bcb6b.js"]);case"xquery":return ve(()=>import("./xquery-ac39b5ff.js").then(t=>t.x),["assets/xquery-ac39b5ff.js","assets/vendor-72681657.js"]);case"yacas":return ve(()=>import("./yacas-d949bbf8.js").then(t=>t.y),["assets/yacas-d949bbf8.js","assets/vendor-72681657.js"]);case"yaml":return ve(()=>import("./yaml-5182651e.js").then(t=>t.y),["assets/yaml-5182651e.js","assets/vendor-72681657.js"]);case"z80":return ve(()=>import("./z80-bd4cce56.js").then(t=>t.z),["assets/z80-bd4cce56.js","assets/vendor-72681657.js"]);case"mscgen":return ve(()=>import("./mscgen-61fad102.js").then(t=>t.m),["assets/mscgen-61fad102.js","assets/vendor-72681657.js"]);case"wast":return ve(()=>import("./wast-6e92b602.js").then(t=>t.w),["assets/wast-6e92b602.js","assets/vendor-72681657.js"]);case"makefile":return ve(()=>import("./makefile-4797d6b5.js").then(t=>t.m),["assets/makefile-4797d6b5.js","assets/vendor-72681657.js"]);case"mermaid":return ve(()=>import("./ruby-ddf0d0c8.js").then(t=>t.r),["assets/ruby-ddf0d0c8.js","assets/vendor-72681657.js","assets/ruby-18c8f201.js"]);case"solidity":return ve(()=>import("./solidity-03f43cb5.js"),["assets/solidity-03f43cb5.js","assets/vendor-72681657.js"]);case"elixir":return ve(()=>import("./elixir-facc4ef5.js"),["assets/elixir-facc4ef5.js","assets/vendor-72681657.js"]);default:throw new Error}},BX={path:e=>e,loadMode:(e,t)=>{AX(e).then(t)}},d0=["C","C#","C++","Clojure","CMake","Closure Stylesheets (GSS)","CoffeeScript","Common Lisp","Crystal","CSS","D","Dart","Django","Dockerfile","diff","EBNF","Elm","Erlang","elixir","Fortran","F#","Gherkin","Go","Ini","Shell","Groovy","HAML","Haskell","Haxe","HTML","HTTP","Java","JavaScript","JSON","Julia","Kotlin","LESS","LiveScript","Lua","Markdown","Mathematica","Matlab","MakeFile","Mermaid","Nginx","NSIS","Objective-C","Objective-C++","OCaml","Pascal","Perl","PHP","Plain Text","PowerShell","Properties files","ProtoBuf","Puppet","Python","Q","R","RPM Spec","Ruby","Rust","React","SAS","Scala","Scheme","SCSS","Smalltalk","Stylus","SQL","Solidity","Swift","LaTeX","sTeX","Tcl","Toml","Twig","TypeScript","VB.NET","VBScript","Verilog","VHDL","Vue","XML","XQuery","YAML"];function Jk(e){var s,a;const t=e.toLowerCase().trim();return(a=((s=Qo.modeInfo.filter(o=>d0.includes(o.name)).find(o=>{var i,l;return(l=(i=o.alias)==null?void 0:i.includes(t))!=null?l:!1}))==null?void 0:s.name)||d0.find(o=>o.toLocaleLowerCase()===t))!=null?a:Om}const LX=e=>{switch(e){case"React":return Qo.findModeByExtension("tsx");case"TypeScript":return Qo.findModeByExtension("ts");case"Matlab":return Qo.findModeByName("octave");case"MakeFile":return{mime:void 0,mode:"makefile"};case"Mermaid":return{mime:void 0,mode:"ruby"};case"Solidity":return{mime:void 0,mode:"solidity"};case"Ini":return{mime:void 0,mode:"ini"};case"elixir":return{mime:void 0,mode:"elixir"};default:return Qo.findModeByName(e.toLocaleLowerCase())}},Rv=e=>{const t=e.replace(/(.)\n!\[/g,`$1

![`);return PI().use(IM).use(jM).use(DM).parse(t)},sxe=e=>{const t=PI().use(SM).parse(e);RM(t,s=>{s.type==="element"&&s.tagName==="content"&&(s.tagName="div")});const n=AM(t,s=>s.type!=="comment");if(n)return BM(n)},PX=new NM.Converter,rxe=e=>PX.makeHtml(e),Jy=(e,t)=>{var g;const n=Rv(e),{spaceId:s="",pageId:a=""}=t!=null?t:{},o={},i={},l=[],c=(_,x,y={})=>{const b=qe(),E={uuid:b,type:_,spaceId:s,parentId:x,textColor:"",backgroundColor:y.backgroundColor||"",permissions:[],subNodes:[],data:y,status:1,version:0};return o[b]=E,i[x]=(i[x]||[]).concat(b),b},u=(_,x,y=a,b)=>{if(_.type==="paragraph"&&((!b||!x)&&(x=c(m.BlockType.TEXTAREA,y)),_.children.forEach(E=>p(E,x))),_.type==="thematicBreak"&&c(m.BlockType.DIVIDER,y),_.type==="heading"&&(x=c(m.BlockType.HEADER,y,{level:_.depth}),_.children.forEach(E=>p(E,x))),_.type==="html")if(/^<aside>/.test(_.value)){const E=_.value.substring(8,10)||"";x=c(m.BlockType.MARK,y,{backgroundColor:Pe.grey,icon:{type:"emoji",value:E}}),Rv(_.value.substring(10)).children.forEach(k=>u(k,x,y))}else c(m.BlockType.TEXTAREA,y,{segments:[{type:m.TextType.TEXT,text:_.value,enhancer:{}}]});if(_.type==="blockquote"){x=c(m.BlockType.QUOTE,y);const[E,...w]=_.children;E&&E.type==="paragraph"?(E.children.forEach(k=>p(k,x)),w.forEach(k=>u(k,x))):_.children.forEach(k=>u(k,x))}if(_.type==="list"&&(typeof _.start=="number"&&_.start,_.children.forEach(E=>h(E,x||y,_.ordered))),_.type==="code"){const E=hg();c(m.BlockType.CODE,y,{format:{language:Jk(_.lang||E||"")},segments:[{type:m.TextType.TEXT,text:_.value,enhancer:{}}]})}if(_.type==="table"&&!x){const w=_.children[0].children.map(()=>qe());x=c(m.BlockType.TABLE,y,{format:{tableBlockColumnOrder:w,tableBlockRowHeader:!0}}),_.children.forEach(k=>d(k,x,w))}_.type==="math"&&c(m.BlockType.EQUATION,y,{segments:[{type:m.TextType.TEXT,text:_.value,enhancer:{}}]})},d=(_,x,y)=>{const b=c(m.BlockType.TABLE_ROW,x);_.children.forEach((E,w)=>f(E,b,y[w]))},f=(_,x,y)=>{_.children.forEach(b=>p(b,x,void 0,void 0,y))},h=(_,x,y)=>{let b;y?b=c(m.BlockType.ORDER_LIST,x):_.checked===null?b=c(m.BlockType.LIST,x):b=c(m.BlockType.TODO,x,{checked:_.checked}),_.children.forEach((E,w)=>u(E,b,b,w===0))},p=(_,x,y={},b,E)=>{const w=o[x];if(!w)return;const k=T=>{if(T.text)if(E){const{collectionProperties:v}=w.data;v?v[E]=(v[E]||[]).concat(T):w.data.collectionProperties={[E]:[T]}}else w.data.segments=(w.data.segments||[]).concat(T)},C=()=>{if(E){const{collectionProperties:T}=w.data;if(T)return T[E]}else return w.data.segments};if(_.type==="text"){const T={type:m.TextType.TEXT,text:_.value,enhancer:y};b&&(T.type=m.TextType.URL,T.url=b),k(T)}if(_.type==="break"){const T=pn(C());T!=null&&T.text&&(T.text+=`
`)}if(_.type==="strong"&&_.children.forEach(T=>p(T,x,{...y,bold:!0},b,E)),_.type==="emphasis"&&_.children.forEach(T=>p(T,x,{...y,italic:!0},b,E)),_.type==="delete"&&_.children.forEach(T=>p(T,x,{...y,lineThrough:!0},b,E)),_.type==="inlineCode"){const T={type:m.TextType.TEXT,text:_.value,enhancer:{...y,code:!0}};b&&(T.type=m.TextType.URL,T.url=b),k(T)}if(_.type==="inlineMath"){const T={type:m.TextType.EQUATION,text:_.value,enhancer:y};k(T)}if(_.type==="link")if(_.children.length)_.children.forEach(T=>p(T,x,y,_.url,E));else{const T={type:m.TextType.URL,text:_.url,url:_.url,enhancer:y};k(T)}if(_.type==="html")if(_.value==="<br />"){const T=pn(C());T!=null&&T.text&&(T.text+=`
`)}else{const T={type:m.TextType.TEXT,text:_.value,enhancer:{}};k(T)}};Array.isArray(n.children)?n.children.forEach(_=>u(_)):u(n);for(const _ of Object.values(o))if(_.type===m.BlockType.TEXTAREA){const{segments:x}=_.data;if((x==null?void 0:x.length)===1){const[y]=x;if(y){const{type:b,text:E}=y;if(b===m.TextType.TEXT){const w=E.match(/^!\[(.*)\]\((.*)\)$/);w&&(_.type=m.BlockType.FILE,_.data={segments:mt(w[1]),size:0,extName:"png",display:"image"},l.push({parentId:_.parentId,blockId:_.uuid,url:(g=w[2])!=null?g:""}))}}}}return o},OX=e=>{var v,I,j,D,S,R,A,L;const{str:t,allLine:n,pageId:s,scene:a,tempPageId:o,currentBlockId:i,codeStartLineNum:l,popper:c,isInRight:u,resultContainer:d,modalContainer:f,uploadFile:h}=e;if(!t)return;if(t===`
`){const P=n.current.join("");if(P.trim().length===0){n.current=[""];return}if(P.endsWith(`
`))return}n.current.length===0?n.current.push(t):n.current[n.current.length-1]=((v=pn(n.current))!=null?v:"")+t;const p=a===ct.TextSelected||a===ct.BlockSelected||a===ct.TextSelectedAndWroteByAI||a===ct.BlockSelectedAndWroteByAI,g=p?o:s,_=(I=pn(n.current))!=null?I:"",x=_.trimStart(),y=x.startsWith("|");if((x==="`"||x==="``")&&t!==`
`)return;const b=x.startsWith("```");if(x==="!"&&t!==`
`)return;const E=x.startsWith("!["),w=K.blocks[i.current],k=(w==null?void 0:w.type)===m.BlockType.TABLE,C=(w==null?void 0:w.type)===m.BlockType.CODE,T=()=>{UX({popper:c,isInRight:u,isShowInTempPage:p,resultContainer:d,editContainerRef:f,currentBlockId:i})};if(t===`
`){if(y){if(k){const P=_.split("|").filter(V=>!!V.trim()).map(V=>V.trim()),M=(j=w==null?void 0:w.data.format)==null?void 0:j.tableBlockColumnOrder;if(!M)return;const U={};M.forEach((V,W)=>{var z;U[V]=[{text:(z=P[W])!=null?z:"",type:m.TextType.TEXT,enhancer:{}}]}),Qe({type:m.BlockType.TABLE_ROW,data:{collectionProperties:U,pageFixedWidth:!0,format:{}}},{parentId:i.current,last:!0},p),T()}else{const P=n.current[n.current.length-2];if(P&&P.trimStart().startsWith("|")){const M=Jy(`${P}${_}`),U=Object.values(M);let V,W;U.forEach(z=>{z.type===m.BlockType.TABLE?V=z:W=z}),V&&(pe(i.current,{type:m.BlockType.TABLE,data:V.data},p),W&&Qe({type:m.BlockType.TABLE_ROW,data:W.data},{parentId:i.current,first:!0},p),T())}}n.current.push("");return}if(b){if(l.current!==-1&&l.current===n.current.length-1){n.current.push("");return}l.current=-1;let P=_;for(let U=n.current.length-2;U>=0;U--){const V=(D=n.current[U])!=null?D:"";if(P=V+P,V.trimStart().startsWith("```"))break}const M=Jy(P);if(M){const U=Object.values(M)[0];U&&(pe(i.current,{type:U.type,data:U.data},p),i.current=Qe({type:m.BlockType.TEXTAREA,data:{segments:[]}},{parentId:g,after:i.current},p),T())}n.current.push("");return}if(l.current!==-1){let P=_;for(let M=n.current.length-2;M>=0;M--){const U=(S=n.current[M])!=null?S:"";if(U.trimStart().startsWith("```"))break;P=U+P}pe(i.current,{data:{segments:[{text:P,type:m.TextType.TEXT,enhancer:{}}]}},p),T(),n.current.push("");return}if(E){const P=(A=(R=_.match(new RegExp("(?<=\\]\\()https?:\\/\\/.*(?=\\))")))==null?void 0:R[0])!=null?A:"";if(P){pe(i.current,{type:m.BlockType.FILE,data:{segments:[],display:"image"}},p);const M=i.current;fetch(P).then(U=>U.blob().then(V=>{const W=UK(P);Av(h,M,W,V,T,p)}),()=>{dj(P).then(U=>{U&&Av(h,M,U.fileName,U.blob,T,p)}).catch(U=>{console.log(U)})})}else pe(i.current,{data:{segments:[{type:m.TextType.TEXT,enhancer:{},text:_}]}},p);i.current=Qe({type:m.BlockType.TEXTAREA,data:{segments:[]}},{parentId:g,after:i.current},p),T(),n.current.push("");return}n.current.push(""),!p&&MX(a,i),i.current=Qe({type:m.BlockType.TEXTAREA,data:{segments:[]}},{parentId:g,after:i.current},p)}else{if(y||l.current!==-1)return;if(k&&!y){b&&(l.current=n.current.length-1),i.current=Qe({type:b?m.BlockType.CODE:m.BlockType.TEXTAREA,data:{segments:[{text:b?"":t,type:m.TextType.TEXT,enhancer:{}}]}},{parentId:g,after:i.current},p);return}if(b){l.current=n.current.length-1,C||pe(i.current,{type:m.BlockType.CODE,data:{segments:[{text:"",type:m.TextType.TEXT,enhancer:{}}]}},p);return}if(E)return;let P=_;const M=_.startsWith("    ");M&&(P=_.trimStart());const U=Jy(P);if(U){const V=Object.values(U)[0];V&&pe(i.current,{type:V.type,data:{...V.data,segments:M?[{text:new Array(_.length-P.length).fill(" ").join(""),type:m.TextType.TEXT,enhancer:{}},...(L=V.data.segments)!=null?L:[]]:V.data.segments}},!0)}}T()},MX=(e,t)=>{(e===ct.PageEmpty||e===ct.PageHasContent||e===ct.PageContentWroteByAI)&&Di(()=>{const n=K.blocks[t.current];n&&pe(t.current,{type:n.type,data:n.data})})},Av=(e,t,n,s,a,o)=>{const i=new File([s],n);e({key:t,userId:K.user.uuid,spaceId:Ut(),file:i,type:"file",onComplete:async l=>{if(l.success){const c=await mp(i),{ossName:u}=l;pe(t,{type:m.BlockType.FILE,data:{ossName:u,...c,segments:mt(n),size:s.size}},o),a==null||a()}}})},UX=e=>{const{isInRight:t,isShowInTempPage:n,resultContainer:s,editContainerRef:a,currentBlockId:o,popper:i}=e;setTimeout(()=>{if(n){const x=s.current;if(!x)return;x.clientHeight>window.innerHeight*.38?x.style.paddingBottom="200px":x.style.paddingBottom="0",x.scrollHeight-x.scrollTop-200>x.clientHeight&&(x.scrollTop=x.scrollTop+x.clientHeight/2);return}const l=i==null?void 0:i.current;if(!l)return;const c=jn(`[data-block-id="${o.current}"]`,t);if(!c)return;l.state.elements.reference!==c&&(l.state.elements.reference=c);const u=a.current,d=jn(".next-space-page",t);if(!u||!d)return;const{reference:f}=l.state.elements;if(!f)return;const h=u.clientHeight+10,p=f.getBoundingClientRect(),g=d.getBoundingClientRect(),_=p.bottom-g.top;if(d.clientHeight-_<h){const y=_+d.scrollTop-(d.clientHeight-h);d.scrollTo(0,y+d.clientHeight/2)}l.update()})},Zy={[we.CPlus]:"Rewriting",[we.Java]:"Rewriting",[we.JavaScript]:"Rewriting",[we.TypeScript]:"Rewriting",[we.Python]:"Rewriting",[we.OtherCodeLanguage]:"Rewriting",[we.Comment]:"commenting",[we.BugFix]:"bugFixer",[we.Professional]:"changeTone",[we.Casual]:"changeTone",[we.Straightforward]:"changeTone",[we.Confident]:"changeTone",[we.Friendly]:"changeTone",[we.Longer]:"longer",[we.Simpler]:"shorter",[we.Improve]:"improve",[we.Chinese]:"translate",[we.ClassicalChinese]:"translate",[we.English]:"translate",[we.Korean]:"translate",[we.Japanese]:"translate",[we.French]:"translate",[we.German]:"translate",[we.OtherLanguage]:"translate",[we.Summary]:"summary",[we.Summarize]:"summarize",[we.ContinueWrite]:"continue",[we.Blog]:"blog",[we.Brainstorm]:"brainstorm",[we.Outline]:"outline",[we.Story]:"story",[we.DailyNotes]:"daily",[we.ProsAndConsList]:"prosConsList",[we.ActionItems]:"findActionItems",[we.Explain]:"explain"},VX=e=>{let t="";return e.split("data: ").forEach(n=>{if(n=n.trim(),n)try{const s=JSON.parse(n);t+=s.content}catch(s){return console.log("----parse error",s,e),""}}),t};let QR;const qX=e=>{QR=e},HX=e=>{const{closeSelf:t,editorScene:n,editType:s,popper:a,popcorn:o,blockId:i,selection:l,model:c,isInRight:u,from:d}=e,[f,h]=F.useState(n),[p,g]=F.useState(()=>{var Ee;return s&&ce.event("ai_trigger",{ai_type:Zy[s],from:d}),(Ee=u1[s!=null?s:""])==null?void 0:Ee.prompt}),[_,x]=F.useState(s&&xX.has(s)),y=F.useRef(null),b=gt(),E=F.useRef(s),w=ke(),k=no(jn(".next-space-page-content",u)).width,C=F.useRef(""),T=F.useRef(""),v=F.useRef(f===ct.BlockSelected?Es(K.ui.selectedBlocks):[]),I=F.useRef(),j=me(),D=F.useRef(null),S=F.useRef(null),R=F.useRef(),A=Ft(),L=F.useRef(-1),P=F.useRef([]),M=F.useRef([]),U=F.useRef(""),[V,W]=F.useState(!1),z=Ma(),Q=xn(),[Z,te]=F.useState(!1),re=no(o instanceof Element?o:void 0,{mode:"debounce",type:"height"}).height||30;F.useEffect(()=>{if(f===ct.PageEmpty)return;const Ee=D.current,Ge=jn(".next-space-page",u);if(!Ee||!Ge)return;const Je=a==null?void 0:a.current;if(!Je)return;const et=Ee.clientHeight+10,$t=o.getBoundingClientRect(),tt=Ge.getBoundingClientRect(),Ze=$t.bottom-tt.top;if(Ge.clientHeight-Ze>et)return;const It=Ze+Ge.scrollTop-(Ge.clientHeight-et);Ge.scrollTo(0,It),Je.update()},[a==null?void 0:a.current]),F.useEffect(()=>{var Ee,Ge;if(f===ct.TextSelected&&c)return R.current=c.mark((Ee=l==null?void 0:l.start)!=null?Ee:0,(Ge=l==null?void 0:l.end)!=null?Ge:0,{className:gn({backgroundColor:"var(--selection)"})}),()=>{var Je;(Je=R.current)==null||Je.remove()}},[]);const ne=F.useCallback(()=>{(f===ct.PageEmpty||f===ct.PageHasContent||f===ct.PageContentWroteByAI)&&w(()=>{const Ee=K.blocks[T.current];Ee&&pe(T.current,{type:Ee.type,data:Ee.data})})},[f,w]),Y=F.useCallback(()=>{_||U.current?j.warning({modalId:_X,title:"是否放弃当前AI处理结果？",confirm(){var Ge;De(),_&&ne(),(Ge=I.current)==null||Ge.abort(),t(),te(!1)}}):(t(),te(!1));const Ee=Q(i);Ee==null||Ee.requestFocus()},[i,t,Q,_,j,ne]);F.useEffect(()=>{const Ee=Ge=>{var et;const Je=Ge.target;(et=D.current)!=null&&et.contains(Je)||Je.closest("[data-list-item]")||Je.closest(`[data-modal-id="${Dv}"]`)||Y()};return qt.addEventListener("mouseup",Ee),()=>{qt.removeEventListener("mouseup",Ee)}},[t,Y,_,j,w,Q,i]),F.useEffect(()=>{var et;const{ui:Ee,blocks:Ge}=le();let Je="";if(f===ct.BlockSelected){const $t=Es(Ee.selectedBlocks);Je=tl($t)}f===ct.TextSelected&&(Je=de((et=Ge[i])==null?void 0:et.data.segments).slice(l==null?void 0:l.start,l==null?void 0:l.end)),C.current=Je,Je.length>1e3&&j.warning({modalId:Dv,title:"处理内容上限1000字，字数超出可能影响写作水平哦",noCancel:!0,confirm(){}})},[]),F.useEffect(()=>{if(!s||s===we.OtherLanguage)return;const Ee=new Set(Wk.map(Ge=>Ge.editType));(s===we.ContinueWrite||s===we.Summarize||s===we.Summary||s===we.Explain||Ee.has(s))&&ie(s)},[]);const X=()=>{const Ee=y.current;Ee&&xs(0).then(()=>{Ee.setSelectionRange(Ee.value.length,Ee.value.length),Ee.focus()})};F.useEffect(()=>{X()},[]);const oe=F.useCallback(()=>{var Ee;(Ee=I.current)==null||Ee.abort(),x(!1),g(""),X(),U.current&&(f===ct.BlockSelected&&h(ct.BlockSelectedAndWroteByAI),f===ct.TextSelected&&h(ct.TextSelectedAndWroteByAI)),(f===ct.PageEmpty||f===ct.PageHasContent||f===ct.PageContentWroteByAI)&&(h(ct.PageContentWroteByAI),ne())},[f,ne]);F.useEffect(()=>{const Ee=Ge=>{be("esc")(Ge)&&_&&oe()};return document.addEventListener("keydown",Ee),()=>{document.removeEventListener("keydown",Ee)}},[_,oe]);const ie=Ee=>{var Ge,Je;Ee===we.Replace||Ee===we.Insert||Ee===we.Close?ce.event("ai_finish",{ai_type:(Je=Zy[(Ge=E.current)!=null?Ge:""])!=null?Je:Ee,from:d}):ce.event("ai_trigger",{ai_type:Zy[Ee],from:d}),YR({pageId:b,blockId:i,tempPageId:U,allLine:P,archiveResult:M,selectedText:C,selectedBlockIds:v,editTypeRef:E,editType:Ee,scene:f,fetchAIResult:$e,setPrompt:g,getSelectedContent:Ne,removeTempPage:De,closeSelf:t,selection:l,model:c})},ge=Sv(f,ie,v).filter(Ee=>Ee.type!==$.LINE).length;F.useEffect(()=>{const Ee=!p&&!_&&ge>0;xs(Ee?100:0).then(()=>{te(Ee)})},[_,ge,p]);const Ne=()=>{var et;const{blocks:Ee}=le(),Ge=Ee[b];let Je="";return(f===ct.PageHasContent||f===ct.PageContentWroteByAI)&&(Je=tl((et=Ge==null?void 0:Ge.subNodes)!=null?et:[])),(f===ct.BlockSelected||f===ct.BlockSelectedAndWroteByAI||f===ct.TextSelected||f===ct.TextSelectedAndWroteByAI)&&(Je=C.current),Je},De=()=>{U.current&&(ha(U.current,!0),W(!1),U.current="")},Se=Ee=>{let Ge=[Ee];Ee.length!==1&&Ee.includes(`
`)&&(Ge=[],Ee.split(`
`).forEach((Je,et)=>{et!==0?Ge.push(`
`,Je):Ge.push(Je)}));for(const Je of Ge)OX({str:Je,pageId:b,scene:f,tempPageId:U.current,currentBlockId:T,codeStartLineNum:L,allLine:P,popper:a,isInRight:u,resultContainer:S,modalContainer:D,uploadFile:z})},Ie=()=>{var Ge;const Ee=(Ge=pn(P.current))!=null?Ge:"";if(!Ee.endsWith(`
`)){const Je=Ee.startsWith("```"),et=Ee.startsWith("|"),$t=Ee.startsWith("![");(Je||et||$t)&&Se(`
`)}switch(ne(),x(!1),g(""),f){case ct.PageEmpty:case ct.PageHasContent:h(ct.PageContentWroteByAI);break;case ct.TextSelected:h(ct.TextSelectedAndWroteByAI);break;case ct.BlockSelected:h(ct.BlockSelectedAndWroteByAI);break}},Ke=(Ee,Ge)=>Qe({type:m.BlockType.TEXTAREA,data:{segments:[]}},{parentId:Ee,after:Ge.after},Ge.ignoreOP),dt=()=>{var Ee,Ge,Je;switch(f){case ct.PageEmpty:T.current=i;break;case ct.PageHasContent:{const{blocks:et}=le();de((Ee=et[i])==null?void 0:Ee.data.segments).trim()?T.current=Ke(b,{after:i}):T.current=i;break}case ct.BlockSelected:case ct.TextSelected:case ct.BlockSelectedAndWroteByAI:case ct.TextSelectedAndWroteByAI:{if(!K.blocks[U.current]){U.current=Qe({type:m.BlockType.PAGE,hidden:!0},{parentId:b},!0),W(!0),T.current=Ke(U.current,{ignoreOP:!0});return}const{blocks:$t}=le();de((Ge=$t[T.current])==null?void 0:Ge.data.segments).trim()&&(T.current=Ke(U.current,{after:T.current,ignoreOP:!0}));break}case ct.PageContentWroteByAI:{const{blocks:et}=le();de((Je=et[T.current])==null?void 0:Je.data.segments).trim()&&(T.current=Ke(b,{after:T.current}));break}}},$e=async Ee=>{x(!0);try{const Ge={"Content-Type":"application/json"};if(un){const Ze=yx();Ze&&(Ge.Authorization=`Bearer ${Ze}`)}I.current=new AbortController;const Je=await fetch("/api/completions",{signal:I.current.signal,method:"POST",headers:Ge,body:JSON.stringify({...Ee,spaceId:A.uuid,blockId:i})});if(!Je.ok)return;const et=Je.body;if(!et)return;const $t=et.getReader(),tt=new TextDecoder;for(dt(),P.current.join("").trim()&&(M.current=P.current),P.current=[];;){const{value:Ze,done:jt}=await $t.read();if(jt){Ie();break}const It=tt.decode(Ze);if(It.startsWith("error:")){x(!1),It.includes("已达到使用次数上限")?j.warning({title:`${cr(A.planType)}赠送次数已全部使用`,noCancel:!0,confirm(){var N;(N=I.current)==null||N.abort(),t()}}):(ne(),ye.warning(It));break}const nn=VX(It);location.origin.includes("flowus.cn")||console.log(It,nn),Se(nn)}}catch(Ge){console.log(Ge)}},ut=()=>{var $t,tt,Ze,jt;if(!p||!p.trim())return;const{blocks:Ee}=le(),Ge=Ee[b];if(!Ge)return;const Je=de(Ge.data.segments);let et;if(E.current===we.OtherLanguage&&p.startsWith("把当前语言翻译成"))et={type:"edit",prompt:p,selectedText:Ne()};else if(E.current===we.OtherCodeLanguage&&p.startsWith("把当前代码改写成"))et={type:"rewriting",selectedText:Ne(),language:(tt=($t=p.split("把当前代码改写成："))==null?void 0:$t[1])!=null?tt:""};else if(f===ct.BlockSelected||f===ct.TextSelected||f===ct.BlockSelectedAndWroteByAI||f===ct.TextSelectedAndWroteByAI)De(),et={type:"edit",prompt:p,selectedText:C.current,pageTitle:Je};else{const It=FX.find(nn=>{var O;const N=(O=u1[nn])==null?void 0:O.prompt;return N?p.startsWith(N):!1});It?et={type:(jt=(Ze=u1[It])==null?void 0:Ze.type)!=null?jt:"write",topic:p}:et={type:"write",prompt:p}}$e(et)};return r.jsx("div",{className:"min-w-[400px]",style:{width:k},ref:D,children:r.jsxs(Fe,{visible:Z,interactive:!0,offset:({placement:Ee})=>Ee==="bottom-start"?[0,4]:[0,re],placement:"bottom-start",theme:"none",animation:"shift-away",maxWidth:"unset",className:"next-modal border w-full block",popupClass:"next-modal",popup:r.jsx(ze,{className:"py-2 w-72 max-w-[calc(100vw-24px)] overflow-y-auto",items:Sv(f,ie,v),onItemClick:({data:Ee})=>ie(Ee.editType)}),children:[V&&r.jsx("div",{className:"p-2 pb-0 whitespace-pre-wrap text-t2 max-h-[40vh] overflow-auto",ref:S,children:r.jsx(Al.Provider,{value:Tt.PAGE_LITE_PREVIEW,children:r.jsx(au.Provider,{value:S,children:r.jsx(QR,{uuid:U.current,readonly:!0})})})}),r.jsxs("div",{className:"flex border-grey6 rounded py-1.5 px-2 items-center",children:[r.jsx(H,{name:"IcAi",className:"mr-2 mt-0.5 self-start cursor-pointer text-[#00E384]",size:"middle"}),_&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-t2 text-[#00E384]",children:"AI正在写作..."}),r.jsx(H,{className:"animate-spin text-grey4",name:"IcNaviLoading",size:"middle"}),r.jsx("span",{className:"text-t2 text-grey4 ml-auto cursor-pointer",onClick:oe,children:"停止 ESC"})]}),!_&&r.jsxs(r.Fragment,{children:[r.jsx(oo,{ref:y,autoFocus:!0,singleLine:!1,placeholder:"告诉AI写什么...",boxClassName:"flex-grow",fontClassName:"text-t2",onKeyDown:Ee=>{Ee.stopPropagation(),Ee.nativeEvent.stopPropagation(),be("esc")(Ee)&&Y(),!Ee.nativeEvent.isComposing&&(Ee.key==="Enter"&&ut(),!p&&be("Backspace")(Ee)&&Y())},value:p,onChange:Ee=>{const Ge=Ee.target;Ge&&g(Ge.value)}}),r.jsx(H,{name:"IcCommentSend",onClick:()=>ut(),size:"large",className:Yt("text-grey4 self-end cursor-pointer justify-end",p&&"text-active_color")})]})]})]})})},lu=()=>{const e=me(),t=On(),n=Qd();return F.useCallback(s=>{if(!n)return;const{popcorn:a,editorScene:o,blockId:i,model:l,offset:c,editType:u,selection:d,from:f}=s;e.dropdown({modalId:Xe.AI_EDITOR,popcorn:a,offset:c!=null?c:[0,2],placement:"bottom-start",disableEsc:!0,autoClose:!1,blockMaskClick:!1,content({onCloseModal:h,popper:p}){return r.jsx(HX,{popcorn:a,isInRight:t,model:l,blockId:i,popper:p,closeSelf:h,editorScene:o,editType:u,from:f,selection:d})}})},[n,t,e])},Bv=({hasContent:e})=>{const t=Xp(),n=lu(),s=mw(),a=document.querySelector(`[data-block-id="${t}"]`);if(!a)return null;let o=[];return e?o=[{type:$.BLOCK_ITEM,data:{editType:we.Summarize,title:"总结",icon:"IcSummarize"}},{type:$.BLOCK_ITEM,data:{editType:we.Summary,icon:"IcSummary",title:"摘要"}},{type:$.BLOCK_ITEM,data:{editType:we.Explain,icon:"IcExplain",title:"解释"}}]:o=$R.map(i=>({type:$.BLOCK_ITEM,data:i})),r.jsx(ze,{keyDownPriority:Tr+1,className:Mi,items:o,onItemClick:({data:i})=>{const{editType:l}=i;nr(t).performChange(u=>{u.shadow().select(s.left,s.right).delete().release()}),n({popcorn:a,blockId:t,from:Ll.ContextMenu,editorScene:e?ct.PageHasContent:ct.PageEmpty,editType:l})}})},$X=()=>{const e=Xp(),t=lu(),n=mw(),s=document.querySelector(`[data-block-id="${e}"]`);if(!s)return null;const a=Wk.map(o=>({type:$.BLOCK_ITEM,data:o}));return r.jsx(ze,{keyDownPriority:Tr+1,className:Mi,items:a,onItemClick:({data:o})=>{const{editType:i}=o;nr(e).performChange(c=>{c.shadow().select(n.left,n.right).delete().release()}),t({popcorn:s,blockId:e,from:Ll.ContextMenu,editorScene:ct.PageHasContent,editType:i})}})},GX=()=>[{title:"Figma",placeholder:"https://www.figma.com/...",embedType:mr.figma},{title:"Airtable",placeholder:"https://www.airtable.com/...",embedType:mr.airtable},{title:"Sketch",placeholder:"https://www.sketch.com/...",embedType:mr.sketch},{title:"墨刀",placeholder:"https://www.modao.cc/...",embedType:mr.modao},{title:"摹客",placeholder:"https://app.mockplus.cn/...",embedType:mr.mockplus,keywords:["mockplus"]},{title:"Excalidraw",placeholder:"https://www.excalidraw.com/...",embedType:mr.excalidraw},{title:"ProcessOn",placeholder:"https://www.processon.com/...",embedType:mr.processon},{title:"Canva",placeholder:"https://www.canva.cn/...",embedType:mr.canva},{title:"Bilibili",placeholder:"https://www.bilibili.com/...",embedType:mr.bilibili},{title:"腾讯视频",placeholder:"https://v.qq.com/...",embedType:mr.vqq,keywords:["tencentvideo"]},{title:"优酷视频",placeholder:"https://v.youku.com/...",embedType:mr.youku,keywords:["youku"]},{title:"西瓜视频",placeholder:"https://www.ixigua.com/...",embedType:mr.xigua,keywords:["ixigua"]},{title:"网易云音乐",placeholder:"https://music.163.com/...",embedType:mr.music163,keywords:["neteasemusic"],py:"wangyiyunyinyue",initials:"wyyyy"},{title:"CodeSandbox",placeholder:"https://www.codesandbox.io/...",embedType:mr.codesandbox},{title:"CodePen",placeholder:"https://www.codepen.io/...",embedType:mr.codepen}],Zk=()=>{const e={},t=Wa();return GX().forEach(n=>e[n.embedType]={type:$.BLOCK_ITEM,data:{type:m.BlockType.EMBED,actionType:Oe.CREATE,image:new URL(`${bt}/embeds/${t?"dark":"light"}/ic_insert_${n.embedType}.png`).href,title:n.title,placeholder:n.placeholder,py:n.py,initials:n.initials,keywords:n.keywords,params:{data:{embedType:n.embedType},local:!0}}}),e},Bt=e=>{const{title:t,image:n}=e;return r.jsxs("div",{className:"p-2 bg-grey1 dark:bg-grey6 text-t4-medium text-white rounded w-40",children:[n&&r.jsx("img",{src:`${bt}/block-description/${n}.png`,alt:t,className:"mb-2 w-full bg-white rounded-sm"}),r.jsx("span",{children:t})]})},JR=e=>{const t={textarea:{type:$.BLOCK_ITEM,data:{type:m.BlockType.TEXTAREA,actionType:Oe.CREATE,icon:"MIcInsertBlockText",title:"正文",context:Bt({title:"主要文本撰写",image:"textarea"}),keywords:["text"]}},todo:{type:$.BLOCK_ITEM,data:{type:m.BlockType.TODO,actionType:Oe.CREATE,icon:"MIcInsertBlockTodo",title:"待办列表",context:Bt({title:"管理待办事项",image:"todo"}),keywords:["todo"]}},subPage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.PAGE,actionType:Oe.CREATE,icon:"MIcInsertBlockPage",title:"页面",context:Bt({title:"当前页面中创建子级页面",image:"page"}),keywords:["page"]}},linkPage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.REFERENCE,actionType:Oe.CREATE,icon:"MIcInsertLinktopage",title:"引用页面",keywords:["linkPage"],context:Bt({title:"引用已有页面/多维表/文件夹",image:"link_page"}),params:{data:{display:"linkPage"}}}},h1:{type:$.BLOCK_ITEM,data:{type:m.BlockType.HEADER,actionType:Oe.CREATE,icon:"MIcInsertBlockH1",quick:"h1",title:"标题1",context:Bt({title:"创建一级标题",image:"h1"}),keywords:["h1","heading1"],params:{data:{level:1}}}},h2:{type:$.BLOCK_ITEM,data:{type:m.BlockType.HEADER,actionType:Oe.CREATE,icon:"MIcInsertBlockH2",title:"标题2",quick:"h2",context:Bt({title:"创建二级标题",image:"h2"}),keywords:["h2","heading2"],params:{data:{level:2}}}},h3:{type:$.BLOCK_ITEM,data:{type:m.BlockType.HEADER,actionType:Oe.CREATE,icon:"MIcInsertBlockH3",title:"标题3",quick:"h3",context:Bt({title:"创建三级标题",image:"h3"}),keywords:["h3","heading3"],params:{data:{level:3}}}},h4:{type:$.BLOCK_ITEM,data:{type:m.BlockType.HEADER,actionType:Oe.CREATE,icon:"MIcInsertBlockH4",title:"标题4",quick:"h4",context:Bt({title:"创建四级标题",image:"h4"}),keywords:["h4","heading4"],params:{data:{level:4}}}},table:{type:$.BLOCK_ITEM,data:{type:m.BlockType.TABLE,actionType:Oe.CREATE,icon:"MIcInsertTable",context:Bt({title:"支持纯文本/行内元素",image:"table"}),title:"简单表格",keywords:["simple table","table"]}},list:{type:$.BLOCK_ITEM,data:{type:m.BlockType.LIST,actionType:Oe.CREATE,icon:"MIcInsertBlockBullrted",title:"项目列表",context:Bt({title:"显示项目符号的列表",image:"list"}),keywords:["list","bulleted list"]}},orderList:{type:$.BLOCK_ITEM,data:{type:m.BlockType.ORDER_LIST,actionType:Oe.CREATE,icon:"MIcInsertBlockNum",title:"编号列表",context:Bt({title:"显示编号的列表",image:"order_list"}),keywords:["numbered list"]}},foldList:{type:$.BLOCK_ITEM,data:{type:m.BlockType.FOLD_LIST,actionType:Oe.CREATE,icon:"MIcInsertBlockToggle",title:"折叠列表",context:Bt({title:"可折叠隐藏/展开显示",image:"fold_list"}),keywords:["toggle list"]}},divider:{type:$.BLOCK_ITEM,data:{type:m.BlockType.DIVIDER,actionType:Oe.CREATE,icon:"MIcInsertDivider",title:"分割线",context:Bt({title:"进行区域划分",image:"divider"}),keywords:["divider"]}},quote:{type:$.BLOCK_ITEM,data:{type:m.BlockType.QUOTE,actionType:Oe.CREATE,icon:"MIcInsertQuote",title:"引述文字",context:Bt({title:"可批量移入块",image:"quote"}),keywords:["quote"]}},mark:{type:$.BLOCK_ITEM,data:{type:m.BlockType.MARK,actionType:Oe.CREATE,icon:"MIcInsertCallout",title:"着重文字",py:"zhuozhongwenzi",context:Bt({title:"可更换emoji/批量移入块",image:"mark"}),keywords:["call out mark"]}},code:{type:$.BLOCK_ITEM,data:{type:m.BlockType.CODE,actionType:Oe.CREATE,icon:"MIcInsertBlockCode",title:"代码片段",context:Bt({title:"创建代码片段块",image:"code"}),keywords:["code block"],params:{local:!0,data:{format:{language:Om}}}}},equation:{type:$.BLOCK_ITEM,data:{type:m.BlockType.EQUATION,actionType:Oe.CREATE,icon:"MIcInsertEquation",title:"数学公式",context:Bt({title:"LaTex数学公式块",image:"equation"}),keywords:["math equation latex"],params:{local:!0}}},mindMap:{type:$.BLOCK_ITEM,data:{type:m.BlockType.MIND_MAPPING,actionType:Oe.CREATE,icon:"MIcInsertMindMap",title:"思维导图",context:Bt({title:"创建思维导图",image:"mind-map"}),keywords:["embed mindmap brainmap naotu nt"],params:{local:!0}}},mindMapPage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.MIND_MAPPING_PAGE,actionType:Oe.CREATE,icon:"MIcInsertMindMap",title:"思维导图页面",context:Bt({title:"创建思维导图页面",image:"mind-map"}),keywords:["mindmap brainmap naotu nt"],params:{local:!0}}},toggleHeader1:{type:$.BLOCK_ITEM,data:{type:m.BlockType.TOGGLE_HEADER,actionType:Oe.CREATE,icon:"MIcInsertBlockToggleH1",title:"折叠标题1",context:Bt({title:"创建折叠标题1",image:"toggle-h1"}),keywords:["toggle heading h1"],params:{data:{level:1}}}},toggleHeader2:{type:$.BLOCK_ITEM,data:{type:m.BlockType.TOGGLE_HEADER,actionType:Oe.CREATE,icon:"MIcInsertBlockToggleH2",title:"折叠标题2",context:Bt({title:"创建折叠标题2",image:"toggle-h2"}),keywords:["toggle heading h2"],params:{data:{level:2}}}},toggleHeader3:{type:$.BLOCK_ITEM,data:{type:m.BlockType.TOGGLE_HEADER,actionType:Oe.CREATE,icon:"MIcInsertBlockToggleH3",title:"折叠标题3",context:Bt({title:"创建折叠标题3",image:"toggle-h3"}),keywords:["toggle heading h3"],params:{data:{level:3}}}},toggleHeader4:{type:$.BLOCK_ITEM,data:{type:m.BlockType.TOGGLE_HEADER,actionType:Oe.CREATE,icon:"MIcInsertBlockToggleH4",title:"折叠标题4",context:Bt({title:"创建折叠标题4",image:"toggle-h4"}),keywords:["toggle heading h4"],params:{data:{level:4}}}}},n={writing:{type:$.BLOCK_ITEM,data:{actionType:Oe.AI_EDITOR,icon:"IcAi",title:"让AI写作",keywords:["Ask AI to write..."]}},brainstorm:{type:$.BLOCK_ITEM,data:{aiEditType:we.Brainstorm,actionType:Oe.AI_EDITOR,icon:"IcContinueWriting",title:"头脑风暴",keywords:["brainstorm ideas"]}},blog:{type:$.BLOCK_ITEM,data:{aiEditType:we.Blog,actionType:Oe.AI_EDITOR,icon:"IcContinueWriting",title:"博客文章",keywords:["blog posts"]}},more:{type:$.OPERATION,data:{actionType:Oe.AI_EDITOR,icon:"IcMore",title:"更多",keywords:["more"],hasArrow:!0,renderSubMenu:()=>r.jsx(Bv,{})}}},s={writing:{type:$.BLOCK_ITEM,data:{actionType:Oe.AI_EDITOR,icon:"IcAi",title:"让AI写作",keywords:["Ask AI to write..."]}},continueWriting:{type:$.BLOCK_ITEM,data:{aiEditType:we.ContinueWrite,actionType:Oe.AI_EDITOR,icon:"IcContinueWriting",title:"继续写作",keywords:["Continue writing"]}},translate:{type:$.OPERATION,data:{actionType:Oe.AI_EDITOR,icon:"IcTranslate",title:"翻译",keywords:["Translate"],hasArrow:!0,renderSubMenu:()=>r.jsx($X,{})},attribute:{"data-prevent-event":!0}},more:{type:$.OPERATION,data:{actionType:Oe.AI_EDITOR,icon:"IcMore",title:"更多",keywords:["more"],hasArrow:!0,renderSubMenu:()=>r.jsx(Bv,{hasContent:!0})},attribute:{"data-prevent-event":!0}}},a={template:{type:$.BLOCK_ITEM,data:{type:m.BlockType.TEMPLATE,actionType:Oe.CREATE,icon:"MIcInsertBlockTemplateButton",title:"模板按钮",py:"mubananniu",context:Bt({title:"快速创建常用块副本",image:"template"}),keywords:["template button"]}},sync:{type:$.BLOCK_ITEM,data:{type:m.BlockType.SYNC_CONTAINER,actionType:Oe.CREATE,icon:"MIcInsertSyncedBlock",title:"同步块",context:Bt({title:"跨页面同步块内容",image:"sync"}),keywords:["sync"]}}},o={};Object.keys(t).forEach(d=>{if(!["divider","linkPage","table","mindMapPage"].includes(d)){const f=t[d];o[d]={...f,data:{...f.data,actionType:Oe.TURN_INTO}}}});const[i,l]=Dg.map(d=>d.items.map(f=>{const h=d.title==="文字颜色";return{type:$.BLOCK_ITEM,data:{actionType:Oe.COLOR,...h?{textColor:f.colorkey||"default"}:{backgroundColor:f.colorkey||"default"},title:f.desc,keywords:[f.colorkey?`${h?"":"bg "}${f.colorkey.split("_")[0]}`:"default",f.colorkey?`${h?"":"background "}${f.colorkey.split("_")[0]}`:"default"],params:{...h?{backgroundColor:"",textColor:f.colorkey||""}:{backgroundColor:f.colorkey||"",textColor:""}}}}})),c={type:$.BLOCK_ITEM,data:{actionType:Oe.COLOR,title:"上次使用颜色"}},u={aiAssistantWithEmptyDoc:n,aiAssistantWithNotEmptyDoc:s,basicBlock:t,media:{image:{type:$.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Oe.CREATE,icon:"MIcInsertBlockImage",title:"图片",context:Bt({title:"上传或插入图片链接",image:"image"}),keywords:["image","picture"],params:{data:{display:"image"},local:!0}}},video:{type:$.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Oe.CREATE,icon:"MIcInsertBlockVideo",title:"视频",context:Bt({title:"上传或插入视频链接",image:"video"}),keywords:["video"],params:{data:{display:"video"},local:!0}}},audio:{type:$.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Oe.CREATE,icon:"MIcInsertBlockAudio",title:"音频",context:Bt({title:"上传或插入音频链接",image:"audio"}),keywords:["audio"],params:{data:{display:"audio"},local:!0}}},file:{type:$.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Oe.CREATE,icon:"MIcInsertBlockFile",title:"文件",context:Bt({title:"上传或插入文件链接",image:"file"}),keywords:["file"],params:{local:!0,data:{display:"file"}}}},folder:{type:$.BLOCK_ITEM,data:{type:m.BlockType.FOLDER,actionType:Oe.CREATE,icon:"MIcInsertBlockFolder",title:"文件夹",context:Bt({title:"当前页面中创建子级文件夹页面",image:"folder"}),keywords:["folder"],params:{local:!0}}},bookmark:{type:$.BLOCK_ITEM,data:{type:m.BlockType.BOOKMARK,actionType:Oe.CREATE,icon:"MIcInsertBlockBookmark",title:"网页书签",context:Bt({title:"书签形式插入在线网页",image:"bookmark"}),keywords:["web bookmark"],params:{local:!0}}}},inlineElement:{date:{type:$.BLOCK_ITEM,data:{actionType:Oe.CREATE,type:Dr.DATE,icon:"MIcInsertBlockDate",title:"行内日期",isInline:!0,context:Bt({title:"插入行内日期",image:"inline_date"}),keywords:["inline date inline time"]}},link_page:{type:$.BLOCK_ITEM,data:{actionType:Oe.CREATE,type:Dr.LINK_PAGE,icon:"MIcInsertPageInline",title:"行内引用页面",isInline:!0,context:Bt({title:"行内形式引用已有页面",image:"inline_link_page"}),keywords:["inline linkPage"]}},page:{type:$.BLOCK_ITEM,data:{actionType:Oe.CREATE,type:Dr.PAGE,icon:"MIcInsertSubpage",title:"行内页面",isInline:!0,context:Bt({title:"行内形式页面",image:"inline_page"}),keywords:["inline page","hangneiyemian","hnym","hnys hnym","hnys inline Page"]}},equation:{type:$.BLOCK_ITEM,data:{actionType:Oe.CREATE,type:Dr.EQUATION,icon:"MIcInlineEquation",title:"行内公式",isInline:!0,context:Bt({title:"行内形式插入公式",image:"inline_equation"}),keywords:["inline equation"]}},person:{type:$.BLOCK_ITEM,data:{actionType:Oe.CREATE,type:Dr.PEOPLE,icon:"MIcMentionPerson",title:"人员",isInline:!0,context:Bt({title:"提及空间内成员",image:"inline_person"}),keywords:["inline person"]}},emoji:{type:$.BLOCK_ITEM,data:{actionType:Oe.CREATE,type:Dr.EMOJI,image:new URL(Object.assign({"../../../image/embeds/dark/ic_insert_emoji.png":dX,"../../../image/embeds/light/ic_insert_emoji.png":fX})[`../../../image/embeds/${e?"dark":"light"}/ic_insert_emoji.png`],self.location).href,title:"Emoji",isInline:!0,context:Bt({title:"插入行内 Emoji",image:"inline_emoji"}),keywords:["inline emoji"]}}},database:{embedBitable:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Oe.CREATE,icon:"MIcInsertDatabase",title:"表格",context:Bt({title:"嵌入表格视图多维表",image:"embed_bitable"}),keywords:["database"],tableType:m.CollectionViewType.TABLE}},bitablePage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Oe.CREATE,icon:"MIcInsertBlockDatabase",title:"表格页面",context:Bt({title:"插入表格视图多维表子页面",image:"bitable_page"}),keywords:["database page"],tableType:m.CollectionViewType.TABLE}},embedBitableBoard:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Oe.CREATE,icon:"MIcInsertBoard",title:"看板",context:Bt({title:"嵌入看板视图多维表",image:"embed_bitable_board"}),keywords:["database board"],tableType:m.CollectionViewType.BOARD}},bitableBoardPage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Oe.CREATE,icon:"MIcInsertBlockBoard",title:"看板页面",context:Bt({title:"插入看板视图多维表子页面",image:"bitable_board_page"}),keywords:["database board page"],tableType:m.CollectionViewType.BOARD}},embedBitableGallery:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Oe.CREATE,icon:"MIcInsertGallery",title:"画廊",context:Bt({title:"嵌入画廊视图多维表",image:"embed_bitable_gallery"}),keywords:["database gallery"],tableType:m.CollectionViewType.GALLERY}},bitableGalleryPage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Oe.CREATE,icon:"MIcInsertBlockGallery",title:"画廊页面",context:Bt({title:"插入画廊视图多维表子页面",image:"bitable_gallery_page"}),keywords:["database gallery page"],tableType:m.CollectionViewType.GALLERY}},embedBitableList:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Oe.CREATE,icon:"MIcInsertList",title:"目录",context:Bt({title:"嵌入目录视图多维表",image:"embed_bitable_list"}),keywords:["database list"],tableType:m.CollectionViewType.LIST}},bitableListPage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Oe.CREATE,icon:"MIcInsertBlockList",title:"目录页面",context:Bt({title:"插入目录视图多维表子页面",image:"bitable_list_page"}),keywords:["database list page"],tableType:m.CollectionViewType.LIST}},embedBitableTimeline:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Oe.CREATE,icon:"MIcInsertTimeline",title:"时间轴",context:Bt({title:"嵌入时间轴视图多维表",image:"embed_bitable_timeline"}),keywords:["database timeline"],tableType:m.CollectionViewType.TIMELINE}},bitableTimelinePage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Oe.CREATE,icon:"MIcInsertBlockTimeline",title:"时间轴页面",context:Bt({title:"插入时间轴视图多维表子页面",image:"bitable_timeline_page"}),keywords:["database timeline page"],tableType:m.CollectionViewType.TIMELINE}},embedBitableForm:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Oe.CREATE,icon:"MIcInsertBlockForm",title:"收集表",context:Bt({title:"嵌入收集表视图多维表",image:"embed_bitable_form"}),keywords:["database form"],tableType:m.CollectionViewType.FORM}},bitableFormPage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Oe.CREATE,icon:"MIcInsertForm",title:"收集表页面",context:Bt({title:"插入收集表视图多维表子页面",image:"bitable_form_page"}),keywords:["database form page"],tableType:m.CollectionViewType.FORM}},embedBitableCalendar:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW,actionType:Oe.CREATE,icon:"MIcInsertCalendar",title:"日历",context:Bt({title:"嵌入日历视图多维表",image:"embed_bitable_calendar"}),keywords:["database calendar"],tableType:m.CollectionViewType.CALENDAR}},bitableCalendarPage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLLECTION_VIEW_PAGE,actionType:Oe.CREATE,icon:"MIcInsertBlockCalendar",title:"日历页面",context:Bt({title:"插入日历视图多维表子页面",image:"bitable_calendar_page"}),keywords:["database calendar page"],tableType:m.CollectionViewType.CALENDAR}},linkBitable:{type:$.BLOCK_ITEM,data:{type:m.BlockType.REFERENCE_COLLECTION,actionType:Oe.CREATE,icon:"MIcInsertPageInline",title:"引用多维表",context:Bt({title:"嵌入已有多维表",image:"link_bitable"}),keywords:["linked database","link table"]}}},embed:{webpage:{type:$.BLOCK_ITEM,data:{type:m.BlockType.EMBED,actionType:Oe.CREATE,icon:"MIcInsertBlockWeb",title:"嵌入网页",context:Bt({title:"直接嵌入在线网页",image:"embed_webpage"}),keywords:["embed web"],params:{data:{embedType:mr.webpage},local:!0}}},file:{type:$.BLOCK_ITEM,data:{type:m.BlockType.FILE,actionType:Oe.CREATE,icon:"MIcInsertPdf",title:"嵌入文件",context:Bt({title:"直接嵌入可预览文件",image:"embed_file"}),keywords:["embed file"],params:{data:{display:"file",viewMode:Vs.preview},local:!0}}},folder:{type:$.BLOCK_ITEM,data:{type:m.BlockType.FOLDER,actionType:Oe.CREATE,icon:"MIcInsertFolder",title:"嵌入文件夹",context:Bt({title:"直接嵌入可预览文件夹",image:"embed_folder"}),keywords:["embed folder"],params:{data:{viewMode:Vs.preview},local:!0}}},...Zk()},advanced:a,layout:{leftColumn:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Oe.CREATE,icon:"MIcInsertBlockLeft",title:"在左侧插入分栏",params:{left:!0}}},rightColumn:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Oe.CREATE,icon:"MIcInsertBlockRight",title:"在右侧插入分栏",params:{left:!1}}},twoColumn:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Oe.CREATE,icon:"MIcInsertDownTwo",quick:"2",title:"两列分栏",params:{columnCount:2}}},threeColumn:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Oe.CREATE,icon:"MIcInsertDownThree",quick:"3",title:"三列分栏",params:{columnCount:3}}},fourColumn:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Oe.CREATE,icon:"MIcInsertDownFour",quick:"4",title:"四列分栏",params:{columnCount:4}}},fiveColumn:{type:$.BLOCK_ITEM,data:{type:m.BlockType.COLUMN_LIST,actionType:Oe.CREATE,icon:"MIcInsertDownFive",quick:"5",title:"五列分栏",params:{columnCount:5}}}},turninto:o,action:{delete:{type:$.BLOCK_ITEM,data:{actionType:Oe.DELETE,icon:"IcMenuDelete",keywords:["delete"],title:"删除"}},copy:{type:$.BLOCK_ITEM,data:{actionType:Oe.COPY,icon:"IcMenuDuplicate",keywords:["copy"],title:"拷贝副本"}},moveTo:{type:$.BLOCK_ITEM,data:{actionType:Oe.MOVETO,icon:"IcMenuMove",keywords:["move"],title:"移动到"}}},lastUsedColor:{lastUsedColor:c},color:i,colorBackground:l};return W3(u,(d,f)=>{W3(d,h=>{var p,g;h.data.initials=(p=h.data.initials)!=null?p:sg(h.data.title),h.data.py=(g=h.data.py)!=null?g:yl(h.data.title),h.data.category=al[f]})}),u},zX=OI(JR),WX=OI((e,t)=>{const n=JR(e);return em(n).forEach(s=>{const a=n[s],o=al[s],i=AS[s];em(a).forEach(l=>{const c=n[s][l];c!=null&&c.data&&(n[s][l].data.keywords=[...new Set([c.data.quick,c.data.initials,...c.data.keywords||[],c.data.py,c.data.title,`${i.initials} ${c.data.initials}`,...(c.data.keywords||[]).map(u=>`${i.initials} ${u}`)])].filter(Boolean),n[s][l].data.thesaurus=[`${s} ${c.data.title}`,`${s} ${c.data.quick}`,s,...c.data.keywords||[],i.pinyin,`${o} ${c.data.title}`,`${o} ${c.data.quick}`].map(u=>gd(u)))})}),n}),KX=e=>{const t=Wa();return WX(t,e)},uF=()=>{const e=Wa();return zX(e)},eb={},eC=(e,t)=>{const n=`${e}-${t==null?void 0:t.level}-${t==null?void 0:t.display}`;if(eb[n])return eb[n];if(e===void 0)return;let s;const a=uF();return Ei(a).some(o=>{o=Ei(o);const i=o.findIndex(c=>{var u,d,f,h;return!!(c.data.type===e&&(e!==m.BlockType.HEADER&&e!==m.BlockType.FILE&&e!==m.BlockType.TOGGLE_HEADER||t!=null&&t.level&&t.level===((d=(u=c.data.params)==null?void 0:u.data)==null?void 0:d.level)||t!=null&&t.display&&t.display===((h=(f=c.data.params)==null?void 0:f.data)==null?void 0:h.display)))}),l=o[i];return l?(s=l.data,!0):!1}),eb[n]=s,s},Ya=e=>{var o,i;const t=le().blocks[e],n=uF();if(!t)return"";switch(t.type){case m.BlockType.REFERENCE:return t.data.display==="linkPage"?n.basicBlock.linkPage.data.title:"引用块";case m.BlockType.FILE:switch(t.data.display){case"audio":return n.media.audio.data.title;case"video":return n.media.video.data.title;case"image":return n.media.image.data.title;case"file":return t.data.viewMode===Vs.preview?n.embed.file.data.title:n.media.file.data.title;default:return""}case m.BlockType.HEADER:return`标题${(o=t.data.level)!=null?o:1}`;case m.BlockType.TOGGLE_HEADER:return`折叠标题${(i=t.data.level)!=null?i:1}`}const s=[n.basicBlock,n.media,n.database,n.embed,n.advanced];let a;for(const l of s)if(a=YX(t,l),a)return a;return t.type===m.BlockType.SYNC_REFERENCE?"影子同步块":t.type===m.BlockType.COLUMN_LIST||t.type===m.BlockType.COLUMN?"分栏":""},YX=(e,t)=>{for(const[n,s]of Object.entries(t))if(e.type===s.data.type)return s.data.title;return""},I_=(e,t)=>({type:$.BLOCK_TEXT,data:{title:e,py:yl(e),initials:sg(e),...t}}),XX=()=>{const e=JSON.parse(localStorage.getItem(pT)||"{}");Object.entries(e).forEach(([t,n])=>{S1.put(t,n)}),localStorage.removeItem(pT)};XX();const cu=e=>[vV(e),(s,a=!0)=>{Po(e,s,a)}],Po=(e,t,n=!0)=>{var a;const s=Array.isArray(e)?e:[e];if(t?kT(s,!0):kT(s,!1),!Array.isArray(e)){const o=K.blocks[e],i=(a=eC(o==null?void 0:o.type,{level:o==null?void 0:o.data.level}))==null?void 0:a.title;i&&ce.event("block_fold",{block_name:i})}n&&S1.batch(()=>{s.forEach(o=>{S1.put(o,t)})})},ZR=e=>{var s;if(!e)return!1;const t=K.blocks[e];if(!t)return!1;const n=(s=wt.$expandFoldRecord[e])!=null?s:!1;return Sg(t.type)&&n===!1},Sg=e=>[m.BlockType.TODO,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(e),Sr=300;class QX{constructor(t){q(this,"engine");q(this,"canvasContext",null);q(this,"canvasElement",null);q(this,"dragCanvasElement",null);q(this,"dragCanvasContext",null);q(this,"width",0);q(this,"height",0);q(this,"scale",1);q(this,"getCanvasContext",()=>this.canvasContext);q(this,"getDragCanvasContext",()=>this.dragCanvasContext);q(this,"setCanvas",t=>{this.canvasElement=t,this.canvasContext=t.getContext("2d")});q(this,"setDragCanvas",t=>{var n,s,a;this.dragCanvasElement=t,this.dragCanvasContext=t.getContext("2d"),(n=this.dragCanvasContext)==null||n.scale(this.scale,this.scale),(s=this.dragCanvasElement)==null||s.setAttribute("width",this.width.toString()),(a=this.dragCanvasElement)==null||a.setAttribute("height",this.height.toString()),this.layout()});q(this,"offsetX",Sr/2);q(this,"offsetY",Sr/2);q(this,"setCanvasSize",(t,n)=>{var s,a,o;this.width=(t+Sr)*this.scale,this.height=(n+Sr)*this.scale,(s=this.canvasContext)==null||s.scale(this.scale,this.scale),(a=this.canvasElement)==null||a.setAttribute("width",this.width.toString()),(o=this.canvasElement)==null||o.setAttribute("height",this.height.toString()),this.layout()});q(this,"layout",()=>{var t,n,s,a,o,i,l;(t=this.canvasContext)==null||t.save(),(n=this.dragCanvasContext)==null||n.save(),(s=this.canvasContext)==null||s.translate(this.offsetX,this.offsetY),(a=this.dragCanvasContext)==null||a.translate(this.offsetX,this.offsetY),this.clear(),(o=this.canvasContext)==null||o.beginPath(),this.engine.dragLines(),(i=this.canvasContext)==null||i.restore(),(l=this.dragCanvasContext)==null||l.restore()});q(this,"clear",()=>{var t,n;(t=this.canvasContext)==null||t.clearRect(-this.offsetX,-this.offsetY,this.width+this.offsetX,this.height+this.offsetY),(n=this.dragCanvasContext)==null||n.clearRect(-this.offsetX,-this.offsetY,this.width+this.offsetX,this.height+this.offsetY)});q(this,"destroy",()=>{});this.engine=t}}const Rg=(e,t)=>e.x<=t.x+t.width&&t.x<=e.x+e.width&&e.y<=t.y+t.height&&t.y<=e.y+e.height;function JX(e,t,n,s,a,o=5,i=!1,l=!0){const c={tl:o,tr:o,br:o,bl:o};e.beginPath(),e.moveTo(t+c.tl,n),e.lineTo(t+s-c.tr,n),e.quadraticCurveTo(t+s,n,t+s,n+c.tr),e.lineTo(t+s,n+a-c.br),e.quadraticCurveTo(t+s,n+a,t+s-c.br,n+a),e.lineTo(t+c.bl,n+a),e.quadraticCurveTo(t,n+a,t,n+a-c.bl),e.lineTo(t,n+c.tl),e.quadraticCurveTo(t,n,t+c.tl,n),e.closePath(),i&&e.fill(),l&&e.stroke()}const dF=(e,t)=>{const n=e.nodesByLevelMap[t];if(n===void 0)return;const s=e.nodesByLevelOrder[n],a=s==null?void 0:s.indexOf(t);if(!(a===void 0||a===0))return s==null?void 0:s[a-1]},fF=(e,t)=>{const n=e.nodesByLevelMap[t];if(n===void 0)return;const s=e.nodesByLevelOrder[n];if(!s)return;const a=s==null?void 0:s.indexOf(t);if(!(a===void 0||a===(s==null?void 0:s.length)-1))return s==null?void 0:s[a+1]},ja=(e,t,n,s,a,o,i=0,l=0)=>{let c=!1;s&&(c=s(t,n,!!o,i,l));const u=e.getMindNode(t);if(u){if(!c&&u.childrenIds.length>0){const d=i+1;u.childrenIds.forEach((f,h)=>{ja(e,f,t,s,a,!1,d,h)})}a&&a(t,n,!!o,i,l)}};class Ag{constructor(t,n){q(this,"engine");q(this,"opt");q(this,"width",0);q(this,"height",0);q(this,"viewportWidth",0);q(this,"viewportHeight",0);q(this,"round",8);q(this,"container");q(this,"scroller");q(this,"fitCenter",()=>{var f;if(this.engine.computeNodesCoordinate(),!this.scroller)return;const t=this.scroller.getBoundingClientRect(),n=this.engine.getState();if(!n.mindNodes[n.rootId])return;const a=this.getMindMapCenterPos();if(!a)return;const[o,i]=a,l=t.left+t.width/2-this.scroller.scrollLeft,c=t.top+t.height/2-this.scroller.scrollTop,u=o-l,d=i-c;(f=this.scroller)==null||f.scrollTo(u,d)});q(this,"updateViewPort",()=>{const t=this.engine.getDraftState(),n=t.mindNodes[t.rootId],s=t.scale*.01;n&&this.container&&(this.viewportWidth=this.width*2+n.regionWidth*s-100,this.viewportHeight=this.height*2+n.regionHeight*s-100,this.container.style.height=`${this.viewportHeight}px`,this.container.style.width=`${this.viewportWidth}px`,this.engine.graph.setCanvasSize(n.regionWidth,n.regionHeight))});q(this,"drawDragNodeRect",()=>{const t=this.engine.graph.getDragCanvasContext();if(!t)return;const{dragInfo:n}=this.engine;if(!n)return;const{ids:s}=n;let a;s.forEach(o=>{if(!this.engine.getMindNode(o))return;t.save(),t.strokeStyle="#18A0FB",t.lineWidth=2,t.lineCap="butt",t.setLineDash([6]);const l=this.getDragNodeRect(o);l&&(a&&Rg(a,l)||(a=l,JX(t,l.x,l.y,l.width,l.height),t.restore()))})});q(this,"drawMindNodes",()=>{const{rootId:t,lineStyle:n}=this.engine.getState(),s=this.computedLines(t),a=this.engine.graph.getCanvasContext();a&&s.forEach(o=>{a.beginPath(),n===At.MindMappingLineStyle.NORMAL?this.drawLine(a,o):this.drawBezierLine(a,o),a.stroke()})});q(this,"updateMindNodeSize",(t,n,s)=>{const o=this.engine.getDraftState().mindNodes[t];o&&(o.width=Math.floor(n),o.height=Math.floor(s))});q(this,"getLineColor",t=>{var i,l,c;const n=this.engine.getState();let s=t,a;for(;s&&n.rootId!==s;){const u=n.mindNodes[s];if(!u)break;if(u.themeColor){a=u.themeColor;break}s=u.parentId}let o;return a&&(o=(l=(i=this.engine.option).getLineColor)==null?void 0:l.call(i,a,t)),o||(o=(c=this.engine.option.lineColor)!=null?c:"#000000"),o});q(this,"computeOffset",()=>{const t=this.engine.getDraftState(),n=t.mindNodes[t.rootId];if(!n)return;const s=n.regionWidth*.5,a=n.regionHeight*.5,o=this.viewportWidth*.5,i=this.viewportHeight*.5;t.offsetX=o-s,t.offsetY=i-a});q(this,"drawLines",()=>{this.drawMindNodes(),this.drawDragNodeRect(),this.drawDragLine()});q(this,"drawDragLine",()=>{const t=this.engine.graph.getDragCanvasContext();if(!t)return;const{dragInfo:n}=this.engine;if(!n)return;const{dropInfo:s,lineStyle:a}=this.engine.getState();if(!s)return;const[o,i]=this.engine.option.getCanvasPosition(this.engine,n.left,n.top),l=this.getDragLine(o,i,n.id,s.parentId);l&&(t.beginPath(),a===At.MindMappingLineStyle.NORMAL?this.drawLine(t,l,{strokeStyle:"#18A0FB"}):this.drawBezierLine(t,l,{strokeStyle:"#18A0FB"}),t.stroke())});q(this,"computedLines",t=>{const n=this.engine.getMindNode(t);if(!n)return[];const s=[];return n.left===jf||n.top===jf||n.expanded&&n.childrenIds.forEach(a=>{const o=this.engine.getMindNode(a);if(!o||o.left===jf||o.top===jf)return;const i=this.getLine(n,o);s.push(i);const l=this.computedLines(a);s.push(...l)}),s});q(this,"setContainer",t=>{this.container=t});q(this,"setScroller",t=>{this.scroller=t});q(this,"setSize",(t,n)=>{this.width=t,this.height=n,this.updateViewPort()});q(this,"getDropPosition",t=>{if(!t)return;const n=this.engine.getState();if(!n.mindNodes[t.id]||!n.mindNodes[n.rootId])return;const o=this.getConnectToWhere(t);if(!(o&&(this.checkDragRecycle(t.ids,o)||!this.engine.option.supportAppendChild(o.parentId))))return o});q(this,"computeNodesCoordinate",()=>{var s,a;const t=this.engine.getDraftState(),n=(a=(s=this.engine.option).getAllElement)==null?void 0:a.call(s);if(n)for(const o of n){const{blockId:i}=o.dataset;if(!i)return;const l=o.getBoundingClientRect(),c=t.mindNodes[i];c&&(c.x=Math.floor(l.x),c.y=Math.floor(l.y))}});q(this,"getParentId",t=>{const n=this.engine.getMindNode(t);return n==null?void 0:n.parentId});q(this,"getMiddleChild",t=>{const n=this.engine.getMindNode(t);if(!n||!n.expanded||n.childrenIds.length===0)return;const s=Math.floor((n.childrenIds.length-1)/2);return n.childrenIds[s]});q(this,"updateNodeRecursive",(t,n,s)=>{const o=this.engine.getDraftState().mindNodes[t];o&&(o[n]+=s,o.childrenIds.forEach(i=>{this.updateNodeRecursive(i,n,s)}))});q(this,"computeFixWidth",()=>{if(!this.engine.alignSiblingNode)return;const t=this.engine.getDraftState(),n={};ja(this.engine,t.rootId,"",void 0,(s,a,o,i)=>{var u,d;const l=(d=(u=n[i])==null?void 0:u.fixWidth)!=null?d:0,c=t.mindNodes[s];c&&c.reallyWidth>l&&(n[i]={id:s,fixWidth:c.reallyWidth})}),t.fixWidthRecord=n});q(this,"computeNodesByLevelOrder",()=>{const t=this.engine.getDraftState(),n={},s={};ja(this.engine,t.rootId,"",void 0,(a,o,i,l)=>{const c=t.mindNodes[a];if(!c||!c.expanded)return;let u=n[l];u||(u=[],n[l]=u),u.push(a),s[a]=l}),this.engine.nodesByLevelMap=s,this.engine.nodesByLevelOrder=n});q(this,"checkDragRecycle",(t,n)=>t.some(s=>{var o,i;let{parentId:a}=n;for(;a;){if(a===s)return!0;a=(i=(o=this.engine.getMindNode(a))==null?void 0:o.parentId)!=null?i:""}return!1}));q(this,"drawBezierLine",(t,n,s)=>{const a=t;a.strokeStyle=n.color,a.lineWidth=2,a.lineCap="butt",s&&Object.assign(a,s),a.moveTo(n.startX,n.startY);const o=n.startX+(n.endX-n.startX)/2,i=n.startY,l=o,c=n.endY;a.bezierCurveTo(o,i,l,c,n.endX,n.endY)});q(this,"scale",1);this.engine=t,this.opt=n}}q(Ag,"copyValueToNewProvider",(t,n)=>{t.width=n.width,t.height=n.height,t.viewportWidth=n.viewportWidth,t.viewportHeight=n.viewportHeight,t.round=n.round,t.container=n.container,t.scroller=n.scroller});class U2 extends Ag{constructor(n,s){super(n,s);q(this,"layout",n=>{try{this.computeNodeRegionValue(n),this.updateViewPort(),this.computedBaseValue(),this.computedTopValue(),this.adjustTopValue(),this.computeOffset(),this.computeFixWidth(),this.computeNodesByLevelOrder()}catch(s){console.warn(s)}});q(this,"computedBaseValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",(s,a,o)=>{const i=n.mindNodes[s],l=n.mindNodes[a];if(i&&(o?(i.left=0,i.top=-i.height*.5+i.regionHeight*.5):l&&(i.left=l.left+l.width+this.opt.horizontalMargin),!i.expanded))return!0},s=>{const a=n.mindNodes[s];if(!a)return;if(!a.expanded)return a.childrenHeight=0,!0;let o=0;a.childrenHeight=a.childrenIds.reduce((i,l)=>{const c=n.mindNodes[l];return c?(o++,i+c.height):i},0)+(o+1)*this.opt.verticalMargin},!0,0)});q(this,"computedTopValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a)return!1;if(!a.expanded)return!0;if(a.childrenIds.length===0)return;let i=a.top+a.height/2-a.childrenHeight/2+this.opt.verticalMargin;a.childrenIds.forEach(l=>{const c=n.mindNodes[l];c&&(c.top=i,i+=c.height+this.opt.verticalMargin)})},void 0,!0,0)});q(this,"adjustTopValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a)return!1;if(!a.expanded)return!0;const o=a.childrenHeight-this.opt.verticalMargin*2-a.height;o>0&&this.updateBrothers(s,o/2)},void 0,!0)});q(this,"updateBrothers",(n,s)=>{const a=this.engine.getDraftState(),o=a.mindNodes[n];if(!o)return;const i=this.engine.getMindNode(o.parentId);if(!i)return;const l=i.childrenIds.findIndex(c=>c===n);i.childrenIds.forEach((c,u)=>{if(c===n||!a.mindNodes[c])return;let f=0;u<l?f=-s:u>l&&(f=s),this.updateNodeRecursive(c,"top",f)}),this.updateBrothers(o.parentId,s)});q(this,"getMindMapCenterPos",()=>{if(!this.scroller)return;const n=this.engine.getRootMindNode(),{scale:s}=this.engine.getState(),a=s*.01,o=this.scroller.getBoundingClientRect();let i=n.x+n.width*a/2;const l=n.y+n.height*a/2;return n.regionWidth*a<o.width&&(i=n.x+n.regionWidth*a/2),[i,l]});q(this,"updateScrollerPos",(n,s)=>{var i;const o=(this.engine.getRootMindNode().regionHeight-s)/2;o!==0&&((i=this.scroller)==null||i.scrollBy(0,o))});q(this,"getConnectToWhere",n=>{const s=this.engine.getState(),a=s.scale*.01;if(!s.mindNodes[n.id])return;const i=s.mindNodes[s.rootId];if(!i)return;const l=n.left,c=n.top;if(l<i.x+i.width*a||l>i.x+(i.regionWidth+Sr*.5)*a)return;const u=i.y+(i.height*.5-i.regionHeight*.5)*a;if(c<u-Sr*.5*a||c>u+(i.regionHeight+Sr*.5)*a)return;let d;const f=Object.entries(s.mindNodes),h=s.mindNodes[n.id];if(!h)return;let p=Number.MAX_VALUE;for(const[g,_]of f){const x={x:_.x,y:_.y+_.height*.5*a-_.regionHeight*.5*a,width:_.width*a,height:_.regionHeight*a};if(Rg(x,{x:l,y:c+h.height/2*a,width:1,height:1})){if(_.id===n.id)return{parentId:_.parentId};if(!_.parentId)return;const y=s.mindNodes[_.parentId];return y?this.findPosition(n,y):void 0}if(l>_.x+_.width*a){const y=c+h.height/2*a,b=_.x+_.width*a,E=_.y+_.height/2*a,w=Math.pow(y-E,2)+Math.pow(l-b,2);w<p&&(p=w,d=_)}}if(d&&d.id!==n.id)return!d.expanded||d.childrenIds.length===0?{parentId:d.id,first:!0}:this.findPosition(n,d)});q(this,"findPosition",(n,s)=>{const a=this.engine.getState(),o=n.top;let i;for(let l=0;l<s.childrenIds.length;l++){const c=s.childrenIds[l];if(!c)return;const u=a.mindNodes[c];if(!u)return;if(l===0&&o<u.y)return{parentId:s.id,first:!0};o>u.y&&(i=u.id)}if(i&&i!==n.id)return{parentId:s.id,after:i}});q(this,"computeNodeRegionValue",n=>{const s=this.engine.getDraftState(),a=s.mindNodes[n];if(!a)return;const{height:o,width:i}=a;let l=0,c=0;a.expanded?(a.childrenIds.forEach(u=>{this.computeNodeRegionValue(u);const d=s.mindNodes[u];d&&(l+=d.regionHeight,d.regionWidth>c&&(c=d.regionWidth))}),a.childrenIds.length>0&&(l+=this.opt.verticalMargin*(a.childrenIds.length-1))):l=0,a.regionHeight=Math.max(o,l),a.expanded&&a.childrenIds.length>0?a.regionWidth=i+this.opt.horizontalMargin+c:a.regionWidth=i});q(this,"getDragNodeRect",n=>{const s=this.engine.getMindNode(n!=null?n:"");if(!s)return;const a=s.left,o=s.top+s.height*.5-s.regionHeight*.5;return{x:a,y:o,width:s.regionWidth,height:s.regionHeight}});q(this,"getLine",(n,s)=>{const a=this.getLineColor(s.id);return{startX:(n.left+n.width)/this.scale,startY:(n.top+n.height/2)/this.scale,endX:s.left/this.scale,endY:(s.top+s.height/2)/this.scale,debug:`${n.id} - ${s.id}`,isRoot:!n.parentId,color:a}});q(this,"getDragLine",(n,s,a,o)=>{const i=this.engine.getMindNode(a);if(!i)return;const l=this.engine.getMindNode(o);if(!l)return;const c=this.getLineColor(a);return{debug:"",startX:(l.left+l.width)/this.scale,startY:(l.top+l.height/2)/this.scale,endX:n/this.scale,endY:s+i.height/2/this.scale,color:c}});q(this,"drawLine",(n,s,a)=>{const o=n;o.lineWidth=2,o.lineCap="butt",o.strokeStyle=s.color,a&&Object.assign(o,a),o.moveTo(s.startX,s.startY);const i=s.startX+(s.endX-s.startX)/2;o.lineTo(i,s.startY);const l=s.endY<s.startY,{round:c}=this;Math.abs(s.endY-s.startY)>c?(o.lineTo(i,l?s.endY+c:s.endY-c),o.arcTo(i,s.endY,i+c,s.endY,c),o.lineTo(s.endX,s.endY)):o.lineTo(s.endX,s.startY)});q(this,"getNextNodeIdByArrowKeyboard",(n,s)=>{switch(n){case"left":return this.getParentId(s);case"right":return this.getMiddleChild(s);case"up":return dF(this.engine,s);case"down":return fF(this.engine,s)}})}}class ZX extends U2{constructor(n,s){super(n,s);q(this,"computedBaseValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",(s,a,o)=>{const i=n.mindNodes[s],l=n.mindNodes[a];if(!i||(o?(i.left=i.regionWidth-i.width,i.top=-i.height*.5+i.regionHeight*.5):l&&(i.left=l.left-i.width-this.opt.horizontalMargin),!i.expanded))return!0},s=>{const a=n.mindNodes[s];if(!a)return;if(!a.expanded)return a.childrenHeight=0,!0;let o=0;a.childrenHeight=a.childrenIds.reduce((i,l)=>{const c=n.mindNodes[l];return c?(o++,i+c.height):i},0)+(o+1)*this.opt.verticalMargin},!0,0)});q(this,"updateScrollerPos",(n,s)=>{var l;const a=this.engine.getRootMindNode(),o=(a.regionHeight-s)/2,i=a.regionWidth-n;(o!==0||i!==0)&&((l=this.scroller)==null||l.scrollBy(i,o))});q(this,"getMindMapCenterPos",()=>{if(!this.scroller)return;const n=this.engine.getRootMindNode(),{scale:s}=this.engine.getState(),a=s*.01,o=this.scroller.getBoundingClientRect();let i=n.x+n.width*a/2;const l=n.y+n.height*a/2;return n.regionWidth*a<o.width&&(i=n.x+n.width*a-n.regionWidth*a/2),[i,l]});q(this,"getConnectToWhere",n=>{const s=this.engine.getState(),a=s.scale*.01,o=s.mindNodes[n.id];if(!o)return;const i=s.mindNodes[s.rootId];if(!i)return;const l=n.left,c=n.top,u=s.mindNodes[n.id];if(!u||l+u.width*a<i.x+i.width*a-i.regionWidth*a-Sr*.5||l>i.x)return;const d=i.y+(i.height*.5-i.regionHeight*.5)*a;if(c<d-Sr*.5*a||c>d+(i.regionHeight+Sr*.5)*a)return;let f;const h=Object.entries(s.mindNodes);let p=Number.MAX_VALUE;for(const[g,_]of h){const x={x:_.x+_.width,y:_.y+_.height*.5*a-_.regionHeight*.5*a,width:_.width*a,height:_.regionHeight*a};if(Rg(x,{x:l,y:c+o.height/2*a,width:1,height:1})){if(_.id===n.id)return{parentId:_.parentId};if(!_.parentId)return;const b=s.mindNodes[_.parentId];return b?this.findPosition(n,b):void 0}const y=l+u.width*a;if(y<_.x){const b=c+u.height/2*a,E=_.y+_.height/2*a,w=Math.pow(b-E,2)+Math.pow(y-_.x,2);w<p&&(p=w,f=_)}}if(f&&f.id!==n.id)return!f.expanded||f.childrenIds.length===0?{parentId:f.id,first:!0}:this.findPosition(n,f)});q(this,"getDragNodeRect",n=>{const s=this.engine.getMindNode(n!=null?n:"");if(!s)return;const a=s.left+s.width-s.regionWidth,o=s.top+s.height*.5-s.regionHeight*.5;return{x:a,y:o,width:s.regionWidth,height:s.regionHeight}});q(this,"getLine",(n,s)=>{const a=this.getLineColor(s.id);return{startX:n.left/this.scale,startY:(n.top+n.height/2)/this.scale,endX:(s.left+s.width)/this.scale,endY:(s.top+s.height/2)/this.scale,debug:`${n.id} - ${s.id}`,isRoot:!n.parentId,color:a}});q(this,"getDragLine",(n,s,a,o)=>{const i=this.engine.getMindNode(a);if(!i)return;const l=this.engine.getMindNode(o);if(!l)return;const c=this.getLineColor(a);return{debug:"",startX:l.left/this.scale,startY:(l.top+l.height/2)/this.scale,endX:(n+i.width)/this.scale,endY:s+i.height/2/this.scale,isRoot:!i.parentId,color:c}});q(this,"drawLine",(n,s,a)=>{const o=n;o.strokeStyle=s.color,o.lineWidth=2,o.lineCap="butt",a&&Object.assign(o,a),o.moveTo(s.startX,s.startY);const i=s.startX+(s.endX-s.startX)/2;o.lineTo(i,s.startY);const l=s.endY<s.startY,{round:c}=this;Math.abs(s.endY-s.startY)>c?(o.lineTo(i,l?s.endY+c:s.endY-c),o.arcTo(i,s.endY,i-c,s.endY,c),o.lineTo(s.endX,s.endY)):o.lineTo(s.endX,s.startY)});q(this,"getNextNodeIdByArrowKeyboard",(n,s)=>{switch(n){case"left":return this.getMiddleChild(s);case"right":return this.getParentId(s);case"up":return dF(this.engine,s);case"down":return fF(this.engine,s)}})}}class eQ extends Ag{constructor(n,s){super(n,s);q(this,"layout",n=>{try{this.computedDir(),this.computeNodeRegionValue(n),this.updateViewPort(),this.computedBaseValue(),this.computedTopValue(),this.adjustTopValue(),this.computeOffset(),this.computeFixWidth(),this.computeNodesByLevelOrder()}catch(s){console.warn(s)}});q(this,"computedDir",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",(s,a,o,i,l)=>{const c=n.mindNodes[s],u=n.mindNodes[a];if(!c)return!0;if(!o&&(u&&(u.dir?c.dir=u.dir:c.dir=l<u.childrenIds.length/2?"right":"left"),!c.expanded))return!0},void 0,!0,0)});q(this,"computedBaseValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",(s,a,o,i)=>{const l=n.mindNodes[s],c=n.mindNodes[a];if(!l)return!0;if(o)l.left=l.regionWidth-l.rightRegionWidth,l.top=-l.height*.5+l.regionHeight*.5;else if(c){if(c.dir)l.dir=c.dir;else{const d=c.childrenIds.filter(f=>n.mindNodes[f]).indexOf(s);l.dir=d<c.childrenIds.length/2?"right":"left"}l.left=l.dir==="right"?c.left+c.width+this.opt.horizontalMargin:c.left-l.width-this.opt.horizontalMargin}if(!l.expanded)return!0},s=>{const a=n.mindNodes[s];if(!a)return;if(!a.expanded){a.leftChildrenHeight=0,a.rightChildrenHeight=0;return}let o=0,i=0,l=0,c=0;a.childrenIds.forEach(u=>{const d=n.mindNodes[u];d&&(d.dir==="left"?(o++,l+=d.height):d.dir==="right"&&(i++,c+=d.height))}),a.leftChildrenHeight=l+(o+1)*this.opt.verticalMargin,a.rightChildrenHeight=c+(i+1)*this.opt.verticalMargin},!0,0)});q(this,"computedTopValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a||!a.expanded)return!0;if(a.childrenIds.length===0)return;const o=a.top+a.height/2+this.opt.verticalMargin;let i=o-a.leftChildrenHeight/2,l=o-a.rightChildrenHeight/2;a.childrenIds.forEach(c=>{const u=n.mindNodes[c];u&&(u.dir==="left"?(u.top=i,i+=u.height+this.opt.verticalMargin):u.dir==="right"&&(u.top=l,l+=u.height+this.opt.verticalMargin))})},void 0,!0,0)});q(this,"adjustTopValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a||!a.expanded)return!0;const o=this.opt.verticalMargin*2+a.height,i=a.leftChildrenHeight-o,l=a.rightChildrenHeight-o;(i>0||l>0)&&this.updateBrothers(s,i/2,l/2)},void 0,!0)});q(this,"updateBrothers",(n,s,a)=>{const o=this.engine.getDraftState(),i=o.mindNodes[n];if(!i)return;const l=this.engine.getMindNode(i.parentId);if(!l)return;const c=l.childrenIds.filter(d=>{const f=o.mindNodes[d];return(f==null?void 0:f.dir)===i.dir}),u=c.indexOf(n);c.forEach((d,f)=>{const h=o.mindNodes[d];if(!h)return;let p=0;const g=h.dir==="left"?s:a;f<u?p=-g:f>u&&(p=g),this.updateNodeRecursive(d,"top",p)}),this.updateBrothers(i.parentId,s,a)});q(this,"updateScrollerPos",(n,s)=>{var l;const a=this.engine.getRootMindNode(),o=(a.regionHeight-s)/2,i=a.regionWidth-n;(o!==0||i!==0)&&((l=this.scroller)==null||l.scrollBy(i,o))});q(this,"getMindMapCenterPos",()=>{if(!this.scroller)return;const n=this.engine.getRootMindNode(),{scale:s}=this.engine.getState(),a=s*.01,o=n.x+n.width*a/2,i=n.y+n.height*a/2;return[o,i]});q(this,"getConnectToWhere",n=>{const s=this.engine.getState(),a=s.scale*.01;if(!s.mindNodes[n.id])return;const i=s.mindNodes[s.rootId];if(!i)return;const l=s.mindNodes[n.id];if(!l)return;const c=n.left,u=n.top;if(c+l.width<i.x+i.width*a-i.leftRegionWidth*a-Sr*.5*a||c>i.x+i.rightRegionWidth*a+Sr*.5*a)return;const d=i.y+(i.height*.5-i.regionHeight*.5)*a;if(u<d-Sr*.5*a||u>d+(i.regionHeight+Sr*.5)*a||c>i.x&&c<i.x+i.width*a)return;const f=c>i.x+i.width*a;let h;const p=Object.entries(s.mindNodes);let g=Number.MAX_VALUE;for(const[_,x]of p){if(x.dir==="left"&&f||x.dir==="right"&&!f)continue;let y=0;switch(x.dir){case"left":y=x.leftRegionHeight;break;case"right":y=x.rightRegionHeight;break;default:y=x.regionHeight}const b={x:x.dir==="left"?x.x+x.width:x.x,y:x.y+x.height*.5-y*.5*a,width:x.width*a,height:x.regionHeight*a};if(Rg(b,{x:c,y:u+l.height/2*a,width:1,height:1})){if(x.id===n.id)return{parentId:x.parentId};if(!x.parentId)return;const E=s.mindNodes[x.parentId];return E?this.findPosition(n,E,f):void 0}if(f&&c>x.x+x.width*a){const E=u+l.height/2*a,w=x.x+x.width*a,k=x.y+x.height/2*a,C=Math.pow(E-k,2)+Math.pow(c-w,2);C<g&&(g=C,h=x)}else if(!f&&c+l.width*a<x.x){const E=c+l.width*a,w=u+l.height/2*a,k=x.y+x.height/2*a,C=Math.pow(w-k,2)+Math.pow(E-x.x,2);C<g&&(g=C,h=x)}}if(h&&h.id!==n.id)return!h.expanded||h.childrenIds.length===0?{parentId:h.id,first:!0}:this.findPosition(n,h,f)});q(this,"findPosition",(n,s,a)=>{const o=this.engine.getState(),i=n.top;let l;for(let c=0;c<s.childrenIds.length;c++){const u=s.childrenIds[c];if(!u)return;const d=o.mindNodes[u];if(!d)return;if(!(a&&d.dir==="left")){if(c===0&&i<d.y)return{parentId:s.id,first:!0};i>d.y&&(l=d.id)}}if(l&&l!==n.id)return{parentId:s.id,after:l}});q(this,"updateMindNodeSize",(n,s,a)=>{const i=this.engine.getDraftState().mindNodes[n];i&&(i.width=Math.floor(s),i.height=Math.floor(a))});q(this,"computeNodeRegionValue",n=>{const s=this.engine.getDraftState(),a=s.mindNodes[n];if(!a)return;let o=0,i=0,l=0,c=0,u=0,d=0;if(a.expanded&&(a.childrenIds.forEach(f=>{const h=s.mindNodes[f];h&&(this.computeNodeRegionValue(f),h.dir==="left"?(o++,l+=h.regionHeight,h.regionWidth>u&&(u=h.regionWidth)):h.dir==="right"&&(i++,c+=h.regionHeight,h.regionWidth>d&&(d=h.regionWidth)))}),l+=(o-1)*this.opt.verticalMargin,c+=(i-1)*this.opt.verticalMargin),a.regionHeight=Math.max(a.height,Math.max(l,c)),a.leftRegionHeight=Math.max(a.height,l),a.rightRegionHeight=Math.max(a.height,c),a.expanded&&a.childrenIds.length>0){const f=a.parentId?this.opt.horizontalMargin:this.opt.horizontalMargin*2;a.regionWidth=a.width+f+u+d,a.leftRegionWidth=a.width+this.opt.horizontalMargin+u,a.rightRegionWidth=a.width+this.opt.horizontalMargin+d}else a.regionWidth=a.width});q(this,"drawLine",(n,s,a)=>{const o=n;o.strokeStyle=s.color,o.lineWidth=2,o.lineCap="butt",a&&Object.assign(o,a),o.moveTo(s.startX,s.startY);const i=s.startX+(s.endX-s.startX)/2;o.lineTo(i,s.startY);const l=s.endY<s.startY,{round:c}=this;Math.abs(s.endY-s.startY)>c?(o.lineTo(i,l?s.endY+c:s.endY-c),o.arcTo(i,s.endY,i+(s.dir==="left"?-c:c),s.endY,c),o.lineTo(s.endX,s.endY)):o.lineTo(s.endX,s.startY)});q(this,"getLine",(n,s)=>{const a=this.getLineColor(s.id);let o;return s.dir==="left"?o={startX:n.left/this.scale,startY:(n.top+n.height/2)/this.scale,endX:(s.left+s.width)/this.scale,endY:(s.top+s.height/2)/this.scale,debug:`${n.id} - ${s.id}`,dir:"left",isRoot:!n.parentId,color:a}:o={startX:(n.left+n.width)/this.scale,startY:(n.top+n.height/2)/this.scale,endX:s.left/this.scale,endY:(s.top+s.height/2)/this.scale,debug:`${n.id} - ${s.id}`,dir:"right",isRoot:!n.parentId,color:a},o});q(this,"getDragLine",(n,s,a,o)=>{const i=this.engine.getMindNode(a);if(!i)return;const l=this.engine.getMindNode(o);if(!l)return;const c=this.getLineColor(a);let u;const d=f=>f==="left"?{debug:"",startX:l.left/this.scale,startY:(l.top+l.height/2)/this.scale,endX:(n+i.width)/this.scale,endY:s+i.height/2/this.scale,dir:"left",color:c}:{debug:"",startX:(l.left+l.width)/this.scale,startY:(l.top+l.height/2)/this.scale,endX:n/this.scale,endY:s+i.height/2/this.scale,dir:"right",color:c};if(l.dir==="right")u=d("right");else if(l.dir==="left")u=d("left");else if(l.dir===void 0){const f=this.engine.getRootMindNode();if(!this.engine.dragInfo)return;const h=this.engine.dragInfo.left;if(!this.engine.getMindNode(this.engine.dragInfo.id))return;h>f.x?u=d("right"):h<f.x&&(u=d("left"))}return u});q(this,"getDragNodeRect",n=>{const s=this.engine.getMindNode(n!=null?n:"");if(!s)return;if(s.dir==="right"||s.dir===void 0){const i=s.left,l=s.top+s.height*.5-s.regionHeight*.5;return{x:i,y:l,width:s.regionWidth,height:s.regionHeight}}const a=s.left+s.width-s.regionWidth,o=s.top+s.height*.5-s.regionHeight*.5;return{x:a,y:o,width:s.regionWidth,height:s.regionHeight}});q(this,"getNextNodeIdByArrowKeyboard",(n,s)=>{const a=this.engine.getMindNode(s);if(a)switch(n){case"left":{if(a.dir===void 0&&a.childrenIds.length>1){const o=Math.round(a.childrenIds.length/2/2);return a.childrenIds[a.childrenIds.length-o]}return a.dir==="right"?this.getParentId(s):this.getMiddleChild(s)}case"right":{if(a.dir===void 0&&a.childrenIds.length>1){const o=Math.floor(a.childrenIds.length/2/2);return a.childrenIds[o]}return a.dir==="right"?this.getMiddleChild(s):this.getParentId(s)}case"up":{const o=dF(this.engine,s);if(!o)return;const i=this.engine.getMindNode(o);if((i==null?void 0:i.dir)===a.dir)return o;break}case"down":{const o=fF(this.engine,s);if(!o)return;const i=this.engine.getMindNode(o);if((i==null?void 0:i.dir)===a.dir)return o;break}}})}}class tQ extends Ag{constructor(n,s){super(n,s);q(this,"layout",n=>{try{this.computeNodeRegionValue(n),this.updateViewPort(),this.computedBaseValue(),this.computedLeftValue(),this.adjustLeftValue(),this.computeOffset(),this.computeFixWidth(),this.computeNodesByLevelOrder()}catch(s){console.warn(s)}});q(this,"computedBaseValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",(s,a,o)=>{const i=n.mindNodes[s],l=n.mindNodes[a];if(!i||(o?(i.left=-i.width*.5+i.regionWidth*.5,i.top=0):l&&(i.top=l.top+l.height+this.opt.horizontalMargin),!i.expanded))return!0},s=>{const a=n.mindNodes[s];if(!a)return;if(!a.expanded){a.childrenWidth=0;return}let o=0;a.childrenWidth=a.childrenIds.reduce((i,l)=>{const c=n.mindNodes[l];return c?(o++,i+c.width):i},0)+(o+1)*this.opt.verticalMargin},!0,0)});q(this,"computedLeftValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a)return!0;if(!a.expanded||a.childrenIds.length===0)return;let i=a.left+a.width*.5-a.childrenWidth*.5+this.opt.verticalMargin;a.childrenIds.forEach(l=>{const c=n.mindNodes[l];c&&(c.left=i,i+=c.width+this.opt.verticalMargin)})},void 0,!0,0)});q(this,"adjustLeftValue",()=>{const n=this.engine.getDraftState();ja(this.engine,n.rootId,"",s=>{const a=n.mindNodes[s];if(!a||!a.expanded)return!0;const o=a.childrenWidth-this.opt.verticalMargin*2-a.width;o>0&&this.updateBrothers(s,o/2)},void 0,!0)});q(this,"updateBrothers",(n,s)=>{const a=this.engine.getDraftState(),o=a.mindNodes[n];if(!o)return;const i=this.engine.getMindNode(o.parentId);if(!i)return;const l=i.childrenIds.indexOf(n);i.childrenIds.forEach((c,u)=>{if(c===n||!a.mindNodes[c])return;let f=0;u<l?f=-s:u>l&&(f=s),this.updateNodeRecursive(c,"left",f)}),this.updateBrothers(o.parentId,s)});q(this,"updateScrollerPos",(n,s)=>{var i;const o=(this.engine.getRootMindNode().regionWidth-n)/2;o!==0&&((i=this.scroller)==null||i.scrollBy(o,0))});q(this,"getMindMapCenterPos",()=>{if(!this.scroller)return;const n=this.engine.getRootMindNode(),{scale:s}=this.engine.getState(),a=s*.01,o=this.scroller.getBoundingClientRect(),i=n.x+n.width*a/2;let l=n.y+n.height*a/2;return n.regionHeight*a<o.height&&(l=n.y+n.regionHeight*a/2),[i,l]});q(this,"getConnectToWhere",n=>{const s=this.engine.getState(),a=s.scale*.01;if(!s.mindNodes[n.id])return;const i=s.mindNodes[s.rootId];if(!i)return;const l=s.mindNodes[n.id];if(!l)return;const c=n.left,u=n.top;if(c+l.width*a<i.x+i.width*.5*a-i.regionWidth*.5*a-Sr*.5*a||c+l.width*a>i.x+i.width*.5*a+i.regionWidth*.5*a+Sr*.5*a||u<i.y-Sr*.5*a||u>i.y+i.regionHeight*a+Sr*.5*a)return;let d,f=Number.MAX_VALUE;const h=Object.entries(s.mindNodes);for(const[g,_]of h){const x={x:_.x+_.width*.5*a-_.regionWidth*.5*a,y:_.y+_.height,width:_.regionWidth*a,height:_.height*a};if(Rg(x,{x:c,y:u,width:1,height:1}))return _.id===n.id?{parentId:_.parentId}:_.id===n.id?void 0:c>_.x?{parentId:_.parentId,after:_.id}:{parentId:_.parentId,before:_.id};if(u>_.y+_.height*a){const y=c+l.width/2*a,b=_.x+_.width/2*a,E=_.y+_.height*a,w=Math.pow(u-E,2)+Math.pow(y-b,2);w<f&&(f=w,d=_)}}if(!d||d.id===n.id)return;if(!d.expanded||d.childrenIds.length===0)return{parentId:d.id,first:!0};let p;for(const g of d.childrenIds){const _=s.mindNodes[g];if(!_)return;if(c<_.x)return{parentId:d.id,first:!0};c>_.x&&(p=_.id)}if(p&&p!==n.id)return{parentId:d.id,after:p}});q(this,"updateMindNodeSize",(n,s,a)=>{const i=this.engine.getDraftState().mindNodes[n];i&&(i.width=Math.floor(s),i.height=Math.floor(a))});q(this,"computeNodeRegionValue",n=>{const s=this.engine.getDraftState(),a=s.mindNodes[n];if(!a)return;const{height:o,width:i}=a;let l=0,c=0;a.expanded&&(a.childrenIds.forEach(u=>{this.computeNodeRegionValue(u);const d=s.mindNodes[u];d&&(c+=d.regionWidth,d.regionHeight>l&&(l=d.regionHeight))}),a.childrenIds.length>0&&(c+=this.opt.verticalMargin*(a.childrenIds.length-1))),a.regionWidth=Math.max(i,c),a.expanded&&a.childrenIds.length>0?a.regionHeight=o+this.opt.horizontalMargin+l:a.regionHeight=o});q(this,"getLine",(n,s)=>{const a=this.getLineColor(s.id);return{startX:(n.left+n.width/2)/this.scale,startY:(n.top+n.height)/this.scale,endX:(s.left+s.width/2)/this.scale,endY:s.top/this.scale,debug:`${n.id} - ${s.id}`,isRoot:!n.parentId,color:a}});q(this,"getDragNodeRect",n=>{const s=this.engine.getMindNode(n!=null?n:"");if(!s)return;const a=s.left+s.width/2-s.regionWidth/2,o=s.top;return{x:a,y:o,width:s.regionWidth,height:s.regionHeight}});q(this,"getDragLine",(n,s,a,o)=>{const i=this.engine.getMindNode(a);if(!i)return;const l=this.engine.getMindNode(o);if(!l)return;const c=this.getLineColor(a);return{debug:"",startX:(l.left+l.width*.5)/this.scale,startY:(l.top+l.height)/this.scale,endX:(n+i.width*.5)/this.scale,endY:s/this.scale,color:c}});q(this,"drawBezierLine",(n,s,a)=>{const o=n;o.strokeStyle=s.color,o.lineWidth=2,o.lineCap="butt",a&&Object.assign(o,a);const i=(s.endY-s.startY)/2,l=s.startX,c=s.startY+i,u=s.endX,d=c;o.moveTo(s.startX,s.startY),o.bezierCurveTo(l,c,u,d,s.endX,s.endY)});q(this,"drawLine",(n,s,a)=>{const o=n;o.strokeStyle=s.color,o.lineWidth=2,o.lineCap="butt",a&&Object.assign(o,a),o.moveTo(s.startX,s.startY);const i=s.startY+(s.endY-s.startY)/2;o.lineTo(s.startX,i);const l=s.startX<s.endX,{round:c}=this;if(Math.abs(s.startX-s.endX)>c){const u=l?s.endX-c:s.endX+c;o.lineTo(u,i),o.arcTo(s.endX,i,s.endX,i+c,c),o.lineTo(s.endX,s.endY)}else o.lineTo(s.startX,s.endY)});q(this,"getNextNodeIdByArrowKeyboard",(n,s)=>{switch(n){case"left":return dF(this.engine,s);case"right":return fF(this.engine,s);case"up":return this.getParentId(s);case"down":return this.getMiddleChild(s)}})}}LM();const Lv=300,Pv=10,Eh=8,wh=60,jf=-9999,nQ=[10,25,50,75,100,120,150,200,300];class eA{constructor(t){q(this,"state",{mindNodes:{},rootId:"",dropInfo:void 0,scale:100,offsetX:0,offsetY:0,hoverId:"",direction:At.MindMappingType.LOGIC_DIAGRAM_LEFT,loading:!0,lineStyle:At.MindMappingLineStyle.NORMAL,fixWidthRecord:{}});q(this,"option");q(this,"dragInfo");q(this,"layoutProvider");q(this,"graph");q(this,"cacheSize",{});q(this,"scaleListeners",[]);q(this,"alignSiblingNode");q(this,"nodesByLevelOrder",{});q(this,"nodesByLevelMap",{});q(this,"setRootId",t=>{this.state.rootId!==t&&this.performChange(n=>{n.rootId=t})});q(this,"performChange",t=>{this.beginDraft(),t(this.getDraftState()),this.endDraft()});q(this,"tmpAddMindNodes");q(this,"tmpUpdateMindNodes");q(this,"addMindNode",(t,n)=>{this.tmpAddMindNodes||(this.tmpAddMindNodes={});const s={id:t,left:jf,top:jf,parentId:n!=null?n:"",childrenIds:[],regionHeight:0,regionWidth:0,childrenHeight:0,childrenWidth:0,leftChildrenHeight:0,leftRegionHeight:0,rightRegionHeight:0,rightChildrenHeight:0,leftRegionWidth:0,rightRegionWidth:0,expanded:!0,x:0,y:0,width:n===this.state.rootId?116:100,height:36,reallyWidth:0},a=this.cacheSize[t];a&&(s.width=a.width,s.height=a.height,s.reallyWidth=a.reallyWidth),this.tmpAddMindNodes[t]=s;const o=()=>{this.performChange(l=>{if(this.tmpAddMindNodes){for(const c of Object.keys(this.tmpAddMindNodes)){const u=this.tmpAddMindNodes[c];u&&(l.mindNodes[c]=u)}this.tmpAddMindNodes=void 0,this.layout()}})};this.addMindNodeTimer&&clearTimeout(this.addMindNodeTimer),this.addMindNodeTimer=setTimeout(o,10);const{loading:i}=this.getState();i&&(this.loadingTimer&&clearTimeout(this.loadingTimer),this.loadingTimer=setTimeout(this.setAlreadyDone,200))});q(this,"setAlreadyDone",()=>{this.performChange(t=>{t.loading=!1}),this.loadingTimer=void 0});q(this,"loadingTimer");q(this,"addMindNodeTimer");q(this,"updateMindNodeTimer");q(this,"updateMindNode",t=>{var o,i,l,c,u,d,f,h,p;let n=!1;if(this.tmpAddMindNodes){const g=this.tmpAddMindNodes[t.id];g&&(Object.assign(g,t),n=!0),this.loadingTimer&&(clearTimeout(this.loadingTimer),this.loadingTimer=setTimeout(this.setAlreadyDone,200))}if(!n){const g=()=>{this.performChange(_=>{if(this.tmpUpdateMindNodes){for(const x of Object.keys(this.tmpUpdateMindNodes)){const y=_.mindNodes[x],b=this.tmpUpdateMindNodes[x];y&&b&&Object.assign(y,b)}this.tmpUpdateMindNodes=void 0,this.layout()}})};if(this.tmpUpdateMindNodes||(this.tmpUpdateMindNodes={}),this.tmpUpdateMindNodes){const _=this.tmpUpdateMindNodes[t.id];_?Object.assign(_,t):this.tmpUpdateMindNodes[t.id]=t}this.updateMindNodeTimer&&clearTimeout(this.updateMindNodeTimer),this.updateMindNodeTimer=setTimeout(g,10)}const{loading:s,mindNodes:a}=this.getState();this.cacheSize[t.id]={width:(l=(i=t.width)!=null?i:(o=a[t.id])==null?void 0:o.width)!=null?l:0,height:(d=(u=t.height)!=null?u:(c=a[t.id])==null?void 0:c.width)!=null?d:0,reallyWidth:(p=(h=t.reallyWidth)!=null?h:(f=a[t.id])==null?void 0:f.reallyWidth)!=null?p:0},s&&(this.loadingTimer&&clearTimeout(this.loadingTimer),this.loadingTimer=setTimeout(this.setAlreadyDone,200))});q(this,"setLineColor",t=>{this.option.lineColor=t,this.graph.layout()});q(this,"deleteMindNode",t=>{this.performChange(n=>{delete n.mindNodes[t]})});q(this,"setCanvas",t=>{var n;(n=this.graph)==null||n.setCanvas(t)});q(this,"setDragCanvas",t=>{var n;(n=this.graph)==null||n.setDragCanvas(t)});q(this,"setContainer",t=>{var n;(n=this.layoutProvider)==null||n.setContainer(t)});q(this,"setScroller",t=>{var n;(n=this.layoutProvider)==null||n.setScroller(t)});q(this,"destroy",()=>{});q(this,"setSize",(t,n)=>{this.performChange(()=>{var s;(s=this.layoutProvider)==null||s.setSize(t,n),this.layout()})});q(this,"getSize",()=>{var t,n;return[(t=this.layoutProvider)==null?void 0:t.width,(n=this.layoutProvider)==null?void 0:n.height]});q(this,"updateDragInfo",t=>{this.performChange(n=>{this.computeNodesCoordinate(),this.dragInfo=t,n.dropInfo=this.getDropPosition(t)})});q(this,"setHoverId",t=>{this.state.hoverId!==t&&this.performChange(n=>{n.hoverId=t!=null?t:""})});q(this,"setAlignSiblingNode",t=>{this.alignSiblingNode=t,this.performChange(n=>{n.fixWidthRecord={},this.layout()})});q(this,"clearDropInfo",()=>{this.dragInfo=void 0,this.performChange(t=>{t.dropInfo=void 0})});q(this,"computeNodesCoordinate",()=>{this.performChange(()=>{var t;(t=this.layoutProvider)==null||t.computeNodesCoordinate()})});q(this,"getDropPosition",t=>{var n;return(n=this.layoutProvider)==null?void 0:n.getDropPosition(t)});q(this,"setLineStyle",t=>{this.performChange(n=>{n.lineStyle=t})});q(this,"setDirection",(t,n=!1)=>{var s,a,o,i,l,c,u,d;if(this.state.direction!==t){let f;switch(t){case At.MindMappingType.LOGIC_DIAGRAM_LEFT:f=new U2(this,{verticalMargin:(s=this.option.verticalMargin)!=null?s:Eh,horizontalMargin:(a=this.option.horizontalMargin)!=null?a:wh});break;case At.MindMappingType.LOGIC_DIAGRAM_RIGHT:f=new ZX(this,{verticalMargin:(o=this.option.verticalMargin)!=null?o:Eh,horizontalMargin:(i=this.option.horizontalMargin)!=null?i:wh});break;case At.MindMappingType.MIND_MAPPING:f=new eQ(this,{verticalMargin:(l=this.option.verticalMargin)!=null?l:Eh,horizontalMargin:(c=this.option.horizontalMargin)!=null?c:wh});break;case At.MindMappingType.ORGANIZATION_STRUCTURE:f=new tQ(this,{verticalMargin:(u=this.option.verticalMargin)!=null?u:Eh,horizontalMargin:(d=this.option.horizontalMargin)!=null?d:wh});break}this.layoutProvider&&f&&Ag.copyValueToNewProvider(f,this.layoutProvider),f&&(this.layoutProvider=f,n&&(this.performChange(h=>{h.direction=t,this.layout()}),Promise.resolve().then(()=>{try{this.fitCenter()}catch(h){}})))}});q(this,"getNextNodeIdByArrowKeyboard",(t,n)=>{var s;return(s=this.layoutProvider)==null?void 0:s.getNextNodeIdByArrowKeyboard(t,n)});q(this,"getMindNode",t=>this.draftState?this.draftState.mindNodes[t]:this.state.mindNodes[t]);q(this,"getRootMindNode",()=>{const t=this.draftState?this.draftState.rootId:this.state.rootId,n=this.getMindNode(t);if(!n)throw Error("root not found");return n});q(this,"getDirection",()=>this.draftState?this.draftState.direction:this.state.direction);q(this,"layout",()=>{this.performChange(t=>{var o;let n=0,s=0;const a=t.mindNodes[t.rootId];a&&(n=a.regionWidth,s=a.regionHeight),this._layout(),a&&((o=this.layoutProvider)==null||o.updateScrollerPos(n,s))})});q(this,"updateScale",()=>{this.performChange(t=>{var o,i,l,c;(o=this.layoutProvider)==null||o.updateViewPort(),(i=this.layoutProvider)==null||i.computeOffset();let n=0,s=0;const a=t.mindNodes[t.rootId];a&&(n=a.regionWidth,s=a.regionHeight),(l=this.layoutProvider)==null||l.updateViewPort(),a&&((c=this.layoutProvider)==null||c.updateScrollerPos(n,s))})});q(this,"fitCenter",()=>{var t;(t=this.layoutProvider)==null||t.fitCenter()});q(this,"_layout",()=>{var t;this.computeNodesCoordinate(),(t=this.layoutProvider)==null||t.layout(this.state.rootId)});q(this,"toggleAllMindNode",(t,n)=>{const s=(a,o)=>{const i=a.mindNodes[o];i&&(i.expanded=n,i.childrenIds.forEach(l=>s(a,l)))};this.performChange(a=>{t.forEach(o=>{s(a,o)}),this.layout()})});q(this,"updateMindNodeSize",(t,n,s)=>{var a;this.beginDraft(),(a=this.layoutProvider)==null||a.updateMindNodeSize(t,n,s),this.layout(),this.endDraft()});q(this,"getState",()=>this.state);q(this,"draftState");q(this,"getDraftState",()=>{if(this.draftState)return this.draftState;throw Error("用法不对,请查看getDraftState注释")});q(this,"getLineColor",t=>{var n;return(n=this.layoutProvider)==null?void 0:n.getLineColor(t)});q(this,"callCount",0);q(this,"beginDraft",()=>{if(this.callCount++,this.draftState)return this.draftState;this.draftState=PM(this.state)});q(this,"endDraft",()=>{if(this.callCount--,!this.draftState)throw Error("用法不对,请查看getDraftState注释");let t=[];if(this.callCount===0){if(this.state=OM(this.draftState,n=>{t=n}),this.draftState=void 0,t.length===0||(this.notifyChange(),t.length===1&&t.some(n=>{var s,a;return sQ.includes((a=(s=n.path[0])==null?void 0:s.toString())!=null?a:"")})))return;this.graph.layout()}});q(this,"findSuitableScale",t=>{const{scale:n}=this.getState();let s=n;for(const a of nQ){if(t){if(a>n)return t?a:s}else if(a>=n)return t?a:s;s=a}return n});q(this,"zoomin",(t=-1)=>{this.performChange(n=>{if(t===-1){const s=this.findSuitableScale(!0);n.scale=s}else n.scale=Math.min(n.scale+t,Lv);this.updateScale(),this.notifyScaleListeners(n.scale)})});q(this,"zoomout",(t=-1)=>{this.performChange(n=>{if(t===-1){const s=this.findSuitableScale(!1);n.scale=s}else n.scale=Math.max(Math.round(n.scale)-t,Pv);this.updateScale(),this.notifyScaleListeners(n.scale)})});q(this,"zoom",t=>{this.performChange(n=>{n.scale=Math.max(Pv,Math.min(Math.round(t),Lv)),this.updateScale(),this.notifyScaleListeners(n.scale)})});q(this,"dragLines",()=>{var t;(t=this.layoutProvider)==null||t.drawLines()});q(this,"notifyChange",()=>{Is.unstable_batchedUpdates(()=>{this.callbacks.forEach(t=>t())})});q(this,"callbacks",new Set);q(this,"subscribe",t=>(this.callbacks.add(t),()=>{this.callbacks.delete(t)}));q(this,"getSnapShot",()=>this.state);q(this,"addScaleListener",t=>(this.scaleListeners.push(t),()=>this.removeScaleListener(t)));q(this,"removeScaleListener",t=>{this.scaleListeners=this.scaleListeners.filter(n=>n!==t)});q(this,"notifyScaleListeners",t=>{this.scaleListeners.forEach(n=>n.onScaleChange(this,t))});var n,s;this.option=t,this.graph=new QX(this),this.layoutProvider=new U2(this,{verticalMargin:(n=this.option.verticalMargin)!=null?n:Eh,horizontalMargin:(s=this.option.horizontalMargin)!=null?s:wh}),this.alignSiblingNode=!1}}const sQ=["hoverId"],io=F.createContext(void 0),Ws=()=>{const e=F.useContext(io);if(!e)throw new Error("mindEngine is undefined");return e},rQ=()=>{const e=Ws();return F.useCallback((t,n)=>{e.addMindNode(t,n)},[e])},aQ=F.version.startsWith("18")?MM.useSyncExternalStoreWithSelector:UM.useSyncExternalStoreWithSelector;function Oo(e,t=Object.is){const n=Ws();return aQ(n.subscribe,n.getSnapShot,n.getSnapShot,F.useCallback(()=>e(n.getSnapShot()),[n,e]),t)}const tC=()=>Oo(e=>!e.loading),oQ=()=>{const e=Ws();return F.useCallback(t=>{e.deleteMindNode(t)},[e])},Hi=()=>Oo(e=>e.rootId);function Ov(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function nC(e,t){if(Ov(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(let a=0;a<n.length;a++)if(!Object.prototype.hasOwnProperty.call(t,n[a])||!Ov(e[n[a]],t[n[a]]))return!1;return!0}function Ym(e,t){return Oo(n=>{const s=n.mindNodes[e];if(s&&t&&(t==null?void 0:t.length)>0){const a={};return a&&(t==null||t.forEach(o=>{a[o]=s[o]})),a}return s},nC)}const iQ=()=>Oo(e=>e.mindNodes[e.rootId],nC),sC=()=>Oo(e=>e.scale),lQ=()=>Oo(e=>({offsetX:e.offsetX,offsetY:e.offsetY}),nC),cQ=()=>{const e=Ws();return F.useCallback(()=>{e.fitCenter()},[e])};class uQ{}class mF extends uQ{constructor(n="Draft:"){super();q(this,"unsavedDrafts",new Set);this.prefix=n}hasUnsavedDrafts(){return this.unsavedDrafts.size>0}loadDraft(n){return gV(`${this.prefix}${n}`)}clearUnsavedDrafts(){this.unsavedDrafts.clear()}saveDraft(n,s,a=!1){const o=`${this.prefix}${n}`;if(a)return yT(o),de(s)!==""?this.unsavedDrafts.add(n):this.unsavedDrafts.delete(n),!1;if(s===void 0||de(s)==="")return yT(o),!0;const i=_V(o,s,{expiredAt:Date.now()+1e3*60*60*24,safeToPurge:!1});return i||this.unsavedDrafts.add(n),i}}const tA=F.createContext(null),hF=e=>r.jsx(tA.Provider,{value:e.manager,children:e.children}),dQ=(e,t,n=!1)=>{const s=F.useContext(tA),[a,o]=F.useState(t!=null?t:e==null||n||s==null?void 0:s.loadDraft(e)),i=F.useCallback(l=>{if(l===void 0){o(l),e!=null&&s!=null&&(s==null||s.saveDraft(e,l,n));return}o(c=>{const u=typeof l=="function"?l(c):l;return e!=null&&s!=null&&(s==null||s.saveDraft(e,u,n)),u})},[e,s,n]);return[a,i]};function Ba(e,t,n,s){var c,u;const[a,o]=F.useState({width:t==="width"||t==="all"?(c=d1(e))==null?void 0:c.clientWidth:void 0,height:t==="height"||t==="all"?(u=d1(e))==null?void 0:u.clientHeight:void 0}),i=F.useRef({}),l=d1(e);return F.useLayoutEffect(()=>l?Pd.observe(l,f=>{const{clientWidth:h,clientHeight:p,offsetHeight:g,offsetWidth:_}=f.target,x=n?_:h,y=n?g:p;if(!t){(i.current.width!==x||i.current.height!==x)&&o({width:x,height:y}),i.current.width=x,i.current.height=y;return}switch(t){case"width":i.current.width!==x&&o({width:x});break;case"height":i.current.height!==x&&o({height:y});break;case"all":(i.current.width!==x||i.current.height!==y)&&o({width:x,height:y});break}i.current.width=x,i.current.height=y}):void 0,[s,n,t,l]),{...a}}function nA(e,t,n){const s=F.useRef(t),a=F.useRef({}),o=d1(e);F.useEffect(()=>o?Pd.observe(o,l=>{const{clientWidth:c,clientHeight:u}=l.target;let d=!1;if(!n){(a.current.width!==c||a.current.height!==u)&&(d=!0);return}switch(n){case"width":a.current.width!==c&&(d=!0);break;case"height":a.current.height!==u&&(d=!0);break;case"all":(a.current.width!==c||a.current.height!==u)&&(d=!0);break}a.current.width=c,a.current.height=u,d&&s.current({...a.current})}):void 0,[n,o])}function d1(e,t){if(!e)return t;let n;return typeof e=="function"?n=e():"current"in e?n=e.current:n=e,n}const Nc=({user:e,className:t,forceNickname:n})=>{var a;const s=Yr((a=e==null?void 0:e.uuid)!=null?a:"",e==null?void 0:e.nickname);return r.jsx(Ps,{color:(e==null?void 0:e.backgroundColor)||to.grey,name:n!=null?n:s,icon:{type:"upload",value:e==null?void 0:e.avatar},className:B("text-white rounded-full",t),imgClassName:"rounded-full"})},rC={arrowKey:!0,tabKey:!0,backspaceKey:!0,enterKey:!0,bracketRightKey:!0,minusKey:!0,spaceKey:!0,shortcutKey:!0,slashKey:!0,editorInputKey:!0},fQ={arrowKey:!0},Ic={enterKey:!0,shortcutKey:!0,editorInputKey:!0},mQ={enterKey:!0,shortcutKey:!0,editorInputKey:!1},hQ={arrowKey:!0,enterKey:!0,shortcutKey:!0,backspaceKey:!0,editorInputKey:!0},pQ={editorInputKey:!1,shortcutKey:!0},sA={tabKey:!0,bracketRightKey:!0,minusKey:!0,spaceKey:!0,shortcutKey:!0};let rA;const gQ=e=>{rA=e},_Q=(e,t)=>{const n=e==null?[]:e.slice(0);return n.push({type:m.TextType.USER,uuid:t,enhancer:{},text:""}),n},aC=e=>{var x,y,b;const t=(x=e.noSaveDraft)!=null?x:!1,n=(y=e.showAvatar)!=null?y:!0,s=gt(),a=ae(E=>{var w;return(w=E.blocks[s])==null?void 0:w.type}),{roleWithoutPublic:o}=it(s),i=o!==m.PermissionRole.NONE&&Xt(a),l=dr(()=>WR()),c=F.useRef(null),u=Ba(c,"height"),[d,f]=dQ(e.draftKey,e.initialText,t);F.useEffect(()=>{if(e.remoteAction==null)return;const E=e.remoteAction.subscribe({next:w=>{switch(w.type){case"focus":{l.requestFocus();break}case"reply":{f(k=>_Q(k,w.payload.to)),setTimeout(()=>{l.performChange(k=>{k.select(l.content.length).collapse("focus")}),l.requestFocus()});break}}}});return()=>E.unsubscribe()},[e.remoteAction,l,f]);const h=Qt(),p=dr(()=>qe()),g=de(d)==="",_=rd(()=>l.onActiveChange.pipe(ad(()=>l.active)),l.active);return r.jsxs("div",{"data-is-comment":!0,className:"flex items-start",children:[n&&r.jsx(Nc,{user:h,className:"text-t2 mt-1 w-6 h-6"}),r.jsxs("div",{className:B("relative flex-1 min-w-0 px-1 ml-1",gn({selectors:{"&:focus-within .biz-btns":{opacity:1}}}),((b=u.height)!=null?b:0)>120&&"pb-9"),children:[r.jsx("div",{ref:c,className:B("max-h-[166px] overflow-y-auto px-1 py-2 rounded",gn({selectors:{"&:hover:not(:focus-within)":{backgroundColor:"rgba(0, 0, 0, 0.03)"}}})),children:r.jsx(rA,{className:B("whitespace-pre-wrap biz-inline-editable",gn({selectors:{":not(.biz-placeholder-shown)::after":{display:"inline-block",content:'""',width:"100px"}}})),autoFocus:e.autoFocus,autoFocusCaretToEnd:!0,editorModel:l,placeholder:_?"输入评论（Enter 发送，Shift+Enter 换行）":"请输入评论...",uuid:p,toolbar:!0,segments:d,keydownOption:i?Ic:mQ,onChange:f,onKeyDown:E=>{var w;be("shift+enter")(E)?(E.preventDefault(),l.performChange(k=>{k.insert(`
`)}),l.scrollCaretIntoViewIfNeeded()):be("enter")(E)?de(d)!==""&&(f(void 0),(w=e.onComment)==null||w.call(e,d)):be("mod+v")(E)&&setTimeout(()=>{l.scrollCaretIntoViewIfNeeded()},100)}})}),r.jsxs("div",{className:"absolute right-1 bottom-2 biz-btns flex opacity-0",children:[i&&r.jsx(Fe,{popup:g?"":"提及日期、页面、或成员",children:r.jsx("button",{onClick:async E=>{E.stopPropagation(),await l.requestFocus(),await xs(0),l.inputInsert("@","input")},className:"text-grey3 animate-hover flex",children:r.jsx(H,{name:"IcTitleEmail",className:"w-6 h-6"})})}),r.jsx(Fe,{popup:g?"":"发送评论",children:r.jsx("button",{onClick:()=>{var E;g||(f(void 0),(E=e.onComment)==null||E.call(e,d))},disabled:g,className:B("flex",g?"text-grey4":"text-active_color"),children:r.jsx(H,{name:"IcCommentSend",className:"w-6 h-6"})})})]})]})]})},Uu=1e3*60,Gf=Uu*60,aA=Gf*24;function xQ(e,t){const n=t-e;if(n<=Uu)return"刚刚";if(n<=Gf)return`${Math.floor(n/Uu)}分钟前`;if(n<=aA)return`${Math.floor(n/Gf)}小时前`;const s=he(e);return s.isSame(t,"year")?s.format("M月D日 HH:mm"):s.format("YYYY/M/D HH:mm")}function FQ(e,t,n=200){const s=t-e;return s<=Uu?e+Uu-t+n:s<=Gf?Uu-s%Uu+n:s<=aA?Gf-s%Gf+n:null}const yQ=({timestamp:e})=>{const[t,n]=F.useState(0);return F.useEffect(()=>{const s=FQ(e,Date.now());if(s==null)return;const a=setTimeout(()=>{n(o=>o+1)},s);return()=>clearTimeout(a)},[n,t,e]),r.jsx(r.Fragment,{children:xQ(e,Date.now())})},bQ={elementMeta:{tag:"buildin"},initialize(e){e.setInputHook((t,n,s)=>{const a=UE(t.editorKey),o=new CustomEvent("inlinedinput",{bubbles:!0,cancelable:!0,detail:{content:n,type:s}});if(a.dispatchEvent(o),o.defaultPrevented)return!1}),e.overrideTextComponent(t=>({format:s,className:a,...o})=>{Lr();const i=s.backgroundColor!==null?Rn(s.backgroundColor):void 0;return r.jsx(t,{...o,format:{...s,bold:!1,color:null,backgroundColor:null,underline:!1},className:B(a,gn({fontWeight:s.bold?600:void 0,borderBottom:s.underline?"1px solid":void 0,color:s.color!==null?Us(s.color):void 0,background:i,paddingTop:"3px",paddingBottom:"3px",borderRadius:i?"2px":void 0}))})}),e.overrideTextComponent(t=>({content:s,format:a,length:o,baseOffset:i,markers:l=[],className:c})=>{const d=VM({type:"text",content:s,format:a,length:o},i,l);return r.jsx(F.Fragment,{children:d.map(([f,h],p)=>r.jsx(t,{content:f.content,length:f.length,format:f.format,baseOffset:i,className:B(c,h.map(g=>g.data.className))},p))})})}},EQ={elementMeta:{tag:"buildin"},initialize(e){e.setInputHook((t,n,s)=>{const a=UE(t.editorKey),o=new CustomEvent("inlinedinput",{bubbles:!0,cancelable:!0,detail:{content:n,type:s}});if(a.dispatchEvent(o),o.defaultPrevented)return!1}),e.overrideTextComponent(t=>({content:s,length:a,baseOffset:o,className:i})=>r.jsx(t,{content:s,length:a,format:MI,baseOffset:o,className:i}))}},wQ=({children:e,htmlDataProps:t})=>r.jsx("span",{className:"rounded-sm text-[0.8125em] p-1 mx-[2px] code-inline-color code-font-family",...t,children:e});Bi(jk);const kQ={elementMeta:jk,initialize(e){e.setElementComponent(this.elementMeta.tag,wQ)}},CQ={elementMeta:jk,initialize(e){e.setElementComponent(this.elementMeta.tag,({children:t,htmlDataProps:n})=>r.jsx("span",{...n,children:t}))}};function Xm({className:e,value:t,icon:n,title:s,shortTitle:a,content:o,placeholder:i,onChange:l,readonly:c,Dropdown:u,dropdownProps:d}){const f=me(),h=Kt(),p=dr(qe),g=_=>{c||f.dropdown({modalId:p,popcorn:_.currentTarget,content:u,placement:"bottom-start",contentProps:{...d,value:t,onCloseModal:()=>h(p),onChange:x=>l==null?void 0:l(x)}})};return r.jsxs("div",{className:B("flex h-8 cursor-pointer border-grey5 group hover:border-grey1 border rounded px-2 items-center text-black",e),onClick:_=>{g(_)},children:[r.jsx("div",{className:"flex flex-1 overflow-hidden overflow-ellipsis whitespace-nowrap",children:o||(t!=null?r.jsx(Fe,{popup:a?s:null,children:r.jsxs("div",{className:"flex items-center",children:[n&&r.jsx(H,{size:"middle",className:"mr-1",name:n}),r.jsx("span",{className:"whitespace-nowrap",children:a!=null?a:s})]})}):r.jsx("span",{className:"text-grey4",children:i}))}),r.jsx(H,{size:"xxsmall",className:"text-grey4 group-hover:text-grey1 ml-1",name:"IcArrow"})]})}function oC({className:e,value:t,icon:n,title:s,content:a,placeholder:o,onChange:i,readonly:l,Dropdown:c,dropdownProps:u}){const d=me(),f=Kt(),h=dr(qe),p=g=>{l||d.dropdown({modalId:h,popcorn:g.currentTarget,content:c,placement:"bottom-start",contentProps:{...u,value:t,onCloseModal:f,onChange:_=>{i==null||i(_),f(h)}}})};return r.jsxs("div",{className:B("flex text-t2 px-[6px] h-5 cursor-pointer hover:bg-black_006 rounded-sm items-center text-black",e),onClick:g=>{p(g)},children:[r.jsx("div",{className:"flex flex-1 overflow-hidden overflow-ellipsis",children:a||(t!=null?r.jsxs("div",{className:"flex items-center",children:[n&&r.jsx(H,{size:"middle",className:"mr-1",name:n}),r.jsx("span",{className:"text-grey3 whitespace-nowrap",children:s})]}):r.jsx("span",{className:"text-grey4",children:o}))}),!l&&r.jsx(H,{size:"xxsmall",className:"ml-2 text-grey4",name:"IcArrow"})]})}const oA=()=>{const e=Ft();F.useEffect(()=>{(async()=>{const s=wt.$subscriptionData[e.uuid];if(s){const{users:a}=s,o=a.filter(({userId:i})=>!K.users[i]).map(({userId:i})=>({id:i,table:"user"}));if(o.length){const{users:i}=await Ce.editor.queryRecords({requests:o});i&&ee(El.updateSpaceUsers({users:i}))}}})()},[e.uuid])},TQ=()=>{const e=Ft();return CG(e.uuid)},Bg=()=>{const e=TQ();return ae(({users:t})=>e.map(({userId:n})=>t[n]).filter(Boolean))},V2=new Set;let q2=new Set;const vQ=$n(async e=>{const t=q2;q2=new Set;const n=await Ce.editor.queryRecords({requests:[...t].map(s=>({id:s,table:"user"}))});if(n.users){ee(El.updateSpaceUsers({users:n.users,space:e}));for(const s of Object.values(n.users))V2.delete(s.uuid)}},32),NQ=(e,t)=>{V2.has(e)||(q2.add(e),V2.add(e),vQ(t))},$i=e=>{const t=ae(s=>{if(e!=null)return typeof e=="object"?e:s.users[e]}),n=Ft();return F.useEffect(()=>{e==null||e==="me"||typeof e=="object"||!e||t||NQ(e,n)},[e,t,n]),t};var Me=(e=>(e[e.CELL=0]="CELL",e[e.FIELD=1]="FIELD",e[e.CARD=2]="CARD",e[e.LIST=3]="LIST",e[e.CALENDAR=4]="CALENDAR",e))(Me||{});const iA=({name:e,icon:t,size:n="default",spaceName:s,className:a,backgroundColor:o})=>r.jsxs("div",{className:B("flex items-center overflow-hidden whitespace-nowrap leading-5",a),title:e,children:[r.jsx(Ps,{className:B("!text-t2-medium mr-2 rounded-md text-white",n==="small"&&"!h-5 !w-5",n==="xsmall"&&"!text-t4-medium !h-4 !w-4"),name:s||"未",icon:t,color:o,iconSize:n==="small"?20:void 0}),r.jsx("span",{className:"text-ellipsis",children:e})]}),lA=({name:e,icon:t,size:n="default",className:s})=>r.jsxs("div",{className:B("flex items-center overflow-hidden whitespace-nowrap leading-5",s),title:e,children:[r.jsx(Ps,{className:B("!text-t2-medium mr-2 rounded-md text-white",n==="small"&&"!h-5 !w-5",n==="xsmall"&&"!text-t4-medium !h-4 !w-4"),name:e||"未",icon:t,iconSize:n==="small"?20:void 0}),r.jsx("span",{className:"text-ellipsis",children:e})]}),hi=({userId:e,className:t,size:n="default"})=>{const s=$i(e),a=Yr(e,s==null?void 0:s.nickname);return r.jsxs("div",{className:B("flex items-center overflow-hidden whitespace-nowrap leading-5",t),title:a||(s==null?void 0:s.phone),children:[r.jsx(Ps,{className:B("!text-t2-medium mr-2 rounded-full text-white",n==="small"&&"!h-5 !w-5",n==="xsmall"&&"!text-t4-medium !h-4 !w-4"),imgClassName:"rounded-full",name:a||"客",color:(s==null?void 0:s.backgroundColor)||void 0,icon:s!=null&&s.avatar?{type:"upload",value:s.avatar}:void 0,iconSize:n==="small"?20:void 0}),r.jsx("span",{className:"text-ellipsis",children:a||(s==null?void 0:s.phone)})]})},IQ=({recordId:e,className:t,site:n})=>{const s=ae(({blocks:a})=>{var o;return(o=a[e])==null?void 0:o.updatedBy});return s==null?null:r.jsx(hi,{className:B("my-px",t,(n===Me.FIELD||n===Me.CELL)&&"px-2 py-1.5"),size:Df(n)?"xsmall":"default",userId:s})},jQ=({recordId:e,className:t,site:n})=>{const s=ae(({blocks:a})=>{var o;return(o=a[e])==null?void 0:o.createdBy});return s==null?null:r.jsx(hi,{className:B(t,"my-px",(n===Me.FIELD||n===Me.CELL)&&"px-2 py-1.5"),size:Df(n)?"xsmall":"default",userId:s})},Df=e=>e===Me.CARD||e===Me.LIST||e===Me.CALENDAR,pF=({userId:e,showClose:t,onClose:n,site:s,type:a=m.PermissionType.USER})=>{var l;const o=Ft(),i=(l=o.permissionGroups)==null?void 0:l.find(c=>c.id===e);return r.jsxs("div",{className:B("text-t2 flex min-w-0 flex-nowrap items-center",(s===Me.CARD||s===Me.LIST||s===Me.CALENDAR)&&"mr-2"),children:[a===m.PermissionType.USER?r.jsx(hi,{userId:e,size:Df(s)?"xsmall":"default",className:B("my-px",Df(s)?"":"px-2 py-1.5",(s===Me.CARD||s===Me.LIST||s===Me.CALENDAR)&&"text-t4")}):a===m.PermissionType.GROUP?r.jsx(lA,{name:i==null?void 0:i.name,icon:i==null?void 0:i.icon,className:B("my-px",Df(s)?"":"px-2 py-1.5",(s===Me.CARD||s===Me.LIST||s===Me.CALENDAR)&&"text-t4")}):r.jsx(iA,{name:"全体成员",icon:o.icon,backgroundColor:o.backgroundColor,className:B("my-px",Df(s)?"":"px-2 py-1.5",(s===Me.CARD||s===Me.LIST||s===Me.CALENDAR)&&"text-t4")}),t&&r.jsx(H,{size:"middle",className:"text-brown ml-[-8px] cursor-pointer opacity-50",onClick:n,name:"IcToastClose"})]})},Sf=e=>{if(!e)return[];const t=new Map;return e.forEach(n=>{n.type===m.TextType.USER&&n.uuid&&t.set(n.uuid,n)}),[...t.values()]},DQ=({recordId:e,propertyId:t,site:n,className:s})=>{const a=ae(({blocks:i})=>{var l,c;return(c=(l=i[e])==null?void 0:l.data.collectionProperties)==null?void 0:c[t]}),o=Sf(a);return r.jsx("div",{className:B("flex",n===Me.LIST||n===Me.CALENDAR?"":"flex-wrap",n===Me.FIELD&&gn({selectors:{":empty:before":{content:'"未填写"',display:"block",fontSize:"14px",padding:"8px",color:"var(--grey4)",lineHeight:"20px"}}}),s),children:o.map(i=>{var l;return r.jsx(pF,{userId:(l=i.uuid)!=null?l:"",site:n},i.uuid)})})},SQ=({className:e,value:t,onChange:n})=>{const{isLocked:s}=Te(),a=Bg();return r.jsx(Xm,{readonly:s,className:e,value:t,content:t==="me"?"我":t&&r.jsx(hi,{className:"!px-0",userId:t}),onChange:n,Dropdown:AQ,dropdownProps:{value:t,users:a}})},RQ=({noMe:e=!1,users:t,value:n,onCloseModal:s,onChange:a})=>{const[o,i]=F.useState(""),l=[...e?[]:[{type:$.OPERATION,data:{content:r.jsx("span",{children:"我"}),value:"me",thesaurus:"我 wo",onClick:()=>{a==null||a("me"),s()}}}],...Cc(t,o).map(c=>({type:$.OPERATION,data:{content:r.jsx(hi,{className:"!px-0",userId:c.uuid}),value:c.uuid,onClick:()=>{a==null||a(c.uuid),s()}}}))];return r.jsxs(r.Fragment,{children:[r.jsx(xt,{autoFocus:!0,className:"mx-[10px] mt-[2px] mb-[6px] h-8",value:o,onChange:c=>{i(c)}}),r.jsx(ze,{className:"text-t2 max-h-[50vh] overflow-y-auto",defaultActiveIndex:l.findIndex(c=>c.data.value===n),items:l})]})},AQ=({...e})=>r.jsx("div",{className:"next-modal py-2",children:r.jsx(RQ,{...e})}),H2=e=>{var o;const[t,n]=F.useState(!1),s=F.useMemo(()=>r.jsx("div",{className:B("next-modal min-w-[160px] py-1",e.optionClassName),children:e.options.map((i,l)=>r.jsx(BQ,{selected:e.selectedIndex===l,...i,onClick:()=>{n(!1),e.onSelect(i,l)}},i.id))}),[e]),a=F.useCallback(i=>{n(i)},[]);return r.jsxs("div",{className:B("flex h-10 items-center justify-between",e.disable?"opacity-30":"",e.className),children:[r.jsx("span",{className:"text-t2 flex-shrink-0",children:e.name}),r.jsx(og,{disable:e.disable,visible:t,onChange:a,content:s,children:r.jsxs("div",{className:B("ml-2 flex items-center text-ellipsis",e.disable?"":"cursor-pointer"),children:[r.jsx("span",{className:B("text-t2 mr-2 text-ellipsis text-grey3"),children:(o=e.options[e.selectedIndex])==null?void 0:o.name}),r.jsx(H,{name:"IcArrow",size:"xxxsmall"})]})})]})},BQ=e=>r.jsxs("div",{className:"flex justify-between items-center px-4 h-9 text-t2 cursor-pointer",onClick:e.onClick,children:[r.jsx("div",{children:e.name}),e.selected&&r.jsx(H,{name:"IcSelectedSpace"})]}),LQ=e=>e<10?Number("200".concat(String(e))):e<100&&e>=10?Number("20".concat(String(e))):e,$2=(e,t=Ct)=>{if(t===Ct){const s=e.replaceAll("-","/").split("/").map(l=>parseInt(l,10)),a=s[0],o=s[1],i=s[2]&&isNaN(s[2])?1:s[2];if(i||i===0){const l=new Date(LQ(a),o-1,i),c=o-1;return isNaN(l.getTime())||l.getDate()!==i||l.getMonth()!==c?void 0:he(l).format(t)}}return e},Mv=e=>!isNaN(new Date(he().format(Ct).concat(" ",e)).getTime()),Uv="YYYY-MM-DD",G2=["h:mm","H:mm","hh:mm","HH:mm"];G2.push(...G2.map(e=>e.concat(" A")));const PQ=e=>{const{includeTime:t,date:n,dateFormat:s,timeFormat:a,autoFocus:o,onChange:i}=e,l=s===m.DateFormat.LL||s===m.DateFormat.RELATIVE,{dateStr:c,timeStr:u}=F.useMemo(()=>{const S=he(n);return{dateStr:S.format(l?Uv:s),timeStr:S.format(a)}},[n,s,l,a]),[d,f]=F.useState(c),[h,p]=F.useState(u),g=F.useRef(),_=F.useRef(),x=F.useRef(),y=F.useRef(),b=F.useRef(),[E,w]=F.useState(!1),[k,C]=F.useState(!1),[T,v]=F.useState(!1),I=!k||!T,j=F.useRef();j.current=i,F.useEffect(()=>{f(c)},[n,c]),F.useEffect(()=>{p(u)},[n,u]),F.useEffect(()=>{C(!0),v(!0)},[n]);const D=F.useCallback(()=>{var U,V;const S=l?Uv:s;let R=y.current.value.trim();R=R.replaceAll("-","/"),R=(U=$2(R))!=null?U:R;const A=uT(R,S);if(C(A),!A)return!1;let L="",P;if(t){const W=b.current.value.trim();for(const Q of G2)if(uT(W,Q)){P=Q;break}const z=!!P;if(v(z),L=W,!z)return!1}let M;return t?M=he(`${R} ${L}`,`${S} ${P}`).toDate():M=he(R,S).toDate(),(V=j.current)==null||V.call(j,M),!0},[s,t,l]);return F.useEffect(()=>{const S=R=>{if(be("enter")(R)&&!D())return!0};return qt.addEventListener("keydown",S,Cx+1,!0),()=>{qt.removeEventListener("keydown",S,!0)}},[D]),F.useEffect(()=>{if(!o)return;const S=setTimeout(()=>{clearTimeout(S),y.current.focus()})},[o]),F.useEffect(()=>{const S=[];return k||S.push(Ql(g.current,_.current,{placement:"left",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),T||S.push(Ql(g.current,x.current,{placement:"right",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),()=>{S.forEach(R=>R.destroy())}},[k,T]),r.jsxs("div",{className:"flex flex-col px-[10px]",children:[r.jsxs("div",{ref:g,className:B("flex bg-grey9 border-grey6 rounded-sm py-[6px] h-8",{"input-error":I,"input-focus":E&&!I}),children:[r.jsx(xt,{inputRef:y,showBorder:!1,className:`border-none ${t?"w-1/2":"w-full"}`,style:{backgroundColor:"transparent"},value:d,onChange:f,onFocus:()=>w(!0),onEnter:D,onBlur:()=>{w(!1),D()}}),t&&r.jsx(xt,{inputRef:b,showBorder:!1,className:"w-1/2 px-3 border-none rounded-none border-grey6",style:{borderLeft:"1px solid #E5E5E5",backgroundColor:"transparent"},onFocus:()=>w(!0),onEnter:D,onBlur:()=>{w(!1),D()},onChange:p,value:h})]}),!k&&r.jsx("div",{ref:_,className:"px-2 py-1 text-white bg-black rounded-sm bg-opacity-70 text-t4",children:r.jsx("span",{children:"无效日期"})}),!T&&r.jsx("div",{ref:x,className:"px-2 py-1 text-white bg-black rounded-sm bg-opacity-70 text-t4",children:r.jsx("span",{children:"无效时间"})})]})},cA=[{name:"无",value:0,time:""},{name:"当天(上午9:00)",value:0,time:"09:00",unit:"day"},{name:"提前1天(上午9:00)",value:1,time:"09:00",unit:"day"},{name:"提前2天(上午9:00)",value:2,time:"09:00",unit:"day"},{name:"提前1周(上午9:00)",value:7,time:"09:00",unit:"day"}],uA=[{name:"无",value:0},{name:"当时",value:0,unit:"minute"},{name:"提前5分钟",value:5,unit:"minute"},{name:"提前10分钟",value:10,unit:"minute"},{name:"提前15分钟",value:15,unit:"minute"},{name:"提前30分钟",value:30,unit:"minute"},{name:"提前1小时",value:1,unit:"hour"},{name:"提前2小时",value:2,unit:"hour"},{name:"提前1天",value:1,unit:"day"},{name:"提前2天",value:2,unit:"day"},{name:"提前1周",value:7,unit:"day"}],OQ=(e,t)=>{if(!e)return 0;const n=t?uA:cA;let s=n.findIndex(a=>a.value===e.value&&a.unit===e.unit);return s!==-1?s:e.unit==="minute"||e.unit==="hour"?1:(s=n.findIndex(a=>e.unit===a.unit&&e.value===a.value),s!==-1?s:0)},MQ=e=>e==="LL"||e==="YYYY/MM/DD"||e==="DD/MM/YYYY"||e==="MM/DD/YYYY"||e==="relative"?e:m.DateFormat.YYYY_MM_DD,Vv=[{id:m.DateFormat.LL,name:"完整日期"},{id:m.DateFormat.YYYY_MM_DD,name:"年/月/日"},{id:m.DateFormat.DD_MM_YYYY,name:"日/月/年"},{id:m.DateFormat.MM_DD_YYYY,name:"月/日/年"},{id:m.DateFormat.RELATIVE,name:"相对日期"}],qv=[{id:m.TimeFormat.H_MM_A,name:"12 小时"},{id:m.TimeFormat.H_MM,name:"24 小时"}],UQ=e=>{const t=F.useMemo(()=>Vv.findIndex(s=>s.id===e.dateFormat),[e.dateFormat]),n=F.useMemo(()=>qv.findIndex(s=>s.id===e.timeFormat),[e.timeFormat]);return r.jsxs("div",{className:"next-modal px-4 py-1 w-[250px]",children:[r.jsx(H2,{name:"日期格式",selectedIndex:t,options:Vv,onSelect:s=>{e.onSelectDateFormat(s.id)}}),r.jsx(H2,{name:"时间格式",disable:e.disableTimeFormat,selectedIndex:n,options:qv,onSelect:s=>{e.onSelectTimeFormat(s.id)}})]})},Rr=e=>{const{className:t,...n}=e;return r.jsx("span",{className:B("block border-t border-grey6",t),...n})},xp=e=>{const{className:t}=e;return r.jsx("div",{className:B("h-2.5 flex items-center w-full flex-shrink-0",t),children:r.jsx("div",{className:"w-full h-px bg-grey6"})})},Lg=()=>{const e=Va();return F.useCallback(t=>{var u;const{keywords:n="",filterIds:s=[],includeGroup:a,users:o=e}=t,l=Object.values(o).map(d=>d).filter(d=>!s.includes(d.uuid)),c=Cc(l,n).map(d=>({...d,type:m.PermissionType.USER}));if(a){const d=(u=Tn().permissionGroups)==null?void 0:u.filter(p=>{const g=yl(p.name);return gd(`${p.name}${g}`).includes(gd(n))}).map(p=>({uuid:p.id,nickname:p.name,iconData:p.icon,type:m.PermissionType.GROUP}));d&&c.unshift(...d);const{uuid:f,icon:h}=Tn();c.unshift({uuid:f,nickname:"全体成员",iconData:h,type:m.PermissionType.SPACE})}return c},[e])},gF=({value:e=[],onUpdate:t=()=>{},onClose:n=()=>{},onSelect:s,includeGroup:a=!0})=>{const o=Lg(),i=Ve(),l=F.useRef(null),[c,u]=F.useState(""),d=F.useMemo(()=>o({keywords:c,includeGroup:a}).filter(b=>!e.some(E=>E.permissionType===b.type?E.permissionType===m.PermissionType.SPACE?!0:E.uuid===b.uuid:!1)),[a,c,o,e]),f=y=>{t(y)},h=(y,b)=>{if(e.findIndex(E=>E.uuid===y)===-1){const E=wc(y);E.permissionType=b,f([...e,E])}},p=()=>{if(e.length>0){const[y,...b]=e;f(b)}},g=y=>{const b=e.findIndex(E=>E.uuid===y);if(b>=0){const E=[];e.forEach((w,k)=>{k!==b&&E.push(w)}),f(E)}},_=(y,b)=>{var E;u(""),h(y,b),s==null||s(y,b),(E=l.current)==null||E.focus()},x=y=>{if(be("Esc")(y)){n();return}!c&&be("Backspace")(y)&&p()};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex min-h-[42px] min-w-[260px] max-w-[480px] flex-wrap items-center px-2",children:[e.map((y,b)=>{var E,w;return r.jsx(pF,{userId:(E=y.uuid)!=null?E:"",showClose:!0,onClose:()=>{y.uuid&&g(y.uuid)},type:(w=e[b])==null?void 0:w.permissionType},y.uuid)}),!i&&r.jsx(oo,{ref:l,autoFocus:!0,singleLine:!0,placeholder:"搜索成员",fontClassName:gn({lineHeight:"24px",fontSize:14,whiteSpace:"nowrap"}),className:gn({width:"100%",selectors:{"&::placeholder":{color:"var(--grey4)"}}}),boxClassName:gn({flexBasis:"auto",flexGrow:1,flexShrink:0,minWidth:120,maxWidth:"100%"}),value:c,onKeyDown:x,onChange:y=>{u(y.target.value)}})]}),r.jsx(Rr,{}),r.jsx(VQ,{className:"py-1.5",users:d,onSelectPerson:_})]})},VQ=({className:e,users:t,value:n,onSelectPerson:s,customHeader:a})=>{const o=t.map(i=>({type:$.OPERATION,data:{content:i.type===m.PermissionType.GROUP?r.jsx(lA,{name:i.nickname,icon:i.iconData}):i.type===m.PermissionType.USER?r.jsx(hi,{className:"!px-0",userId:i.uuid}):r.jsx(iA,{backgroundColor:Tn().backgroundColor,spaceName:Tn().title,name:i.nickname,icon:i.iconData}),value:i.uuid,onClick:()=>{s==null||s(i.uuid,i.type)}}}));return r.jsx(ze,{customHeader:a,items:o,customFooter:r.jsx(r.Fragment,{children:o.length<=0&&r.jsx("div",{className:"text-t2 relative flex h-10 items-center justify-center text-grey4",children:"没有找到相关结果"})}),className:B("text-t2 max-h-[50vh] overflow-y-auto",e),defaultActiveIndex:o.findIndex(i=>i.data.value===n)})},qQ=e=>{const t=me(),n=Ft(),s=Ui(),a=e.userPermissions.reduce((l,c)=>{var u;if(c.userId&&c.type===m.PermissionType.USER){const d=ss(c.userId);d&&(l&&(l+=","),l+=d)}else if(c.type===m.PermissionType.GROUP){const d=(u=n.permissionGroups)==null?void 0:u.find(f=>f.id===c.groupId);d&&(l&&(l+=","),l+=d.name)}else l&&(l+=","),l+="全体成员";return l},""),o=e.userPermissions.map(l=>{var u,d,f;const c=l.type===m.PermissionType.USER;return{type:m.TextType.USER,permissionType:l.type,uuid:c?l.userId:l.groupId,text:c?ss((u=l.userId)!=null?u:""):(f=(d=n.permissionGroups)==null?void 0:d.find(h=>h.id===l.groupId))==null?void 0:f.name,enhancer:{}}}),i=l=>{t.dropdown({popcorn:l.currentTarget,placement:"right",content:c=>r.jsx(HQ,{defaultValue:o,onUpdate:u=>{u||(u=[]);const d=u.map(f=>({type:f.permissionType,userId:f.permissionType===m.PermissionType.USER?f.uuid:"",groupId:f.permissionType===m.PermissionType.GROUP?f.uuid:""}));e.onSelect(d)},onCloseModal:c.onCloseModal})})};return r.jsxs("div",{className:B("flex items-center h-10 my-1 px-4 justify-between",{"opacity-30":s}),children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:"IcMenuPerson",size:"middle"}),r.jsx("span",{className:"text-t2 ml-2",children:"提醒成员"})]}),r.jsxs("div",{className:"flex items-center cursor-pointer",onClick:s?void 0:i,children:[r.jsx("span",{className:"text-t2 ml-2 mr-2 text-ellipsis text-grey3 max-w-[136px]",children:a||"无"}),r.jsx(H,{name:"IcArrow",size:"xxxsmall"})]})]})},HQ=({defaultValue:e,onUpdate:t,onCloseModal:n})=>{const[s,a]=F.useState(e);return r.jsx("div",{className:"next-modal",children:r.jsx(gF,{value:s,onClose:()=>n(),onUpdate:o=>{a(o),t(o)}})})};const $Q="一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),GQ="日_一_二_三_四_五_六".split("_"),zQ="星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),WQ=({onPreviousClick:e,onNextClick:t})=>r.jsxs("div",{className:"absolute right-4 flex justify-between top-5",children:[r.jsx(Fe,{className:"mr-2 rounded-sm animate-hover",children:r.jsx(H,{name:"IcArrowDateBack",size:"middle",onClick:()=>e()})}),r.jsx(Fe,{className:"rounded-sm animate-hover",children:r.jsx(H,{name:"IcArrowDateNext",size:"middle",onClick:()=>t()})})]}),KQ=({date:e})=>r.jsx("div",{className:"table-caption mt-[10px] h-10",children:r.jsx("span",{className:"flex items-center h-full text-black text-t2-bold",children:he(e).format("YYYY年MM月")})}),_F=e=>{var j,D;const{dateInfo:t,onClear:n,closeDatePicker:s,uiOption:a={}}=e,[o,i]=F.useState(!1),l=ks(),{includeTime:c=!0,reminder:u}=t,{hasSwitchTimeOption:d=!0,hasEndTime:f=!1,noShadow:h=!1,hasFormatSetting:p=!0,hasRemind:g=!1}=a,{timeFormat:_=m.TimeFormat.H_MM}=t;let{dateFormat:x=m.DateFormat.YYYY_MM_DD}=t;x=MQ(x);const y=Ui(),b=Ve(),E=Vw();F.useEffect(()=>{const S=R=>{be("enter")(R)&&(s==null||s())};return qt.addEventListener("keydown",S,Cx,!0),()=>{qt.removeEventListener("keydown",S,!0)}},[s]);const w=!!u;F.useEffect(()=>{w&&!y&&!b&&Jx(Ut())},[w,y,b]);const k=F.useCallback(S=>{e.onChange({...t,...S})},[t,e]),C=S=>{const R=he(t.from);let A;const L=he(Date.now());S?A=R.hour(L.hour()).minute(L.minute()).toDate():A=R.hour(0).minute(0).toDate();let P;if(f){const M=he(t.to);S?P=M.hour(12).minute(0).toDate():P=M.hour(0).minute(0).toDate()}k({from:A,to:P,reminder:void 0,includeTime:S})},T=F.useCallback((S,R,A)=>{A.stopPropagation();const L=t.from.getHours(),P=t.from.getMinutes(),M=he(S).hour(L).minute(P).toDate();k({from:M,to:void 0}),c||s==null||s()},[s,t.from,c,k]),v=c?uA:cA,I=F.useMemo(()=>OQ(u,c),[c,u]);return r.jsxs("div",{className:B("w-[282px] bg-white2 pt-2.5 pb-[5px]",{"next-modal":!h}),children:[r.jsx(PQ,{date:t.from,dateFormat:x,timeFormat:_,includeTime:c,autoFocus:!0,onChange:S=>{var P,M;const R=v[I],A=[{userId:K.user.uuid,type:m.PermissionType.USER}],L=(M=(P=t.reminder)==null?void 0:P.userPermissions)!=null?M:A;if(!w){k({from:S});return}if(c){const U=he(S).format("HH:mm");k({from:S,reminder:{...Jn(R,"name"),time:U,userPermissions:L}})}}}),r.jsx(UI,{className:"flex justify-center w-full",fixedWeeks:!0,selectedDays:t.from,firstDayOfWeek:E===m.DaySetting.MON?1:0,navbarElement:WQ,captionElement:KQ,locale:"zh-cn",month:t.from,months:$Q,onDayClick:T,weekdaysShort:GQ,weekdaysLong:zQ}),d&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-[252px] h-px bg-grey6 mx-[15px] mt-3"}),r.jsx("div",{children:r.jsxs("div",{className:"flex items-center my-1 justify-between h-10 px-4",children:[r.jsx("span",{className:"text-t2",children:"时间点"}),r.jsx(wn,{open:c,onSwitch:C})]})})]}),g&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-[252px] h-px bg-grey6 mx-[15px] mt-3"}),r.jsx("div",{children:r.jsxs("div",{className:"flex items-center my-1 justify-between h-10 px-4",children:[r.jsx(H,{name:"IcMenuAlarm",size:"middle"}),r.jsx(H2,{name:"提醒",className:"w-full ml-2",selectedIndex:I,options:v.map(S=>({...S,id:S.name})),onSelect:(S,R)=>{var M,U;if(R===0){k({reminder:void 0});return}l(Ae.CREATE_DATE_MENTION,We.basicList,{step2:!0});const A=v[R],L=[{userId:K.user.uuid,type:m.PermissionType.USER}],P=(U=(M=t.reminder)==null?void 0:M.userPermissions)!=null?U:L;if(A)if(c){const V=he(t.from).format("HH:mm");k({reminder:{...Jn(A,"name"),time:V,userPermissions:P}})}else k({reminder:{...Jn(A,"name"),userPermissions:P}})}})]})})]}),g&&I>0&&r.jsx(qQ,{userPermissions:(D=(j=t.reminder)==null?void 0:j.userPermissions)!=null?D:[],onSelect:S=>{k({reminder:{...t.reminder,userPermissions:S}})}}),p&&r.jsx(r.Fragment,{children:r.jsxs(og,{visible:o,placement:"right",content:r.jsx(UQ,{disableTimeFormat:!c,dateFormat:x,timeFormat:_,onSelectDateFormat:S=>{i(!1),k({dateFormat:S})},onSelectTimeFormat:S=>{i(!1),k({timeFormat:S})}}),children:[r.jsx("div",{className:"w-[252px] h-px bg-grey6 mx-[15px] "}),r.jsx("div",{className:"cursor-pointer",children:r.jsxs("div",{className:"flex items-center h-10 my-1 px-4",children:[r.jsx(H,{name:"IcMenuSettings",size:"middle"}),r.jsx("span",{className:"text-t2 ml-2",children:"日期格式"})]})})]})}),r.jsx("div",{className:"w-[260px] h-px bg-grey6 my-1 mx-[11px]"}),r.jsx("div",{className:"flex items-center h-10 pl-4 cursor-pointer text-t2",onClick:n,children:"清除"})]})};var Na=(e=>(e[e.date=1]="date",e[e.person=2]="person",e[e.page=3]="page",e[e.search=4]="search",e[e.searchPerson=5]="searchPerson",e[e.foldPage=6]="foldPage",e[e.foldUser=7]="foldUser",e))(Na||{});const dA=({left:e,right:t,setFakeFocus:n,blockId:s,symbol:a="@",tip:o="",onCloseModal:i,getEditorModel:l,changeTipWhenComposing:c})=>{const[u,d]=F.useState("");return F.useEffect(()=>{const f=l(s);if(!f)return;const h=f.createCursor(e,"left"),p=f.createCursor(t,"right");if(n){d(br(yr(f.content,h.offset,p.offset)));return}f.performChange(y=>{y.select(e,t).replace(yn([zn(zo,{tip:o,symbol:a})])).collapse("end")}),a.length>1&&(p.offset=h.offset+1);const g=f.onSelectionChange.subscribe(()=>{if(f.selection){const{focusOffset:y}=f.selection;y<=h.offset&&i()}}),_=f.onComposingChange.subscribe(()=>{if(!c)return;const b=yr(f.content,h.offset,h.offset+1).items[0];f.isComposing&&b&&b.type==="element"&&b.tag===zo&&b.props.tip&&f.performChange(E=>{E.shadow().select(e,e+1).replace(yn([zn(zo,{tip:"",symbol:a})]))})}),x=f.onContentChange.subscribe(()=>{const y=yr(f.content,h.offset,p.offset),b=br(y),E=y.items[0];if(E&&E.type==="element"&&E.tag===zo){const w={tip:o,symbol:a};(b||f.isComposing)&&(w.tip=""),E.props.tip!==w.tip&&f.performChange(k=>{k.shadow().select(h.offset,h.offset+1).replace(yn([zn(zo,w)]))}),d(b)}});return()=>{const y=yr(f.content,h.offset,p.offset),b=br(y),E=y.items[0];E&&E.type==="element"&&E.tag===zo&&f.performChange(w=>{w.shadow().select(h.offset,p.offset).replace(`${a}${b}`)}),h.release(),p.release(),g.unsubscribe(),x.unsubscribe(),_.unsubscribe()}},[s,l,i,e,t,d,a,o,c,n]),u},YQ=3,fA=({onlyDate:e,keyword:t,onChange:n,filterTypes:s})=>{const[a,o]=F.useState(!0),[i,l]=F.useState(!1),c=Kc(),u=Ft(),d=IS(),[f,h]=F.useState([]),p=F.useRef(t),g=b=>{h(s?b.filter(E=>!s.includes(E.data.type)):b),o(!0),l(!1)},_=F.useRef($n(async()=>{const b=await Ce.editor.querySpaceVisitsHistory(u.uuid,0);if(typeof b!="object"||!b.recordMap||!b.results)return;const{blocks:E}=b.recordMap;if(!E)return;ee(Gn.update({blocks:E}));const w=T=>{const v=[];let I=E[T];for(;I;)I=E[I.parentId],I&&Xt(I.type)&&v.unshift(I);return v},k=[];let C=0;for(const{uuid:T}of b.results){if(C>=YQ)break;if(!T||T===c)continue;const v=K.blocks[T];v&&(C++,k.push({type:$.SEARCH,data:{uuid:v.uuid,title:de(v.data.segments)||Ot(v.type),icon:v.data.icon,navs:w(T),type:v.type,backgroundColor:v.backgroundColor,categoryType:3}}))}p.current||g(k)},200)),x=F.useRef($n(async b=>{const{resultBlocks:E}=await d({spaceId:u.uuid,pageNo:1,perPage:20,search:b}),w=E.map(({block:k,navs:C})=>({type:$.SEARCH,data:{uuid:k.uuid,title:de(k.data.segments)||Ot(k.type),icon:k.data.icon,navs:C,type:k.type,backgroundColor:k.backgroundColor,categoryType:3}}));p.current===b&&g(w)},200));F.useEffect(()=>{e||(l(!0),p.current=t,t?x.current(t):_.current(),o(!0),n==null||n())},[e,t]);const y=F.useMemo(()=>a&&f.length>5?[...f.slice(0,5),{type:$.OPERATION,data:{categoryType:6,title:`查看其他${f.length-5}个页面`}}]:f,[a,f]);return{setPageFold:o,pageList:y,loading:i}},XQ="CURRENT_DATE",mA="CURRENT_DATETIME",hA="CUSTOM_DATE",z2="InlineDatePickerModal",QQ=()=>{const e=Bg();return oA(),F.useCallback(t=>{const{onlyDate:n,keyword:s="",onlyPeoPel:a,fold:o}=t,i=[{type:$.BLOCK_TEXT,data:{title:"日期"}},{type:$.OPERATION,data:{title:he().format("YYYY/MM/DD"),type:XQ,categoryType:Na.date}},{type:$.OPERATION,data:{title:he().format("YYYY/MM/DD HH:mm"),type:mA,categoryType:Na.date}},{type:$.OPERATION,data:{title:"自定义日期",type:hA,categoryType:Na.date}}];if(n)return{date:i,hasPeople:!1,users:[]};const l=Cc(e,s).map(f=>({type:$.OPERATION,data:{categoryType:Na.person,userId:f.uuid,content:r.jsx(hi,{userId:f.uuid,className:"text-t2 !mx-0 !px-0"})}})).sort((f,h)=>f.data.userId===K.user.uuid||h.data.userId===K.user.uuid?-1:1),c=[],u=5;o&&l.length>u&&s?(c.push(...l.slice(0,u)),c.push({type:$.OPERATION,data:{categoryType:Na.foldUser,title:`查看其他${l.length-u}个成员`}})):s||!o?c.push(...l):(c.push(...l.slice(0,3)),l.length>3&&c.push({type:$.OPERATION,data:{categoryType:Na.foldUser,title:"查看所有成员"}}));const d=[{type:$.BLOCK_TEXT,isHidden:c.length===0,data:{title:"成员"}},...c];return a?{users:d,hasPeople:c.length>0}:{users:[...i,...d],hasPeople:c.length>0}},[e])},Hv=({onCloseModal:e,blockId:t,left:n,right:s,onGlobalCaptureKeydown:a,onlyDate:o,getEditorModel:i})=>{const l=dA({left:n,right:s,blockId:t,onCloseModal:e,getEditorModel:i}),[c,u]=F.useState(!0),d=ks(),f=QQ(),h=pA(),{pageList:p,setPageFold:g,loading:_}=fA({onlyDate:o,keyword:l,onChange(){u(!0)}}),{users:x,hasPeople:y,date:b}=f({onlyDate:o,onlyPeoPel:!!l,keyword:l,fold:c}),E=F.useMemo(()=>[...b!=null?b:[],...y?x:[],{isHidden:o||!_&&p.length===0,type:$.BLOCK_TEXT,data:{title:"页面",icon:_&&r.jsx(hs,{size:"large"})}},...p],[b,y,o,p,_,x]);return!o&&!y&&!p.length&&l?null:r.jsx(ze,{virtualList:!0,defaultActiveIndex:1,className:"w-[260px] py-2 next-modal overflow-y-auto min-h-[30px]",items:E,onItemClick:(w,k,C)=>{const T=i(t);if(!T||!T.selection)return;const{focusOffset:v}=T.selection;if([Na.foldPage,Na.foldUser].includes(w.data.categoryType)){C.preventDefault(),w.data.categoryType===Na.foldPage?(d(Ae.CREATE_REF_PAGE,We.advancedList),g(!1)):u(!1),T.requestFocus();return}e(()=>{w.data.categoryType===Na.person?(T.performChange(I=>{I.shadow().select(n,v).replace(yn([zn(Wd,{userId:w.data.userId})]))}),T.requestFocus()):w.data.categoryType===Na.page?(T.performChange(I=>{I.shadow().select(n,v).replace(yn([zn(oi,{pageId:w.data.uuid})]))}),T.requestFocus(),d(Ae.GUIDE_FIRST_TIME_LINK_PAGE,We.advancedList)):(T.performChange(I=>{I.shadow().select(n,v).replace(yn([zn(bc,{datetime:Date.now(),includeTime:w.data.type===mA})]))}),w.data.type===hA&&h(n,s,()=>i(t)),T.requestFocus(),d(Ae.CREATE_DATE_MENTION,We.basicList,{step1:!0}))})},onGlobalCaptureKeydown:a})},JQ=({getEditorModel:e,cursorLeft:t,cursorRight:n})=>{const s=Kt(),[a,o]=F.useState(()=>{const i=e(),c=yr(i.content,t.offset,t.offset+1).items[0],u=d=>he(d).hour(12).toDate();return c&&c.type==="element"&&c.tag===bc?{from:new Date(c.props.datetime),includeTime:c.props.includeTime,dateFormat:c.props.dateFormat,timeFormat:c.props.timeFormat,reminder:c.props.reminder}:{from:u(new Date),includeTime:!1}});return r.jsx(_F,{dateInfo:a,uiOption:{hasRemind:!0},onChange:i=>{o(i);const l=e();l&&l.performChange(c=>{c.select(t.offset,t.offset+1).replace(yn([zn(bc,{datetime:i.from.getTime(),includeTime:!!i.includeTime,dateFormat:i.dateFormat,timeFormat:i.timeFormat,reminder:i.reminder})])).collapse("end")})},onClear:()=>{const i=e();i&&(s(z2),i.performChange(l=>{l.shadow().select(t.offset,n.offset).delete()}),i.requestFocus())}})},pA=()=>{const e=me(),t=Kt();return F.useCallback((s,a,o)=>{const i=o();if(!i)return;const{selection:l}=i;if(!l||!l.isCollapsed)return;const c=i.createCursor(s,"left"),u=i.createCursor(a,"left"),d=i.onSelectionChange.subscribe(()=>{if(i.selection){const{focusOffset:f}=i.selection;(f<=c.offset||u.offset<f)&&t(z2)}});e.dropdown({modalId:z2,closeBeforeCallBack:()=>{d.unsubscribe(),c.release(),u.release()},popcorn:{getBoundingClientRect(){return i.getBoundingClientRectOfRange(c.offset,c.offset)}},placement:"bottom-start",offset:[0,15],content(){return r.jsx(JQ,{getEditorModel:o,cursorLeft:c,cursorRight:u})}})},[t,e])},xF=e=>{const t=[];e.overline&&t.push("overline"),e.dashed&&t.push("dashed"),e.lineThrough&&t.push("line-through");const n=eF(e);n.textDecoration!=null&&t.push(n.textDecoration);const s={...n,borderBottom:e.underline?"1px solid":void 0,fontWeight:e.bold?"600":void 0,fontStyle:e.italic?"italic":void 0,color:e.color!=null?Us(e.color):void 0};return t.length>0&&(s.textDecoration=t.join(" ")),e.backgroundColor!=null&&(s.background=Rn(e.backgroundColor),s.borderRadius="2px"),s},gA={tag:bc,hasContent:!1,legalize:e=>{var n;const t=he(e.props.datetime).format((n=e.props.includeTime)!=null&&n?us:Ct);return yn([eo(` ${t} `)])},setFormat:(e,t)=>{e.props.textFormat=ro(t,e.props.textFormat)}};Bi(gA);const ZQ=({htmlDataProps:e,datetime:t,includeTime:n,textFormat:s,dateFormat:a,timeFormat:o,reminder:i,baseOffset:l})=>{var k,C;const c=t,u=n!=null?n:!1,d=a!=null?a:m.DateFormat.YYYY_MM_DD,f=o!=null?o:m.TimeFormat.H_MM,h=i!=null?i:void 0,p=ro(s),g=xF(p),_=pA(),{readonly:x,interactable:y}=F.useContext(qm),b=rw(c,d,u,f),[E,w]=F.useState(!1);return F.useEffect(()=>{const T=Rj(c,h);if(!T)return;const v=T-Date.now();if(v>0){w(!1);let I;return v<1*24*60*60*1e3&&(I=setTimeout(()=>{w(!0)},v)),()=>{I&&clearTimeout(I)}}w(!0)},[c,h]),r.jsxs("span",{...e,contentEditable:!1,className:B("flex-inline items-center px-1 h-full py-[3px]",!x&&y&&"cursor-pointer",{"line-through text-red/70":E}),style:g,onClick:x||!y?void 0:T=>{const v=$p(T.target);if(!v)return;const I=v.getAttribute("data-editor");I&&(T.stopPropagation(),_(l,l+1,()=>nr(I)))},children:[r.jsx("span",{className:B((k=g.color)!=null?k:"text-grey4",{"text-red":h,"text-red/70":E}),children:"@"}),r.jsx("span",{className:B((C=g.color)!=null?C:"text-grey3",{"text-red":h,"text-red/70":E}),children:b}),h&&r.jsx(H,{name:"IcMenuAlarm",size:"normal",className:B("text-red ml-[2px]",{"text-red/70":E})})]})},_A={elementMeta:gA,initialize(e){e.setElementComponent(this.elementMeta.tag,ZQ)}},xA={tag:Ed,hasContent:!1,hasBoundary:!1,legalize:e=>{const t=e.props.text;return yn([eo(`${t}`)])},setFormat:(e,t)=>{e.props.textFormat=ro(t,e.props.textFormat)}};Bi(xA);const eJ=({htmlDataProps:e,textFormat:t,text:n})=>{const s=ro(t),a=xF(s);return r.jsx("span",{...e,style:a,className:"py-[3px]",children:r.jsx($s,{contentEditable:!1,emojiStr:n,disableHover:!0,inline:!0,className:B("inline cursor-default mp-px",{}),style:{top:bH?"-0.1em":void 0}})})},FA={elementMeta:xA,initialize(e){e.setElementComponent(this.elementMeta.tag,eJ)}},Qm=e=>{if(!e)return"";const t=e.split("::");let n=t[t.length-1];return n&&(n=n.slice(0,36)),n!=null?n:""},za={activeEditorKey:null,selection:null},yA=(e,t)=>{F.useEffect(()=>{const n=t.onActiveChange.subscribe(()=>{t.active?za.activeEditorKey=e:za.activeEditorKey===e&&(za.activeEditorKey=null)});return()=>{za.activeEditorKey===e&&(za.selection=t.selection),n.unsubscribe()}},[e,t])},Jm=Symbol("SYNCED_SEGMENTS_REF_SYMBOL"),Pg=Symbol("SYNCED_REVISION_REF_SYMBOL"),FF=(e,t,n)=>{const s=e[Jm],a=e[Pg];if(s&&!zD(s.current,t)){const{wrapSegments:o,hasNewEmoji:i}=Dk(t!=null?t:[]),l=gp(i?o:t);e.performChange(c=>{var u,d;c.load(l),n!==void 0&&c.select((u=n==null?void 0:n.offset)!=null?u:0,(d=n==null?void 0:n.endOffset)!=null?d:0)}),s.current=t,a.current=e.revision}else n!==void 0&&e.performChange(o=>{var i,l;o.select((i=n==null?void 0:n.offset)!=null?i:0,(l=n==null?void 0:n.endOffset)!=null?l:0)})},yF=(e,t,n)=>{if(!e)return;const s=Qm(e);if(za.activeEditorKey=e,!le().blocks[s])return;const o=Date.now();let i=!1;const l=()=>{var h;const c=nr(e);if(c===void 0){if(i)return;Date.now()-o<=100&&(i=!0,setTimeout(l));return}const u=le().blocks[s];if(!u)return;const d=c[Jm];if(!d)return;t===-1&&(t=c.content.length);const f=n==="caption"?u.data.caption:(h=u.data)==null?void 0:h.segments;d.current===f?c.performChange(p=>{p.select(t)}):FF(c,f,VI(t,t)),c.requestFocus(),c.scrollCaretIntoViewIfNeeded()};Promise.resolve().then(l)},fr=()=>{const e=F.useContext(mi),t=Os(),n=(s,a,o,i)=>{if(!s)return;let l;i?l=Si(s,i==null?void 0:i.namespace,i==null?void 0:i.syncId):l=Si(s,e,t),yF(l,a,o)};return F.useCallback(n,[e,t])},tJ=()=>{const e=F.useContext(mi),t=Os(),n=(s,a,o,i)=>{if(!s)return;let l;i?l=Si(s,i==null?void 0:i.namespace,i==null?void 0:i.syncId):l=Si(s,e,t);let c=a.clientX,u=a.clientY;requestAnimationFrame(async()=>{if(!l)return;const d=nr(l);if(!d)return;const f=await(async()=>{if(c===0&&u===0)return 0;if(c===1/0&&u===1/0)return d.content.length;await d.scrollCaretIntoViewIfNeeded(),await new Promise(g=>setTimeout(g,0));const h=d.getBoundingClientRectOfRange(0,0),p=d.getBoundingClientRectOfRange(d.content.length,d.content.length);if(!(!h||!p))return c=Zn(c,h.left+.01,p.right-.01),u=Zn(u,h.top+.01,p.bottom-.01),d.hitTest(c,u)})();f!=null&&yF(l,f,o)})};return F.useCallback(n,[e,t])},uu=e=>{const t=F.useRef(null),{text:n,iconProp:s,loading:a,defaultOpenPanel:o,iconElement:i,readonly:l,onClick:c,...u}=e,[d]=F.useState(o);return F.useEffect(()=>{var f;d&&!l&&((f=t.current)==null||f.click())},[d]),ht()?null:r.jsxs("div",{ref:t,onClick:l?void 0:c,...u,className:B("flex items-center w-full h-12.5 py-2.5 pl-3 rounded bg-grey8 cursor-pointer",e.className),children:[i||r.jsx(H,{size:"large",...s,className:B("w-6 h-6 text-grey4",s.className)}),r.jsx("div",{className:B("ml-1.5 text-t2",a?"text-grey3":"text-grey4"),children:n})]})};var W2=(e=>(e.symbols="symbols",e.math="math",e.physical="physical",e.chemistry="chemistry",e))(W2||{}),bA=(e=>(e.math="math",e.func="func",e.arrow="arrow",e.greek="greek",e))(bA||{});const $v=[{icon:"IcMenuSymbol",title:"常用符号",isGroup:!0,type:"symbols",group:[{title:"数学",value:"math"},{title:"函数",value:"func"},{title:"箭头",value:"arrow"},{title:"希腊字母",value:"greek"}]},{icon:"IcMenuMath",title:"数学公式",isGroup:!1,type:"math",group:[]},{icon:"IcMenuPhysics",title:"物理公式",isGroup:!1,type:"physical",group:[]},{icon:"IcMenuChemistry",title:"化学公式",isGroup:!1,type:"chemistry",group:[]}],Gv={symbols:{math:[{symbols:[{cmd:"\\times"},{cmd:"\\div"},{cmd:"\\pm"},{cmd:"\\mp"},{cmd:"\\cdot"},{cmd:"\\star"}]},{symbols:[{cmd:"\\sqrt{ab}"},{cmd:"\\sqrt[n]{ab}"},{cmd:"\\log_{a}{b}"},{cmd:"\\lg{ab}"},{cmd:"a^{b}"},{cmd:"a_{b}"},{cmd:"c_a^b"},{cmd:"\\widetilde{ab}"},{cmd:"\\widehat{ab}"},{cmd:"\\overleftarrow{ab}"},{cmd:"\\overrightarrow{ab}"},{cmd:"\\overbrace{ab}"},{cmd:"\\underbrace{ab}"},{cmd:"\\underline{ab}"},{cmd:"\\overline{ab}"}]},{symbols:[{cmd:"\\neq"},{cmd:"\\leq"},{cmd:"\\geq"},{cmd:"\\sim"},{cmd:"\\approx"},{cmd:"\\cong"},{cmd:"\\equiv"},{cmd:"\\propto"},{cmd:"\\ll"},{cmd:"\\gg"},{cmd:"\\in"},{cmd:"\\subset"},{cmd:"\\subseteq"},{cmd:"\\prec"},{cmd:"\\preceq"},{cmd:"\\simeq"},{cmd:"\\asymp"},{cmd:"\\doteq"},{cmd:"\\succ"},{cmd:"\\succeq"},{cmd:"\\sqsubseteq"},{cmd:"\\sqsupseteq"},{cmd:"\\ni"},{cmd:"\\models"},{cmd:"\\vdash"},{cmd:"\\dashv"},{cmd:"\\perp"},{cmd:"\\mid"},{cmd:"\\parallel"},{cmd:"\\smile"},{cmd:"\\frown"},{cmd:"\\bowtie"},{cmd:"\\unlhd"},{cmd:"\\unrhd"}]},{symbols:[{cmd:"\\hat{a}"},{cmd:"\\check{a}"},{cmd:"\\breve{a}"},{cmd:"\\acute{a}"},{cmd:"\\grave{a}"},{cmd:"\\tilde{a}"},{cmd:"\\bar{a}"},{cmd:"\\vec{a}"},{cmd:"\\dot{a}"},{cmd:"\\ddot{a}"}]}],func:[{symbols:[{cmd:"\\frac{ab}{cd}"},{cmd:"\\frac{\\partial a}{\\partial b}"},{cmd:"\\frac{\\text{d}x}{\\text{d}y}"},{cmd:"\\lim\\limits_{a \\rightarrow b}"},{cmd:"\\int_{a}^{b}"},{cmd:"\\oint_a^b"},{cmd:"\\prod\\limits_a^b"},{cmd:"\\coprod\\limits_a^b"},{cmd:"\\bigcap\\limits_a^b"},{cmd:"\\bigcup\\limits_a^b"},{cmd:"\\bigvee\\limits_a^b"},{cmd:"\\bigwedge\\limits_a^b"},{cmd:"\\bigsqcup\\limits_a^b"},{cmd:"\\sum\\limits_a^b"}]},{symbols:[{cmd:"\\left(\\begin{array}{c}a\\\\ b\\end{array}\\right)"},{cmd:"\\begin{bmatrix}a & b \\\\c & d \\end{bmatrix}"},{cmd:"\\begin{cases}a & x = 0\\\\b & x > 0\\end{cases}"}]},{symbols:[{cmd:"\\arccos"},{cmd:"\\arcsin"},{cmd:"\\arctan"},{cmd:"\\cos"},{cmd:"\\cosh"},{cmd:"\\cot"},{cmd:"\\coth"},{cmd:"\\csc"},{cmd:"\\sec"},{cmd:"\\sin"},{cmd:"\\sinh"},{cmd:"\\tan"},{cmd:"\\tanh"}]},{symbols:[{cmd:"\\exp"},{cmd:"\\log"},{cmd:"\\ln"},{cmd:"\\max"},{cmd:"\\min"},{cmd:"\\sup"},{cmd:"\\inf"}]},{symbols:[{cmd:"\\lim"},{cmd:"\\gcd"},{cmd:"\\hom"},{cmd:"\\ker"},{cmd:"\\det"},{cmd:"\\bmod"}]}],arrow:[{symbols:[{cmd:"()"},{cmd:"[]"},{cmd:"\\{\\}"},{cmd:"\\lfloor"},{cmd:"\\lceil"},{cmd:"\\rfloor"},{cmd:"\\rceil"},{cmd:"\\langle"},{cmd:"\\rangle"},{cmd:"\\backslash"},{cmd:"\\cap"},{cmd:"\\cup"},{cmd:"\\uplus"},{cmd:"\\sqcap"},{cmd:"\\sqcup"},{cmd:"\\vee"},{cmd:"\\wedge"},{cmd:"\\wr"}]},{symbols:[{cmd:"\\leftarrow"},{cmd:"\\Leftarrow"},{cmd:"\\rightarrow"},{cmd:"\\Rightarrow"},{cmd:"\\leftrightarrow"},{cmd:"\\Leftrightarrow"},{cmd:"\\mapsto"},{cmd:"\\leftharpoonup"},{cmd:"\\leftharpoondown"},{cmd:"\\uparrow"},{cmd:"\\downarrow"},{cmd:"\\leftleftarrows"},{cmd:"\\rightrightarrows"},{cmd:"\\leftrightarrows"},{cmd:"\\rightleftarrows"}]}],greek:[{symbols:[{cmd:"\\alpha"},{cmd:"\\beta"},{cmd:"\\gamma"},{cmd:"\\delta"},{cmd:"\\epsilon"},{cmd:"\\zeta"},{cmd:"\\eta"},{cmd:"\\theta"},{cmd:"\\iota"},{cmd:"\\kappa"},{cmd:"\\lambda"},{cmd:"\\mu"},{cmd:"\\nu"},{cmd:"\\xi"},{cmd:"\\pi"},{cmd:"\\rho"},{cmd:"\\sigma"},{cmd:"\\tau"},{cmd:"\\upsilon"},{cmd:"\\phi"},{cmd:"\\chi"},{cmd:"\\psi"},{cmd:"\\omega"}]}]},disciplineFormula:{math:[{title:"傅里叶级数",symbols:[{cmd:"f(x) = {{{a_0}} \\over 2} + \\sum\\limits_{n = 1}^\\infty {({a_n}\\cos {nx} + {b_n}\\sin {nx})}"}]},{title:"泰勒展开式",symbols:[{cmd:"e ^ { x } = 1 + \\frac { x } { 1 ! } + \\frac { x ^ { 2 } } { 2 ! } + \\frac { x ^ { 3 } } { 3 ! } + \\cdots , \\quad - \\infty < x < \\infty"}]},{title:"高斯公式",symbols:[{cmd:"\\iiint _ { \\Omega } \\left( \\frac { \\partial {P} } { \\partial {x} } + \\frac { \\partial {Q} } { \\partial {y} } + \\frac { \\partial {R} }{ \\partial {z} } \\right) \\mathrm { d } V = \\oint _ { \\partial \\Omega } ( P \\cos \\alpha + Q \\cos \\beta + R \\cos \\gamma ) \\mathrm{ d} S"}]},{title:"定积分",symbols:[{cmd:"\\lim\\limits_ { n \\rightarrow + \\infty } \\sum _ { i = 1 } ^ { n } f \\left[ a + \\frac { i } { n } ( b - a ) \\right] \\frac { b - a } { n } = \\int _ { a } ^ { b } f ( x ) dx"}]},{title:"和的展开式",symbols:[{cmd:"( 1 + x ) ^ { n } = 1 + \\frac { n x } { 1 ! } + \\frac { n ( n - 1 ) x ^ { 2 } } { 2 ! } + \\cdots"}]},{title:"三角恒等式1",symbols:[{cmd:"\\sin \\alpha \\pm \\sin \\beta = 2 \\sin \\frac { 1 } { 2 } ( \\alpha \\pm \\beta ) \\cos \\frac { 1 } { 2 } ( \\alpha \\mp \\beta )"}]},{title:"三角恒等式2",symbols:[{cmd:"\\cos \\alpha + \\cos \\beta = 2 \\cos \\frac { 1 } { 2 } ( \\alpha + \\beta ) \\cos \\frac { 1 } { 2 } ( \\alpha - \\beta )"}]},{title:"欧拉公式",symbols:[{cmd:"{e^{ix}} = \\cos {x} + i\\sin {x}"}]},{title:"格林公式",symbols:[{cmd:"\\iint\\limits_D {({{\\partial Q} \\over {\\partial x}} - {{\\partial P} \\over {\\partial y}})dxdy = \\oint\\limits_L {Pdx + Qdy} }"}]},{title:"贝努力方程",symbols:[{cmd:"{{dy} \\over {dx}} + P(x)y = Q(x){y^n}(n \\ne 0,1)"}]},{title:"全微分方程",symbols:[{cmd:"du(x,y) = P(x,y)dx + Q(x,y)dy = 0"}]},{title:"非齐次方程",symbols:[{cmd:"y = (\\int {Q(x){e^{\\int {P(x)dx} }}dx + C){e^{ - \\int {P(x)dx} }}}"}]},{title:"柯西中值定理",symbols:[{cmd:"\\frac{{f(b) - f(a)}}{{F(b) - F(a)}} = \\frac{{f'(\\xi )}}{{F'(\\xi )}}"}]},{title:"拉格朗日中值定理",symbols:[{cmd:"f(b) - f(a) = f'(\\xi )(b - a)"}]},{title:"曲面面积",symbols:[{cmd:"A = \\iint\\limits_D {\\sqrt {1 + {{\\left( {{{\\partial z} \\over {\\partial x}}} \\right)}^2} + {{\\left( {{{\\partial z} \\over {\\partial y}}} \\right)}^2}} dxdy}"}]},{title:"重积分",symbols:[{cmd:"\\iint\\limits_D {f(x,y)dxdy} = \\iint\\limits_{D'} {f(r\\cos \\theta ,r\\sin \\theta )rdrd\\theta}"}]},{title:"导数公式",symbols:[{cmd:"(\\arcsin x)' = \\frac{1}{{\\sqrt {1 - {x^2}} }}"}]},{title:"三角函数积分",symbols:[{cmd:"\\int {tgxdx = - \\ln \\left| {\\cos x} \\right| + C}"}]},{title:"二次曲面",symbols:[{cmd:"\\frac{{{x^2}}}{{{a^2}}} + \\frac{{{y^2}}}{{{b^2}}} - \\frac{{{z^2}}}{{{c^2}}} = 1"}]},{title:"二阶微分",symbols:[{cmd:"{{{d^2}y} \\over {d{x^2}}} + P(x){{dy} \\over {dx}} + Q(x)y = f(x)"}]},{title:"方向导数",symbols:[{cmd:"\\frac{{\\partial f}}{{\\partial l}} = \\frac{{\\partial f}}{{\\partial x}}\\cos \\phi + \\frac{{\\partial f}}{{\\partial y}}\\sin \\phi"}]}],physical:[{title:"牛顿第一运动定律",symbols:[{cmd:"\\sum \\vec{F}_{i}=\\frac{d \\vec{v}}{d t}=0"}]},{title:"牛顿第二运动定律",symbols:[{cmd:"\\vec{F}=m \\vec{a}=m \\frac{d^{2} \\vec{r}}{d t^{2}}"}]},{title:"牛顿第三运动定律",symbols:[{cmd:"\\vec{F}_{12}=-\\vec{F}_{21}"}]},{title:"万有引力势能",symbols:[{cmd:"{E_p} = -\\frac{{GMm}}{r}"}]},{title:"库仑定律",symbols:[{cmd:"\\vec{F}=k \\frac{Q q}{r^{2}} \\hat{r}"}]},{title:"静电场环路定理",symbols:[{cmd:"\\oint_{L} \\vec{E} \\cdot d \\vec{I}=0"}]},{title:"毕奥.萨伐尔定律",symbols:[{cmd:"d \\vec{B}=\\frac{\\mu_{0}}{4 \\pi} \\frac{I d I \\times \\vec{r}}{r^{3}}=\\frac{\\mu_{0}}{4 \\pi} \\frac{I d I \\sin \\theta}{r^{2}}"}]},{title:"安培定理",symbols:[{cmd:"d \\vec{F}= Id \\vec{l} \\times \\vec{B}"}]},{title:"法拉第电磁感应定律",symbols:[{cmd:"E = n{{ \\Delta \\Phi } \\over {\\Delta {t} }}"}]},{title:"高斯定理",symbols:[{cmd:"\\left.\\Phi_{e}=\\oint \\vec{E} \\cdot d \\vec{S}=\\frac{1}{\\varepsilon_{0}}\\right\\rangle q"}]},{title:"电场的环路定理",symbols:[{cmd:"\\oint \\vec{E} \\cdot d \\vec{I}=-\\frac{d \\varphi_{B}}{d t}"}]},{title:"安培环路定理",symbols:[{cmd:"\\oint \\vec{B} \\cdot d \\vec{I}=\\mu_{0} I+\\mu_{0} I_{d}"}]},{title:"焦耳定律",symbols:[{cmd:"Q = I ^ { 2 } R \\mathrm { t }"}]},{title:"万有引力定律",symbols:[{cmd:"F = G{{Mm} \\over {{r^2}}}"}]},{title:"爱因斯坦光电效应方程",symbols:[{cmd:"{E_k} = hv - {W_0}"}]},{title:"德布罗意波波长公式",symbols:[{cmd:"\\lambda = \\frac{{ \\frac{{{c^2}}}{v}}}{{ \\frac{{m{c^2}}}{h}}} = \\frac{h}{{mv}} = \\frac{h}{p}"}]},{title:"海森堡不确定性原理",symbols:[{cmd:"\\Delta {x} \\Delta {p} \\ge \\frac{h}{{4 \\pi }}"}]},{title:"狭义相对论长度",symbols:[{cmd:"l = {l_0} \\sqrt {1 - {{( \\frac{v}{c})}^2}}"}]},{title:"简谐振动",symbols:[{cmd:"{y_0} = A \\cos ( \\omega {t} + { \\varphi _0})"}]},{title:"波形方程",symbols:[{cmd:"y(t) = A \\cos ( \\frac{{2 \\pi {x}}}{ \\lambda } + \\varphi )"}]},{title:"多普勒效应",symbols:[{cmd:"f' = \\left( { \\frac{{v \\pm {v_0}}}{{v \\pm {v_s}}}} \\right)f"}]}],chemistry:[{title:"铝和稀硫酸",symbols:[{cmd:"\\ce{2Al + 3{H_2}S{O_4} = A{l_2}{(S{O_4})_3} + 3{H_2} \\uparrow}"}]},{title:"铝和稀盐酸",symbols:[{cmd:"\\ce{2Al + 6HCl = 2AlC{l_3} + 3{H_2} \\uparrow}"}]},{title:"镁和稀硫酸",symbols:[{cmd:"\\ce{Mg + {H_2}S{O_4} = MgS{O_4} + {H_2} \\uparrow}"}]},{title:"镁和稀盐酸溶液",symbols:[{cmd:"\\ce{Mg + 2HCl = MgC{l_2} + {H_2} \\uparrow}"}]},{title:"铁和硫酸铜溶液",symbols:[{cmd:"\\ce{Fe + CuS{O_4} = FeS{O_4} + Cu}"}]},{title:"铁和稀硫酸",symbols:[{cmd:"\\ce{Fe + {H_2}S{O_4} = FeS{O_4} + {H_2} \\uparrow}"}]},{title:"铁和稀盐酸",symbols:[{cmd:"\\ce{Fe + 2HCl = FeC{l_2} + {H_2} \\uparrow}"}]},{title:"锌和稀硫酸",symbols:[{cmd:"\\ce{Zn + {H_2}S{O_4} = ZnS{O_4} + {H_2} \\uparrow}"}]},{title:"锌和稀盐酸",symbols:[{cmd:"\\ce{Zn + 2HCl = ZnC{l_2} + {H_2} \\uparrow}"}]}]}},nJ=e=>{const{onClick:t}=e,[n,s]=F.useState($v[0]),[a,o]=F.useState(bA.math),i=d=>{s(d)},l=d=>o(d),c=n.type===W2.symbols,u=n.type===W2.symbols?Gv.symbols[a]:Gv.disciplineFormula[n.type];return r.jsxs("div",{className:"border-t border-grey6 flex",children:[r.jsx("div",{className:"w-36 p-1.5 border-r border-grey6",children:$v.map(d=>r.jsxs("div",{onClick:()=>i(d),className:Yt("h-10 relative flex items-center justify-center animate-hover my-1 text-t2 pl-3",n.type===d.type&&"bg-black_006"),children:[r.jsx(H,{className:"absolute left-2",size:"middle",name:d.icon}),d.title]},d.type))}),r.jsxs("div",{className:"w-full h-[192px] overflow-y-auto relative pb-2",children:[n.isGroup&&r.jsx("div",{className:"border-b border-grey6 h-10 flex w-full p-1.5 sticky top-0 z-10 bg-white2 text-t2",children:n.group.map(d=>r.jsx("div",{onClick:()=>l(d.value),className:Yt("flex items-center flex-1 justify-center animate-hover mx-0.5",a===d.value&&"bg-black_006"),children:d.title},d.value))}),r.jsx("div",{children:u.map((d,f)=>r.jsxs("div",{children:[d.title&&r.jsx("div",{className:"text-t2 text-grey3 py-2 px-4",children:d.title}),r.jsx("div",{className:Yt("px-3 text-t2",c&&"flex flex-wrap mb-1"),children:d.symbols.map((h,p)=>r.jsx(kj,{onClick:()=>t(h.cmd),text:h.cmd,className:Yt("animate-hover px-3 overflow-x-auto block",c&&"mt-1 flex items-center min-w-[15px] justify-center")},`${p}-${d.type}`))})]},f))})]},n.type)]})},sJ=e=>{const t=F.useRef(null),[n,s]=F.useState(e.content),[a,o]=F.useState(""),i=F.useRef({left:0,right:0}),l=(d,f)=>{i.current={left:d!=null?d:i.current.left,right:f!=null?f:i.current.right}};F.useEffect(()=>{t.current&&(t.current.setSelectionRange(t.current.value.length,t.current.value.length),l(0,t.current.value.length))},[]),F.useEffect(()=>{const{errorMsg:d}=wj(n);o(d)},[n]);const c=d=>{var p;const f=N$(n,d,i.current.left,i.current.right-i.current.left);s(f),e.onChange(f);const h=i.current.left+d.length;(p=t.current)==null||p.focus(),l(h,h),setTimeout(()=>{var g;(g=t.current)==null||g.setSelectionRange(h,h)},0)},u=r.jsx(je,{disable:!!a,colorType:"active",onClick:()=>e.onSubmit(n),className:B("flex-shrink-0 self-start",a&&"opacity-90"),children:"提交"});return r.jsxs("div",{className:"latex-input-panel flex flex-col width-600 max-h-[450px] next-modal",children:[r.jsxs("div",{className:"flex py-3 px-3.5",children:[r.jsxs("div",{className:"flex w-full flex-col justify-center overflow-y-hidden h-full",children:[r.jsx(oo,{onBlurCapture:d=>{l(d.currentTarget.selectionStart,d.currentTarget.selectionEnd),d.currentTarget.focus(),d.currentTarget.setSelectionRange(i.current.left,i.current.right)},ref:t,autoFocus:!0,autoSelectAll:!0,value:n,shiftEnter:!0,onChange:d=>{s(d.target.value),e.onChange(d.target.value)},placeholder:"使用 LaTeX 语法输入文本，例 E = MC^2",className:"placeholder-grey4 overflow-auto pr-1",boxClassName:B("w-full max-h-[200px]",e.singleLine?"":"min-h-[70px]"),fontClassName:"whitespace-pre-wrap ",onKeyDown:d=>{l(d.currentTarget.selectionStart,d.currentTarget.selectionEnd),!be("shift+enter")(d)&&(be("enter")(d)?(d.preventDefault(),e.onSubmit(n)):(be("mod+z")(d)||be(["ArrowLeft","shift+ArrowLeft"])(d)||be(["ArrowRight","shift+ArrowRight"])(d))&&d.stopPropagation())}}),a&&r.jsx("div",{className:"flex items-center h-9 text-red text-t4",children:a})]}),u]}),r.jsx(nJ,{onClick:c})]})},iC=e=>{const t=F.useRef(null),n=me(),[s,a]=F.useState(!1);F.useContext(io);const o=c=>{c.stopPropagation();let u=!1;n.dropdown({popcorn:Br(c.currentTarget),placement:"bottom",offset:e.isInline?[0,8]:[0,0],closeNoAnimate:!0,closeAfterCallBack:()=>{var d;u||(d=e.onCancel)==null||d.call(e)},content:({onCloseModal:d})=>r.jsx(sJ,{singleLine:e.isInline,content:e.content,onChange:f=>{var h;(h=e.onChange)==null||h.call(e,f)},onSubmit:f=>{var h,p;(h=e.onChange)==null||h.call(e,f),(p=e.onSubmit)==null||p.call(e,f),u=!0,d()}})})};F.useEffect(()=>{var c;e.defaultOpenPanel&&((c=t.current)==null||c.click())},[e.defaultOpenPanel]);const i=F.useMemo(()=>e.isInline?r.jsxs("span",{className:"text-t4 text-grey3 bg-grey6 p-1 cursor-pointer rounded inline-flex items-center",children:[r.jsx(H,{name:"IcEquation",size:"small"}),"新公式"]}):r.jsx(uu,{readonly:e.readonly,text:"添加数学公式",className:e.readonly?"cursor-default":"cursor-pointer",iconProp:{name:"IcUploadEquation"}}),[e.isInline,e.readonly]),l=r.jsxs(r.Fragment,{children:[r.jsx(kj,{className:B("w-full leading-[initial]",s&&"hidden"),inline:e.isInline,text:e.content,onRender:c=>a(!!c)}),s&&r.jsxs("span",{className:B("bg-red/30 w-full text-ellipsis",e.isInline?"bg-red/30":"flex items-center text-t1 overflow-x-auto h-[34px]"),children:["公式解析错误: ",e.content]})]});return e.isInline?r.jsx("span",{ref:t,className:"flex line-default",onMouseDown:c=>{c.stopPropagation()},onClick:e.readonly?void 0:o,children:e.content?l:i}):r.jsxs("div",{ref:t,onClick:e.readonly?void 0:o,className:B("line-default group relative h-full w-full",!e.readonly&&"cursor-pointer"),children:[e.content?r.jsx("div",{className:"overflow-auto",children:l}):i,r.jsx(Fe,{className:"disable-select flex items-center absolute top-0 right-0 z-10 cursor-pointer bg-black/75 opacity-0 group-hover:opacity-100 text-white1 transition-opacity text-t4 rounded-sm animate-click",popup:"复制公式",onClick:c=>{c.stopPropagation(),on(e.content,{message:"已复制公式"})},children:r.jsx(H,{name:"IcMenuCopy",size:"middle"})})]})},lC={tag:vi,hasContent:!1,legalize:e=>{const t=e.props.text;return yn([eo(`${t}`)])},setFormat:(e,t)=>{e.props.textFormat=ro(t,e.props.textFormat)},toString:e=>e.props.text};Bi(lC);const EA=e=>{const{htmlDataProps:t,textFormat:n,open:s,text:a="",baseOffset:o,noStyle:i}=e,l=fr(),c=F.useRef(null),[u,d]=F.useState(a),f=ro(n),h=xF(f),{readonly:p,interactable:g}=F.useContext(qm);F.useEffect(()=>d(a),[a]);const _=()=>{const y=$p(c.current);if(!y)return;const b=y.getAttribute("data-editor");if(b)return nr(b)},x=y=>{const b=_();if(!b)return;const{selection:E}=b;if(!E)return;const w=b.createCursor(o,"left"),k=b.createCursor(o+1,"left"),C=()=>{w.release(),k.release()};gd(y)?(b.performChange(T=>{T.select(w.offset,k.offset).replace(yn([zn(vi,{text:y,textFormat:n})]))}),l(b.editorKey,k.offset)):b.performChange(T=>{T.shadow().select(w.offset,k.offset).delete(),b.requestFocus()}),C()};return r.jsx("span",{className:Yt("max-w-full inline-block py-0.5",(p||!g)&&"pointer-events-none"),...t,style:i?{}:h,contentEditable:!1,ref:c,children:r.jsx(iC,{isInline:!0,defaultOpenPanel:!!s,content:u,onChange:y=>{d(y)},onSubmit:x,onCancel:()=>{if(d(a),!gd(a))x("");else{const y=_();y&&l(y.editorKey,o+1)}}})})},wA={elementMeta:lC,initialize(e){e.setElementComponent(this.elementMeta.tag,EA)}},rJ={elementMeta:lC,initialize(e){e.setElementComponent(this.elementMeta.tag,t=>r.jsx(EA,{...t,noStyle:!0}))}},aJ=({link:e,onClick:t,icon:n,blockId:s})=>r.jsxs("div",{className:"border-grey6 mt-2.5 border-b px-4",children:[r.jsx("div",{className:"text-t2 text-grey3 flex h-9 items-center",children:"链接到"}),r.jsxs("div",{className:"mb-2.5 flex items-center",children:[s?r.jsx(tn,{trigger:!1,blockId:s,iconSize:20,className:"mr-1",defaultIcon:r.jsx(H,{name:n,size:"middle"})}):r.jsx($s,{defaultIcon:r.jsx(H,{name:n,size:"middle"})}),r.jsx("span",{className:"text-t2 truncate",onClick:t,children:e})]})]}),zv=({className:e,icon:t,onClick:n,text:s})=>r.jsxs("div",{onClick:n,className:Jf("animate-hover flex items-center px-2 py-1",e),children:[r.jsx(H,{className:"mr-1",name:t,size:"small"}),r.jsx("div",{className:"flex flex-col",children:r.jsx("span",{className:"text-t2 text-black",children:s})})]}),oJ=({inLink:e,link:t,onClearLink:n,onLinkChange:s,onSetLink:a,onCloseModal:o,isInternalLink:i})=>{const[l,c]=F.useState(i);return r.jsx(r.Fragment,{children:e&&!i&&!l?r.jsxs(r.Fragment,{children:[r.jsx(aJ,{icon:"IcUploadWeb",onClick:()=>c(!0),link:t}),r.jsxs("div",{className:"my-1.5 flex items-center px-2",children:[r.jsx(zv,{className:"mr-2.5",text:"复制链接",icon:"IcUrl",onClick:()=>{on(t,{message:"已复制链接"})}}),r.jsx(zv,{text:"清除链接",icon:"IcMenuDelete",onClick:()=>{n==null||n(),o()}})]})]}):r.jsx(xt,{autoFocus:!0,placeholder:"输入网页链接",value:i?"":t,className:"mx-2.5 my-2.5 h-8",onEnter:()=>{a==null||a(),o()},onChange:u=>{s==null||s(u)}})})},iJ=({isInternalLink:e=!1,...t})=>r.jsx("div",{className:"next-modal w-[370px]",children:r.jsx(oJ,{...t,isInternalLink:e})}),tb=new jo(localStorage,"linkInfo",50),lJ=3*24*60*60*1e3,cJ=7*24*60*60*1e3,jc=async(e,t=!1)=>{t&&(e=ZE(e).url);const n=tb.get(e);if(n)return n;try{const s=await Ce.editor.linkInfo.raw({url:e,headers:["X-Frame-Options"]});return s.code===200?(s.data.cover&&s.data.icon?tb.put(e,s.data,Date.now()+cJ):tb.put(e,s.data,Date.now()+lJ),s.data):null}catch(s){return null}},fm=e=>{if(tm(e)||/^\w+:?\/\//.test(e))return e;try{let n=new URL(`${un?"https://":location.protocol}${e}`).toString();return e.endsWith("/")||(n=n.replace(/\/$/g,e.includes("/")?"/":"")),n}catch(t){return e}},kA=e=>!!/mp\.weixin\.qq\.com/.test(e),cC=(e,t)=>{const n=xn(),{model:s,setFakeFocus:a}=t||{},o=F.useRef(""),i=me();return F.useCallback(()=>{var h;const l=s||n(e);if(!l)return;const c=l.active?l.selection:null;if(!c)return;const u=kf(l.content,c.offset,c.endOffset,(p,g)=>{if(p.type==="element"&&p.tag===_o){if(c.isCollapsed)return!0;const _=g+Cf(p);return c.endOffset>g&&c.offset<_}return!1}),d=u.length>0?(h=qI(l.content,u))==null?void 0:h.props.url:null;o.current=d!=null?d:"";const f=({onCloseModal:p})=>{const[g,_]=F.useState(d!=null?d:""),x=y=>{_(y),o.current=y};return F.useEffect(()=>{const y=b=>{be("esc")(b)&&(o.current="")};return document.addEventListener("keydown",y,{capture:!0}),a==null||a(!0),()=>{a==null||a(!1),document.removeEventListener("keydown",y,{capture:!0})}},[]),r.jsx(iJ,{inLink:d!==null,link:g,onLinkChange:x,onClearLink:()=>{x(""),l.performChange(y=>{const b=kf(l.content,c.offset,c.endOffset,(E,w)=>{if(E.type==="element"&&E.tag===_o){if(c.isCollapsed)return!0;const k=w+Cf(E);return c.endOffset>w&&c.offset<k}return!1});y.select(c.offset,c.endOffset),b.length>0&&y.unwrap(_o,b)})},onCloseModal:p})};i.dropdown({popcorn:{getBoundingClientRect:()=>{const p=l.getBoundingClientRectOfRange(c.offset,c.endOffset);return p!=null?p:new DOMRect(-9999,-9999,0,0)}},closeAfterCallBack:()=>{l.requestFocus()},closeBeforeCallBack:()=>{const p=o.current,g=fm(p);g!==""&&l.performChange(_=>{_.select(c.offset,c.endOffset),_.selection!==null&&(_.selection.isCollapsed?_.insert(yn([{type:"element",tag:_o,props:{url:g},content:yn([eo(g,_.format)])}])):_.wrap(_o,{url:g}))})},placement:"bottom",offset:[4,4],content:f})},[s,n,i,a,e])},uJ={getRect:null,disableLink:!0,disableEquation:!0,inLink:null,inCode:!1,inEquation:!1,disableAI:!1},bF=e=>{const t=Os(),[n,s]=F.useState(uJ),a=xn(),o=F.useRef(null),i=eD(o,()=>new HI(!1)),l=a(e),c=F.useRef(null);F.useEffect(()=>{if(!l)return;const d=()=>{try{if(l.readonly){const x=$I();return x==null||x[0]!==l.editorKey?null:l.selection}return l.active||i.value?l.selection:null}catch(x){return null}},f=K3(l.onContentChange,l.onActiveChange,i.pipe(Y3(1)),l.onSelectionChange).pipe(qM(100),HM(()=>l.isContentRendered?$M(0):l.onContentRendered.pipe(OE())),TI(()=>!!UE(l.editorKey)),ad(d)),h=x=>{var T;if(x===null||x.isCollapsed){const{$toolbarInfo:v}=wt;return t&&v&&v.showing&&v.syncId===t&&v.uuid===e&&Ye({$toolbarInfo:{syncId:t,showing:!1,uuid:e}}),{getRect:null,disableLink:!1,inLink:null,inCode:!1,inEquation:!1,disableEquation:!1,disableAI:!1}}const y=kf(l.content,x.offset,x.endOffset,(v,I)=>{if(v.type==="element"&&v.tag===_o){if(x.isCollapsed)return!0;const j=I+Cf(v);return x.endOffset>I&&x.offset<j}return!1}),b=kf(l.content,x.offset,x.endOffset,(v,I)=>{if(v.type==="element"&&v.tag===oi){if(x.isCollapsed)return!0;const j=I+Cf(v);return x.endOffset>I&&x.offset<j}return!1}),E=v=>!!(v.type==="element"&&[oi,kg,bc,Wd].includes(v.tag)),w=kf(l.content,x.offset,x.endOffset,(v,I)=>{if(E(v)){if(x.isCollapsed)return!0;const j=I+Cf(v);return x.endOffset>I&&x.offset<j}return!1}).length>0,k=VE(l.content,x.offset,x.endOffset,v=>v.type==="element"&&v.tag===jr),C=kf(l.content,x.offset+1,x.endOffset,(v,I)=>{if(v.type==="element"&&v.tag===vi){const j=I+Cf(v);return x.endOffset>I&&x.offset<j}return!1});return{getRect:()=>{var v;return(v=l.getBoundingClientRectOfRange(x.offset,x.endOffset))!=null?v:new DOMRect(-9999,-9999,0,0)},disableLink:w||C.length>0,inLink:y.length>0?(T=qI(l.content,y))==null?void 0:T.props.url:null,inCode:k.length>0,inEquation:C.length>0,disableEquation:w,disableAI:b.length>0}};let p=null;const g=f.subscribe(()=>{const x=h(d());s(y=>rn(y,x)?y:x),p===null&&x.getRect&&t&&Ye({$toolbarInfo:{syncId:t,showing:!0,uuid:e}}),p=x.getRect});return d()===null&&(s(h(null)),p=null),()=>{g.unsubscribe(),i.next(!1)}},[l,i,s,t,e]),F.useEffect(()=>{if(!l)return;const d=K3(l.onActiveChange,i.pipe(Y3(1))).subscribe(()=>{var h,p,g,_;c.current===null&&(c.current=l.mark(0,0,{className:gn({backgroundColor:"var(--selection)"})}));const f=c.current;!l.active&&i.value?f.updateRange((p=(h=l.selection)==null?void 0:h.offset)!=null?p:0,(_=(g=l.selection)==null?void 0:g.endOffset)!=null?_:0):f.updateRange(0,0)});return()=>{d.unsubscribe()}},[l,i]);const u=F.useCallback(d=>{i.next(d)},[i]);return{queryResult:n,fakeFocus$:i,setFakeFocus:u}},dJ=e=>{const t=$p(e);if(!t)return;const n=t.getAttribute("data-editor");if(n)return nr(n)};Bi(eR);const fJ=({url:e,fileStorageType:t,children:n,htmlDataProps:s,baseOffset:a})=>{const o=F.useRef(null),i=gt(),l=e,c=t,u=F.useRef(),{interactable:d}=F.useContext(qm),[f,h]=F.useState(pt.print?fm(l!=null?l:""):""),p=dJ(o.current),{setFakeFocus:g}=bF((p==null?void 0:p.editorKey)||""),_=cC((p==null?void 0:p.editorKey)||"",{setFakeFocus:g}),x=Ve(p==null?void 0:p.editorKey);F.useEffect(()=>{(async()=>{let E=l!=null?l:"";c==="internal"?E=await Ls.fetchDownloadUrl(i,E):E=fm(E),h(E)})()},[c,l,i]);const y=async()=>{f&&on(f)},b=E=>{E.preventDefault(),E.stopPropagation();const w=Number(s["data-length"]||0);p&&p.performChange(async k=>{k.select(a,a+w),await p.requestFocus(),_()})};return r.jsx("a",{...s,href:f,ref:o,target:"_blank",rel:"noreferrer",className:B("underline underline-offset-4 text-active_color",d?"cursor-pointer":"cursor-text"),onClick:async E=>{if(E.preventDefault(),!d)return;const w=u.current;if(!w||Math.max(Math.abs(w.upX-w.downX),Math.abs(w.upY-w.downY))>=5)return;const k=document.createElement("a");k.setAttribute("target","_blank"),k.setAttribute("href",f),k.click()},onPointerDown:E=>{u.current={downX:E.clientX,downY:E.clientY,upX:E.clientX,upY:E.clientY}},onPointerUp:E=>{u.current&&(u.current.upX=E.clientX,u.current.upY=E.clientY)},children:r.jsx(Fe,{disabled:x,theme:"none",maxWidth:"none",interactive:!0,className:"inline break-words",placement:"bottom-start",interactiveDebounce:0,popupClass:"next-modal !shadow-light-sm h-7 !flex items-center text-t4 line-clamp-none allow-text-selection",popupClick:E=>{E.preventDefault(),E.stopPropagation()},popup:r.jsxs(r.Fragment,{children:[r.jsx(H,{name:"IcUploadWeb",size:"small",className:"ml-2 mr-1 flex-shrink-0 text-grey3"}),r.jsx("div",{className:"text-ellipsis text-grey3 flex-shrink-0 max-w-[220px]",children:f}),r.jsxs("span",{className:"flex-shrink-0 ml-4 flex items-center",children:[r.jsx(H,{className:"text-grey3 cursor-pointer disable-select",name:"IcMenuCopy",size:"small",onClick:y}),r.jsx("span",{className:"ml-2.5 mr-2 cursor-pointer disable-select",onClick:b,children:"编辑"})]})]}),children:n})})},CA={elementMeta:eR,initialize(e){e.setElementComponent(this.elementMeta.tag,fJ)}},TA={tag:oi,hasContent:!1,setFormat:(e,t)=>{e.props.textFormat=ro(t,e.props.textFormat)}},vA={tag:kg,hasContent:!1,setFormat:(e,t)=>{e.props.textFormat=ro(t,e.props.textFormat)}};Bi(TA);Bi(vA);const NA=({pageId:e,blockId:t,htmlDataProps:n,textFormat:s,baseOffset:a,text:o})=>{const i=_e(e,[]),l=_e(i==null?void 0:i.parentId,[]),c=Ar(zm,Gm),u=Ar(K6,W6),d=Ar(Yx,ur),{interactable:f}=F.useContext(qm),h=ro(s),p=eF(h),g=F.useRef(null),_=F.useCallback(()=>{const b=$p(g.current);if(!b)return;const E=b.getAttribute("data-editor");if(E)return nr(E)},[]);if(!i)return r.jsx("span",{className:"mx-[2px]",...n,ref:g,children:r.jsx(Wx,{id:e,inline:!0})});let x=c?i.parentId!==c:i.parentId!==d;(l==null?void 0:l.type)===m.BlockType.TABLE_ROW&&(x=i.parentId!==u);const y={...p};return h.lineThrough&&(y.textDecoration!=null?y.textDecoration+=" line-through":y.textDecoration="line-through"),r.jsx("span",{className:"mx-[2px]",...n,style:y,ref:g,children:r.jsx(Aa,{uuid:e,blockId:t,isLinkPage:x,interactable:f,autoIconSize:!0,format:s,getEditorModal:_,baseOffset:a,aliasText:o})})},IA={elementMeta:TA,initialize(e){e.setElementComponent(this.elementMeta.tag,NA)}},jA={elementMeta:vA,initialize(e){e.setElementComponent(this.elementMeta.tag,NA)}},DA={tag:Wd,hasContent:!1,legalize:e=>{var s;const t=e.props.userId,n=le().users[t];return yn([eo(` ${ss((s=n==null?void 0:n.uuid)!=null?s:"")} `)])},setFormat:(e,t)=>{e.props.textFormat=ro(t,e.props.textFormat)}};Bi(DA);const mJ=({htmlDataProps:e,textFormat:t,userId:n})=>{var c,u,d;const s=n,a=ro(t),o=$i(s),i=xF(a),l=Yr((c=o==null?void 0:o.uuid)!=null?c:"");return r.jsxs("span",{...e,contentEditable:!1,className:"px-1 py-[3px]",style:i,children:[r.jsx("span",{className:(u=i.color)!=null?u:"text-grey4",children:"@"}),r.jsx("span",{className:(d=i.color)!=null?d:"text-grey3",children:l})]})},SA={elementMeta:DA,initialize(e){e.setElementComponent(this.elementMeta.tag,mJ)}},hJ=({htmlDataProps:e,tip:t,symbol:n})=>r.jsxs("span",{children:[r.jsx("span",{...e,contentEditable:!1,children:n!=null?n:"@"}),r.jsx("span",{"data-tr40owj":"","data-cursor-stop":"",children:"​​"}),t&&r.jsx("span",{className:"text-grey4 ml-[1px] mr-[2px]",children:t})]}),RA={tag:zo,hasContent:!1,legalize:()=>yn([eo("@")])};Bi(RA);const AA={elementMeta:RA,initialize(e){e.setElementComponent(this.elementMeta.tag,hJ)}},EF=[bQ,kQ,_A,SA,CA,IA,jA,AA,wA,FA,pK],kr=[EQ,CQ,_A,SA,CA,IA,AA,wA,FA,jA,rJ];DX(EF);function Pn(e){const{className:t,segments:n,interactable:s=!0,plugins:a=EF,placeholder:o,placeholderColor:i}=e,l=F.useMemo(()=>Kk(a),[a]);let c=gp(n);const u=de(n);return u||(c=gp(mt(o))),r.jsx("div",{className:B(t,"break-words"),style:{color:u?void 0:i!=null?i:"var(--grey4)"},children:r.jsx(qm.Provider,{value:{readonly:!0,interactable:s},children:r.jsx(GM,{content:c,EditorModel:l})})})}const BA=()=>{const e=lF(),t=PR(),n=On(),s=F.useRef(!1),a=F.useRef(null);return F.useCallback(async function o(i,l=0,c){var _;if(l>5){e&&ye.warning("页面尚未加载完成，请稍后重试");return}const u=x=>jn(`.next-space-page [data-block-id="${x}"]`,n),d=()=>{const x=u(i);return x?qS(x).top:null};let f=!1;if(t.isVirtualListMode&&t.virtualRef&&!u(i)){const x=UT(i),y=t.subNodes.findIndex(E=>x.find(w=>E===w.uuid));if(y===-1)return;const b=new jx;(_=t.virtualRef.current)==null||_.scrollIntoView({index:y,align:"start",behavior:"auto",done:()=>{b.resolve()}}),await b.promise,await xs(10),f=!0}s.current=!1,a.current&&clearTimeout(a.current);const h=()=>{const x=document.querySelector(`[data-block-id="${i}"] .block-background`),y=document.querySelector(`[data-block-id="${i}"]:not([data-toc-type])`);if(x)x.setAttribute("style","opacity: 100"),x.classList.add("animate__flash"),xs(1300).then(()=>{x.classList.remove("animate__flash"),x.style.opacity=""}),c==null||c("animateStart");else if(y){const b=document.createElement("div");b.setAttribute("class","absolute inset-0 block-background animate__animated pointer-events-none bg-black_006 transition-opacity rounded-sm animate__flash"),y.appendChild(b),xs(1300).then(()=>y.removeChild(b)),xs(1e3).then(()=>c==null?void 0:c("animateScrollEnd")),c==null||c("animateScrollStart")}},p=d(),g=jn(".next-space-page",n);if(p!==null){const x=async(y,b)=>{if(b>2)return;if(typeof g.scrollTo=="function")if(tp)g.scrollTo({top:y,behavior:"auto"});else if(Math.abs(y-g.scrollTop)>800&&!f){let w=y;g.scrollTop>y?w=w+50:w=w-50,g.scrollTo({top:w,behavior:"auto"}),g.scrollTo({top:y,behavior:"smooth"})}else g.scrollTo({top:y,behavior:f?"auto":"smooth"});else if(g.scrollTop)g.scrollTop=y;else return;if(await xs(200),h(),s.current)return;const E=d();if(E){const w=jn(".next-space-page",n);Math.abs(E-g.scrollTop)>30&&w.scrollTop!==E&&E>0&&(s.current=!0,x(E-100,b++),a.current=setTimeout(()=>{s.current=!1},1e3))}};x(p-100,0)}else{const y=UT(i).filter(b=>[m.BlockType.TEMPLATE].includes(b.type)||ZR(b.uuid));y.length!==0&&(Po(y.map(b=>b.uuid),!0),setTimeout(()=>o(i,l++),500))}},[n,e,t.isVirtualListMode,t.subNodes,t.virtualRef])},pJ=F.createContext(!1),f1=e=>{var f,h;const{commentId:t,discussion:n}=e,s=ae(p=>p.comments[e.commentId]),a=$i(s==null?void 0:s.createdBy),o=Yr((f=s==null?void 0:s.createdBy)!=null?f:""),i=F.useContext(pJ),l=BA(),c=()=>{i&&l(n.parentId)};if(s==null)return null;const{illegal:u}=s,d=s.createdBy===K.user.uuid;return r.jsxs("div",{className:B("flex",e.className),children:[r.jsx(Nc,{user:a,className:"text-t2 w-6 h-6"}),r.jsxs("div",{className:"flex-1 ml-2",children:[r.jsxs("div",{className:"mb-1.5",children:[r.jsx("span",{className:"text-t2-medium",children:o}),r.jsxs("span",{className:"ml-1.5 text-t4 text-grey4",children:[r.jsx(Fe,{popup:he(s.createdAt).format(us),className:"inline",children:r.jsx(yQ,{timestamp:(h=s.createdAt)!=null?h:Date.now()})}),s.updatedAt-s.createdAt>60*1e3?"（编辑过）":null,ht()&&s.ipLocation&&r.jsx("span",{className:"ml-1.5",children:`来自${s.ipLocation}`})]})]}),u&&r.jsxs("div",{children:[r.jsx("span",{className:"text-t2 text-grey4",children:"该评论涉嫌违反社区分享协作政策，已屏蔽显示。"}),d&&r.jsx("span",{className:"cursor-pointer text-t2 text-active_color",onClick:()=>{},children:"我要申诉"})]}),r.jsxs(r.Fragment,{children:[n.comments[0]===t&&r.jsx("div",{className:B("my-1.5 border-l-[3px] border-l-yellow pl-2 line-clamp-3 !rounded-none",i&&"animate-hover"),onClick:c,children:r.jsx(Pn,{className:"whitespace-pre-wrap opacity-60",segments:n.context})}),r.jsx("div",{className:B(i&&"animate-hover"),onClick:c,children:r.jsx(Pn,{className:"whitespace-pre-wrap",segments:s.text})})]})]})]})},Zm=()=>{const e=Kr(),t=Qt();return F.useMemo(()=>{const n=(s,a)=>{var i,l;const o=(l=(i=le().discussions[s])==null?void 0:i.resolved)!=null?l:!1;e.dispatch(bs({init(){e.dispatch(Bu({uuid:s,patch:{resolved:a}}))},undo(){e.dispatch(Bu({uuid:s,patch:{resolved:o}}))},redo(){e.dispatch(Bu({uuid:s,patch:{resolved:a}}))}}))};return{addDiscussion(s){var c,u,d;const a=qe(),o=Date.now(),i=(u=(c=le().blocks[s.blockId])==null?void 0:c.spaceId)!=null?u:"",l={uuid:a,spaceId:i,parentId:s.blockId,status:m.BlockStatus.NORMAL,createdAt:o,updatedAt:o,createdBy:t.uuid,updatedBy:t.uuid,resolved:!1,version:0,comments:[],context:(d=s.context)!=null?d:[]};return e.dispatch(gx({discussion:l})),e.dispatch(tg({uuid:a,parentId:s.blockId})),a},resolveDiscussion(s){n(s.discussionId,!0)},reopenDiscussion(s){n(s.discussionId,!1)},appendComment(s){var c,u,d;const a=qe(),o=Date.now(),i=(u=(c=le().discussions[s.discussionId])==null?void 0:c.spaceId)!=null?u:"",l={uuid:a,spaceId:i,parentId:s.discussionId,version:0,status:m.BlockStatus.NORMAL,createdAt:o,createdBy:t.uuid,updatedAt:o,updatedBy:t.uuid,text:(d=s.text)!=null?d:[],subNodes:[]};return e.dispatch(_x({comment:l})),e.dispatch(xx({uuid:a,parentId:s.discussionId})),a},editComment(s){e.dispatch(lp({uuid:s.commentId,patch:{text:s.newText,updatedAt:Date.now(),updatedBy:t.uuid}}))},deleteComment(s){var l;const a=e.getState().comments[s.commentId];if(a==null)return;const o=a.parentId;e.dispatch(Fx({uuid:a.uuid,parentId:a.parentId,spaceId:a.spaceId})),e.dispatch(lp({uuid:a.uuid,patch:{status:m.BlockStatus.DELETED}}));const i=e.getState().discussions[o];if(i!=null&&i.comments.length===0){e.dispatch(ng({uuid:i.uuid,parentId:i.parentId,spaceId:i.spaceId})),e.dispatch(Bu({uuid:i.uuid,patch:{status:m.BlockStatus.DELETED}}));const c=e.getState().blocks[i.parentId];if(c!=null){const u=d=>{const f=kK(qp(c,d),i.uuid);if(f!==c.data.segments){const h={};zM(h,d,f),e.dispatch(mn({uuid:c.uuid,patch:h}))}};if(u("data.segments"),u("data.caption"),u("data.description"),c.type===m.BlockType.TABLE_ROW)for(const d of Object.keys((l=c.data.collectionProperties)!=null?l:{}))u(`data.collectionProperties.${d}`)}}}}},[e,t.uuid])},LA=e=>{const t=dr(()=>qe());return r.jsx("div",{className:"next-modal w-[500px] p-1",children:r.jsx(aC,{autoFocus:!0,draftKey:t,noSaveDraft:!0,showAvatar:!1,initialText:e.initialText,onComment:e.onComment})})},f0=e=>{var p;const t=ae(g=>g.discussions[e.discussionId]),n=(p=t==null?void 0:t.comments)!=null?p:[],s=ke(),a=Zm(),o=dr(()=>new Up),{role:i}=it(t==null?void 0:t.uuid),l=g=>{s(()=>{a.appendComment({discussionId:e.discussionId,text:g})})};if(F.useEffect(()=>{const g=o.subscribe(_=>{var x;_.type==="resolve"&&((x=e.onResolve)==null||x.call(e))});return()=>{g.unsubscribe()}},[o,e]),t==null)return null;if(t.resolved)return r.jsx(_J,{discussionId:e.discussionId,readonly:e.readonly});const c=ht(),u=Fs(i,m.PermissionRole.COMMENTER),h=c&&e.allowCommentInSharePage&&u||!c&&u;return r.jsxs("div",{className:B("relative pt-4 pb-2.5 group",e.className),children:[r.jsx("div",{className:"absolute z-10 top-3.5 right-0 border rounded opacity-0 group-hover:opacity-100 flex",children:r.jsx(Wv,{editorActions:o,commentId:n[0],readonly:e.readonly})}),r.jsxs("div",{className:"space-y-4",children:[n.map((g,_)=>r.jsxs("div",{className:"relative group-scope",children:[_>=1&&r.jsx("div",{className:"absolute z-10 top-0 right-0 border rounded opacity-0 group-scope-hover:opacity-100 flex",children:r.jsx(Wv,{editorActions:o,commentId:g,readonly:e.readonly})}),r.jsx(f1,{discussion:t,commentId:g})]},g)),h&&r.jsx(aC,{draftKey:e.draftKey,autoFocus:e.autoFocus,remoteAction:o,onComment:l})]})]})},gJ=e=>{const t=Kr(),n=ke(),s=Zm(),a=ae(h=>h.comments[e.commentId]),o=me(),{role:i}=it(e.commentId),l=JS();if(l==null)return null;const c=!(a!=null&&a.illegal)&&Fs(i,m.PermissionRole.COMMENTER)&&(a==null?void 0:a.createdBy)===l.uuid,u=l.spaceRole===m.PermissionRole.EDITOR&&Fs(i,m.PermissionRole.READER)||Fs(i,m.PermissionRole.COMMENTER)&&(a==null?void 0:a.createdBy)===l.uuid,d=()=>{var p;if(e.btnRef.current==null)return;e.onCloseModal();const h=(p=t.getState().comments[e.commentId])==null?void 0:p.text;o.dropdown({popcorn:e.btnRef.current,placement:"bottom-end",content:g=>r.jsx(LA,{initialText:g.text,onComment:_=>{g.onCloseModal(),n(()=>{s.editComment({commentId:e.commentId,newText:_})})}}),contentProps:{text:h}})},f=()=>{o.warning({title:r.jsx(r.Fragment,{children:"确定删除该条评论吗？"}),confirmText:"删除",confirm(){e.onCloseModal(),n(()=>{s.deleteComment({commentId:e.commentId})})}})};return r.jsx(ze,{className:"next-modal w-[180px] py-1",items:[{type:$.OPERATION,isHidden:!c,data:{title:"编辑",icon:"IcMenuRename",onClick:d}},{type:$.OPERATION,isHidden:!u,data:{title:"删除",icon:"IcMenuDelete",onClick:f}}]})},Wv=e=>{const t=me(),n=ke(),s=Zm(),a=F.useRef(null),o=ae(h=>h.comments[e.commentId]),i=ht(),{role:l}=it(o==null?void 0:o.uuid),c=JS(),u=ae(h=>{if((o==null?void 0:o.parentId)!=null)return h.discussions[o.parentId]}),d=h=>{t.dropdown({popcorn:h.currentTarget,content:gJ,contentProps:{commentId:e.commentId,btnRef:a}})},f=()=>{u!=null&&(n(()=>{s.resolveDiscussion({discussionId:u.uuid})}),e.editorActions.next({type:"resolve"}))};return e.readonly||c==null||o==null||u==null?null:r.jsxs(r.Fragment,{children:[Fs(l,m.PermissionRole.COMMENTER)&&r.jsx(Fe,{popup:"回复",children:r.jsx("button",{className:"px-1 border-r last:border-r-0 animate-hover rounded-none",onClick:()=>{i&&!wt.$allowCommentInSharePage&&Ye({$allowCommentInSharePage:!0}),setTimeout(()=>{const h=o==null?void 0:o.createdBy;h!=null&&e.editorActions.next({type:"reply",payload:{to:h}})},10)},children:r.jsx(H,{name:"IcMenuReply",className:"text-grey3"})})}),e.commentId===(u==null?void 0:u.comments[0])&&Fs(l,m.PermissionRole.WRITER)&&r.jsx(Fe,{popup:"解决并隐藏评论",children:r.jsx("button",{className:"px-1 border-r last:border-r-0 animate-hover rounded-none",onClick:f,children:r.jsx(H,{name:"IcResolve",className:"text-grey3"})})}),(c.spaceRole===m.PermissionRole.EDITOR&&Fs(l,m.PermissionRole.READER)||Fs(l,m.PermissionRole.COMMENTER)&&(o==null?void 0:o.createdBy)===c.uuid)&&r.jsx("button",{ref:a,className:"px-1 border-r last:border-r-0 animate-hover rounded-none",onClick:d,children:r.jsx(H,{name:"IcMore",className:"text-grey3"})})]})},_J=e=>{var u;const t=ae(d=>d.discussions[e.discussionId]),n=(u=t==null?void 0:t.comments)!=null?u:[],[s,a]=F.useState(!1),o=ke(),{role:i}=it(t==null?void 0:t.uuid),l=Zm(),c=()=>{o(()=>{l.reopenDiscussion({discussionId:e.discussionId})})};return t==null?null:r.jsxs("div",{className:B("relative py-4 group",e.className),children:[r.jsx("div",{className:"absolute z-10 top-4 right-4 border rounded opacity-0 group-hover:opacity-100 flex",children:Fs(i,m.PermissionRole.WRITER)&&!e.readonly&&r.jsx("button",{className:"px-1 animate-hover rounded-none bg-white text-grey3 text-t4 h-6 leading-6",onClick:c,children:"重新打开"})}),r.jsx("div",{className:"space-y-[15px]",children:n.length<=5||s?n.map(d=>r.jsx(f1,{discussion:t,commentId:d},d)):r.jsxs(r.Fragment,{children:[r.jsx(f1,{discussion:t,commentId:n[0]}),r.jsx("div",{className:"text-t2 text-grey4 ml-6",onClick:()=>a(!0),children:r.jsxs("span",{className:"inline-block animate-hover py-1 px-2",children:["查看中间",n.length-2,"条评论"]})}),r.jsx(f1,{discussion:t,commentId:n[n.length-1]})]})})]})},xJ=(e="unresolved")=>{const t=me(),n=dr(()=>new mF),s=gt(),a=Ve(s,!1,!0);return F.useCallback(o=>{const{editorModel:i,popcorn:l,mask:c=!0,placement:u="bottom",selector:d}=o;d(le()).length<=0||setTimeout(()=>{if(i!=null&&!i.isContentRendered)return;const h=p=>{const g=F.useRef(p);g.current=p,F.useEffect(()=>{if(i==null)return;const b=i.onChange.subscribe(()=>{g.current.onCloseModal()});return()=>b.unsubscribe()},[]);const _=ae(d),y=_.filter(b=>e==="unresolved"?!b.resolved:!0).length===0;return F.useEffect(()=>{y&&g.current.onCloseModal()},[y]),r.jsx(hF,{manager:n,children:r.jsx("div",{className:B("next-modal w-[500px] max-h-[80vh] overflow-y-auto px-4",_.length===0&&"hidden"),children:_.map(b=>r.jsx(f0,{readonly:a,autoFocus:o.autoFocus||ht(),allowCommentInSharePage:!0,draftKey:b.uuid,discussionId:b.uuid,className:"border-t first:border-t-0"},b.uuid))})})};t.dropdown({modalId:Xe.COMMENTS,mask:c,autoClose:!0,popcorn:l,content:h,placement:u,modifiers:[{name:"preventOverflow",options:{padding:15}}],closeNoAnimate:!0})})},[n,e,t,a])},FJ=()=>{const e=me(),t=gt(),n=Ve(t,!1,!0),s=dr(()=>new mF);return F.useCallback(a=>{const{editorModel:o,popcorn:i,mask:l=!0,placement:c="bottom",selector:u}=a;u(le()).length<=0||setTimeout(()=>{const f=h=>{const p=F.useRef(h);p.current=h,F.useEffect(()=>{if(o==null)return;const b=o.onChange.subscribe(()=>{p.current.onCloseModal()});return()=>b.unsubscribe()},[]);const g=ae(u),_=g.filter(b=>b.resolved),x=g.filter(b=>!b.resolved),y=x.length===0;return F.useEffect(()=>{y&&p.current.onCloseModal()},[y]),r.jsx(hF,{manager:s,children:r.jsx("div",{className:B("next-modal w-[500px] max-h-[80vh] overflow-y-auto",g.length===0&&"hidden"),children:r.jsxs($d,{children:[x.length>0&&r.jsx(Zs,{title:`评论（${x.length}）`,children:r.jsx("div",{className:"px-4",children:x.map(b=>r.jsx(f0,{readonly:n,autoFocus:a.autoFocus,allowCommentInSharePage:!0,draftKey:b.uuid,discussionId:b.uuid,className:"border-t first:border-t-0"},b.uuid))})}),_.length>0&&r.jsx(Zs,{title:`已解决（${_.length}）`,children:r.jsx("div",{className:"px-4",children:_.map(b=>r.jsx(f0,{readonly:n,autoFocus:a.autoFocus,discussionId:b.uuid,className:"border-t first:border-t-0"},b.uuid))})})]},`${x.length>0?1:0}${_.length>0?1:0}`)})})};e.dropdown({mask:l,autoClose:!0,popcorn:i,modifiers:[{name:"preventOverflow",options:{padding:15}}],content:f,placement:c,closeNoAnimate:!0})})},[s,e,n])},Zd=e=>{const t=!!F.useContext(io),n=function*(o,i,l=!1){var p,g;const c=o.blocks[i],u=Xt(c==null?void 0:c.type);(e.blockId===i||!u)&&(yield*(p=c==null?void 0:c.discussions)!=null?p:[]);const d=c&&Sg(c==null?void 0:c.type)&&!wt.$expandFoldRecord[c.uuid],f=(c==null?void 0:c.type)===m.BlockType.TABLE;if((l||d||f)&&!u)for(const _ of(g=c==null?void 0:c.subNodes)!=null?g:[])yield*n(o,_,l||d)},s=ae(o=>{let i=0;for(const l of n(o,e.blockId)){const c=o.discussions[l];if(c!=null&&!c.resolved)for(const u of c.comments){const d=o.comments[u];d!=null&&d.status===m.BlockStatus.NORMAL&&(i+=1)}}return i}),a=FJ();return s<=0?null:r.jsxs("div",{"data-comment-block-id":e.blockId,className:B("whitespace-nowrap text-grey3 text-t4 flex items-center animate-hover px-1",e.className),onClick:o=>{const i=o.currentTarget.closest(".relative");[...n(le(),e.blockId)].length<=0||a({placement:t?"right":"bottom",popcorn:i,selector:c=>[...n(c,e.blockId)].map(d=>c.discussions[d]).filter(d=>d!=null)})},children:[r.jsx(H,{name:"IcMenuReply",className:"w-5 h-5 mr-0.5"}),s>9?"9+":s]})},Fp=F.createContext(!0),yJ=F.memo(({position:e,zIndex:t,viewId:n})=>{var s;return n&&e&&((s=le().collectionViews[n])==null?void 0:s.type)===m.CollectionViewType.GALLERY&&(e==="top"?e="left":e="right"),e==="top"?r.jsx("div",{className:"absolute h-1 bg-black/30 inset-x-0 -top-0.5"}):e==="bottom"?r.jsx("div",{className:B("absolute h-1 inset-x-0 bg-black/30",t===0?"bottom-[-3px]":"-bottom-1"),style:{zIndex:t+10},children:r.jsx("span",{className:"w-0.5 h-1 absolute bg-white1 z-[9999] bottom-0 -left-px"})}):e==="left"?r.jsx("div",{className:"absolute inset-y-0 w-1 bg-black/30 pointer-events-none -left-3"}):e==="right"?r.jsx("div",{className:"absolute inset-y-0 w-1 bg-black/30 pointer-events-none -right-3"}):null}),bJ=(e,t,n,s,a)=>{const o=_e(e,[]);return Do(i=>{if(!i||J$(i.cursorArea))return;const{dropId:l,position:c,cursorArea:u}=i;if(t!=null&&t.current&&Z$(u)){const{left:d}=t.current.getBoundingClientRect();if(!eG(d))return}if(c==="bottom"&&l&&o&&![m.BlockType.COLUMN_LIST,m.BlockType.QUOTE,m.BlockType.MARK,m.BlockType.COLLECTION_VIEW,m.BlockType.TEMPLATE].includes(o.type)&&aG(K.blocks,e).has(l)&&i.viewId===s&&i.groupValue===a)return"bottom";if(l===e&&i.dropInChild===!!n&&i.viewId===s&&i.groupValue===a)return c})},ln=({id:e,children:t,bindId:n=!0,hideHoverMenu:s=!1,horizontal:a=!1,fullWidth:o=!0,className:i="",dropInChild:l,blockRef:c,viewId:u,groupValue:d,subGroupValue:f,style:h,disableColorStyle:p,...g})=>{const _=Ig(e),x=_e(e,["discussions"]),y=F.useRef(null),b=c!=null?c:y,E=oX(e),w=bJ(e,y,l,u,d),k=Xr(),C=cX(),T=Os(),v=F.useContext(Fp)&&n,I=F.useMemo(()=>{let S=!1;const R=ls(e);return[...ji(e)].some(A=>{const L=K.blocks[A];return L?R===A?!0:L.type===m.BlockType.COLUMN?(S=!0,!0):!1:!1}),S},[e]),j=Q6(),D=!l&&fg(x)&&j;return r.jsxs("div",{ref:b,className:B("relative cursor-text",o&&"w-full",D&&I&&"pr-10",_.backgroundColor&&"rounded",k?i.replace("animate-hover",""):i,C&&"hide-sync-block-child"),"data-block-id":v?e:null,"data-drop-in-child":l,"data-horizontal":a||null,"data-hide-hover-menu":s?!0:null,style:{...h,...p?{}:_,...E},"data-sync-id":T,"data-view-id":u,"data-group-value":d,"data-sub-group-value":f,...g,children:[t,r.jsx(yJ,{zIndex:Kc()===(x==null?void 0:x.parentId)?0:ji(e).size,position:w,viewId:u}),D&&r.jsx(EJ,{id:e,inColumn:I}),r.jsx(kJ,{id:e,bindId:v,dropInChild:l,position:w,viewId:u,groupValue:d,subGroupValue:f})]})},EJ=F.memo(({id:e,inColumn:t})=>r.jsx("div",{className:B("absolute top-0 right-0 h-full z-10",t&&"right-10"),children:r.jsx(Zd,{className:"absolute left-1 top-[5px]",blockId:e})})),wJ=(e,t,n)=>Do(s=>{const{dropId:a,position:o}=s||{};if(!a)return;const i=K.blocks[e];if(!i||n||o==="middle"&&(Xt(i.type)||Sg(i.type))&&!t)return;const l=K.blocks[i.parentId],c=Kc();if(!(!l||Wr(l.type)||l.type===m.BlockType.COLUMN_LIST||l.uuid===c))return l.uuid===e}),kJ=F.memo(({id:e,bindId:t,dropInChild:n,position:s,viewId:a,groupValue:o,subGroupValue:i})=>{const l=iu(e,a,o,i),c=cF(e),u=wJ(e,c,n),d=Xr(),f=F.useMemo(()=>{var _,x;const h=K.blocks[e];if(!h)return!1;const p=(x=(_=Vd(e))==null?void 0:_.type)!=null?x:h.type;if(d)return s==="middle"?Xt(p)||Sg(p):u;const g=h.type===m.BlockType.FILE&&h.data.display==="image"&&(h.data.link||h.data.ossName);return l&&t&&!g},[e,d,u,l,s,t]);return r.jsx(OR,{className:"absolute inset-0 pointer-events-none",children:f&&r.jsx("div",{className:"block-background animate__animated bg-active_color opacity-[0.12] pointer-events-none absolute inset-0 z-40 rounded-sm transition-opacity"})})}),wF=e=>{var a;const t=_e(e,["data"],["format"]),n=ae(o=>{const i=o.blocks[e];if(!i)return[];const l=[];return i.subNodes.forEach(c=>{const u=o.blocks[c];u&&l.push(u)}),l},{equalityFn:Cn});return F.useMemo(()=>{const o=c=>{var _,x;const{sortType:u,reverse:d}=ex((x=(_=t==null?void 0:t.data)==null?void 0:_.format)==null?void 0:x.orderFolder),f=c.map(y=>({...y,sortTitle:de(y.data.segments),sortSize:m.BlockType.FOLDER===y.type?y.subNodes.length:y.data.size}));let h="updatedAt";switch(u){case m.OrderFolderType.SIZE:case m.OrderFolderType.SIZE_REVERSED:{h="sortSize";break}case m.OrderFolderType.NAME:case m.OrderFolderType.NAME_REVERSED:{h="sortTitle";break}default:case m.OrderFolderType.TIME:case m.OrderFolderType.TIME_REVERSED:{h="updatedAt";break}}const p=["updatedAt","sortSize"].includes(h);return vU({items:f,key:h,reverse:d,isNumber:p}).map(y=>Jn(y,["sortTitle","sortSize"]))},i=o(n.filter(c=>c.type===m.BlockType.FILE||c.data.ossName));return{folder:o(n.filter(c=>c.type!==m.BlockType.FILE)),files:i}},[(a=t==null?void 0:t.data)==null?void 0:a.format,n])},PA=e=>{const{uuid:t="",pageId:n=""}=e,s=_e(n,[]),{files:a}=wF(n);return F.useMemo(()=>{let i=zS(t,[m.BlockType.FILE,m.BlockType.EXTERNAL_FILE,m.BlockType.REFERENCE],l=>{var u,d,f,h;if(l.type===m.BlockType.EXTERNAL_FILE&&l.data.display==="image"&&l.data.link)return!0;if(l.type===m.BlockType.FILE){if((l.data.display==="image"||l.data.display==="file")&&l.data.ossName&&ew(ac(l.data.ossName).extName))return!0;const p=Hr.image.test(ac(l.data.ossName).extName);if(l.data.display===void 0&&(p||Hr.image.test((u=l.data.extName)!=null?u:"")))return!0}const c=(f=(d=l==null?void 0:l.data)==null?void 0:d.ref)==null?void 0:f.uuid;if(l.type===m.BlockType.REFERENCE&&c){const p=K.blocks[c];if((p==null?void 0:p.type)===m.BlockType.FILE&&(p!=null&&p.data.ossName)&&Hr.image.test(ac(p.data.ossName).extName)||(p==null?void 0:p.type)===m.BlockType.PDF_ANNOTATION&&((h=p==null?void 0:p.data.pdfAnnotation)!=null&&h.ossName))return!0}return!1});return(s==null?void 0:s.type)===m.BlockType.FOLDER&&(i=a==null?void 0:a.filter(l=>i.includes(l.uuid)).map(l=>l.uuid)),i.length?i:[]},[a,s==null?void 0:s.type,t])},kF=e=>ae(t=>{let n=t.blocks[e];const s=new Set;for(;n&&!s.has(n.uuid);){if(s.add(n.uuid),n.status===m.BlockStatus.DELETED)return!0;n=t.blocks[n.parentId]}return!1}),uC=(e,t=K.blocks)=>{let n=t[e];for(;n;){if(n.status===m.BlockStatus.DELETED)return!0;n=t[n.parentId]}},Og=e=>{const t=me(),n=DG(),s=gt(),a=Kp(),o=Un();return F.useCallback(i=>{const l=le().blocks[e];l&&t.warning({title:r.jsxs(r.Fragment,{children:["确定彻底删除该",jS(l.type),"？"]}),confirm:async()=>{await n(l.uuid),ye.success("已彻底删除"),i?i():s===l.uuid&&([m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.FOLDER].includes(l.type)?a():o.push(Rt.main))}})},[n,t,e,s,o,a])},dC=F.memo(({uuid:e,onDelete:t})=>{const n=_e(e,["moved"]),s=Un(),a=o6(),o=CJ(),i=Og(e),l=Kp(),c=gg(e),{role:u}=it(e);if(!n)return null;const d=()=>{i(()=>{[m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.FOLDER,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(n.type)&&l(),ce.event("completely_delete",{page_source:"fromDeleteBar"}),t==null||t()})},f=()=>{var g,_;ce.event("recycle_recover",{page_source:"fromDeleteBar"});const{blocks:p}=le();if(n.type===m.BlockType.FILE){const x=p[n.parentId];(x==null?void 0:x.status)===m.BlockStatus.NORMAL&&(x.type===m.BlockType.FOLDER||x.type===m.BlockType.PAGE)?(s.push(`/${x.uuid}`),a(n.uuid)):o();return}if((n.type===m.BlockType.FOLDER||n.type===m.BlockType.COLLECTION_VIEW_PAGE||n.type===m.BlockType.COLLECTION_VIEW||n.type===m.BlockType.MIND_MAPPING||n.type===m.BlockType.MIND_MAPPING_PAGE)&&((g=p[n.parentId])==null?void 0:g.type)===m.BlockType.COLLECTION_VIEW_PAGE){o();return}if((n.type===m.BlockType.PAGE||n.type===m.BlockType.COLLECTION_VIEW_PAGE||n.type===m.BlockType.COLLECTION_VIEW||n.type===m.BlockType.MIND_MAPPING||n.type===m.BlockType.MIND_MAPPING_PAGE)&&((_=p[n.parentId])==null?void 0:_.type)===m.BlockType.FOLDER){o();return}a(n.uuid)};let h;if(n.moved){const{movedToSpaceId:p}=n.moved,{spaces:g}=le(),_=g[p];_&&(h=r.jsxs("span",{className:"text-t2",children:["已移动到 ",_.title," 空间"]}))}else{const p=jS(n.type);h=r.jsxs("span",{className:"text-t2",children:["当前",p,"已删除"]})}return r.jsxs("div",{className:"h-[60px] w-full bg-red flex-shrink-0 text-white flex items-center justify-center sticky cursor-default top-0 left-0 z-20",children:[r.jsx(H,{name:"MIcRecycle",size:"middle",className:"mr-2"}),h,c&&(u===m.PermissionRole.EDITOR||u===m.PermissionRole.WRITER)&&r.jsxs("span",{className:"absolute flex items-center right-2",children:[r.jsx(je,{...bn(Bn.deleteBarRestore),colorType:"white",size:"large",className:"mr-2",onClick:f,children:"恢复"}),!n.moved&&r.jsx(je,{...bn(Bn.deleteBarDelete),colorType:"white",onClick:d,children:"彻底删除"})]})]})}),CJ=()=>{const e=me();return F.useCallback(()=>{e.modal({content:({onCloseModal:t})=>r.jsxs("div",{className:"next-modal w-[400px] h-[288px] py-[30px] flex flex-col justify-center items-center",children:[r.jsx("p",{className:"text-[70px] leading-[80px]",children:"😔"}),r.jsx("p",{className:"mt-2.5 text-t1",children:"当前页面无法恢复至原路径"}),r.jsxs("p",{className:"text-t2 mt-[10px] text-center",children:["因原路径已被彻底删除或无法移入，可尝试将该页面 ",r.jsx("br",{}),"移动至指定页面"]}),r.jsx(je,{onClick:()=>t(),colorType:"active",className:"w-[340px] border-none text-t2 text-white mt-[34px] py-1.5 flex-shrink-0",children:"知道了"})]})})},[e])},TJ=e=>[m.BlockType.FOLDER,m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(e),Mg=()=>F.useCallback((e,t,n)=>{const{blocks:s}=le(),a=ji(e,s,n),o=[];if(s[e])for(const l of a){if(!t&&l===e)continue;const c=s[l];if(!c)break;TJ(c.type)&&o.unshift(c)}return o},[]),axe=()=>{const e=Mg();return F.useCallback((t,n)=>{const s=e(t),a=WM(s.map(({uuid:o})=>o).map(o=>[`${cs.SPACE}_${o}`,`${cs.PRIVATE}_${o}`,`${cs.FAVORITE}_${o}`,`${cs.SHARE}_${o}`]));n!=null&&n.includeItself&&a.push(`${cs.SPACE}_${t}`,`${cs.PRIVATE}_${t}`,`${cs.FAVORITE}_${t}`,`${cs.SHARE}_${t}`),ox(a,!0)},[e])},Ol=()=>{const e=(t,n)=>{const s=K.ui.selectedBlocks;ee(bs({init(){ka(),ee(nt.updateSelectBlocks(t))},redo(){ka(),ee(nt.updateSelectBlocks(t))},undo(){ka(),ee(nt.updateSelectBlocks(n||s))}}))};return{selectedBlockHistory:F.useCallback(e,[]),selectedBlock:K.ui.selectedBlocks}},fC=e=>{const{uuid:t,updatedAt:n,deletedAt:s,createdBy:a,createdAt:o,subNodes:i,parentId:l,spaceId:c,version:u,permissions:d,views:f,...h}=e;return h},vJ=(e,t)=>{e.type===m.BlockType.SYNC_CONTAINER&&(e.type=m.BlockType.SYNC_REFERENCE,e.data.ref={uuid:t},e.subNodes=[])},mC=()=>{const e=Jc(),t=fi();return F.useCallback(async n=>{var o;const s=(o=n.targetSpaceId)!=null?o:Ut();Sl(s);const a=await Ce.editor.copySubNodes.raw(n);if(a.code===412){const i=Lm(s),l=await t(s);e({title:"复制失败",maxCapacity:l.maxCapacity,isNovice:l.isNovice,planType:i.planType,spaceId:s})}return a},[t,e])},eh=()=>{const e=ke(),t=jJ(),n=mC(),s=async(a,o)=>{Sl();const{effects:i,afterCopy:l}=o||{},c=[],u=new Set(a);return!a.length||!t(a)||(e(()=>{c.push(...OA(a,o));const d=new Map,f=[];for(const{uuid:p,block:g}of c)d.set(p,g.uuid),g.type===m.BlockType.TABLE&&f.push(g);f.length&&f.forEach(p=>{var _;const g=(_=p.data.format)==null?void 0:_.tableBlockRanges;if(g){const x=g.map(y=>{const{start:b,end:E}=y;return{start:[d.get(b==null?void 0:b[0]),b==null?void 0:b[1]],end:[d.get(E==null?void 0:E[0]),E==null?void 0:E[1]]}});ee(mn({uuid:p.uuid,patch:{data:{format:{tableBlockRanges:x}}}}))}});const h=c.filter(p=>a.includes(p.uuid)).map(p=>p.block.uuid);i==null||i(kd(h))},{noThrottle:!0}),oa(async()=>{const d=c.filter(({block:f})=>f.type!==m.BlockType.COLLECTION_VIEW&&Xt(f.type)).map(({uuid:f,block:h})=>({uuid:f,targetId:h.uuid,isDescendant:!u.has(f)}));if(d.length){for(const h of d)ee(mn({uuid:h.targetId,patch:{version:-1}}));const f=await n({list:d});l==null||l(),f.code!==200&&(c.forEach(({block:h})=>ha(h.uuid)),ee(Er()),ye.error(f.msg))}})),c};return F.useCallback(s,[t,n,e])},OA=(e,t)=>{const{after:n,parent:s,prefixName:a=!0}=t||{},{blocks:o,collectionViews:i}=le(),l=[],c=n||e[e.length-1],u=o[c];return u&&e.reduce((d,f)=>{if(!o[f])return d;const p=IJ(s||u.parentId,f,d,a),g=p[0];return!g||NJ(f,d,g)===d||p.forEach((_,x)=>{var y,b,E;if(x===0&&(d=_.block.uuid),l.push(_),_.block.parentId===_.block.spaceId){const{permissions:w}=_.block;w.some(k=>k.type===m.PermissionType.SPACE)?_.block.permissions=[{type:m.PermissionType.SPACE,role:m.PermissionRole.EDITOR}]:_.block.permissions=[{type:m.PermissionType.USER,role:m.PermissionRole.EDITOR,userId:K.user.uuid}]}else _.block.permissions=[];if(_.block.type===m.BlockType.COLLECTION_VIEW||_.block.type===m.BlockType.REFERENCE_COLLECTION){ee(Ia({block:{..._.block,views:[]},local:!1}));const{views:w}=_.block;Array.isArray(w)&&w.forEach(k=>{const C=i[k];if(!C)return;const{pageSort:T,spaceId:v,parentId:I,uuid:j,shareId:D,...S}=C;Ka({...S,shareId:D?qe():void 0,pageSort:T.map(R=>{const A=p.find(L=>L.uuid===R);return A==null?void 0:A.block.uuid}).filter(Boolean)},{parentId:_.block.uuid,last:!0})})}else{const{blocks:w}=le(),k=w[_.uuid],C=w[(y=k==null?void 0:k.parentId)!=null?y:""];if((C==null?void 0:C.type)===m.BlockType.COLLECTION_VIEW){const T=[];Object.entries((b=C.data.schema)!=null?b:{}).forEach(([I,j])=>{j.type===m.CollectionSchemaType.RELATION&&j.collectionId===C.uuid&&T.push(I)});const v={..._.block.data.collectionProperties};T.forEach(I=>{const j=v[I];if(!j)return;const D=[];j.forEach(S=>{var R;S.type===m.TextType.LINK_PAGE&&S.uuid&&C.subNodes.includes(S.uuid)?D.push({...S,uuid:(R=p.find(A=>A.uuid===S.uuid))==null?void 0:R.block.uuid}):D.push(S)}),v[I]=D}),_.block.data.collectionProperties=v}ee(Ia({block:_.block,local:!1}))}if(_.block.isTemplate){const w=le().blocks[_.block.parentId];if(w!=null){const k=(E=w.templatePages)!=null?E:[],C=_.after?k.indexOf(_.after)+1:k.length,T=k.slice(0);T.splice(C,0,_.block.uuid),ee(mn({uuid:w.uuid,patch:{templatePages:T}}))}}else _.after!=="IS_INLINE_PAGE"&&ee(Wn({uuid:_.block.uuid,parentId:_.block.parentId,after:_.after}))}),d},c),l},NJ=(e,t,n)=>{var i,l,c;const{blocks:s,collectionViews:a}=K,o=s[e];if(!o)return t;if(!o.isTemplate&&(((i=s[o.parentId])==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW_PAGE||((l=s[o.parentId])==null?void 0:l.type)===m.BlockType.COLLECTION_VIEW)){const d=(c=document.querySelector(`[data-block-id="${e}"]`).dataset.viewId)!=null?c:"";if(d){const f=s[o.parentId];if(!f)return t;const h=a[d];if(!h)return t;const p=[...h.pageSort],g=h.pageSort.indexOf(t);if(g>-1)p.splice(g+1,0,n.block.uuid);else{const _=new Set(p);for(const x of f.subNodes)if(_.has(x)||p.push(x),x===t){p.push(n.block.uuid);break}}Kn(d,{pageSort:p})}}},IJ=(e,t,n,s)=>{const{blocks:a,user:o}=le(),i=[],l=(c,u,d)=>{var E;const f=a[u];if(!f)return;const h=a[f.parentId],p=qe(),g={...f.data};if(g.segments=fv(g.segments),g.caption=fv(g.caption),typeof(g==null?void 0:g.pageFixedWidth)!="boolean"&&Object.assign(g,{pageFixedWidth:!0}),(h==null?void 0:h.type)!==m.BlockType.REFERENCE_COLLECTION&&(h==null?void 0:h.type)!==m.BlockType.REFERENCE_COLLECTION_PAGE&&((h==null?void 0:h.type)!==m.BlockType.COLLECTION_VIEW||f.isTemplate)&&s&&(Xt(f.type)||f.type===m.BlockType.FILE)&&g.segments&&g.segments.length>0&&(g.segments=[{text:"副本",type:m.TextType.TEXT,enhancer:{}},...g.segments]),f.type===m.BlockType.COLLECTION_VIEW||f.type===m.BlockType.COLLECTION_VIEW_PAGE){const w=(E=g.schema)!=null?E:{},k={};Object.entries(w).forEach(([C,T])=>{T.type===m.CollectionSchemaType.RELATION?T.collectionId===f.uuid?k[C]={...T,collectionId:p}:k[C]={...T,pairProperty:qe()}:k[C]={...T}}),g.schema=k}const _={uuid:p,parentId:c,version:0,spaceId:f.spaceId,type:f.type,textColor:f.textColor,backgroundColor:f.backgroundColor,data:g,isTemplate:f.isTemplate,templatePages:void 0,status:1,subNodes:[],createdBy:f.createdBy,createdAt:f.createdAt,updatedBy:f.uuid===t?o.uuid:f.updatedBy,updatedAt:f.uuid===t?Date.now():f.updatedAt,permissions:f.permissions,discussions:void 0};if((f.type===m.BlockType.COLLECTION_VIEW||f.type===m.BlockType.REFERENCE_COLLECTION)&&(_.views=f.views),(f.type===m.BlockType.FOLDER||f.type===m.BlockType.PAGE||f.type===m.BlockType.MIND_MAPPING)&&(_.subNodes=f.subNodes),_.type===m.BlockType.SYNC_CONTAINER&&vJ(_,f.uuid),i.push({block:_,uuid:u,after:d}),wt.$expandFoldRecord[t]!==void 0&&Po([p],!!wt.$expandFoldRecord[t]),f.type!==m.BlockType.COLLECTION_VIEW&&Xt(f.type)||f.type===m.BlockType.SYNC_CONTAINER)return p;if(f.templatePages!=null)for(const w of f.templatePages)l(p,w);const x=DJ(u,g),{subNodes:y}=f;let b;for(const w of y){s=!1,b=l(p,w,b);for(const k of x)if(k.uuid===w&&(k.type==="segments"||k.type==="caption")){const C=_.data[k.type];_.data[k.type]=C==null?void 0:C.map(T=>T.uuid===k.uuid?{...T,uuid:b}:T),x.delete(k)}}return SJ(x,_,i),p};return l(e,t,n),i},jJ=()=>{const e=Jc();return F.useCallback(t=>{const{blocks:n}=le(),s=t.reduce((a,o)=>{var l;const i=n[o];return i&&i.type===m.BlockType.FILE&&i.data.ossName?a+((l=i.data.size)!=null?l:0):a},0);if(s>0){const a=Mm(Ut());if(a.currentCapacity+s>a.maxCapacity)return e({title:"复制块失败",maxCapacity:a.maxCapacity,isNovice:a.isNovice}),!1}return!0},[e])},DJ=(e,t)=>{var o;const n=new Set,s=new Set,a=(i,l,c)=>{l&&l.forEach((u,d)=>{if(u.type===m.TextType.LINK_PAGE&&u.uuid){const f=K.blocks[u.uuid];if((f==null?void 0:f.parentId)===e){const h={type:i,index:d,uuid:u.uuid,propertyId:c};s.has(h.uuid)||(s.add(h.uuid),n.add(h))}}})};return a("segments",t.segments),a("caption",t.caption),Object.keys((o=t.collectionProperties)!=null?o:{}).forEach(i=>{var l;return a("collectionProperties",(l=t.collectionProperties)==null?void 0:l[i],i)}),n},SJ=(e,t,n)=>{var s;if(e.size>0)for(const a of e){const o=K.blocks[a.uuid];if(o){const i={...o,uuid:qe(),parentId:t.uuid,version:0};if(a.type==="segments"||a.type==="caption"){const l=t.data[a.type];t.data[a.type]=l==null?void 0:l.map(c=>c.uuid===a.uuid?{...c,uuid:i.uuid}:c)}if(a.type==="collectionProperties"&&a.propertyId){const l=t.data[a.type];if(l){const c=l[a.propertyId];l[a.propertyId]=(s=c==null?void 0:c.map(u=>u.uuid===a.uuid?{...u,uuid:i.uuid}:u))!=null?s:[]}}n.push({block:i,uuid:a.uuid,after:"IS_INLINE_PAGE"})}}},RJ=()=>{const e=Jc();return F.useCallback(t=>{const{blocks:n}=le();let s=0;if(t.forEach(a=>{const o=n[a];o&&Ei(o.data.collectionProperties).forEach(i=>{i.forEach(l=>{var c;s=+((c=l==null?void 0:l.size)!=null?c:0)})})},0),s>0){const a=Mm(Ut(),{isDatabase:!0});if(a.currentCapacity+s>a.maxCapacity)return e({title:"复制块失败",maxCapacity:a.maxCapacity,isNovice:a.isNovice}),{status:!1,totalSize:s}}return{status:!0,totalSize:s}},[e])},MA=()=>{const e=RJ(),t=ke(),n=mC(),s=(a,o,i)=>{var d;Sl();const l=[];let c=i==null?void 0:i.after;i!=null&&i.after||(c=(d=pn(o))==null?void 0:d.blockId),e(Es(o)).status&&(t(()=>{var f;o.reduce((h,p)=>{const g=AJ(a,p,h);return l.push({uuid:p.blockId,targetId:g,syncId:p.syncId}),g},c),(f=i==null?void 0:i.effects)==null||f.call(i,l.map(h=>({blockId:h.targetId,syncId:h.syncId,viewId:a})))},{noThrottle:!0}),oa(()=>n({list:l})))};return F.useCallback(s,[e,n,t])},AJ=(e,t,n)=>{var p;const{blocks:s,collectionViews:a,user:o}=le(),i=s[t.blockId],l=s[(p=i==null?void 0:i.parentId)!=null?p:""],c=a[e];if(!i||!l||!c)return"";const u={...i.data};typeof u.pageFixedWidth!="boolean"&&(u.pageFixedWidth=!0);const d=qe(),f={...i,uuid:d,data:u,version:0,status:1,subNodes:[],permissions:[],createdBy:i.createdBy,createdAt:i.createdAt,updatedBy:o.uuid,updatedAt:Date.now()},h=[...c.pageSort];if(n==="head")h.unshift(f.uuid);else if(n==="tail"){const g=new Set(h);for(const _ of l.subNodes)g.has(_)||h.push(_);h.push(f.uuid)}else{const g=c.pageSort.indexOf(n!=null?n:"");if(g>-1)h.splice(g+1,0,f.uuid);else{const _=new Set(h);for(const x of l.subNodes)if(_.has(x)||h.push(x),x===n){h.push(f.uuid);break}}}return ee(Ia({block:f,local:!1})),ee(Wn({uuid:f.uuid,parentId:i.parentId,after:n})),Kn(e,{pageSort:h}),d},CF=()=>{const e=ui(),t=me(),n=Ro(),s=_g();return F.useCallback((a,o=`已达到导图节点上限${s.mindMapMaxLimit},升级空间立即解锁无限节点`,i=s.mindMapMaxLimit)=>{if(Ok(K,a,a)>=i&&!e)return t.warning({title:"",content:o,confirmText:"升级空间",cancelText:"我再想想",colorType:"active",confirm:()=>{n(Vt.mind_node_limit)}}),!0},[e,s.mindMapMaxLimit,t,n])},Ug=()=>{const e=MA(),t=eh(),{selectedBlockHistory:n}=Ol(),s=CF(),a=async(o,i,l,c)=>{var h,p,g;Sl();let u,d=[];const f=(h=o[0])==null?void 0:h.blockId;if(f){const _=ls(f);if(_&&xo((p=K.blocks[_])==null?void 0:p.type)&&s(_))return}if(o.every(_=>{const{blocks:x}=K,y=x[_.blockId];if(y){const b=x[y.parentId];if(Wr(b==null?void 0:b.type))return u&&u.uuid!==(b==null?void 0:b.uuid)?!1:(u=b,!0)}return!1})){if(u){const _=(g=o[0])==null?void 0:g.viewId;_&&e(_,o,{effects:x=>{var y;n(x),(y=c==null?void 0:c.effects)==null||y.call(c,x),d=x}})}}else await t(Es(o),{effects:_=>{var x;_.forEach(y=>y.syncId=l),n(_),(x=c==null?void 0:c.effects)==null||x.call(c,_),d=_},after:i});return d};return F.useCallback(a,[t,e,s,n])},BJ=()=>{const e=La(),t=ke(),n=Gd(),{setting:s={}}=Qt(),a=Un();return F.useCallback(async o=>{const{viewId:i,where:l,propertyValues:c,templateId:u,isOpenInRight:d,from:f}=o;u&&await e(u);const h=[],p=t(()=>{const g=LJ(i,l,c);g!=null&&u!=null&&UA(g,u,h);const _=wt.$collectionSearch;return Ye({$collectionSearch:{..._,[i]:void 0}}),g&&(d?s.useRightPageByNew?n(g):a.push(`/${g}`):Ye({$newCreatedRecord:{id:g,from:f,viewId:i}})),g},{noThrottle:!0});return oa(async()=>{await Promise.all(h.map(g=>g()))}),p},[t,e,s.useRightPageByNew,n,a])},LJ=(e,t,n)=>{var f,h,p,g;const s=Zt(e);if(!s)return;const{view:a,collection:o}=s,i={type:m.BlockType.PAGE};if(i.data={},n!==void 0){const{title:_,...x}=n;i.data.collectionProperties=KM(x,hc),i.data.segments=_}let l=!1;if(a.type===m.CollectionViewType.CALENDAR?l=((f=a.format.calendarColorSetting)==null?void 0:f.type)===m.CardColorSource.CUSTOM:a.type===m.CollectionViewType.TIMELINE&&(l=((h=a.format.timelineColorSetting)==null?void 0:h.type)===m.CardColorSource.CUSTOM),l){const _=wr.map(y=>y.key),x=(p=od(_))!=null?p:wr[0].key;i.data.collectionCardColor=x}const c=Qe(i,{parentId:o.uuid,last:!0}),{newPageSort:u,needUpdate:d}=Vg(a.pageSort,o.subNodes);return d&&Kn(e,{pageSort:u}),t!=null&&t.first||t!=null&&t.before?ee(md({uuid:c,viewId:e,before:t.before})):ee(Fl({uuid:c,viewId:e,after:t==null?void 0:t.after})),(g=o.views)==null||g.forEach(_=>{_!==e&&ee(Fl({uuid:c,viewId:_}))}),c},Vg=(e,t)=>{const n=new Set(e),s=new Set(t);let a=!1;for(const o of t)n.has(o)||(a=!0,n.add(o));for(const o of e)s.has(o)||(a=!0,n.delete(o));return{needUpdate:a,newPageSort:[...n]}},UA=(e,t,n=[])=>{var l,c,u,d,f,h;const s=le().blocks[e];if(s==null){console.warn(`找不到记录${e}`);return}const a=le().blocks[t];if(a==null){console.warn(`找不到模板记录${t}`);return}const o={},i={...s.data.collectionProperties};for(const[p,g]of Object.entries((l=a.data.collectionProperties)!=null?l:{}))p!=="title"&&(i[p]===void 0||((c=i[p])==null?void 0:c.length)===0)&&(i[p]=g);if(o.data={collectionProperties:i},o.data.pageFixedWidth=a.data.pageFixedWidth,o.data.directoryMenu=a.data.directoryMenu,s.data.cover==null&&(o.data.cover=a.data.cover),s.data.coverPos==null&&(o.data.coverPos=a.data.coverPos),s.data.icon==null&&(o.data.icon=a.data.icon),s.data.iconUrl==null&&(o.data.iconUrl=a.data.iconUrl),(u=a.data.format)!=null&&u.pageLayout&&(o.data.format||(o.data.format={}),o.data.format.pageLayout=(d=a.data.format)==null?void 0:d.pageLayout),(f=a.data.format)!=null&&f.fontFormat&&(o.data.format||(o.data.format={}),o.data.format.fontFormat=(h=a.data.format)==null?void 0:h.fontFormat),pe(e,o),s.subNodes.length===0&&a.subNodes.length===0&&Qe({type:m.BlockType.TEXTAREA},{parentId:e,last:!0}),a.subNodes.length>0){const p=new Set(a.subNodes),g=[...OA(a.subNodes,{parent:e,prefixName:!1})],_=g.filter(({block:x})=>x.type!==m.BlockType.COLLECTION_VIEW&&x.type!==m.BlockType.REFERENCE_COLLECTION&&Xt(x.type)).map(({uuid:x,block:y})=>({uuid:x,targetId:y.uuid,isDescendant:!p.has(x)}));_.length>0&&n.push(async()=>{const x=await Ce.editor.copySubNodes.raw({list:_});x.code!==200&&(g.forEach(({block:y})=>ha(y.uuid)),ee(Er()),ye.error(x.msg))})}},PJ="一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),m0="日_一_二_三_四_五_六".split("_"),Qu="NewRecordPlaceholderId",yp=60*1e3,Dc=15*yp,h0=4*Dc,En=24*h0,cc=46,hC=34,Kv=300;var Cd=(e=>(e.PREV="prev",e.NEXT="next",e))(Cd||{}),ot=(e=>(e.HOUR="hour",e.DAY="day",e.WEEK="week",e.BIWEEK="biweek",e.MONTH="month",e.QUARTER="quarter",e.YEAR="year",e))(ot||{});const OJ={hour:4,day:12,month:5,week:1,biweek:5,quarter:14,year:28},VA={hour:60,day:60,month:100,biweek:50,week:25,quarter:25,year:25},Hs={hour:80,day:20,week:180,biweek:80,month:40,quarter:10,year:5},Yv=[{name:"小时",level:"hour"},{name:"天",level:"day"},{name:"周",level:"week"},{name:"双周",level:"biweek"},{name:"月",level:"month"},{name:"季",level:"quarter"},{name:"年",level:"year"}];var bp=(e=>(e.left="left",e.right="right",e))(bp||{});const qA=["left","right"],Xv=(e,t)=>{if(t)switch(t){case m.GroupLevel.RELATIVE:{const n=he(he(e).format(Ct)).valueOf(),s=he(he(Date.now()).format(Ct)).valueOf();return n===s?"today":n===s+En?"tomorrow":n===s-En?"yesterday":n>s+En&&n<=s+7*En?"next_7_day":n>s+7*En&&n<=s+30*En?"next_30_day":n<s-En&&n>=s-7*En?"last_7_day":n<s-7*En&&n>=s-30*En?"last_30_day":n>s+30*En?"after_next_30_day":n<s-30*En?"before_last_30_day":""}case m.GroupLevel.DAY:return he(e).format(Ct);case m.GroupLevel.WEEK:{const n=e-En*((he(e).day()||7)-1);return`${he(n).format(Ct)}`}case m.GroupLevel.MONTH:return`${he(e).date(1).format(Ct)}`;case m.GroupLevel.YEAR:return`${he(e).month(0).date(1).format(Ct)}`}},Rh=e=>{const t=he(he(Date.now()).format(Ct)).valueOf();return e==="today"?t:e==="tomorrow"?t+En:e==="yesterday"?t-En:e==="next_7_day"?t+2*En:e==="next_30_day"?t+8*En:e==="after_next_30_day"?t+31*En:e==="last_7_day"?t-2*En:e==="last_30_day"?t-8*En:e==="before_last_30_day"?t-31*En:he(e).valueOf()},Qv=(e,t,n,s)=>{let a="";if(e>=t&&e<n){const o=new $a(t).plus(new $a(Math.floor((e-t)/s)).multipliedBy(new $a(s)));a=`${o},${$a.sum(o,s).toNumber()}`}else a="out_of_range";return a},pC=ia({}),du=(e,t,n=le().blocks)=>{var f,h,p;const s=n[e],a=s==null?void 0:s.parentId,o=n[a!=null?a:""],i=(f=o==null?void 0:o.data.schema)==null?void 0:f[t],{collectionId:l}=i!=null?i:{},c=n[l!=null?l:""],u=(p=(h=s==null?void 0:s.data.collectionProperties)==null?void 0:h[t])!=null?p:[],d=[];return u.forEach(g=>{g.type===m.TextType.LINK_PAGE&&g.uuid&&(c!=null&&c.subNodes.includes(g.uuid))&&d.push(g.uuid)}),{relationRecords:d,relationCollection:c}},MJ=e=>{if(!e)return;const t=he(Ec(e));if(!isNaN(t.toDate().getTime())){if(e.type===m.TextType.DATE)return{dateString:t.format(Ct),timestamp:t.valueOf(),textType:m.TextType.DATE};if(e.type===m.TextType.DATETIME)return{dateString:t.format(us),timestamp:t.valueOf(),textType:m.TextType.DATETIME}}},TF=(e,t="ungroup",n=!1)=>{var o;const{groupBy:s,subGroupBy:a}=(o=Zt(e))!=null?o:{};return`viewId:${e};groupProperty:${n?a==null?void 0:a.property:s==null?void 0:s.property};groupName:${t}`},Gr=(e,t)=>{var s,a;if(!e)return;const n=(a=(s=e.data.collectionProperties)==null?void 0:s[t])==null?void 0:a.find(o=>o.type===m.TextType.DATE||o.type===m.TextType.DATETIME);if(n)return MJ(n)},pi=e=>{var n;const t=e==null?void 0:e.find(s=>s.type===m.TextType.URL);return(n=t==null?void 0:t.url)!=null?n:de(e)},HA=({blocks:e,propertyId:t,schema:n,formulaTool:s,users:a=le().users})=>{const o=e.map(l=>{var c,u,d,f,h,p,g,_,x,y,b;if(l)switch(n.type){case m.CollectionSchemaType.CREATED_AT:return he(l.createdAt).format(us);case m.CollectionSchemaType.UPDATED_AT:return he(l.updatedAt).format(us);case m.CollectionSchemaType.CREATED_BY:return l.createdBy;case m.CollectionSchemaType.UPDATED_BY:return l.updatedBy;case m.CollectionSchemaType.PERSON:return((u=(c=l.data.collectionProperties)==null?void 0:c[t])!=null?u:[]).filter(k=>{var C;return k.type===m.TextType.USER&&a[(C=k.uuid)!=null?C:""]}).map(k=>k.uuid).filter(k=>!!k);case m.CollectionSchemaType.DATE:{const E=Gr(l,t);return E&&E.dateString}case m.CollectionSchemaType.TITLE:return de(l.data.segments);case m.CollectionSchemaType.NUMBER:{const E=de((d=l.data.collectionProperties)==null?void 0:d[t]);let w=parseFloat(E);return Number.isNaN(w)&&(w=parseFloat((h=(f=E.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:f[0])!=null?h:"")),Number.isNaN(w)?void 0:String(w)}case m.CollectionSchemaType.FILE:return((g=(p=l.data.collectionProperties)==null?void 0:p[t])!=null?g:[]).filter(k=>k.type===m.TextType.URL&&k.fileStorageType==="internal").map(k=>k.url).filter(k=>!!k);case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:{const E=(_=l.data.collectionProperties)==null?void 0:_[t];return pi(E)}case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{const w=de((x=l.data.collectionProperties)==null?void 0:x[t]).trim().split(/\s*,\s*/g).map(k=>{var C,T;return(T=(C=n.options)==null?void 0:C.find(v=>v.value===k))==null?void 0:T.id}).filter(k=>!!k);return n.type===m.CollectionSchemaType.SELECT?w[0]:w}case m.CollectionSchemaType.FORMULA:{const E=s.getType(t),w=s.getValue(l.uuid,t);return E===He.ValueTool.booleanType?w?"YES":"NO":w==null?void 0:E===He.ValueTool.dateType?he(w).format(us):E===He.ValueTool.numberType?mk(w):`${w}`}case m.CollectionSchemaType.RELATION:return du(l.uuid,t).relationRecords;case m.CollectionSchemaType.CHECKBOX:return de((y=l.data.collectionProperties)==null?void 0:y[t]).trim().toUpperCase()==="YES"?"YES":"NO";default:return de((b=l.data.collectionProperties)==null?void 0:b[t]).trim()}}),i=o.filter(l=>typeof l=="string"&&l!==""||Array.isArray(l)&&l.length>0);return{allCellValues:o,notEmptyCellValues:i}};let $A;const UJ=e=>{$A=e},VJ=(...e)=>$A(...e),Vo=void 0,GA=(e,t,n,s,a)=>{var x;const{propertySchema:o,targetPropertySchema:i}=nu(s,t);if(!o)return;const{type:l,aggregation:c}=o,u=i==null?void 0:i.type;let d,f,h,p=[],g=[];const _=l===m.CollectionSchemaType.ROLLUP;if(!ai(n)&&!_){const y=HA({blocks:e,propertyId:t,schema:o,formulaTool:a});p=y.allCellValues,g=y.notEmptyCellValues}switch(_&&(p=e.map(y=>{var k;if(!y)return;const{originValues:b,aggregationValue:E,relationRecords:w=[]}=(k=VJ(y.uuid,t))!=null?k:{};return so(c)?u===m.CollectionSchemaType.TITLE?w:b:zd(c)?E?String(bg(E)):void 0:E}),g=p.filter(y=>typeof y=="string"&&y!==""||Array.isArray(y)&&y.length>0)),n){case m.AggregationAction.NONE:break;case m.AggregationAction.COUNT_ALL:case m.AggregationAction.COUNT_UNIQUE_VALUE:case m.AggregationAction.COUNT_VALUE:case m.AggregationAction.COUNT_EMPTY:case m.AggregationAction.COUNT_NOT_EMPTY:case m.AggregationAction.PERCENT_EMPTY:case m.AggregationAction.PERCENT_NOT_EMPTY:{switch(n){case m.AggregationAction.COUNT_ALL:d=e.length;break;case m.AggregationAction.COUNT_VALUE:{_?d=g.flat(1/0).filter(y=>!!y).length:d=g.flat(1/0).length;break}case m.AggregationAction.COUNT_UNIQUE_VALUE:d=new Set(g.flat(1/0)).size;break;case m.AggregationAction.COUNT_EMPTY:{d=e.length-g.length;break}case m.AggregationAction.COUNT_NOT_EMPTY:d=g.length;break;case m.AggregationAction.PERCENT_EMPTY:d=e.length===0?Vo:fa(p_(e.length-g.length,e.length));break;case m.AggregationAction.PERCENT_NOT_EMPTY:d=e.length===0?Vo:fa(p_(g.length,e.length));break}break}case m.AggregationAction.SUM:case m.AggregationAction.AVERAGE:case m.AggregationAction.MEDIAN:case m.AggregationAction.MIN:case m.AggregationAction.MAX:case m.AggregationAction.RANGE:{const y=g.map(Number).filter(b=>!isNaN(b));if(y.length===0){d=Vo;break}switch(n){case m.AggregationAction.SUM:if(y.includes(1/0)&&y.includes(-1/0)){d=Vo;break}d=$a.sum(...y).toNumber();break;case m.AggregationAction.AVERAGE:if(y.includes(1/0)&&y.includes(-1/0)){d=Vo;break}d=$a.sum(...y).dividedBy(y.length).toNumber();break;case m.AggregationAction.MIN:d=$a.minimum(...y).toNumber();break;case m.AggregationAction.MAX:d=$a.maximum(...y).toNumber();break;case m.AggregationAction.RANGE:{d=new $a(Math.max(...y)).minus(Math.min(...y)).toNumber();break}case m.AggregationAction.MEDIAN:{const b=y.sort((E,w)=>E-w);if(b.length%2===0){const E=b[b.length/2],w=b[b.length/2-1];if(!E||!w){d=Vo;break}d=$a.sum(E,w).dividedBy(2).toNumber()}else d=(x=b[(b.length-1)/2])!=null?x:0;break}}break}case m.AggregationAction.CHECKED:case m.AggregationAction.UNCHECKED:case m.AggregationAction.PERCENT_CHECKED:case m.AggregationAction.PERCENT_UNCHECKED:{const y=g.filter(b=>typeof b=="string"&&b.toUpperCase()==="YES").length;switch(n){case m.AggregationAction.CHECKED:d=y;break;case m.AggregationAction.UNCHECKED:d=e.length-y;break;case m.AggregationAction.PERCENT_CHECKED:d=e.length===0?Vo:fa(p_(y,e.length));break;case m.AggregationAction.PERCENT_UNCHECKED:d=e.length===0?Vo:fa(p_(e.length-y,e.length));break}break}case m.AggregationAction.EARLIEST_DATE:case m.AggregationAction.LATEST_DATE:case m.AggregationAction.DATE_RANGE:{let y=[];if(l===m.CollectionSchemaType.CREATED_AT||l===m.CollectionSchemaType.UPDATED_AT||l===m.CollectionSchemaType.FORMULA){if(l===m.CollectionSchemaType.CREATED_AT)y=e.map(w=>{var k;return(k=w==null?void 0:w.createdAt)!=null?k:0}).sort();else if(l===m.CollectionSchemaType.UPDATED_AT)y=e.map(w=>{var k;return(k=w==null?void 0:w.updatedAt)!=null?k:0}).sort();else if(l===m.CollectionSchemaType.FORMULA){const w=Ln(s);y=e.filter(k=>k!=null).map(k=>{const C=w.getBoxedValue(k.uuid,t);return C==null?0:He.ValueTool.typeOf(C)===He.ValueTool.dateType?He.ValueTool.asDate(C).getTime():0}).sort()}const b=y[0],E=pn(y);if(!b||!E){d=Vo;break}switch(n){case m.AggregationAction.EARLIEST_DATE:{d=he(b).format(us),f=d;break}case m.AggregationAction.LATEST_DATE:{d=he(E).format(us),f=d;break}case m.AggregationAction.DATE_RANGE:{b&&E&&(f=he(b).format(us),h=he(E).format(us),d=he(b).format(us).concat(" - ").concat(he(E).format(us)));break}}break}if(l===m.CollectionSchemaType.DATE||l){let b=e.map(k=>Gr(k,t)).filter(k=>k!==void 0);b=Xb(b,k=>k.timestamp);const E=b[0],w=pn(b);if(!E||!w){d=Vo;break}switch(n){case m.AggregationAction.EARLIEST_DATE:{d=E.dateString,f=d;break}case m.AggregationAction.LATEST_DATE:{d=w.dateString,f=d;break}case m.AggregationAction.DATE_RANGE:{f=E.dateString,h=w.dateString,d=E.dateString.concat(" - ",w.dateString);break}}}if(_){let b=[];c===m.AggregationAction.DATE_RANGE?g.forEach(k=>{typeof k=="string"&&k.split("-").forEach(C=>b.push(C.trim()))}):b=g,b=b.sort();const E=b[0],w=pn(b);if(!E||!w){d=Vo;break}switch(n){case m.AggregationAction.EARLIEST_DATE:{f=E,d=E;break}case m.AggregationAction.LATEST_DATE:{f=w,d=w;break}case m.AggregationAction.DATE_RANGE:{f=E,h=w,d=E.concat(" - ",w);break}}}break}}return{result:d,dateStartTimestamp:f,dateEndTimestamp:h}},p0=(e,t)=>{var d,f,h;const{propertySchema:n,relationPropertySchema:s,targetPropertySchema:a}=nu(e,t);if(!n)return[];const{type:o,targetProperty:i,aggregation:l}=n,c=Ln(e);let u=[];if(o===m.CollectionSchemaType.ROLLUP){let p=a==null?void 0:a.type;if(p===m.CollectionSchemaType.FORMULA&&(p=Ln((d=s==null?void 0:s.collectionId)!=null?d:"").getTypeAsCollectionSchemaType(i!=null?i:"")),!p)return[];u=XW(p,l)}else if(o===m.CollectionSchemaType.FORMULA){const p=c.getTypeAsCollectionSchemaType(t);u=(f=uv[p])!=null?f:[]}else u=(h=uv[o])!=null?h:[];return[...u]},qJ=(e,t,n)=>{const s=p0(e,t);return s.shift(),n!==m.CollectionSchemaType.CHECKBOX&&s.unshift({type:m.AggregationAction.SHOW_UNIQUE,title:"显示 唯一值"}),s.unshift({type:m.AggregationAction.SHOW_ORIGIN,title:"显示 原始值"}),s},Jr=(e,t,n=le())=>{var T,v,I;const{blocks:s}=n,a=s[e],o=s[(T=a==null?void 0:a.parentId)!=null?T:""],i=(v=o==null?void 0:o.data.schema)==null?void 0:v[t],{relationProperty:l,targetProperty:c,aggregation:u}=i!=null?i:{};if(!l||!c)return;const{relationRecords:d,relationCollection:f}=du(e,l,n.blocks);if(!f)return;const h=(I=f.data.schema)==null?void 0:I[c];if(!h)return;const p=h.type,g=Ln(f.uuid),{allCellValues:_,notEmptyCellValues:x}=HA({blocks:d.map(j=>s[j]),propertyId:c,schema:h,formulaTool:g}),y=x.flat(),b=[...new Set(y)],E=u===m.AggregationAction.SHOW_UNIQUE,w=E?b:y,k=c&&p===m.CollectionSchemaType.FORMULA,C={allCellValues:_,originValues:w,targetProperty:c,targetPropertySchema:h,relationCollection:f,relationRecords:d,isUniqueValue:E,formulaType:k?g.getType(c):void 0,isEmpty:w.length===0,originValueToStringFunc:j=>j};if(p===m.CollectionSchemaType.SELECT||p===m.CollectionSchemaType.MULTI_SELECT?C.originValueToStringFunc=j=>{var D,S,R;return(R=(S=((D=h.options)!=null?D:[]).find(A=>A.id===j))==null?void 0:S.value)!=null?R:""}:p===m.CollectionSchemaType.PERSON||p===m.CollectionSchemaType.CREATED_BY||p===m.CollectionSchemaType.UPDATED_BY?C.originValueToStringFunc=j=>{var D,S;return ss((S=(D=n.users[j])==null?void 0:D.uuid)!=null?S:"")}:p===m.CollectionSchemaType.RELATION&&(C.originValueToStringFunc=j=>{var D;return de((D=n.blocks[j])==null?void 0:D.data.segments)}),u&&u!==m.AggregationAction.SHOW_ORIGIN&&u!==m.AggregationAction.SHOW_UNIQUE&&p0(f.uuid,c).find(S=>S.type===u&&S.type!==m.AggregationAction.NONE)){const S=GA(d.map(R=>s[R]),c,u,f.uuid,g);S?(C.dateStartTimestamp=S.dateStartTimestamp,C.dateEndTimestamp=S.dateEndTimestamp,C.aggregationValue=typeof S.result<"u"?String(S.result):void 0,C.isEmpty=!C.aggregationValue):C.isEmpty=!0}return C};CK(Jr);UJ(Jr);const HJ=e=>{const t=(e!=null?e:[]).filter(n=>n.type===m.TextType.URL&&n.fileStorageType==="internal");return t.length>0?t.map(n=>n.text):null},$J=e=>e.data.segments,GJ=e=>e.createdAt,zJ=e=>e.updatedAt,wu=e=>t=>{var n;return(n=t.data.collectionProperties)==null?void 0:n[e]};function WJ(e,t){const n=[],{collectionId:s,schemas:a,ranking:o,formulaTool:i}=t,l=d=>f=>{const h=i.getValue(f.uuid,d),p=i.getType(d);return p===He.ValueTool.stringType&&h===""?null:p===He.ValueTool.booleanType&&h==null?!1:h},c={findSchema(d,f){var h,p;return(p=(h=le().blocks[d])==null?void 0:h.data.schema)==null?void 0:p[f]},findUser(d){return le().users[d]},findRecord(d,f){return le().blocks[f]}},u=({property:d,direction:f})=>{var x,y,b;const h=fK(s,d,c),{type:p,aggregation:g,targetProperty:_}=(x=a==null?void 0:a[d])!=null?x:{};switch(p!=null?p:m.CollectionSchemaType.TEXT){case m.CollectionSchemaType.FORMULA:{const E=i.getType(d),w=E===He.ValueTool.stringType?ol:E===He.ValueTool.booleanType?hr(k=>k?1:0,Iu):E===He.ValueTool.numberType?Iu:E===He.ValueTool.dateType?hr(k=>k.getTime(),Iu):Id;return hr(l(d),Fa($o(w,f==="desc")))}case m.CollectionSchemaType.ROLLUP:{if(so(g)){const{relationPropertySchema:w,targetPropertySchema:k}=nu(s,d),C=(y=k==null?void 0:k.type)!=null?y:m.CollectionSchemaType.TEXT;if(C===m.CollectionSchemaType.FORMULA){const I=Ln((b=w==null?void 0:w.collectionId)!=null?b:"").getType(_!=null?_:"");return I===He.ValueTool.numberType||I===He.ValueTool.booleanType?hr((D=>S=>{var L;const{originValues:R=[]}=(L=Jr(S.uuid,D))!=null?L:{};let A=[];return I===He.ValueTool.booleanType?A=R.map(P=>typeof P=="string"&&P.toUpperCase()==="YES"?1:0):A=R.map(P=>Number(P)),A.length>0?A:null})(d),Fa($o(__(Fa(Iu)),f==="desc"))):I===He.ValueTool.stringType||I===He.ValueTool.dateType?hr((D=>S=>{var A;const{originValues:R=[]}=(A=Jr(S.uuid,D))!=null?A:{};return R.length>0?R:null})(d),Fa($o(__(Fa(I1)),f==="desc"))):()=>0}else if(C===m.CollectionSchemaType.CHECKBOX||C===m.CollectionSchemaType.NUMBER||C===m.CollectionSchemaType.SELECT||C===m.CollectionSchemaType.MULTI_SELECT){const v=C===m.CollectionSchemaType.NUMBER,I=C===m.CollectionSchemaType.CHECKBOX;return hr((D=>S=>{var P,M;const{originValues:R=[],targetPropertySchema:A}=(P=Jr(S.uuid,D))!=null?P:{};let L=[];if(I)L=R.map(U=>typeof U=="string"&&U.toUpperCase()==="YES"?1:0);else if(v)L=R.map(U=>Number(U));else{const V=((M=A==null?void 0:A.options)!=null?M:[]).map(W=>W.id);L=R.map(W=>typeof W>"u"?-1:V.indexOf(W)).filter(W=>W!==-1)}return L.length>0?L:null})(d),Fa($o(__(Fa(Iu)),f==="desc")))}else{if(C===m.CollectionSchemaType.FILE)return hr((I=>j=>{var A;const{relationRecords:D}=(A=Jr(j.uuid,I))!=null?A:{},{blocks:S}=le(),R=[];return D==null||D.forEach(L=>{var U,V;const P=(V=(U=S[L])==null?void 0:U.data.collectionProperties)==null?void 0:V[_!=null?_:""],M=HJ(P);M&&R.push(...M)}),R.length>0?R:null})(d),Fa($o(yj(ol),f==="desc")));if(C===m.CollectionSchemaType.TITLE||C===m.CollectionSchemaType.RELATION)return hr((I=>j=>{var M;const{originValues:D=[],relationRecords:S=[]}=(M=Jr(j.uuid,I))!=null?M:{},R=C===m.CollectionSchemaType.TITLE,{blocks:A}=le(),P=(R?S:D).map(U=>{var V;return de((V=A[U])==null?void 0:V.data.segments)||aa}).join("").trim();return P||null})(d),Fa($o(ol,f==="desc")))}return hr((v=>I=>{var S;const{originValues:j=[]}=(S=Jr(I.uuid,v))!=null?S:{};let D=j;return(C===m.CollectionSchemaType.PERSON||C===m.CollectionSchemaType.CREATED_BY||C===m.CollectionSchemaType.UPDATED_BY)&&(D=j.map(R=>ss(R)).filter(R=>!!R)),D.length>0?D:null})(d),Fa($o(__(Fa(ol)),f==="desc")))}return ai(g)?hr((k=>C=>{var v;const{dateStartTimestamp:T}=(v=Jr(C.uuid,k))!=null?v:{};return T||null})(d),Fa($o(I1,f==="desc"))):hr((w=>k=>{var v;const{aggregationValue:C}=(v=Jr(k.uuid,w))!=null?v:{};let T;return zd(g)?T=C?bg(C):null:T=C?Number(C):null,T})(d),Fa($o(Iu,f==="desc")))}default:return(E,w)=>{const k=dv(s,E.uuid,d,h,c),C=dv(s,w.uuid,d,h,c);if(!(h instanceof H6)){if(h.isEmpty(k)&&h.isEmpty(C))return 0;if(h.isEmpty(k))return 1;if(h.isEmpty(C))return-1}return(f==="desc"?-1:1)*h.compare(k,C)}}};for(const d of e)n.push(u(d));return n.push(hr(d=>{var f;return(f=o.get(d.uuid))!=null?f:1/0})),n.push(hr(d=>d.uuid)),EU(...n)}const ku=e=>[e.startOf("day"),e.endOf("day")],nb=e=>{const t=e.startOf("day").valueOf()-((e.day()||7)-1)*Hn,n=t+7*Hn-1e3;return[he(t),he(n)]},sb=e=>[e.startOf("month"),e.endOf("month")],rb=e=>[e.startOf("year"),e.endOf("year")],li={today:{title:"今天",day:!0,fn:()=>ku(he())},yesterday:{title:"昨天",day:!0,fn:()=>ku(he().add(-1,"day"))},tomorrow:{title:"明天",day:!0,fn:()=>ku(he().add(1,"day"))},current_week:{title:"本周",day:!1,fn:()=>nb(he())},last_week:{title:"上周",day:!1,fn:()=>nb(he().add(-1,"week"))},next_week:{title:"下周",day:!1,fn:()=>nb(he().add(1,"week"))},current_month:{title:"本月",day:!1,fn:()=>sb(he())},last_month:{title:"上月",day:!1,fn:()=>sb(he().add(-1,"month"))},next_month:{title:"下月",day:!1,fn:()=>sb(he().add(1,"month"))},current_year:{title:"今年",day:!1,fn:()=>rb(he())},last_year:{title:"去年",day:!1,fn:()=>rb(he().add(-1,"year"))},next_year:{title:"明年",day:!1,fn:()=>rb(he().add(1,"year"))},a_week_ago:{title:"一周前",day:!0,fn:()=>ku(he().add(-1,"week"))},a_week_later:{title:"一周后",day:!0,fn:()=>ku(he().add(1,"week"))},a_month_ago:{title:"一个月前",day:!0,fn:()=>ku(he().add(-1,"month"))},a_month_later:{title:"一个月后",day:!0,fn:()=>ku(he().add(1,"month"))},last_7_days:{title:"过去7天",day:!1,fn:()=>[he().add(-6,"day").startOf("day"),he().endOf("day")]},next_7_days:{title:"未来7天",day:!1,fn:()=>[he().add(1,"day").startOf("day"),he().add(7,"day").endOf("day")]},last_30_days:{title:"过去30天",day:!1,fn:()=>[he().add(-29,"day").startOf("day"),he().endOf("day")]},next_30_days:{title:"未来30天",day:!1,fn:()=>[he().add(1,"day").startOf("day"),he().add(30,"day").endOf("day")]}},ff=e=>(t,n)=>Hu(li,n)?e(t,li[n].fn()[0].format(Ct)):e(t,n),K2={string:{in:(e,t)=>(e!=null?e:"").includes(t),nin:(e,t)=>!(e!=null?e:"").includes(t),eq:(e,t)=>(e!=null?e:"")===t,neq:(e,t)=>(e!=null?e:"")!==t,startsWith:(e,t)=>(e!=null?e:"").startsWith(t),endsWith:(e,t)=>(e!=null?e:"").endsWith(t)},tag:{eq:(e,t)=>e===t,neq:(e,t)=>e!==t},tags:{in:(e,t)=>(e!=null?e:[]).includes(t),nin:(e,t)=>!(e!=null?e:[]).includes(t)},number:{eq:(e,t)=>(e!=null?e:NaN)===t,neq:(e,t)=>(e!=null?e:NaN)!==t,gt:(e,t)=>(e!=null?e:NaN)>t,lt:(e,t)=>(e!=null?e:NaN)<t,gte:(e,t)=>(e!=null?e:NaN)>=t,lte:(e,t)=>(e!=null?e:NaN)<=t},date:{eq:ff((e,t)=>e===t),neq:ff((e,t)=>e!==t),in:(e,t)=>{if(e==null)return!1;if(Hu(li,t)){const n=li[t],[s,a]=n.fn();return he(e,Ct).isBetween(s,a,"day","[]")}if(t.includes(",")){const n=t.split(","),s=he(n[0],Ct),a=he(n[1],Ct);return he(e,Ct).isBetween(s,a,"day","[]")}return!1},lt:ff((e,t)=>e!=null&&e<t),gt:ff((e,t)=>e!=null&&e>t),lte:ff((e,t)=>e!=null&&e<=t),gte:ff((e,t)=>e!=null&&e>=t)},persons:{in:(e,t)=>(e!=null?e:[]).includes(t),nin:(e,t)=>!(e!=null?e:[]).includes(t)},relations:{in:(e,t)=>{if(t==="")return!0;const n=(t!=null?t:"").split(",").filter(Boolean);return(e!=null?e:[]).some(s=>n.includes(s))},nin:(e,t)=>{if(t==="")return!0;const n=(t!=null?t:"").split(",").filter(Boolean);return(e!=null?e:[]).every(s=>!n.includes(s))}},rollupUnique:{in:(e,t)=>(e!=null?e:[]).some(n=>n===t),nin:(e,t)=>(e!=null?e:[]).every(n=>n!==t)},other:{}},ab={eq:{_default:"是",[m.CollectionSchemaType.NUMBER]:"="},neq:{_default:"不是",[m.CollectionSchemaType.NUMBER]:"≠"},lt:{_default:"小于",[m.CollectionSchemaType.NUMBER]:"<",[m.CollectionSchemaType.DATE]:"早于"},lte:{_default:"小于等于",[m.CollectionSchemaType.NUMBER]:"≤",[m.CollectionSchemaType.DATE]:"不晚于"},gt:{_default:"大于",[m.CollectionSchemaType.NUMBER]:">",[m.CollectionSchemaType.DATE]:"晚于"},gte:{_default:"大于等于",[m.CollectionSchemaType.NUMBER]:"≥",[m.CollectionSchemaType.DATE]:"不早于"},in:{_default:"包含",[m.CollectionSchemaType.DATE]:"位于某段时间内"},nin:{_default:"不包含"},startsWith:{_default:"开始为"},endsWith:{_default:"结束为"},isEmpty:{_default:"未填写",[m.CollectionSchemaType.CHECKBOX]:"未勾选"},isNotEmpty:{_default:"已填写",[m.CollectionSchemaType.CHECKBOX]:"已勾选"}};function Y2(e,t,n){switch(e===m.CollectionSchemaType.FORMULA&&t&&n&&(e=Ln(t).getTypeAsCollectionSchemaType(n)),e){case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return"string";case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:return"date";case m.CollectionSchemaType.NUMBER:return"number";case m.CollectionSchemaType.SELECT:return"tag";case m.CollectionSchemaType.MULTI_SELECT:return"tags";case m.CollectionSchemaType.PERSON:case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:return"persons";case m.CollectionSchemaType.RELATION:return"relations";case m.CollectionSchemaType.ROLLUP:case m.CollectionSchemaType.CHECKBOX:case m.CollectionSchemaType.FILE:return"other";case m.CollectionSchemaType.FORMULA:throw new Error("Assertion failed")}}function mm(e,t){var f,h;const{propertySchema:n,relationPropertySchema:s,targetPropertySchema:a}=nu(e,t),{type:o,aggregation:i,targetProperty:l}=n!=null?n:{};let c=o!=null?o:m.CollectionSchemaType.TEXT;if((o===m.CollectionSchemaType.CREATED_AT||o===m.CollectionSchemaType.UPDATED_AT)&&(c=m.CollectionSchemaType.DATE),c===m.CollectionSchemaType.ROLLUP)if(so(i)){const p=(f=a==null?void 0:a.type)!=null?f:m.CollectionSchemaType.TEXT;if(p===m.CollectionSchemaType.FORMULA)return c=Ln((h=s==null?void 0:s.collectionId)!=null?h:"").getTypeAsCollectionSchemaType(l!=null?l:""),[];c=p}else ai(i)?c=m.CollectionSchemaType.DATE:c=m.CollectionSchemaType.NUMBER;else o===m.CollectionSchemaType.FORMULA&&(c=Ln(e).getTypeAsCollectionSchemaType(t));const u=Y2(c,e,t),d=K2[u];return[...Object.keys(d),"isNotEmpty","isEmpty"].map(p=>{var x,y,b,E;const g=p,_=(E=(b=(x=ab[g])==null?void 0:x[c])!=null?b:(y=ab[g])==null?void 0:y._default)!=null?E:"?";return{value:g,title:_,shortTitle:_===ab.in[m.CollectionSchemaType.DATE]?"位于":void 0}})}function zA(e,t){const{collectionId:n,schemas:s,userId:a}=t,o=c=>{var T,v,I;const{propertySchema:u,relationPropertySchema:d,targetPropertySchema:f}=nu(n,c.property),{type:h=m.CollectionSchemaType.TEXT,options:p=[],aggregation:g,targetProperty:_}=u!=null?u:{},x=(T=f==null?void 0:f.type)!=null?T:m.CollectionSchemaType.TEXT,y=j=>{switch(h){case m.CollectionSchemaType.TITLE:return D=>de($J(D));case m.CollectionSchemaType.CREATED_AT:return D=>{const S=GJ(D);return he(S).format(Ct)};case m.CollectionSchemaType.UPDATED_AT:return D=>{const S=zJ(D);return he(S).format(Ct)};case m.CollectionSchemaType.DATE:return D=>{const S=wu(j)(D),R=FK(S);return R&&he(R).format(Ct)};case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return D=>de(wu(j)(D));case m.CollectionSchemaType.CHECKBOX:return D=>de(wu(j)(D)).toUpperCase()==="YES"?"YES":null;case m.CollectionSchemaType.FILE:return D=>{const S=wu(j)(D);return(S!=null?S:[]).filter(R=>R.type===m.TextType.URL&&R.fileStorageType==="internal").length>0?"<not_null>":null};case m.CollectionSchemaType.NUMBER:return D=>B2(wu(j)(D));case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{const D=S=>{const R=wu(j)(S);return R==null?void 0:de(R).split(/\s*,\s*/g).map(P=>{var M;return(M=p.find(U=>U.value===P))==null?void 0:M.id}).filter(P=>!!P)};return h===m.CollectionSchemaType.MULTI_SELECT?D:S=>{var R;return(R=D(S))==null?void 0:R[0]}}case m.CollectionSchemaType.PERSON:return D=>{const S=yK(wu(j)(D));return S!==void 0?S:[]};case m.CollectionSchemaType.CREATED_BY:return D=>D.createdBy!==void 0?[D.createdBy]:[];case m.CollectionSchemaType.UPDATED_BY:return D=>D.updatedBy!==void 0?[D.updatedBy]:[];case m.CollectionSchemaType.RELATION:return D=>du(D.uuid,j).relationRecords;case m.CollectionSchemaType.ROLLUP:return D=>Jr(D.uuid,j);case m.CollectionSchemaType.FORMULA:return D=>{const S=Ln(n),R=S.getType(j),A=S.getValue(D.uuid,j);return R===He.ValueTool.dateType?A==null?null:he(A).format(Ct):R===He.ValueTool.booleanType?A?"YES":"":A};default:return()=>{}}},b=h===m.CollectionSchemaType.ROLLUP,E=y(c.property);if(c.operator==="isEmpty"||c.operator==="isNotEmpty"){const j=c.operator==="isEmpty";if(b){if(!so(g))return S=>{const R=Jr(S.uuid,c.property);return j?(R==null?void 0:R.isEmpty)===!0:(R==null?void 0:R.isEmpty)!==!0};let D;return x===m.CollectionSchemaType.FORMULA?(D=Ln((v=d==null?void 0:d.collectionId)!=null?v:"").getTypeAsCollectionSchemaType(_!=null?_:""),()=>!0):S=>{var L;let{allCellValues:R=[]}=(L=Jr(S.uuid,c.property))!=null?L:{};const A=g===m.AggregationAction.SHOW_UNIQUE;return R.length===0?!(A||c.mode==="every"||c.mode==="any"):x===m.CollectionSchemaType.CHECKBOX||D===m.CollectionSchemaType.CHECKBOX?A?R.some(j?j_:Ah):c.mode==="every"?R.every(j?j_:Ah):c.mode==="any"?R.some(j?j_:Ah):R.every(j?Ah:j_):((x===m.CollectionSchemaType.DATE||x===m.CollectionSchemaType.CREATED_AT||x===m.CollectionSchemaType.UPDATED_AT||D===m.CollectionSchemaType.DATE)&&(R=R.map(P=>typeof P=="string"?he(P).format(Ct):void 0)),A?R.some(j?Bh:D_):c.mode==="every"?R.every(j?Bh:D_):c.mode==="any"?R.some(j?Bh:D_):R.every(j?D_:Bh))}}return j?D=>{const S=E(D);return S==null||S===""||Array.isArray(S)&&S.length===0}:D=>{const S=E(D);return!(S==null||S===""||Array.isArray(S)&&S.length===0)}}let w=Y2(h,n,c.property);if(b){let j;const D=x===m.CollectionSchemaType.FORMULA;if(x===m.CollectionSchemaType.FORMULA)return j=Ln((I=d==null?void 0:d.collectionId)!=null?I:"").getTypeAsCollectionSchemaType(_!=null?_:""),()=>!0;if(so(g))return S=>{var W;const R=Jr(S.uuid,c.property);let A=(W=R==null?void 0:R.allCellValues)!=null?W:[];const L=g===m.AggregationAction.SHOW_UNIQUE;if(A.length===0)return!(L||c.mode==="every"||c.mode==="any");x===m.CollectionSchemaType.DATE||x===m.CollectionSchemaType.CREATED_AT||x===m.CollectionSchemaType.UPDATED_AT||j===m.CollectionSchemaType.DATE?A=A.map(z=>typeof z=="string"?he(z).format(Ct):void 0):x===m.CollectionSchemaType.NUMBER&&(A=A.map(z=>typeof z=="string"?Number(z):void 0));const P=D?j!=null?j:m.CollectionSchemaType.TEXT:x,M=Y2(P),U=K2[M][c.operator],V=(()=>{var Q,Z,te;let z=(Q=c.__effectiveValue)!=null?Q:c.value;if(M==="number")return Number(z);if(M==="persons"&&z==="me")return a;if(P===m.CollectionSchemaType.RELATION){const re=((Z=String(z))!=null?Z:"").split(","),{blocks:ne}=le(),Y=ne[(te=f==null?void 0:f.collectionId)!=null?te:""];z=re.filter(oe=>oe&&(Y==null?void 0:Y.subNodes.includes(oe))).join(",")}return z})();return L?A.some(z=>P===m.CollectionSchemaType.RELATION&&V===""||!U?!0:U(z,V)):c.mode==="every"?A.every(z=>P===m.CollectionSchemaType.RELATION&&V===""||!U?!0:U(z,V)):c.mode==="any"?A.some(z=>P===m.CollectionSchemaType.RELATION&&V===""||!U?!0:U(z,V)):A.every(z=>P===m.CollectionSchemaType.RELATION&&V===""||!U?!0:!U(z,V))};ai(g)?w="date":w="number"}const k=K2[w][c.operator],C=(()=>{var D;const j=(D=c.__effectiveValue)!=null?D:c.value;return w==="number"?Number(j):w==="persons"&&j==="me"?a:j})();return k==null?()=>!1:j=>{var S,R,A;if(b){const{dateStartTimestamp:L,aggregationValue:P}=(S=Jr(j.uuid,c.property))!=null?S:{};let M=P;return ai(g)?M=L&&he(L).format(Ct):zd(g)?M=typeof P=="string"?bg(P):void 0:M=Number(P),k(M,C)}const D=E(j);if((u==null?void 0:u.type)===m.CollectionSchemaType.RELATION){const L=((R=String(C))!=null?R:"").split(","),{blocks:P}=le(),M=P[(A=u.collectionId)!=null?A:""],U=L.filter(V=>V&&(M==null?void 0:M.subNodes.includes(V)));return k(D,U.join(","))}return k(D,C)}},i=c=>{const u=c.filters.filter(d=>ci(d,s)).filter(d=>d.disable||d.type==="filter"&&!(s!=null&&s[d.property])?!1:d.type==="filter"&&["isEmpty","isNotEmpty"].includes(d.operator)?!0:!(d.type==="filter"&&d.value==="")).map(d=>l(d));if(u.length===0)return()=>!0;switch(c.operator){case"and":return d=>u.every(f=>f(d));case"or":return d=>u.some(f=>f(d))}},l=(c,u=!1)=>{if(c==null||c.disable||!ci(c,s))return()=>u;switch(c.type){case"group":return i(c);case"filter":return o(c)}};return l(e,!0)}const ci=(e,t)=>{if(e==null)return!1;if(e.type==="filter"){const n=t==null?void 0:t[e.property];return!(n==null||e.propertyType!=null&&n.type!==e.propertyType)}return e.filters.length<=0?!1:!e.filters.every(n=>!ci(n,t))},qg=(e,t)=>!e||e.disable?!1:e.type==="filter"?ci(e,t):e.filters.length<=0?!1:e.filters.some(n=>qg(n,t)),g0=(e,t)=>{if(e.type==="group"){const n=e.filters.filter(s=>ci(s,t)).map(s=>g0(s,t));return{...e,filters:n}}return e},Ah=e=>typeof e=="string"&&e.toUpperCase()==="YES",j_=e=>!Ah(e),Bh=e=>typeof e=="string"&&e===""||Array.isArray(e)&&e.length===0||typeof e>"u",D_=e=>!Bh(e),gC={text:[{type:m.GroupSortType.MANUAL,name:"手动排序"},{type:m.GroupSortType.ASCENDING,name:"升序"},{type:m.GroupSortType.DESCENDING,name:"降序"}],date:[{type:m.GroupSortType.ASCENDING,name:"时间升序"},{type:m.GroupSortType.DESCENDING,name:"时间倒序"}],number:[{type:m.GroupSortType.ASCENDING,name:"升序"},{type:m.GroupSortType.DESCENDING,name:"降序"}]},_C={date:[{type:m.GroupLevel.RELATIVE,name:"相对日期"},{type:m.GroupLevel.DAY,name:"天"},{type:m.GroupLevel.WEEK,name:"周"},{type:m.GroupLevel.MONTH,name:"月"},{type:m.GroupLevel.YEAR,name:"年"}],text:[{type:m.GroupLevel.EXACT,name:"精确"},{type:m.GroupLevel.ALPHABET_PREFIX,name:"模糊前缀"}]},_0=e=>{const t=parseFloat(String(e==null?void 0:e.start))||0,n=parseFloat(String(e==null?void 0:e.end))||1e3,s=parseFloat(String(e==null?void 0:e.size))||100;return{start:t,end:n,size:s}},Hg=(e,t)=>((!t||!gC[e].find(n=>n.type===t))&&(t=m.GroupSortType.ASCENDING),t),zf=(e,t)=>((!t||!_C[e].find(n=>n.type===t))&&(t=e==="date"?m.GroupLevel.RELATIVE:m.GroupLevel.EXACT),t),$g=(e,t=le())=>{var o;const n=t.blocks[e];if(!n)return[];const s=(o=n.data.schema)!=null?o:{};return Object.keys(s).filter(i=>{const l=s[i],c=l==null?void 0:l.type;return c===m.CollectionSchemaType.FORMULA?rR(e,i,l==null?void 0:l.formula):c!==m.CollectionSchemaType.ROLLUP&&c!==m.CollectionSchemaType.FILE})},_a=()=>{const e=ke(),{getState:t}=Kr(),n=(s,a,o,i={needTransaction:!0})=>{const l=()=>{var g,_,x;const{blocks:c}=t(),u=c[s];if(!u)return;const d=(g=u.data.schema)!=null?g:{},f=d[a];if(!f)return;const h=[...(x=(_=o.options)!=null?_:f.options)!=null?x:[]],p=new Set(h.map(y=>y.value));(o.type==="select"||o.type==="multi_select")&&u.subNodes.map(y=>c[y]).forEach(y=>{var w,k;if(!y)return;const b=(k=(w=y.data.collectionProperties)==null?void 0:w[a])!=null?k:[];de(b).split(",").forEach(C=>{var T;C=C.trim(),C&&(p.has(C)||(p.add(C),h.push({id:qe(),color:(T=od(wr.map(v=>v.key)))!=null?T:wr[0].key,value:C})))})}),pe(s,{data:{schema:{...d,[a]:{...f,showAs:i.isUpdateNumberFormat?void 0:f.showAs,...o,options:h}}}})};i!=null&&i.needTransaction?e(()=>{l()}):l()};return F.useCallback(n,[t,e])},WA=[{zh:"数字",en:"number",pingyin:"shuzi",example:"123"},{zh:"整数",en:"integer",pingyin:"zhengshu",example:"123"},{zh:"一位小数",en:"oneDecimal",pingyin:"yiweixiaoshu",example:"1.0"},{zh:"两位小数",en:"twoDecimal",pingyin:"liangweixiaoshu",example:"1.00"},{zh:"千分位",en:"thousandth",pingyin:"qianfenwei",example:"1,000"},{zh:"百分数(一位小数)",en:"percentOneDecimal",pingyin:"baifenshuyiweixiaoshu",example:"1.0%"},{zh:"百分数(两位小数)",en:"percent",pingyin:"baifenshuliangweixiaoshu",example:"1.00%"},{zh:"人民币",en:"rmb",pingyin:"renminbi",symbol:"CN¥",example:"CN¥100"},{zh:"美元",en:"dollar",pingyin:"meiyuan",symbol:"US$",example:"US$100"},{zh:"日元",en:"yen",pingyin:"riyuan",symbol:"JP¥",example:"JP¥100"},{zh:"欧元",en:"euro",pingyin:"ouyuan",symbol:"€",example:"€100"}],KJ=()=>{const{readonly:e}=Te(),t=me(),n=(s,a)=>{s.stopPropagation(),!e&&t.dropdown({popcorn:s.currentTarget,placement:"bottom",content:({onCloseModal:o})=>r.jsx(KA,{closeModal:o,propertyId:a})})};return F.useCallback(n,[t,e])},KA=e=>{var h,p;const{closeModal:t,propertyId:n}=e,{collectionId:s}=Te(),[a,o]=F.useState(""),i=F.useRef(null),l=_a(),c=_e(s,["data"],["schema"]),{numberFormat:u}=(p=(h=c==null?void 0:c.data.schema)==null?void 0:h[n])!=null?p:{},d=[],f=new RegExp(a,"i");return WA.forEach((g,_)=>{const x=g.en+g.zh+g.pingyin;_===7&&d.push({type:$.LINE}),x.search(f)>-1&&d.push({type:$.OPERABLE_BLOCK_TEXT,data:{title:g.zh,followTitle:!0,selected:u===g.en,desc:g.example,...g}})}),r.jsxs("div",{className:"w-[220px] py-2 next-modal",children:[r.jsx(xt,{autoFocus:!0,inputRef:i,placeholder:"搜索格式",className:"h-8 flex-1 border-grey6 rounded-sm m-2",inputClassName:"px-2",onEnter:()=>t==null?void 0:t(),onChange:g=>o(g)}),r.jsx(ze,{className:"overflow-auto max-h-120",items:d,onItemClick:g=>{var y,b,E;t==null||t();const{blocks:_}=le(),{numberFormat:x}=(E=(b=(y=_[s])==null?void 0:y.data.schema)==null?void 0:b[n])!=null?E:{};x!==g.data.title&&l(s,n,{numberFormat:g.data.en},{needTransaction:!0,isUpdateNumberFormat:!0})}})]})},X2=({width:e,height:t=3,percent:n=.25,bgColor:s,progressColor:a,className:o})=>r.jsx("div",{className:B("rounded-full overflow-hidden",o),style:{backgroundColor:s,height:t,width:e},children:r.jsx("div",{className:"h-full rounded-full",style:{backgroundColor:a,width:fa(n)}})}),Q2=e=>{const{levelSymbol:t="⭐️",totalScore:n=5,score:s=0,className:a}=e,o=[];Array.from({length:n}).forEach((l,c)=>{o.push(r.jsx(zt.Fragment,{children:YJ[t]},c))});const i=Math.min(s,n);return r.jsxs("div",{className:B("relative",a),children:[r.jsx("div",{style:{clipPath:`inset(0 ${fa(1-i/n)} 0 0)`},className:"min-w-max flex",children:o}),r.jsx("div",{style:{clipPath:`inset(0 0 0 ${fa(i/n)})`},className:"absolute inset-0 bg-white1 opacity-20 min-w-max flex",children:o})]})},YJ={"⭐️":r.jsx("img",{src:`${bt}/score/1.png`,className:"w-4 h-4",alt:"⭐️"}),"❤️":r.jsx("img",{src:`${bt}/score/2.png`,className:"w-4 h-4",alt:"❤️"}),"💡":r.jsx("img",{src:`${bt}/score/3.png`,className:"w-4 h-4",alt:"💡"}),"🔥":r.jsx("img",{src:`${bt}/score/4.png`,className:"w-4 h-4",alt:"🔥"}),"👍":r.jsx("img",{src:`${bt}/score/5.png`,className:"w-4 h-4",alt:"👍"}),"😀":r.jsx("img",{src:`${bt}/score/6.png`,className:"w-4 h-4",alt:"😀"}),"☘️":r.jsx("img",{src:`${bt}/score/7.png`,className:"w-4 h-4",alt:"☘️"}),"🟡️":r.jsx("img",{src:`${bt}/score/8.png`,className:"w-4 h-4",alt:"🟡️"}),"🔷":r.jsx("img",{src:`${bt}/score/9.png`,className:"w-4 h-4",alt:"🔷"}),"⬛":r.jsx("img",{src:`${bt}/score/10.png`,className:"w-4 h-4",alt:"⬛"})},Ep=e=>{const{num:t,showAs:n={},numberFormat:s,from:a}=e,{levelSymbol:o,type:i,color:l,maxValue:c}=n;if(!c)return null;const u=`${t} / ${c}`;let d=null;return i===m.NumberShowType.BAR&&l?d=r.jsx(Fe,{popup:u,offset:[0,-3],className:"max-w-[300px] min-w-[80px] w-[60%] flex-shrink-0 ml-2 self-stretch flex items-center cursor-pointer",children:r.jsx(X2,{height:5,className:"w-full",percent:s!=null&&s.includes("percent")?t:t/c,bgColor:Tf(l),progressColor:ql(l)})}):i===m.NumberShowType.RING&&l?d=r.jsx(Fe,{popup:u,offset:[0,-3],className:"ml-2 flex-shrink-0 cursor-pointer",children:r.jsx(J1,{size:20,percent:s!=null&&s.includes("percent")?t:t/c,bgColor:Tf(l),ringColor:ql(l)})}):i===m.NumberShowType.LEVEL&&o&&(d=r.jsx(Fe,{popup:u,className:"ml-2 whitespace-nowrap cursor-pointer",children:r.jsx(Q2,{levelSymbol:o,totalScore:c,score:s!=null&&s.includes("percent")?c*t:t,className:"flex-shrink-0"})})),d},Sc=(e,t)=>{var s,a;if(Number.isNaN(e))return;if(!t||t==="number")return mk(e);if(t==="integer")return Math.round(e);if(t==="oneDecimal")return Number(e).toFixed(1);if(t==="twoDecimal")return Number(e).toFixed(2);if(t==="thousandth"){const[o,i]=String(e).split(".");let l=YT(o!=null?o:"");return i&&(l=l.concat(".",i)),l}return t==="percentOneDecimal"?fa(e,1):t==="percent"?fa(e):((a=(s=WA.find(o=>o.en===t))==null?void 0:s.symbol)!=null?a:"").concat(" ",YT(Number(e).toFixed(2)))},YA=({className:e,site:t,recordId:n,propertyId:s})=>{const{collectionId:a,readonly:o}=Te(),i=KJ(),l=ae(({blocks:p})=>{var g,_;return(_=(g=p[a])==null?void 0:g.data.schema)==null?void 0:_[s]}),{numberFormat:c,showAs:u}=l!=null?l:{},d=ae(p=>{var E,w,k,C,T,v;const{blocks:g}=p,_=(w=(E=g[a])==null?void 0:E.data.schema)==null?void 0:w[s];if((_==null?void 0:_.type)===m.CollectionSchemaType.FORMULA){const j=Ln(a,()=>p).getValue(n,s);return j==null?NaN:j}const x=(C=(k=g[n])==null?void 0:k.data.collectionProperties)==null?void 0:C[s],y=de(x);let b=parseFloat(y);return Number.isNaN(b)&&(b=parseFloat((v=(T=y.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:T[0])!=null?v:"")),b}),f=Sc(d,c);let h;return d!==void 0&&(h=Ep({num:Math.max(0,d),showAs:u,numberFormat:c,from:"num"})),r.jsxs("div",{className:B("number-box w-full overflow-hidden p-2 leading-[20px] min-h-[36px]",t!==Me.FIELD&&"text-right",e),children:[typeof f<"u"?r.jsxs("div",{className:B("items-center flex min-h-[20px]",t!==Me.FIELD&&"justify-end"),children:[h&&!(u!=null&&u.showNumber)?void 0:f,h]}):t===Me.FIELD&&r.jsx("span",{className:"text-grey4",children:"未填写"}),(t===Me.CELL||t===Me.FIELD)&&!o&&r.jsx("button",{onClick:p=>i(p,s),className:B("absolute top-1.5 flex items-center justify-center w-6 h-6 rounded cursor-pointer border-grey6 border bg-white1 animate-hover-opaque opacity-0",{"left-1":t===Me.CELL,"right-1":t===Me.FIELD}),children:r.jsx(H,{name:"IcMenuNum",size:"middle",className:"text-grey3"})})]})};function Cl(e,t,n){var a,o,i,l,c,u,d,f,h,p;if(!e)return;const{blocks:s}=le();if(typeof e=="string"){const g=s[e];if(!g)return;e=g}if(!n){const g=s[e.parentId];if(!g)return;n=(a=g.data.schema)==null?void 0:a[t]}if(n)switch(n.type){case m.CollectionSchemaType.CREATED_AT:return e.createdAt;case m.CollectionSchemaType.UPDATED_AT:return e.updatedAt;case m.CollectionSchemaType.CREATED_BY:return e.createdBy;case m.CollectionSchemaType.UPDATED_BY:return e.updatedBy;case m.CollectionSchemaType.DATE:return(o=Gr(e,t))==null?void 0:o.timestamp;case m.CollectionSchemaType.TITLE:return de(e.data.segments).trim();case m.CollectionSchemaType.NUMBER:{const g=de((i=e.data.collectionProperties)==null?void 0:i[t]);let _=parseFloat(g);return Number.isNaN(_)&&(_=parseFloat((c=(l=g.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:l[0])!=null?c:"")),Number.isNaN(_)?void 0:_}case m.CollectionSchemaType.FILE:{const _=((d=(u=e.data.collectionProperties)==null?void 0:u[t])!=null?d:[]).filter(x=>x.type===m.TextType.URL&&x.fileStorageType==="internal").map(x=>x.url).filter(x=>!!x);return _.length>0?_:void 0}case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:return pi((f=e.data.collectionProperties)==null?void 0:f[t]);case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:return de((h=e.data.collectionProperties)==null?void 0:h[t]).trim().split(/\s*,\s*/g).filter(x=>{var y;return(y=n==null?void 0:n.options)==null?void 0:y.some(b=>b.value===x)});default:return de((p=e.data.collectionProperties)==null?void 0:p[t]).trim()}}const XJ=(e,t,n)=>{var i,l,c,u,d,f,h;if(!e)return;const{blocks:s}=le();if(typeof e=="string"){const p=s[e];if(!p)return;e=p}let a="";if(!n){const p=s[e.parentId];if(!p)return;a=e.parentId,n=nu(p.uuid,t).propertySchema}if(!n)return;const o=(i=e.data.collectionProperties)==null?void 0:i[t];switch(n.type){case m.CollectionSchemaType.CREATED_AT:return he(e.createdAt).format(us);case m.CollectionSchemaType.UPDATED_AT:return he(e.updatedAt).format(us);case m.CollectionSchemaType.CREATED_BY:return ss((l=e.createdBy)!=null?l:"");case m.CollectionSchemaType.UPDATED_BY:return ss((c=e.updatedBy)!=null?c:"");case m.CollectionSchemaType.DATE:{const p=o==null?void 0:o.find(g=>g.type===m.TextType.DATE||g.type===m.TextType.DATETIME);return p?Wp(p,n.dateFormat,p.type===m.TextType.DATETIME,n.timeFormat):""}case m.CollectionSchemaType.PERSON:return Sf(o).map(p=>{var g;return ss((g=p.uuid)!=null?g:"")});case m.CollectionSchemaType.FILE:return o==null?void 0:o.filter(p=>p.type===m.TextType.URL&&p.fileStorageType==="internal").map(p=>p.text).join(",");case m.CollectionSchemaType.NUMBER:{const p=n.numberFormat,g=de(o);let _=parseFloat(g);return Number.isNaN(_)&&(_=parseFloat((d=(u=g.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:u[0])!=null?d:"")),Sc(_,p)}case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:return pi(o);case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:return de((f=e.data.collectionProperties)==null?void 0:f[t]).trim().split(/\s*,\s*/g).filter(_=>{var x;return(x=n==null?void 0:n.options)==null?void 0:x.some(y=>y.value===_)}).join(",");case m.CollectionSchemaType.TITLE:return de(e.data.segments).trim();case m.CollectionSchemaType.CHECKBOX:return de(o).toUpperCase()==="YES"?"YES":"NO";case m.CollectionSchemaType.FORMULA:{if(a){const p=Ln(a),g=p.getType(t),_=p.getValue(e.uuid,t);if(g===He.ValueTool.numberType)return _;if(g===He.ValueTool.stringType)return _;if(g===He.ValueTool.booleanType)return _?"YES":"NO";if(g===He.ValueTool.dateType)return he(_).format(us)}return""}default:return de((h=e.data.collectionProperties)==null?void 0:h[t])}},oxe=(e,t,n)=>{var a,o,i,l,c,u,d;if(!e)return;const{blocks:s}=le();if(typeof e=="string"){const f=s[e];if(!f)return;e=f}if(!n){const f=s[e.parentId];if(!f)return;n=(a=f.data.schema)==null?void 0:a[t]}if(n)switch(n.type){case m.CollectionSchemaType.CREATED_AT:return[Fn({from:new Date((o=e.createdAt)!=null?o:""),includeTime:!0})];case m.CollectionSchemaType.UPDATED_AT:return[Fn({from:new Date((i=e.updatedAt)!=null?i:""),includeTime:!0})];case m.CollectionSchemaType.CREATED_BY:return[wc((l=e.createdBy)!=null?l:"")];case m.CollectionSchemaType.UPDATED_BY:return[wc((c=e.updatedBy)!=null?c:"")];case m.CollectionSchemaType.FILE:case m.CollectionSchemaType.DATE:case m.CollectionSchemaType.NUMBER:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:case m.CollectionSchemaType.URL:return(u=e.data.collectionProperties)==null?void 0:u[t];case m.CollectionSchemaType.TITLE:return e.data.segments;case m.CollectionSchemaType.FORMULA:{const f=XJ(e,t);return mt(f)}default:return(d=e.data.collectionProperties)==null?void 0:d[t]}},Td="028b4b00-f133-4a70-a19e-4df3d5df906f",QJ=(e,t,n)=>e==="out_of_range"?1:t==="out_of_range"||!e?-1:t?n===m.GroupSortType.ASCENDING?Number(e.split(",")[0])-Number(t.split(",")[0]):Number(t.split(",")[0])-Number(e.split(",")[0]):1,JJ=(e,t,n)=>e?t?n===m.GroupSortType.ASCENDING?Rh(e)-Rh(t):Rh(t)-Rh(e):1:-1,XA=(e,t,n)=>e?t?n===m.GroupSortType.ASCENDING?e.localeCompare(t):t.localeCompare(e):1:-1,ZJ=(e,t)=>{const n=Hg("text",t);n!==m.GroupSortType.MANUAL&&e.sort((s,a)=>{var o,i;return XA((o=s.value)!=null?o:"",(i=a.value)!=null?i:"",n)})},eZ=(e,t)=>{const n=Hg("number",t);e.sort((s,a)=>{var o,i;return QJ((o=s.value)!=null?o:"",(i=a.value)!=null?i:"",n)})},tZ=(e,t)=>{const n=Hg("date",t);e.sort((s,a)=>{var o,i;return JJ((o=s.value)!=null?o:"",(i=a.value)!=null?i:"",n)})},nZ=(e,t)=>{const{blocks:n}=le(),s=Hg("text",t);s!==m.GroupSortType.MANUAL&&e.sort((a,o)=>{var c,u;if(!a.value)return-1;if(!o.value)return 1;const i=de((c=n[a.value])==null?void 0:c.data.segments),l=de((u=n[o.value])==null?void 0:u.data.segments);return XA(i,l,s)})},wp=Ai(e=>e.blocks,e=>e.users,e=>e.collectionId,e=>e.recordId,e=>e.groupProperty,e=>e.groupBy,(e,t,n,s,a,o)=>{var f,h,p,g,_,x,y,b,E,w;const i=e[s];if(!i)return[];const l=e[n],c=(f=l==null?void 0:l.data.schema)==null?void 0:f[a];if(!c)return[];const u=c.type;let d=[];switch(u){case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{d=de((h=i.data.collectionProperties)==null?void 0:h[a]).trim().split(/\s*,\s*/g).map(k=>{var C,T;return(T=(C=c.options)==null?void 0:C.find(v=>v.value===k))==null?void 0:T.value}).filter(k=>!!k),u===m.CollectionSchemaType.SELECT&&(d=d.slice(0,1));break}case m.CollectionSchemaType.CHECKBOX:{const k=(p=i.data.collectionProperties)==null?void 0:p[a];d=[de(k).trim().toUpperCase()==="YES"?"YES":"NO"];break}case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.PERSON:{if(u===m.CollectionSchemaType.PERSON)d=((_=(g=i.data.collectionProperties)==null?void 0:g[a])!=null?_:[]).filter(C=>{var T;return C.type===m.TextType.USER&&t[(T=C.uuid)!=null?T:""]}).map(C=>C.uuid).filter(C=>!!C);else{const C=u===m.CollectionSchemaType.CREATED_BY?i.createdBy:i.updatedBy;C&&t[C]&&(d=[C])}break}case m.CollectionSchemaType.RELATION:{const{relationRecords:k}=du(i.uuid,a,e);d=k;break}case m.CollectionSchemaType.NUMBER:{const{start:k,end:C,size:T}=_0(o),v=de((x=i.data.collectionProperties)==null?void 0:x[a]);let I=parseFloat(v);Number.isNaN(I)&&(I=parseFloat((b=(y=v.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:y[0])!=null?b:"")),Number.isNaN(I)||(d=[Qv(I,k,C,T)]);break}case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{let k;if(u===m.CollectionSchemaType.DATE){const T=Gr(i,a);k=T==null?void 0:T.timestamp}else u===m.CollectionSchemaType.CREATED_AT?k=i.createdAt:k=i.updatedAt;if(!k){d=[];break}const C=Xv(k,zf("date",o==null?void 0:o.groupLevel));C&&(d=[C]);break}case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:{const k=zf("text",o==null?void 0:o.groupLevel);let C="";if(u===m.CollectionSchemaType.PHONE||u===m.CollectionSchemaType.URL||u===m.CollectionSchemaType.EMAIL){const T=(E=i.data.collectionProperties)==null?void 0:E[a];C=pi(T)}else u===m.CollectionSchemaType.TITLE?C=de(i.data.segments):C=de((w=i.data.collectionProperties)==null?void 0:w[a]);C=C.trim(),k===m.GroupLevel.ALPHABET_PREFIX&&(C=C.charAt(0).toUpperCase()),C&&(d=[C]);break}case m.CollectionSchemaType.FORMULA:{const k=Ln(n),C=k.getTypeAsCollectionSchemaType(a),{start:T,end:v,size:I}=_0(o);let{groupLevel:j}=o;switch((C==="text"||C==="date")&&(j=zf(C,j)),C){case m.CollectionSchemaType.CHECKBOX:{d=[k.getValue(i.uuid,a)===!0?"YES":"NO"];break}case m.CollectionSchemaType.TEXT:{let D=k.getValue(i.uuid,a);typeof D=="string"&&D.trim()&&(D=D.trim(),j===m.GroupLevel.ALPHABET_PREFIX&&(D=D.charAt(0).toUpperCase()),d=[D]);break}case m.CollectionSchemaType.NUMBER:{const D=k.getValue(i.uuid,a);typeof D=="number"&&!isNaN(D)&&(d=[Qv(D,T,v,I)]);break}case m.CollectionSchemaType.DATE:{const D=k.getValue(i.uuid,a);if(typeof D=="object"&&D!==null){const S=D.getTime(),R=Xv(S,j);R&&(d=[R])}break}}break}}return d.length===0&&(d=[Td]),d},{memoizeOptions:{maxSize:200}}),Jv=(e,t,n,s,a,o,i)=>{var f,h,p;const l=(f=i.property)!=null?f:"",c=o.type;let u=[...a];(a.length===0||((h=a[0])==null?void 0:h.propertyType)!==c)&&(u=[]);let d;if(c===m.CollectionSchemaType.FORMULA){const _=Ln(s).getTypeAsCollectionSchemaType(l),x=(p=u[0])==null?void 0:p.resultType;_!==x&&(u=[]),u=Zv(e,t,n,s,a,o,i,u,_),_===m.CollectionSchemaType.TEXT&&(d="text"),_===m.CollectionSchemaType.NUMBER&&(d="number"),_===m.CollectionSchemaType.DATE&&(d="date")}else u=Zv(e,t,n,s,a,o,i,u),c===m.CollectionSchemaType.RELATION&&(d="relation"),c===m.CollectionSchemaType.NUMBER&&(d="number"),(c===m.CollectionSchemaType.CREATED_AT||c===m.CollectionSchemaType.UPDATED_AT||c===m.CollectionSchemaType.DATE)&&(d="date"),(c===m.CollectionSchemaType.TITLE||c===m.CollectionSchemaType.TEXT||c===m.CollectionSchemaType.PHONE||c===m.CollectionSchemaType.URL||c===m.CollectionSchemaType.EMAIL)&&(d="text");return d==="text"?ZJ(u,i.sort):d==="number"?eZ(u,i.sort):d==="date"?tZ(u,i.sort):d==="relation"&&nZ(u,i.sort),{needUpdateGroups:!rn(a,u),newViewGroups:u}},Zv=(e,t,n,s,a,o,i,l,c)=>{var g,_,x;const u=l.length===0,d=(g=i.property)!=null?g:"",f=o.type;let h=[];f===m.CollectionSchemaType.SELECT||f===m.CollectionSchemaType.MULTI_SELECT?(h=(x=(_=o.options)==null?void 0:_.map(y=>y.value))!=null?x:[],l=l.filter(y=>!y.value||h.includes(y.value))):f===m.CollectionSchemaType.CHECKBOX||f===m.CollectionSchemaType.FORMULA&&c===m.CollectionSchemaType.CHECKBOX?h=["YES","NO"]:e.forEach(y=>{const b=wp({blocks:t,users:n,collectionId:s,recordId:y,groupProperty:d,groupBy:i});h.push(...b)});const p=new Set;return a.forEach(y=>y.value&&p.add(y.value)),new Set(h).forEach(y=>{if(!p.has(y)&&y!==Td){const b={property:d,propertyType:f,visible:!0,value:y};c&&(b.resultType=c),l.push(b)}}),u&&!l.find(y=>!y.value)&&(f===m.CollectionSchemaType.TITLE||f===m.CollectionSchemaType.TEXT||f===m.CollectionSchemaType.PHONE||f===m.CollectionSchemaType.URL||f===m.CollectionSchemaType.EMAIL||f===m.CollectionSchemaType.DATE||f===m.CollectionSchemaType.PERSON||f===m.CollectionSchemaType.SELECT||f===m.CollectionSchemaType.MULTI_SELECT||f===m.CollectionSchemaType.RELATION||f===m.CollectionSchemaType.NUMBER||f===m.CollectionSchemaType.FORMULA&&c!==m.CollectionSchemaType.CHECKBOX)&&l.unshift({property:d,propertyType:f,visible:!0,resultType:c}),l=YM(l.filter(Boolean),y=>{if(y.value)return y.value}),l},vF=Ai(e=>e.blocks,e=>e.collectionViews,e=>e.users,e=>e.viewId,e=>e.sortedRecordIds,(e,t,n,s,a)=>{var M,U,V,W;const o=Zt(s,e,t);if(!o)return;const{view:i,collection:l,groups:c=[],subGroups:u=[],groupBy:d,subGroupBy:f,timelineShowTable:h,timelineBy:p,timelineByEnd:g}=o,_=(M=d==null?void 0:d.property)!=null?M:"",x=(U=f==null?void 0:f.property)!=null?U:"",y=$g(l.uuid);i.type===m.CollectionViewType.TIMELINE&&!h&&(a=a.filter(z=>{if(!p||!g)return!1;const Q=e[z],Z=Cl(Q,p),te=Cl(Q,g);return!!(Z||te)}));const b=(V=l.data.schema)==null?void 0:V[_],E=(W=l.data.schema)==null?void 0:W[x];if(!b||!y.includes(_)||!d)return{sortedRecordIds:a,visibleGroups:[],hiddenGroups:[],withoutValidGroup:!0};let w=!1;i.type===m.CollectionViewType.BOARD&&y.includes(x)&&(w=!0);const{needUpdateGroups:k,newViewGroups:C}=Jv(a,e,n,l.uuid,c,b,d),T=new Map,v=C.map((z,Q)=>{const Z=ob(z,_);return T.set(Z.value,{group:Z,index:Q}),Z});let I=!1,j=[],D=new Map,S=[];if(w&&E&&f){const z=Jv(a,e,n,l.uuid,u,E,f);I=z.needUpdateGroups,j=z.newViewGroups,D=new Map,S=j.map(Q=>{const Z={...ob(Q,x),groups:C.map(te=>ob(te,_))};return D.set(Z.value,Z),Z})}a.forEach(z=>{if(!e[z])return;const Z=wp({blocks:e,users:n,collectionId:l.uuid,recordId:z,groupProperty:_,groupBy:d}),te=[];Z.forEach(re=>{const ne=T.get(re);ne&&(te.push(ne.index),ne.group.recordIds.push(z))}),w&&E&&f&&wp({blocks:e,users:n,collectionId:l.uuid,recordId:z,groupProperty:x,groupBy:f}).forEach(ne=>{const Y=D.get(ne);Y&&te.forEach(X=>{var oe;Y.recordIds.push(z),(oe=Y.groups[X])==null||oe.recordIds.push(z)})})});const R=[],A=[];v.forEach(z=>{z.visible?d.hideEmptyGroups&&z.recordIds.length===0&&z.emptyHidden!==!1?(z.visible=!1,A.push(z)):R.push(z):A.push(z)});const L=[],P=[];return S.forEach(z=>{z.groups.forEach((Q,Z)=>{var te,re;Q.visible=(re=(te=v[Z])==null?void 0:te.visible)!=null?re:Q.visible}),z.visible?f!=null&&f.hideEmptyGroups&&z.recordIds.length===0&&z.emptyHidden!==!1?(z.visible=!1,P.push(z)):L.push(z):P.push(z)}),{withoutValidGroup:!1,needUpdateGroups:k,needUpdateSubGroups:I,newViewGroups:C,newViewSubGroups:j,groups:v,visibleGroups:R,hiddenGroups:A,hasValidSubGroup:w,subGroups:S,visibleSubGroups:L,hiddenSubGroups:P,subGroupProperty:x,groupProperty:_,sortedRecordIds:a}},{memoizeOptions:{maxSize:10}}),ob=(e,t)=>{var n;return{value:(n=e.value)!=null?n:Td,visible:e.visible,emptyHidden:e.emptyHidden,recordIds:[],groupProperty:t}},sZ=e=>{var n;const t=(n=vm(e))==null?void 0:n.trim();return ae(s=>QA(e,s,!1,t),{equalityFn:Cn})},QA=Ai((e,t,n)=>e,(e,t,n)=>t,(e,t,n)=>n,(e,t,n,s)=>s,(e,t,n,s)=>{var h;const{users:a,user:o}=t,i=Zt(e,t.blocks,t.collectionViews);if(!i)return[];const{view:l,collection:c}=i;if(pt.dataBaseRange==="all")return c.subNodes;const u=aZ(c.uuid,t,n,s),d=ZA({collectionId:c.uuid,records:u,schemas:c.data.schema,userId:o.uuid,filter:l.format.filter});return JA({state:t,collectionId:c.uuid,records:d,tableSchema:(h=c.data.schema)!=null?h:{},users:a,sorters:l.format.sorters,sort:l.pageSort}).map(p=>p.uuid)},{memoizeOptions:{maxSize:10,resultEqualityCheck:rn}}),uc=({viewId:e,state:t=le(),ignoreSearch:n=!1,groupValue:s})=>{var d,f;const a=QA(e,t,n,wt.$collectionSearch[e]);if(!s)return a;const{blocks:o,users:i,collectionViews:l}=le(),c=vF({blocks:o,collectionViews:l,users:i,viewId:e,sortedRecordIds:a}),u=(d=c==null?void 0:c.groups)==null?void 0:d.find(h=>h.value===s);return(f=u==null?void 0:u.recordIds)!=null?f:[]},rZ=(e,t,n)=>{var a,o,i,l,c,u,d,f,h,p,g;const s=n.split(/\s+/);for(const[_,x]of Object.entries(e)){let y="";switch(x.type){case m.CollectionSchemaType.TEXT:{const b=(a=t.data.collectionProperties)==null?void 0:a[_];y=de(b);break}case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:{const b=(o=t.data.collectionProperties)==null?void 0:o[_];y=pi(b);break}case m.CollectionSchemaType.TITLE:{y=de(t.data.segments);break}case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{y=de((i=t.data.collectionProperties)==null?void 0:i[_]).trim().split(/\s*,\s*/g).map(w=>{var k,C;return(C=(k=x.options)==null?void 0:k.find(T=>T.value===w))==null?void 0:C.value}).filter(w=>!!w).join("");break}case m.CollectionSchemaType.NUMBER:{const b=de((l=t.data.collectionProperties)==null?void 0:l[_]);let E=parseFloat(b);Number.isNaN(E)&&(E=parseFloat((u=(c=b.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:c[0])!=null?u:"")),Number.isNaN(E)||(y=String(E));break}case m.CollectionSchemaType.RELATION:{const b=du(t.uuid,_).relationRecords,{blocks:E}=le();y=b.map(k=>{const C=E[k];return C?de(C.data.segments):""}).join("");break}case m.CollectionSchemaType.CHECKBOX:{y=de((d=t.data.collectionProperties)==null?void 0:d[_]).trim().toUpperCase()==="YES"?"yes":"no";break}case m.CollectionSchemaType.FILE:{y=((h=(f=t.data.collectionProperties)==null?void 0:f[_])!=null?h:[]).filter(w=>w.type===m.TextType.URL&&w.fileStorageType==="internal").map(w=>w.text).join("");break}case m.CollectionSchemaType.PERSON:{((g=(p=t.data.collectionProperties)==null?void 0:p[_])!=null?g:[]).forEach(E=>{if(E.type===m.TextType.USER&&E.uuid){const w=ss(E.uuid);w&&(y+=w)}});break}}if(s.find(b=>y.includes(b)))return!0}return!1},aZ=(e,t=le(),n=!1,s="")=>{const{blocks:a}=t,o=a[e];return o?o.subNodes.reduce((i,l)=>{const c=a[l];if((c==null?void 0:c.type)!==m.BlockType.PAGE)return i;const u=o.data.schema;if(!n&&s&&u&&c&&!rZ(u,c,s))return i;const{role:d}=hn(l);return c&&(ht()||d!==m.PermissionRole.NONE)&&i.push(c),i},[]):[]},JA=Ai([({collectionId:e})=>e,({records:e})=>e,({tableSchema:e})=>e,({users:e})=>e,({sorters:e})=>(e!=null?e:[]).filter(t=>!t.disable),({sort:e})=>e],(e,t,n,s,a,o)=>{if(a.length===0&&o.length===0)return t;const i=new Map;o.forEach((f,h)=>{i.set(f,h)});let l=o.length;for(const f of t)i.has(f.uuid)||(i.set(f.uuid,l),l+=1);const c=Ln(e),u=WJ(a,{collectionId:e,schemas:n,ranking:i,users:s,formulaTool:c}),d=t.slice(0);return d.sort(u),d},{memoizeOptions:{equalityCheck:rn,maxSize:100}}),ZA=Ai([({records:e})=>e,({schemas:e})=>e,({userId:e})=>e,({filter:e})=>e,({collectionId:e})=>e],(e,t,n,s,a)=>{const o=zA(s,{collectionId:a,schemas:t,userId:n});return e.filter(o)},{memoizeOptions:{equalityCheck:Cn,maxSize:100}}),Xa=e=>e!==Td?e:void 0,fu=e=>{const t=sZ(e);return ae(({blocks:n,users:s,collectionViews:a})=>vF({blocks:n,collectionViews:a,users:s,viewId:e,sortedRecordIds:t}),{equalityFn:rn})},J2=e=>({checkRecord:t=>e(t)!==null,prevRecord:t=>{var o;const n=e(t);if(n==null)return null;const{records:s,index:a}=n;return a<=0?null:(o=s[a-1])!=null?o:null},nextRecord:t=>{var o;const n=e(t);if(n==null)return null;const{records:s,index:a}=n;return a>=s.length-1?null:(o=s[a+1])!=null?o:null}}),oZ=(e,t)=>{const n=sa(pC);F.useEffect(()=>(n(s=>({...s,[e]:t})),()=>{n(s=>{const{[e]:a,...o}=s;return o})}),[n,e,t])},Gg=(e,t=!0)=>{const n=fu(e),s=sa(pC);return F.useEffect(()=>{if(!t)return;const o=J2(i=>{if(n==null)return null;if(n.withoutValidGroup){const l=n.sortedRecordIds.indexOf(i);return l>=0?{records:n.sortedRecordIds,index:l}:null}for(const l of n.visibleGroups){const c=l.recordIds.indexOf(i);if(c>=0)return{records:l.recordIds,index:c}}return null});return s(i=>({...i,[e]:o})),()=>{s(i=>{const{[e]:l,...c}=i;return c})}},[t,s,n,e]),n},th=e=>{var p,g,_,x,y,b,E;const t={},{viewId:n,groupValue:s,subGroupValue:a,blockId:o,oldGroupValues:i,isNewRecord:l}=e;if(!s&&!a)return t;const{collection:c,view:u,subGroupBy:d,groupBy:f}=(p=Zt(n))!=null?p:{};if(!c||!u)return t;const h=(d==null?void 0:d.property)===(f==null?void 0:f.property);return[{groupValue:s,propertyId:f==null?void 0:f.property,schemaType:(x=(_=c.data.schema)==null?void 0:_[(g=f==null?void 0:f.property)!=null?g:""])==null?void 0:x.type,oldGroupValue:Object.keys(i!=null?i:{}),groupBy:f},{groupValue:a,propertyId:d==null?void 0:d.property,schemaType:(E=(b=c.data.schema)==null?void 0:b[(y=d==null?void 0:d.property)!=null?y:""])==null?void 0:E.type,oldGroupValue:i?[...new Set(Object.values(i).flat().filter(Boolean))]:void 0,groupBy:d}].forEach(({groupValue:w,propertyId:k,schemaType:C,groupBy:T,oldGroupValue:v})=>{var I,j,D,S,R,A;if(!(!w||!k||!C)){if(!Xa(w)){C===m.CollectionSchemaType.TITLE?t.title=(I=t.title)!=null?I:[]:t[k]=(j=t[k])!=null?j:[];return}if(w=Xa(w),!!w)switch(C){case m.CollectionSchemaType.TITLE:{t.title=mt(w);break}case m.CollectionSchemaType.NUMBER:{if(w==="out_of_range")t[k]=mt((D=T==null?void 0:T.end)!=null?D:1e3);else{const L=w.split("->")[0];L&&(t[k]=mt(L))}break}case m.CollectionSchemaType.MULTI_SELECT:{if(l&&h){const M=de(t[k]);M?M!==w&&(t[k]=mt(`${M},${w}`)):t[k]=mt(`${w}`);break}const{blocks:L}=le(),P=L[o!=null?o:""];if(P){const M=(S=P.data.collectionProperties)==null?void 0:S[k],U=de(M).split(",").map(W=>v!=null&&v.includes(W)?"":W).filter(W=>!!W);let V="";U.includes(w)?V=U.join(","):V=U.concat(w).join(","),t[k]=mt(V);break}t[k]=mt(w);break}case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.CHECKBOX:case m.CollectionSchemaType.SELECT:{t[k]=mt(w);break}case m.CollectionSchemaType.DATE:{const L=Rh(w);t[k]=[Fn({from:he(L).toDate()})];break}case m.CollectionSchemaType.PERSON:{const{blocks:L}=le(),P=L[o!=null?o:""];if(P){const M=(A=(R=P.data.collectionProperties)==null?void 0:R[k])!=null?A:[];let U=!1;const V=M.filter(W=>{var z;return W.type===m.TextType.USER?W.uuid===w?(U=!0,!0):!(v!=null&&v.includes((z=W.uuid)!=null?z:"")):!1});U||V.push(wc(w)),t[k]=V;break}t[k]=[wc(w)];break}case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:{t[k]=[{type:m.TextType.URL,url:w,text:w,enhancer:{}}];break}case m.CollectionSchemaType.RELATION:{t[k]=[{type:m.TextType.LINK_PAGE,uuid:w,text:"",enhancer:{code:!1}}];break}}}}),t};let eB;const iZ=e=>{eB=e},lZ=(...e)=>eB(...e),Ri=(e,t,n)=>{e.reduce((s,a)=>{cZ(a,s,n);const{parentId:o}=s;return{parentId:o,after:a,groupValue:s.groupValue,subGroupValue:s.subGroupValue}},t)},cZ=(e,t,n)=>{var c;if(e===t.parentId)return;const{blocks:s}=le(),a=s[e];if(!a)return;const o=s[t.parentId];if(!o)return;a0(e);let i=!1;if((o.type===m.BlockType.COLLECTION_VIEW||o.type===m.BlockType.COLLECTION_VIEW_PAGE)&&n){if(!Kw.includes(a.type))return;const{collectionViews:u}=le(),d=s[o.uuid],f=u[n];if(!d||!f)return;const{newPageSort:h,needUpdate:p}=Vg(f.pageSort,d.subNodes);p&&Kn(n,{pageSort:h}),h.includes(e)&&ee(_c({uuid:e,viewId:n})),t.first||t.before?ee(md({uuid:e,viewId:n,before:t.before})):ee(Fl({uuid:e,viewId:n,after:t.after}));const g=th({viewId:n,groupValue:t.groupValue,subGroupValue:t.subGroupValue,blockId:e});Object.keys(g).length>0&&pe(e,{data:{segments:(c=g.title)!=null?c:a.data.segments,collectionProperties:{...a.data.collectionProperties,...g}}}),a.type!==m.BlockType.PAGE&&(i=!0)}o.uuid===a.spaceId&&(a.type===m.BlockType.COLLECTION_VIEW?pe(e,{type:m.BlockType.COLLECTION_VIEW_PAGE}):a.type===m.BlockType.REFERENCE_COLLECTION?pe(e,{type:m.BlockType.REFERENCE_COLLECTION_PAGE}):a.type===m.BlockType.MIND_MAPPING&&pe(e,{type:m.BlockType.MIND_MAPPING_PAGE})),ee(tr({uuid:e,parentId:t.parentId})),t.first||t.before?ee(Ii({uuid:e,parentId:t.parentId,before:t.before})):ee(Wn({uuid:e,parentId:t.parentId,after:t.after})),i&&lZ([e],{type:m.BlockType.PAGE});const l=t.before||t.after;if(l){const u=s[l];if(u&&u.parentId===u.spaceId){const{permissions:d}=u;d.some(h=>h.type===m.PermissionType.SPACE)?a.permissions.some(h=>h.type===m.PermissionType.SPACE)||ga(e,{type:m.PermissionType.SPACE,role:m.PermissionRole.EDITOR}):pe(e,{permissions:[{type:m.PermissionType.USER,role:m.PermissionRole.EDITOR,userId:K.user.uuid}]})}}Fd(a.uuid,a.parentId)},eN=10,uZ=({onSelect:e})=>{const[t,n]=F.useState(!0),[s,a]=F.useState([]);F.useEffect(()=>{(async()=>{var _;const l=await Ce.editor.querySpaceVisitsHistory(Ut(),0);if(n(!1),typeof l!="object")return;const{results:c,recordMap:u}=l;if(!c||!u)return;const{blocks:d}=u;if(!d)return;ee(Gn.update({blocks:d}));const f=x=>{if(x){const y=d[x];if(Xt(y==null?void 0:y.type))return y}},h=[];let p=0;for(let x=0;p<eN&&x<c.length;x++){const y=(_=c[x])==null?void 0:_.uuid,b=f(y);b&&h.length<eN&&(p++,h.push(b))}const g=h.map(x=>{var y;return{type:$.SEARCH,data:{uuid:x.uuid,title:de(x.data.segments)||Ot(x.type),icon:(y=x.data)==null?void 0:y.icon,type:x.type,backgroundColor:x.backgroundColor}}});a(g)})()},[]);const o=(i,l)=>{const c=s[l];c&&(e==null||e(c.data))};return r.jsx("div",{className:"relative overflow-y-auto h-[300px]",children:r.jsx(ze,{items:s,hasMore:!1,scrollContainerStyle:{top:"52px"},onItemClick:o,customFooter:r.jsxs(r.Fragment,{children:[t&&r.jsxs("div",{className:"relative flex flex-row items-center justify-center h-10",children:[r.jsx(hs,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"正在加载..."})]}),!t&&s.length===0&&r.jsx("div",{className:"text-grey4 text-center mt-[100px]",children:"还没有最近浏览记录"})]})})})},dZ=e=>{const{filterItems:t=[]}=e,{resultList:n,loading:s,hasMore:a,loadMore:o,onInputChange:i,firstTime:l}=Sx({defaultList:e.defaultValue,type:e.searchType,source:e.source,parentId:e.parentId,canSearchWithEmpty:e.canSearchWithEmpty,fileType:e.fileType,spaceId:e.spaceId});F.useEffect(()=>{i(e.keyword)},[e.keyword]),F.useEffect(()=>{e.canSearchWithEmpty&&i("")},[e.canSearchWithEmpty]);const c=(d,f)=>{var p;const h=n[f];h&&((p=e.onSelect)==null||p.call(e,h))},u=F.useMemo(()=>n.map(d=>({type:$.SEARCH,data:{uuid:d.uuid,title:de(d.data.segments)||d.title||Ot(d.type),avatarTitle:d.avatarTitle,icon:d.data.icon,navs:d.navs,type:d.type,backgroundColor:d.backgroundColor,...bn(Bn.moveToItem)}})).filter(d=>!t.includes(d.data.uuid)),[t,n]);return r.jsx("div",{className:B("relative h-[365px]"),children:r.jsx(ze,{items:u,hasMore:a,loadMore:o,scrollContainerStyle:{top:"8px"},onItemClick:c,loadingView:s&&r.jsx(Ck,{}),customFooter:r.jsxs(r.Fragment,{children:[s&&a&&r.jsxs("div",{className:"relative flex flex-row items-center justify-center h-10",children:[r.jsx(hs,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"正在加载..."})]}),!l&&!s&&u.length===0&&r.jsx("div",{className:"relative flex justify-center items-center h-10 text-t2 text-grey4",children:"没有找到相关结果"})]})})})},fZ=e=>{const t=F.useMemo(()=>e.spaceItems.map(s=>({type:$.SEARCH,data:{uuid:s.uuid,title:de(s.data.segments)||s.title||Ot(s.type),avatarTitle:s.avatarTitle,icon:s.data.icon,navs:s.navs,type:s.type,backgroundColor:s.backgroundColor}})),[e.spaceItems]),n=(s,a)=>{var i;const o=e.spaceItems[a];o&&((i=e.onSelect)==null||i.call(e,o))};return t.length===0?null:r.jsx("div",{className:"relative overflow-y-auto h-[300px]",children:r.jsx(ze,{items:t,hasMore:!1,scrollContainerStyle:{top:"52px"},onItemClick:n})})},mZ=e=>{const t=F.useRef(e.onSelect);return t.current=e.onSelect,r.jsx(nB.Provider,{value:t.current,children:r.jsx(bd.Provider,{value:!0,children:r.jsx(tB,{className:"h-[300px] pt-0"})})})};let tB;const ixe=e=>{tB=e},nB=F.createContext(void 0),hZ=()=>F.useContext(nB),pZ=e=>{const t=F.useMemo(()=>K.ui.selectedBlocks.length?Es(K.ui.selectedBlocks):[e.uuid],[e.uuid]),[n,s]=F.useState(""),a=F.useCallback(f=>{s(f)},[]),o=!!n,i=Uw(),l=Ao(),c=Ft(),[u,d]=F.useState([]);return F.useLayoutEffect(()=>{var x;const{role:f,isRestricted:h,permissions:p}=hn(t[0]),{spacePermission:g}=ek(p),_=K.blocks[(x=t[0])!=null?x:""];if(_&&t.every(y=>{const b=K.blocks[y];return b?Xt(b.type):!1})){const y=[];if(f===m.PermissionRole.EDITOR){const E=[],{spaceId:w}=_;i.forEach(k=>{if(!k.permissions)return;const C=w===k.uuid,T={...k,title:C?"个人页面":k.title,avatarTitle:k.title,type:C?"PRIVATE":"SPACE",data:{icon:k.icon}};C?E.unshift(T):E.push(T)}),y.unshift(...E)}const b=g&&g.role!==m.PermissionRole.NONE?f===m.PermissionRole.EDITOR||h&&f===m.PermissionRole.WRITER:f===m.PermissionRole.EDITOR;if(l&&b){const E={...c,title:"空间页面",avatarTitle:c.title,type:"SPACE",data:{icon:c.icon}};y.unshift(E)}d(y)}},[c,t,l,i]),r.jsxs("div",{className:"relative pt-2.5 next-modal w-[360px]",style:{paddingBottom:e.footer?"40px":void 0},children:[r.jsx(xt,{autoFocus:!0,className:"h-8 mx-2.5",...bn(Bn.moveToInput),placeholder:e.placeholder||"搜索页面",onChange:a}),o&&r.jsx(dZ,{...e,keyword:n}),!o&&r.jsx("div",{className:"bg-grey6 h-px w-full mt-3.5"}),!o&&r.jsxs($d,{border:!1,defaultActiveIndex:1,children:[u.length>0&&r.jsx(Zs,{title:"空间",children:r.jsx(fZ,{uuids:t,spaceItems:u,onSelect:f=>{var h;(h=e.onSelect)==null||h.call(e,f)}})}),r.jsx(Zs,{title:"最近使用",children:r.jsx(uZ,{onSelect:f=>{var h;(h=e.onSelect)==null||h.call(e,f)}})}),r.jsx(Zs,{title:"目录",children:r.jsx(mZ,{onSelect:f=>{var h;(h=e.onSelect)==null||h.call(e,f)}})})]}),e.footer]})},gZ=()=>{const e=me(),t=pg(),n=F.useRef(""),s=Qt(),a=Ug(),o=(i,l)=>{const{copyToSpace:c,callback:u,copyAndMove:d}=l||{},f=h=>{let p="";t(async()=>{if(p=Qe({type:h?m.BlockType.FOLDER:m.BlockType.PAGE,data:{segments:mt(n.current)}},{parentId:c||i.spaceId,last:!0}),ga(p,{type:m.PermissionType.USER,userId:s.uuid,role:m.PermissionRole.EDITOR}),p)if(d)await a(kd(Es(K.ui.selectedBlocks)),p,void 0,{effects:g=>{Ri(Es(g),{parentId:p,last:!0}),ye.success("已完成拷贝副本")}});else if(c){const g=fC(i);Qe(g,{parentId:p,last:!0})}else{const g=K.ui.selectedBlocks.length?Es(K.ui.selectedBlocks):[i.uuid];Ri(g,{parentId:p,last:!0})}}),u==null||u(p)};e.modal({content({onCloseModal:h}){const p={onCloseModal:h,onCreate:f,value:n};return r.jsx("div",{className:"next-modal w-[370px]",children:r.jsxs($d,{children:[r.jsx(Zs,{title:"文档页面",children:r.jsx(tN,{...p})}),r.jsx(Zs,{title:"文件夹页面",children:r.jsx(tN,{...p,isFolder:!0})})]})})}})};return F.useCallback(o,[t,a,s.uuid,e])},tN=({onCloseModal:e,onCreate:t,value:n,isFolder:s})=>r.jsxs(r.Fragment,{children:[r.jsx(xt,{autoFocus:!0,className:"h-8 my-4 mx-2.5",placeholder:s?iw:aa,onChange:a=>n.current=a}),r.jsxs("div",{className:"flex mb-4 mr-2.5 justify-end",children:[r.jsx(je,{className:"mr-2.5",onClick:()=>e(),colorType:"secondary",children:"取消"}),r.jsx(je,{colorType:"active",onClick:()=>{t(s),e()},children:"创建并移动"})]})]}),mu=()=>{const e=me(),t=Ug(),n=Kt(),s=ke(),a=pg(),o=Ft(),i=gZ(),l=gt(),c=Un(),u=fi(),d=async h=>{const p=Qe({type:m.BlockType.TEXTAREA},{parentId:h.posBlockId});ha(p);const g=await t(kd(h.ids,h.viewId,h.syncId),p,h.syncId,{effects:h.effects});return Es(g!=null?g:[])};return({popcorn:h,placement:p="right-start",uuid:g,offset:_=[20,0],copyToSpace:x,callback:y,copyAndMove:b,placeholder:E})=>{e.dropdown({popcorn:h,placement:p,offset:_,content({onCloseModal:w}){const{blocks:k,ui:C}=K,{selectedBlocks:T}=C,v=k[g];if(!v)return null;const I=v.type===m.BlockType.FOLDER||v.type===m.BlockType.FILE,j=T.length?Es(T):[v.uuid];return r.jsx(pZ,{placeholder:E,uuid:g,onSelect:async D=>{if(w(),D.type==="SPACE"&&D.uuid!==o.uuid){e.loading({modalId:"move-to-space",title:"正在移动页面，请稍等... "});try{const A=async L=>{try{await u(D.uuid),Sl(D.uuid);const P=await Ce.editor.docsMoveToSpace({spaceId:D.uuid,list:L});if(n("move-to-space"),g===l){const M=P.moveList[0];M&&c.push(`/${M.targetId}`)}}catch(P){n("move-to-space")}};b?a(async()=>{await d({ids:j,posBlockId:v.uuid,syncId:b.syncId,viewId:b.viewId,effects:async L=>{await Za(500),A(Es(L)),ye.success("已完成拷贝副本")}})}):A(j)}catch(A){n("move-to-space")}return}if(j.includes(D.uuid)){ye.warning("不能移动自己所在页面");return}if(D.navs&&D.navs.some(L=>j.some(P=>P===L.uuid))){ye.warning("不能移动自己的子页面");return}const S=K.blocks[D.uuid];if(!S)return;if(Wr(S.type)&&j.some(A=>{var L;return((L=K.blocks[A])==null?void 0:L.type)!==m.BlockType.PAGE})){ye.warning("无法移动至多维表页面");return}if(S.type===m.BlockType.FOLDER&&j.some(A=>{var P,M;const L=(P=K.blocks[A])==null?void 0:P.type;return L===m.BlockType.FILE&&!((M=K.blocks[A])!=null&&M.data.ossName)||L!==m.BlockType.FILE&&L!==m.BlockType.FOLDER})){ye.warning("无法移动至文件夹页面");return}ox((D.navs||[]).map(A=>A.uuid).concat(D.uuid),!0);const R=A=>{if(x){const L=fC(v);Qe(L,{parentId:D.uuid,last:!0})}else D.type==="SPACE"&&A.forEach(L=>{const P=K.blocks[L];P&&!P.permissions.some(M=>M.type===m.PermissionType.SPACE&&M.role!==m.PermissionRole.NONE)&&ga(g,{type:m.PermissionType.SPACE,role:m.PermissionRole.EDITOR,userId:K.user.uuid})}),D.type==="PRIVATE"&&A.forEach(L=>{xd(L,{type:m.PermissionType.SPACE}),ga(L,{type:m.PermissionType.USER,role:m.PermissionRole.EDITOR,userId:K.user.uuid})}),Ri(A,{parentId:D.uuid,last:!0});ee(mn({uuid:v.uuid,patch:{updatedAt:Date.now()},ignoreOp:!0}))};b?await d({ids:j,posBlockId:D.uuid,syncId:b.syncId,viewId:b.viewId,effects:A=>{const L=Es(A);R(L),ye.success("已完成拷贝副本")}}):s(()=>{R(j)}),y==null||y(D.uuid)},searchType:I?"":"page",footer:I&&r.jsx("div",{className:"absolute bottom-0 w-full h-10 bg-white2 border-t border-grey6",children:r.jsxs("div",{className:"flex items-center justify-center h-full animate-hover",onClick:()=>{i(v,{copyToSpace:x,callback:y,copyAndMove:b}),w()},children:[r.jsx(H,{name:"MIcAddNew",size:"middle"}),r.jsx("div",{className:"ml-1.5 text-t2 text-grey3",children:"创建新页面"})]})}),source:"move"})}})}};function nN(e){return e.pathname+(e.search?`?${e.search}`:"")+(e.hash?`#${e.hash}`:"")}const nh=(e,t)=>{const n=new URLSearchParams(location.search);Array.isArray(t)?t.forEach(({key:a,value:o})=>o&&n.set(a,o)):n.set(t.key,t.value);const s=n.toString();return`${e}${s?`?${s}`:""}`},NF=()=>{const e=zx();return F.useCallback(async(t,n)=>{var a;const s=yg(t);if(!(!s&&!(n!=null&&n.ignorePresence))){if(n!=null&&n.onlyViewed)await Ce.infra.completedActivity.raw(t,{viewed:!0});else{if(["abandoned","completed"].includes((s==null?void 0:s.status)||""))return;await Ce.infra.completedActivity.raw(t,{completed:(a=n==null?void 0:n.completed)!=null?a:!0,viewed:!0,createdBy:n==null?void 0:n.createdBy})}e()}},[e])},sh=e=>ae(t=>{if(e)return t.blocks[e]}),sB=()=>F.useCallback(e=>{const t=!!K.user.uuid;if(!t){const n=[{key:ms.callbackPath,value:location.pathname}];e&&(Array.isArray(e)?n.concat(e):n.push(e)),ye.warning("请先登录/注册"),Bs(nh(Rt.login,n))}return t},[]),kp="copy_to_space_uuid",IF=()=>{const e=me(),t=sB();return F.useCallback(n=>{if(!!!K.user.uuid){const o=K.blocks[n];o!=null&&o.createdBy?Ce.editor.queryRecords({requests:[{id:o.createdBy,table:"user"}]}).then(i=>{var c;const l=(c=i.users)==null?void 0:c[o.createdBy||""];l!=null&&l.inviteCode?t({key:ms.inviteCode,value:`${l.inviteCode}`}):t()}):t(),window.sessionStorage.setItem(kp,n);return}const a=document.getElementById("page-header-more")||document.querySelector(".menu_more");a&&e.dropdown({popcorn:a,placement:"bottom-end",offset:[0,16],content:({onCloseModal:o})=>r.jsx(_Z,{uuid:n,onSelectSpace:()=>{o()}})})},[t,e])},_Z=({uuid:e,onSelectSpace:t})=>{const n=sh(e),s=mu(),a=Um(),o=F.useRef(""),i=Un(),l=y2(),c=Qt(),u=NF(),d=mC(),f=fi();F.useEffect(()=>{Pm().then(()=>{y2().length===0?(ye.warning("请先创建空间"),window.sessionStorage.setItem(kp,e),i.push(nh(Rt.create,{key:ms.callbackPath,value:location.pathname}))):window.sessionStorage.removeItem(kp)})},[i,e]);const h=F.useMemo(()=>{const p=async(_,x)=>{if(!n||o.current)return;if(Nn(`${x.uuid}_template_id`,n.uuid),t(),n.type===m.BlockType.FILE){const E=_.currentTarget;a(x.uuid).then(()=>{s({uuid:e,popcorn:E,copyToSpace:x.uuid,callback(w){oa(()=>{ib(x.uuid,m.BlockType.FILE,w),u(Ae.LIMITED_TIME_SHARE_COPY,{createdBy:n.createdBy,ignorePresence:!0})})}})})}else{await f(x.uuid),ee(Ia({block:{spaceId:x.uuid,type:"SPACE",data:{icon:x.icon},...x},ignoreOp:!0}));const E=fC(n);let w=E.type;w===m.BlockType.COLLECTION_VIEW?w=m.BlockType.COLLECTION_VIEW_PAGE:w===m.BlockType.REFERENCE_COLLECTION?w=m.BlockType.REFERENCE_COLLECTION_PAGE:w===m.BlockType.MIND_MAPPING&&(w=m.BlockType.MIND_MAPPING_PAGE),o.current=ye.loading("正在拷贝...");const k=Qe({...E,data:{...E.data,pageFixedWidth:!!E.data.pageFixedWidth},type:w},{parentId:x.uuid,last:!0},!1,!1);ga(k,{type:m.PermissionType.USER,userId:c.uuid,role:m.PermissionRole.EDITOR}),ee(Er()),oa(async()=>{try{const C=await d({list:[{uuid:e,targetId:k,isDescendant:!0}]});ib(x.uuid,E.type,k,o.current),u(Ae.LIMITED_TIME_SHARE_COPY,{createdBy:n.createdBy,ignorePresence:!0}),C.code===200?(ib(x.uuid,E.type,k),u(Ae.LIMITED_TIME_SHARE_COPY,{createdBy:n.createdBy,ignorePresence:!0})):C.code===412&&(ha(k),ee(Er()))}finally{ye.closeMessage(o.current),o.current=""}})}const y=tx.parse(location.search);y.from==="website"&&y.event==="copy"?ce.event("copy_template",{is_from:"home_template",template_id:n.uuid}):ce.event("copy_from_share",{page_id:e})},g=Bm(l.filter(_=>_.permissions),"uuid");return[{type:$.BLOCK_TEXT,data:{title:"选择一个拷贝到的空间"}},...g.map(_=>({type:$.OPERATION,data:{onClick:x=>p(x,_),content:r.jsxs("div",{className:"flex items-center w-full",children:[r.jsx(Ps,{className:"flex-shrink-0 !text-t3-medium w-[26px] h-[26px]",name:_.title,icon:_.icon,color:_.backgroundColor}),r.jsx("div",{className:"ml-2 text-t2 text-ellipsis",children:_.title})]})}}))]},[l,n,d,c.uuid,f,a,s,t,u,e]);return r.jsx(ze,{className:"py-2 w-60 max-h-[50vh] overflow-y-auto next-modal",items:h})},ib=(e,t,n,s)=>{const a=window.innerWidth<=640,o=ye.success({key:s,duration:5e3,content:r.jsxs("div",{className:"flex items-center justify-between w-52",children:[r.jsx("div",{className:"text-t2",children:"拷贝成功"}),a?r.jsx("div",{onClick:()=>{const i=`flowus://NoteActivity?uuid=${n}&type=${t}&spaceId=${e}`;window.open(i,"_blank"),ye.closeMessage(o)},className:"text-t4 text-active_color animate-click",children:"App 中查看"}):r.jsx("div",{onClick:()=>{Bs(`${dd()}/${n}`),ye.closeMessage(o)},className:"text-t4 text-active_color animate-click",children:"跳转查看"})]})})},zg=e=>ae(({pageMetas:t})=>t[e]),xC=(e,t)=>{const n=me(),s=gt(),a=sB();return F.useCallback(async()=>{if(!a())return;const o={report:"complain",justice:"appeal"};await Ce.editor.shareCheck(e||s,o.report)===!1?n.modal({content:({onCloseModal:l})=>r.jsx(bk,{success:!1,type:"report",onCloseModal:l})}):n.modal({content:({onCloseModal:l})=>r.jsx(D6,{blockType:t==null?void 0:t.blockType,type:"report",uuid:e||s,onCloseModal:l})})},[a,n,t==null?void 0:t.blockType,s,e])},sN=window.innerWidth<=640,rB=e=>{const t=gt(),n=_e(e,["data"],["segments"]),{allowDuplicate:s,shared:a,roleWithoutPublic:o,illegal:i}=it(e),l=Qt(),c=qx(),u=ht(),d=Kt(),f=xC(e),h=IF(),p=I6(),g=zg(t),_=Yd(t),x=p||(g==null?void 0:g.tag)==="NO_PERMISSION"||(g==null?void 0:g.tag)==="NOT_FOUND"||i||_,y=!!l.uuid;return F.useMemo(()=>{if(!u||!n)return[];const b=!!(o!==m.PermissionRole.NONE&&Xt(n.type)),E=[{type:$.CUSTOM_RENDER,render:()=>y?r.jsxs("div",{className:"mx-2 flex h-10 items-center justify-between px-2",children:[r.jsxs("div",{className:"flex w-3/5 items-center",children:[r.jsx(Ps,{className:"!text-t4 mr-2 h-5 w-5 flex-shrink-0 rounded-full text-white",name:ss(l.uuid,l.nickname),color:l.backgroundColor,icon:{type:"upload",value:l.avatar},imgClassName:"rounded-full"}),r.jsx("span",{className:"text-grey3 text-t2 text-ellipsis",children:l.nickname})]}),sN?null:r.jsx("div",{className:"text-active_color text-t4-bold flex-shrink-0",onClick:()=>{d(Xe.PAGE_HEADER_MENU_LIST),Bs(dd())},children:"回到我的空间"})]}):r.jsxs("div",{className:"mx-2 flex h-10 cursor-pointer items-center px-2",onClick:()=>{d(Xe.PAGE_HEADER_MENU_LIST),Bs(nh(Rt.login,{key:ms.callbackPath,value:location.pathname}))},children:[r.jsx(H,{size:"middle",name:"MIcSettingsAccount",className:"mr-2"}),r.jsx("span",{className:"text-t2 text-grey3",children:"登录/注册"})]})}];if(y&&b){const w=sN?{type:$.OPERATION,data:{icon:r.jsx("img",{src:Dn.logo,alt:"logo",className:"h-[22px] w-[22px] rounded"}),title:"在 App 中查看/编辑",onClick:()=>{const k=document.createElement("a");k.href=`flowus://NoteActivity?uuid=${n.uuid}&type=${n.type}&spaceId=${n.spaceId}`,k.target="_blank",document.body.appendChild(k),k.click(),document.body.removeChild(k)}}}:{type:$.OPERATION,data:{icon:"IcMenuEditor",title:"进入空间编辑/查看",onClick:()=>{Bs(`${dd()}/${t}`)}}};E.push({type:$.LINE,disableClick:!0},w)}return i||(E.push({type:$.LINE,disableClick:!0},{type:$.OPERATION,data:{icon:"IcUrl",title:"复制分享链接",onClick:()=>{ce.event("share_copylink",{is_share:a}),on(`${window.location.href}
${id}${de(n.data.segments)}`)}}}),s&&!i&&E.push({type:$.OPERATION,data:{icon:"IcMenuDuplicate",title:"拷贝到我的空间",onClick:()=>{ce.event("copytomyspace",{page_id:e}),h(e)}}}),x||E.push({type:$.LINE,disableClick:!0},{type:$.OPERATION,data:{icon:"IcMenuReport",title:"举报违法信息",onClick:f}})),y&&E.push({type:$.LINE,disableClick:!0},{type:$.OPERATION,data:{icon:"MIcSettingsLogout",title:"退出登录",onClick:()=>{ce.logout(),c()}}}),!i&&s&&E.push({type:$.LINE,disableClick:!0},{type:$.CUSTOM_RENDER,render(){return r.jsxs("div",{className:"text-grey3 mx-4 mt-5 mb-3 flex items-center",children:[r.jsx(H,{name:"IcShareDanger",size:"small",className:"mr-1"}),r.jsx("span",{className:"text-t4",children:"允许拷贝副本、下载和打印"})]})}}),E},[u,n,o,y,i,s,l.uuid,l.nickname,l.backgroundColor,l.avatar,d,t,x,a,h,e,f,c])},rh=({logoImage:e,className:t="",description:n})=>{const s=gt(),a=_e(s,[]),o=Od(a==null?void 0:a.spaceId),i=ht(),l=ui(a==null?void 0:a.spaceId),c=Lr();e||(e=c?Dn.logoWhiteWide:Dn.logoBlackWide);const u=F.useMemo(()=>l&&i&&o.uuid?r.jsx(Ps,{name:o.title,color:o.backgroundColor,icon:o.icon,iconSize:18}):r.jsx("img",{src:e,alt:"logo",className:"h-[18px]"}),[l,i,e,o]);return r.jsxs("a",{href:A1||un?"javascript:void(0);":Sn(),className:B("flex-shrink-0 flex items-center mr-2 cursor-pointer",t),onClick:()=>{un&&Bs(Rt.main)},children:[u,n]})},xZ=e=>{const t=_e(e,[]),n=Mg();return t?n(t.uuid):[]},aB=({isPreviewPage:e,uuid:t,downloadUrl:n,pageScene:s,onClose:a})=>{var W,z,Q,Z;const o=nk(t),i=mu(),l=Ve(t),c=_e(t,["data"],["segments","pdfAnnotation","size"]),u=Cr(),{illegal:d,allowDuplicate:f}=it(t),{blocks:h}=le(),{role:p}=it((W=c==null?void 0:c.parentId)!=null?W:""),g=h[(z=c==null?void 0:c.parentId)!=null?z:""],_=(c==null?void 0:c.type)===m.BlockType.PDF_ANNOTATION,x=me(),y=F.useRef();let b=d?rs:de(c==null?void 0:c.data.segments);_&&(b="图片标注.png");const{extName:E}=sn(b),w=xZ(t);if(_){const te=h[(Q=c.parentId)!=null?Q:""];te&&w.push(te)}const k=rB(t),C=Og(t),T=IF(),v=ht(),I=s===Tt.TEMPLATE,j=Yd(t)||I,D=Lk(),S=Pk&&!D,R=Hr.image.test(E),A=F.useCallback(()=>{window.open(`/preview/${t}`)},[t]),L=F.useCallback(()=>{e||i({popcorn:y.current,uuid:t})},[e,i,t]),P=F.useCallback(()=>{on(`${Sn()}/preview/${t}`)},[t]),M=async()=>{if(R){const te=await VG(t);te?Tc(te):ye.error("下载资源失败")}else Tc(n)},U=F.useMemo(()=>v?k:d?[{type:$.OPERATION,data:{icon:"IcMenuDelete",title:"彻底删除",onClick:()=>C()}}]:[{type:$.OPERATION,data:{icon:"IcMenuOpenNew",title:"新窗口打开",onClick:A}},{type:$.OPERATION,isHidden:l||p!==m.PermissionRole.EDITOR,data:{icon:"IcUrl",title:"拷贝链接",onClick:P}},{type:$.OPERATION,isHidden:l||g&&p!==m.PermissionRole.EDITOR,data:{icon:"IcMenuMove",rightText:`${Gt}+Shift+P`,title:"移动到",onClick:L}}],[v,k,d,A,l,p,P,g,L,C]),V=F.useCallback(te=>{y.current=te.currentTarget,x.dropdown({popcorn:te.currentTarget,placement:"bottom-end",offset:[0,10],content:({onCloseModal:re})=>r.jsx(ze,{className:"py-2 rounded next-modal w-52",items:U,onItemClick:()=>re()})})},[U,x]);return c?r.jsxs("div",{className:B("absolute top-0 left-0 z-20 flex justify-between w-screen min-h-[55px] bg-black-base/40 backdrop-blur-sm",w.length===0?"items-center":"items-start"),children:[r.jsxs("div",{className:"flex h-full",children:[v&&!u&&r.jsx(rh,{logoImage:Dn.logoWhiteWide,className:"ml-4 h-[18px] self-center border-r pr-4 sm:pr-1"}),r.jsxs("div",{className:B("flex",{"relative top-2":w.length>0,"pl-20":S}),children:[!e&&K.blocks[c.parentId]&&!u&&r.jsx(H,{name:"IcArrowBack",className:B("animate-click text-white sm:ml-0",v?"ml-2":"ml-3"),size:"middle",onClick:a}),r.jsxs("div",{className:"flex px-3 text-white sm:ml-1",children:[r.jsx(H,{name:pa(E),size:"middle",className:"flex-shrink-0 mr-2"}),r.jsxs("div",{className:"flex flex-col justify-between w-[calc(100vw-450px)] sm:w-[calc(100vw-250px)]",children:[r.jsx(Bl,{fileName:b,className:"text-t2",addonAfter:u?null:r.jsx("span",{className:"ml-2 text-grey3",children:es(_?(Z=c.data.pdfAnnotation)==null?void 0:Z.size:c.data.size)})}),r.jsx(lg,{navs:w,className:"text-white",placement:"bottom",untitled:iw})]})]})]})]}),r.jsxs("div",{className:"flex items-center self-center flex-shrink-0 mr-4",children:[v&&f&&!d&&!j&&r.jsx(je,{className:"text-t2-medium mr-8 sm:mx-4 flex-shrink-0",onClick:()=>{ce.event("copytomyspace",{page_id:t}),T(t)},children:"拷贝到"}),!v&&!d&&!j&&r.jsx(vg,{showType:"button",className:"mr-4",uuid:t,color:"text-white"}),f&&!j&&!d&&r.jsx(Fe,{popup:"下载",className:"flex items-center justify-center mr-4 animate-hover",onClick:()=>{M()},children:r.jsx(H,{name:"IcMenuDownload",className:"text-white",size:"middle",...bn(Bn.menuDown)})}),!v&&!d&&!I&&r.jsx(oF,{uuid:t,style:{color:o?to.yellow:to.white},className:B(!e&&"mr-4")}),!location.pathname.includes("preview")&&r.jsx(H,{name:"IcMore",className:"menu_more text-white",size:"middle",...bn(Bn.menuMore),onClick:V})]})]}):null},oB=e=>{var g;const{overlayProps:t,previewId:n,hiddenImageToolbar:s}=e,a=Vn(),o=t.images[t.index],i=t.images.length!==0,l=_e(n,[]),c=!!((g=o==null?void 0:o.src)!=null&&g.startsWith("data:")),u=()=>{if(t.index===0){ye.warning("当前为第一张");return}t.onIndexChange(t.index-1)},d=()=>{if(t.index+1===t.images.length){ye.warning("当前为最后一张");return}t.onIndexChange(t.index+1)},f=(_,x)=>{const y=x.metaKey||x.ctrlKey?.1:.5;_==="in"?t.onScale(t.scale-y):t.onScale(t.scale+y)},h=_=>{_.metaKey||_.ctrlKey?t.onRotate(t.rotate+45):t.onRotate(t.rotate+90)},p=()=>{if(!(o!=null&&o.src))return;const _=M7(o.src),x=URL.createObjectURL(_);Tc(x,he().format("YYYY-MM-DD-HH-mm-ss"))};return r.jsxs(r.Fragment,{children:[l?r.jsx(aB,{onClose:t.onClose,uuid:l.uuid,downloadUrl:`${o==null?void 0:o.src}`,pageScene:a}):r.jsx("div",{className:"fixed top-4 right-4 z-20 animate-click text-grey3",onClick:t.onClose,children:"关闭"}),n&&uC(n)&&r.jsx("div",{className:"absolute z-10 w-full top-[55px] h-14",children:r.jsx(dC,{uuid:n,onDelete:t.onClose})}),r.jsxs(r.Fragment,{children:[i&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed z-10 left-0 h-full flex items-center",children:r.jsx(Fe,{popup:"上一张",children:r.jsx(H,{name:"MIcBtnPre",size:"xxxlarge",onClick:u})})}),r.jsx("div",{className:"fixed z-10 right-0 h-full flex items-center",children:r.jsx(Fe,{popup:"下一张",children:r.jsx(H,{name:"MIcBtnNext",size:"xxxlarge",onClick:d})})})]}),r.jsxs("div",{className:"fixed z-10 flex items-center px-1 py-1 -translate-x-1/2 bg-black-base/70 left-1/2 bottom-5 rounded backdrop-blur-sm",children:[!s&&r.jsxs(r.Fragment,{children:[r.jsx(Js,{onClick:_=>f("in",_),size:40,className:"mr-1 animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(H,{name:"MIcZoomIn",size:"large"})}),r.jsx(Js,{size:40,onClick:_=>f("out",_),className:"mr-1 animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(H,{name:"MIcZoomOut",size:"large"})}),r.jsx(Js,{size:40,onClick:h,className:"mr-1 text-grey3-base animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(H,{name:"IcMenuRelink",size:"large",className:"-scale-x-100"})}),c&&r.jsx(Js,{size:40,onClick:p,className:"mr-1 text-grey3-base animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(H,{name:"IcMenuDownload",size:"large",className:"-scale-x-100"})})]}),r.jsx(Js,{size:40,onClick:t.onClose,className:"text-grey3-base animate-hover hover:bg-white1/10 dark:hover:bg-grey6",children:r.jsx(H,{name:"IcBannerClose",size:"xxlarge"})})]})]})]})},FZ=()=>{const[e,t]=F.useState(!1),[n,s]=F.useState(0),[a,o]=F.useState([]),[i,l]=F.useState([]),[c,u]=F.useState([]),d=!!c.length,f=()=>{s(0),t(!1),u([]),o([...i])},h=F.useCallback(x=>{const y=a.findIndex(b=>b.key===x.uuid);y>=0?s(y):(u([{key:x.uuid,src:x.src}]),s(0)),t(!0)},[a]),p=(x,y)=>{(d?u:o)(E=>{const w=da(E),k=w.findIndex(T=>T.key===y),C=w[k];return Object.assign(C,{src:x}),w})};F.useEffect(()=>{e?document.body.classList.add("overscroll-x-contain"):document.body.classList.remove("overscroll-x-contain")},[e]);const g=x=>{d?u(x):(o(x),l(x))},_=F.useMemo(()=>d?c:a,[a,c,d]);return{index:n,visible:e,images:_,setImages:g,onClose:f,setIndex:s,openImagePreview:h,onLoad:p}},ah=()=>Nx(Cp,e=>e.openImagePreview),Cp=ag(FZ),Wg=({children:e,uuid:t})=>t?r.jsxs(Cp,{children:[r.jsx(bZ,{uuid:t}),e]}):r.jsx(Cp,{children:r.jsx(yZ,{uuid:t,children:e})}),yZ=({children:e})=>r.jsx(JM,{minDragScale:.5,onVisibleChange:t=>{Ye({$isOpenImagePreview:t})},maskOpacity:.8,speed:()=>200,maskClosable:!0,loop:!1,bannerVisible:!1,photoClosable:!1,loadingElement:r.jsx(hs,{}),overlayRender:t=>r.jsx(oB,{overlayProps:t}),children:e}),bZ=F.memo(({uuid:e})=>{const t=fw(),n=rD(),{index:s,visible:a,images:o,setImages:i,onClose:l,setIndex:c}=ws(Cp),u=o[s],d=PA({uuid:e,pageId:e});XM((h,p,g)=>{if(!rn(p==null?void 0:p[0],g==null?void 0:g[0])){const x=d.map(b=>({src:void 0,key:b}));i(x),x[s]||l()}},[d,i]);const f=()=>{if(un)return;[...document.getElementsByClassName("PhotoView__Photo")].forEach(p=>{const{src:g}=p;gc(g)||(p.src="",p.referrerPolicy="no-referrer",p.src=g)})};return F.useEffect(()=>{a&&xs(200).then(f)},[a]),F.useEffect(()=>{f()},[s]),r.jsx(r.Fragment,{children:r.jsx(QM,{minDragScale:.5,index:s,visible:a,images:o.map(h=>({...h,width:h.src?void 0:t,height:h.src?void 0:n,render:p=>{let g=r.jsx(r.Fragment,{});return(u==null?void 0:u.key)!==h.key&&(g=r.jsx(hs,{})),g=r.jsx(EZ,{...p,uuid:h.key}),r.jsx(wZ,{...p,children:g})}})),brokenElement:r.jsx(R6,{}),onClose:l,maskOpacity:.8,speed:()=>200,maskClosable:!0,loop:!1,bannerVisible:!1,onIndexChange:c,loadingElement:r.jsx(hs,{}),overlayRender:h=>r.jsx(oB,{hiddenImageToolbar:!(u!=null&&u.src),previewId:u==null?void 0:u.key,overlayProps:h})})})}),EZ=e=>{const{uuid:t}=e,{illegal:n}=it(t),{imageUrl:s,loading:a}=Vi(n?"":t,{isImage:!0});return n?r.jsx(Qx,{className:"p-0",uuid:t}):r.jsxs(r.Fragment,{children:[r.jsx(hs,{}),!a&&s&&r.jsx(kZ,{item:{uuid:t,src:s}})]})},wZ=e=>{var c,u;const{attrs:t,scale:n,children:s}=e,a=fw(),i=(((u=Number((c=t.style)==null?void 0:c.width))!=null?u:0)-a)/a,l=n===1?n+i:1+i;return r.jsx("div",{...t,children:r.jsx("div",{style:{transform:`scale(${l})`,width:a,transformOrigin:"0 0"},children:r.jsx("div",{className:"w-screen h-screen flex items-center justify-center",children:s})})})},kZ=e=>{const{onLoad:t}=ws(Cp),{item:n}=e,[s,a]=F.useState(n==null?void 0:n.src);F.useEffect(()=>{const i=e2.get(s);i?t(i,n.uuid):gc(s)&&t(n.src,n.uuid)},[]);const o=()=>{if(!n.src.startsWith("blob")){const i=uj(n.src);fj(i,{callback:l=>{const c=URL.createObjectURL(l.blob);t(c,n.uuid),a(c)},onError:()=>{t(n.src,n.uuid)}})}};return r.jsx("img",{style:{width:0,height:0,opacity:0},src:s,onLoad:()=>{t(n.src,n.uuid)},referrerPolicy:gc(s)?"strict-origin-when-cross-origin":"no-referrer",onError:o})},CZ=()=>{const e=zs();return F.useCallback(t=>{var c,u,d,f,h;const n=new Set,s=new Set;t.forEach(p=>{n.add(p.recordId),s.add(p.propertyId)});const a=t[0];if(!a)return;const o=ls(a.recordId);if(!o)return;const i=(d=(u=(c=K.blocks[o])==null?void 0:c.data.schema)==null?void 0:u[a.propertyId])==null?void 0:d.type,l=(h=(f=K.blocks[a.recordId])==null?void 0:f.data.collectionProperties)==null?void 0:h[a.propertyId];i===m.CollectionSchemaType.CHECKBOX?de(l).toUpperCase()==="YES"&&e([...n],[...s],"NO"):e([...n],[...s],"")},[e])},TZ=e=>e instanceof DOMException&&e.name==="AbortError",rN=(e,t)=>{try{return JSON.parse(e)}catch(n){return t}},Du=(e,t,n)=>{if(e.has(t))return e.get(t);const s=n();return e.set(t,s),s},aN=(e,t,n)=>{const s=Du(e,t,()=>[]);return s.includes(n)?!1:(s.push(n),!0)},oN=(e,t,n)=>{const s=Du(e,t,()=>[]),a=s.indexOf(n);return a===-1?!1:(s.splice(a,1),s.length===0&&e.delete(t),!0)},vZ={}.VITE_WS_URL||`wss://${location.host}/ws/webSocket/`,NZ=300,IZ=25e3,jZ=2e4,DZ=3e5,iN=4001,lN=4002;class cN extends Error{constructor(n){super(`WebSocket closed with code: ${n}`);q(this,"code");this.code=n}}class SZ{constructor(t={}){q(this,"userIdAndTokenReady");q(this,"setUserIdAndTokenReady");q(this,"userId");q(this,"token");q(this,"disposed",!1);q(this,"disposer");q(this,"options");q(this,"pageObservers",new Map);q(this,"spaceViewObservers",new Map);q(this,"collectionViewObservers",new Map);q(this,"spacePageObservers",new Map);q(this,"presencePageObservers",new Map);q(this,"sharedPagesObservers",new Map);q(this,"notificationsObservers",[]);q(this,"scheduleCommitObservers",g_);q(this,"scheduleCommitRequest",g_);q(this,"retryCount",0);q(this,"requestData",[]);q(this,"throttledDispatchRecover",fs(this.dispatchRecover.bind(this),1500,{leading:!1,trailing:!0}));q(this,"lastPresentData");this.userIdAndTokenReady=new Promise(n=>{this.setUserIdAndTokenReady=(s,a)=>{this.userId=s,this.token=a,n()}}),this.options={...t,heartbeatIntervalInMs:IZ,heartbeatTimeoutInMs:jZ,maxRetryIntervalInMs:DZ},Xi.ifvisible.wakeup(),Xi.ifvisible.setIdleDuration(NZ),this.lifecycle()}setUserIdAndToken(t,n){this.setUserIdAndTokenReady(t,n)}dispose(){var t;this.disposed=!0,(t=this.disposer)==null||t.call(this),this.disposer=void 0}async lifecycle(){await this.userIdAndTokenReady;const t=async()=>{(!Xi.ifvisible.now()||!$r.online)&&await new Promise(s=>{const a=()=>{Xi.ifvisible.now()&&$r.online&&(o.unsubscribe(),Xi.ifvisible.off("wakeup",a),s())},o=$r.onStatusChange.subscribe(a);Xi.ifvisible.on("wakeup",a)})};let n=!1;for(;!this.disposed;){try{await this.startNewSession(n)}catch(s){s instanceof cN&&s.code===lN||console.error(s)}if(n=!0,!Xi.ifvisible.now()||!$r.online)await t();else{const s=Math.min(1e3*Math.pow(2,this.retryCount),this.options.maxRetryIntervalInMs);this.retryCount+=1,await Za(s),await t()}}}async ping(t){t.send("PING"),await new Promise((n,s)=>{const a=()=>{clearTimeout(i),t.removeEventListener("message",o),t.removeEventListener("close",a)},o=l=>{l.data==="PONG"&&(a(),n())};t.addEventListener("message",o),t.addEventListener("close",a);const i=setTimeout(()=>{a(),s(new Error("Timeout"))},this.options.heartbeatTimeoutInMs)})}async request(t,n,s){const a=qe(),o=JSON.stringify({requestId:a,type:n,data:s});return t.send(o),new Promise((i,l)=>{const c=()=>{t.removeEventListener("message",u),t.removeEventListener("close",c)},u=d=>{const f=rN(d.data);this.isResponsePacket(f)&&f.requestId===a&&(c(),f.status===200?i(f.data):l(new Error(`Response with status: ${f.status}`)))};t.addEventListener("message",u),t.addEventListener("close",c)})}isResponsePacket(t){return typeof t=="object"&&t!==null&&t.type==="response"}isNotificationPacket(t){return typeof t=="object"&&t!==null&&t.type==="notification"}setupObservers(t){const n=new Set,s=new Set,a=new Set,o=new Set,i=new Set;let l=!1;this.scheduleCommitObservers=fs(async()=>{if(t.readyState!==WebSocket.OPEN)return;const u=[];for(const d of this.spacePageObservers.keys())n.has(d)||(n.add(d),u.push(this.request(t,"/subscribe",{channel:`/spaces/${d}`})));for(const d of n)this.spacePageObservers.has(d)||u.push(this.request(t,"/unsubscribe",{channel:`/spaces/${d}`}).then(()=>{n.delete(d),this.scheduleCommitObservers()}));for(const d of this.pageObservers.keys())s.has(d)||(s.add(d),u.push(this.request(t,"/subscribe",{channel:`/pages/${d}`})));for(const d of s)this.pageObservers.has(d)||u.push(this.request(t,"/unsubscribe",{channel:`/pages/${d}`}).then(()=>{s.delete(d),this.scheduleCommitObservers()}));for(const d of this.spaceViewObservers.keys())a.has(d)||(a.add(d),u.push(this.request(t,"/subscribe",{channel:`/spaceViews/${d}`})));for(const d of a)this.spaceViewObservers.has(d)||u.push(this.request(t,"/unsubscribe",{channel:`/spaceViews/${d}`}).then(()=>{a.delete(d),this.scheduleCommitObservers()}));for(const d of this.presencePageObservers.keys())o.has(d)||(o.add(d),u.push(this.request(t,"/subscribe",{channel:`/presences/${d}`})));for(const d of o)this.presencePageObservers.has(d)||u.push(this.request(t,"/unsubscribe",{channel:`/presences/${d}`}).then(()=>{o.delete(d),this.scheduleCommitObservers()}));for(const d of this.sharedPagesObservers.keys())i.has(d)||(i.add(d),u.push(this.request(t,"/subscribe",{channel:`/spaces/${d}/userSharedPages/${this.userId}`})));for(const d of i)this.sharedPagesObservers.has(d)||u.push(this.request(t,"/unsubscribe",{channel:`/spaces/${d}/userSharedPages/${this.userId}`}).then(()=>{i.delete(d),this.scheduleCommitObservers()}));this.notificationsObservers.length>0&&(l||(l=!0,u.push(this.request(t,"/subscribe",{channel:`/users/${this.userId}/notification`})))),this.notificationsObservers.length===0&&l&&u.push(this.request(t,"/unsubscribe",{channel:`/users/${this.userId}/notification`}).then(()=>{l=!1,this.scheduleCommitObservers()})),await Promise.all(u)},500);const c=u=>{const d=rN(u.data);this.isNotificationPacket(d)&&this.dispatchNotification(d)};return t.addEventListener("message",c),this.scheduleCommitObservers(),()=>{this.scheduleCommitObservers=g_,t.removeEventListener("message",c)}}setupHeartbeat(t){let n;return n=setInterval(async()=>{try{await this.ping(t)}catch(s){TZ(s)||t.close(iN)}},this.options.heartbeatIntervalInMs),()=>{clearInterval(n),n=void 0}}setupRequestSender(t){return this.scheduleCommitRequest=fs(async()=>{if(t.readyState!==WebSocket.OPEN)return;const n=[],s=this.requestData.slice(0);this.requestData=[];for(const a of s)n.push(this.request(t,"/send",a));await Promise.all(n)},0),this.scheduleCommitRequest(),()=>{this.scheduleCommitRequest=g_}}setupRecover(t){let n=!1;const s=()=>{n=!0},a=()=>{n&&this.throttledDispatchRecover()},o=()=>{t.close(lN)};return window.addEventListener("offline",s),window.addEventListener("online",a),Xi.ifvisible.on("idle",o),()=>{window.removeEventListener("offline",s),window.removeEventListener("online",a),Xi.ifvisible.off("idle",o)}}async startNewSession(t=!1){const n=new WebSocket(vZ+this.token);this.disposer=()=>{n.close()},await new Promise(s=>{const a=()=>{n.removeEventListener("open",a),s()};n.addEventListener("open",a)}),await this.ping(n),this.retryCount=0,t&&this.throttledDispatchRecover(),await new Promise((s,a)=>{const o=[],i=l=>{n.removeEventListener("close",i);let c=o.pop();for(;c;)c(),c=o.pop();l.code===iN?a(new Error("Heartbeat timeout")):a(new cN(l.code))};n.addEventListener("close",i),o.push(this.setupObservers(n)),o.push(this.setupHeartbeat(n)),o.push(this.setupRecover(n)),o.push(this.setupRequestSender(n))})}dispatchRecover(){const t=this,n=function*(a){for(const o of a.values())yield*o},s=function*(){yield*n(t.pageObservers),yield*n(t.spaceViewObservers),yield*n(t.collectionViewObservers);for(const[,a]of t.spacePageObservers)yield*n(a);yield*n(t.presencePageObservers),yield*n(t.sharedPagesObservers),yield*t.notificationsObservers};for(const a of s())a()}dispatchNotification(t){var s,a,o,i,l,c,u,d;if({}.VITE_DISABLE_SYNC||!t.data||t.senderId===d2)return;const n=f=>{for(const h of f)h(t)};if(t.data.action!=="version")if(t.table==="space"){const f=(s=Du(this.spacePageObservers,t.data.id,()=>new Map).get(null))!=null?s:[];n(f)}else if(t.table==="collectionView"){const f=(a=this.collectionViewObservers.get(t.data.id))!=null?a:[];n(f)}else if(t.table==="block"){const f=(o=this.pageObservers.get(t.data.pageId))!=null?o:[];n(f);const h=[...(i=Du(this.spacePageObservers,t.data.spaceId,()=>new Map).get(t.data.pageId))!=null?i:[],...(l=Du(this.spacePageObservers,t.data.spaceId,()=>new Map).get(null))!=null?l:[]];n(h)}else if(t.table==="spaceView"){const f=(c=this.spaceViewObservers.get(t.data.id))!=null?c:[];n(f)}else if(t.channel.endsWith("/notification")){const{notificationsObservers:f}=this;n(f)}else{if(/presences/.test(t.channel)){const h=t.channel.substring(11,t.channel.length),p=(u=this.presencePageObservers.get(h))!=null?u:[];n(p)}const f=t.channel.match(/\/spaces\/([^/]*)\/userSharedPages\//);if(f&&f[1]){const h=f[1],p=(d=this.presencePageObservers.get(h))!=null?d:[];n(p)}}}subscribePageBlocks(t,n){return this.addToObservers(this.pageObservers,t,n),()=>{this.removeFromObservers(this.pageObservers,t,n)}}subscribeSpaceView(t,n){return this.addToObservers(this.spaceViewObservers,t,n),()=>{this.removeFromObservers(this.spaceViewObservers,t,n)}}subscribeCollectionView(t,n){return this.addToObservers(this.collectionViewObservers,t,n),()=>{this.removeFromObservers(this.collectionViewObservers,t,n)}}subscribeChildPages(t,n,s){const a=Du(this.spacePageObservers,t,()=>new Map);return aN(a,n,s),this.scheduleCommitObservers(),()=>{const o=Du(this.spacePageObservers,t,()=>new Map);oN(o,n,s),o.size===0&&this.spacePageObservers.delete(t),this.scheduleCommitObservers()}}subscribePresencePages(t,n){return this.addToObservers(this.presencePageObservers,t,n),()=>{this.removeFromObservers(this.presencePageObservers,t,n)}}sendPresenceData(t,n,s){if(this.lastPresentData&&this.lastPresentData.pageId===n&&this.lastPresentData.body.blockId===s.blockId&&s.activityTime-this.lastPresentData.body.activityTime<5*60*1e3&&s.present===this.lastPresentData.body.present)return;const a={channel:`/presences/${n}`,userId:t,body:s,senderId:d2};this.lastPresentData={...a,pageId:n},this.sendRequestData(a)}subscribeSharedPages(t,n){return this.addToObservers(this.sharedPagesObservers,t,n),()=>{this.removeFromObservers(this.sharedPagesObservers,t,n)}}subscribeNotifications(t){return this.notificationsObservers.push(t),()=>{const n=this.notificationsObservers.indexOf(t);n>=0&&this.notificationsObservers.splice(n,1)}}sendRequestData(t){this.requestData.push(t),this.scheduleCommitRequest()}addToObservers(t,n,s){aN(t,n,s),this.scheduleCommitObservers()}removeFromObservers(t,n,s){oN(t,n,s),this.scheduleCommitObservers()}}const RZ=F.createRef(),jF=()=>eD(RZ,()=>{const e=new SZ,t=U1.subscribe(()=>{const n=U1.getState().user.uuid,s=yx();n&&(s!=null&&s.startsWith("ey"))&&(t(),e.setUserIdAndToken(n,s))});return e}),ef=()=>{const e=jF();return F.useCallback((t,n,s=!0)=>{if(ht())return;const{planType:a}=Tn();if(a===Et.freePersonal||a===Et.personal)return;const o=Date.now();if(!s){e.sendPresenceData(K.user.uuid,t,{present:!1,blockId:n,activityTime:o});return}if(!n){e.sendPresenceData(K.user.uuid,t,{present:!0,blockId:"",activityTime:o});return}K.blocks[n]&&e.sendPresenceData(K.user.uuid,t,{present:!0,blockId:n,activityTime:o})},[e])},iB=100,FC=()=>{const e={id:0};return{rafY:e,autoScrollY:({y:n,container:s,threshold:a=iB,offset:o})=>{var d,f;const i=s.getBoundingClientRect(),l=a+((d=o==null?void 0:o.top)!=null?d:0),c=a+((f=o==null?void 0:o.bottom)!=null?f:0),u=()=>{if(n-i.top<l){const p=(l-(n-i.top))/10;s.scrollTop-=p,e.id=requestAnimationFrame(u)}if(i.bottom-n<c){const p=(a-(i.bottom-n))/10;s.scrollTop+=p,e.id=requestAnimationFrame(u)}};cancelAnimationFrame(e.id),e.id=requestAnimationFrame(u)}}},lB=()=>{const e={id:0};return{raf:e,autoScroll:(n,s,a,o=iB)=>{const i=a.getBoundingClientRect(),l=()=>{let c=!1;if(n-i.left<o){const u=(n-i.left-o)*10/o;a.scrollLeft+=u,c=!0}if(i.right-n<o){const u=(o-(i.right-n))*10/o;a.scrollLeft+=u,c=!0}if(s-i.top<o){const u=(s-i.top-o)*10/o;a.scrollTop+=u,c=!0}if(i.bottom-s<o){const u=(o-(i.bottom-s))*10/o;a.scrollTop+=u,c=!0}c&&(e.id=requestAnimationFrame(l))};cancelAnimationFrame(e==null?void 0:e.id),e.id=requestAnimationFrame(l)}}},cB=(e,t)=>{var j;let n=e.target;if(!n||t!=null&&t.pointerCaptured&&(n=document.elementFromPoint(e.clientX,e.clientY),!n)||n.closest("[data-disable-select], [data-draggable]"))return;e.type==="mousedown"&&(window.getSelection().removeAllRanges(),document.dispatchEvent(new Event("_clearTextSelection")));const s=K.ui.selectedCells[0];if(!s)return;const{recordId:a,propertyId:o,viewId:i,groupValue:l}=s;let c=`[data-view-id="${i}"]`;l&&(c+=`[data-group-value="${l}"]`);let u=n.closest(`${c} [data-property-id]`),d=u==null?void 0:u.closest("[data-block-id]");if(!u||!d){const D=document.querySelector(`.block-list${c}`),S=D==null?void 0:D.querySelectorAll("[data-block-id]");if(!S)return;let R=Number.MAX_SAFE_INTEGER;for(const L of S){const{top:P,bottom:M}=L.getBoundingClientRect(),U=Math.abs(P-e.clientY);if(U<R&&(R=U,d=L),e.clientY>=P&&e.clientY<=M){d=L;break}}if(!d)return;R=Number.MAX_SAFE_INTEGER;const A=d.querySelectorAll("[data-property-id]");for(const L of A){const{left:P,right:M}=L.getBoundingClientRect(),U=Math.abs(P-e.clientX);if(U<R&&(R=U,u=L),e.clientX>=P&&e.clientX<=M){u=L;break}}}if(!u||!d)return;const f=uc({viewId:i,groupValue:l,ignoreSearch:!1}),{collectionViews:h}=le(),p=h[i],_=(j=(p==null?void 0:p.type)===m.CollectionViewType.TIMELINE?p==null?void 0:p.format.timelineTableProperties:p==null?void 0:p.format.tableProperties)==null?void 0:j.filter(D=>D.visible).map(D=>D.property);if(!_)return;const x=_.findIndex(D=>D===o),y=f.findIndex(D=>D===a),b=u.dataset.propertyId,{blockId:E,syncId:w}=d.dataset,k=t!=null&&t.onlyYAxis?x:_.findIndex(D=>D===b),C=f.findIndex(D=>D===E);if(k===-1||C===-1)return;const T=C>y,v=k>x,I=[];for(let D=y;T?D<=C:D>=C;T?D++:D--)for(let S=x;v?S<=k:S>=k;v?S++:S--){const R=_[S],A=f[D];R&&A&&I.push({propertyId:R,recordId:A,viewId:i,syncId:w,groupValue:l})}ee(nt.update({selectedCells:I}))},uB=zt.createContext(null);var qn=(e=>(e[e.PROPERTY_LIST=0]="PROPERTY_LIST",e[e.PROPERTY_LIST_TIMELINE_TABLE=1]="PROPERTY_LIST_TIMELINE_TABLE",e[e.TABLE_HEADER=2]="TABLE_HEADER",e[e.PAGE_PROPERTIES=3]="PAGE_PROPERTIES",e[e.FORM_PROPERTIES=4]="FORM_PROPERTIES",e))(qn||{}),Kg=(e=>(e.TIMELINE_TABLE="TIMELINE_TABLE",e.TIMELINE="TIMELINE",e))(Kg||{});const dB=({recordId:e,propertyId:t,className:n})=>{const{collectionId:s,readonly:a}=Te(),o=ae(i=>{var d,f,h,p;const{blocks:l}=i,c=(f=(d=l[s])==null?void 0:d.data.schema)==null?void 0:f[t];return(c==null?void 0:c.type)===m.CollectionSchemaType.FORMULA?Ln(s,()=>i).getValue(e,t):de((p=(h=l[e])==null?void 0:h.data.collectionProperties)==null?void 0:p[t]).toUpperCase()==="YES"});return r.jsx("div",{style:{padding:6},children:r.jsx("button",{disabled:a,className:B("block text-left",n),style:{width:24,height:24},children:r.jsx(Ra,{size:"auto",checked:o})})})},DF=e=>ae(({blocks:t})=>{var n;return(n=t[e])==null?void 0:n.parentId}),Yg=e=>{const t=F.useRef();t.current=e,F.useEffect(()=>()=>{t.current.onSave(),setTimeout(t.current.onClose)},[]),F.useLayoutEffect(()=>{t.current.onUpdate()},[])},Wo=({children:e,className:t,noWrap:n})=>r.jsx("div",{className:B(t,n?"whitespace-nowrap":"break-words"),children:e}),fB=({className:e,recordId:t,propertyId:n})=>{const{collectionId:s}=Te(),a=ae(o=>{var u,d,f,h;const{blocks:i}=o,l=(d=(u=i[s])==null?void 0:u.data.schema)==null?void 0:d[n];if((l==null?void 0:l.type)===m.CollectionSchemaType.FORMULA)return Ln(s,()=>o).getValue(t,n);const c=(h=(f=i[t])==null?void 0:f.data.collectionProperties)==null?void 0:h[n];return de(c)});return a?r.jsx(Wo,{className:B("p-2 leading-5",e),children:a}):null},AZ=({className:e,recordId:t})=>{const n=ae(({blocks:s})=>{var a;return(a=s[t])==null?void 0:a.updatedAt});return r.jsx(Wo,{className:B("p-2 leading-5",e),children:he(n).format(us)})},BZ=({className:e,recordId:t})=>{const n=ae(({blocks:s})=>{var a;return(a=s[t])==null?void 0:a.createdAt});return r.jsx(Wo,{className:B("p-2 leading-5",e),children:he(n).format(us)})},LZ=({className:e,recordId:t,propertyId:n})=>{const{collectionId:s}=Te(),a=ae(({blocks:c})=>{var u,d,f;return(f=(d=(u=c[t])==null?void 0:u.data.collectionProperties)==null?void 0:d[n])==null?void 0:f.find(h=>h.type===m.TextType.DATE||h.type===m.TextType.DATETIME)}),o=ae(({blocks:c})=>{var f,h,p;const u=(h=(f=c[s])==null?void 0:f.data.schema)==null?void 0:h[n];if(!u)return;const d=Gr(c[t],n);if(d)return rw((p=d==null?void 0:d.timestamp)!=null?p:0,u.dateFormat,(d==null?void 0:d.textType)===m.TextType.DATETIME,u.timeFormat)},{equalityFn:Cn}),[i,l]=F.useState(!1);return F.useEffect(()=>{const c=Aj(a);if(!c)return;const u=c-Date.now();if(u>0){l(!1);let d;return u<1*24*60*60*1e3&&(d=setTimeout(()=>{l(!0)},u)),()=>{d&&clearTimeout(d)}}l(!0)},[a]),!o||!a?null:a.reminder?r.jsx(Wo,{className:B("p-2 leading-5 text-red",{"line-through text-red/70":i},e),children:r.jsx("div",{className:"inline-flex items-center",children:r.jsxs("span",{children:[o,r.jsx(H,{name:"IcMenuAlarm",size:"normal",className:B("text-red ml-[2px]",{"text-red/70":i})})]})})}):r.jsx(Wo,{className:B("p-2 leading-5",e),children:o})},PZ=({recordIds:e,recordId:t,propertyId:n,onUpdate:s,onClose:a})=>{var g,_,x;const o=(g=ae(({blocks:y})=>{var b,E;return(E=(b=y[t])==null?void 0:b.data.collectionProperties)==null?void 0:E[n]}))!=null?g:[],i=DF(t),l=zs(),c=y=>{l(e!=null?e:t,n,y)},u=o.find(y=>y.type===m.TextType.DATE||y.type===m.TextType.DATETIME),d=qa(i!=null?i:"",n),f=_a(),h=u?Ec(u):null,p=(u==null?void 0:u.type)===m.TextType.DATETIME;return Yg({onUpdate:s,onClose:a,onSave:()=>{}}),i?r.jsx(_F,{uiOption:{noShadow:!0,hasRemind:!0},dateInfo:{from:h!=null?h:new Date,includeTime:p,dateFormat:(_=d.propertySchema)==null?void 0:_.dateFormat,timeFormat:(x=d.propertySchema)==null?void 0:x.timeFormat,reminder:u==null?void 0:u.reminder},onChange:y=>{var k,C;const{dateFormat:b,timeFormat:E,...w}=y;(b!==((k=d.propertySchema)==null?void 0:k.dateFormat)||E!==((C=d.propertySchema)==null?void 0:C.timeFormat))&&f(i,n,{dateFormat:b,timeFormat:E}),c([Fn(w)])},onClear:()=>{c([]),a()}}):null},OZ=e=>{const t=F.useRef(null),n=Kr(),s=zs(),a=ou();return F.useEffect(()=>{const o=t.current;if(o==null)return;const{autoScrollY:i,rafY:l}=FC(),c=u=>{if(u.button!==0)return;u.preventDefault(),u.stopPropagation();const{pointerId:d}=u,f=p=>{p.pointerId===d&&(p.preventDefault(),p.stopPropagation(),cB(p,{onlyYAxis:!0,pointerCaptured:!0}),i({y:p.clientY,container:a.current}))},h=p=>{var w;if(p.pointerId!==d)return;cancelAnimationFrame(l.id),p.preventDefault(),p.stopPropagation(),document.removeEventListener("pointermove",f),document.removeEventListener("pointerup",h);const{selectedCells:g}=n.getState().ui;if(g.length<=1)return;const _=g[0],x=g.slice(1).map(k=>k.recordId).filter(k=>{const{role:C}=hn(k);return Fs(C,m.PermissionRole.WRITER)}),{propertyId:y}=_,b=n.getState().blocks[_.recordId];if(b==null)return;const E=y==="title"?b.data.segments:(w=b.data.collectionProperties)==null?void 0:w[y];s(x,y,E),x.length!==g.length&&n.dispatch(nt.update({selectedCells:g.filter((k,C)=>C===0||x.includes(k.recordId))}))};document.addEventListener("pointermove",f),document.addEventListener("pointerup",h)};return o.addEventListener("pointerdown",c),()=>{cancelAnimationFrame(l.id),o.removeEventListener("pointerdown",c)}},[a,n,s]),r.jsx("div",{ref:t,className:B("rounded-full w-[10px] h-[10px] border border-blue_cobalt bg-blue cursor-ns-resize",e.className),onClick:o=>{o.stopPropagation()}})},MZ=F.memo(OZ),UZ=()=>i8(l8(c8,{activationConstraint:{distance:3}})),vr=({items:e,renderItemContent:t,onChange:n,onlyHandleDraggable:s=!1,disabled:a=!1,onDragStart:o,onDragEnd:i,modifiers:l=[Gp,qE],strategy:c=r8,className:u,appendChild:d,listRef:f,isHorizontalAxis:h,virtual:p})=>{var E;const g=F.useRef(null),[_,x]=F.useState(void 0),y=UZ(),b=w=>{g.current=w,f&&(f.current=w)};return r.jsxs(ZM,{modifiers:l,sensors:y,collisionDetection:e8,onDragEnd:w=>{i==null||i(w),x(void 0);const{active:k,over:C}=w;if(C&&k.id!==C.id){const T=e.findIndex(j=>j.id===k.id),v=e.findIndex(j=>j.id===C.id),I=qc(e,T,v);n==null||n(I,w)}},onDragStart:w=>{o==null||o(w);const k=e.find(C=>C.id===w.active.id);x(k)},children:[r.jsxs("div",{className:u,ref:b,children:[r.jsx(t8,{items:e,strategy:c,children:p?r.jsx(n8,{height:Zn(e.length*32,0,400),itemCount:e.length,className:"w-full",overscanCount:5,itemSize:32,stickyIndices:_?[e.indexOf(_)]:void 0,renderItem:({index:w,style:k})=>{const C=e[w];return C?r.jsx(uN,{renderItemContent:t,item:C,wrapperStyle:k,disabled:a,onlyHandleDraggable:s},C.id):null}}):r.jsx(r.Fragment,{children:e.map(w=>r.jsx(uN,{renderItemContent:t,item:w,disabled:a,onlyHandleDraggable:s},w.id))})}),d]}),Is.createPortal(r.jsx(s8,{dropAnimation:null,className:"!z-[9999]",children:_&&r.jsx(VZ,{height:h?(E=g.current)==null?void 0:E.clientHeight:void 0,renderItemContent:t,item:_})}),document.body)]})},VZ=({item:e,height:t,renderItemContent:n})=>{const s=a=>r.jsx("div",{className:a.className,children:r.jsx(H,{name:"IcBlockHandle"})});return r.jsx("div",{className:"opacity-[0.9]",style:{height:t},children:n({item:e,isPreview:!0,renderDragHandle:s})})},uN=({item:e,renderItemContent:t,onlyHandleDraggable:n,disabled:s,wrapperStyle:a})=>{const{listeners:o,setNodeRef:i,transform:l,transition:c,active:u,isDragging:d}=a8({id:e.id,disabled:s}),f={...a,transform:o8.Transform.toString(l),transition:u?c:void 0,opacity:d?0:1},h=p=>r.jsx("div",{...o,onClick:g=>{var _;return(_=p.onClick)==null?void 0:_.call(p,g)},className:B(p.className,d?"cursor-[grabbing]":"cursor-[grab]"),children:r.jsx(Fe,{popup:p.popup,children:r.jsx(H,{name:"IcBlockHandle"})})});return r.jsx("div",{...n?{}:o,ref:i,style:f,children:t({item:e,isPreview:!1,renderDragHandle:h,listeners:o,active:u,isDragging:d})})};class qZ{constructor(){q(this,"errorOssName",new Set);q(this,"doneErrorOssNames",new Set);q(this,"timer",null)}add(t){this.doneErrorOssNames.has(t)||!K.user.uuid||(this.errorOssName.add(t),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{this.errorOssName.size>0&&(Ce.editor.filesPreviewOssProcess.raw({ossNames:[...this.errorOssName]}),this.doneErrorOssNames=new Set([...this.errorOssName,...this.doneErrorOssNames]),this.errorOssName.clear())},1e3))}}const HZ=new qZ,oh=F.memo(e=>{const{defaultIcon:t,uuid:n,ossName:s}=e,a=zp(s),{illegal:o}=it(n),{extName:i}=sn(s);return!s||!i||o?r.jsx(r.Fragment,{children:t}):a?r.jsx($Z,{...e,extName:sn(a).extName,ossName:a,originOssName:s}):r.jsx(r.Fragment,{children:t})}),$Z=F.memo(e=>{var f;const{uuid:t,defaultIcon:n,className:s,options:a,ossName:o,extName:i}=e,l=!Rd.test(i),c=Math.floor((f=a==null?void 0:a.resizeWidth)!=null?f:200),[u,d]=nD(()=>Ls.fetchImageUrl(t,o),[t,o]);return F.useEffect(()=>{var h;u==="fulfilled"&&!d&&((h=a==null?void 0:a.onError)==null||h.call(a))},[a,u,d]),u!=="fulfilled"||!d?r.jsx(r.Fragment,{children:n}):cn.image.test(i)?r.jsx(dN,{...e,url:l?d:bo(`${d}&img_process=/resize,w_${c}`,i),originSrc:d,className:s,defaultIcon:n,options:a,fileType:"image"}):cn.video.test(i)?r.jsx(dN,{...e,originSrc:`${d}&x-oss-process=video/snapshot,t_10000,f_jpg,w_800`,url:`${d}&x-oss-process=video/snapshot,t_10000,f_jpg,w_800`,className:s,defaultIcon:n,fileType:"video",options:a}):r.jsx(r.Fragment,{children:n})}),dN=e=>{const t=F.useRef(!1),{url:n,className:s,defaultIcon:a,fileType:o,options:i,originOssName:l,originSrc:c,...u}=e,{src:d,error:f}=u8({srcList:n,useSuspense:!1});F.useEffect(()=>{var p;if(f&&l){(p=i==null?void 0:i.onError)==null||p.call(i);const{extName:g}=sn(l);Ej(g)&&(t.current=!0,HZ.add(l))}},[f,i,l]);const h=r.jsx(jI,{...Jn(u,["uuid","extName","ossName"]),src:`${d}`,loader:r.jsx(r.Fragment,{children:a}),unloader:r.jsx(r.Fragment,{children:a}),className:B("object-contain object-center",s)});switch(o){case"video":return i!=null&&i.hideVideoIcon||f?h:r.jsxs("div",{className:"relative flex items-center justify-center",children:[h,r.jsx(H,{name:"IcMenuNext",size:i==null?void 0:i.videoPlayIconSize,className:"absolute text-black-base pointer-events-none"})]});case"image":return i!=null&&i.previewImage?r.jsx(d8,{src:c,overlay:i!=null&&i.useOverlayId?{uuid:u.uuid}:{},render:()=>h,children:h}):h;default:return h}},Tl=({className:e,color:t,label:n,value:s,showClose:a,onClick:o,onDelete:i})=>{Lr();const l=XE(t),c=YE(t);return r.jsxs("span",{className:B("h-5 inline-flex items-center rounded-sm pl-[6px] overflow-hidden text-t2 leading-[20px]",{"pr-[6px]":!a},e),style:{color:c,backgroundColor:l},onClick:o,children:[r.jsx("span",{className:"overflow-ellipsis overflow-x-hidden whitespace-nowrap",children:n!=null?n:s}),a&&r.jsx("button",{className:"opacity-80 flex-shrink-0 w-5 h-5 inline-block",onClick:i,children:r.jsx(H,{name:"IcToastClose",className:"w-full h-full",size:"auto"})})]})},SF=20971520,Xl={tasks:[],tasksChange$:new Up},mB=()=>{const e=Ma(),t=zs(),n=fk();return F.useCallback(async(s,a,o)=>{var d;if(Xl.tasks.find(f=>f.file===s))return;const i=new HI(0),l=(d=a[0])!=null?d:"",c=qe(),u=await e({key:c,file:s,isDatabase:!0,inTransferList:!0,blockId:a[0],onProgress:f=>{i.next(f)},type:"file",onComplete:async f=>{var y,b;if(f8(Xl.tasks,E=>E.file===s),Xl.tasksChange$.next(),!f.success)return;i.complete();const h=await n(s),p=b2({name:s.name,size:s.size,ossName:f.ossName,...h}),{blocks:g}=le(),_=(b=(y=g[l])==null?void 0:y.data.collectionProperties)==null?void 0:b[o],x=(_!=null?_:[]).filter(E=>E.type===m.TextType.URL&&E.fileStorageType==="internal");x.push(p),t(a,o,x)}});u&&(a.forEach(f=>{Xl.tasks.push({file:s,abort:()=>{Fg.abort(u)},progress$:i,recordId:f,propertyId:o})}),Xl.tasksChange$.next())},[n,t,e])},hB=(e,t)=>rd(()=>Xl.tasksChange$.pipe(ad(()=>Xl.tasks.filter(n=>n.recordId===e&&n.propertyId===t))),Xl.tasks.filter(n=>n.recordId===e&&n.propertyId===t),[e,t]),GZ=({className:e,recordId:t,propertyId:n,site:s})=>{const a=ae(({blocks:l})=>{var c,u;return(u=(c=l[t])==null?void 0:c.data.collectionProperties)==null?void 0:u[n]}),o=hB(t,n),i=RF();return r.jsxs("div",{className:B("flex items-center",s===Me.FIELD&&gn({selectors:{":empty:before":{content:'"未填写"',display:"block",fontSize:"14px",padding:"3px",color:"var(--grey4)",lineHeight:"20px"}}}),(s===Me.CELL||s===Me.FIELD)&&"p-[5px]",(s===Me.CELL||s===Me.FIELD||s===Me.CARD)&&"flex-wrap",e),children:[(a!=null?a:[]).filter(l=>l.type===m.TextType.URL&&l.fileStorageType==="internal").map((l,c)=>{const u=zp(l.url),d=r.jsx(Tl,{label:l.text,color:wr[0].key,className:B("align-middle max-w-[calc(100%-6px)]",(s===Me.CELL||s===Me.FIELD)&&"m-[3px]",(s===Me.CARD||s===Me.LIST)&&"mr-1 my-0.5 text-t4",s===Me.CALENDAR&&"mr-1 my-[1px] text-t4",u&&"cursor-pointer"),onClick:async f=>{u&&(f.stopPropagation(),i(t,n,l))}},c);return u&&(!l.size||l.size<=SF)?r.jsx(oh,{className:B("h-5 w-5 m-[3px] cursor-pointer border border-grey6 rounded-sm overflow-hidden inline-flex",(s===Me.CELL||s===Me.FIELD)&&"m-[3px]",s===Me.CARD||s===Me.LIST?"mr-1 my-0.5":"m-[3px]",s===Me.CALENDAR&&"mr-1 my-[1px]"),uuid:t,ossName:l.url,defaultIcon:d,options:{videoPlayIconSize:"small",resizeWidth:40,previewImage:cn.image.test(sn(l.text).extName)},onClick:f=>{const h=cn.image.test(sn(l.text).extName);f.stopPropagation(),!h&&i(t,n,l)}},c):d}),o.length>0&&r.jsx(hs,{size:"large"})]})},zZ=({task:e})=>{const t=rd(()=>e.progress$,e.progress$.value,[e]);return r.jsxs("div",{className:"flex items-center h-8 py-1 mx-3 cursor-default text-t2",children:[r.jsx(H,{className:"text-xl leading-none text-grey4 animate-spin",name:"IcNaviLoading"}),r.jsx("span",{className:"flex-1 mx-1 overflow-hidden whitespace-nowrap overflow-ellipsis",children:e.file.name}),r.jsxs("span",{className:"mx-1",children:[t.toFixed(1),"%"]}),r.jsx("button",{className:"flex items-center justify-center w-5 h-5 ml-1 animate-hover",onClick:()=>{e.abort()},children:r.jsx(H,{size:"small",name:"IcTitleClose"})})]})},RF=()=>{const e=me();return(t,n,s)=>{if(!s.url)return;const{extName:a}=sn(s.text),o=cn.image.test(a);ce.event("file_preview",{file_format:a}),e.modal({modalId:Xe.FILE_PREVIEW,noAnimation:!0,content:()=>o?r.jsx(QZ,{recordId:t,propertyId:n,data:s}):r.jsx(pB,{recordId:t,data:s})})}},WZ=({recordIds:e,recordId:t,propertyId:n,data:s,onCloseModal:a,setShowInput:o})=>{const i=Ve(t,!1),l=zs(),c=RF(),{allowDuplicate:u}=hn(t),d=async(f,h)=>{var g;const p=await Ls.fetchDownloadUrl(f,(g=h.url)!=null?g:"<never>",h.text);Tc(p,h.text)};return r.jsx("div",{className:"next-modal w-[200px] rounded-sm py-2",children:r.jsx(ze,{items:[{type:$.OPERATION,isHidden:ht()&&!u,data:{title:"下载",onClick:()=>{a(),d(t,s)}}},{type:$.OPERATION,data:{title:"查看",onClick:()=>{a(),c(t,n,s)}}},{type:$.OPERATION,data:{title:"重命名",onClick:()=>{a(),o(!0)}}},{type:$.OPERATION,isHidden:i,data:{title:"删除",onClick:()=>{var p,g;a();const{blocks:f}=le(),h=(g=(p=f[t])==null?void 0:p.data.collectionProperties)==null?void 0:g[n];l(e!=null?e:t,n,h==null?void 0:h.filter(_=>_!==s))}}}]})})},KZ={none:"点击上传，或粘贴/拖入文件",dragging:"拖入文件上传",draggingOver:"松手即可上传文件"},YZ=({recordIds:e,recordId:t,propertyId:n})=>{const s=Ve(t,!1),a=ae(({blocks:h})=>{var p,g;return(g=(p=h[t])==null?void 0:p.data.collectionProperties)==null?void 0:g[n]}),o=(a!=null?a:[]).filter(h=>h.type===m.TextType.URL&&h.fileStorageType==="internal"),i=hB(t,n),l=mB(),c=zs(),[u,d]=F.useState("none"),f=F.useRef(null);return F.useEffect(()=>{const h=f.current,p=h==null?void 0:h.parentElement;if(!(p==null?void 0:p.parentElement)||!p||!h)return;const _=E=>{E.target instanceof HTMLElement&&(p.contains(E.target)?d("draggingOver"):d("dragging"))},x=E=>{E.clientX===0&&E.clientY===0&&d("none")},y=()=>d("none"),b=E=>{var w;if((w=E.clipboardData)!=null&&w.files.length){const{files:k}=E.clipboardData;[...k].forEach(C=>{l(C,e!=null?e:[t],n)})}};return document.addEventListener("dragenter",_),document.addEventListener("dragleave",x),document.addEventListener("drop",y),document.addEventListener("paste",b),()=>{document.removeEventListener("dragenter",_),document.removeEventListener("dragleave",x),document.removeEventListener("drop",y),document.removeEventListener("paste",b)}},[]),r.jsxs("div",{className:"pt-1",children:[!s&&r.jsx(Fe,{popup:"支持多选，你也可以拖放文件到这里来上传",className:B(u!=="none"&&"h-[140px]"),children:r.jsxs(Z2,{ref:f,className:B("relative flex items-center w-full animate-hover rounded-none",u==="none"?"h-10 px-3 py-2":"m-2.5 flex-col justify-center rounded",u==="draggingOver"&&"bg-active_color_10 border-active_color border border-dashed"),multiple:!0,onSelect:h=>{[...h].forEach(p=>{l(p,e!=null?e:[t],n)})},children:[r.jsx(H,{className:B(u==="none"?"mr-1":"mb-2 text-grey3"),name:u==="none"?"MIcAddNew":"IcBtnUpload",size:u==="none"?"middle":"large"}),r.jsx("span",{className:"text-t2 text-grey3",children:[KZ[u]]})]})}),r.jsx("div",{className:B("max-h-[438px] overflow-auto py-2 border-b-[1px]",o.length<=0&&i.length<=0&&"hidden",u!=="none"&&"hidden"),children:r.jsxs("div",{className:"w-[260px]",children:[r.jsx(Wg,{children:r.jsx(vr,{disabled:s,items:o.map(h=>{var p;return{id:(p=h.url)!=null?p:"<never>",data:h}}),onChange:h=>{c(t,n,h.map(p=>p.data))},renderItemContent:({item:{data:h},renderDragHandle:p})=>r.jsx(XZ,{data:h,renderDragHandle:p,recordId:t,recordIds:e,propertyId:n})})}),r.jsx("div",{children:i.map((h,p)=>r.jsx(zZ,{task:h},p))})]})})]})},XZ=({data:e,renderDragHandle:t,recordIds:n,recordId:s,propertyId:a})=>{const o=zp(e.url),i=RF(),l=me(),[c,u]=F.useState(!1),{name:d,extName:f}=sn(e.text),[h,p]=F.useState(d),g=zs(),_=y=>{l.dropdown({popcorn:y.target,placement:"right",content:WZ,contentProps:{recordIds:n,recordId:s,propertyId:a,data:e,setShowInput:u}})},x=()=>{var k,C,T;const{blocks:y}=le(),w=((T=(C=(k=y[s])==null?void 0:k.data.collectionProperties)==null?void 0:C[a])!=null?T:[]).filter(v=>v.type===m.TextType.URL&&v.fileStorageType==="internal").map(v=>({...v,text:v.url===e.url&&h.trim()?Gw(h,f):v.text}));g(s,a,w),u(!1)};return r.jsxs("div",{className:"flex flex-col px-3 bg-white2 cursor-pointer animate-hover-opaque",children:[r.jsxs("div",{className:"flex items-center w-full h-8",children:[t({className:"flex items-center justify-center w-5 h-5 text-grey4"}),c?r.jsx(xt,{selection:[0,e.text.length],onEnter:x,className:"h-8 w-full max-w-[360px]",autoFocus:!0,value:h,onBlur:x,onChange:y=>p(y)}):r.jsxs(r.Fragment,{children:[r.jsxs("span",{className:"flex items-center flex-1 min-w-0 mx-1",onClick:()=>{cn.image.test(f)||i(s,a,e)},children:[r.jsx(H,{className:"mr-1",size:"middle",name:"IcTitleFiles"}),r.jsx("span",{title:e.text,className:"flex-1 min-w-0 overflow-hidden text-t2 whitespace-nowrap overflow-ellipsis",children:e.text})]}),r.jsx("button",{className:"flex items-center justify-center w-5 h-5 ml-1 text-grey3 animate-hover",onClick:_,children:r.jsx(H,{className:"w-5 h-5",name:"IcMore"})})]})]}),o&&(!e.size||e.size<=SF)&&r.jsx("div",{className:"w-full cursor-pointer flex justify-center",onClick:y=>{y.stopPropagation(),!cn.image.test(f)&&i(s,a,e)},children:r.jsx(oh,{className:"max-h-[200px] mb-2",uuid:s,ossName:e.url,defaultIcon:r.jsx(r.Fragment,{}),options:{resizeWidth:300,videoPlayIconSize:"xxlarge",previewImage:cn.image.test(f)}})})]})},Z2=F.forwardRef((e,t)=>{const{multiple:n,accept:s,className:a,children:o,onSelect:i}=e,[l,c]=F.useState(0);return r.jsxs("div",{className:a,children:[o,r.jsx("input",{ref:t,type:"file",multiple:n,accept:s,className:gn({display:"block",position:"absolute",left:0,top:0,cursor:"pointer",opacity:0,width:"100%",height:"100%",selectors:{"::file-selector-button":{position:"absolute",cursor:"pointer",display:"block",width:"100%",height:"100%"}}}),onChange:u=>{u.target.files&&(i==null||i(u.target.files),c(d=>(d+1)%2))}},l)]})}),QZ=({recordId:e,propertyId:t,data:n})=>{const s=F.useMemo(()=>ls(e),[e]),a=F.useMemo(()=>{var p,g,_;if(!s)return[];const d=[],f=(_=(g=(p=K.blocks[e])==null?void 0:p.data.collectionProperties)==null?void 0:g[t])!=null?_:[],h=f==null?void 0:f.filter(x=>{const{extName:y}=sn(x.text);return cn.image.test(y)});return d.push(...h),d},[s,t,e]),[o,i]=F.useState(a.findIndex(d=>rn(d,n))),l=F.useCallback(()=>{i(d=>d===0?(ye.warning("当前为第一张"),d):d-1)},[]),c=F.useCallback(()=>{i(d=>d===a.length-1?(ye.warning("当前为最后一张"),d):d+1)},[a.length]);F.useEffect(()=>{const d=h=>{be("ArrowLeft")(h)?l():be("ArrowRight")(h)&&c()};return qt.addEventListener("keydown",d)},[c,l]);const u=a[o];return u?r.jsxs("div",{children:[r.jsx(pB,{recordId:e,data:u}),r.jsx(Fe,{popup:"上一张",className:"cursor-pointer absolute left-0 pl-2 top-[50%]",children:r.jsx(H,{name:"MIcBtnPre",size:"xxxlarge",onClick:d=>{d.stopPropagation(),l()}})}),r.jsx(Fe,{popup:"下一张",className:"cursor-pointer absolute right-0 pr-2 top-[50%]",children:r.jsx(H,{name:"MIcBtnNext",size:"xxxlarge",onClick:d=>{d.stopPropagation(),c()}})})]}):null},pB=({recordId:e,data:t})=>{const[n,s]=F.useState(),{extName:a}=sn(t.text),o=vR(a),i=Kt();return F.useEffect(()=>{t.url&&Ls.fetchDownloadUrl(e,t.url,t.text).then(l=>{const c=bo(l,a);s(c)})},[t.text,t.url,a,e]),n?r.jsxs("div",{className:"fixed top-0 bottom-0 left-0 right-0 bg-black-base/80",children:[r.jsx("div",{className:"absolute top-0 left-0 z-10 flex items-center w-screen pb-2.5 min-h-[55px]",style:{background:"linear-gradient(black, transparent)"},children:r.jsx("button",{className:"absolute top-0 right-0 px-5 py-4 text-white text-t2",onClick:()=>{i(Xe.FILE_PREVIEW)},children:"关闭"})}),r.jsx("div",{className:"flex items-center justify-center absolute top-[55px] bottom-0 w-screen",onClick:l=>l.target===l.currentTarget&&i(Xe.FILE_PREVIEW),children:r.jsx(o,{downloadUrl:n})})]}):null};const gB=["prop",...Yl.flatMap(S2,e=>e.list).map(e=>e.title)];Qo.defineSimpleMode("formula",{start:[{regex:/"([^\\"]|\\.)*"?/,token:"string"},{regex:/\b(?:pi|e|true|false)\b/,token:"atom"},{regex:/(?:0|[1-9][0-9]*)(?:[.][0-9]+)?(?:[eE][+-]?(?:0|[1-9][0-9]*))?/,token:"number"},{regex:new RegExp(`\\b(?:${gB.join("|")})\\b`),token:"builtin"},{regex:/\b(?:[A-Za-z_][A-Za-z0-9_]*)\b/,token:"variable"}]});const _B=e=>{var i,l,c,u;const t=e.getDoc(),n=t.getValue();let s=t.indexFromPos(e.getCursor()),a="";if(/[A-Za-z0-9_]/.test((i=n[s])!=null?i:""))return null;for(;s>0;){const d=(l=n[s-1])!=null?l:"";if(!/[A-Za-z0-9_]/.test(d))break;a=d+a,s-=1}if(a===""||/[0-9]/.test(a.charAt(0)))return null;let o=0;for(;o<s;){const d=n.slice(o).indexOf('"'),f=o+d;if(d===-1||s<=f)break;const h=/^"([^"\\]|\.)*"/.exec(n.slice(f)),p=h==null?n.length:f+h.index+((u=(c=h[0])==null?void 0:c.length)!=null?u:0);if(s<p)return null;o=p}return{cursor:s,word:a}},xB=F.forwardRef((e,t)=>{var l;const n=Lr(),s=F.useRef(null),a=tD(e),o=F.useRef();F.useImperativeHandle(t,()=>({cm(){return o.current}})),F.useEffect(()=>{const c=s.current;if(!c)return;const{initialValue:u,placeholder:d,readOnly:f=!1,autoFocus:h=!1}=a.current,p=Qo(c,{value:u,mode:"formula",autoRefresh:!0,viewportMargin:1/0,autoCloseBrackets:!0,placeholder:d,readOnly:f,lineWrapping:!0,highlightSelectionMatches:{showToken:/\w/,annotateScrollbar:!0},matchTags:{bothTags:!0},matchBrackets:{strict:!0},theme:n?"ayu-dark":"default"});if(o.current=p,h){p.focus();const E=p.getDoc();p.setCursor(E.posFromIndex(1/0))}p.on("beforeChange",(E,w)=>{});const g=document.createElement("span");g.className="widget-autocomplete";let _=null,x=null,y=null;const b=()=>{g.innerText="",x==null||x.clear(),x=null,_=null,y=null};return p.on("change",E=>{E.startOperation(),b(),_=E.getCursor();const w=_B(E),k=w==null?void 0:w.word;if(k){const C=gB.find(T=>T.startsWith(k));C&&C!==k&&(y=C.slice(k.length),x=E.setBookmark(_,{widget:g,insertLeft:!0}),g.innerText=y)}E.endOperation()}),p.on("changes",()=>{var E,w;(w=(E=a.current).onChange)==null||w.call(E)}),p.on("cursorActivity",E=>{const w=E.getCursor();_!=null&&(w.line!==_.line||w.ch!==_.ch)&&b()}),p.on("keydown",(E,w)=>{_!=null&&y!=null&&(be("tab")(w)||be("right")(w))&&(E.replaceRange(y,_,_,"+input"),w.preventDefault())}),()=>{const E=new Range;E.selectNodeContents(c),E.deleteContents()}},[n,a]);const{className:i}=e;return r.jsx("div",{ref:s,className:B(i,gn({selectors:{"& div.CodeMirror":{height:"auto",background:"transparent",color:"var(--black)"},".CodeMirror-wrap pre":{wordBreak:"break-word"},"& div.CodeMirror-scroll":{maxHeight:e.maxHeight},"& .widget-autocomplete":{color:"var(--grey3)"},"& .CodeMirror-empty":{color:"var(--grey4)"},"& .CodeMirror-cursor":{borderLeftWidth:"1px !important",display:(l=e.readOnly)!=null&&l?"none !important":void 0},"& .CodeMirror-focused .CodeMirror-selected":{background:"var(--selection) !important"},"& .CodeMirror-line::selection, & .CodeMirror-line > span::selection, & .CodeMirror-line > span > span::selection":{background:"var(--selection) !important"},"& .CodeMirror pre.CodeMirror-line, & .CodeMirror pre.CodeMirror-line-like":{fontFamily:'SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace'},"& .cm-mark-error":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",backgroundImage:'url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJDw4cOCW1/KIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAHElEQVQI12NggIL/DAz/GdA5/xkY/qPKMDAwAADLZwf5rvm+LQAAAABJRU5ErkJggg==")'},"& .CodeMirror-matchingbracket":{outline:"1px solid var(--grey4)"}}}))})}),JZ=({className:e,search:t,recordId:n,propId:s,onComplete:a})=>{var h,p,g,_;const o=(h=DF(n))!=null?h:"",[i,l]=F.useState(null),c=ae(({blocks:x})=>{var y;return(y=x[o])==null?void 0:y.data.schema}),u=Ln(o),d=F.useMemo(()=>{const x=u.getAvailablePropIds(s),y={groupEn:"Properties",groupCn:"属性",list:Yl.uniqBy(Object.entries(c!=null?c:{}).filter(([E])=>x.has(E)).map(([E,w])=>{const k=(()=>{let{type:T}=w;switch(T===m.CollectionSchemaType.FORMULA&&(T=u.getTypeAsCollectionSchemaType(E)),T){case m.CollectionSchemaType.NUMBER:return"number";case m.CollectionSchemaType.TEXT:return"string";case m.CollectionSchemaType.CHECKBOX:return"boolean";case m.CollectionSchemaType.DATE:case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:return"date";default:return"string"}})(),C=u.getValue(n,E);return{title:w.name,resultType:k,description:`获取当前记录的“${w.name}”属性`,syntax:`prop(${JSON.stringify(w.name)})`,examples:C==null?`empty(prop(${JSON.stringify(w.name)})) == true`:`prop(${JSON.stringify(w.name)}) == ${k==="date"?`fromTimestamp(${C.getTime()})`:JSON.stringify(C)}`}}),E=>E.title)};if(t==null)return[y,...S2];const b=t.toLowerCase();return[y,...S2].map(E=>({...E,list:E.groupEn==="Properties"&&b==="prop"?E.list:E.list.filter(w=>w.title.toLowerCase().includes(b))})).filter(E=>E.list.length>0)},[u,s,n,c,t]),f=i?(g=Yl.flatMap(d,x=>x.list).find(x=>x.title===i))!=null?g:(p=d[0])==null?void 0:p.list[0]:(_=d[0])==null?void 0:_.list[0];return r.jsxs("div",{className:B(e,"flex min-h-0 text-t2"),children:[r.jsx("div",{className:"h-full relative overflow-auto w-[180px] border-r border-grey6",children:d.map(x=>r.jsxs("dl",{children:[r.jsx("dt",{className:"h-7 leading-7 mx-1 px-1 text-grey3 sticky top-0 z-10 bg-white1",children:x.groupCn}),x.list.map(y=>r.jsxs("dd",{className:B("mx-1 px-2 h-7 animate-hover flex items-center",y===f&&"bg-black_006"),onPointerEnter:()=>{l(y.title)},onPointerDown:b=>{var E;((E=document.activeElement)==null?void 0:E.closest(".formula-editor"))!=null&&b.preventDefault()},onClick:()=>{const b=x.groupEn==="Properties"?"property":x.groupEn==="Constants"?"constant":"function";a==null||a(b,y.title)},children:[r.jsx(H,{size:"middle",className:"text-grey3",name:y.resultType==="number"?"IcTitleNum":y.resultType==="string"?"IcTitleText":y.resultType==="boolean"?"IcTitleCheckbox":y.resultType==="date"?"IcTitleDate":"IcTitleText"}),r.jsx("div",{className:"ml-2 flex-1 min-w-0 text-ellipsis",children:y.title})]},y.title))]},x.groupEn))}),r.jsx("div",{className:"h-full overflow-auto flex-1 p-3",children:f&&r.jsxs("article",{className:"allow-text-selection",children:[r.jsx("h1",{className:"text-h3 mt-1 mb-3",children:f.title}),r.jsx("p",{className:"text-t3 my-2",children:f.description}),r.jsxs("section",{className:B(!f.syntax&&"hidden"),children:[r.jsx("h2",{className:"text-t3-bold my-2",children:"语法"}),r.jsx("pre",{className:"rounded text-t3 whitespace-pre-wrap break-words text-mono py-1.5 px-2.5 bg-grey6",children:r.jsx("code",{children:f.syntax})})]}),r.jsxs("section",{className:B(!f.examples&&"hidden"),children:[r.jsx("h2",{className:"text-t3-bold my-2",children:"示例"}),r.jsx(xB,{readOnly:!0,className:"rounded text-t3 py-1.5 px-2.5 bg-grey6",initialValue:f.examples},f.title)]})]})})]})},ZZ=({className:e,propertyId:t,recordId:n})=>{const{collectionId:s}=Te(),a=ae(o=>Ln(s,()=>o).getValue(n,t),{equalityFn:yU(bU(hr(o=>o.getTime())))});return a==null?null:r.jsx(Wo,{className:B("p-2 leading-5",e),children:he(a).format(us)})},eee=e=>{const{collectionId:t}=Te(),{propertyId:n}=e,s=ae(a=>Ln(t,()=>a).getType(n));return s===He.ValueTool.numberType?r.jsx(YA,{...e}):s===He.ValueTool.stringType?r.jsx(fB,{...e}):s===He.ValueTool.booleanType?r.jsx(dB,{...e}):s===He.ValueTool.dateType?r.jsx(ZZ,{...e}):null},tee=({propertyId:e,recordId:t,onClose:n,viewId:s})=>{var w,k;const a=(w=DF(t))!=null?w:"",o=Ln(a),i=Ve(a),l=(k=Tg(s))!=null?k:a,c=So(l),u=i||c,d=ae(({blocks:C})=>{var v,I,j;const T=(j=(I=(v=C[a])==null?void 0:v.data.schema)==null?void 0:I[e])==null?void 0:j.formula;return T==null?"":o.fromServer(T)}),f=F.useRef(),[h,p]=F.useState(null),g=F.useRef(),[_,x]=F.useState(null),y=ke(),b=()=>{if(f.current==null||(_==null?void 0:_.type)!=="preview")return;const C=f.current.cm().getValue();y(()=>{var D;const{blocks:T}=le(),v=T[a];if(!v)return;const I=(D=v.data.schema)!=null?D:{},j=I[e];j&&pe(a,{data:{schema:{...I,[e]:{...j,formula:o.toServer(C)}}}})}),n()},E=FV(()=>{if(f.current==null)return;const C=f.current.cm(),T=_B(C);p(T);const v=D=>{if(x(D),g.current!=null&&(g.current.clear(),g.current=void 0),D!=null&&D.type==="error"){const S=C.getDoc();g.current=C.markText(S.posFromIndex(D.pos.pmin),S.posFromIndex(D.pos.pmax),{className:"cm-mark-error"})}},I=C.getValue();if(I===""){v(null);return}const j=o.validate(I,t,e);v(j)});return F.useEffect(()=>{E()},[E]),r.jsxs("div",{className:B("bg-white1 flex flex-col",gn({minWidth:"180px",width:"580px",height:u?"48px":"400px",maxWidth:"calc(100vw - 24px)",maxHeight:"70vh"})),children:[r.jsxs("div",{className:"flex items-start max-h-[180px] formula-editor",onKeyDown:C=>{C.stopPropagation(),be("mod+enter")(C)&&(_==null?void 0:_.type)!=="error"&&b()},children:[r.jsx(xB,{ref:f,className:"flex-1 min-w-0 mx-2.5 my-2 text-t2 border border-grey6 bg-grey9 focus-within-border rounded-sm box-border",autoFocus:!0,placeholder:"输入公式",initialValue:d,maxHeight:"162px",readOnly:u,onChange:E}),!u&&r.jsx(je,{colorType:"active",className:"my-2 mr-2.5",onClick:b,disable:(_==null?void 0:_.type)==="error",children:"提交"})]}),!u&&r.jsxs(r.Fragment,{children:[r.jsx(JZ,{className:"border-t border-grey6 flex-1",search:h==null?void 0:h.word,recordId:t,propId:e,onComplete:(C,T)=>{var S,R;const v=(S=f.current)==null?void 0:S.cm();if(v==null)return;C==="function"?T+="(":C==="property"&&(T=`prop(${JSON.stringify(T)})`);const I=v.getDoc(),j=(R=h==null?void 0:h.cursor)!=null?R:I.indexFromPos(I.getCursor()),D=h==null?j:j+h.word.length;v.replaceRange(T,I.posFromIndex(j),I.posFromIndex(D),"+input")}}),r.jsxs("div",{className:"h-8 text-t2 flex items-center border-t border-grey6",children:[r.jsxs("span",{className:"flex-1 mx-3 text-ellipsis",children:[(_==null?void 0:_.type)==="preview"&&r.jsxs("span",{children:["预览结果：",_.preview]}),(_==null?void 0:_.type)==="error"&&r.jsx("span",{className:"text-red flex-1",children:_.message})]}),r.jsxs("span",{className:"text-grey3 text-t4 mr-3",children:[Gt,"+Enter可快捷提交"]})]})]})]})},yC=e=>{const t=F.useRef(null);return F.useEffect(()=>{const n=t.current;n&&n.setSelectionRange(n.value.length,n.value.length)},[]),r.jsx(oo,{fontClassName:"whitespace-pre-wrap",ref:t,...e})},nee=({value:e,onChange:t})=>r.jsx(yC,{autoFocus:!0,value:e,onChange:n=>{t(n.target.value)}});function bC({useValue:e,useSaveValue:t,ValueEditor:n}){return({site:a,recordId:o,recordIds:i,propertyId:l,onUpdate:c,onClose:u})=>{const d=e({recordId:o,propertyId:l}),[f,h]=F.useState(d),p=t({recordId:i!=null?i:o,propertyId:l}),g=F.useRef(!1),_=()=>{g.current&&p(f)};return Yg({onUpdate:c,onClose:u,onSave:_}),r.jsx("div",{className:"px-2 text-t2 py-[9px] min-w-full leading-[20px]",onKeyDown:x=>{be("shift+enter")(x)||(be("enter")(x)?(x.preventDefault(),_(),u()):be("esc")(x)&&u())},children:r.jsx(n,{site:a,value:f,onChange:x=>{g.current=!0,h(x)}})})}}const see=bC({useValue:({recordId:e,propertyId:t})=>ae(({blocks:s})=>{var o,i;const a=(i=(o=s[e])==null?void 0:o.data.collectionProperties)==null?void 0:i[t];return de(a)}),useSaveValue:({recordId:e,propertyId:t})=>{const n=zs();return s=>{n(e,t,mt(s))}},ValueEditor:nee}),EC=e=>({className:t,recordId:n,propertyId:s,site:a})=>{const o=RF(),i=ae(({blocks:c})=>{var d,f;const u=(f=(d=c[n])==null?void 0:d.data.collectionProperties)==null?void 0:f[s];return pi(u)}),l=Ve(n,!1);return i?r.jsxs("div",{className:B("group-scope w-full overflow-hidden leading-[20px]",a===Me.LIST&&"flex",(a===Me.CELL||a===Me.FIELD)&&"p-2 break-all",(a===Me.LIST||a===Me.CALENDAR)&&"overflow-ellipsis",t),children:[pt.print?r.jsx("a",{href:fm(i),target:"_blank",className:"underline",children:i}):r.jsx("span",{className:B("border-grey5 cursor-pointer border-b text-black",(a===Me.CARD||a===Me.LIST||a===Me.CALENDAR)&&"animate-hover hover:rounded-sm"),onClick:c=>{(l||a===Me.CARD||a===Me.LIST)&&(c.stopPropagation(),window.open(e.getLinkUrl(i)))},children:i}),(a===Me.CELL||a===Me.FIELD)&&e.validate(i)&&r.jsx("a",{className:B("group-scope-hover:opacity-100 animate-hover-opaque absolute right-[5px] top-[5px] rounded border bg-white1 p-0.5 opacity-0 transition-opacity"),href:e.getLinkUrl(i),target:"_blank",rel:"noopener noreferrer",onClick:c=>{var h,p;c.stopPropagation();const{blocks:u}=le(),d=(p=(h=u[n])==null?void 0:h.data.collectionProperties)==null?void 0:p[s],f=d==null?void 0:d.find(g=>g.type===m.TextType.URL);f&&f.fileStorageType==="internal"&&(c.preventDefault(),o(n,s,f))},children:r.jsx(Fe,{popup:e.tooltip,children:r.jsx(H,{size:"middle",name:e.icon,className:"text-grey3"})})})]}):null},AF=e=>t=>e===m.CollectionSchemaType.EMAIL?`mailto:${t}`:e===m.CollectionSchemaType.PHONE?`tel:${t}`:fm(t),ree=EC({icon:"IcTitleUrl",tooltip:"访问链接",validate:e=>e.trim()!=="",getLinkUrl:AF(m.CollectionSchemaType.URL)}),aee=EC({icon:"IcTitleEmail",tooltip:"发送邮件",validate:e=>GI(e),getLinkUrl:AF(m.CollectionSchemaType.EMAIL)}),oee=EC({icon:"IcTitlePhone",tooltip:"拨打电话",validate:e=>h6(e),getLinkUrl:AF(m.CollectionSchemaType.PHONE)}),lb=bC({useValue:({recordId:e,propertyId:t})=>ae(({blocks:s})=>{var o,i;const a=(i=(o=s[e])==null?void 0:o.data.collectionProperties)==null?void 0:i[t];return pi(a)}),useSaveValue:({recordId:e,propertyId:t})=>{const n=zs();return s=>{n(e,t,s?[{type:m.TextType.URL,enhancer:{},text:s,url:s}]:void 0)}},ValueEditor:({value:e,onChange:t})=>r.jsx(yC,{autoFocus:!0,singleLine:!0,value:e,fontClassName:"whitespace-nowrap",onChange:n=>{t(n.target.value)}})}),fN=e=>{var n,s;let t=parseFloat(e);return Number.isNaN(t)&&(t=parseFloat((s=(n=e.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:n[0])!=null?s:"")),Number.isNaN(t)?"":`${p6(t)}`},iee=bC({useValue:({recordId:e,propertyId:t})=>ae(({blocks:s})=>{var o,i;const a=(i=(o=s[e])==null?void 0:o.data.collectionProperties)==null?void 0:i[t];return fN(de(a))}),useSaveValue:({recordId:e,propertyId:t})=>{const n=zs();return s=>{n(e,t,mt(fN(s)))}},ValueEditor:({site:e,value:t,onChange:n})=>r.jsx(yC,{autoFocus:!0,singleLine:!0,value:t,className:B({"text-right":e!==Me.FIELD}),fontClassName:"whitespace-nowrap",onChange:s=>{n(s.target.value)}})}),lee=({recordIds:e,recordId:t,propertyId:n,onUpdate:s,onClose:a})=>{const o=Ve(t,!1),i=ae(({blocks:b})=>{var E,w;return(w=(E=b[t])==null?void 0:E.data.collectionProperties)==null?void 0:w[n]});oA();const l=F.useRef(null),[c,u]=F.useState(""),d=zs();Yg({onUpdate:s,onClose:a,onSave:()=>{}});const f=b=>{d(e!=null?e:t,n,b)},h=b=>{const E=Sf(i);E.findIndex(w=>w.uuid===b)===-1&&(E.push(wc(b)),f(E))},p=()=>{const b=Sf(i);b.length>0&&(b.pop(),f(b))},g=b=>{var k;const E=Sf(i),w=E.findIndex(C=>C.uuid===b);w>=0&&(E.splice(w,1),f(E),(k=l.current)==null||k.focus())},_=b=>{var E;u(""),h(b),(E=l.current)==null||E.focus()},x=b=>{if(be("Esc")(b)){a();return}!c&&be("Backspace")(b)&&p()},y=Bg();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex min-h-[42px] min-w-[260px] max-w-[480px] flex-wrap items-center px-2",children:[Sf(i).map(b=>{var E;return r.jsx(pF,{userId:(E=b.uuid)!=null?E:"",showClose:!0,onClose:()=>{b.uuid&&g(b.uuid)}},b.uuid)}),!o&&r.jsx(oo,{ref:l,autoFocus:!0,singleLine:!0,placeholder:"搜索成员",fontClassName:gn({lineHeight:"24px",fontSize:14,whiteSpace:"nowrap"}),className:gn({width:"100%",selectors:{"&::placeholder":{color:"var(--grey4)"}}}),boxClassName:gn({flexBasis:"auto",flexGrow:1,flexShrink:0,minWidth:120,maxWidth:"100%"}),value:c,onKeyDown:x,onChange:b=>{u(b.target.value)}})]}),r.jsx(Rr,{}),r.jsx(wC,{className:"py-1.5",search:c,users:y,onSelectPerson:_})]})},wC=({className:e,users:t,value:n,search:s,onSelectPerson:a,customHeader:o})=>{const i=F.useMemo(()=>Cc(t,s).map(l=>({type:$.OPERATION,data:{content:r.jsx(hi,{className:"!px-0",userId:l.uuid}),value:l.uuid,onClick:()=>{a==null||a(l.uuid)}}})),[a,s,t]);return r.jsx(ze,{customHeader:o,customFooter:r.jsx(r.Fragment,{children:i.length<=0&&r.jsx("div",{className:"text-t2 relative flex h-10 items-center justify-center text-grey4",children:"没有找到相关结果"})}),className:B("text-t2 max-h-[50vh] overflow-y-auto",e),defaultActiveIndex:i.findIndex(l=>l.data.value===n),items:i})},cee=new m8.diff_match_patch;function cb(e,t){return e===void 0?t:t===void 0?e:[...e,...t]}function m1(e,t){const n=h=>{if(h!==void 0)return h.map(p=>({...p,enhancer:{...p.enhancer,backgroundColor:"var(--active_color-10)",textColor:"var(--active_color-80)"}}))},s=h=>{if(h!==void 0)return h.map(p=>({...p,enhancer:{...p.enhancer,lineThrough:!0,textColor:"#B3B3B3"}}))},a=h=>(h!=null?h:[]).reduce((p,g)=>(g.type===m.TextType.TEXT?p+=g.text:p+=" ",p),""),o=(h,p,g)=>{const _=[];let x=0;const y=g,b=g+h.length;for(const E of p!=null?p:[])if(E.type===m.TextType.TEXT){const w=x,k=x+E.text.length;x=k;const C=Math.max(w,y),T=Math.min(k,b);T-C>0&&_.push({...E,text:h.slice(C-y,T-y)})}else{const w=x,k=x+1;x=k;const C=Math.max(w,y);Math.min(k,b)-C>0&&_.push(E)}return _},i=a(e),l=a(t),c=cee.diff_main(i,l);let u,d=0,f=0;for(const h of c){const[p,g]=h;if(p<0){let _=o(g,e,d);_=s(_),u=cb(u,_),d+=g.length}else if(p>0){let _=o(g,t,f);_=n(_),u=cb(u,_),f+=g.length}else{const _=o(g,t,f);u=cb(u,_),d+=g.length,f+=g.length}}return u}const lxe=({className:e,isTitle:t=!1,segmentsA:n,segmentsB:s})=>{const a=m1(n,s);return r.jsx(Pn,{className:B("leading-[20px] text-t2",e),plugins:t?kr:void 0,segments:a,interactable:!1})},ub=new WeakMap,Pr=(e,t)=>{const n=xn(),s=fr(),a=t!=null?t:"segments",o=ke(),i=F.useCallback(function*(f){yield a==="caption"?f.data.caption:a==="description"?f.data.description:f.data.segments},[a]),l=F.useRef(),c=F.useRef(ll),u=F.useMemo(()=>fs(()=>{var x,y,b;const f=l.current,h=le().blocks[e];if(!f||!h)return;if(c.current<ll){c.current=ll;return}const p=(x=h.data[a])!=null?x:[],g=(y=ub.get(p))!=null?y:f.offset,_=uee(e,p,(b=f.segments)!=null?b:[]);o(()=>{ee(bs({init(){pe(e,{data:{[a]:p}}),_.forEach(E=>{db(E,m.BlockStatus.DELETED)}),tc(e,i)},redo(){pe(e,{data:{[a]:p}}),_.forEach(E=>{db(E,m.BlockStatus.DELETED)}),tc(e,i),s(e,g,t)},undo(){pe(e,{data:{[a]:f.segments}}),_.forEach(E=>{db(E,m.BlockStatus.NORMAL)}),tc(e,i),s(e,f.offset,t)}}))}),l.current=void 0},500,{leading:!1}),[s,i,a,o,t,e]);return F.useMemo(()=>(f,h)=>{var x,y,b,E,w;const p=a==="segments"&&((x=le().blocks[e])==null?void 0:x.type)===m.BlockType.CODE,g=n(p?`${e}_mock`:e,!0);if(c.current=ll,!l.current){const k=le().blocks[e];if(!k)return;if(h){const[C,T]=h;l.current={segments:Qs(C),offset:(y=T==null?void 0:T.offset)!=null?y:0}}else{const C=k.data[a];l.current=C?{segments:C,offset:k.data[a]&&(b=ub.get(C))!=null?b:0}:{segments:void 0,offset:0}}}ee(mn({ignoreOp:!0,uuid:e,patch:{data:{[a]:f}}})),tc(e,i,o);const _=le().blocks[e];ub.set(_.data[a],(w=(E=g.selection)==null?void 0:E.offset)!=null?w:0),u()},[n,a,i,u,o,e])},tc=(e,t,n)=>{var u;const s=le().blocks[e];if(s==null)return;const a=((u=s.discussions)!=null?u:[]).filter(d=>{const f=le().discussions[d];return de(f==null?void 0:f.context)!==""}),o=[];for(const d of t(s))o.push(...wK(d));const i=X3(a,o),l=X3(o,a),c=()=>{if(i.length>0)for(const d of i)ee(ng({uuid:d,parentId:e,spaceId:s.spaceId}));if(l.length>0)for(const d of l)ee(tg({uuid:d,parentId:e}))};(i.length>0||l.length>0)&&(n?n(c):c())},uee=(e,t,n)=>{const s=l=>new Set(l.map(c=>{if(c.type===m.TextType.LINK_PAGE&&c.uuid){const u=le().blocks[c.uuid];if(u&&u.parentId===e)return c.uuid}return null}).filter(Boolean)),a=s(n),o=s(t),i=[];for(const l of a)o.has(l)||i.push(l);return i},db=(e,t)=>{ee(mn({uuid:e,patch:{status:t}}))},dee=e=>{const{blocks:t}=le(),n=e[0];if(!n)return;const s=t[n];if(!s)return;const a=t[s.parentId];if(!a)return;const o=a.subNodes.indexOf(n);if(o<1)return;const i=a.subNodes[o-1];if(!i)return;const l=t[i];l&&ZV(l)&&e.forEach(c=>{ee(tr({uuid:c})),ee(Wn({uuid:c,parentId:i}))})},FB=e=>{const{blocks:t}=le(),n=e[0],s=pn(e);if(!n||!s)return;const a=t[n];if(!a||!t[s])return;const i=t[a.parentId];if(!i||Kc()===i.uuid||i.type===m.BlockType.COLUMN||i.type===m.BlockType.SYNC_CONTAINER)return;const l=i.subNodes.indexOf(s);l>-1&&i.subNodes.slice(l+1).forEach(u=>{ee(tr({uuid:u})),ee(Wn({uuid:u,parentId:s}))}),e.reduce((c,u)=>(ee(tr({uuid:u})),ee(Wn({uuid:u,parentId:i.parentId,after:c})),u),i.uuid)},fee=e=>{const t=ke(),n=Pl(e!=null?e:""),s=fr(),a=lF(),o=i=>{if(!be(["Tab","Shift+Tab"])(i))return;if(a){ye.loading({key:"tab-key-page-loading",content:"Tab功能请等待文档加载完毕",duration:3e3});return}const{blocks:l,ui:c}=K,{selectedBlocks:u}=c,d=u.length?Es(u):e?[e]:[],f=u.some(g=>g.mindMapId),h=d[0];if(!h)return;const p=l[h];p&&([m.BlockType.PAGE].includes(p.type)||f||(i.preventDefault(),t(()=>{var g,_;if(i.shiftKey)FB(d);else{dee(d);const x=K.blocks[p.uuid];if(x){const y=l[x.parentId];((y==null?void 0:y.type)===m.BlockType.FOLD_LIST||(y==null?void 0:y.type)===m.BlockType.TOGGLE_HEADER||ZR(y==null?void 0:y.uuid))&&Po(x.parentId,!0)}}if(e){const x=ls(e);if(!x||xo((g=K.blocks[x])==null?void 0:g.type))return;const y=(_=nr(n))==null?void 0:_.selection;if(!y)return;const{offset:b}=y;xs(50).then(()=>{ee(bs({init(){s(e,b)},redo(){s(e,b)},undo(){s(e,b)}}))})}})))};return F.useCallback(o,[n,s,a,t,e])},mee=(e,t)=>t?document.querySelector(`[data-sync-id="${t}"][data-block-id="${e}"] [contenteditable]`):document.querySelector(`[data-block-id="${e}"] [contenteditable]`),hee=()=>{const e=window.getSelection();if(!(e.rangeCount<1))return e.getRangeAt(0)},Zr=e=>{const t=nr(e);if(!t)return;const{selection:n}=t;if(!n)return;let s=n.offset,{endOffset:a}=n;n.isCollapsed&&t.content.length>0&&(a===t.content.length?s-=1:/^[\r\n]/.test(br(yr(t.content,s,s+1)))||(a+=1));const o=t.getBoundingClientRectOfRange(s,a)||(console.warn("editorModel.getBoundingClientRectOfRange returns null"),new DOMRect);if(t.content.length===0)return{caretRect:o,collapsed:n.isCollapsed,isFirstLine:!0,isLastLine:!0,isFirstChar:!0,isLastChar:!0};const i=t.getBoundingClientRectOfRange(0,1),l=t.getBoundingClientRectOfRange(t.content.length-1,t.content.length),c=br(t.content),u=c.indexOf(`
`),d=c.lastIndexOf(`
`),f=o.top===(i==null?void 0:i.top)&&(s<=u||u===-1),h=o.bottom===(l==null?void 0:l.bottom)&&(a>d||d===-1),p=f&&n.focusOffset<=0,g=h&&n.focusOffset>=t.content.length;return{caretRect:o,collapsed:n.isCollapsed,isFirstLine:f,isLastLine:h,isFirstChar:p,isLastChar:g}},Rf=e=>{const{symbol:t,model:n}=e,s=t.length,{selection:a}=n,{focusOffset:o}=a||{};if(!a||!o)return{};const i=pee(n,a.offset-s,t);if(i<=0)return{};const l=i>=s+1&&i!==-1?h1(n,i-(s+1),i-s):"";try{const c=h1(n,i,o-s),u=h1(n,i-s,o),d=u.startsWith(t)&&u.endsWith(t),f=c&&c!==" "&&!c.includes([...new Set(t.split(""))].join(""));return(!l||l===" "||!/^[\x00-\x7F]*$/.test(l))&&d&&f?{hitText:u,lastSameIndex:i}:{lastSameIndex:i}}catch(c){return{}}},h1=(e,t,n)=>br(yr(e.content,t,n)),pee=(e,t,n)=>{for(;t>0&&t-n.length>0;){const s=h1(e,t-n.length,t);if(n===s)break;t--}return t},gee=e=>{const t=xn();return F.useCallback(n=>new Promise(s=>{var i,l;const a=t(e);if(!a){s(!1);return}((l=(i=a.selection)==null?void 0:i.focusOffset)!=null?l:0)<2&&s(!1);const o=a.onAfterInput.subscribe(()=>{if(o.unsubscribe(),n===">"){const{hitText:c}=Rf({model:a,symbol:"<u>"});c&&s("underline")}if(n==="="){const{hitText:c}=Rf({model:a,symbol:"=="});c&&s("highlight")}s(!1)})}),[t,e])},Fr=(e,t,n)=>{requestAnimationFrame(async()=>{if(!e)return;let s=nr(e);if(s||(s=nr(`${e}_mock`)),!s)return;const a=await(async()=>{if(t===0&&n===0)return 0;if(n===1/0)return s.content.length;s.performChange(l=>{l.select(n===1/0?s.content.length:0)}),await s.scrollCaretIntoViewIfNeeded(),await new Promise(l=>setTimeout(l,0));const o=s.getBoundingClientRectOfRange(0,0),i=s.getBoundingClientRectOfRange(s.content.length,s.content.length);if(!(!o||!i))return t=Zn(t,o.left+.01,i.right-.01),n=Zn(n,o.top+.01,i.bottom-.01),s.hitTest(t,n)})();a!=null&&(s.performChange(o=>{o.select(a)}),await s.requestFocus())})},yB=(e,t,n)=>{if(!e)return;let s=null;return t?s=jn(`[data-block-id='${e}'][data-sync-id='${t}'] [data-editor]`,n):s=jn(`[data-block-id='${e}'] [data-editor]`,n),(s==null?void 0:s.getAttribute("data-editor"))||e},bB=e=>{const t=e==null?void 0:e.closest("[data-editor]");return(e==null?void 0:e.getAttribute("data-editor"))||(t==null?void 0:t.getAttribute("data-editor"))},_ee=e=>{if(!(e!=null&&e.querySelector))return;const t=e.querySelector("[data-editor]");return e.getAttribute("data-editor")||(t==null?void 0:t.getAttribute("data-editor"))},cxe=e=>{const t=e==null?void 0:e.closest("[data-sync-id]"),n=(e==null?void 0:e.getAttribute("data-sync-id"))||(t==null?void 0:t.getAttribute("data-sync-id"));if(n)return n},uxe=e=>{if(!e)return;const t=document.querySelector(`[data-block-id] [data-editor='${e}']`);if(!t)return;const n=t.closest("[data-block-id]");if(n instanceof HTMLElement)return n},dxe=e=>{const t=document.querySelector(`[data-editor="${e}"]`);if(t){const n=t.closest("[data-table-row-id]");if(n)return n.dataset.tableRowId;const s=t.closest("[data-modal-id]");if(s){const{modalId:a}=s.dataset;if(a!=null&&a.startsWith("cell-"))return a.slice(5,41)}}return e},EB=e=>{const t=ef(),n=qi(),s=On(),a=Os(),o=Pl(e),i=l=>{const c=Zr(o);if(!(c!=null&&c.collapsed)||!c.isFirstLine)return;l.preventDefault();const u=Qm(e),d=K.blocks[u];if(!d)return;const f=ls(d.uuid);if(!f)return;const h=_d(s),g=h.findIndex(_=>_.blockId===d.uuid&&_.syncId===a)-1;if(g>=0){const _=h[g];if(!_)return;l.preventDefault(),n(),Fr(_.editorKey,c.caretRect.x,0),t(f,_.blockId)}else Fr(f,c.caretRect.x,0)};return F.useCallback(i,[n,o,s,t,a,e])},wB=e=>{const t=ef(),n=qi(),s=On(),a=Os(),o=i=>{const l=yB(e,a,s);if(!l)return;const c=Zr(l);if(!(c!=null&&c.collapsed)||!c.isLastLine)return;const u=Qm(e),d=K.blocks[u];if(!d)return;const f=ls(d.uuid);if(!f)return;const h=_d(s),g=h.findIndex(_=>_.blockId===d.uuid&&_.syncId===a)+1;if(g<h.length){const _=h[g];if(!_)return;i.preventDefault(),n(),Fr(_.editorKey,c.caretRect.x,0),t(f,_.blockId)}};return F.useCallback(o,[n,s,t,a,e])},xee=e=>{const t=ef(),n=qi(),s=On(),a=Os(),o=Pl(e),i=l=>{const c=Zr(o);if(!(c!=null&&c.collapsed)||!c.isLastChar)return;const u=Qm(e),d=K.blocks[u];if(!d)return;const f=ls(d.uuid);if(!f)return;const h=_d(s),g=h.findIndex(_=>_.blockId===d.uuid&&_.syncId===a)+1;if(g<h.length){const _=h[g];if(!_)return;n(),l.preventDefault(),Fr(_.editorKey,0,0),t(f,_.blockId)}};return F.useCallback(i,[n,o,s,t,a,e])},Fee=e=>{const t=ef(),n=qi(),s=On(),a=Os(),o=Pl(e),i=l=>{const c=Zr(o);if(!(c!=null&&c.collapsed)||!c.isFirstChar)return;l.preventDefault();const u=Qm(e),d=K.blocks[u];if(!d)return;const f=ls(d.uuid);if(!f)return;const h=_d(s),g=h.findIndex(_=>_.blockId===d.uuid&&_.syncId===a)-1;if(g>=0){const _=h[g];if(!_)return;n(),l.preventDefault(),Fr(_.editorKey,1/0,1/0),t(f,_.blockId);return}Fr(f,1/0,1/0)};return F.useCallback(i,[n,o,s,t,a,e])};function BF(e){e.icon&&Nn("last_mark_info_icon",e.icon),e.textColor?(Nn("last_mark_info_text_color",e.textColor),localStorage.removeItem("last_mark_info_background_color")):e.backgroundColor&&(Nn("last_mark_info_background_color",e.backgroundColor),localStorage.removeItem("last_mark_info_text_color"))}function yee(){const e={},t=localStorage.getItem("last_mark_info_text_color"),n=localStorage.getItem("last_mark_info_background_color"),s={icon:localStorage.getItem("last_mark_info_icon")};return t?e.textColor=t:n&&(e.backgroundColor=n),s.icon&&(e.data={icon:{value:s.icon,type:"emoji"}}),e}const kB=(e,t)=>{const n=e.clientY,s=e.clientX;return bee(s,n,t)},mN=40,bee=(e,t,n)=>{var i;const s=(n||document.body).querySelectorAll("[data-block-id]:not(.card):not(.hide-sync-block-child):not([data-column-list]), [data-drop-in-child]");let a,o=1/0;for(const l of s){const c=l.getBoundingClientRect(),u=parseInt(getComputedStyle(l).getPropertyValue("margin-top"),10),d=parseInt(getComputedStyle(l).getPropertyValue("margin-bottom"),10);if(t>c.top-u&&t<c.bottom+d&&e>c.left-mN&&e<c.right+mN){const f=(e-c.left)**2,h=(t-(c.top-d))**2,p=f+h;p<o&&(o=p,a=l)}}return{blockId:(i=a==null?void 0:a.closest("[data-block-id]"))==null?void 0:i.dataset.blockId,node:a}},x0=e=>{if(e===m.BlockType.MARK){const t=yee();return!t.textColor&&!t.backgroundColor&&(t.backgroundColor=Pe.grey),t}return{}},Cu={backgroundColor:"",data:{segments:[]},status:1,subNodes:[],textColor:"",version:0,permissions:[]},F0=(e,t,n)=>{const{blocks:s}=le(),a=s[t];if(!a)return;if(a.type===m.BlockType.COLUMN){const u=qe();return ee(Ia({block:{...Cu,type:m.BlockType.COLUMN,uuid:u,parentId:t,spaceId:a.spaceId,data:{...Cu.data,columnRatio:1}}})),ee(n==="left"?Ii({uuid:u,parentId:a.parentId,before:t}):Wn({uuid:u,parentId:a.parentId,after:t})),e.forEach(d=>{const f=s[d];f&&(a0(d),ee(tr({uuid:d,parentId:f.parentId})),ee(Wn({uuid:d,parentId:u})),Fd(f.uuid,f.parentId))}),u}const o=qe();ee(Ia({block:{...Cu,uuid:o,type:m.BlockType.COLUMN_LIST,parentId:a.parentId,spaceId:a.spaceId}})),ee(Wn({uuid:o,parentId:a.parentId,after:t}));const i=qe();ee(Ia({block:{...Cu,type:m.BlockType.COLUMN,uuid:i,parentId:o,spaceId:a.spaceId,data:{...Cu.data,columnRatio:1}}})),ee(Wn({uuid:i,parentId:o}));const l=qe();return ee(Ia({block:{...Cu,type:m.BlockType.COLUMN,uuid:l,parentId:o,spaceId:a.spaceId,data:{...Cu.data,columnRatio:1}}})),ee(Wn({uuid:l,parentId:o,after:i})),e.forEach(c=>{const u=s[c];u&&(a0(c),ee(tr({uuid:c})),ee(tr({uuid:t})),n==="left"?(ee(Wn({uuid:c,parentId:i})),ee(Wn({uuid:t,parentId:l}))):(ee(Wn({uuid:t,parentId:i})),ee(Wn({uuid:c,parentId:l}))),Fd(u.uuid,u.parentId))}),l},CB=(e,t,n)=>{var p,g;const{blocks:s}=le(),a=(p=n==null?void 0:n.createEmptyTextBlock)!=null?p:!0,o=(g=n==null?void 0:n.autoTrim)!=null?g:!0,i=n==null?void 0:n.convertBlock,l=s[e];if(!l||!s[l.parentId])return;const u=h8([Pe.grey,Pe.brown,Pe.orange,Pe.yellow,Pe.green,Pe.blue,Pe.purple,Pe.pink,Pe.red],t),d=xc(l.data),f=mG(e,[m.BlockType.COLUMN_LIST]);let h=l.uuid;d&&!f&&o?i([h],{type:m.BlockType.COLUMN_LIST,backgroundColor:""}):h=Qe({type:m.BlockType.COLUMN_LIST},{parentId:l.parentId,after:l.uuid});for(let _=0;_<t;_++){const x=Qe({type:m.BlockType.COLUMN,data:{columnRatio:1}},{parentId:h});a&&Qe({type:m.BlockType.TEXTAREA,backgroundColor:u[_]},{parentId:x})}return h},_s=(e,t)=>{var s,a,o;const{blocks:n}=le();if(t.type===m.BlockType.SYNC_CONTAINER){const i=(a=n[(s=e[0])!=null?s:""])==null?void 0:a.parentId;i&&TB(e,i);return}if(t.type===m.BlockType.COLUMN_LIST&&e.length>1){const i=CB(e[0],e.length,{createEmptyTextBlock:!1,autoTrim:!1,convertBlock:_s});(o=K.blocks[i!=null?i:""])==null||o.subNodes.forEach((l,c)=>{const u=e[c];u&&Ri([u],{parentId:l})});return}e.forEach(async i=>{var f,h,p,g,_,x;const{type:l,...c}=t,u=n[i];if(!u)return;const d=u.type===m.BlockType.FILE&&l===m.BlockType.REFERENCE;if(!(!Kw.includes(u.type)&&!d)){if(l===u.type){if(l===m.BlockType.HEADER||l===m.BlockType.TOGGLE_HEADER){if(u.data.level===((f=t.data)==null?void 0:f.level))return}else if(l!==m.BlockType.REFERENCE)return}if(l===m.BlockType.MARK&&(u.data.icon||(c.data={...c.data,icon:{type:"emoji",value:"💡"}}),!u.textColor&&!u.backgroundColor)){const y=x0(m.BlockType.MARK),{data:b,...E}=y;Object.assign(c,E),c.data={...c.data,...b}}if(l===m.BlockType.CODE){const y=hg();c.data&&(c.data.format={...(h=c.data)==null?void 0:h.format,language:y!=null?y:Om})}if((l===m.BlockType.MIND_MAPPING||l===m.BlockType.MIND_MAPPING_PAGE)&&(c.data||(c.data={}),c.data.format={...c.data.format,mindMappingFormat:{...(p=c.data.format)==null?void 0:p.mindMappingFormat,oldBlockType:u.type}}),l===m.BlockType.PAGE&&(c.data||(c.data={}),c.data.format||(c.data.format={}),typeof u.data.pageFixedWidth!="boolean"&&Object.assign(c.data,{pageFixedWidth:rk(),directoryMenu:(g=K.user.setting)==null?void 0:g.directoryMenu}),Object.assign(c.data.format,{pageLayout:(_=cm())==null?void 0:_.setting.pageLayout,fontFormat:(x=cm())==null?void 0:x.setting.fontFormat})),ee(mn({uuid:i,patch:{type:l,...c}})),[m.BlockType.EQUATION,m.BlockType.CODE].includes(l)&&u.subNodes.reduce((y,b)=>(ee(tr({uuid:b})),ee(Wn({uuid:b,parentId:u.parentId,after:y})),b),i),u.type===m.BlockType.PAGE){const y=await Ce.editor.getDoc(u.uuid),b=Object.entries(y.blocks).reduce((E,[w,k])=>(n[w]||(E[w]=k),E),{});ee(Gn.update({blocks:b}))}}})},TB=(e,t)=>{const n=e[0];if(!n)return;const s=Qe({type:m.BlockType.SYNC_CONTAINER},{parentId:t,before:n});return Ri(e,{parentId:s}),s};iZ(_s);const hN=(e,t)=>{var d,f;const{blocks:n}=le(),s=n[e];if(!s)return;const a=i2(s);if(s.type!==m.BlockType.TEXTAREA&&!a)return;const o=n[t];if(!o)return;const i=i2(o)?"caption":"segments",l=a?"caption":"segments",u=((d=o.data[i])!=null?d:[]).concat((f=s.data[l])!=null?f:[]);s.subNodes.reduce((h,p)=>(ee(tr({uuid:p})),ee(Wn({uuid:p,parentId:s.parentId,after:h})),p),s.uuid),l==="segments"?(ee(mn({uuid:e,patch:{status:m.BlockStatus.DELETED}})),ee(tr({uuid:e}))):ee(mn({uuid:e,patch:{data:{caption:[],showEmptyCaption:!1}}})),ee(mn({uuid:t,patch:{data:{[i]:u}}})),Fd(s.uuid,s.parentId)},Eee=(e,t)=>{const n=ke(),s=On(),a=Os(),o=fr(),i=xn(),l=F.useContext(io),c=u=>{var E;const{blocks:d}=le();if(!ls(e))return;const h=d[e];if(!h)return;const p=d[h.parentId];if(!p)return;const g=(E=i(e))==null?void 0:E.selection;if(!g||!g.isCollapsed||g.offset!==0)return;if(u.preventDefault(),u.stopPropagation(),h.type!==m.BlockType.TEXTAREA&&h.type!==m.BlockType.CODE&&t==="segments"){n(()=>{_s([h.uuid],{type:m.BlockType.TEXTAREA}),ee(bs({init(){},redo(){o(h.uuid,0)},undo(){o(h.uuid,0)}}))});return}const _=[m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(p.type)&&p.subNodes.length===1&&pn(p.subNodes)===e||m.BlockType.TEMPLATE===p.type&&pn(p.subNodes)===e;if(p.type!==m.BlockType.PAGE&&p.type!==m.BlockType.COLUMN&&p.type!==m.BlockType.SYNC_CONTAINER&&pn(p.subNodes)===e&&!_&&t==="segments"){n(()=>{FB([e]),ee(bs({init(){o(e,0)},redo(){o(e,0)},undo(){o(e,0)}}))});return}const x=_d(s),y=x.findIndex(w=>w.blockId===e&&w.syncId===a),b=x[h.type===m.BlockType.CODE&&t==="caption"?y:y-1];if(b&&!l){const w=Si(b.blockId,void 0,b.syncId),k=nr(w);n(()=>{const C=i2(d[b.blockId])?"caption":"segments";hN(h.uuid,b.blockId),ee(bs({init(){o(b.blockId,(k==null?void 0:k.content.length)||0,C,{syncId:b.syncId})},redo(){o(b.blockId,(k==null?void 0:k.content.length)||0,C,{syncId:b.syncId})},undo(){o(e,0,t)}}))});return}if(p.type===m.BlockType.PAGE&&t==="segments"){const w=de(p.data.segments);n(()=>{hN(h.uuid,p.uuid),ee(bs({init(){o(p.uuid,w.length)},redo(){o(p.uuid,w.length)},undo(){o(e,0)}}))})}p.type===m.BlockType.SYNC_CONTAINER&&n(()=>{Gs(h.uuid)})};return F.useCallback(c,[l,o,i,s,t,a,n,e])},y0=(e,t,n=1/0)=>{if(!e)return[];const s=[];let a=0;for(const o of e){const i=a,l=a+o.text.length;let{text:c}=o;if(a+=c.length,l<=t)continue;if(i>=n)break;let u=0,d=c.length;t>i&&(u=t-i),l>n&&(d=c.length-(l-n)),c=c.slice(u,d),s.push({...o,text:c})}return s},vB=e=>{const t=ke(),n=xn(),s=fr(),a=o=>{var h;const{blocks:i}=le(),l=i[e];if(!l)return;const c=(h=n(e))==null?void 0:h.selection;if(!c||!c.isCollapsed||c.offset!==1)return;const[u]=y0(l.data.segments,0,1);if(!u)return;const d=u.text;if(d!=="["&&d!=="【")return;o==null||o.preventDefault();const f=y0(l.data.segments,1);o&&pe(l.uuid,{data:{segments:[{...u,text:`${d}${o.key}`},...f]}},!0),t(()=>{pe(l.uuid,{type:m.BlockType.TODO,data:{segments:f}}),ee(bs({init(){s(l.uuid,0)},redo(){s(l.uuid,0)},undo(){s(l.uuid,2)}}))})};return F.useCallback(a,[s,n,t,e])},wee=(e,t)=>{const n=ke(),s=qi(),a=xn(),o=fr(),i=l=>{l.preventDefault();const{blocks:c}=le(),u=c[e],d=a(e),f=d==null?void 0:d.selection;if(!u||!d||!f||d.isComposing)return;if(l.shiftKey){d.performChange(I=>{I.replace(`
`)});return}if(de(u.data.segments)===""&&[m.BlockType.TODO,m.BlockType.HEADER,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(u.type)){n(()=>{pe(u.uuid,{type:m.BlockType.TEXTAREA}),o(u.uuid,0)});return}const{content:p}=d,{offset:g,endOffset:_}=f,x=br(p);if(/(\$\$|￥￥)$/.test(x)){pe(u.uuid,{type:m.BlockType.EQUATION,local:!0,data:{...u.data,segments:[]}});return}if(f.isCollapsed&&g===p.length&&/^(?:(`|·){3,}|~{3,}|～{3,})[A-Za-z#() +.-]*$/.test(x)){const I=Jk(x.slice(3).trim());Nn(Bx,I);const j=qe();n(()=>{Qe({uuid:j,type:m.BlockType.CODE,data:{format:{language:I}}},{parentId:u.parentId,after:u.uuid}),ha(u.uuid),ee(bs({init(){setTimeout(()=>{o(`${j}_mock`,0)},150)},undo(){o(u.uuid,g)},redo(){setTimeout(()=>{o(`${j}_mock`,0)},150)}}))});return}const[y]=Qb(p,g),[,b]=Qb(p,_),E=Qs(y),w=Qs(b);if(g===0){const I=c[u.parentId];if(!I)return;const j=I.subNodes.indexOf(u.uuid),D=I.subNodes[j-1];t==="segments"?(n(()=>{pe(u.uuid,{data:{segments:w}}),Qe({},D?{parentId:u.parentId,after:D}:{parentId:u.parentId,first:!0})}),o(u.uuid,0)):n(()=>{pe(u.uuid,{data:{showEmptyCaption:!1,caption:[]}});const S=Qe({data:{segments:w}},{parentId:u.parentId,after:u.uuid});o(S,0)}),s();return}let k=m.BlockType.TEXTAREA,C={parentId:u.parentId,after:u.uuid};const T=[m.BlockType.TEXTAREA,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.TODO,m.BlockType.FOLD_LIST],v=wt.$expandFoldRecord[u.uuid];if(Sg(u.type)&&!v)T.includes(u.type)&&(k=u.type);else{const[I]=u.subNodes,j=I?c[I]:void 0;(j||[m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(u.type))&&(C={parentId:u.uuid,first:!0}),j&&T.includes(j.type)&&(k=j.type)}n(()=>{pe(u.uuid,{data:{[t]:E}});const I=Qe({type:k,data:{segments:w,level:u.data.level}},C);s(),ee(bs({init(){o(I,0)},undo(){o(u.uuid,g)},redo(){o(I,0)}}))})};return F.useCallback(i,[e,a,n,o,t,s])},kee=4,pN=8,Cee=({onCloseModal:e,blockId:t,left:n,right:s,symbol:a="",getEditorModel:o,search:i})=>{const[l,c]=F.useState(i),u=p8(l!=null?l:"",{wait:800}),d=me(),f=F.useRef(void 0),[h,p]=F.useState(0);F.useEffect(()=>{const _=o(t);if(!_)return;const{selection:x}=_;if(!x||!x.isCollapsed)return;const y=_.createCursor(s,"right");f.current=y,i?_.performChange(k=>{k.select(n,s).replace(i).collapse("end")}):a||_.performChange(k=>{k.select(n,s).replace(":").collapse("end")});const b=_.createCursor(n+1-a.length,"left"),E=n,w=_.onContentChange.subscribe(()=>{if(_.selection){const{focusOffset:T}=_.selection;if(T<=E){e();return}}const k=yr(_.content,b.offset,y.offset),C=br(k);c(C)});return()=>{w.unsubscribe(),y.release(),b.release()}},[t,o,n,e,s,i,a]);const g=F.useCallback((_,x,y)=>{if(!y&&x&&_.skin)return d.dropdown({popcorn:x.currentTarget,placement:"bottom",content:({onCloseModal:E})=>r.jsx(_2,{emoji:_,onSelect:w=>{E(),e();const k=o(t);k==null||k.performChange(C=>{var T;C.select(n-a.length,(T=f.current)==null?void 0:T.offset).replace(yn([zn(Ed,{text:w.native})])).collapse("end")}),k==null||k.requestFocus()}})}),!0;e();const b=o(t);b==null||b.performChange(E=>{var w;E.select(n-a.length,(w=f.current)==null?void 0:w.offset).replace(yn([zn(Ed,{text:_.native})])).collapse("end")}),b==null||b.requestFocus()},[t,o,n,e,d,a.length]);return F.useEffect(()=>{if(!u)return;const _=Lu.search(u);if(_!=null&&_.length)p(0);else{const x=u.replace(/[^\x00-\xff]/g,"**").length;x>kee&&x<pN?p(x):x>=pN&&e()}},[e,u]),h?null:r.jsx("div",{className:"next-modal w-[418px]",children:r.jsx(g2,{useButton:!0,onSelect:g,keyword:u,hideSearchInput:!0})})},Tee=({onCloseModal:e,blockId:t,left:n,right:s,symbol:a="",getEditorModel:o})=>{const i=o(t);return F.useEffect(()=>{if(!i)return;const{selection:l}=i;if(!l)return;const c=i.createCursor(n,"left"),u=i.createCursor(s,"right");i.performChange(d=>{d.shadow().select(n,s).replace(yn([zn(vi,{open:!0})])).collapse("end")}),e(),c.release(),u.release()},[t,i,n,e,s,a]),null},NB=()=>{const e=$c(),t=On(),n=Gd(),{setting:s={}}=Qt(),a=(o,i)=>{if(o){if(!i&&!t&&!wt.$isMobileSize&&s.useRightPageByNew){n(o);return}e.push(`/${o}`)}};return F.useCallback(a,[e,t,n,s.useRightPageByNew])},IB=()=>{const e=ke(),t=NB();return F.useCallback(n=>{const{setFakeFocus:s,left:a,blockId:o,editorModel:i,title:l=""}=n;if(!i.selection)return;const{endOffset:c}=i.selection,u={type:m.BlockType.PAGE};l&&(u.data={segments:mt(l)}),e(()=>{const d=Qe(u,{parentId:o,inline:!0});let f=c;!s&&l&&(f=a+l.length+1),i.performChange(h=>{h.shadow().select(a,f).replace(yn([zn(oi,{pageId:d})])),h.select(f)}),l||oa(()=>{t(d)})},{noThrottle:!0})},[t,e])},gN=[m.BlockType.FOLDER,m.BlockType.FILE],vee=({onCloseModal:e,blockId:t,left:n,title:s,setFakeFocus:a,getEditorModel:o})=>{const i=ks(),l=ke(),c=F.useMemo(()=>dp({ancestorId:Ut(),filterTypes:gN}),[]);return r.jsx(yc,{defaultValue:c,onSelect:u=>{if(a==null||a(!1),gN.includes(u.type)){ye.warning("不能在文件夹内创建页面"),e();return}const d=o(t);if(!d)return;const f={type:m.BlockType.PAGE};s&&(f.data={segments:mt(s)}),l(()=>{const h=Qe(f,{parentId:u.uuid});d.performChange(p=>{d.selection&&p.shadow().select(n,d.selection.focusOffset).replace(yn([zn(oi,{pageId:h})]))}),d.requestFocus()},{noThrottle:!0}),e(),i(Ae.GUIDE_FIRST_TIME_LINK_PAGE,We.advancedList),i(Ae.CREATE_REF_PAGE,We.advancedList)}})},jB=e=>{const{onCloseModal:t,blockId:n,left:s,right:a,getEditorModel:o,setFakeFocus:i}=e,l=ks(),c=IB(),[u,d]=F.useState(!1),f=dA({...e,symbol:"[[",tip:"输入内容进行搜索或创建",changeTipWhenComposing:!0}),{pageList:h,setPageFold:p,loading:g}=fA({keyword:f}),_=F.useMemo(()=>{const x=f?`"${f}"`:"";return[{type:$.BLOCK_TEXT,data:{title:"引用页面",icon:g&&r.jsx(hs,{size:"large"})}},...h,{type:$.LINE,data:{},disableClick:!0},{type:$.CUSTOM_RENDER,render(){return r.jsxs("div",{className:"flex items-center py-2 animate-hover px-4",onClick:y=>{y.stopPropagation();const b=o(n);if(!b)return;let E=n;K.blocks[E]||(E=b.editorElement.dataset.realBlockId),c({setFakeFocus:i,editorModel:b,blockId:E,title:f,left:s,right:a}),t()},children:[r.jsx(H,{name:"IcBtnNew",size:"middle"}),r.jsx("div",{className:"ml-1 text-t2 text-grey3 text-ellipsis",children:`创建行内页面 ${x}`})]})}},{type:$.CUSTOM_RENDER,render(){return r.jsxs("div",{className:"flex items-center py-2 animate-hover px-4",onClick:()=>{i==null||i(!0),d(!0),l(Ae.CREATE_REF_PAGE,We.advancedList)},children:[r.jsx(H,{name:"IcTitleRelation",size:"middle"}),r.jsx("div",{className:"ml-1 text-t2 text-grey3 text-ellipsis",children:`创建新的行内引用页面 ${x}`})]})}}]},[f,g,h,o,n,c,i,s,a,t,l]);return u?r.jsx(vee,{...e,title:f}):r.jsx(ze,{virtualList:!0,defaultActiveIndex:1,className:"w-60 next-modal py-2 overflow-y-auto",items:_,onItemClick:(x,y,b)=>{const E=o(n);if(!E)return;if(x.data.categoryType===Na.page&&l(Ae.CREATE_REF_PAGE,We.advancedList),x.data.categoryType===Na.foldPage){b.preventDefault(),p(!1),E.requestFocus();return}if(!E.selection)return;const{focusOffset:w}=E.selection;let k=w;!i&&f&&(k=s+f.length+1),E.performChange(C=>{C.shadow().select(s,k).replace(yn([zn(oi,{pageId:x.data.uuid})])),C.select(k)}),E.requestFocus(),l(Ae.GUIDE_FIRST_TIME_LINK_PAGE,We.advancedList),t()}})},Nee=({onCloseModal:e,blockId:t,left:n,right:s,symbol:a="",getEditorModel:o})=>{const i=Bg();F.useEffect(()=>{const u=o(t);if(!u)return;const d=u.createCursor(n,"left"),{selection:f}=u;if(!f||!f.isCollapsed)return;const h=u.createCursor(f.focusOffset,"right");u.performChange(y=>{y.select(n,s).replace(yn([zn(zo,{tip:"选择成员"})])).collapse("end")}),h.offset=d.offset+1;const p=u.onSelectionChange.subscribe(()=>{if(u.selection){const{focusOffset:y}=u.selection;(y<=d.offset||h.offset<y)&&e()}}),g=u.onBeforeInput.pipe(OE()).subscribe(()=>{x(),e()});let _=!1;const x=()=>{if(_)return;_=!0;const b=yr(u.content,d.offset,h.offset).items[0];b&&b.type==="element"&&b.tag===zo&&(u.performChange(E=>{E.shadow().select(d.offset,h.offset).replace(a)}),u.requestFocus()),d.release(),h.release(),p.unsubscribe(),g.unsubscribe()};return()=>{x()}},[t,n,e,a,s,o]);const[l,c]=F.useState("");return r.jsx("div",{className:"w-[260px] py-2 next-modal",children:r.jsx(wC,{customHeader:r.jsx(xt,{autoFocus:!0,className:"h-8 mx-2.5 mb-2.5",placeholder:"搜索成员",onChange:u=>{c(u)}}),className:"py-1.5",search:l,users:i,onSelectPerson:u=>{const d=o(t);d&&(d.performChange(f=>{f.shadow().select(n,n+1).replace(yn([zn(Wd,{userId:u})]))}),d.requestFocus(),e())}})})},Iee=({onCloseModal:e,blockId:t,inlineType:n,left:s,right:a,onGlobalCaptureKeydown:o,symbol:i,getEditorModel:l,keyword:c})=>{switch(n){case Dr.DATE:return r.jsx(Hv,{getEditorModel:l,onlyDate:!i,onCloseModal:e,blockId:t,left:s,right:a,onGlobalCaptureKeydown:o});case Dr.LINK_PAGE:return r.jsx(jB,{getEditorModel:l,symbol:i,onCloseModal:e,blockId:t,left:s,right:a});case Dr.EQUATION:return r.jsx(Tee,{getEditorModel:l,symbol:i,onCloseModal:e,blockId:t,left:s,right:a});case Dr.PEOPLE:return r.jsx(Nee,{getEditorModel:l,symbol:i,onCloseModal:e,blockId:t,left:s,right:a});case Dr.EMOJI:return r.jsx(Cee,{getEditorModel:l,symbol:i,onCloseModal:e,blockId:t,left:s,search:c,right:a});default:return r.jsx(Hv,{getEditorModel:l,onCloseModal:e,blockId:t,left:s,right:a,onGlobalCaptureKeydown:o})}},DB=()=>{const e=me(),t=qi(),n=Rm(Xe.INLINE_PANEL),s=IB(),a=(o,i,l,c,u,d,f)=>{const h=u(l);if(!h)return;const{selection:p}=h;if(p&&p.isCollapsed&&!n){if(t(),c===Dr.PAGE){s({editorModel:h,blockId:l,left:o,right:i});return}return Ye({$ignoreSlash:!0}),h.requestFocus(),e.dropdown({modalId:Xe.INLINE_PANEL,popcorn:{getBoundingClientRect(){return h.getBoundingClientRectOfRange(o,o)}},closeAfterCallBack:()=>{Ye({$ignoreSlash:!1}),c===Dr.EMOJI&&Ye({$allowEmojiPanel:!1})},placement:"bottom-start",offset:[0,10],content:({onCloseModal:g})=>r.jsx(Iee,{symbol:d,getEditorModel:u,onCloseModal:g,blockId:l,inlineType:c,left:o,right:i,keyword:f,onGlobalCaptureKeydown:_=>{(be("enter")(_)||be("shift+enter")(_))&&(_.stopImmediatePropagation(),g())}})}),!0}};return F.useCallback(a,[t,s,n,e])},jee=e=>{const t=DB(),n=xn();return F.useCallback((a,o,i,l)=>{const c=n(e);if(!c)return;const{selection:u}=c;if(!u||!u.isCollapsed)return;const d=u.focusOffset-(i.length-1);t(d,u.focusOffset,e,o,n,i,l)&&a.preventDefault()},[n,t,e])},Dee=(e,t)=>{const n=xn(),s=a=>{const o=n(e);if(!o)return;const{selection:i}=o;if(!i)return;const{focusOffset:l}=i;if(l<2)return;const c=br(yr(o.content,l-2,l-1)),u=d=>{o.performChange(f=>{f.shadow().select(l-2,l).replace(d)})};c==="-"&&(a===">"||a==="》")&&u("→"),(c==="<"||c==="《")&&a==="-"&&u("←"),(c==="!"||c==="！")&&a==="="&&u("≠"),(c==="<"||c==="《")&&a==="="&&u("≤"),(c===">"||c==="》")&&a==="="&&u("≥")};return F.useCallback(s,[n,e])},LF=e=>{const{model:t}=e||{},n=xn();return F.useCallback(s=>{const a=t||n(s);a&&a.performChange(o=>SB(a,{ctx:o,selection:o.selection}))},[t,n])},SB=(e,t)=>{const{ctx:n,selection:s}=t;if(!s)return;const a=yr(e.content,s.offset,s.endOffset),o=br(a);a.items.every(l=>{var c;return l.type==="element"&&l.tag===vi?!0:l.type==="element"&&l.tag===jr?(c=l.content)==null?void 0:c.items.every(u=>u.type==="element"&&u.tag===vi):!1})?(n.shadow().select(s.offset,s.endOffset).replace(yn([eo(`${o}`,e.format)])),e.requestFocus()):n.select(s.offset,s.endOffset).replace(yn([zn(vi,{text:o,textFormat:e.format})])).collapse("end")},kC=e=>{const t=ke(),n=xn(),s=fr(),a=(o,i)=>{const{blocks:l}=le(),c=l[e];if(!c)return;const u=n(e),d=u==null?void 0:u.selection;if(!d||!d.isCollapsed||d.offset!==i)return;const[f]=y0(c.data.segments,0,i);if(!f)return;const h=f.text;if(!["--","**","－－","＊＊"].includes(h))return;o.preventDefault();const p=y0(c.data.segments,i),g=[...new Set(h.split(""))].join();pe(e,{data:{segments:[{...f,text:[...new Array(3)].map(()=>g).join("")},...p]}},!0),t(()=>{pe(c.uuid,{data:{segments:p}}),Qe({type:m.BlockType.DIVIDER},{parentId:c.parentId,before:c.uuid}),ee(bs({init(){s(e,0)},redo(){s(e,0)},undo(){s(e,3)}}))})};return F.useCallback(a,[s,n,t,e])},See=(e,t)=>{const n=ke(),s=fr(),a=xn(),o=kC(e),i=async l=>{var p;const{content:c}=l.detail,u=a(e);if(!u)return;const d=g=>{setTimeout(()=>{u.performChange(_=>{const{selection:x}=u;if(!x)return;const y=x.offset;_.select(y,y).setFormat({[g]:!1})})})},f=g=>{const{redoFocus:_,intFocus:x,undoFocus:y,segments:b}=g;n(()=>{ee(mn({uuid:e,patch:{data:{[t]:b}}})),ee(bs({init(){s(e,x)},redo(){s(e,_)},undo(){s(e,y)}}))})};if([">","="].includes(c)){const g=c===">",_=c==="=",y=(p={"=":"==",">":"<u>"}[c])!=null?p:`${c}`,{hitText:b,lastSameIndex:E}=Rf({symbol:y,model:u}),{selection:w}=u;if(!w)return;const{focusOffset:k}=w;if(!b)return;f({intFocus:k,redoFocus:k,undoFocus:k+y.length,segments:Qs(u.content)}),u.performChange(C=>{const T=E,v=w.offset,I=C.shadow().select(T,v),j={...I.format};g&&(I.applyFormat({underline:!j.underline}),C.select(v,v).setFormat({underline:!1}),d("underline")),_&&(I.applyFormat({color:void 0,backgroundColor:j.backgroundColor?void 0:Pe.yellow}),C.select(v,v).setFormat({color:void 0,backgroundColor:Pe.yellow}),d("color")),I.select(v-y.length,v).delete().select(T-y.length,T).delete().release()}),f({intFocus:k-y.length,redoFocus:k-y.length,undoFocus:k+y.length,segments:Qs(u.content)});return}const h=u.onAfterInput.subscribe(()=>{h.unsubscribe();const{selection:g}=u;if(!g)return;const{isCollapsed:_,focusOffset:x}=g;if(!_||x<2)return;if(["*","_"].includes(c)){const{hitText:w,lastSameIndex:k}=Rf({symbol:`${c}${c}`,model:u});if(w){const C=Qs(u.content);f({intFocus:x-4,redoFocus:x,undoFocus:x-1,segments:C}),u.performChange(T=>{const v=k,I=g.offset,j=T.shadow().select(v,I),D={...j.format};j.applyFormat({bold:!D.bold}),T.select(I,I).setFormat({bold:!1}),d("bold"),j.select(I-2,I).delete().select(v-2,v).delete().release()}),f({intFocus:x-2,redoFocus:x-2,undoFocus:x,segments:Qs(u.content)});return}}["*"].includes(c)&&o(l,3);const b=w=>{const{shadowContext:k,left:C,right:T,size:v}=w,I=VE(u.content,C+v,T-v,j=>j.type==="element"&&j.tag===jr);I.length>0?k.unwrap(jr,I):(k.select(C,T-v),k.wrap(jr,{})),k.selection&&(k.shadow().select(k.selection.offset-v,k.selection.offset).delete().release(),k.shadow().select(k.selection.endOffset,k.selection.endOffset+v).delete().release(),k.release())};if(["`","·"].includes(c)){const w=Rf({symbol:`${c}${c}${c}`,model:u});if(w.hitText){const k=Qs(u.content);f({intFocus:x-3,redoFocus:x-3,undoFocus:x,segments:k}),u.performChange(C=>{const T=w.lastSameIndex,v=g.offset,I=C.shadow().select(T,v);b({shadowContext:I,left:T,right:v,size:3})}),f({intFocus:x-3,redoFocus:x-3,undoFocus:x,segments:Qs(u.content)});return}}const E=Rf({symbol:c,model:u});if(E.hitText){const w=Qs(u.content);f({intFocus:x-2,redoFocus:x,undoFocus:x-1,segments:w}),u.performChange(T=>{const v=E.lastSameIndex,I=g.offset,j=T.shadow().select(v,I),D={...j.format};switch(c){case"$":{j.select(I-1,I).delete().select(v-1,v).delete().release();const S=T.select(v-1,I-2);SB(u,{ctx:T,selection:S.selection});return}case"*":case"_":{j.applyFormat({italic:!D.italic}),T.select(I,I).setFormat({italic:!1}),d("italic");break}case"~":case"～":{j.applyFormat({lineThrough:!D.lineThrough}),T.select(I,I).setFormat({lineThrough:!1}),d("lineThrough");break}case"`":case"·":{b({shadowContext:j,left:v,right:I,size:1});return}}j.select(I-1,I).delete().select(v-1,v).delete().release()});const k=Qs(u.content);let C=2;(c==="`"||c==="·")&&(C=0),f({intFocus:x-C,redoFocus:x-C,undoFocus:x,segments:k})}})};return F.useCallback(i,[s,a,o,t,n,e])},PF=e=>{const{model:t}=e||{},n=xn();return F.useCallback(s=>{const a=t||n(s);a&&a.performChange(o=>{if(o.selection===null)return;const i=VE(a.content,o.selection.offset,o.selection.endOffset,l=>l.type==="element"&&l.tag===jr);if(i.length>0){o.unwrap(jr,i);return}o.selection.isCollapsed?o.insert(yn([{type:"element",tag:jr,props:{},content:yn([])}])).select(o.selection.focusOffset-1):o.wrap(jr,{})})},[t,n])},CC=F.createContext({recordId:"",tableId:"",spans:{},indexRanges:[]}),OF=()=>F.useContext(CC),Ree=()=>{const e=On();return F.useCallback(t=>{const n=jn(".block-content",e);return n==null?void 0:n.querySelector(`[data-block-id="${t}"]:not([data-toc-type])`)},[e])},tf=()=>{const e=me(),t=Kt(),n=Ree(),s=xn(),a=Rm(Xe.CONTEXT_DISCUSSIONS),o=dr(()=>new mF),i=gt(),l=Ve(i,!1,!0);return F.useCallback(c=>{var x,y,b,E,w,k;if(a||l)return;const{blockId:u}=c,d=le().blocks[u];let f=(x=d==null?void 0:d.data.segments)!=null?x:[],h=null;if(c.withSelection){const C=(d==null?void 0:d.type)===m.BlockType.CODE?`${u}_mock`:u,T=(y=c.editorModel)!=null?y:s(C);if(T==null||(h=T,f=c.withSelection?Qs(yr(h.content,(E=(b=h.selection)==null?void 0:b.offset)!=null?E:0,(k=(w=h.selection)==null?void 0:w.endOffset)!=null?k:h.content.length)):Qs(h.content),de(f)===""))return}let p=!1;const g=C=>{const T=ke(),v=Zm();return r.jsx(hF,{manager:o,children:r.jsx(LA,{onComment:I=>{if(C.onCloseModal(),c.withSelection){const j=T(()=>{const D=v.addDiscussion({blockId:u,context:f});return v.appendComment({discussionId:D,text:I}),D});h==null||h.performChange(D=>{var R,A;(c.withSelection?D.select((R=h==null?void 0:h.selection)==null?void 0:R.offset,(A=h==null?void 0:h.selection)==null?void 0:A.endOffset):D.select()).applyFormat({customs:{...J6(j)}})})}else T(()=>{const j=v.addDiscussion({blockId:u});return v.appendComment({discussionId:j,text:I}),j})}})})},_=()=>{if(o.hasUnsavedDrafts())return p?void 0:(e.warning({title:"放弃保存这条评论？",confirm:()=>{p=!0,o.clearUnsavedDrafts(),t(Xe.CONTEXT_DISCUSSIONS)}}),"prevent")};if(c.withSelection){if(!h)return;const{selection:C}=h;if(C==null)return;e.dropdown({modalId:Xe.CONTEXT_DISCUSSIONS,popcorn:{getBoundingClientRect(){const T=h==null?void 0:h.getBoundingClientRectOfRange(C.offset,C.endOffset);return T!=null?T:new DOMRect(-9999,-9999,0,0)}},content:g,placement:"bottom",closeBeforeCallBack:_})}else{const C=n(u);if(C==null)return;e.dropdown({modalId:Xe.CONTEXT_DISCUSSIONS,popcorn:C,content:g,placement:"bottom",closeBeforeCallBack:_})}},[t,o,s,a,e,n,l])},RB=e=>{const{recordId:t}=OF(),n=tf(),s=xn();return F.useCallback(()=>{var o;const a=s(e);n({blockId:t||e,editorModel:a,withSelection:!((o=a==null?void 0:a.selection)!=null&&o.isCollapsed)})},[s,n,t,e])},MF=()=>{const e=xn();return F.useCallback((t,n)=>{const s=e(t);if(!s)return;const{format:a}=s;switch(n){case"bold":s.performChange(o=>o.applyFormat({bold:!a.bold}));break;case"italic":s.performChange(o=>o.applyFormat({italic:!a.italic}));break;case"underline":s.performChange(o=>o.applyFormat({underline:!a.underline}));break;case"lineThrough":s.performChange(o=>o.applyFormat({lineThrough:!a.lineThrough}));break}},[e])},AB=e=>{const t=LF(),n=MF(),s=PF(),a=lu(),{queryResult:o,setFakeFocus:i}=bF(e),l=cC(e,{setFakeFocus:i}),c=RB(e),{disableEquation:u,disableLink:d}=o,f=xn(),h=p=>{const g=f(e);if(!g)return;const{selection:_}=g;if(_){if(be("mod+a")(p)){_.offset===0&&_.length===g.content.length||p.stopPropagation();return}if(be("mod+shift+m")(p)){p.preventDefault(),c();return}if(be("mod+b")(p)){p.preventDefault(),n(e,"bold");return}if(be("mod+i")(p)){p.preventDefault(),n(e,"italic");return}if(be("mod+u")(p)&&(p.preventDefault(),n(e,"underline")),be("mod+e")(p)&&(p.preventDefault(),s(e)),be("mod+shift+s")(p)&&(p.preventDefault(),n(e,"lineThrough")),be("mod+shift+x")(p)&&!u&&(p.preventDefault(),t(e)),be("mod+k")(p)&&!d&&(p.preventDefault(),p.stopPropagation(),l()),be("mod+j")(p)){p.preventDefault(),p.stopPropagation();const x=f(e);if(!x)return;const y=x.editorElement;if(!y)return;const{selection:b}=x;if(!b)return;const{offset:E,endOffset:w}=b;a({blockId:e,popcorn:y,model:x,selection:{start:E!=null?E:0,end:w!=null?w:0},editorScene:ct.TextSelected,from:Ll.RtfMenu})}}};return F.useCallback(h,[f,e,u,d,c,n,s,t,l,a])},b0=120,fb=()=>{ee(Qn.update({activityTableId:void 0,chosenCells:void 0}))},zl=(e,t,n)=>{var i;const s=document.querySelector(`[data-block-id="${e}"`),a=s==null?void 0:s.querySelector(`[data-table-row-index="${t}"][data-table-column-index="${n}"]`);return(i=a==null?void 0:a.querySelector("[contenteditable]"))==null?void 0:i.dataset.editor},E0=(e,t)=>n=>{const s=e.slice();n&&s.reverse();let a=0;return s.some((o,i)=>K.ui.selectedCells.some(l=>l[t]===o)?(a=i,!0):!1),n?s.length-1-a:a},BB=e=>{const t=ke(),n=Os(),s=xn();F.useEffect(()=>{let a;const o=l=>{a&&clearTimeout(a),a=setTimeout(l)},i=l=>{var h,p,g,_;const c=K.blocks[e];if(!c)return;const{selectedCells:u}=K.ui;if(!u.length||!u.some(({viewId:x})=>x===e))return;const{recordId:d,propertyId:f}=(h=u[0])!=null?h:{};if(!(!d||!f)&&be(["Esc","Tab","Shift+Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter","Shift+ArrowUp","Shift+ArrowDown","Shift+ArrowLeft","Shift+ArrowRight"],l)){const{focus:x}=K.simpleTable,{subNodes:y}=c,b=(g=(p=c.data.format)==null?void 0:p.tableBlockColumnOrder)!=null?g:[],E=y.findIndex(S=>S===d),w=b.findIndex(S=>S===f),k=(_=zl(e,E,w))!=null?_:"",C=E0(b,"propertyId"),T=E0(y,"recordId"),v=()=>{const S=new Set,R=new Set;return K.ui.selectedCells.forEach(A=>{S.add(A.recordId),R.add(A.propertyId)}),{rowSet:S,columnSet:R}},I=(S,R)=>K.ui.selectedCells.some(A=>A.viewId===e&&A.syncId===n&&A.recordId===S&&A.propertyId===R);if(be("Esc")(l)){if(document.querySelector(`[data-modal-id="${Xe.INLINE_PANEL}"]`))return;l.stopImmediatePropagation(),ee(x?Qn.update({focus:!1}):nt.updateSelectBlocks([{blockId:e}])),ka(!0);return}if(be("Enter")(l)){if(!x){const S=T(),R=y[S],A=C(),L=b[A];R&&L&&(ee(nt.update({selectedCells:[{recordId:R,propertyId:L,viewId:e,syncId:n}]})),ee(Qn.update({focus:!0})),Fr(zl(e,S,A),1/0,1/0))}return}if(be("ArrowUp")(l)){if(x){const M=Zr(k);if(!(M!=null&&M.collapsed)||!M.isFirstLine)return}const S=T(),R=C(),A=Math.max(S-1,0),L=y[A],P=b[R];L&&P&&ee(nt.update({selectedCells:[{recordId:L,propertyId:P,viewId:e,syncId:n}]})),o(()=>{x&&Fr(zl(e,A,R),1/0,1/0)});return}if(be("Shift+ArrowUp")(l)){if(x){const R=Zr(k);if(!(R!=null&&R.isFirstLine))return;l.preventDefault(),ee(Qn.update({focus:!1})),ka(!0)}const S=T(!0);if(S>E){const R=y[S];R&&ee(nt.update({selectedCells:K.ui.selectedCells.filter(A=>A.recordId!==R)}))}else{const R=T(),A=y[Math.max(R-1,0)];if(A&&!I(A,f)){const{columnSet:L}=v();ee(nt.update({selectedCells:[...K.ui.selectedCells,...[...L].map(P=>({recordId:A,propertyId:P,viewId:e,syncId:n}))]}))}}}if(be("ArrowDown")(l)){if(x){const M=Zr(k);if(!(M!=null&&M.collapsed)||!M.isLastLine)return}const S=T(!0),R=C(!0),A=Math.min(S+1,y.length-1),L=y[A],P=b[R];L&&P&&ee(nt.update({selectedCells:[{recordId:L,propertyId:P,viewId:e,syncId:n}]})),o(()=>{x&&Fr(zl(e,A,R),0,0)});return}if(be("Shift+ArrowDown")(l)){if(x){const R=Zr(k);if(!(R!=null&&R.isLastLine))return;l.preventDefault(),ee(Qn.update({focus:!1})),ka(!0)}const S=T();if(S<E){const R=y[S];R&&ee(nt.update({selectedCells:K.ui.selectedCells.filter(A=>A.recordId!==R)}))}else{const R=T(!0),A=y[Math.min(R+1,y.length-1)];if(A&&!I(A,f)){const{columnSet:L}=v();ee(nt.update({selectedCells:[...K.ui.selectedCells,...[...L].map(P=>({recordId:A,propertyId:P,viewId:e,syncId:n}))]}))}}}const j=S=>{let R=E,A=w;if(w+1>=b.length){if(E+1>=y.length)return;R=E+1;const P=y[R];A=0;const M=b[A];P&&M&&ee(nt.update({selectedCells:[{recordId:P,propertyId:M,viewId:e,syncId:n}]}))}else{A=w+1;const P=b[A];P&&ee(nt.update({selectedCells:[{recordId:d,propertyId:P,viewId:e,syncId:n}]}))}const L=zl(e,R,A);if(S)o(()=>ka(!0)),ee(Qn.update({focus:!1}));else{if(!x)return;o(()=>{Fr(L,0,0)})}};if(be("Tab")(l)){if(w+1>=b.length&&E+1>=y.length){const S=y[y.length-1];let R="";t(()=>{R=Qe({type:m.BlockType.TABLE_ROW},{parentId:e,after:S})});const A=b[0];A&&(ee(nt.update({selectedCells:[{recordId:R,propertyId:A,viewId:e,syncId:n}]})),ee(Qn.update({focus:!1})));return}j(!0)}if(be("ArrowRight")(l)){if(x){const S=Zr(k);if(!(S!=null&&S.collapsed)||!S.isLastChar)return}j()}if(be("Shift+ArrowRight")(l)){if(x){const R=Zr(k);if(!(R!=null&&R.isLastChar))return;l.preventDefault(),ee(Qn.update({focus:!1})),ka(!0)}const S=C();if(S<w){const R=b[S];R&&ee(nt.update({selectedCells:K.ui.selectedCells.filter(A=>A.propertyId!==R)}))}else{const R=C(!0),A=b[Math.min(R+1,b.length-1)];if(A&&!I(d,A)){const{rowSet:L}=v();ee(nt.update({selectedCells:[...K.ui.selectedCells,...[...L].map(P=>({recordId:P,propertyId:A,viewId:e,syncId:n}))]}))}}}const D=S=>{let R=E,A=w;if(w-1<0){if(E-1<0)return;R=E-1;const L=y[R];A=b.length-1;const P=b[A];L&&P&&ee(nt.update({selectedCells:[{recordId:L,propertyId:P,viewId:e,syncId:n}]}))}else{A=w-1;const L=b[A];L&&ee(nt.update({selectedCells:[{recordId:d,propertyId:L,viewId:e,syncId:n}]}))}if(S)o(()=>ka(!0)),ee(Qn.update({focus:!1}));else{if(!x)return;o(()=>{Fr(zl(e,R,A),1/0,1/0)})}};if(be("Shift+Tab")(l)&&D(!0),be("ArrowLeft")(l)){if(x){const S=Zr(k);if(!(S!=null&&S.collapsed)||!S.isFirstChar)return}D()}if(be("Shift+ArrowLeft")(l)){if(x){const R=Zr(k);if(!(R!=null&&R.isFirstChar))return;l.preventDefault(),ee(Qn.update({focus:!1})),ka(!0)}const S=C(!0);if(S>w){const R=b[S];R&&ee(nt.update({selectedCells:K.ui.selectedCells.filter(A=>A.propertyId!==R)}))}else{const R=C(),A=b[Math.max(R-1,0)];if(A&&!I(d,A)){const{rowSet:L}=v();ee(nt.update({selectedCells:[...K.ui.selectedCells,...[...L].map(P=>({recordId:P,propertyId:A,viewId:e,syncId:n}))]}))}}}}};return document.addEventListener("keydown",i,!0),()=>{document.removeEventListener("keydown",i,!0)}},[s,n,e,t])},Ko=(e,t="属性")=>{const n=Object.values(e!=null?e:{}).map(i=>i.name),s=new Set(n);let a=0,o=t;for(;s.has(o);)a+=1,o=`${t} ${a}`;return o},ih=()=>{const e=ke(),{getState:t}=Kr(),n=({collectionId:s,viewId:a,position:o,propertyType:i=m.CollectionSchemaType.TEXT,isTimelineTable:l=!1,visible:c})=>{var y,b;const{blocks:u,collectionViews:d}=t(),f=u[s];if(!f)return;const h=qe(),{visibleProperty:p,inVisibleProperty:g}=Xg(h);let _={};if(a){const E=d[a];if(!E)return;_=gl(E.format,vl);const{properties:w=[],timelineTableProperties:k=[]}=Zt(E),T=[...l?k:w],v=c||[m.CollectionViewType.TABLE,m.CollectionViewType.FORM].includes(E.type)?p:g;if(o){const j=T.findIndex(D=>D.property===o.property);j>-1?T.splice(o.left?j:j+1,0,v):T.push(v)}else T.push(v);const I=l?"timelineTableProperties":`${LB(E.type)}Properties`;_[I]=T,vl.forEach(j=>{if(j===I)return;const D=_[j];D&&(["tableProperties","formProperties"].includes(j)?_[j]=[...D,p]:_[j]=[...D,g])})}let x=[...(y=f.data.collectionPageProperties)!=null?y:[]];return x.length===0&&(x=Object.keys((b=f.data.schema)!=null?b:{}).map(E=>({property:E,visible:!0}))),x.push(p),e(()=>{pe(s,{data:{collectionPageProperties:x,schema:{...f.data.schema,[h]:{name:Ko(f.data.schema),type:i}}}}),a&&Kn(a,{format:_}),Ju(f.uuid,[h],a)}),h};return F.useCallback(n,[t,e])},UF=()=>[{id:qe(),value:"待处理",color:Pe.red},{id:qe(),value:"进行中",color:Pe.yellow},{id:qe(),value:"已完成",color:Pe.green}],vl=["tableProperties","boardProperties","galleryProperties","listProperties","timelineProperties","timelineTableProperties","calendarProperties","formProperties"],Xg=e=>({visibleProperty:{property:e,visible:!0},inVisibleProperty:{property:e,visible:!1}}),Ju=(e,t,n)=>{var c;const{blocks:s,collectionViews:a}=le(),o=s[e];if(!o)return;const i=[],l=[];t.forEach(u=>{const{visibleProperty:d,inVisibleProperty:f}=Xg(u);i.push(d),l.push(f)}),(c=o.views)==null||c.forEach(u=>{if(u===n)return;const d=a[u];if(!d)return;const f=gl(d.format,vl);vl.forEach(h=>{const p=f[h];p&&(h==="tableProperties"?f[h]=[...p,...i]:f[h]=[...p,...l])}),Kn(u,{format:f})})},LB=e=>{switch(e){case m.CollectionViewType.BOARD:return m.CollectionViewType.BOARD;case m.CollectionViewType.LIST:return m.CollectionViewType.LIST;case m.CollectionViewType.GALLERY:return m.CollectionViewType.GALLERY;case m.CollectionViewType.TIMELINE:return m.CollectionViewType.TIMELINE;case m.CollectionViewType.CALENDAR:return m.CollectionViewType.CALENDAR;case m.CollectionViewType.FORM:return m.CollectionViewType.FORM;default:return m.CollectionViewType.TABLE}},Qg=()=>{const e=ke(),t=ks(),n=(s,a,o=m.CollectionViewType.TABLE)=>{var _,x,y,b,E,w,k,C,T;const{blocks:i}=le();let l=s;const c=i[s];((c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION||(c==null?void 0:c.type)===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(l=(x=(_=c.data.ref)==null?void 0:_.uuid)!=null?x:"");const u=i[l];if(!u)return;let d={};const f=(y=u.data.schema)!=null?y:{};let h=[];const p=localStorage.getItem(`viewId:${s}`);if(p){const{properties:v=Zu(f,o),view:I}=(b=Zt(p))!=null?b:{};h=da(v),o!==m.CollectionViewType.TABLE?h.forEach(j=>{j.property!=="title"&&(j.visible=!1)}):(I==null?void 0:I.type)!==m.CollectionViewType.TABLE&&h.forEach(j=>j.visible=!0)}let g;if(o===m.CollectionViewType.TABLE&&(d=Rc({tableProperties:h})),o===m.CollectionViewType.GALLERY&&(t(Ae.CREATE_GALLERY_VIEW,We.advancedList,{step1:!0}),d=VF({galleryProperties:h})),o===m.CollectionViewType.LIST&&(d=qF({listProperties:h})),o===m.CollectionViewType.BOARD){const v=Object.keys(f).find(I=>{var j;return((j=f[I])==null?void 0:j.type)===m.CollectionSchemaType.SELECT});if(v)d=hm({groupProperty:v,boardProperties:h,options:(E=f[v])==null?void 0:E.options});else{const{role:I}=hn(l);if(I===m.PermissionRole.READER){ye.warning("当前多维表无分类属性，不支持创建看板视图！");return}g=qe();const j=UF(),{inVisibleProperty:D}=Xg(g);return d=hm({groupProperty:g,boardProperties:h.concat(D),options:j}),e(()=>{pe(l,{data:{schema:{...u.data.schema,[g]:{name:Ko(f,"分类"),type:m.CollectionSchemaType.SELECT,options:j}}}});const S=Ka({title:a,format:d,pageSort:u.subNodes,type:o},{parentId:s,last:!0});return Ju(u.uuid,[g],S),S})}}if(o===m.CollectionViewType.TIMELINE){t(Ae.CREATE_TIMELINE_VIEW,We.advancedList);const v=Object.entries(f).filter(([R,A])=>A.type===m.CollectionSchemaType.DATE),{role:I}=hn(l);if(I===m.PermissionRole.READER&&v.length<2){ye.warning("当前多维表无日期属性，不支持创建时间轴视图！");return}let j=(w=v[0])==null?void 0:w[0],D=(k=v[1])==null?void 0:k[0];const S=Zu(f,o);if(j&&D)d=pm({timelineBy:j,timelineByEnd:D,timelineProperties:S});else{const R=[],A={...f};if(!j){j=qe();const L={property:j,visible:!1};R.push(L),S.push(L),A[j]={name:Ko(u.data.schema,"开始时间"),type:m.CollectionSchemaType.DATE}}if(!D){D=qe();const L={property:D,visible:!1};R.push(L),S.push(L),A[D]={name:Ko(u.data.schema,"结束时间"),type:m.CollectionSchemaType.DATE}}return d=pm({timelineBy:j,timelineByEnd:D,timelineProperties:S}),e(()=>{pe(u.uuid,{data:{schema:A}});const L=Ka({title:a,format:d,pageSort:u.subNodes,type:o},{parentId:s,last:!0});return Ju(u.uuid,R.map(P=>P.property),L),L})}}if(o===m.CollectionViewType.CALENDAR){t(Ae.CREATE_CALENDAR_VIEW,We.advancedList);const v=Object.entries(f).filter(([R,A])=>A.type===m.CollectionSchemaType.DATE),{role:I}=hn(l);if(I===m.PermissionRole.READER&&v.length<2){ye.warning("当前多维表无日期属性，不支持创建日历视图！");return}let j=(C=v[0])==null?void 0:C[0],D=(T=v[1])==null?void 0:T[0];const S=Zu(f,o);if(j&&D)d=gm({calendarProperties:S,calendarBy:j,calendarByEnd:D});else{const R=[],A={...f};if(!j){j=qe();const L={property:j,visible:!1};R.push(L),S.push(L),A[j]={name:Ko(u.data.schema,"开始时间"),type:m.CollectionSchemaType.DATE}}if(!D){D=qe();const L={property:D,visible:!1};R.push(L),S.push(L),A[D]={name:Ko(u.data.schema,"结束时间"),type:m.CollectionSchemaType.DATE}}return d=gm({calendarProperties:S,calendarBy:j,calendarByEnd:D}),e(()=>{pe(u.uuid,{data:{schema:A}});const L=Ka({title:a,format:d,pageSort:u.subNodes,type:o},{parentId:s,last:!0});return Ju(u.uuid,R.map(P=>P.property),L),L})}}return o===m.CollectionViewType.FORM&&(t(Ae.CREATE_FORM_VIEW,We.advancedList),d={formSerialNumber:!0,formShowDescription:!0,formDescription:[]}),e(()=>Ka({title:a,format:d,pageSort:u.subNodes,type:o},{parentId:s,last:!0}))};return F.useCallback(n,[e,t])},Rc=({tableProperties:e,oldViewFormat:t={}})=>({...t,tableProperties:e,tableWrap:typeof t.tableWrap<"u"?t.tableWrap:!0}),TC=({formProperties:e,oldViewFormat:t={}})=>({...t,formProperties:e,formShowDescription:typeof t.formShowDescription<"u"?t.formShowDescription:!0,formSerialNumber:typeof t.formSerialNumber<"u"?t.formSerialNumber:!0}),hm=({groupProperty:e,boardProperties:t,options:n=[],oldViewFormat:s={}})=>{var o,i,l;const a=n.map(c=>({property:e,propertyType:m.CollectionSchemaType.SELECT,value:c.value,visible:!0}));return a.unshift({property:e,propertyType:m.CollectionSchemaType.SELECT,visible:!0}),{...s,boardGroupBy:{property:e},boardCoverType:(o=s.boardCoverType)!=null?o:m.CoverType.NONE,boardCardSize:(i=s.boardCardSize)!=null?i:m.CardSize.MEDIUM,boardCoverAspect:(l=s.boardCoverAspect)!=null?l:m.CoverAspectType.COVER,boardProperties:t,boardGroups:a}},VF=({galleryProperties:e,oldViewFormat:t={}})=>{var s,a,o;return{...t,galleryProperties:e,galleryCoverType:(s=t.galleryCoverType)!=null?s:m.CoverType.PAGE_CONTENT,galleryCardSize:(a=t.galleryCardSize)!=null?a:m.CardSize.MEDIUM,galleryCoverAspect:(o=t.galleryCoverAspect)!=null?o:m.CoverAspectType.COVER}},qF=({listProperties:e,oldViewFormat:t={}})=>({...t,listProperties:e}),pm=({timelineProperties:e,oldViewFormat:t={},timelineBy:n,timelineByEnd:s})=>({...t,timelineProperties:e,timelineBy:n,timelineByEnd:s,timelineTableProperties:e,timelineShowTable:!0}),gm=({calendarProperties:e,oldViewFormat:t={},calendarBy:n,calendarByEnd:s})=>({...t,calendarProperties:e,calendarBy:n,calendarByEnd:s}),Zu=(e,t=m.CollectionViewType.TABLE)=>Object.keys(e).map(n=>({property:n,visible:n==="title"||t===m.CollectionViewType.TABLE})),lh=()=>{const e=CF();return F.useCallback((t,n)=>{const s=K.blocks[t.parentId];if(!(!s||e(n))){if([m.BlockType.TEXTAREA,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.TODO,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(s.type)){if(s.subNodes.length===0)return Qe({type:xo(s.type)||[m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes(s.type)?m.BlockType.TEXTAREA:s.type,local:!0},t);let o=s.subNodes[0];if(t.last?o=s.subNodes[s.subNodes.length-1]:t.before?o=HS(t.before):t.after&&(o=t.after),o){const i=K.blocks[o];if(i&&[m.BlockType.TEXTAREA,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.TODO].includes(i.type))return Qe({type:i.type,local:!0},t)}return Qe({type:m.BlockType.TEXTAREA,local:!0},t)}return Qe({type:m.BlockType.TEXTAREA,local:!0},t)}},[e])},p1={},Aee=(e,t)=>{p1[e]=t;const n=em(p1);n.length>100&&n[0]&&delete p1[n[0]]},vC=(e,t,n=le().blocks)=>{const s=n[e];if(!s)return!1;const a=o=>{var i;for(const l of o){const c=n[l];if(!c)continue;const u=c.type;if(Qk.has(u))switch(c.type){case m.BlockType.TEXTAREA:case m.BlockType.TODO:case m.BlockType.HEADER:case m.BlockType.MARK:case m.BlockType.QUOTE:case m.BlockType.LIST:case m.BlockType.ORDER_LIST:case m.BlockType.FOLD_LIST:{const d=de(c.data.segments).trim();if(d){if(l===t&&/^\/\w*/.test(d))continue;return!1}break}case m.BlockType.COLUMN:case m.BlockType.COLUMN_LIST:return a((i=c.subNodes)!=null?i:[])}}return!0};return a(s.subNodes)},Ac={[m.CollectionViewType.TABLE]:"表格",[m.CollectionViewType.BOARD]:"看板",[m.CollectionViewType.GALLERY]:"画廊",[m.CollectionViewType.LIST]:"目录",[m.CollectionViewType.TIMELINE]:"时间轴",[m.CollectionViewType.CALENDAR]:"日历",[m.CollectionViewType.FORM]:"收集表",[m.CollectionViewType.SPACE]:""};m.CollectionViewType.TABLE,m.CollectionViewType.BOARD,m.CollectionViewType.GALLERY,m.CollectionViewType.LIST,m.CollectionViewType.TIMELINE,m.CollectionViewType.CALENDAR,m.CollectionViewType.FORM;const lo={[m.CollectionViewType.TABLE]:"IcTableNew",[m.CollectionViewType.BOARD]:"IcBoardNew",[m.CollectionViewType.GALLERY]:"IcGalleryNew",[m.CollectionViewType.LIST]:"IcListNew",[m.CollectionViewType.TIMELINE]:"IcTimelineNew",[m.CollectionViewType.CALENDAR]:"IcCalendarNew",[m.CollectionViewType.FORM]:"IcFormNew",[m.CollectionViewType.SPACE]:null},_m=[{name:"表格",type:m.CollectionViewType.TABLE,helperLink:Ta.tableViewLink},{name:"看板",type:m.CollectionViewType.BOARD,helperLink:Ta.boardViewLink},{name:"画廊",type:m.CollectionViewType.GALLERY,helperLink:Ta.galleryViewLink},{name:"目录",type:m.CollectionViewType.LIST,helperLink:Ta.listViewLink},{name:"时间轴",type:m.CollectionViewType.TIMELINE,helperLink:Ta.timeViewLink},{name:"日历",type:m.CollectionViewType.CALENDAR,helperLink:Ta.calendarViewLink},{name:"收集表",type:m.CollectionViewType.FORM,helperLink:Ta.formViewLink}],Bee=()=>{const e=me(),t=ke();return F.useCallback(async({popcorn:n,collectionId:s,blockId:a,isCopyLink:o})=>{var d;const{blocks:i}=le(),l=i[s],c=[];((d=l==null?void 0:l.views)!=null?d:[]).forEach(f=>{c.push({id:f,table:"collectionView"})});const{collectionViews:u}=await Ce.editor.queryRecords({requests:c});u&&ee(Am.update(u)),e.dropdown({popcorn:n,placement:"bottom-start",content:({onCloseModal:f})=>{var b;const{blocks:h,collectionViews:p}=le(),g=h[s],_=h[a];if(!g||!_)return null;const x=[];((b=g.views)!=null?b:[]).forEach(E=>{const w=p[E];w&&w.type!==m.CollectionViewType.FORM&&x.push({type:$.OPERATION,data:{viewId:E,title:w.title||Ac[w.type],icon:r.jsx(H,{name:lo[w.type],size:"middle"})}})});let y=xc(_.data);return r.jsxs("div",{className:"next-modal w-[160px] py-[5px]",children:[r.jsx("p",{className:"text-t2 h-10 flex items-center pl-4",children:"复制多维表视图"}),r.jsx(ze,{items:x,onItemClick:E=>{const w={type:m.BlockType.REFERENCE_COLLECTION,data:{ref:{uuid:s}}};if(o){ee(Ad());const{blocks:k}=le(),C=k[a];C&&(y=xc(C.data))}y&&_.type===m.BlockType.TEXTAREA?t(()=>{_s([a],w),_N(a,E.data.viewId)}):t(()=>{const k=Qe(w,{parentId:_.parentId,after:a});_N(k,E.data.viewId)}),f()}})]})}})},[e,t])},_N=(e,t)=>{const{collectionViews:n}=le(),s=n[t];s&&Ka({type:s.type,pageSort:s.pageSort,format:{...s.format,formShared:!1},title:s.title,shareId:void 0},{parentId:e,last:!0})},Lee=e=>{const t=qi(),[n,s]=F.useState(""),{blockId:a,popcorn:o,selectItem:i,slash:l,blockNoText:c,cursorLeft:u,cursorRight:d,syncId:f}=e,h=KX(a),{getEditorModel:p,focusEditableAt:g}=e,_=Pee(a,g,f),x=ke(),y=DB(),b=lD(),E=localStorage.getItem(Yp),w=gt(),k=ae(({blocks:j})=>vC(w,a,j)),C=Qd(),T=F.useMemo(()=>{var P;const j=gd(Ww((P=b[0])!=null?P:"")?b.slice(1):b),D=`${j}-pageIsEmpty-${k}-enableAI-${C}`,S=p1[D];if(S)return S;const R={aiAssistantWithEmptyDoc:[],aiAssistantWithNotEmptyDoc:[],basicBlock:[],media:[],inlineElement:[],database:[],embed:[],advanced:[],layout:[],turninto:[],action:[],lastUsedColor:[],color:[],colorBackground:[]};em(h).forEach(M=>{if(!C&&(M==="aiAssistantWithEmptyDoc"||M==="aiAssistantWithNotEmptyDoc")||C&&(k&&M==="aiAssistantWithNotEmptyDoc"||!k&&M==="aiAssistantWithEmptyDoc"))return;const U=h[M],V=AS[M],W=al[M];Ei(U).forEach(z=>{var re;const Q=z,Z=f&&Q.data.type===m.BlockType.SYNC_CONTAINER;if(((re=Q.data.thesaurus)!=null?re:[]).some(ne=>ne.includes(j))&&!Z){switch(M){case"aiAssistantWithEmptyDoc":case"aiAssistantWithNotEmptyDoc":R[M].length===0&&R[M].push(I_(al[M],{titleSuffix:r.jsx("span",{className:"text-t2 px-1.5 bg-grey/20 rounded-sm ml-2 text-grey2 inline-flex items-center",children:"Beta"})}));break;case"inlineElement":case"basicBlock":case"embed":case"media":case"database":case"advanced":R[M].length===0&&R[M].push(I_(al[M]));break;case"layout":case"turninto":case"action":case"color":case"colorBackground":R[M].length===0&&l&&R[M].push(I_(al[M]));break;case"lastUsedColor":if(E&&E!=="undefined"){R[M].push(I_(al[M]));const Y=JSON.parse(E);Q.data={...Q.data,...Y.isBgColor?{backgroundColor:Y.colorkey||"default"}:{textColor:Y.colorkey||"default"},title:Y.desc,keywords:[Y.colorkey||"default"],params:{...Y.isBgColor?{backgroundColor:Y.colorkey||"",textColor:""}:{backgroundColor:"",textColor:Y.colorkey||""}}}}else return;break}const ne=[...Q.data.keywords].filter(Y=>!!Y);Q.matchAll=!!(j&&!M.includes(j)&&ne.some(Y=>Y.includes(j))),Q.matchAll&&[V.pinyin,V.initials,W].join(" ").includes(j)&&(Q.matchAll=!1),R[M].push(Q)}})}),em(R).forEach(M=>{const U=R[M];U.some(W=>W.matchAll)&&(R[M]=[...U.filter(W=>W.matchAll||W.type==="blockText")])});const A=l?Yb(Ei(R).map(M=>M)):Yb(Ei([...R.aiAssistantWithEmptyDoc,...R.aiAssistantWithNotEmptyDoc,...R.basicBlock,...R.inlineElement,...R.database,...R.media,...R.embed,...R.advanced]).map(M=>M)),L=[];return A.forEach((M,U)=>{M.type==="blockText"&&U!==0&&L.push({type:$.LINE}),L.push(M)}),Aee(D,L),L},[b,h,l,f,E,C,k]);F.useEffect(()=>{if(T.length===0)if(!n)s(b);else{const j=b.replace(/[^\x00-\xff]/g,"**").length,D=n.replace(/[^\x00-\xff]/g,"**").length;j-D>=5&&t()}else n&&s("")},[t,T.length,b,n]);const v=F.useCallback(j=>{i==null||i(),x(()=>{_({...j,blockNoText:c,popcorn:o,slash:l})})},[_,c,o,i,l,x]),I=F.useCallback(j=>{const{type:D,params:S,isInline:R,actionType:A,tableType:L,title:P,category:M,aiEditType:U}=j.data;ce.event("block_choose",{block_name:P,block_type:D,block_category:M,is_from:l?"slash":"add"}),R?y(u.offset,d.offset,a,D,p):v({type:D,params:S,actionType:A,tableType:L,aiEditType:U})},[a,u.offset,d.offset,p,y,l,v]);return T.length?r.jsx(ze,{virtualList:!0,className:"py-2 overflow-y-auto min-w-[290px] next-modal max-h-[60vh]",items:T,onItemClick:I,defaultActiveIndex:T.length>1?1:0}):null},Pee=(e,t,n)=>{const s=ks(),a=_e(e,["backgroundColor","subNodes","textColor"]),o=Hd(),i=me(),l=Kt(),c=Lx(),u=ke(),d=eh(),f=mu(),h=Xp(),p=mw(),g=lh(),_=NB(),x=Bee(),y=gt(),b=ae(({blocks:k})=>vC(y,e,k)),E=lu(),w=async k=>{var A,L,P,M,U;const{type:C,params:T={},popcorn:v,blockNoText:I,actionType:j,slash:D,tableType:S,aiEditType:R}=k;if(a){switch(C){case m.BlockType.PAGE:s(Ae.GUIDE_FIRST_TIME_CREATED_PAGE,We.basicList),s(Ae.CREATE_NEW_PAGE,We.basicList);break;case m.BlockType.TODO:s(Ae.CREATE_TODO_BLOCK,We.basicList);break;case m.BlockType.HEADER:s(Ae.CREATE_HEADER_BLOCK,We.basicList,{step1:!0});break;case m.BlockType.QUOTE:s(Ae.CREATE_QUOTE_BLOCK,We.basicList);break;case m.BlockType.MARK:s(Ae.CREATE_MARK_BLOCK,We.basicList);break;case m.BlockType.FILE:T.data.display==="image"&&s(Ae.CREATE_IMAGE_BLOCK,We.basicList,{step1:!0});break;case m.BlockType.MIND_MAPPING:case m.BlockType.MIND_MAPPING_PAGE:s(Ae.CREATE_MIND_MAP,We.advancedList);break;case m.BlockType.COLLECTION_VIEW:case m.BlockType.COLLECTION_VIEW_PAGE:switch(s(Ae.CREATE_BITABLE_EXPLORE,We.basicList),s(Ae.GUIDE_FIRST_TIME_CREATED_COLLECTION,We.basicList),S){case m.CollectionViewType.GALLERY:s(Ae.CREATE_GALLERY_VIEW,We.advancedList,{step1:!0});break;case m.CollectionViewType.CALENDAR:s(Ae.GUIDE_FIRST_TIME_CALENDAR_VIEW,We.advancedList),s(Ae.CREATE_CALENDAR_VIEW,We.advancedList);break;case m.CollectionViewType.TIMELINE:s(Ae.GUIDE_FIRST_TIME_TIMELINE_VIEW,We.advancedList),s(Ae.CREATE_TIMELINE_VIEW,We.advancedList);break;case m.CollectionViewType.FORM:s(Ae.GUIDE_FIRST_TIME_COLLECTION_VIEW,We.advancedList),s(Ae.CREATE_FORM_VIEW,We.advancedList);break}break;case m.BlockType.FOLDER:s(Ae.CREATE_FOLDER_AND_UPLOAD,We.basicList,{step1:!0}),s(Ae.GUIDE_FIRST_TIME_CREATED_FOLDER,We.basicList);break;case m.BlockType.TABLE:s(Ae.CREATE_SIMPLE_TABLE,We.basicList),s(Ae.GUIDE_FIRST_TIME_CREATED_TABLE,We.basicList);break;case m.BlockType.TEMPLATE:s(Ae.GUIDE_FIRST_TIME_CREATED_TEMPLATE,We.advancedList),s(Ae.CREATE_TEMPLATE_BUTTON,We.advancedList);break;case m.BlockType.SYNC_CONTAINER:s(Ae.GUIDE_FIRST_TIME_CREATED_SYNC,We.advancedList),s(Ae.CREATE_SYNC_BLOCK_NEW,We.advancedList,{step1:!0});break;case m.BlockType.COLUMN_LIST:s(Ae.CREATE_COLUMNS_BLOCK,We.basicList),s(Ae.GUIDE_FIRST_TIME_CREATED_COLUMN_LIST,We.basicList);break}if(D&&s(Ae.GUIDE_FIRST_TIME_SHORTCUT_CREATED,We.advancedList),j===Oe.AI_EDITOR){const V=document.querySelector(`[data-block-id="${e}"]`);if(!V)return;E({popcorn:V,blockId:e,editorScene:b?ct.PageEmpty:ct.PageHasContent,editType:R,selection:{start:(A=p.left)!=null?A:0},from:Ll.ContextMenu});return}if(j===Oe.CREATE)switch(C){case m.BlockType.COLUMN_LIST:{if(!!T.columnCount)CB(e,T.columnCount,{convertBlock:_s});else{const W=[...c(e)],{blocks:z}=le();let Q="";for(const Z of W){if(((L=z[Z])==null?void 0:L.type)===m.BlockType.PAGE)break;((P=z[Z])==null?void 0:P.type)===m.BlockType.COLUMN&&(Q=Z)}if(Q){const Z=z[Q];if(Z){const te=Qe({type:m.BlockType.TEXTAREA},{parentId:Z.uuid});te&&F0([te],Z.uuid,T.left?"left":"right")}}else{const Z=Qe({type:m.BlockType.TEXTAREA},{parentId:a.parentId,after:e});Z&&F0([Z],e,T.left?"left":"right")}}break}case m.BlockType.REFERENCE:{const V=dp({ancestorId:a.spaceId,filterTypes:[m.BlockType.FILE]});setTimeout(()=>{Ye({$textareaPlaceHolder:{blockId:e,alwaysShow:!0,placeHolder:"指定引用页面"}})},250),i.dropdown({popcorn:v,placement:"top-start",closeAfterCallBack:()=>{Ye({$textareaPlaceHolder:void 0})},content:W=>r.jsx(yc,{defaultValue:V,onSelect:z=>{u(()=>{W.onCloseModal(),I&&a.type===m.BlockType.TEXTAREA?_s([e],{type:m.BlockType.REFERENCE,data:{ref:{uuid:z.uuid},...T.data}}):Qe({type:m.BlockType.REFERENCE,data:{...T.data,ref:{uuid:z.uuid}}},{parentId:a.parentId,after:e}),s(Ae.GUIDE_FIRST_TIME_LINK_PAGE,We.advancedList)})}})}),l(h);return}case m.BlockType.REFERENCE_COLLECTION:{const V=dp({ancestorId:a.spaceId,findTypes:[m.BlockType.COLLECTION_VIEW,m.BlockType.COLLECTION_VIEW_PAGE]});setTimeout(()=>{Ye({$textareaPlaceHolder:{blockId:e,alwaysShow:!0,placeHolder:"指定引用多维表"}})},250),i.dropdown({popcorn:v,placement:"top-start",closeAfterCallBack:()=>{Ye({$textareaPlaceHolder:void 0})},content:({onCloseModal:W})=>r.jsx(yc,{defaultValue:V,placeholder:"搜索多维表",searchType:"collection",source:"collectionSettingsSource",onSelect:z=>{W(),x({popcorn:v,collectionId:z.uuid,blockId:a.uuid})}})}),l(h);return}case m.BlockType.PAGE:{if(I)_s([e],{type:C,local:!0,data:{segments:[]}}),_(e);else{const V=o(m.BlockType.PAGE,{parentId:a.parentId,after:e});if(!V)return;ox([V],!0),_(V)}break}case m.BlockType.COLLECTION_VIEW:{if(ce.event("bitable_create",{from_scene:"inline",view_type:C}),I&&a.type===m.BlockType.TEXTAREA&&a.subNodes.length===0)_s([e],{type:C,local:!0,data:{segments:[]}}),Lh(e,S);else{const V=Qe({type:C},{parentId:a.parentId,after:e},!1,!0);Lh(V,S)}break}case m.BlockType.COLLECTION_VIEW_PAGE:{if(ce.event("bitable_create",{from_scene:"subpage",view_type:C}),I&&a.type===m.BlockType.TEXTAREA&&a.subNodes.length===0)_s([e],{type:C}),Lh(e,S),_(e);else{const V=Qe({type:C},{parentId:a.parentId,after:e});Lh(V,S),_(V)}break}case m.BlockType.TEMPLATE:{const V="添加一个待办任务";let W=e;I&&a.type===m.BlockType.TEXTAREA?_s([e],{type:m.BlockType.TEMPLATE,textColor:Pe.blue,data:{segments:mt(V)}}):W=Qe({type:m.BlockType.TEMPLATE,textColor:Pe.blue,data:{segments:mt(V)}},{parentId:e}),Qe({type:m.BlockType.TODO},{parentId:W}),Po(W,!0,!1),l(h,()=>t(W||W,V.length));break}case m.BlockType.TABLE:{let V=e;I&&a.type===m.BlockType.TEXTAREA?_s([e],{type:m.BlockType.TABLE}):V=Qe({type:m.BlockType.TABLE},{parentId:a.parentId,after:e});const W=qe(),z=qe(),Q=()=>Qe({type:m.BlockType.TABLE_ROW},{parentId:V}),Z=Q(),te=Q(),re=Q();pe(V,{subNodes:[Z,te,re],data:{format:{tableBlockColumnOrder:[W,z],tableBlockRowHeader:!0}}}),ee(nt.update({selectedCells:[{recordId:Z,propertyId:W,viewId:V,syncId:n}]})),ee(Qn.update({activityTableId:V,focus:!0})),l(h),setTimeout(()=>{Fr(zl(V,0,0),1/0,1/0)});return}case m.BlockType.MIND_MAPPING:case m.BlockType.MIND_MAPPING_PAGE:{let V=e;I&&a.type===m.BlockType.TEXTAREA?_s([e],{...T,type:C}):V=Qe({type:C},{...T,parentId:a.parentId,after:e}),(()=>{u(()=>{g({parentId:V,last:!0},V),g({parentId:V,last:!0},V),g({parentId:V,last:!0},V)}),C===m.BlockType.MIND_MAPPING_PAGE&&_(e)})();return}default:if(I&&dV.includes(a.type)){if(C===m.BlockType.MARK){if(!a.textColor&&!a.backgroundColor){const V=x0(m.BlockType.MARK);Object.assign(T,V)}}else if(C===m.BlockType.SYNC_CONTAINER){const V=TB([a.uuid],a.parentId);l(h,()=>{t(a.uuid,0,void 0,{syncId:V||n})});return}_s([e],{...T,type:C,data:{...T.data}}),C===m.BlockType.CODE&&l(h,()=>{t(`${e}_mock`,0,void 0,{syncId:n})}),C===m.BlockType.FOLDER&&_(e)}else{let V;const W=x0(C);let z=Qe({...W,...T,type:C,data:{...T.data,...W.data}},{parentId:a.parentId,after:e});C===m.BlockType.SYNC_CONTAINER&&(V=z,z=Qe({},{parentId:z})),C===m.BlockType.CODE&&(z=`${z}_mock`),l(h,()=>{t(z,0,void 0,{syncId:V!=null?V:n})}),C===m.BlockType.FOLDER&&_(z);return}}else switch(j){case Oe.COLOR:{pe(e,{type:a.type,...T});const V=!!T.backgroundColor,[W,z]=Dg,Q=(M=V?z:W)==null?void 0:M.items.find(Z=>Z.colorkey===(V?T.backgroundColor:T.textColor));Nn(Yp,JSON.stringify(Q)),a.type===m.BlockType.MARK&&BF(T);break}case Oe.TURN_INTO:{_s([e],{...T,type:C,data:{...T.data}});break}case Oe.DELETE:{Gs([e]);break}case Oe.MOVETO:{f({popcorn:v,uuid:e});break}case Oe.COPY:{d([e],{effects:V=>{var z,Q;const W=(Q=(z=V[0])==null?void 0:z.blockId)!=null?Q:"";ee(bs({init(){var Z;t(W,(Z=p.left)!=null?Z:1/0)},redo(){var Z;t(W,(Z=p.left)!=null?Z:1/0)},undo(){var Z;t(e,(Z=p.left)!=null?Z:1/0)}}))}});break}}D?t(a.uuid,(U=p.left)!=null?U:0,void 0,{syncId:n}):t(a.uuid,0,void 0,{syncId:n}),l(h)}};return F.useCallback(w,[g,a,e,l,d,h,o,t,c,E,x,i,f,_,b,p.left,n,u,s])},fxe=(e,t,n=m.CollectionViewType.TABLE)=>{var i;const{blocks:s}=le(),a=s[e];if(!a)return;const o=(i=a.data.schema)!=null?i:{};Ka({title:"",format:Rc({tableProperties:Zu(o,n)}),pageSort:a.subNodes,type:n},{parentId:t,last:!0})},Lh=(e,t=m.CollectionViewType.TABLE)=>{const n=UF(),s=t===m.CollectionViewType.TIMELINE,a=t===m.CollectionViewType.CALENDAR,o=t===m.CollectionViewType.FORM,i=qe(),l=qe(),c=qe(),u=[],d={title:{name:"标题",type:m.CollectionSchemaType.TITLE},[i]:{name:"分类",type:m.CollectionSchemaType.SELECT,options:n}};u.push({property:"title",visible:!0},{property:i,visible:!0}),(s||a)&&(d[l]={name:"开始时间",type:m.CollectionSchemaType.DATE},d[c]={name:"结束时间",type:m.CollectionSchemaType.DATE},u.push({property:l,visible:!0},{property:c,visible:!0})),pe(e,{local:!0,data:{schema:d,collectionPageProperties:u}});let f=[];!a&&!o&&(f=[5,3,1].map(g=>{const _={[i]:[]};if(s){const x=new Date(Date.now()-g*En);_[l]=[Fn({from:x})],_[c]=[Fn({from:new Date(x.getTime()+5*En)})]}return Qe({type:m.BlockType.PAGE,local:!0,data:{segments:[],collectionProperties:_}},{parentId:e},!1,!0)}));const h=[{property:"title",visible:!0},{property:i,visible:t===m.CollectionViewType.TABLE}];(s||a)&&h.push({property:l,visible:!1},{property:c,visible:!1});let p={};switch(t){case m.CollectionViewType.TABLE:p=Rc({tableProperties:h});break;case m.CollectionViewType.BOARD:p=hm({groupProperty:i,boardProperties:h,options:n});break;case m.CollectionViewType.GALLERY:p=VF({galleryProperties:h});break;case m.CollectionViewType.LIST:p=qF({listProperties:h});break;case m.CollectionViewType.TIMELINE:p=pm({timelineProperties:h,timelineBy:l,timelineByEnd:c});break;case m.CollectionViewType.CALENDAR:p=gm({calendarProperties:h,calendarBy:l,calendarByEnd:c});break;case m.CollectionViewType.FORM:p=TC({formProperties:h});break}Ka({title:"默认视图",format:p,pageSort:f,type:t},{parentId:e}),o&&Ka({title:"表格",format:Rc({tableProperties:h}),pageSort:[],type:m.CollectionViewType.TABLE},{parentId:e})},Oee=()=>{const e=PB();return F.useCallback((t,n)=>{const{isOpenMenuList:s,syncId:a}=n||{},o=mee(t,a);if(o){const i=o.getBoundingClientRect(),l=bB(o);l&&yF(l,0),s&&e({popcorn:{getBoundingClientRect:()=>i},blockId:t,syncId:a})}},[e])},PB=()=>{const e=me(),t=qi(),n=qR(),s=fr();return F.useCallback(a=>{const{popcorn:o,blockId:i,offset:l=[-4,8],slash:c,syncId:u}=a,d=le().blocks[i];if(!d||wt.$createBlockMenuListId||!hee())return;const h=E=>{const w=Si(E,u);return nr(w)},p=h(i);if(!p)return;const{selection:g}=p;if(!g||!g.isCollapsed)return;const _=p.createCursor(g.focusOffset,"right"),x=p.createCursor(g.focusOffset,"left"),y=p.onSelectionChange.subscribe(()=>{if(p.selection){const{focusOffset:E}=p.selection;if(E<x.offset||_.offset<E){t();return}Ye({$slashSelection:{left:x.offset,right:_.offset}})}}),b=p.onContentChange.subscribe(()=>{var w;const{content:E}=p;try{const k=yr(E,x.offset,_.offset),C=br(k);c?!C||!Ww((w=C[0])!=null?w:"")?t():Ye({$menuListKeywords:C}):Ye({$menuListKeywords:C})}catch(k){t()}});e.dropdown({popcorn:o,placement:"bottom-start",mask:!1,modalId:i,offset:l,closeBeforeCallBack:()=>{x.release(),_.release(),b.unsubscribe(),y.unsubscribe(),t()},content:({onCloseModal:E})=>r.jsx(Lee,{focusEditableAt:s,blockNoText:xc(d.data),slash:c,syncId:u,getEditorModel:h,popcorn:o,blockId:i,cursorLeft:x,cursorRight:_,onCloseModal:E,selectItem:()=>{p.performChange(w=>{w.shadow().select(x.offset,_.offset).delete().release()}),pe(i,{data:{segments:Qs(p.content)}})}})}),n(i)},[t,s,e,n])},OB=e=>{const t=PB(),n=xn(),s=Os(),a=()=>{if(wt.$ignoreSlash)return;const o=n(e);if(!o)return;const{selection:i}=o;if(!i||!i.isCollapsed)return;t({popcorn:{getBoundingClientRect(){return o.getBoundingClientRectOfRange(i.focusOffset,i.focusOffset)}},offset:[4,8],blockId:e,slash:!0,syncId:s})};return F.useCallback(a,[n,t,s,e])};function NC(e,t){const n=mg(e,t,m.BlockType.ORDER_LIST);if(!n)return"1";let s=`${n.listNo}`;const a=n.format||n.defaultFormat;return a==="roman"&&(s=qB(n.listNo)),a==="letters"&&(s=UB(n.listNo-1)),s}function Mee(e,t){const n=mg(e,t,m.BlockType.ORDER_LIST);if(!n)return"2";let s=`${n.listNo+1}`;const a=n.format||n.defaultFormat;return a==="roman"&&(s=qB(n.listNo+1)),a==="letters"&&(s=UB(n.listNo)),s}const MB="abcdefghijklmnopqrstuvwxyz",xN=MB.length,UB=e=>{const t=[];do{const s=e%xN;t.push(s),e=Math.floor(e/xN)}while(e-- >0);const n=[];for(;t.length;){const s=t.pop();typeof s<"u"&&n.push(MB[s])}return n.join("")},VB=["","i","ii","iii","iv","v","vi","vii","viii","ix","","x","xx","xxx","xl","l","lx","lxx","lxxx","xc","","c","cc","ccc","cd","d","dc","dcc","dccc","cm"],qB=e=>{const t=e.toString().split("");let n="";[0,1,2].forEach(o=>{const i=Number(t.pop());if(isNaN(i))return;const l=i+o*10;n=VB[l]+n});const s=Number(t.join(""));return"m".repeat(s)+n},HB=(e,t)=>{const n=ke(),s=xn(),a=fr(),o=lu(),i=Qd(),l=(c,u)=>{var S;const{blocks:d}=le(),f=d[e];if(!f)return;const h=s(e);if(h===void 0)return;const{content:p,selection:g}=h;if(!g||!g.isCollapsed)return;const{offset:_}=g,[x,y]=Qb(p,_),b=Qs(x),E=Qs(y),w=br(x),k=(R,A)=>{if(R===f.type&&(R!==m.BlockType.HEADER||(A==null?void 0:A.level)===f.data.level))return;c.preventDefault();const L=pn(b);if(!L)return;pe(f.uuid,{data:{segments:[...zI(b),{...L,text:`${L.text}${u}`},...E]}});let P={};R===m.BlockType.MARK&&!f.textColor&&!f.backgroundColor&&(P=x0(m.BlockType.MARK)),[m.BlockType.EQUATION].includes(R)&&(P.local=!0),n(()=>{_s([f.uuid],{type:R,...P,data:{...P.data,...A,segments:E}}),ee(bs({init(){a(f.uuid,0)},undo(){a(f.uuid,_+1)},redo(){a(f.uuid,0)}}))})};if(w.match(/^#{1,4}$/)){const R=w.length;if(f.type!==m.BlockType.HEADER||f.data.level!==R){k(f.type===m.BlockType.FOLD_LIST?m.BlockType.TOGGLE_HEADER:m.BlockType.HEADER,{level:R});return}}if(["-","*"].includes(w)){k(m.BlockType.LIST);return}if(["+"].includes(w)){f.type===m.BlockType.HEADER?k(m.BlockType.TOGGLE_HEADER,{level:f.data.level}):k(m.BlockType.FOLD_LIST);return}if([">","》","｜","|","'",'"',"“"].includes(w)){k(m.BlockType.QUOTE);return}if(["!!","！！"].includes(w)){k(m.BlockType.MARK);return}if(["￥￥","$$"].includes(w)){k(m.BlockType.EQUATION);return}if(/^(```|···)/.test(w)&&!E.length&&!/(\s|\d)/.test(w.slice(3))){const R=Jk(w.slice(3).trim()),A=qe();n(()=>{var L;Qe({uuid:A,type:m.BlockType.CODE,data:{format:{language:R||((L=hg())!=null?L:Om)}}},{parentId:f.parentId,after:f.uuid}),ha(f.uuid),ee(bs({init(){setTimeout(()=>a(`${A}_mock`,0),200)},undo(){a(f.uuid,_)},redo(){setTimeout(()=>a(`${A}_mock`,0),200)}}))});return}const T=!!w.match(/^[\d]+(\.|。)$/),v=!T&&!!w.match(/^[A-Za-z]+(\.|。)$/),I=(w.lastIndexOf(".")||w.lastIndexOf("。"))&&VB.includes(w.substring(0,w.length-1)),j=I?"roman":v?"letters":void 0;if(v||T){if(!d[f.parentId])return;const A=oG(e);if((A==null?void 0:A.type)===m.BlockType.ORDER_LIST){const P=Mee(A.uuid,d);(w===`${P}.`||w===`${P}。`)&&k(m.BlockType.ORDER_LIST,{format:{orderListFormat:j}})}else if(T||w==="a."||w==="a。"||I){if(f.type===m.BlockType.HEADER)return;const P=v?1:parseInt(w,10);k(m.BlockType.ORDER_LIST,{format:{listStartIndex:P,orderListFormat:j}})}return}const D=br(p);if(i&&!t&&!D.trim()){c.preventDefault();const R=vC(f.parentId,e),A=h.editorElement;if(!A)return;o({popcorn:A,blockId:e,editorScene:R?ct.PageEmpty:ct.PageHasContent,selection:{start:(S=g.offset)!=null?S:0},from:Ll.ContextMenu})}};return F.useCallback(l,[t,i,a,s,o,n,e])},IC=(e,t,n=rC)=>{const s=gee(e),a=jee(e),o=See(e,t),i=Dee(e),l=OB(e),c=HB(e),u=vB(e),d=kC(e),f=xn();return F.useCallback(h=>{const{content:p}=h.detail;if(!n.editorInputKey)return;const g=f(e);if(typeof p=="string")switch(p){case"@":return a(h,Dr.DATE,"@");case"【":case"[":{if(!g||!g.selection)return;if(g.selection.focusOffset>0){const _=yr(g.content,g.selection.focusOffset-1,g.selection.focusOffset),x=br(_);x==="["&&p==="["?a(h,Dr.LINK_PAGE,"[["):x==="【"&&p==="【"&&a(h,Dr.LINK_PAGE,"【【")}break}case"]":case"】":n.bracketRightKey&&u();break;case"`":case"·":case"~":case"～":case"*":case"_":case"$":case"＊":o(h);break;case">":case"》":case"-":case"－":case"=":g&&s(p).then(_=>{if(_){o(h);return}n.minusKey&&d(h,2),i(p)});break;case"/":case"／":n.slashKey&&l();break;case" ":case"　":n.spaceKey&&c(h,p);break;case":":{Ye({$allowEmojiPanel:!0});break}default:{const _=f(e);if(!_||!_.selection)return;if(tR.exec(p)){h.preventDefault(),_.performChange(x=>{x.insert(yn([zn(Ed,{text:p})])).collapse("focus")});return}if(_.selection.focusOffset>0&&wt.$allowEmojiPanel){const x=yr(_.content,_.selection.focusOffset-1,_.selection.focusOffset);br(x)===":"&&a(h,Dr.EMOJI,":",p)}}}},[u,f,a,s,n.bracketRightKey,n.editorInputKey,n.minusKey,n.slashKey,n.spaceKey,i,o,d,l,c,e])},jC=(e,t,n=rC)=>{const s=wB(e),a=Fee(e),o=xee(e),i=EB(e),l=fee(e),c=Eee(e,t),u=wee(e,t),d=vB(e),f=kC(e),h=HB(e,!0),p=AB(e),g=OB(e),_=gt(),x=ef(),y=ht(),b=sD(),E=w=>{!wt.$isEditingPage&&!y&&b(!0),x(_,e);const k=w.nativeEvent;switch(!0){case(n.arrowKey&&be("ArrowUp")(k)):return i(k);case(n.arrowKey&&be("ArrowDown")(k)):return s(k);case(n.arrowKey&&be("ArrowLeft")(k)):return a(k);case(n.arrowKey&&be("ArrowRight")(k)):return o(k);case(n.tabKey&&be(["Tab","Shift+Tab"])(k)):return l(k);case(n.backspaceKey&&be("Backspace")(k)):return c(k);case(n.spaceKey&&be(["Space","Shift+Space"])(k)):return h(k,k.key);case(n.enterKey&&be(["Enter","Shift+Enter"])(k)):return u(k);case(n.bracketRightKey&&be(["]","】"],{byKey:!0})(k)):return d(k);case(n.minusKey&&be(["-","*","＊","－"],{byKey:!0})(k)):return f(k,2);case(n.slashKey&&k.code==="Slash"&&!k.shiftKey&&!k.ctrlKey&&!k.metaKey):return g();default:if(n.shortcutKey)return p(k)}};return F.useCallback(E,[y,x,_,e,b,n.arrowKey,n.tabKey,n.backspaceKey,n.spaceKey,n.enterKey,n.bracketRightKey,n.minusKey,n.slashKey,n.shortcutKey,i,s,a,o,l,c,h,u,d,f,g,p])};function Uee(e,t=20){const n=dr(()=>{let s=[],a=[];return{push:(c,u)=>{t!==0&&(s.push([c,u]),s=s.slice(-t),a=[])},undo:()=>{t!==0&&e.performChange(c=>{const u=s.pop();if(u){const d=[e.content,e.selection],[f,h]=u;c.load(f),h&&c.select(h.offset,h.endOffset,h.isBackward),a.push(d)}},"undo")},redo:()=>{t!==0&&e.performChange(c=>{const u=a.pop();if(u){const d=[e.content,e.selection],[f,h]=u;c.load(f),h&&c.select(h.offset,h.endOffset,h.isBackward),s.push(d)}},"undo")}}});return F.useEffect(()=>{let s=!1,a=0;const o=e.onChange.subscribe(({key:i,previousContent:l,previousSelection:c})=>{i!=="undo"&&(s||n.push(l,c),s=!0,window.clearTimeout(a),a=window.setTimeout(()=>{s=!1},500))});return()=>o.unsubscribe()},[e,n]),{undo:n.undo,redo:n.redo}}const Vee=(e,t)=>{const n=xn(),{model:s,setFakeFocus:a}=t,o=me();return F.useCallback(()=>{const i=s||n(e);if(!i)return;const l=i.active?i.selection:null;if(!l)return;const c=l.offset,u=l.endOffset;o.dropdown({popcorn:{getBoundingClientRect:()=>{const d=i.getBoundingClientRectOfRange(c,u);return d!=null?d:new DOMRect(-9999,-9999,0,0)}},closeAfterCallBack:()=>{a(!1)},placement:"bottom",offset:[4,4],content:({onCloseModal:d})=>r.jsx(jB,{getEditorModel:n,symbol:"[[",onCloseModal:d,blockId:e,left:c,right:u,setFakeFocus:a})})},[s,n,o,a,e])},DC=({onCloseModal:e,selectItem:t,blockId:n,syncId:s})=>{const a=ks(),o=_e(n,["data"],["level","display"]),i=gt(),l=uF(),c=ke(),{selectedBlockHistory:u,selectedBlock:d}=Ol(),f=XS(n),h=CF(),{isRestricted:p}=it(n),g=!!F.useContext(io),_=async(y,b={})=>{c(()=>{const E=d.length?d:[{blockId:n,syncId:s}];p&&f();const{mindMapMaxLimit:w}=xg();if(g&&h(n,`需要转换的节点数超过${w},升级空间立即解锁无限节点`,w+1))return;const k=Es(E);_s(k,{type:y,...b,local:void 0}),[m.BlockType.TOGGLE_HEADER,m.BlockType.FOLD_LIST].includes(y)&&Po(k,!0),u(E),(o==null?void 0:o.type)===m.BlockType.TEXTAREA&&a(Ae.CONVERT_TEXT_BLOCK,We.basicList),(o==null?void 0:o.type)===m.BlockType.HEADER&&a(Ae.CREATE_HEADER_BLOCK,We.basicList,{step1:!0}),y===m.BlockType.TODO&&a(Ae.CREATE_TODO_BLOCK,We.basicList),y===m.BlockType.QUOTE&&a(Ae.CREATE_QUOTE_BLOCK,We.basicList),y===m.BlockType.MARK&&a(Ae.CREATE_MARK_BLOCK,We.basicList),y===m.BlockType.SYNC_CONTAINER&&(a(Ae.GUIDE_FIRST_TIME_CREATED_SYNC,We.advancedList),a(Ae.CREATE_SYNC_BLOCK_NEW,We.advancedList,{step1:!0})),y===m.BlockType.PAGE&&a(Ae.GUIDE_FIRST_TIME_CREATED_PAGE,We.basicList)}),t&&t(),e()},x=F.useMemo(()=>{if(!o)return[];const y=Object.values(l.basicBlock).filter(b=>(g?Xw:Yw).includes(b.data.type)).map(b=>{const E=eC(o.type,{level:o.data.level,display:o.data.display});return{...b,type:$.BLOCK_TRANSFORM,data:{...b.data,selected:(E==null?void 0:E.title)===b.data.title}}});if(!g&&!s&&!$S(n)){const E={...l.advanced.sync,type:$.BLOCK_TRANSFORM};y.push(E)}if(!g&&K.ui.selectedBlocks.length>1&&K.ui.selectedBlocks.length<=5&&K.ui.selectedBlocks.some(b=>!Dl(b.blockId,i))){const b={type:$.BLOCK_TRANSFORM,data:{type:m.BlockType.COLUMN_LIST,actionType:Oe.CREATE,icon:"MIcInsertColumns",title:"分栏",context:Bt({title:"将选中的块转为分栏排版",image:"column"}),keywords:["sync"]}};y.push(b)}return y},[l.advanced.sync,l.basicBlock,o,n,g,i,s]);return o?r.jsx(ze,{className:B(Mi,"w-[200px]"),items:x,onItemClick:y=>{const{type:b,params:E}=y.data;_(b,E),ce.event("blockmenu_turn_choose",{block_name:Ya(n)})},keyDownPriority:Tr+1}):null},wa=(e,t)=>r.jsxs("div",{className:"text-center",children:[r.jsx("div",{children:e}),r.jsx("div",{children:t})]}),qee=({uuid:e,model:t,containerRef:n,comments:s=!1,segmentType:a})=>{var Q,Z,te;const o=gt(),{role:i}=it(o),l=LF({model:t}),c=MF(),u=PF({model:t}),{queryResult:d,setFakeFocus:f}=bF(e),h=cC(e,{model:t,setFakeFocus:f}),p=Vee(e,{model:t,setFakeFocus:f}),g=RB(e),_=fr(),x=Vn(),y=ks(),b=!!F.useContext(io),E=F.useContext(ik),w=Qd(),k=lu(),{getRect:C,disableLink:T,disableAI:v,inLink:I,inCode:j,inEquation:D,disableEquation:S}=d,R=Os(),A=rd(()=>t.onFormatChange.pipe(WI(20),ad(()=>t.format)),t.format,[t]),L=rd(()=>t.onReadonlyChange.pipe(ad(()=>t.readonly)),t.readonly,[t]),P=me(),M=F.useRef(null);F.useLayoutEffect(()=>{if(!M.current)return;const re=M.current.getBoundingClientRect();if(re.right+5>innerWidth){const ne=innerWidth-re.right-5;M.current.style.transform=`translateX(${ne}px)`}else M.current.style.transform=""});const U=eC((Q=K.blocks[e])==null?void 0:Q.type,{display:(Z=K.blocks[e])==null?void 0:Z.data.display,level:(te=K.blocks[e])==null?void 0:te.data.level});if(!C)return null;const V=s&&Fs(i,m.PermissionRole.COMMENTER)&&(x===Tt.MAIN||x===Tt.SHARE);if(L&&!V||E)return null;const W=w&&(U==null?void 0:U.type)&&V$.includes(U==null?void 0:U.type)&&!v,z=(()=>{var re,ne;return L?r.jsx(Ds,{icon:"IcMenuComment",iconClass:"mr-1",title:wa("评论",`${Gt}+Shift+M`),label:"评论",onClick:Y=>{Y.stopPropagation(),Y.preventDefault(),g()}}):r.jsxs(r.Fragment,{children:[W&&r.jsx(Ds,{title:"AI 辅助",label:"AI 辅助",icon:"IcAi",iconClass:"mr-1",boxClassName:"border-r border-grey6",onClick:Y=>{Y.stopPropagation(),Y.preventDefault();const X=t.editorElement;if(!X)return;const{selection:oe}=t;if(!oe)return;const{offset:ie,endOffset:ue}=oe;k({blockId:e,popcorn:X,model:t,selection:{start:ie!=null?ie:0,end:ue!=null?ue:0},editorScene:ct.TextSelected,from:Ll.RtfMenu})}}),(U==null?void 0:U.type)&&(b?Xw:Yw).includes(U.type)&&r.jsx(Ds,{arrow:!0,title:U.title,label:U.title,boxClassName:"border-r border-grey6",onClick:Y=>{Y.stopPropagation();const{selection:X}=t;X!==null&&P.dropdown({popcorn:Y.target,placement:"left",offset:[0,8],content:({onCloseModal:oe})=>r.jsx(DC,{syncId:R,focusEditableAt:_,onCloseModal:oe,blockId:e,selectItem:()=>{_(e,X.endOffset)}})})}}),a!=="description"&&r.jsx(Ds,{title:"创建或引用页面",icon:"IcMenuSubpage",disabled:!!I||T,boxClassName:"border-r border-grey6",onClick:Y=>{const{selection:X}=t;X!==null&&(Y.stopPropagation(),Y.preventDefault(),p())}}),V&&r.jsx(Ds,{title:wa("评论",`${Gt}+Shift+M`),boxClassName:"border-r border-grey6",icon:"IcMenuComment",onClick:Y=>{Y.stopPropagation(),Y.preventDefault(),g()}}),r.jsx(Ds,{title:wa("加粗",`${Gt}+B`),icon:"IcBold",highlight:A.bold,onClick:Y=>{ce.event("rtf_choose",{rtf_name:"bold"}),Y.stopPropagation(),c(e,"bold")}}),r.jsx(Ds,{title:wa("斜体",`${Gt}+I`),icon:"IcItalic",highlight:A.italic,onClick:Y=>{ce.event("rtf_choose",{rtf_name:"italic"}),Y.stopPropagation(),c(e,"italic")}}),r.jsx(Ds,{title:wa("下划线",`${Gt}+U`),icon:"IcUnderline",highlight:A.underline,onClick:Y=>{ce.event("rtf_choose",{rtf_name:"underline"}),Y.stopPropagation(),c(e,"underline")}}),r.jsx(Ds,{title:wa("中划线",`${Gt}+Shift+S`),icon:"IcDelete",highlight:A.lineThrough,onClick:Y=>{ce.event("rtf_choose",{rtf_name:"deleteline"}),Y.stopPropagation(),c(e,"lineThrough")}}),r.jsx(Ds,{title:wa("代码",`${Gt}+E`),icon:"IcCode",highlight:j,onClick:Y=>{Y.stopPropagation(),ce.event("rtf_choose",{rtf_name:"code"}),u(e)}}),r.jsx(Ds,{title:wa("公式",`${Gt}+Shift+X`),disabled:S,icon:"IcEquation",highlight:D,onClick:Y=>{const{selection:X}=t;X!==null&&(Y.stopPropagation(),ce.event("rtf_choose",{rtf_name:"equation"}),l(e))}}),r.jsx(Ds,{title:"链接",boxClassName:"border-r border-grey6",icon:"IcUrl",disabled:T,labelBorder:!0,highlight:I!==null,onClick:Y=>{const{selection:X}=t;X!==null&&(Y.stopPropagation(),Y.preventDefault(),ce.event("rtf_choose",{rtf_name:"链接"}),h(),y(Ae.CREATE_LINK,We.advancedList))}}),r.jsx(Ds,{title:"着色",arrow:!0,icon:"IcText",iconClass:B("rounded-full",gn({color:`${Us((re=A.color)!=null?re:void 0)}!important`,background:Rn((ne=A.backgroundColor)!=null?ne:void 0)})),onClick:Y=>{const{selection:X}=t;X!==null&&(Y.stopPropagation(),ce.event("rtf_choose",{rtf_name:"color"}),P.dropdown({popcorn:Y.target,offset:[0,8],placement:"left",closeBeforeCallBack:()=>void t.requestFocus(),content:({onCloseModal:oe})=>r.jsx(vx,{items:gX,onColorSelect:({isBgColor:ie,colorkey:ue})=>{t.requestFocus(),t.performChange(ge=>{ge.select(X.offset,X.endOffset),ie?ge.applyFormat({color:void 0,backgroundColor:ue}):ge.applyFormat({backgroundColor:void 0,color:ue})}),oe()}})}))}})]})})();return r.jsx(Hee,{getRect:C,containerRef:n,children:r.jsx("div",{ref:M,className:"flex items-center",onPointerDown:re=>re.preventDefault(),children:z})})},Ds=({title:e,icon:t,iconClass:n,label:s,labelBorder:a,disabled:o,highlight:i,arrow:l,className:c,boxClassName:u,active:d,onClick:f})=>r.jsxs($ee,{title:e,disabled:o,className:B((s||l)&&"px-[7px] !w-auto",c),boxClassName:u,active:d,onClick:h=>{o||f==null||f(h)},children:[t&&r.jsx(H,{name:t,size:"small",className:B("w-4",n,i?"text-active_color":"text-black")}),s&&r.jsx("span",{className:B("text-t3 border-grey4 leading-[14px]",a&&"border-b",i?"text-active_color":"text-black"),children:s}),l&&r.jsx(H,{size:"auto",name:"IcArrow",className:"ml-[6.75px] w-[9px] h-[9px]"})]}),Hee=({getRect:e,containerRef:t,children:n})=>{const s=F.useRef(null),a=F.useRef(),o=F.useRef(e);o.current=e,F.useEffect(()=>{a.current?a.current.update():t.current&&s.current&&(a.current=Ql({getBoundingClientRect:()=>o.current(),contextElement:t.current},s.current,{strategy:"fixed",placement:"top-start",modifiers:[{name:"offset",enabled:!0,options:{offset:[0,10]}},{name:"eventListeners",enabled:!0},{name:"computeStyles",options:{gpuAcceleration:!1}}]}))},[e,t]),F.useEffect(()=>()=>{var l;(l=a.current)==null||l.destroy()},[]);const i=r.jsx("div",{ref:s,className:B("next-modal animate__animated animate__fadeIn__pinter z-[8848] transition-all duration-100"),style:{animationDuration:"0.1s",animationDelay:"0.2s"},children:n});return EI.createPortal(i,document.body)},$ee=F.memo(e=>{const{title:t,more:n,children:s,disabled:a,boxClassName:o,active:i,...l}=e;return r.jsx(Fe,{className:B("py-1 px-[3.75px]",o),popup:t,children:r.jsxs("span",{...l,className:B("flex items-center justify-center rounded h-[30px] w-[30px] whitespace-nowrap",a?"cursor-not-allowed opacity-40":"animate-hover",{"bg-black_006":i},e.className),children:[s,n&&r.jsx(H,{name:"IcArrow",size:"xxxsmall",className:"ml-1.5"})]})})}),co=F.memo(e=>{const{uuid:t,realBlockId:n,editorModel:s,className:a,plugins:o,placeholder:i,placeholderColor:l,alwaysShowPlaceholder:c=!0,onKeyDown:u,readonly:d=!1,interactable:f=!0,segments:h,onChange:p,toolbar:g=!0,comments:_=!1,autoFocus:x=!1,autoFocusCaretToEnd:y=!1,segmentType:b="segments",keydownOption:E=rC,onBlur:w,onFocus:k,onClick:C,onCompositionStart:T,history:v={count:20},disabledKeydownOption:I,...j}=e,D=ht(),S=xn(),R=gt(),A=IC(t,b,E),L=jC(t,b,E),P=s!=null?s:S(t,!0,o),M=ef(),{undo:U,redo:V}=Uee(P,!d&&v?v.count:0),W=Pl(t),z=xJ(),Q=Im();F.useEffect(()=>{P.setReadonly(d)},[P,d]);const Z=F.useRef(),te=F.useRef(NaN);F.useEffect(()=>(P[Jm]=Z,P[Pg]=te,wd.set(W,P),()=>{wd.delete(W)}),[W,P]),yA(W,P);const re=F.useRef({autoFocus:x,autoFocusCaretToEnd:y});F.useEffect(()=>{FF(P,h)},[t,P,h]),F.useEffect(()=>{const ie=P.onChange.subscribe(({previousContent:ue,previousSelection:ge})=>{var dt;const{content:Ne}=P;if(Ne===ue)return;const{unwrapSegments:De,segments:Se}=nR(Ne,!0),{wrapSegments:Ie,hasNewEmoji:Ke}=Dk(Se);if(Ke){let $e=(dt=P.selection)==null?void 0:dt.focusOffset;ge&&($e=ge.focusOffset),P.performChange(ut=>{ut.load(gp(Ie)),ut.select($e,$e)});return}te.current!==P.revision&&(Z.current=De,p==null||p(De,ue,ge),te.current=P.revision)});return()=>{ie.unsubscribe()}},[P,p]);const ne=F.useRef(null);F.useEffect(()=>{const ie=ne.current;ie&&(ie[GR]=P)},[P]),F.useEffect(()=>{const ie=ne.current;if(ie)return ie.addEventListener("inlinedinput",A),()=>{ie.removeEventListener("inlinedinput",A)}},[A]),F.useEffect(()=>{const{autoFocus:ie,autoFocusCaretToEnd:ue}=re.current;setTimeout(()=>{ie&&(ue&&P.performChange(ge=>{ge.select().collapse("end")}),P.requestFocus())},0)},[P]),F.useEffect(()=>{const ie=P.onSelectionChange.subscribe(()=>{let ue=MI;P.selection!=null&&(ue={...Q3(P.content,P.selection.endOffset),customs:null}),P.performChange(ge=>{ge.setFormat(ue)})});return()=>{ie.unsubscribe()}},[P]),F.useEffect(()=>{if(!d)return;const ie=N1(document,"keydown").subscribe(ue=>{if(!be("mod+shift+m")(ue))return;const ge=$I();ge!=null&&ge[0]===P.editorKey&&(ue.nativeEvent=ue,L(ue))});return()=>ie.unsubscribe()},[L,P.editorKey,d]);const Y=g8((ie,ue,ge)=>{if(!d&&M(R,t),C==null||C(ge),!_)return;const Ne=P.hitTest(ge.clientX,ge.clientY);if(Ne==null||P.selection!=null&&!P.selection.isCollapsed)return;const De=Q3(P.content,Ne),Se=el(De),Ie=ie(zm),Ke=Ik(Ie,{noTable:!0}),dt=[...Se,...Ke];z({editorModel:P,popcorn:{getBoundingClientRect(){const $e=P.getBoundingClientRectOfRange(Ne,Ne);return $e!=null?$e:new DOMRect(-9999,-9999,0,0)}},selector:$e=>dt.map(ut=>$e.discussions[ut]).filter(ut=>ut!=null&&ut.status===m.BlockStatus.NORMAL&&!ut.resolved)})},Gm),X=Q&&D&&_,oe=!D&&(!d||_);return r.jsxs(qm.Provider,{value:{readonly:d,interactable:f},children:[r.jsx(HE,{emptyClassName:B("biz-placeholder-shown",gn({selectors:{[c?"&:after":"&:focus-within:after"]:{content:JSON.stringify(i),pointerEvents:"none",color:l!=null?l:"var(--grey4)"},"& > br":{display:"none"}}})),"data-real-block-id":n!=null?n:t,className:B("break-words whitespace-pre-wrap",a,gn({outline:"0 !important"})),model:P,ref:ne,onBlur:w,onFocus:k,spellCheck:!1,onClick:Y,onCompositionStart:T,onKeyDown:ie=>{d||(u==null||u(ie),!ie.isDefaultPrevented()&&(v&&(be("mod+z")(ie)?(U(),ie.preventDefault(),ie.stopPropagation()):be("mod+shift+z")(ie)&&(V(),ie.preventDefault(),ie.stopPropagation())),I||L(ie)))},...j}),g&&(X||oe)&&r.jsx(qee,{uuid:t,containerRef:ne,model:P,comments:_,segmentType:b})]})}),Mo=F.memo(({onKeyDown:e,placeholder:t,uuid:n,className:s,alwaysShowPlaceholder:a=!0,toolbar:o,disabledKeydownOption:i,segmentType:l="segments",keydownOption:c,comments:u=!0})=>{const d=_e(n,["data"],[l]),f=Ve(n),h=Pr(n,l),p=qi(),g=xn(),_=Kt(),x=F.useRef(),y=Vn(),b=F.useMemo(()=>{if(y===Tt.PAGE_FEEDS&&x.current===void 0){const C=Kk(EF);return x.current=new C,x.current}return g(n,!0)},[g,y,n]),E=F.useContext(jX),w=pt.print;F.useEffect(()=>{za.activeEditorKey===b.editorKey&&(za.selection&&(b.performChange(C=>{za.selection&&C.select(za.selection.offset,za.selection.endOffset)}),za.selection=null),b.requestFocus())},[n,b]),Em(()=>{wt.$createBlockMenuListId===n&&p()});let k=d==null?void 0:d.data[l];return E&&(f?E==="deleted"?k=m1(k,void 0):E==="created"?k=m1(void 0,k):k=m1(E.data[l],k):console.error("diffAgainstTo must company with readonly")),r.jsx(co,{keydownOption:c,uuid:n,editorModel:b,toolbar:o,comments:u,disabledKeydownOption:i,className:B(s,"break-words"),placeholder:w?"":t,alwaysShowPlaceholder:w?!1:a,onKeyDown:e,readonly:f,segments:k,segmentType:l,onCompositionStart:()=>{_(Xe.COMMENTS)},onChange:(C,T,v)=>{y!==Tt.PAGE_LITE_PREVIEW&&h(C,[T,v])},history:!1})});Mo.displayName="Editable";gQ(co);const eE=({recordId:e,recordIds:t,propertyId:n,onUpdate:s,onClose:a})=>{const o=n==="title",i=dr(qe),l=xn(),c=ae(({blocks:g})=>{var _,x,y;return o?(_=g[e])==null?void 0:_.data.segments:(y=(x=g[e])==null?void 0:x.data.collectionProperties)==null?void 0:y[n]}),[u,d]=F.useState(c),f=zs(),h=F.useRef(!1),p=()=>{h.current&&f(t||e,n,u)};return Yg({onUpdate:s,onClose:a,onSave:p}),r.jsx("div",{className:"min-w-full p-[9px] leading-[20px]",onKeyDown:g=>{if(be("shift+enter")(g)){g.preventDefault();const _=l(i,!1);_==null||_.performChange(x=>{x.delete().insert(`
`)});return}be("enter")(g)?(g.preventDefault(),p(),a()):be("esc")(g)&&a()},children:r.jsx(co,{uuid:i,realBlockId:e,plugins:o?kr:void 0,toolbar:!o,autoFocus:!0,autoFocusCaretToEnd:!0,className:"text-t2 whitespace-pre-wrap",segments:u,keydownOption:Ic,onChange:g=>{h.current=!0,d(g)}})})},HF=({recordId:e,propertyId:t,multiple:n=!1,editable:s=!1,onChange:a,className:o,itemClassName:i})=>{const l=ae(({blocks:f})=>{var p,g,_,x,y;const h=(g=(p=f[e])==null?void 0:p.parentId)!=null?g:"";return(y=(x=(_=f[h])==null?void 0:_.data.schema)==null?void 0:x[t])==null?void 0:y.options});let u=ae(({blocks:f})=>{var p,g;const h=(g=(p=f[e])==null?void 0:p.data.collectionProperties)==null?void 0:g[t];return de(h).trim()}).split(/\s*,\s*/g).filter(f=>l==null?void 0:l.some(h=>h.value===f));n||(u=u.slice(0,1));const d=f=>{a==null||a(u.filter(h=>h&&h!==f).join(","))};return u.length===0?null:r.jsx("div",{className:B("relative",o),children:u.map(f=>{const h=l==null?void 0:l.find(g=>g.value===f);if(h==null)return null;const p=()=>{h.value&&d(h.value)};return r.jsx(Tl,{className:B("flex-shrink-0",i),color:h.color,value:h.value,label:h.value,showClose:s,onDelete:p},h.id)})})},SC=()=>{const{getState:e}=Kr(),t=_a(),n=(s,a,o,i=!0)=>{var f,h;const l=e().blocks[s];if(!l)return;const c=(f=l.data.schema)==null?void 0:f[a];if(!c)return;const d=((h=c.options)!=null?h:[]).concat({...o});t(s,a,{options:d},{needTransaction:i})};return F.useCallback(n,[e,t])},RC=(e,t)=>{const n=new Set(t);if(e.length===n.size)return od(e);const s=e.filter(a=>!n.has(a));return od(s)},$B=()=>{const{getState:e,dispatch:t}=Kr(),n=ke(),s=(a,o,i)=>{var h,p;const{blocks:l}=e(),c=l[a];if(!c)return;const{[o]:u,...d}=(h=c.data.schema)!=null?h:{};if(!u)return;const f=(p=u.options)==null?void 0:p.filter(g=>g.id!==i);n(()=>{t(mn({uuid:a,patch:{data:{schema:{...d,[o]:{...u,options:f}}}}}))})};return F.useCallback(s,[t,e,n])},AC=()=>{const{getState:e,dispatch:t}=Kr(),n=ke(),s=(a,o,i)=>{n(()=>{var _,x;const{blocks:l}=e(),c=l[a];if(!c)return;const{[o]:u,...d}=(_=c.data.schema)!=null?_:{};if(!u)return;const f=(x=u.options)!=null?x:[],h=f.find(y=>y.id===i.id);if(!h)return;const p={...h,...i};if(rn(p,h))return;const g=f.map(y=>y.id===i.id?p:y);t(mn({uuid:a,patch:{data:{schema:{...d,[o]:{...u,options:g}}}}})),!rn(p,h)&&c.subNodes.forEach(y=>{var T;const b=l[y];if(!b)return;const{role:E}=hn(y);if(E===m.PermissionRole.READER)return;const w=de((T=b.data.collectionProperties)==null?void 0:T[o]);if(!w)return;let k=!1;const C=w.split(",").map(v=>v?v===h.value?(k=!0,p.value):v:"").filter(v=>!!v).join(",");k&&t(mn({uuid:y,patch:{updatedAt:Date.now(),data:{collectionProperties:{...b.data.collectionProperties,[o]:mt(C)}}}}))})})};return F.useCallback(s,[t,e,n])},GB=({option:e,propertyId:t,closeModal:n,closeBeforeCallbackRef:s,collectionId:a})=>{const o=F.useRef(null),{getState:i}=Kr(),l=AC(),c=$B(),u=me(),[d,f]=F.useState(e.value),h=()=>{var x,y,b;const p=d.replaceAll(",","").trim();if(!p)return;const{blocks:g}=i(),_=(b=(y=(x=g[a])==null?void 0:x.data.schema)==null?void 0:y[t])==null?void 0:b.options;if(_&&p!==e.value){if(_.some(E=>E.value===p))return u.warning({title:r.jsx(r.Fragment,{children:"此属性已存在同名的选项"}),noCancel:!0,confirm(){var E;(E=o.current)==null||E.focus()}}),"prevent";l(a,t,{id:e.id,value:p})}};return s.current=h,r.jsxs("div",{className:"flex flex-col w-[240px] rounded-sm next-modal",children:[r.jsx("div",{className:"flex flex-row items-center w-full",children:r.jsx(xt,{inputRef:o,autoFocus:!0,placeholder:"请输入名称",value:d,onChange:f,onEnter:p=>{p.preventDefault(),n()},className:"h-8 mx-2.5 my-2.5 flex-1"})}),r.jsxs("div",{className:"flex flex-col mb-[5px]",children:[r.jsx(ze,{keyDownPriority:Tr+1,items:[{type:$.OPERATION,data:{icon:"IcMenuDelete",title:"删除",onClick:()=>{u.warning({title:r.jsx(r.Fragment,{children:"是否确认删除该选项？"}),confirm:()=>{s.current=void 0,c(a,t,e.id),n()}})}}},{type:$.LINE,data:{},disableClick:!0}]}),r.jsx(Ld,{bgColorFn:XE,value:e.color,onSelect:p=>{l(a,t,{id:e.id,color:p}),n()}})]})]})},Gee=({option:e,active:t,onSelect:n,onMore:s,onMouseOver:a,readonly:o})=>r.jsxs("div",{className:B("w-full flex px-2 h-8 cursor-pointer items-center animate-hover",{"bg-black_006":t}),onMouseOver:a,onClick:n,children:[r.jsxs("div",{className:"flex flex-1 items-center whitespace-nowrap overflow-hidden overflow-ellipsis",children:[r.jsx(H,{className:"mr-1 text-grey4",size:"small",name:"IcBlockHandle"}),r.jsx(Tl,{value:e.value,label:e.value,color:e.color})]}),!o&&r.jsx("button",{className:"w-5 h-5 text-grey3 animate-hover rounded flex items-center justify-center",onClick:i=>{i.stopPropagation(),s==null||s(i)},children:r.jsx(H,{size:"small",name:"IcMore"})})]}),zB=({readonly:e,options:t,onSelect:n,onMore:s,onSort:a,onFocus:o})=>{const[i,l]=F.useState(-1);F.useEffect(()=>{const u=t[i];o(u)},[i,o,t]),F.useEffect(()=>{const u=f=>{var p,g;const h=(p=t[f])==null?void 0:p.id;h&&((g=document.querySelector(`[data-option-id="${h}"]`))==null||g.scrollIntoView({block:"nearest"}))},d=f=>{be("ArrowUp")(f)&&(f.stopPropagation(),f.preventDefault(),l(h=>{const p=Math.max(0,h-1);return u(p),p})),be("ArrowDown")(f)&&(f.stopPropagation(),f.preventDefault(),l(h=>{const p=Math.min(t.length-1,h+1);return u(p),p}))};return document.body.addEventListener("keydown",d),()=>{document.body.removeEventListener("keydown",d)}},[t]);const c=({active:u,over:d})=>{d&&a(u.id,d.id)};return r.jsx(vr,{disabled:e,items:t,onChange:(u,d)=>c(d),renderItemContent:({item:u})=>{var d;return r.jsx(Gee,{readonly:e,active:u.id===((d=t[i])==null?void 0:d.id),onMore:f=>s(u,f),onSelect:f=>n(u,f),option:u})}})},WB=({multiple:e,site:t,recordId:n,viewId:s,recordIds:a,propertyId:o,onUpdate:i,onClose:l})=>{var re,ne,Y,X,oe;const c=(re=DF(n))!=null?re:"",u=Ve(c),d=(ne=Tg(s))!=null?ne:c,f=So(d),h=F.useRef(null),{propertySchema:p}=qa(c,o),g=ae(({blocks:ie})=>{var ge,Ne;const ue=(Ne=(ge=ie[n])==null?void 0:ge.data.collectionProperties)==null?void 0:Ne[o];return de(ue).split(",").map(De=>De.trim()).filter(De=>{var Se;return(Se=p==null?void 0:p.options)==null?void 0:Se.some(Ie=>Ie.value===De)}).join(",")}),_=me(),x=zs(),y=_a(),b=SC(),[E,w]=F.useState(g),[k,C]=F.useState(""),[T,v]=F.useState(),I=!a||a.length===1,j=F.useMemo(()=>{var ue,ge,Ne;const ie=wr.map(De=>De.key);return(Ne=RC(ie,(ge=(ue=p==null?void 0:p.options)==null?void 0:ue.map(De=>De.color))!=null?ge:[]))!=null?Ne:wr[0].key},[p==null?void 0:p.options]);Yg({onUpdate:i,onClose:l,onSave:()=>{}});const D=ie=>{w(ie),x(a!=null?a:n,o,mt(ie))},S=ie=>{if(h.current&&(h.current.value="",h.current.focus()),!ie)return;const ue=E.split(/\s*,\s*/g).filter(Ne=>Ne);if(ue.includes(ie)&&I)return;ue.push(ie);const ge=ue.join(",");D(ge)},R=ie=>{ie===E&&I||D(ie)},A=()=>{const ie=E.split(/\s*,\s*/g).filter(ue=>ue);ie.pop(),D(ie.join(","))},L=ie=>{var ue;ie.value&&(C(""),e?(S(ie.value),(ue=h.current)==null||ue.focus()):(R(ie.value),l()))},P=ie=>{if(!(f||u)){if(be("Esc")(ie)){l();return}if(be("Enter")(ie)){Z?U():T!=null&&T.value&&(e?S(T.value):(R(T.value),l()));return}!k&&be("Backspace")(ie)&&A()}},M=(ie,ue)=>{if(!(p!=null&&p.options))return;const ge=p.options.findIndex(Se=>Se.id===ie),Ne=p.options.findIndex(Se=>Se.id===ue),De=qc(p.options,ge,Ne);y(c,o,{options:De})},U=()=>{var ge;const ie=qe(),ue=k.replace(/,/g,"").trim();b(c,o,{id:ie,value:ue,color:j}),e?(S(ue),C(""),(ge=h.current)==null||ge.focus()):(R(ue),l())},V=ie=>{v(ie)},W=F.useRef(),z=(ie,ue)=>{_.dropdown({popcorn:ue.currentTarget,placement:"right",content({onCloseModal:ge}){return r.jsx(GB,{option:ie,collectionId:c,propertyId:o,closeModal:ge,closeBeforeCallbackRef:W})},closeBeforeCallBack:()=>{var ge;return(ge=W.current)==null?void 0:ge.call(W)},closeAfterCallBack(){var ge;(ge=h.current)==null||ge.focus()}})},Q=(X=(Y=p==null?void 0:p.options)==null?void 0:Y.filter(ie=>{var ue;return(ue=ie.value)==null?void 0:ue.includes(k)}))!=null?X:[],Z=k&&((oe=p==null?void 0:p.options)==null?void 0:oe.every(ie=>ie.value!==k.trim())),te=u||f;return r.jsxs("div",{style:{maxHeight:"80vh",overflow:"auto"},children:[r.jsxs("div",{className:"p-2 items-center flex flex-wrap min-h-[42px]",children:[r.jsx(HF,{site:t,recordId:n,propertyId:o,multiple:e,editable:!0,className:"w-full",itemClassName:"m-[3px] max-w-[calc(100%-6px)]",onChange:ie=>{var ue;D(ie),(ue=h.current)==null||ue.focus()}}),!u&&r.jsx(oo,{ref:h,autoFocus:!0,singleLine:!0,placeholder:"查找或创建选项",fontClassName:gn({lineHeight:"24px",fontSize:14,whiteSpace:"nowrap"}),className:gn({width:"100%",selectors:{"&::placeholder":{color:"var(--grey4)"}}}),boxClassName:gn({flexBasis:"auto",flexGrow:1,flexShrink:0,minWidth:120,maxWidth:"100%"}),value:k,onKeyDown:P,onChange:ie=>{C(ie.target.value)}})]}),r.jsx(Rr,{}),r.jsx("div",{className:"p-2 text-t2 text-grey3",children:!k&&Q.length===0?"暂无选项":"选择或创建一个选项"}),r.jsx(zB,{options:Q,onSelect:L,onMore:z,onSort:M,onFocus:V,readonly:te}),Z&&!te&&r.jsxs("div",{onClick:U,className:"p-2 flex items-center cursor-pointer animate-hover",children:[r.jsx("span",{className:"flex-shrink-0 text-grey3 text-t2 mr-2",children:"创建选项"}),r.jsx(Tl,{color:j,label:k,value:k})]})]})},zee=({className:e,...t})=>r.jsx(HF,{className:B("p-[5px] w-full",e),...t,itemClassName:"max-w-[calc(100%-6px)] m-[3px]"}),Wee=({className:e,...t})=>r.jsx(HF,{className:B("p-[5px] w-full",e),...t,multiple:!0,itemClassName:"max-w-[calc(100%-6px)] m-[3px]"}),Kee=e=>r.jsx(WB,{...e}),Yee=e=>r.jsx(WB,{multiple:!0,...e});let KB;const Xee=e=>{KB=e},YB=e=>e===m.CollectionSchemaType.SELECT?Kee:e===m.CollectionSchemaType.MULTI_SELECT?Yee:e===m.CollectionSchemaType.DATE?PZ:e===m.CollectionSchemaType.PERSON?lee:e===m.CollectionSchemaType.TEXT?eE:e===m.CollectionSchemaType.NUMBER?iee:e===m.CollectionSchemaType.TITLE?eE:e===m.CollectionSchemaType.URL||e===m.CollectionSchemaType.EMAIL||e===m.CollectionSchemaType.PHONE?lb:e===m.CollectionSchemaType.FILE?YZ:e===m.CollectionSchemaType.FORMULA?tee:e===m.CollectionSchemaType.RELATION?KB:see,XB=e=>{const t=ae(({blocks:s})=>{var o,i,l,c;const a=(o=s[e.recordId])==null?void 0:o.parentId;return(c=(l=(i=s[a!=null?a:""])==null?void 0:i.data.schema)==null?void 0:l[e.propertyId])==null?void 0:c.type}),n=YB(t);return r.jsx(n,{...e})},Qee=({className:e,recordId:t,propertyId:n,site:s})=>{const{relationRecords:a}=QB(t,n);return a.length===0?null:r.jsx("div",{className:B((s===Me.CELL||s===Me.FIELD)&&"w-full h-full p-2 flex flex-wrap",(s===Me.CALENDAR||s===Me.LIST)&&"inline",s===Me.CARD&&"flex flex-wrap w-full overflow-hidden",e),children:a.map(o=>r.jsx(Aa,{uuid:o,autoIconSize:s!==Me.CELL&&s!==Me.FIELD,className:B("leading-none p-0 mr-2 whitespace-nowrap",s===Me.CARD&&"text-ellipsis")},o))})},QB=(e,t)=>ae(({blocks:n})=>du(e,t,n),{equalityFn:kn}),Jee=({className:e,recordId:t,propertyId:n})=>{var i;const s=Ve(t),a=n==="title",o=ae(({blocks:l})=>{var c,u,d;return a?(c=l[t])==null?void 0:c.data.segments:(d=(u=l[t])==null?void 0:u.data.collectionProperties)==null?void 0:d[n]});return!o||o.length===0||o.length===1&&((i=o[0])==null?void 0:i.type)===m.TextType.TEXT&&o[0].text===""?null:r.jsx("div",{className:"p-2",children:r.jsx(Pn,{className:B("leading-[20px]",e),plugins:a?kr:void 0,segments:o,interactable:s})})},Zee=({collectionId:e,propertyId:t,closeSelf:n})=>{const{relationPropertySchema:s}=qa(e,t),a=_a(),i=ae(({blocks:c})=>{var h,p;const u=c[(h=s==null?void 0:s.collectionId)!=null?h:""],d=[],f={findSchema(g,_){var x,y;return(y=(x=c[g])==null?void 0:x.data.schema)==null?void 0:y[_]}};return Object.entries((p=u==null?void 0:u.data.schema)!=null?p:{}).forEach(([g,_])=>{var x;_.type!==m.CollectionSchemaType.ROLLUP&&!z6(e,t,(x=s==null?void 0:s.collectionId)!=null?x:"",g,f)&&d.push({..._,propertyId:g})}),d}).map(c=>({type:$.OPERATION,data:{icon:an[c.type],title:c.name,propertyId:c.propertyId,type:c.type}})),l=(c,u)=>{var h,p,g;const{blocks:d}=le(),f=(g=((p=(h=d[e])==null?void 0:h.data.schema)!=null?p:{})[t])!=null?g:{};a(e,t,{...f,targetProperty:c,targetPropertyType:u,aggregation:void 0,showAs:void 0}),n()};return r.jsx("div",{className:"flex flex-col w-[300px] rounded-sm next-modal-scroll py-2",children:r.jsx(ze,{items:i,onItemClick:c=>l(c.data.propertyId,c.data.type)})})},ete=({collectionId:e,propertyId:t,closeSelf:n})=>{const s=_a(),o=ae(({blocks:l})=>{var d;const c=l[e],u=[];return Object.entries((d=c==null?void 0:c.data.schema)!=null?d:{}).forEach(([f,h])=>{h.type===m.CollectionSchemaType.RELATION&&u.push({...h,propertyId:f})}),u}).map(l=>({type:$.OPERATION,data:{icon:an[m.CollectionSchemaType.RELATION],title:l.name,propertyId:l.propertyId}})),i=l=>{var d,f,h;const{blocks:c}=le(),u=(h=((f=(d=c[e])==null?void 0:d.data.schema)!=null?f:{})[t])!=null?h:{};s(e,t,{...u,relationProperty:l,targetProperty:"title",targetPropertyType:m.CollectionSchemaType.TITLE,aggregation:void 0,showAs:void 0}),n()};return r.jsx("div",{className:"flex flex-col w-[300px] rounded-sm next-modal-scroll py-2",children:r.jsx(ze,{items:o,onItemClick:l=>i(l.data.propertyId)})})},BC=({viewId:e,collectionId:t,propertyId:n})=>{var x,y,b;const s=me(),a=(x=Tg(e))!=null?x:t,o=Ve(a),i=So(a),l=o||i,c=_a(),{propertySchema:u,targetPropertySchema:d,relationPropertySchema:f}=qa(t,n),{targetProperty:h}=u!=null?u:{};if(!u)return null;const p=E=>{l||s.dropdown({popcorn:E.currentTarget,placement:"bottom",content:({onCloseModal:w})=>r.jsx(ete,{collectionId:t,propertyId:n,closeSelf:w})})},g=E=>{l||f&&s.dropdown({popcorn:E.currentTarget,placement:"bottom",content:({onCloseModal:w})=>r.jsx(Zee,{collectionId:t,propertyId:n,closeSelf:w})})},_=E=>{if(l||!(f!=null&&f.collectionId)||!h)return;const k=qJ(f.collectionId,h,d==null?void 0:d.type).map(T=>({type:$.OPERABLE_BLOCK_TEXT,data:T})),C=T=>{c(t,n,{...u,showAs:void 0,aggregation:T})};s.dropdown({popcorn:E.currentTarget,placement:"bottom",content:({onCloseModal:T})=>r.jsx(ze,{className:"w-[200px] py-2 next-modal-scroll",items:k,onItemClick:v=>{C(v.data.type),T()}})})};return r.jsxs("div",{className:"flex flex-col w-[240px] rounded-sm next-modal",children:[r.jsxs("div",{className:"flex flex-col mb-[5px]",children:[r.jsx("div",{className:"text-t2 text-grey3 mb-[4px] mx-4 mt-2.5",children:"关联"}),r.jsxs("div",{onClick:p,className:"flex items-center justify-between h-10 px-2 mx-2 rounded cursor-pointer active-bg animate-hover text-ellipsis",children:[r.jsxs("div",{className:"flex min-w-0 items-center",children:[f&&r.jsx(H,{name:an[f.type],size:"middle"}),r.jsx("span",{className:"flex-1 min-w-0 overflow-hidden text-black whitespace-nowrap overflow-ellipsis text-t2 ml-2",children:(y=f==null?void 0:f.name)!=null?y:"请选择"})]}),!l&&r.jsx(H,{name:"IcMenuNext",size:"middle",className:"text-grey4 rotate-90"})]})]}),r.jsxs("div",{className:B("flex flex-col mb-[5px]"),children:[r.jsx("div",{className:"text-t2 text-grey3 mb-[4px] mx-4 mt-2.5",children:"汇总属性"}),r.jsxs("div",{onClick:g,className:B("flex items-center justify-between h-10 px-2 mx-2 rounded cursor-pointer text-ellipsis",f?"animate-hover active-bg":"opacity-30"),children:[r.jsxs("div",{className:"flex min-w-0 items-center",children:[d&&r.jsx(H,{name:an[d.type],size:"middle"}),r.jsx("span",{className:"flex-1 min-w-0 overflow-hidden text-black whitespace-nowrap overflow-ellipsis text-t2 ml-2",children:(b=d==null?void 0:d.name)!=null?b:"请选择"})]}),!l&&r.jsx(H,{name:"IcMenuNext",size:"middle",className:"text-grey4 rotate-90"})]})]}),r.jsxs("div",{className:B("flex flex-col mb-[5px]"),children:[r.jsx("div",{className:"text-t2 text-grey3 mb-[4px] mx-4 mt-2.5",children:"汇总方式"}),r.jsxs("div",{onClick:_,className:B("flex items-center justify-between h-10 px-2 mx-2 rounded cursor-pointer text-ellipsis",f?"animate-hover active-bg":"opacity-30"),children:[r.jsx("div",{className:"flex min-w-0 items-center",children:r.jsx("span",{className:"flex-1 min-w-0 overflow-hidden text-black whitespace-nowrap overflow-ellipsis text-t2",children:u.aggregation?V6[u.aggregation]:"显示 原始值"})}),!l&&r.jsx(H,{name:"IcMenuNext",size:"middle",className:"text-grey4 rotate-90"})]})]})]})},JB=e=>{const t=me(),n=(s,a,o,i)=>{s.stopPropagation(),t.dropdown({popcorn:i!=null?i:s.currentTarget,placement:"bottom",content:()=>r.jsx(BC,{collectionId:e,propertyId:a,viewId:o})})};return F.useCallback(n,[e,t])},tte=zt.memo(({className:e,recordId:t,propertyId:n,site:s})=>{var x;const{collectionId:a,viewId:o}=Te(),i=JB(a),{propertySchema:l,targetPropertySchema:c}=qa(a,n),{aggregation:u}=l!=null?l:{},d=Cg(o),f=ae(y=>Jr(t,n,y),{equalityFn:kn});let h;if(f){const{originValues:y,targetProperty:b,targetPropertySchema:E,aggregationValue:w,relationRecords:k,formulaType:C}=f;if(so(u)&&(h=nte({relationRecords:k,propertyId:b,propertySchema:E,rollupSchema:l,blocks:le().blocks,originValues:y,site:s,formulaType:C,tableCellWrap:d})),typeof w<"u"){const T=E.type===m.CollectionSchemaType.NUMBER&&!!E.numberFormat&&Vf(u);let v=w;if(T){const D=Sc(Number(w),E.numberFormat);if(typeof D=="string")v=D;else if(typeof D=="number")v=String(D);else return null}let I=null;if(zd(u))I=Ep({num:bg(w),showAs:l==null?void 0:l.showAs,numberFormat:"percent",from:"rollup"});else{const D=Number(w);isNaN(D)||q6(u)==="number"&&(I=Ep({num:D,showAs:l==null?void 0:l.showAs,numberFormat:Vf(u)?E.numberFormat:void 0,from:"rollup"}))}const{showNumber:j}=(x=l==null?void 0:l.showAs)!=null?x:{};h=r.jsxs("div",{className:B("w-full",I&&"flex items-center whitespace-nowrap",I&&s===Me.CELL&&"justify-end",s===Me.CELL&&!ai(u)?"text-right ":"text-left"),children:[I&&!j?null:v,I]})}}const p=c==null?void 0:c.type,_=so(u)&&(p===m.CollectionSchemaType.PERSON||p===m.CollectionSchemaType.UPDATED_BY||p===m.CollectionSchemaType.CREATED_BY);return r.jsxs("div",{className:B("rollup-box h-full w-full",!_&&(s===Me.CELL||s===Me.FIELD)&&"p-2",e),children:[h,!h&&s===Me.FIELD&&r.jsx("span",{className:"text-grey4",children:"未填写"}),(s===Me.CELL||s===Me.FIELD)&&r.jsx("button",{onClick:y=>i(y,n,o),className:B("animate-hover-opaque border-grey6 absolute top-1.5 right-1 flex h-6 w-6 cursor-pointer items-center justify-center rounded border bg-white1 opacity-0"),children:r.jsx(H,{name:"IcBtnEdit",size:"middle",className:"text-grey3"})})]})},kn),nte=({propertyId:e,relationRecords:t,blocks:n=le().blocks,propertySchema:s,rollupSchema:a,originValues:o,site:i,formulaType:l,tableCellWrap:c})=>{if(!s)return null;const u=s.type,d=(f,h)=>{var x;let p=f;if(s.numberFormat){const y=Sc(Number(f),s.numberFormat);if(typeof y=="string")p=y;else if(typeof y=="number")p=String(y);else return null}let g=null;const _=Number(f);return isNaN(_)||(g=Ep({num:_,showAs:a==null?void 0:a.showAs,numberFormat:s.numberFormat,from:"property-value"})),a!=null&&a.showAs&&(a!=null&&a.showAs.type)?r.jsxs("div",{className:B("flex items-center whitespace-nowrap",i===Me.CELL&&"justify-end",(i===Me.LIST||i===Me.CALENDAR)&&"inline-flex ml-2"),children:[g&&!((x=a==null?void 0:a.showAs)!=null&&x.showNumber)?void 0:p,g]},h):r.jsx(Wo,{className:"inline leading-5 ",children:h===o.length-1?p:`${p}, `},h)};if(u===m.CollectionSchemaType.TITLE)return r.jsx(r.Fragment,{children:t.map(f=>r.jsx(Aa,{uuid:f,className:"mr-2 whitespace-nowrap p-0 leading-none"},f))});if(u===m.CollectionSchemaType.TEXT)return r.jsx(r.Fragment,{children:t.map((f,h)=>{var _;const p=n[f],g=(_=p==null?void 0:p.data.collectionProperties)==null?void 0:_[e];return de(g)?r.jsxs(zt.Fragment,{children:[r.jsx(Pn,{className:"inline leading-[20px]",segments:g,interactable:!1}),h!==o.length-1&&", "]},f):null})});if(u===m.CollectionSchemaType.DATE)return r.jsx(r.Fragment,{children:t.map((f,h)=>{var b,E;const p=n[f],g=(E=(b=p==null?void 0:p.data.collectionProperties)==null?void 0:b[e])==null?void 0:E[0];if(!g)return null;const _=Wp(g,s.dateFormat,g.type===m.TextType.DATETIME,g.timeFormat),x=Aj(g),y=Date.now()-(x!=null?x:0)>0;return g.reminder?r.jsxs(Wo,{className:B("inline leading-5 text-red",{"line-through text-red/70":y}),children:[_,r.jsx(H,{name:"IcMenuAlarm",size:"normal",className:B("text-red ml-[2px]",{"text-red/70":y})}),h===o.length-1?"":", "]},h):r.jsx(Wo,{className:"inline leading-5 ",children:h===o.length-1?_:`${_}, `},h)})});if(u===m.CollectionSchemaType.NUMBER)return r.jsx(r.Fragment,{children:o.map((f,h)=>typeof f!="string"?null:d(f,h))});if(u===m.CollectionSchemaType.CREATED_AT||u===m.CollectionSchemaType.UPDATED_AT)return r.jsx(r.Fragment,{children:o.map((f,h)=>typeof f!="string"?null:r.jsx(Wo,{className:"inline leading-5 ",children:h===o.length-1?f:`${f}, `},h))});if(u===m.CollectionSchemaType.PHONE||u===m.CollectionSchemaType.EMAIL||u===m.CollectionSchemaType.URL)return r.jsx(r.Fragment,{children:o.map((f,h)=>{if(typeof f!="string")return null;const g=AF(u)(f);return r.jsxs(zt.Fragment,{children:[r.jsx("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"animate-hover border-grey5 my-px inline cursor-pointer rounded-none border-b leading-5 text-black/95 hover:rounded-sm",children:f}),h!==o.length-1&&", "]},h)})});if(u===m.CollectionSchemaType.CHECKBOX)return r.jsx(r.Fragment,{children:o.map((f,h)=>{const p=typeof f=="string"&&f.toUpperCase()==="YES",g=i===Me.CELL||i===Me.FIELD;let _="";return p?_=g?"IcCheckboxCheck":"IcCheckbox2Check":_=g?"IcCheckbox":"icCheckbox2",r.jsx(Ra,{size:g?"large":"small",className:"mr-2",name:_,checked:p},h)})});if(u===m.CollectionSchemaType.CREATED_BY||u===m.CollectionSchemaType.UPDATED_BY||u===m.CollectionSchemaType.PERSON)return r.jsx("div",{className:B("flex",i===Me.LIST||i===Me.CALENDAR?"text-ellipsis whitespace-nowrap":"flex-wrap"),children:o.map((f,h)=>typeof f!="string"?null:r.jsx(hi,{className:"my-px px-2 py-1.5",userId:f},h))});if(u===m.CollectionSchemaType.SELECT||u===m.CollectionSchemaType.MULTI_SELECT){const{options:f}=s;return f?r.jsx("div",{className:B("flex",i===Me.LIST||i===Me.CALENDAR||!c?"text-ellipsis whitespace-nowrap":"flex-wrap"),children:o.map((h,p)=>{if(typeof h!="string")return null;const g=f.find(_=>_.id===h);return g?r.jsx(Tl,{color:g.color,value:g.value,label:g.value,className:B("flex-shrink-0",i!==Me.CELL&&i!==Me.FIELD?"text-t4 mr-1":"m-[3px]",i===Me.CALENDAR?"my-[1px]":"my-0.5")},p):null})}):null}else if(u===m.CollectionSchemaType.FILE){const f=[];return t.forEach(h=>{var _,x;const p=n[h];if(!p)return;((x=(_=p.data.collectionProperties)==null?void 0:_[e])!=null?x:[]).forEach(y=>{y.type===m.TextType.URL&&y.fileStorageType==="internal"&&f.push({...y,blockId:h})})}),r.jsx("div",{className:B("flex",i===Me.LIST||i===Me.CALENDAR?"text-ellipsis whitespace-nowrap py-px":"flex-wrap"),children:f.map((h,p)=>{const g=zp(h.url),_=r.jsx(Tl,{label:h.text,color:wr[0].key,className:B("max-w-[calc(100%-6px)] align-middle",i===Me.CELL||i===Me.FIELD?"m-[3px]":"mr-1")},p);return g&&h.uuid&&(!h.size||h.size<=SF)?r.jsx(oh,{uuid:h.uuid,ossName:h.url,defaultIcon:_,className:B("h-5 min-h-[20px] min-w-[20px] cursor-pointer overflow-hidden rounded-sm",i===Me.CELL||i===Me.FIELD?"m-[3px]":"mr-1")},p):_})})}else{if(u===m.CollectionSchemaType.RELATION)return r.jsx(r.Fragment,{children:o.map((f,h)=>typeof f!="string"?null:r.jsx(Aa,{uuid:f,className:"mr-2 whitespace-nowrap p-0 leading-none"},h))});if(u===m.CollectionSchemaType.FORMULA)return r.jsx(r.Fragment,{children:o.map((f,h)=>{if(typeof f!="string")return null;if(l===He.ValueTool.booleanType){const p=f==="YES";return r.jsx(Ra,{size:"large",checked:p},h)}return l===He.ValueTool.numberType?d(f,h):r.jsx(Wo,{className:"inline leading-5 ",children:h===o.length-1?f:`${f}, `},h)})})}return null};const ste=F.memo(({className:e,recordId:t})=>{const{illegal:n}=it(t),{relationEditor:s}=Te(),a=ae(({blocks:u})=>{var d;return(d=u[t])==null?void 0:d.data.segments}),o=ae(({blocks:u})=>{var f,h;const d=u[t];return((f=d==null?void 0:d.subNodes)!=null?f:[]).length>0||((h=d==null?void 0:d.data.icon)==null?void 0:h.type)}),i=ae(({blocks:u})=>{var d;return(d=u[t])==null?void 0:d.data.icon}),l=Cs(),c=Kp();return r.jsxs("div",{className:B("p-2 leading-none flex",{"opacity-30":n},e),children:[o&&r.jsx(tn,{className:B("mr-1 inline-block h-5 w-5 p-0",{"!align-middle":(i==null?void 0:i.type)!=="emoji"}),blockId:t,trigger:!1,iconSize:20,defaultIcon:r.jsx(as,{uuid:t,size:"middle"})}),n?r.jsx("span",{className:"border-b border-grey6 align-middle leading-[19px]",children:rs}):pt.print?r.jsx("a",{href:`/${t}`,className:"underline",children:r.jsx(Pn,{className:"text-t2 inline align-middle",plugins:kr,segments:a,interactable:!1})}):r.jsx(Pn,{className:"text-t2 inline align-middle",plugins:kr,segments:a,interactable:!1}),r.jsx(Zd,{className:"inline-flex align-middle pointer-events-none",blockId:t}),!s&&r.jsx("div",{className:"animate-hover-opaque absolute top-[5px] right-[5px] rounded border border-grey6 bg-white1 p-0.5 opacity-0 transition-opacity group-hover:opacity-100",onClick:u=>{u.stopPropagation(),Gc(location.search)===t?c():l(t,{illegal:n,forceOpenInRight:u.altKey,forceOpenNewTab:u.ctrlKey||u.metaKey})},children:r.jsx(Fe,{popup:"打开此页面",children:r.jsx(H,{size:"middle",name:"IcMenuOpen",className:"text-grey3"})})})]})},kn),FN=5,yN=F.memo(e=>{const{recordId:t,propertyId:n,groupValue:s,style:a,isLastCell:o}=e,{collectionId:i,viewId:l,relationEditor:c,viewType:u}=Te(),{illegal:d,pageId:f,readonly:h}=F.useContext(uB),p=ou(),g=Cg(l),_=F.useRef(null),[x,y]=F.useState(!1),b=me(),E=Kt(),w=u===m.CollectionViewType.TIMELINE,k=Os(),C=ae(({blocks:Y})=>{var X,oe,ie;return(ie=(oe=(X=Y[i])==null?void 0:X.data.schema)==null?void 0:oe[n])==null?void 0:ie.type}),T=Su(C),v=zs(),I=CZ(),j=ef(),D=!C||im.includes(C)||YD.includes(C),S=ae(({ui:{selectedCells:Y}})=>!!Y.find(oe=>oe.recordId===t&&oe.propertyId===n&&oe.viewId===l&&oe.groupValue===s)),R=ae(({ui:{selectedCells:Y}})=>{const X=Y[0];return X?X.recordId===t&&X.propertyId===n&&X.viewId===l&&X.groupValue===s:!1}),A=`cell-${t}-${n}-${l}-${s}`;F.useEffect(()=>()=>E(A),[A,E]);const L=F.useRef(null);F.useEffect(()=>{if(!_.current||!x)return;let Y;const X=3,oe=_.current.getBoundingClientRect(),ie={};(C===m.CollectionSchemaType.TEXT||C===m.CollectionSchemaType.TITLE||C===m.CollectionSchemaType.NUMBER||C===m.CollectionSchemaType.EMAIL||C===m.CollectionSchemaType.URL||C===m.CollectionSchemaType.PHONE)&&(Y="fadeIn",ie.overflow="auto",g?(ie.width=oe.width+X,ie.minHeight=Math.min(oe.height+X,window.innerHeight*.8)):(ie.minWidth=oe.width+X,ie.maxWidth=320)),(C===m.CollectionSchemaType.SELECT||C===m.CollectionSchemaType.MULTI_SELECT)&&(ie.minWidth=oe.width+X,ie.maxWidth=320),C===m.CollectionSchemaType.FILE&&(ie.minWidth=262,ie.maxWidth=320);const ue=C===m.CollectionSchemaType.DATE?oe.height:0;j(f,t),b.dropdown({modalId:A,animation:Y,placement:"bottom-start",offset:[-X/2,-oe.height-X/2+ue],popcorn:{getBoundingClientRect:()=>oe},closeBeforeCallBack(){var ge;if(y(!1),window.event&&window.event.type==="keydown"&&be("Enter")(window.event)){const Ne=uc({viewId:l,groupValue:s});let De=Ne.findIndex(Ie=>Ie===t);De+=1,De=Zn(De,0,Ne.length-1);const Se=(ge=Ne[De])!=null?ge:t;ee(nt.update({selectedCells:[{propertyId:n,recordId:Se,viewId:l,groupValue:s}]}))}else ee(nt.update({selectedCells:[{propertyId:n,recordId:t,viewId:l,syncId:k,groupValue:s}]}))},content({onCloseModal:ge}){return r.jsx("div",{className:"next-modal max-h-[80vh]",style:ie,ref:L,children:r.jsx(nx.Provider,{value:L,children:r.jsx(XB,{site:Me.CELL,viewId:l,recordId:t,propertyId:n,onUpdate:()=>{},onClose:ge})})})}})},[C,x,s,A,b,f,n,t,j,k,g,l]),F.useEffect(()=>{R&&!x&&_.current&&_.current.focus()},[S,x,R]),F.useEffect(()=>{const Y=wt.$newCreatedRecord;t===(Y==null?void 0:Y.id)&&l===Y.viewId&&C===m.CollectionSchemaType.TITLE&&(!Y.from||Y.from===Kg.TIMELINE_TABLE)&&(y(!0),Ye({$newCreatedRecord:void 0}))},[]);const P=F.useRef(!1),M=()=>{var Y,X;if(C&&!(h&&C!==m.CollectionSchemaType.FILE&&C!==m.CollectionSchemaType.RELATION)&&!wt.$isSelecting&&!P.current&&!d){if(C===m.CollectionSchemaType.CHECKBOX){const{blocks:oe}=le(),ie=(X=(Y=oe[t])==null?void 0:Y.data.collectionProperties)==null?void 0:X[n],ue=de(ie);v(t,n,ue.toUpperCase()==="YES"?"NO":"YES");return}if(x){y(!1);const oe=setTimeout(()=>{clearTimeout(oe),y(!0)})}else{if(D&&C!==m.CollectionSchemaType.FORMULA)return;y(!0)}}},U=Y=>{var De,Se,Ie,Ke;if(d||!C||wt.$isOpenImagePreview)return;const{ui:X,blocks:oe,collectionViews:ie}=le(),ue=X.selectedCells[0],ge=X.selectedCells[X.selectedCells.length-1];if(!ge||!ue)return;if(be(["ArrowUp","shift+ArrowUp","ArrowDown","shift+ArrowDown","ArrowLeft","shift+ArrowLeft","ArrowRight","shift+ArrowRight","Tab"])(Y)){Y.preventDefault();const{selectedCells:dt}=X;if(dt.length===0)return;const $e=Y.shiftKey,ut=uc({viewId:l,groupValue:s}),Ee=ie[l],Ge=(De=w?Ee==null?void 0:Ee.format.timelineTableProperties:Ee==null?void 0:Ee.format.tableProperties)==null?void 0:De.filter(It=>It.visible).map(It=>It.property);if(!Ge)return;let Je=Ge.findIndex(It=>It===($e?ge.propertyId:ue.propertyId)),et=ut.findIndex(It=>It===($e?ge.recordId:ue.recordId));if(Je===-1||et===-1){ee(nt.update({selectedCells:[]}));return}if(be(["ArrowUp","shift+ArrowUp"])(Y)?et-=1:be(["ArrowDown","shift+ArrowDown"])(Y)?et+=1:be(["ArrowLeft","shift+ArrowLeft"])(Y)?Je-=1:be(["ArrowRight","shift+ArrowRight","Tab"])(Y)&&(Je+=1),$e&&(Je<0||Je>=Ge.length||et<0||et>=ut.length))return;Je<0&&(et-=1,Je=Ge.length-1),Je>Ge.length-1&&(Je=0,et+=1),et=Zn(et,0,ut.length-1);const $t=Ge.findIndex(It=>It===ue.propertyId),tt=ut.findIndex(It=>It===ue.recordId),Ze=Ge[Je],jt=ut[et];if(Ze&&jt)if($e){const It=et>tt,nn=Je>$t,N=[];for(let O=tt;It?O<=et:O>=et;It?O++:O--)for(let G=$t;nn?G<=Je:G>=Je;nn?G++:G--){const J=Ge[G],se=ut[O];J&&se&&N.push({propertyId:J,recordId:se,viewId:l,syncId:k,groupValue:s})}ee(nt.update({selectedCells:N}))}else ee(nt.update({selectedCells:[{propertyId:Ze,recordId:jt,viewId:l,syncId:k,groupValue:s}]}));else ee(nt.update({selectedCells:[]}));return}if(h)return;const Ne=(Ie=(Se=oe[t])==null?void 0:Se.data.collectionProperties)==null?void 0:Ie[n];if(be("Enter")(Y)){if(C===m.CollectionSchemaType.CHECKBOX||C===m.CollectionSchemaType.ROLLUP||im.includes(C)){if(C===m.CollectionSchemaType.CHECKBOX){const Ee=de(Ne),Ge=K.ui.selectedCells.filter(Je=>Je.propertyId===n).flatMap(Je=>Je.recordId);if(v(Ge,n,Ee.toUpperCase()==="YES"?"NO":"YES"),Ge.length>1)return}const dt=uc({viewId:l,groupValue:s});let $e=dt.findIndex(Ee=>Ee===t);$e+=1,$e=Zn($e,0,dt.length-1);const ut=(Ke=dt[$e])!=null?Ke:t;ee(nt.update({selectedCells:[{propertyId:n,recordId:ut,viewId:l,syncId:k,groupValue:s}]}))}else ee(nt.update({selectedCells:[]})),y(!0);Y.preventDefault();return}be(["Backspace","Delete"],{byKey:!0})(Y)&&I(K.ui.selectedCells)},V=Y=>{if(Y.button===2||Y.target instanceof Element&&Y.target.closest("[data-disable-select], [data-draggable]"))return;Y.preventDefault(),!S&&C!==m.CollectionSchemaType.CHECKBOX&&(P.current=!0),Y.shiftKey||ee(nt.update({selectedCells:[{recordId:t,propertyId:n,viewId:l,syncId:k,groupValue:s}]}));const{autoScrollY:X,rafY:oe}=FC(),ie=p==null?void 0:p.current;if(!ie)return;const ue={x:Y.clientX,y:Y.clientY};let ge=!1;const Ne=fs(Se=>{if(!ge){if(Math.abs(ue.x-Se.clientX)<FN&&Math.abs(ue.y-Se.clientY)<FN)return;ge=!0}K.ui.selectedCells.length===0&&(Ye({$isSelecting:!0}),ee(nt.update({selectedCells:[{recordId:t,propertyId:n,viewId:l,syncId:k,groupValue:s}]}))),X({y:Se.clientY,container:ie}),cB(Se)},60),De=()=>{document.removeEventListener("mousemove",Ne),document.removeEventListener("mouseup",De),cancelAnimationFrame(oe.id),setTimeout(()=>{P.current=!1,Ye({$isSelecting:!1})},0)};document.addEventListener("mousemove",Ne),document.addEventListener("mouseup",De)},W=mB(),[z,Q]=F.useState(!1),Z=Y=>{C===m.CollectionSchemaType.FILE&&[...Y.dataTransfer.items].some(X=>X.kind==="file")&&Q(!0)},te=Y=>{Y.preventDefault(),Y.stopPropagation(),Q(!1),W1(),C===m.CollectionSchemaType.FILE&&[...Y.dataTransfer.items].filter(X=>X.kind==="file").map(X=>X.getAsFile()).forEach(X=>{W(X,[t],n)})},re=C===m.CollectionSchemaType.SELECT||C===m.CollectionSchemaType.FILE||C===m.CollectionSchemaType.MULTI_SELECT||C===m.CollectionSchemaType.RELATION||C===m.CollectionSchemaType.FORMULA,ne=C===m.CollectionSchemaType.FILE?"IcBtnNew":C===m.CollectionSchemaType.FORMULA?"IcTitleFormula":"IcNaviUnfold";return r.jsxs("div",{"data-property-id":n,ref:_,tabIndex:-1,style:a,className:B("relative outline-none",{"selected-cell":S,"focused-cell":R,"min-h-full":g,"h-full":!g,"bg-black_006":z,"pointer-events-none":c,"border-r ":!(w&&o&&!pt.print)}),onClick:M,onKeyDown:U,onMouseDown:V,onDragOver:Z,onDragLeave:()=>Q(!1),onDragEnd:()=>Q(!1),onDrop:te,children:[d&&C!==m.CollectionSchemaType.TITLE?null:r.jsxs("div",{className:B("flex-shrink-0 relative overflow-hidden text-t2",{"break-words whitespace-pre-wrap min-h-full":g,"whitespace-nowrap flex items-center overflow-ellipsis h-full":!g,"hover-box":re},gn({selectors:{"& > *":{flexShrink:g?void 0:0}}})),children:[r.jsx(Wg,{children:r.jsx(T,{site:Me.CELL,recordId:t,propertyId:n})}),re&&!h&&r.jsx("button",{onClick:()=>y(!0),className:B("animate-hover-opaque border-grey6 absolute top-1.5 right-1 flex h-6 w-6 cursor-pointer items-center justify-center rounded border bg-white1 opacity-0"),children:r.jsx(H,{name:ne,size:"middle",className:"text-grey3"})})]}),!h&&R&&!D&&r.jsx(MZ,{className:"absolute z-[9] right-[-5px] bottom-[-5px]"})]})}),Su=e=>{switch(e){case m.CollectionSchemaType.TITLE:return ste;case m.CollectionSchemaType.NUMBER:return YA;case m.CollectionSchemaType.CHECKBOX:return dB;case m.CollectionSchemaType.SELECT:return zee;case m.CollectionSchemaType.MULTI_SELECT:return Wee;case m.CollectionSchemaType.DATE:return LZ;case m.CollectionSchemaType.PERSON:return DQ;case m.CollectionSchemaType.UPDATED_AT:return AZ;case m.CollectionSchemaType.CREATED_AT:return BZ;case m.CollectionSchemaType.UPDATED_BY:return IQ;case m.CollectionSchemaType.CREATED_BY:return jQ;case m.CollectionSchemaType.TEXT:return Jee;case m.CollectionSchemaType.URL:return ree;case m.CollectionSchemaType.EMAIL:return aee;case m.CollectionSchemaType.PHONE:return oee;case m.CollectionSchemaType.FILE:return GZ;case m.CollectionSchemaType.FORMULA:return eee;case m.CollectionSchemaType.RELATION:return Qee;case m.CollectionSchemaType.ROLLUP:return tte;default:return fB}},w0=F.memo(e=>{const{recordId:t,groupProperty:n,groupValue:s,tableCellWrap:a=!1,properties:o,onClick:i,settingIcon:l}=e,{viewId:c,viewType:u,relationEditor:d=!1,embed:f}=Te(),h=QY(),p=F.useRef(null),g=u===m.CollectionViewType.TIMELINE,{illegal:_}=it(t),x=Ve(t,!!f),y=gt();return r.jsx(ln,{id:t,blockRef:p,"data-block-id":t,groupValue:s,viewId:c,className:B("group flex w-full min-w-max print:w-fit border-b",d&&"hover:bg-black_006 cursor-pointer pl-2"),style:{minHeight:si},onClick:b=>i==null?void 0:i(t,b),children:r.jsxs(uB.Provider,{value:{illegal:_,pageId:y,readonly:x||d},children:[l,a?r.jsx(r.Fragment,{children:o.map(b=>{const E=b!=null&&b.width?Math.max(lc,b.width):Eo;return r.jsx(yN,{style:{width:E},site:Me.CELL,recordId:t,propertyId:b.property,groupProperty:n,groupValue:s},b.property)})}):r.jsx(o2,{direction:"horizontal",bufferSize:1,scrollRef:h,count:o.length,getItemSize:b=>{const E=o[b];return E!=null&&E.width?Math.max(lc,E.width):Eo},getItemKey:b=>{var E,w;return(w=(E=o[b])==null?void 0:E.property)!=null?w:""},renderItem:b=>{const E=o[b];if(!E)return;const w=E.width?Math.max(lc,E.width):Eo;return r.jsx(yN,{style:{width:w},site:Me.CELL,recordId:t,propertyId:E.property,groupProperty:n,groupValue:s,isLastCell:b===o.length-1},E.property)}}),!g&&r.jsx("div",{className:"flex-1 flex-shrink-0 print:hidden",children:r.jsx("div",{className:"w-12"})})]})})}),rte=({groupName:e})=>{const{readonly:t,managerReadonly:n,collectionId:s,viewId:a,relationEditor:o,isLocked:i}=Te(),l=ih(),c=()=>{if(t||n||i)return;ce.event("bitable_property_create",{from_scene:"view"});const u=l({collectionId:s,viewId:a});u&&Ye({$newTableProperty:{propertyId:u,from:qn.TABLE_HEADER,groupInfo:TF(a,e)}})};return r.jsx("div",{className:"flex-1 print:hidden",children:r.jsx("button",{disabled:t,onClick:c,style:{height:si},className:B("flex flex-1 flex-shrink-0 items-center duration-150 select-none w-12 min-w-full",{"animate-hover rounded-none":!t}),children:t||n||o||i?null:r.jsx(H,{size:"middle",name:"MIcAddNew",className:"text-grey3 w-12"})})})},ate=(e,t)=>{const n=F.useCallback((a,o)=>{var g,_;const{collectionViews:i}=le(),l=i[e];if(!l)return;const c=l.type===m.CollectionViewType.TIMELINE,u=c?(g=l.format.timelineTableProperties)!=null?g:[]:(_=l.format.tableProperties)!=null?_:[],d=u.findIndex(x=>x.property===t),f=u[d],h=[...u];h[d]={...f,width:a};const p={};c?p.timelineTableProperties=h:p.tableProperties=h,o?Kn(e,{format:p},!0):yt(e,p)},[t,e]),s=F.useMemo(()=>$n(a=>{n(a,!1)},300),[n]);return F.useCallback(a=>{n(a,!0),s(a)},[s,n])};function Uo({className:e,dropdownClassName:t,value:n,placeholder:s,options:a,onChange:o,readonly:i,enableSearch:l,SelectView:c=Xm}){var d;const u=a.find(f=>f.value===n);return r.jsx(c,{className:e,value:n,icon:u==null?void 0:u.icon,title:(d=u==null?void 0:u.shortTitle)!=null?d:u==null?void 0:u.title,placeholder:s,onChange:o,readonly:i,Dropdown:ote,dropdownProps:{className:t,defaultValue:n,options:a,enableSearch:l}})}function ote({className:e,defaultValue:t,options:n,enableSearch:s,onChange:a,onCloseModal:o}){const[i,l]=F.useState(""),c=i.trim().toLowerCase(),u=n.filter(d=>c?d.title.toLowerCase().includes(c):!0).map(d=>({type:$.OPERATION,data:d}));return r.jsxs("div",{className:B("next-modal py-2",e),children:[s&&r.jsx(xt,{delayFocus:50,autoFocus:!0,className:"mx-[10px] mt-[2px] mb-[6px] h-8",value:c,onChange:d=>{l(d)}}),r.jsx(ze,{className:"max-h-[50vh] overflow-y-auto",items:u,defaultActiveIndex:u.findIndex(d=>d.data.value===t),onItemClick:d=>{a==null||a(d.data.value),o()}})]})}const ite="一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),lte="日_一_二_三_四_五_六".split("_"),cte="星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),kh=(e,t)=>e.concat(" ",t),ute=({onPreviousClick:e,onNextClick:t})=>r.jsxs("div",{className:"absolute right-4 flex justify-between top-5",children:[r.jsx(Fe,{className:"mr-2 rounded-sm animate-hover",children:r.jsx(H,{name:"IcArrowDateBack",size:"middle",onClick:()=>e()})}),r.jsx(Fe,{className:"rounded-sm animate-hover",children:r.jsx(H,{name:"IcArrowDateNext",size:"middle",onClick:()=>t()})})]}),dte=({date:e})=>r.jsx("div",{className:"table-caption mt-[10px] h-10",children:r.jsx("span",{className:"flex items-center h-full text-black text-t2-bold",children:he(e).format("YYYY年MM月")})}),ZB=({closeDatePicker:e,selectRangeDate:t=!1,includeTime:n=!0,showTimeSwitch:s=!0,...a})=>{const o=Vw(),i=F.useRef(),l=F.useRef(),c=F.useRef(),u=F.useRef(),d=F.useRef(),f=F.useRef(),h=F.useRef(),p=F.useRef(),[g,_]=F.useState(!1),[x,y]=F.useState(!1),[b,E]=F.useState(a.date),[w,k]=F.useState({startDate:he(b.from).format(Ct),startTime:he(b.from).format(s2),validStartDate:!0,validStartTime:!0}),[C,T]=F.useState({startDate:b.to?he(b.to).format(Ct):"",startTime:b.to?he(b.to).format(s2):"",validStartDate:!0,validStartTime:!0}),[v,I]=F.useState(n),j=F.useCallback(V=>{k(W=>({...W,...V}))},[]),D=F.useCallback(V=>T(W=>({...W,...V})),[]);bm(()=>{var V;b.to&&((V=a.onChange)==null||V.call(a,b,v))},[b],{wait:300}),F.useEffect(()=>{const V=setTimeout(()=>{clearTimeout(V),h.current.focus()})},[]),F.useEffect(()=>{const V=W=>{if(be("enter")(W)){const z=$2(w.startDate),Q=Mv(w.startTime);z&&Q&&(e==null||e())}};return document.addEventListener("keydown",V,!0),()=>{document.removeEventListener("keydown",V,!0)}},[w.startDate,w.startTime,e]);const S=V=>{var z;const W={from:he(kh(he(b.from).format(Ct),"12:00"),us).toDate(),to:(z=b.to)!=null?z:he(kh(he(b.to).format(Ct),"12:00"),us).toDate()};E(W),j({startTime:"12:00",validStartTime:!0}),D({startTime:"12:00",validStartTime:!0}),I(V)},R=F.useCallback((V,W,z)=>{z.stopPropagation(),V=new Date(V);const Q=A(b.from,b.to,V);V.setHours(v?12:0,0,0,0);const Z=he(V).format(Ct);Q?(E({from:V}),j({startDate:Z,startTime:v?"12:00":"00:00",validStartDate:!0,validStartTime:!0})):(V.setHours(23,59,0,0),E(te=>({...te,to:V})),D({startDate:Z,startTime:v?"12:00":"00:00",validStartDate:!0,validStartTime:!0}))},[b.from,b.to,v,j,D]);F.useEffect(()=>{const V=[];return w.validStartDate||V.push(Ql(i.current,c.current,{placement:"left",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),C.validStartDate||V.push(Ql(l.current,u.current,{placement:"left",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),w.validStartTime||V.push(Ql(i.current,d.current,{placement:"right",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),C.validStartTime||V.push(Ql(l.current,f.current,{placement:"right",modifiers:[{name:"offset",options:{offset:[0,6]}}]})),()=>{V.forEach(W=>W.destroy())}},[w.validStartDate,w.validStartTime,C.validStartDate,C.validStartTime]);const A=(V,W,z)=>{const Q=V&&_8.DateUtils.isDayBefore(z,V);return!V||Q||V&&W},L=(V,W)=>{const z=$2(V?w.startDate:C.startDate);if(W&&(V?j({validStartDate:!!z}):D({validStartDate:!!z})),z){V?j({startDate:z}):D({startDate:z});const Q=new Date(kh(z,V?w.startTime:C.startTime));E(Z=>V?{...Z,from:Q}:{...Z,to:Q})}},P=(V,W)=>{const z=Mv(V?w.startTime:C.startTime);W||(V?j({validStartTime:z}):D({validStartTime:z})),z&&E(V?Q=>({...Q,from:he(kh(w.startDate,w.startTime),us).toDate()}):Q=>({...Q,to:he(kh(C.startDate,C.startTime),us).toDate()}))},M=!w.validStartDate||!w.validStartTime,U=!C.validStartDate||!C.validStartTime;return r.jsxs("div",{className:B("w-[282px] bg-white2 pt-[10px] pb-[5px]",{"next-modal":!a.noShadow}),children:[r.jsxs("div",{className:"flex flex-col px-[10px]",children:[r.jsxs("div",{ref:i,className:B("flex bg-grey9 rounded-sm py-1.5 h-8 border border-transparent",{"input-error":M,"input-focus":g&&!M}),children:[r.jsx(xt,{inputRef:h,showBorder:!1,className:`border-none ${t?"w-1/2":"w-full"}`,style:{backgroundColor:"transparent"},onChange:V=>j({startDate:V}),value:w.startDate,onFocus:()=>_(!0),onEnter:()=>{L(!0,!0)},onBlur:()=>{_(!1),L(!0,!1)}}),v&&r.jsx(xt,{showBorder:!1,className:"w-1/2 px-3 rounded-none",style:{borderLeft:"1px solid var(--grey6)",backgroundColor:"transparent"},onChange:V=>j({startTime:V}),onFocus:()=>_(!0),onEnter:()=>{P(!0,!0)},onBlur:()=>{_(!1),P(!0,!1)},value:w.startTime})]}),!w.validStartDate&&r.jsx("div",{ref:c,className:"px-2 py-1 text-white1 bg-black/70 rounded-sm text-t4",children:r.jsx("span",{children:"无效日期"})}),!w.validStartTime&&r.jsx("div",{ref:d,className:"px-2 py-1 text-white1 bg-black/70 rounded-sm text-t4",children:r.jsx("span",{children:"无效时间"})}),r.jsxs("div",{ref:l,className:B("mt-1 flex bg-grey9 rounded-sm py-1.5 h-8 border border-transparent",{"input-error":U,"input-focus":x&&!U}),children:[r.jsx(xt,{inputRef:p,showBorder:!1,className:`border-none ${t?"w-1/2":"w-full"}`,style:{backgroundColor:"transparent"},onChange:V=>D({startDate:V}),value:C.startDate,onFocus:()=>y(!0),onEnter:()=>{L(!1,!0)},onBlur:()=>{y(!1),L(!1,!1)}}),v&&r.jsx(xt,{showBorder:!1,className:"w-1/2 px-3 border-none rounded-none border-grey6",style:{borderLeft:"1px solid var(--grey6)",backgroundColor:"transparent"},onChange:V=>D({startTime:V}),onFocus:()=>y(!0),onEnter:()=>{P(!1,!0)},onBlur:()=>{y(!1),P(!1,!1)},value:C.startTime})]}),!C.validStartDate&&r.jsx("div",{ref:u,className:"px-2 py-1 text-white1 bg-black/70 rounded-sm text-t4",children:r.jsx("span",{children:"无效日期"})}),!C.validStartTime&&r.jsx("div",{ref:f,className:"px-2 py-1 text-white1 bg-black/70 rounded-sm text-t4",children:r.jsx("span",{children:"无效时间"})})]}),r.jsx(UI,{className:"time-picker flex justify-center w-full",fixedWeeks:!0,selectedDays:[b.from,{from:b.from,to:b.to}],firstDayOfWeek:o===m.DaySetting.MON?1:0,navbarElement:ute,captionElement:dte,locale:"zh-cn",month:b.from,months:ite,onDayClick:R,weekdaysShort:lte,weekdaysLong:cte}),s&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-[252px] h-px bg-grey6 my-1 mx-[15px] mt-3"}),r.jsx("div",{children:r.jsxs("div",{className:"flex items-center justify-between h-10 px-4",children:[r.jsx("span",{className:"text-t2",children:"时间点"}),r.jsx(wn,{open:v,onSwitch:S})]})})]})]})},fte=({onChange:e,propertyId:t,path:n})=>{var v,I;const{collectionId:s,viewId:a}=Te(),o=F.useRef(null),[i,l]=F.useState(""),{propertySchema:c,targetPropertySchema:u}=qa(s,t),d=(c==null?void 0:c.type)===m.CollectionSchemaType.RELATION?(v=c.collectionId)!=null?v:"":(I=u==null?void 0:u.collectionId)!=null?I:"",{resultList:f,onInputChange:h,firstTime:p,loadMore:g,hasMore:_,loading:x}=Sx({type:"collection",fileType:void 0,source:"relationMenu",parentId:d,canSearchWithEmpty:!0,getPerPage:()=>20});F.useEffect(()=>h(""),[h]);const y=ae(({blocks:j,collectionViews:D})=>{var P,M;const S=D[a],R=qp(S==null?void 0:S.format.filter,n);if(!((P=j[s])==null?void 0:P.data.schema)||!R)return[];const L=R==null?void 0:R.value;return(M=L==null?void 0:L.split(",").filter(U=>{var V;return j[U]&&((V=j[d])==null?void 0:V.subNodes.includes(U))}))!=null?M:[]}),b=F.useMemo(()=>f.map(j=>({type:$.SEARCH,data:{uuid:j.uuid,title:j.title||Ot(j.type),icon:j.data.icon,type:j.type,renderRight:()=>y.includes(j.uuid)?r.jsx(H,{name:"IcSelectedSpace",size:"middle"}):null}})),[y,f]);F.useEffect(()=>{const j=setTimeout(()=>{var D;clearTimeout(j),(D=o.current)==null||D.focus()},0);return()=>{clearTimeout(j)}},[y]);const E=j=>{const D=y.indexOf(j.data.uuid);D!==-1?y.splice(D,1):y.push(j.data.uuid),e==null||e(y.join(","))},w=j=>{const D=y.indexOf(j);D!==-1&&y.splice(D,1),e==null||e(y.join(","))},k=()=>{y.pop(),e==null||e(y.join(","))},C=j=>{be("Esc")(j)||!i&&be("Backspace")(j)&&k()},T=()=>{e==null||e(""),h(""),l("")};return d?r.jsxs("div",{className:"relative overflow-hidden next-modal w-60",children:[r.jsxs("div",{className:"relative m-2 border-2 border-black rounded p-[5px] flex justify-between items-start min-h-[32px]",children:[r.jsxs("div",{className:"flex flex-wrap w-[190px] overflow-hidden",children:[y.map(j=>r.jsxs("div",{className:"inline-flex items-center text-t4 ",children:[r.jsx(Aa,{uuid:j,className:"p-0 leading-[22px] my-px"}),r.jsx("button",{className:"opacity-80 flex-shrink-0 w-5 h-5 inline-block",onClick:()=>w(j),children:r.jsx(H,{name:"IcToastClose",className:"w-full h-full",size:"auto"})})]},j)),r.jsx(oo,{ref:o,autoFocus:!0,singleLine:!0,placeholder:"搜索记录",fontClassName:"leading-5 text-[14px] whitespace-nowrap",className:"w-full placeholder:text-grey4",boxClassName:"flex-1 flex-shrink-0 min-w-[120px]",value:i,onKeyDown:C,onChange:j=>{const{value:D}=j.target;h(D),l(D)}})]}),r.jsx(H,{size:"middle",name:"IcUploadCancel",onClick:T,className:"text-grey4 cursor-pointer animate-hover"})]}),r.jsx(ze,{items:b,className:"relative h-60",hasMore:_,loadMore:g,scrollContainerStyle:{top:"0px"},onItemClick:E,loadingView:x&&r.jsx(Ck,{}),customFooter:r.jsxs(r.Fragment,{children:[x&&_&&r.jsxs("div",{className:"relative flex flex-row items-center justify-center h-10",children:[r.jsx(hs,{size:"middle"}),r.jsx("div",{className:"flex items-center ml-2 text-center text-t2 text-grey4",children:"正在加载..."})]}),!p&&!x&&b.length===0&&r.jsx("div",{className:"relative flex justify-center items-center h-10 text-t2 text-grey4",children:"没有找到相关结果"})]})})]}):null},Jg=({isFromViewSetting:e})=>{var E;const{viewId:t,collectionId:n,isLocked:s,managerReadonly:a}=Te(),o=ps(t),i=(E=ae(({blocks:w})=>{const k=w[n];return k==null?void 0:k.data.schema}))!=null?E:{},l=ae(({collectionViews:w})=>{const k=w[t];return k==null?void 0:k.format.filter}),c=me(),u=Object.keys(i)[0];if(!o)return null;const d=w=>{var j,D,S,R;if(s||!u)return;ce.event("bitable_view_filter_manage",{manage_type:"create"});const k=(j=le().collectionViews)==null?void 0:j[t];if(!k)return;let C;if(k.format.filter?C=da(k.format.filter):C={type:"group",filters:[],operator:"and"},!C)return;C.filters.length===0&&(C.disable=!1);const T=mm(n,u),v={type:"filter",property:u,propertyType:(D=i[u])==null?void 0:D.type,operator:(R=(S=T[0])==null?void 0:S.value)!=null?R:"isNotEmpty",value:""},I=w!=null&&w.group?{type:"group",operator:"and",filters:[v]}:v;C.filters.push(I),C=g0(C,i),yt(t,{filter:C},a)},f=()=>{d()},h=()=>{d({group:!0})},p=w=>{var C;const k=(C=da(o.format.filter))!=null?C:{type:"group",filters:[],operator:"and"};k.operator=w,yt(t,{filter:k},a)},g=w=>{o.format.filter&&yt(t,{filter:{...o.format.filter,disable:w}},a)},_=()=>{g(!0)},x=()=>{g(!1)},y=qg(l,i),b=l&&l.filters.filter(w=>ci(w,i)).length>0;return r.jsxs("div",{className:B("min-w-[480px]",!e&&"rounded-sm next-modal-scroll"),children:[b&&r.jsxs("div",{className:"flex justify-between px-4 my-2",children:[r.jsxs("div",{className:"flex items-center text-t2",children:[r.jsx(H,{className:"mr-1",name:lo[o.type],size:"middle"}),r.jsxs("span",{className:"mr-2 font-medium text-t2",children:["筛选符合下方",r.jsx(nL,{className:"inline-flex font-medium !border-0",value:l.operator,onChange:w=>{p(w)}}),"条件的数据"]})]}),r.jsxs("div",{className:"flex items-center text-t2",children:[r.jsx("span",{className:"mr-1",children:y?r.jsx("span",{className:"mr-1 text-active_color",children:"已生效"}):r.jsx("span",{className:"mr-1",children:"未生效"})}),r.jsx(wn,{open:y,disabled:s,onSwitch:()=>{s||(y?(ce.event("bitable_view_filter_manage",{manage_type:"off"}),_()):(ce.event("bitable_view_filter_manage",{manage_type:"on"}),x()))}})]})]}),l&&r.jsx(tL,{path:[],...l}),r.jsxs("button",{className:B("flex items-center w-full h-10 px-4 py-2 animate-hover !rounded-t-none",b&&"border-t border-grey6",s&&"cursor-not-allowed"),disabled:!u,onClick:f,children:[r.jsx(H,{className:"mr-1",name:"MIcAddNew",size:"middle"}),r.jsx("span",{className:"text-t2 text-grey3",children:"创建筛选条件"}),!s&&r.jsx("span",{className:"inline-flex p-1 animate-hover",onClick:w=>{w.stopPropagation(),c.dropdown({popcorn:w.currentTarget.parentElement,content:eL,contentProps:{onCreateFilter:f,onCreateFilterGroup:h},placement:"bottom-start",offset:[-1,0]})},children:r.jsx(H,{name:"IcArrow",className:"text-grey3",size:"tiny"})})]})]})},eL=({onCreateFilter:e,onCreateFilterGroup:t,onCloseModal:n})=>r.jsxs("div",{className:"next-modal p-2",children:[r.jsxs("div",{className:"h-9 px-2 flex items-center animate-hover",onClick:()=>{e==null||e(),n()},children:[r.jsx(H,{name:"IcBtnNew",className:"mr-2",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建筛选条件"})]}),r.jsxs("div",{className:"h-9 px-2 flex items-center animate-hover",onClick:()=>{t==null||t(),n()},children:[r.jsx(H,{name:"IcAddFilterGroup",className:"mr-2",size:"middle"}),r.jsx("span",{className:"text-t2",children:"创建筛选条件组"})]})]}),tL=({path:e,operator:t,filters:n})=>{var w;const{viewId:s,collectionId:a,isLocked:o,managerReadonly:i}=Te(),l=(w=ae(({blocks:k})=>{var C;return(C=k[a])==null?void 0:C.data.schema}))!=null?w:{},c=me(),u=(k,C)=>C.length===0?k:qp(k,C),d=kte(n,l),f=Object.keys(l)[0],h=k=>{var R,A,L,P;if(o||!f)return;ce.event("bitable_view_filter_manage",{manage_type:"create"});let C=f;if(d.length>0){const M=d[d.length-1];(M==null?void 0:M.type)==="filter"&&ci(M,l)&&(C=M.property)}const T=mm(a,C),v={type:"filter",property:C,propertyType:(R=l[C])==null?void 0:R.type,operator:(L=(A=T[0])==null?void 0:A.value)!=null?L:"isNotEmpty",value:""},I=k!=null&&k.group?{type:"group",operator:"and",filters:[v]}:v,j=(P=le().collectionViews)==null?void 0:P[s];if(!j)return;const D=da(j.format.filter),S=u(D,e);S==null||S.filters.push(I),D&&yt(s,{filter:g0(D,l)},i)},p=()=>{h()},g=()=>{h({group:!0})},_=k=>{var I;const C=(I=le().collectionViews)==null?void 0:I[s];if(!C)return;const T=da(C.format.filter),v=u(T,e);v&&v.filters.splice(k,1),T&&yt(s,{filter:g0(T,l)},i)},x=(k,C,T)=>{var D;const v=(D=le().collectionViews)==null?void 0:D[s];if(!v)return;const I=da(v.format.filter),j=u(I,[...e,"filters",k]);j&&(g1(a,j,C,T),yt(s,{filter:I},i))},y=k=>{var I;const C=(I=le().collectionViews)==null?void 0:I[s];if(!C)return;const T=da(C.format.filter),v=u(T,e);v.operator=k,yt(s,{filter:T},i)},b=r.jsx(vr,{className:"flex-1 min-w-0",items:d,onlyHandleDraggable:!0,renderItemContent:({item:k})=>{const C=e.slice(0);if(C.push("filters",k.id),k.type==="group")return r.jsxs("div",{className:"flex items-start my-2",children:[r.jsx(tL,{...k,path:C}),r.jsx("div",{className:"w-9",children:!o&&r.jsx(H,{size:"large",className:"ml-3 mt-1 cursor-pointer text-grey3 hover:text-grey1",name:"IcToastClose",onClick:()=>{const A=Number(k.id);_(A),ce.event("bitable_view_filter_manage",{manage_type:"delete"})}})})]});const T=l[k.property],{type:v,aggregation:I}=T!=null?T:{},j=mm(a,k.property),D=k.operator==="isEmpty"||k.operator==="isNotEmpty",S=j.map(A=>A.value).includes(k.operator)&&!D,R=v===m.CollectionSchemaType.ROLLUP&&so(I);return r.jsxs("div",{className:"flex items-center my-2 text-t2",children:[r.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[r.jsx(mte,{className:"w-[120px]",value:k.property,onChange:A=>{const L=Number(k.id);x(L,"property",A)}}),R&&r.jsx(hte,{className:"ml-2 w-[72px]",property:k.property,value:k.mode,isShowUniqueValue:I===m.AggregationAction.SHOW_UNIQUE,onChange:A=>{const L=Number(k.id);x(L,"mode",A)}}),r.jsx(sL,{className:B("w-[76px]",S?"mx-2":"ml-2"),property:k.property,value:k.operator,onChange:A=>{const L=Number(k.id);x(L,"operator",A)}}),S&&r.jsx(rL,{className:"w-[160px]",property:k.property,operator:k.operator,value:k.value,path:C,onChange:A=>{const L=Number(k.id);x(L,"value",A)},onEffectiveChange:A=>{const L=Number(k.id);x(L,"__effectiveValue",A)}})]}),!o&&r.jsx(H,{size:"large",className:"ml-3 cursor-pointer text-grey3 hover:text-grey1",name:"IcToastClose",onClick:()=>{const A=Number(k.id);_(A),ce.event("bitable_view_filter_manage",{manage_type:"delete"})}})]})}}),E=Math.ceil(e.length/2);return E===0?d.length===0?null:r.jsx("div",{className:"px-4 mb-3.5",children:b}):r.jsxs("div",{className:B("flex-1 px-3.5 pt-1.5 rounded-md border border-grey5",gn({backgroundColor:"rgba(0, 0, 0, 0.02)"})),children:[r.jsx("div",{children:r.jsxs("span",{className:"mr-2 font-medium text-t2",children:["筛选符合下方",r.jsx(nL,{className:"inline-flex font-medium !border-0",value:t,onChange:k=>{y(k)}}),"条件的数据"]})}),b,r.jsxs("div",{className:B("mt-1 mx-[-14px] h-9 px-3 flex items-center animate-hover",o&&"cursor-not-allowed"),onClick:p,children:[r.jsx(H,{className:"mr-1",name:"MIcAddNew",size:"middle"}),r.jsx("span",{className:"text-t2 text-grey3",children:"创建筛选条件"}),E<2&&!o&&r.jsx("span",{className:"inline-flex p-1 animate-hover",onClick:k=>{k.stopPropagation(),c.dropdown({popcorn:k.currentTarget.parentElement,content:eL,contentProps:{onCreateFilter:p,onCreateFilterGroup:g},placement:"bottom-start",offset:[-1,0]})},children:r.jsx(H,{name:"IcArrow",className:"text-grey3",size:"tiny"})})]})]})},mte=({className:e,value:t,onChange:n})=>{var i;const{collectionId:s,isLocked:a}=Te(),o=(i=ae(({blocks:l})=>{var c;return(c=l[s])==null?void 0:c.data.schema}))!=null?i:{};return r.jsx(Uo,{readonly:a,className:e,dropdownClassName:"max-w-[260px]",value:t,onChange:n,options:Object.keys(o).map(l=>{var u,d,f;const c=(u=o[l])==null?void 0:u.type;return{value:l,title:(f=(d=o[l])==null?void 0:d.name)!=null?f:"",icon:c&&an[c]}})})},nL=({className:e,value:t,onChange:n})=>{const{isLocked:s}=Te();return r.jsx(Uo,{readonly:s,className:e,value:t,onChange:n,options:[{value:"and",title:"全部"},{value:"or",title:"任意"}]})},hte=({isShowUniqueValue:e,className:t,value:n,onChange:s})=>{const{isLocked:a}=Te(),o=e?[{value:"any",title:"任意"}]:[{value:"any",title:"任意"},{value:"every",title:"全部"},{value:"none",title:"无"}];return r.jsx(Uo,{readonly:a,className:t,value:e?"any":n,onChange:s,options:o})},sL=({className:e,property:t,value:n,onChange:s})=>{const{collectionId:a,isLocked:o}=Te(),i=mm(a,t);return r.jsx(Uo,{readonly:o,className:e,value:n,onChange:s,options:i})},pte=(e,t)=>{var n,s;if(t===m.CollectionSchemaType.NUMBER){let a=parseFloat(e);return Number.isNaN(a)&&(a=parseFloat((s=(n=e.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:n[0])!=null?s:"")),isNaN(a)?"":`${a}`}else if(t===m.CollectionSchemaType.CREATED_AT||t===m.CollectionSchemaType.UPDATED_AT||t===m.CollectionSchemaType.DATE){const a=he(e,Ct);return a.isValid()?a.format(Ct):""}else if(t===m.CollectionSchemaType.CHECKBOX)return e.toUpperCase()==="YES"?"YES":e.toUpperCase()==="NO"?"NO":"";return e},g1=(e,t,n,s)=>{var c,u,d,f,h,p,g,_,x,y,b,E,w;const a=(d=(u=(c=K.blocks[e])==null?void 0:c.data)==null?void 0:u.schema)!=null?d:{};n==="property"&&(((k,C)=>(k===m.CollectionSchemaType.NUMBER||k===m.CollectionSchemaType.TEXT||k===m.CollectionSchemaType.TITLE)&&(C===m.CollectionSchemaType.TEXT||C===m.CollectionSchemaType.TITLE||C===m.CollectionSchemaType.NUMBER))((h=(f=a[t.property])==null?void 0:f.type)!=null?h:m.CollectionSchemaType.TEXT,(g=(p=a[s])==null?void 0:p.type)!=null?g:m.CollectionSchemaType.TEXT)?t.value=pte(t.value,(x=(_=a[s])==null?void 0:_.type)!=null?x:m.CollectionSchemaType.TEXT):t.value="",((y=a[s])==null?void 0:y.type)===m.CollectionSchemaType.ROLLUP?t.mode="any":t.mode=void 0),n==="operator"&&t.operator!==s&&(t.operator==="in"||s==="in")&&he(t.value,Ct).isValid()&&(t.value=""),t[n]=s;const i=(E=(b=a[t.property])==null?void 0:b.type)!=null?E:m.CollectionSchemaType.TEXT;t.propertyType=i;const l=mm(e,t.property);l.map(k=>k.value).includes(t.operator)||(t.operator=(w=l[0])==null?void 0:w.value,t.value="")},rL=({className:e,property:t,operator:n,value:s,path:a,onChange:o,onEffectiveChange:i})=>{var D;const{collectionId:l,isLocked:c}=Te(),{propertySchema:u,relationPropertySchema:d,targetPropertySchema:f}=qa(l,t),{type:h,aggregation:p,targetProperty:g=""}=u!=null?u:{},_=(D=d==null?void 0:d.collectionId)!=null?D:"",x=Ln(l),y=Ln(_),b=mm(l,t),E=n==="isEmpty"||n==="isNotEmpty",w=b.map(S=>S.value).includes(n)&&!E,k=F.useRef();F.useEffect(()=>()=>{clearTimeout(k.current)},[]);const C=S=>{o(S),clearTimeout(k.current),k.current=window.setTimeout(()=>{i==null||i(S)},500)};let T=h;const v=T===m.CollectionSchemaType.ROLLUP,I=T===m.CollectionSchemaType.FORMULA;if(v){const S=f==null?void 0:f.type;so(p)?S===m.CollectionSchemaType.FORMULA?T=y.getTypeAsCollectionSchemaType(g):T=S:ai(p)?T=m.CollectionSchemaType.DATE:T=m.CollectionSchemaType.NUMBER}else I&&(T=x.getTypeAsCollectionSchemaType(t));const j=B(e,"h-8");if(!w)return null;switch(T!=null?T:m.CollectionSchemaType.TEXT){case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.NUMBER:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return r.jsx(xt,{readonly:c,className:B(j,"border-grey5"),value:s,onChange:C});case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:return n==="in"?r.jsx(xte,{className:j,value:s,onChange:C}):r.jsx(Fte,{className:j,value:s,onChange:C});case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:return r.jsx(Ete,{className:j,property:t,value:s,onChange:C});case m.CollectionSchemaType.CHECKBOX:case m.CollectionSchemaType.FILE:return null;case m.CollectionSchemaType.PERSON:case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:return r.jsx(SQ,{className:j,value:s,onChange:C});case m.CollectionSchemaType.RELATION:return r.jsx(gte,{propertyId:t,className:j,value:s,path:a,onChange:C})}},gte=({className:e,value:t,path:n,onChange:s,propertyId:a})=>{var h,p,g,_;const{isLocked:o,collectionId:i}=Te(),{propertySchema:l,targetPropertySchema:c}=qa(i,a),u=(l==null?void 0:l.type)===m.CollectionSchemaType.RELATION?(h=l.collectionId)!=null?h:"":(p=c==null?void 0:c.collectionId)!=null?p:"",d=(_=(g=le().blocks[u!=null?u:""])==null?void 0:g.subNodes)!=null?_:[],f=r.jsx("div",{className:"text-t4",children:t==null?void 0:t.split(",").map(x=>x&&d.includes(x)?r.jsx(Aa,{uuid:x},x):null)});return r.jsx(Xm,{readonly:o,className:e,value:t,content:f,onChange:s,Dropdown:fte,dropdownProps:{propertyId:a,path:n}})},_te=e=>{if(!e)return{title:"",shortTitle:void 0};const t=e.split(","),n=he(t[0],Ct),s=he(t[1],Ct);return{title:`${n.format(Ct)} → ${s.format(Ct)}`,shortTitle:`${n.format(xT)} → ${s.format(xT)}`}},aL=(e,t)=>{if(t==="range"){const s=li[e];if(s!=null)return!s.day;const a=e.split(",");return he(a[0],Ct).isValid()&&he(a[1],Ct).isValid()}const n=li[e];return n!=null?n.day:he(e,Ct).isValid()},xte=({className:e,value:t,onChange:n})=>{const{isLocked:s}=Te(),a=aL(t,"range")?t:"",{title:o,shortTitle:i}=_te(a),l=Hu(li,a)?a:"exact";return r.jsxs(r.Fragment,{children:[r.jsx(Uo,{readonly:s,value:l,className:"mr-2",options:[{title:"具体时间",value:"exact"},...KI(li).filter(c=>!c[1].day).map(([c,u])=>({title:u.title,value:c}))],onChange:c=>{n(c==="exact"?"":c)}}),l==="exact"&&r.jsx(Xm,{readonly:s,className:e,value:a,title:o,shortTitle:i,onChange:c=>{n(c)},Dropdown:yte,dropdownProps:{}})]})},Fte=({className:e,value:t,onChange:n})=>{const{isLocked:s}=Te(),a=aL(t,"day")?t:"",o=Hu(li,a)?a:"exact";return r.jsxs(r.Fragment,{children:[r.jsx(Uo,{readonly:s,value:o,className:"mr-2",options:[{title:"具体时间",value:"exact"},...KI(li).filter(i=>i[1].day).map(([i,l])=>({title:l.title,value:i}))],onChange:i=>{n(i==="exact"?"":i)}}),o==="exact"&&r.jsx(Xm,{readonly:s,className:e,value:a,title:a,onChange:n,Dropdown:bte,dropdownProps:{}})]})},yte=({value:e,onChange:t,onCloseModal:n})=>{const s=e?e.split(","):[],a=he(s[0],Ct),o=he(s[1],Ct);return r.jsx(ZB,{includeTime:!1,showTimeSwitch:!1,closeDatePicker:n,date:{from:a.isValid()?a.toDate():new Date,to:o.isValid()?o.toDate():new Date},onChange:({from:i,to:l})=>{t==null||t(`${he(i).format(Ct)},${he(l).format(Ct)}`)},onClear:()=>{t==null||t("")}})},bte=({value:e,onChange:t,onCloseModal:n})=>{const s=he(e,Ct);return r.jsx(_F,{uiOption:{hasSwitchTimeOption:!1,hasFormatSetting:!1},closeDatePicker:n,dateInfo:{from:s.isValid()?s.toDate():new Date,includeTime:!1},onChange:({from:a})=>{t==null||t(he(a).format(Ct))},onClear:()=>{t==null||t("")}})},Ete=({className:e,property:t,value:n,onChange:s})=>{const{collectionId:a,isLocked:o}=Te(),i=ae(({blocks:c})=>{var f,h,p,g,_,x,y;const u=(f=c[a])==null?void 0:f.data.schema,d=u==null?void 0:u[t];if(!u)return[];if((d==null?void 0:d.type)===m.CollectionSchemaType.ROLLUP){const{targetProperty:b="",relationProperty:E=""}=d,w=(h=u[E])==null?void 0:h.collectionId;return(x=(_=(g=(p=c[w!=null?w:""])==null?void 0:p.data.schema)==null?void 0:g[b])==null?void 0:_.options)!=null?x:[]}return(y=d==null?void 0:d.options)!=null?y:[]}),l=i.find(c=>c.id===n);return r.jsx(Xm,{readonly:o,className:e,value:n,content:l&&r.jsx(Tl,{color:l.color,value:l.value}),onChange:s,Dropdown:wte,dropdownProps:{options:i}})},wte=({options:e,onCloseModal:t,onChange:n})=>{const[s,a]=F.useState(""),o=e.filter(i=>i.value.includes(s)).map(i=>({type:$.OPERATION,data:{content:r.jsx(Tl,{color:i.color,value:i.value}),onClick:()=>{n==null||n(i.id),t()}}}));return r.jsx("div",{className:"max-h-[80vh] w-[190px] overflow-y-auto next-modal py-2",children:r.jsx(ze,{customHeader:r.jsx(xt,{autoFocus:!0,className:"h-8 mx-2.5 mb-2.5",placeholder:"搜索选项",onChange:i=>a(i)}),items:o})})},oL=(e,t)=>{var n;return t.type!=="filter"||t.propertyType&&((n=e[t.property])==null?void 0:n.type)===t.propertyType||["isEmpty","isNotEmpty"].includes(t.operator)?t:{...t,value:""}},kte=(e,t)=>e.map((n,s)=>({...n,id:`${s}`})).filter(n=>!!ci(n,t)).map(n=>oL(t,n)),Wf="00000000-0000-0000-0000-000000000000",Tp=(e,t,n,s)=>{var u,d,f;const a=le().collectionViews[t],o=(d=(u=le().blocks[e])==null?void 0:u.data.schema)!=null?d:{},i=((f=a==null?void 0:a.format.formProperties)!=null?f:[]).map(h=>h.property),l=k0(o,i,s),c=k0(o,n,l);if(c.length<l.length)return c},k0=(e,t,n)=>n.filter(s=>{const a=t.indexOf(s.condition.property),o=t.indexOf(s.gotoProperty);return a===-1||!e[s.condition.property]||s.gotoProperty!==Wf&&(o===-1||!e[s.gotoProperty]||o<=a)?!1:ci(s.condition,e)}).map(s=>({condition:oL(e,s.condition),gotoProperty:s.gotoProperty})),iL=(e,t)=>{const n=(s,a)=>{var c;const o=(c=le().collectionViews)==null?void 0:c[e];if(!o)return;const i=da(o.format.formProperties),l=i==null?void 0:i.findIndex(u=>u.property===t);if(l!==void 0&&l!==-1&&i){const u=i[l];if(u){const d={...u,[s]:a};i[l]=d}}yt(e,{formProperties:i})};return F.useCallback(n,[t,e])},Cte=()=>{const e=ke(),{getState:t}=Kr();return F.useCallback((n,s,a,o=!1)=>{var x,y,b,E,w;const{blocks:i,collectionViews:l}=t(),c=i[n];if(!c)return;const u=(x=c.data.schema)==null?void 0:x[a];if(!u)return;const d=qe(),{visibleProperty:f,inVisibleProperty:h}=Xg(d);let p={};if(s){const k=l[s];if(!k)return;const C=k.type===m.CollectionViewType.FORM,{properties:T=[],timelineTableProperties:v=[]}=Zt(k);let I=T;o&&(I=v),C&&k.format.formProperties&&(I=k.format.formProperties);const j=I.findIndex(A=>A.property===a),D=[...I],S={property:d,visible:(b=(y=I[j])==null?void 0:y.visible)!=null?b:!0};j>-1?D.splice(j+1,0,S):D.push(S);const R=o?"timelineTableProperties":`${LB(k.type)}Properties`;p={...k.format},p[R]=D,vl.forEach(A=>{if(A===R)return;const L=p[A];L&&(A==="tableProperties"?p[A]=[...L,f]:p[A]=[...L,h])})}let g=[...(E=c.data.collectionPageProperties)!=null?E:[]];g.length===0&&(g=Object.keys((w=c.data.schema)!=null?w:{}).map(k=>({property:k,visible:!0})));const _=g.findIndex(({property:k})=>k===a);return g.splice(_+1,0,f),e(()=>{pe(c.uuid,{data:{collectionPageProperties:g,schema:{...c.data.schema,[d]:{...u,name:Ko(c.data.schema,"副本 ".concat(u.name))}}}}),s&&Kn(s,{format:p}),Ju(c.uuid,[d],s)}),d},[t,e])},Tte=()=>{const{getState:e}=Kr(),t=ke(),n=(s,a)=>{const{blocks:o,collectionViews:i}=e(),l=o[s];l&&t(()=>{var h,p,g,_;const c=(h=l.data.schema)!=null?h:{},u=c[a],d=new Set([a]);(u==null?void 0:u.type)===m.CollectionSchemaType.RELATION&&u.collectionId===s&&u.pairProperty&&((p=c[u.pairProperty])==null?void 0:p.pairProperty)===a&&d.add(u.pairProperty);const f={};Object.entries(c).forEach(([x,y])=>{d.has(x)||(f[x]=y)}),pe(s,{data:{schema:f,collectionPageProperties:(g=l.data.collectionPageProperties)==null?void 0:g.filter(({property:x})=>!d.has(x))}}),(_=l.views)==null||_.forEach(x=>{var w;const y=i[x];if(!y)return;const b=gl(y.format,vl);b.sorters=(w=y.format.sorters)==null?void 0:w.filter(k=>!d.has(k.property));const E=k=>k&&(k.filters=k.filters.filter(C=>{if(C.type==="filter")return!d.has(C.property);const T=E(C);return!!(T&&T.filters.length>0)}),k);b.filter=E(da(y.format.filter)),vl.forEach(k=>{const C=b[k];C&&(b[k]=C.filter(T=>!d.has(T.property)))}),Kn(x,{format:b})})})};return F.useCallback(n,[e,t])},lL=()=>{const{getState:e}=Kr(),t=ke(),n=(s,a,o,i,l=!1)=>{var c,u;if(a){const{collectionViews:d}=e(),f=d[a];if(!f)return;const{properties:h=[],timelineTableProperties:p=[],propertiesName:g}=Zt(f),_=(l?p:h).map(x=>x.property===o?{...x,visible:i}:x);t(()=>{const x={[l?"timelineTableProperties":g]:_};l&&(x.timelineShowTable=!!_.find(y=>y.visible)),Kn(a,{format:x})})}else{const{blocks:d}=e(),f=d[s];if(!f)return;let h=[...(c=f.data.collectionPageProperties)!=null?c:[]];h.length===0?h=Object.keys((u=f.data.schema)!=null?u:{}).map(p=>({property:p,visible:p===o?i:!0})):h=h.map(p=>p.property===o?{...p,visible:i}:p),t(()=>{pe(s,{data:{collectionPageProperties:h}})})}};return F.useCallback(n,[e,t])},ch=({isFromViewSetting:e})=>{var w,k;const{viewId:t,collectionId:n,isLocked:s,managerReadonly:a}=Te(),o=ps(t),i=(w=ae(({blocks:C})=>{const T=C[n];return T==null?void 0:T.data.schema}))!=null?w:{},l=(k=ae(({collectionViews:C})=>{const T=C[t];return T==null?void 0:T.format.sorters}))!=null?k:[],c=l.map(C=>({...C,id:C.property})),u=Object.keys(i).find(C=>l.every(T=>T.property!==C));if(!o)return null;const d=()=>{var T;if(s||!u)return;ce.event("bitable_view_sort_manage",{manage_type:"create"});const C=(T=Yl.cloneDeep(o.format.sorters))!=null?T:[];C.push({property:u,direction:"asc",disable:!1}),yt(t,{sorters:C},a)},f=C=>{yt(t,{sorters:C.map(T=>({property:T.property,direction:T.direction,disable:T.disable}))},a)},h=(C,T)=>{var j;const v=(j=Yl.cloneDeep(o.format.sorters))!=null?j:[],I=v==null?void 0:v.find(D=>D.property===C);I&&(I.property=T),yt(t,{sorters:v},a)},p=(C,T)=>{var j;const v=(j=Yl.cloneDeep(o.format.sorters))!=null?j:[],I=v==null?void 0:v.find(D=>D.property===C);I&&(I.direction=T),yt(t,{sorters:v},a)},g=C=>{var v;const T=(v=Yl.cloneDeep(o.format.sorters))!=null?v:[];yt(t,{sorters:T.filter(I=>I.property!==C)},a)},_=C=>{var v;const T=(v=Yl.cloneDeep(o.format.sorters))!=null?v:[];if(T)for(const I of T)I.disable=C;yt(t,{sorters:T},a)},x=()=>{ce.event("bitable_view_sort_manage",{manage_type:"on"}),_(!0)},y=()=>{ce.event("bitable_view_sort_manage",{manage_type:"off"}),_(!1)},b=l.some(C=>!C.disable),E=l.length>0;return r.jsxs("div",{className:B(e?"w-full":"rounded-sm next-modal-scroll w-[400px]"),children:[E&&r.jsxs("div",{className:"flex justify-between h-8 m-2 mx-4",children:[r.jsxs("div",{className:"flex items-center cursor-default text-t2",children:[r.jsx(H,{className:"mr-1",name:lo[o.type],size:"middle"}),r.jsx("span",{className:"mr-2 font-medium",children:"排序设置"})]}),r.jsxs("div",{className:"flex items-center text-t2",children:[r.jsx("span",{className:"mr-1",children:b?"已生效":"已停用"}),r.jsx(wn,{open:b,disabled:s,onSwitch:()=>{s||(b?x():y())}})]})]}),r.jsx(vr,{disabled:s,className:B(c.length>0&&"m-2"),items:c,renderItemContent:({item:C,renderDragHandle:T})=>r.jsxs("div",{className:"flex items-center h-10 px-2 text-t2",children:[T({className:"cursor-pointer flex items-center justify-center w-5 h-5 mr-1 text-grey4"}),r.jsxs("div",{className:"flex items-center flex-1",children:[r.jsx(vte,{className:"max-w-[200px]",value:C.property,onChange:v=>{h(C.property,v)}}),r.jsx(Nte,{className:"ml-2",value:C.direction,onChange:v=>{p(C.property,v)}})]}),!s&&r.jsx(H,{size:"large",className:"cursor-pointer text-grey3 hover:text-grey1",name:"IcToastClose",onClick:()=>{ce.event("bitable_view_sort_manage",{manage_type:"delete"}),g(C.property)}})]}),onChange:f}),r.jsxs("button",{className:B("flex items-center w-full h-10 p-2 animate-hover pl-4",E&&"border-t border-grey6",s&&"cursor-not-allowed"),disabled:!u,onClick:d,children:[r.jsx(H,{className:"mr-1",name:"MIcAddNew",size:"middle"}),r.jsx("span",{className:"text-t2 text-grey3",children:"创建排序条件"})]})]})},vte=({className:e,value:t,onChange:n})=>{var c,u;const{collectionId:s,viewId:a,isLocked:o}=Te(),i=(c=ae(({blocks:d})=>{var f;return(f=d[s])==null?void 0:f.data.schema}))!=null?c:{},l=(u=ae(({collectionViews:d})=>{const f=d[a];return f==null?void 0:f.format.sorters}))!=null?u:[];return r.jsx(Uo,{readonly:o,className:e,dropdownClassName:"max-w-[260px]",value:t,onChange:n,options:Object.keys(i).filter(d=>d===t||l.every(f=>f.property!==d)).map(d=>{var h,p,g;const f=(h=i[d])==null?void 0:h.type;return{value:d,title:(g=(p=i[d])==null?void 0:p.name)!=null?g:"",icon:f&&an[f]}})})},Nte=({className:e,value:t,onChange:n})=>{const{isLocked:s}=Te();return r.jsx(Uo,{readonly:s,className:e,value:t,onChange:n,options:[{value:"asc",title:"升序"},{value:"desc",title:"降序"}]})},Ite=({viewId:e,collectionId:t,propertyId:n,onClose:s})=>{var C,T;const a=Ve(t),{propertySchema:o}=qa(t,n),i=_a(),l=SC(),c=me(),u=(C=Tg(e))!=null?C:t,d=So(u),[f,h]=F.useState(""),p=F.useRef(null),g=F.useMemo(()=>{var I,j,D;const v=wr.map(S=>S.key);return(D=RC(v,(j=(I=o==null?void 0:o.options)==null?void 0:I.map(S=>S.color))!=null?j:[]))!=null?D:wr[0].key},[o==null?void 0:o.options]),_=()=>{var j;const v=qe(),I=f.replace(/,/g,"").trim();if(I){if((j=o==null?void 0:o.options)!=null&&j.find(D=>D.value===I)){c.warning({title:r.jsx(r.Fragment,{children:"此属性已存在同名的选项"}),noCancel:!0,confirm(){var D;(D=p.current)==null||D.focus()}});return}h(""),l(t,n,{id:v,value:I,color:g})}},x=v=>{if(!(d||a)){if(be("Esc")(v)){s==null||s();return}be("Enter")(v)&&_()}},y=F.useRef(),b=(v,I)=>{c.dropdown({popcorn:I.currentTarget,placement:"right",content({onCloseModal:j}){return r.jsx(GB,{option:v,collectionId:t,propertyId:n,closeModal:j,closeBeforeCallbackRef:y})},closeBeforeCallBack:()=>{var j;return(j=y.current)==null?void 0:j.call(y)},closeAfterCallBack(){var j;(j=p.current)==null||j.focus()}})},E=(v,I)=>{if(!(o!=null&&o.options))return;const j=o.options.findIndex(R=>R.id===v),D=o.options.findIndex(R=>R.id===I),S=qc(o.options,j,D);i(t,n,{options:S})},w=()=>{},k=a||d;return r.jsxs("div",{className:"next-modal-scroll max-h-80vh w-[240px] pt-1.5",children:[r.jsx(oo,{ref:p,autoFocus:!0,singleLine:!0,placeholder:"创建选项",fontClassName:gn({lineHeight:"24px",fontSize:14,whiteSpace:"nowrap"}),className:gn({width:"100%",selectors:{"&::placeholder":{color:"var(--grey4)"}}}),boxClassName:"min-w-[120px] max-w-full flex-grow-1 flex-shrink-0 p-2",value:f,onKeyDown:x,onChange:v=>h(v.target.value)}),r.jsx(Rr,{className:"my-1"}),r.jsx(zB,{options:(T=o==null?void 0:o.options)!=null?T:[],onSelect:()=>{},onMore:b,onSort:E,onFocus:w,readonly:k})]})},jte=e=>{var R,A,L,P,M,U,V,W,z,Q,Z;const{propertyId:t,onCloseModal:n}=e,{collectionId:s}=Te(),a=_e(s,["data"],["schema"]),{showAs:o={},numberFormat:i,type:l,aggregation:c}=(A=(R=a==null?void 0:a.data.schema)==null?void 0:R[t])!=null?A:{},[u,d]=F.useState((L=o==null?void 0:o.maxValue)!=null?L:5),[f,h]=F.useState((P=o==null?void 0:o.showNumber)!=null?P:!0),p=wr.map(te=>te.key),[g,_]=F.useState((U=(M=o==null?void 0:o.color)!=null?M:od(p))!=null?U:Pe.grey),[x,y]=F.useState((V=o.levelSymbol)!=null?V:"⭐️"),[b,E]=F.useState(o.type),w=_a(),k=me(),C=[{title:"默认"},{title:"进度条",type:m.NumberShowType.BAR,example:r.jsx(X2,{width:50,height:3,percent:.25,bgColor:Tf(g),progressColor:ql(g)})},{title:"环形图",type:m.NumberShowType.RING,example:r.jsx(J1,{bgColor:Tf(g),ringColor:ql(g),percent:.25,className:"border-grey7",ringColorClassName:"border-active_color"})},{title:"等级评分",type:m.NumberShowType.LEVEL,example:r.jsx(Q2,{totalScore:3,score:1.5})}],T=te=>{k.dropdown({className:"w-[240px] next-modal pb-2",popcorn:te.currentTarget,placement:"bottom-end",content:({onCloseModal:re})=>r.jsx(Ld,{onSelect:ne=>{_(ne),re()},hideHeader:!0,value:g,selectedIcon:r.jsx(H,{name:"IcSelectedSpace",className:"text-[18px] text-white"}),bgColorFn:ql})})},v=te=>{k.dropdown({popcorn:te.currentTarget,placement:"bottom-end",content:({onCloseModal:re})=>r.jsx(Dte,{onSelect:ne=>{y(ne),re()}})})},I=te=>{E(te),te===m.NumberShowType.BAR||te===m.NumberShowType.RING?D||d(100):d(5)},j=()=>{if(b===m.NumberShowType.LEVEL&&!/^([1-9]|10)$/.test(u.toString())||D&&!/^[1-9][0-9]*$/.test(u.toString()))return;const te=l===m.CollectionSchemaType.FORMULA?"prop_formula_style":l===m.CollectionSchemaType.ROLLUP?"prop_rollup_style":"prop_num_style";ce.event(te,{style_type:b===m.NumberShowType.LEVEL?"star":b||"default"}),w(s,t,{showAs:b?{type:b,maxValue:u,color:g,showNumber:f,levelSymbol:x}:void 0}),n==null||n()},D=b===m.NumberShowType.BAR||b===m.NumberShowType.RING;let S=!0;return D&&(i!=null&&i.includes("percent")&&(S=!1),l===m.CollectionSchemaType.ROLLUP&&zd(c)&&(S=!1)),r.jsxs("div",{className:"next-modal py-2.5 px-4 w-[334px]",children:[r.jsx("div",{className:"flex justify-between my-2.5",children:C.map(te=>r.jsxs("div",{onClick:()=>I(te.type),className:B("w-[70px] h-[64px] py-2 flex justify-center items-center flex-col text-grey3 text-t4 rounded border-grey6 border cursor-pointer",b===te.type&&"border border-active_color bg-active_color_10"),children:[te.example&&r.jsx("div",{className:"h-6 flex items-center",children:te.example}),te.title]},te.title))}),b&&r.jsxs(r.Fragment,{children:[b===m.NumberShowType.LEVEL?r.jsxs("div",{className:"flex h-10 items-center justify-between cursor-pointer",onClick:v,children:[r.jsx("span",{className:"text-t2 flex-shrink-0 mr-auto",children:"图标"}),x,r.jsx(H,{name:"IcMenuNext",className:"w-5 h-5 text-grey4"})]}):r.jsxs("div",{className:"flex h-10 items-center justify-between cursor-pointer",onClick:T,children:[r.jsx("span",{className:"text-t2 flex-shrink-0 mr-auto",children:"颜色"}),r.jsx("div",{className:"w-5 h-5 rounded-full border border-black/5",style:{backgroundColor:ql(g)}}),r.jsx(H,{name:"IcMenuNext",className:"w-5 h-5 text-grey4"})]}),S&&r.jsxs("div",{className:"flex h-10 items-center justify-between cursor-pointer relative",children:[r.jsx("span",{className:"text-t2 flex-shrink-0 mr-auto",children:b===m.NumberShowType.LEVEL?"分级(1-10)":"总值"}),r.jsx(xt,{className:"h-8 w-[120px]",style:{backgroundColor:"transparent"},onChange:te=>d(te),type:"number",value:String(u),inputType:"number"})]}),b===m.NumberShowType.LEVEL&&!/^([1-9]|10)$/.test(u.toString())&&r.jsx("div",{className:"right-0 text-red text-t4 text-right",children:"仅支持1~10的整数"}),D&&!/^[1-9][0-9]*$/.test(u.toString())&&r.jsx("div",{className:"right-0 text-red text-t4 text-right",children:"仅支持不小于1的整数"}),r.jsxs("div",{className:"flex h-10 items-center justify-between cursor-pointer",children:[r.jsx("span",{className:"text-t2 flex-shrink-0 mr-auto",children:"显示数字"}),r.jsx(wn,{open:f,onSwitch:te=>h(te)})]}),b&&r.jsxs("div",{className:"border border-grey6 rounded flex justify-center items-center h-[100px]",children:[f&&r.jsx("span",{className:"mr-1",children:Sc(b===m.NumberShowType.LEVEL?Zn(u,1,10)*.25:.25,i)}),b===m.NumberShowType.BAR&&r.jsx(X2,{width:100,height:5,percent:.25,bgColor:(W=Tf(g))!=null?W:"",progressColor:(z=ql(g))!=null?z:""}),b===m.NumberShowType.RING&&r.jsx(J1,{percent:.25,bgColor:(Q=Tf(g))!=null?Q:"",ringColor:(Z=ql(g))!=null?Z:""}),b===m.NumberShowType.LEVEL&&r.jsx(Q2,{levelSymbol:x,totalScore:Zn(u,1,10),score:Zn(u,1,10)*.25})]})]}),r.jsx("p",{className:"text-grey3 text-t4 my-3",children:"将在所有视图下生效"}),r.jsx(je,{onClick:j,className:"w-full h-8",colorType:"active",children:"提交"})]})},Dte=({onSelect:e})=>r.jsx("div",{className:"text-[24px] w-[194px] next-modal py-2 pr-4 pl-2 flex justify-between flex-wrap",children:["⭐️","❤️","💡","🔥","👍","😀","☘️","🟡️","🔷","⬛"].map((t,n)=>r.jsx("img",{src:`${bt}/score/${n+1}.png`,className:"w-6 h-6 ml-2 mt-2 cursor-pointer",onClick:()=>e(t)}))}),Ste=({propertyId:e,closeSelf:t})=>{const{collectionId:n}=Te(),[s,a]=F.useState(!1),o=_a();return r.jsxs("div",{className:"next-modal w-[450px] p-2 pb-7",children:[r.jsxs("div",{className:B("flex rounded p-3 cursor-pointer"),style:{background:s?"rgba(0,0,0,0.06)":void 0},onClick:()=>a(!0),children:[r.jsx(H,{name:"MIcRelationSync",className:"!w-[150px] !h-[100px]"}),r.jsxs("div",{className:"ml-4 flex flex-col justify-center",children:[r.jsx("p",{className:B("text-t2",s&&"font-medium"),children:"创建双向同步属性"}),r.jsxs("p",{className:"mt-1 text-t4",children:[r.jsx("span",{className:"font-bold",children:"自动创建一个与当前属性双向同步的关联属性。"}),"需要在一个多维表中建立“父记录”与“子记录”的双向关系时，请选择该选项。"]})]})]}),r.jsxs("div",{className:B("flex mt-1.5 rounded  p-3 cursor-pointer",!s&&"font-medium"),style:{background:s?void 0:"rgba(0,0,0,0.06)"},onClick:()=>a(!1),children:[r.jsx(H,{name:"MIcRelationUnsync",className:"!w-[150px] !h-[100px]"}),r.jsxs("div",{className:"ml-4 flex flex-col justify-center",children:[r.jsx("p",{className:B("text-t2",!s&&"font-medium"),children:"不创建双向同步属性"}),r.jsxs("p",{className:"mt-1 text-t4",children:[r.jsx("span",{className:"font-bold",children:"只使用一个关联属性。"}),"只需要建立当前记录与恰记录的单向关系时，请选择该选项。"]})]})]}),r.jsx(je,{className:"h-8 text-t2-medium mt-5",size:"auto",colorType:"active",onClick:()=>{var c;let i=e;s&&(i=qe());const{blocks:l}=le();t(),o(n,e,{type:m.CollectionSchemaType.RELATION,collectionId:n,spaceId:(c=l[n])==null?void 0:c.spaceId,pairProperty:i})},children:"创建关联"})]})},Rte=({collectionId:e,propertyId:t,closeSelf:n,popcorn:s})=>{const a=me(),o=_a(),i=le().blocks[e];if(!i)return null;const l=dp({ancestorId:i.spaceId,findTypes:[m.BlockType.COLLECTION_VIEW,m.BlockType.COLLECTION_VIEW_PAGE]}),c=u=>{var d;if(u.uuid===e)a.dropdown({popcorn:s,placement:"bottom",content:({onCloseModal:f})=>r.jsx(Ste,{propertyId:t,closeSelf:f})}),n();else{const f=qe(),{blocks:h}=le();o(e,t,{type:m.CollectionSchemaType.RELATION,collectionId:u.uuid,spaceId:(d=h[u.uuid])==null?void 0:d.spaceId,pairProperty:f}),n()}};return r.jsx(yc,{defaultValue:l,onSelect:c,placeholder:"搜索多维表",searchType:"collection",source:"collectionSettingsSource",header:r.jsx("p",{className:"text-t2 mb-2 flex items-center pl-4 text-grey3",children:"选择关联的多维表"})})},Ate=({collectionId:e,propertyId:t,propertyType:n,popcorn:s,isFormView:a})=>{const o=me(),i=Kt(),l=_a(),c=f=>{f===n&&f!==m.CollectionSchemaType.RELATION||(ce.event("bitalble_property_turn_type",{from_type:n,target_type:f}),f===m.CollectionSchemaType.RELATION?(i(Xe.BITABLE_PROPERTY_WIDGET),o.dropdown({popcorn:s,placement:"bottom",content:({onCloseModal:h})=>r.jsx(Rte,{collectionId:e,propertyId:t,closeSelf:h,popcorn:s})})):(l(e,t,{type:f}),f===m.CollectionSchemaType.ROLLUP&&o.dropdown({popcorn:s,placement:"bottom",content:()=>r.jsx(BC,{collectionId:e,propertyId:t})}),i(Xe.BITABLE_PROPERTY_WIDGET)))},d=(a?KD:Aw).map(f=>({type:$.OPERATION,data:{...f,hasArrow:f.type===n,arrow:r.jsx(H,{name:"IcSelectedSpace"})}}));return r.jsxs("div",{className:"flex flex-col w-[200px] py-[6px] rounded-sm next-modal-scroll text-black",children:[r.jsx("div",{className:"text-t2 text-grey3 ml-4 h-9 flex items-center",children:"基础属性"}),r.jsx(ze,{items:a?d:d.slice(0,11),onItemClick:f=>c(f.data.type)}),!a&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 text-grey3 h-9 ml-4 flex items-center",children:"高级属性"}),r.jsx(ze,{items:d.slice(11),onItemClick:f=>c(f.data.type)})]})]})},gs={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING",VISIBLE_STATE:"VISIBLE_STATE",DELETE:"DELETE",COPY:"COPY",INSERT_LEFT:"INSERT_LEFT",INSERT_RIGHT:"INSERT_RIGHT",OPTION_SELECT:"OPTION_SELECT",NUMBER_SHOW_AS:"NUMBER_SHOW_AS",NUMBER_FORMAT:"NUMBER_FORMAT"},Bte=({viewId:e,collectionId:t,propertyId:n,closeCallbackRef:s,onClose:a,from:o,popcorn:i})=>{var X;const{viewType:l,pageManager:c,readonly:u,managerReadonly:d}=Te(),f=ps(e),h=iL(e,n),p=l===m.CollectionViewType.FORM,_=l===m.CollectionViewType.TIMELINE&&(o===qn.TABLE_HEADER||o===qn.PROPERTY_LIST_TIMELINE_TABLE),{propertySchema:x,relationPropertySchema:y,targetPropertySchema:b}=qa(t,n),E=ae(oe=>{var Ie,Ke,dt;const{collectionViews:ie,blocks:ue}=oe;if(o===qn.PAGE_PROPERTIES){const $e=((Ke=(Ie=ue[t])==null?void 0:Ie.data.collectionPageProperties)!=null?Ke:[]).find(({property:ut})=>ut===n);return(dt=$e==null?void 0:$e.visible)!=null?dt:!0}const ge=ie[e];if(!ge)return;const{properties:Ne,timelineTableProperties:De=[]}=Zt(ge,oe.blocks,oe.collectionViews),Se=(_?De:Ne).find(({property:$e})=>$e===n);return Se==null?void 0:Se.visible}),w=lL(),k=_a(),C=Tte(),T=me(),v=Kt(),I=ih(),j=Cte(),[D,S]=F.useState((X=x==null?void 0:x.name)!=null?X:""),[R,A]=F.useState(""),L=D.trim(),P=(x==null?void 0:x.type)===m.CollectionSchemaType.TITLE,M=(x==null?void 0:x.type)===m.CollectionSchemaType.RELATION,U=(x==null?void 0:x.type)===m.CollectionSchemaType.ROLLUP,V=(x==null?void 0:x.type)===m.CollectionSchemaType.NUMBER,W=(x==null?void 0:x.type)===m.CollectionSchemaType.FORMULA,z=(x==null?void 0:x.type)===m.CollectionSchemaType.SELECT||(x==null?void 0:x.type)===m.CollectionSchemaType.MULTI_SELECT,Q=ae(oe=>{if(W)return Ln(t,()=>oe).getType(n)}),Z=Lte(),te=F.useRef(null);F.useEffect(()=>{const oe=te.current;oe&&oe.setSelectionRange(0,oe.value.length)},[]),F.useEffect(()=>{Z(t,D,n)?A("此多维表已经存在相同名称的属性，请修改"):A("")},[Z,t,D,n]);const re=F.useMemo(()=>{var ie;if(!p)return[];const oe=(ie=f==null?void 0:f.format.formProperties)==null?void 0:ie.find(ue=>ue.property===n);return[{type:$.TEXT_SWITCH,data:{switch:oe==null?void 0:oe.required,title:"必填",onSwitch:ue=>{h("required",ue)}}},{type:$.TEXT_SWITCH,data:{switch:oe==null?void 0:oe.showDescription,title:"添加说明",onSwitch:ue=>{h("showDescription",ue)}}},{type:$.OPERATION,isHidden:d,data:{icon:E?"IcMenuHide":"IcMenuShow",type:gs.VISIBLE_STATE,visible:E,title:E?"隐藏":"显示"}}]},[E,f==null?void 0:f.format.formProperties,p,d,n,h]),ne=F.useMemo(()=>{var ie,ue;if(!x)return[];const oe=[{type:$.LINE,data:{},isHidden:P&&o===qn.PROPERTY_LIST,disableClick:!0},...re,{type:$.OPERATION,isHidden:o!==qn.TABLE_HEADER||u||d,data:{icon:"IcMenuInsertLeft",type:gs.INSERT_LEFT,title:"左边插入列"}},{type:$.OPERATION,isHidden:o!==qn.TABLE_HEADER||u||d,data:{icon:"IcMenuInsertRight",type:gs.INSERT_RIGHT,title:"右边插入列"}},{type:$.OPERATION,isHidden:[qn.PAGE_PROPERTIES,qn.FORM_PROPERTIES].includes(o)||d,data:{icon:"IcMenuAscending",type:gs.ASCENDING,title:"升序"}},{type:$.OPERATION,isHidden:[qn.PAGE_PROPERTIES,qn.FORM_PROPERTIES].includes(o)||d,data:{icon:"IcMenuDescending",type:gs.DESCENDING,title:"降序"}},{type:$.OPERATION,isHidden:P&&!_||d||p,data:{icon:E?"IcMenuHide":"IcMenuShow",type:gs.VISIBLE_STATE,visible:E,title:E?"隐藏":"显示"}},{type:$.OPERATION,isHidden:P||u||d||M,data:{icon:"IcMenuDuplicate",type:gs.COPY,title:"拷贝"}},{type:$.OPERATION,isHidden:P||u||d,data:{icon:"IcMenuDelete",type:gs.DELETE,title:"删除"}}];if(P)oe.unshift({type:$.OPERATION,data:{icon:"IcTitleName",type:m.CollectionSchemaType.TITLE,title:"标题"}});else{if(V&&oe.unshift({type:$.OPERATION,data:{icon:"IcMenuNum",title:"格式",type:gs.NUMBER_FORMAT}},{type:$.OPERATION,data:{icon:"MIcRing",title:"显示样式",type:gs.NUMBER_SHOW_AS}}),W&&Q===He.ValueTool.numberType&&oe.unshift({type:$.OPERATION,data:{icon:"MIcRing",title:"显示样式",type:gs.NUMBER_SHOW_AS}}),U){const Ne=zd(x.aggregation)||q6(x==null?void 0:x.aggregation)==="number"||so()&&((x==null?void 0:x.targetPropertyType)===m.CollectionSchemaType.NUMBER||(x==null?void 0:x.targetPropertyType)===m.CollectionSchemaType.FORMULA&&Ln((ie=y==null?void 0:y.collectionId)!=null?ie:"").getType((ue=x==null?void 0:x.targetProperty)!=null?ue:"")===He.ValueTool.numberType);oe.unshift({type:$.OPERATION,isHidden:!Ne,data:{icon:"MIcRing",title:"显示样式",type:gs.NUMBER_SHOW_AS}}),oe.unshift({type:$.OPERATION,data:{icon:"IcTitleRollup",title:"汇总设置",hasArrow:!u,renderSubMenu:()=>u?null:r.jsx(BC,{collectionId:t,propertyId:n})}})}z&&oe.unshift({type:$.OPERATION,data:{icon:"IcMenuSettings",type:gs.OPTION_SELECT,title:"管理选项"}});const ge=p?xH:_H;oe.unshift({type:$.OPERATION,data:{...ge[x.type],hasArrow:!u,renderSubMenu:()=>u?null:r.jsx(Ate,{collectionId:t,propertyId:n,propertyType:x.type,isFormView:p,popcorn:i})}})}return oe},[x,P,o,re,u,d,_,p,E,M,V,W,Q,U,z,y==null?void 0:y.collectionId,t,n,i]);s.current=F.useCallback(()=>{if(R)return"prevent";L&&L!==(x==null?void 0:x.name)&&k(t,n,{name:L})},[t,R,n,L,x==null?void 0:x.name,k]);const Y=F.useCallback(async oe=>{var ie,ue,ge,Ne;switch(oe.data.type){case gs.ASCENDING:case gs.DESCENDING:{v(Xe.BITABLE_PROPERTY_WIDGET);const De=(ie=le().collectionViews)==null?void 0:ie[e];if(!De)return;const Se=(ue=da(De.format.sorters))!=null?ue:[];Se.forEach(dt=>{dt.disable=!1});const Ie=Se.find(dt=>dt.property===n),Ke=oe.data.type===gs.ASCENDING?"asc":"desc";if(Ie?Ie.direction=Ke:Se.push({property:n,direction:Ke,disable:!1}),yt(e,{sorters:Se}),c!=null&&c.current){const dt=c.current.querySelector(`.${bl.tableSortManager}`),$e=()=>{var Ee;const ut=(Ee=c.current)==null?void 0:Ee.getBoundingClientRect();return{getBoundingClientRect:()=>({...ut,x:ut.x+ut.width/2,y:ut.y,left:ut.left+ut.width/2,top:ut.top,width:ut.width/2,height:ut.height})}};T.dropdown({popcorn:dt?Br(dt):$e(),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(ch,{})}})}break}case gs.INSERT_LEFT:case gs.INSERT_RIGHT:{ce.event("bitable_property_create",{from_scene:"view"}),I({collectionId:t,viewId:e,position:{property:n,left:oe.data.type===gs.INSERT_LEFT},visible:!0,isTimelineTable:_}),v(Xe.BITABLE_PROPERTY_WIDGET);break}case gs.COPY:{ce.event("bitable_property_create",{from_scene:"duplicate"}),j(t,e,n,_),v(Xe.BITABLE_PROPERTY_WIDGET);break}case gs.VISIBLE_STATE:{const De=!oe.data.visible;if(l===m.CollectionViewType.FORM&&!De){const Se=le().collectionViews[e],Ie=(ge=Se==null?void 0:Se.format.formProperties)!=null?ge:[],Ke=(Ne=Se==null?void 0:Se.format.formLogic)!=null?Ne:[];if(Tp(t,e,Ie.filter($e=>$e.property===n?De:$e.visible).map($e=>$e.property),Ke)!=null){if(!await new Promise(ut=>{T.warning({title:r.jsx(r.Fragment,{children:"确认隐藏题目吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){ut(!0)},cancel(){ut(!1)}})}))return;yt(e,{formLogic:Ke})}}w(t,e,n,De,_),v(Xe.BITABLE_PROPERTY_WIDGET);break}case gs.DELETE:{T.warning({title:r.jsx(r.Fragment,{children:"是否确认删除该属性？"}),confirm:()=>{v(Xe.BITABLE_PROPERTY_WIDGET,{closeAfter:()=>{C(t,n)}})}});break}case gs.OPTION_SELECT:{v(Xe.BITABLE_PROPERTY_WIDGET),T.dropdown({popcorn:i,placement:"bottom",content:({onCloseModal:De})=>u?null:r.jsx(Ite,{viewId:e,collectionId:t,propertyId:n,onClose:De})});break}case gs.NUMBER_SHOW_AS:{v(Xe.BITABLE_PROPERTY_WIDGET),T.dropdown({popcorn:i,placement:"bottom",content:({onCloseModal:De})=>u?null:r.jsx(jte,{propertyId:n,onCloseModal:De})});break}case gs.NUMBER_FORMAT:{v(Xe.BITABLE_PROPERTY_WIDGET),T.dropdown({popcorn:i,placement:"bottom",content:({onCloseModal:De})=>u?null:r.jsx(KA,{propertyId:n,closeModal:De})});break}}},[v,e,c,n,T,I,t,_,j,l,w,C,i,u]);return r.jsxs("div",{className:"flex flex-col w-[240px] rounded-sm next-modal-scroll",children:[!u&&r.jsx("div",{className:"flex flex-row items-center w-full",children:r.jsx(xt,{inputRef:te,autoFocus:!0,placeholder:"请输入名称",value:D,className:"h-8 mx-2.5 mt-2.5 flex-1",onEnter:()=>{R||a()},onChange:S})}),R&&r.jsx("div",{className:"mx-4 mb-2 text-t4 text-red",children:R}),r.jsxs("div",{className:"flex flex-col mb-[5px]",children:[r.jsx("div",{className:"text-t2 text-grey3 mb-[4px] ml-4 mt-2.5",children:"属性类型"}),r.jsx(ze,{onItemClick:Y,items:ne})]})]})},uh=()=>{const{viewId:e,collectionId:t}=Te(),n=me(),s=F.useRef();return F.useCallback((a,o,i=qn.TABLE_HEADER,l,c)=>{n.dropdown({popcorn:o,closeBeforeCallBack:()=>{var u;c==null||c(),(u=s.current)==null||u.call(s)},modalId:Xe.BITABLE_PROPERTY_WIDGET,placement:l||"bottom",content:({onCloseModal:u})=>r.jsx(Bte,{viewId:e,collectionId:t,closeCallbackRef:s,propertyId:a,onClose:u,popcorn:o,from:i})})},[t,n,e])},Lte=()=>{const e=(t,n,s)=>{const a=le().blocks[t];return a!=null&&a.data.schema?Object.keys(a.data.schema).map(i=>{var l,c;return{...(c=(l=a.data.schema)==null?void 0:l[i])!=null?c:{},property:i}}).some(i=>s!==i.property&&i.name===n):!1};return F.useCallback(e,[])},Pte=e=>{const{viewId:t,managerReadonly:n,viewType:s,relationEditor:a,isLocked:o}=Te(),{col:i,isGroup:l}=e,c=ate(t,i.property),u=s===m.CollectionViewType.TIMELINE,d=i!=null&&i.width?Math.max(lc,i.width):Eo,f=$E(({offset:[h]})=>{c(Zn(h,lc,gH))},{from:d,preventDefault:!0});return r.jsxs("div",{"data-disable-select":!0,className:B("relative flex-shrink-0 h-full print:border-t print:border-b print:border-r",!l&&!u&&!a&&"border-r"),style:{width:d},children:[r.jsx(Ote,{...e}),!n&&!o&&r.jsx("div",{...f(),style:{touchAction:"none"},className:"absolute -right-0.5 z-10 cursor-col-resize top-0 w-1 duration-150 hover:bg-black h-full"})]})},Ote=({col:e,groupName:t})=>{const{viewId:n,collectionId:s,viewType:a,readonly:o,managerReadonly:i,isLocked:l}=Te(),c=F.useRef(null),{propertySchema:u}=qa(s,e.property),d=uh(),f=a===m.CollectionViewType.TIMELINE,h=RV(e.property,qn.TABLE_HEADER,TF(n,t));if(gw(e.property,qn.TABLE_HEADER),F.useEffect(()=>{c.current&&h&&(d(e.property,c.current),Ye({$newTableProperty:void 0}))},[e.property,h,d]),!u)return null;const p=_=>{if(g||l)return null;_.preventDefault(),d(e.property,_.currentTarget)},g=o&&i;return r.jsx("button",{ref:c,disabled:g,className:B("text-t2 flex items-center w-full h-full px-2",{"animate-hover rounded-none":!g,"pt-[37px] print:pt-0":f&&!t}),onContextMenu:p,"data-disable-contextmenu":!0,onClick:p,children:r.jsxs("span",{className:"flex items-center overflow-hidden text-grey3 whitespace-nowrap overflow-ellipsis",style:{height:si},children:[r.jsx(H,{className:"mr-1",size:"middle",name:an[u.type]}),u.name]})})},vp=F.memo(({isGroup:e,groupName:t,properties:n,className:s})=>{const{viewId:a,embed:o,relationEditor:i,viewType:l,isLocked:c,managerReadonly:u}=Te(),d=l===m.CollectionViewType.TIMELINE,f=F.useRef(null),h=Vn();F.useEffect(()=>{if(!o)return;const g=f.current,_=g==null?void 0:g.parentElement,x=g==null?void 0:g.closest(".next-space-page");if(!g||!_||!x)return;const y=()=>{const b=_.getBoundingClientRect(),E=x.getBoundingClientRect();if(b.top<E.top){let w=Math.abs(E.top-b.top);const k=_.querySelector(`.${bl.tableFooter}`),C=k==null?void 0:k.getBoundingClientRect();C&&C.y-E.y<g.clientHeight&&(w=w-(g.clientHeight-(C.top-E.top))),g.style.transform=`translate3d(0,${Math.round(w+34)}px,0)`}else g.style.transform="none"};return x.addEventListener("scroll",y),window.addEventListener("resize",y),()=>{x.removeEventListener("scroll",y),window.removeEventListener("resize",y)}},[o]);let p=0;return i||(o?p=void 0:(p=e?38+cc:cc,h===Tt.PAGE_LITE_PREVIEW&&(p=p-11))),r.jsxs("div",{ref:f,style:{top:p},className:B("sticky z-10 w-full min-w-max border-b transition-none print:border-none bg-white1 flex-shrink-0",s,bl.tableHeader,!e&&!i&&"border-t"),children:[r.jsx(vr,{disabled:u||c,className:"flex",appendChild:d?null:r.jsx(rte,{groupName:t}),modifiers:[J0,Gp],strategy:Z0,onDragStart:()=>W1(),items:n.map(g=>({id:g.property,...g})),renderItemContent:({item:g})=>r.jsx(Pte,{col:g,groupName:t,isGroup:e}),onChange:(g,{active:_,over:x})=>{var w;if(W1(),!x)return;const{properties:y=[],timelineTableProperties:b=[]}=(w=Zt(a))!=null?w:{},E=d?b:y;if(_.id!==x.id){const k=E.findIndex(v=>v.property===_.id),C=E.findIndex(v=>v.property===x.id),T=qc(E,k,C);yt(a,{[d?"timelineTableProperties":"tableProperties"]:T})}}}),d&&!t&&!u&&!c&&r.jsx(Fe,{popup:"收起表格",className:"animate-hover absolute right-2 top-2 z-10 rotate-180 text-grey3",onClick:g=>{g.stopPropagation(),yt(a,{timelineShowTable:!1})},children:r.jsx(H,{name:"IcUnfold",size:"middle"})})]})}),Mte=({recordIds:e,recordId:t,propertyId:n,width:s})=>{var V,W;const{relationRecords:a,relationCollection:o}=QB(t,n),i=Ve(t,!1),l=zs(),c=Cs(),u=F.useRef(null),d=ke(),f=F.useRef(null),h=F.useRef(null),p=F.useRef(null),[g,_]=F.useState(""),x=(V=o==null?void 0:o.uuid)!=null?V:"",{resultList:y,onInputChange:b,keyword:E,loadMore:w,hasMore:k,loading:C,firstTime:T}=Sx({type:"collection",fileType:void 0,source:"relationMenu",parentId:x,canSearchWithEmpty:!i,getPerPage:()=>20}),v=F.useMemo(()=>{var z,Q;return{collectionId:(z=o==null?void 0:o.uuid)!=null?z:"",viewParentId:(Q=o==null?void 0:o.uuid)!=null?Q:"",viewType:m.CollectionViewType.TABLE,viewId:"",readonly:!0,managerReadonly:!0,relationEditor:!0,changeView(){}}},[o==null?void 0:o.uuid]);F.useEffect(()=>j(),[a]);const I=z=>{var te;const Z=[...(te=jv(t,n))!=null?te:[]].filter(re=>!(re.type===m.TextType.LINK_PAGE&&re.uuid===z));l(e!=null?e:t,n,Z)},j=()=>{const z=setTimeout(()=>{var Q;clearTimeout(z),(Q=h.current)==null||Q.focus()})},D=z=>{var re;const Q=(re=jv(t,n))!=null?re:[],{relationRecords:Z}=du(t,n);let te=[];Z.includes(z)?te=Q.filter(ne=>ne.uuid!==z):te=Q.concat({type:m.TextType.LINK_PAGE,uuid:z,text:"",enhancer:{code:!1}}),l(e!=null?e:t,n,te)},S=()=>{d(()=>{var re;const{blocks:z}=le(),Q=z[x],Z={type:m.BlockType.PAGE};Z.data={segments:mt(E)};const te=Qe(Z,{parentId:x,last:!0});(re=Q==null?void 0:Q.views)==null||re.forEach(ne=>{ee(Fl({uuid:te,viewId:ne}))}),D(te)},{noThrottle:!0})},R=()=>{h.current&&(h.current.value=""),b(""),j()},A=y.filter(z=>z.type===m.BlockType.PAGE&&!a.includes(z.uuid)).map(z=>z.uuid),L=a.filter(z=>{const Q=K.blocks[z];return(Q==null?void 0:Q.type)===m.BlockType.PAGE&&de(Q.data.segments).includes(i?g:E)});if(!o)return null;const P=[];Object.entries((W=o.data.schema)!=null?W:{}).forEach(([z,Q])=>{const Z=z==="title",te={property:z,visible:!0,name:Q.name,type:Q.type,width:Z?1.5*Eo:Eo};Z?P.unshift(te):P.push(te)});const M=z=>{const Q=L[z];if(!Q)return null;const Z=r.jsx(H,{className:B("sticky left-2 z-10 self-center",i&&"opacity-0"),name:"MIcCircleDelete",onClick:te=>{i||(te.stopPropagation(),I(Q))},size:"large"});return r.jsx(w0,{recordId:Q,properties:P,settingIcon:Z,onClick:(te,re)=>{const{illegal:ne}=hn(Q);c(Q,{illegal:ne,forceOpenInRight:re.altKey,forceOpenNewTab:re.ctrlKey||re.metaKey})}})},U=z=>{const Q=A[z];if(!Q)return null;const Z=a.includes(Q)?"MIcCircleDelete":"MIcCircleAdd",te=r.jsx(H,{className:B("sticky left-2 self-center z-10",Z==="MIcCircleAdd"&&"invisible group-hover:visible"),name:Z,size:"large"});return r.jsx(w0,{recordId:Q,properties:P,settingIcon:te,onClick:re=>D(re)})};return r.jsxs("div",{className:B("relative w-[800px] pb-4"),style:{width:s},children:[r.jsxs("div",{className:"flex items-center justify-between py-1 border-b relative pr-3",ref:f,children:[r.jsx(xt,{autoFocus:!0,placeholder:i?"查找页面":"查找或创建新页面",className:"h-8 flex-grow bg-white2 border-none",showBorder:!1,onChange:i?z=>_(z):b,inputRef:h}),r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{size:"middle",name:"IcUploadCancel",onClick:R,className:"text-grey4 cursor-pointer animate-hover"}),r.jsx("div",{className:"flex items-center h-8 ml-4 px-1 text-t2 max-w-[150px] ",onClick:()=>{c(x)},children:r.jsx(Aa,{uuid:x,interactable:!0,className:"whitespace-nowrap text-ellipsis"})})]})]}),C&&T&&L.length===0&&r.jsx(os,{className:"w-full h-[60px]"}),L.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"px-4 mt-2 mb-2 text-grey3 text-t2",children:[L.length," 条关联记录"]}),a.length===0?r.jsx("div",{className:"text-t2 flex h-[60px] w-full items-center justify-center text-grey3",children:i?"关联记录为空":"搜索查找要关联的记录"}):r.jsx("div",{className:"max-h-[250px] w-full overflow-auto",ref:u,children:r.jsx(u0.Provider,{value:u,children:r.jsx("div",{className:"relative w-max min-w-full",children:r.jsxs(_l.Provider,{value:v,children:[r.jsx(vp,{properties:P,className:"pl-8 z-50 bg-white"}),r.jsx(o2,{bufferSize:10,scrollRef:u,getItemSize:()=>si,count:L.length,getItemKey:z=>{var Q;return(Q=L[z])!=null?Q:`row-${z}`},renderItem:M})]})})})})]}),!i&&r.jsxs(r.Fragment,{children:[A.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"px-4 mb-2 mt-4 text-grey3 text-t2",children:"选择关联记录"}),r.jsx("div",{className:"w-full max-h-[400px] overflow-auto",ref:p,children:r.jsx(u0.Provider,{value:p,children:r.jsx("div",{className:"relative w-max min-w-full",children:r.jsxs(_l.Provider,{value:v,children:[r.jsx(vp,{properties:P,className:"pl-8 z-50 bg-white"}),A.length>0&&r.jsx(Il,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:w,getScrollParent:()=>p.current,hasMore:k,children:r.jsx(o2,{bufferSize:10,scrollRef:p,getItemSize:()=>si,count:A.length,getItemKey:z=>{var Q;return(Q=A[z])!=null?Q:`row-${z}`},renderItem:U})})]})})})})]}),E&&r.jsxs("div",{className:"w-full h-[38px] text-t2 text-grey3 flex items-center pl-2.5 border-b cursor-pointer animate-hover",onClick:S,children:[r.jsx(H,{size:"middle",name:"IcAddBoard",className:"mr-2.5"}),"在 ",r.jsx(Aa,{uuid:x})," 中创建 ",r.jsx("span",{className:"text-black",children:E})]})]})]})};Xee(Mte);var dc=(e=>(e.innerHtml="innerHtml",e.blank="blank",e))(dc||{});const LC=()=>{const[e,t]=F.useState();return F.useEffect(()=>{n0(Ss.GetAppVersion).then(n=>t(n))},[]),e},Ute=async()=>{var o;const e=$F(),t=await GF(),n=(o=t==null?void 0:t.version)!=null?o:"";if(!n)return;if(!e.version){Np(n,{open:!1});return}const s=Qa(e.version),a=Qa(n);a!==s&&Np(n,{open:s<a})},Np=async(e,t)=>{const n=e.slice(0,6),s=await Ce.infra.getUserWebVersion.raw(n);if(s.code===200){Qa(s.data.version)>=Qa(n)&&(t.open=!1),Qa(s.data.version)>Qa(n)&&Ce.infra.getUserWebVersion.raw(s.data.version);const a={pageId:s.data.pageId,version:e,...t};return tE(a)}return tE({})},$F=()=>JSON.parse(localStorage.getItem(Hj)||"{}"),tE=e=>{const n={...$F(),...e};return localStorage.setItem(Hj,JSON.stringify(n)),n},Qa=e=>{var n,s;const t=(s=(n=e==null?void 0:e.slice(0,6))==null?void 0:n.split("."))!=null?s:[];return Number(t.join(""))},GF=async()=>await(await fetch(uV,{method:"GET"})).json(),Vte=async()=>{const n=(await(await fetch(cV,{method:"GET"})).text()).match(new RegExp("(?<=version: )((?:\\d\\.?)+)"));if(n!=null&&n[1]){const[,s]=n;return s}},qte=e=>{const{importantFeature:t}=e,[n,s]=F.useState(0),a=t.features.length>1&&n>0,o=n<t.features.length-1,i=n===t.features.length-1;return r.jsxs("div",{className:"next-modal w-[320px] min-h-[480px] px-7 pb-4",children:[r.jsx("div",{className:"text-t1-medium mt-7",children:e.importantFeature.title}),r.jsx(Hte,{feature:t.features[n],blockId:t.blockId}),r.jsxs("div",{className:B("flex justify-between space-x-4 mt-5",{}),children:[a&&r.jsx(je,{className:"w-full",colorType:"secondary",onClick:()=>{s(n-1)},children:"上一步"}),o&&r.jsx(je,{className:"w-full",colorType:"secondary",onClick:()=>{s(n+1)},children:"下一步"}),i&&r.jsx(je,{className:"w-full",colorType:"active",onClick:()=>{e.onComplete()},children:"完成"})]})]})},Hte=e=>{const[t,n]=F.useState(0);return e.feature?r.jsxs(r.Fragment,{children:[r.jsx(Pn,{className:"text-t2 text-grey2 mt-1",segments:e.feature.desc}),r.jsx(GE,{navigation:{nextEl:".swiper-next",prevEl:".swiper-pre"},mousewheel:!0,className:"w-[260px] h-[260px] rounded-xl border border-black_006 mt-2.5",slidesPerView:"auto",keyboard:{enabled:!0,onlyInViewport:!0},modules:[YI,XI,QI],onActiveIndexChange:s=>n(s.realIndex),children:e.feature.medias.map(s=>r.jsx(zE,{children:r.jsx($te,{blockId:e.blockId,ossName:s})},s))}),e.feature.medias.length>1&&r.jsx("div",{className:"flex justify-center",children:e.feature.medias.map((s,a)=>r.jsx("span",{className:B("h-2 w-2 rounded-full mx-1.5 mt-2.5",a===t?"bg-active_color":"bg-grey5")},a))})]}):null},$te=({blockId:e,ossName:t})=>{const{extName:n}=ac(t),[s,a]=F.useState("");return F.useEffect(()=>{Ls.fetchDownloadUrl(e,t).then(o=>{a(o)})},[e,t]),s?Hr.image.test(n)?r.jsx("img",{className:"w-full h-full object-cover",src:s}):Hr.video.test(n)?r.jsxs("div",{className:"w-full h-full flex items-center",children:[r.jsx("video",{className:"h-full",src:s,controls:!0,preload:"metadata"}),";"]}):null:r.jsx(r.Fragment,{})},Gte=async(e,t)=>{var c,u,d,f;const n=await Ce.editor.getDoc.raw(e);if(n.code!==200){t.onError(n);return}const s=n.data.blocks[e];if(!s||!s.data.schema){t.onError({code:-1,msg:"collection not found"});return}const a=(d=(c=t.getViewId)==null?void 0:c.call(t,s.views))!=null?d:(u=s.views)==null?void 0:u[0];if(!a){t.onError({code:-1,msg:"viewId not found"});return}(f=t.onDataUpdate)==null||f.call(t,n.data);let o=zte(n.data,e,a);const i=Yte(s);if(t.filter){const{filter:h}=t;o=o.filter(p=>h(p,s,i))}return t.convertToTargets(o,s,i)};function zte(e,t,n){var l;const s=(l=e.collectionViews)==null?void 0:l[n],a=e.blocks[t];if(!s||!a)return[];const o=[],{newPageSort:i}=Vg(s.pageSort,a.subNodes);for(const c of i){const u=e.blocks[c];u&&o.push(u)}return o}const Wte=(e,t,n)=>{var o,i;const s=t[n],a=s==null?void 0:s.id;if(!a)return[];switch(s.schema.type){case m.CollectionSchemaType.FILE:{const l=(o=e.data.collectionProperties)==null?void 0:o[a];return(i=l==null?void 0:l.filter(c=>c.fileStorageType==="internal"&&c.type===m.TextType.URL).map(c=>{var u;return(u=c.url)!=null?u:""}))!=null?i:[]}default:return[]}},S_=(e,t,n)=>{var o,i;const s=t[n],a=s==null?void 0:s.id;if(!a)return"";switch(s.schema.type){case m.CollectionSchemaType.TITLE:return de(e.data.segments);case m.CollectionSchemaType.FILE:case m.CollectionSchemaType.URL:{const l=(o=e.data.collectionProperties)==null?void 0:o[a];return pi(l)}default:return de((i=e.data.collectionProperties)==null?void 0:i[a])}},Kte=(e,t,n)=>{var o;const s=t[n],a=s==null?void 0:s.id;if(!a)return[];switch(s.schema.type){case m.CollectionSchemaType.TITLE:return e.data.segments;default:return(o=e.data.collectionProperties)==null?void 0:o[a]}},Yte=e=>{var n;const t={};return Object.entries((n=e.data.schema)!=null?n:{}).forEach(([s,a])=>{t[a.name]={id:s,schema:a}}),t},Xte="标题",Qte="上线",Jte="端",Zte="版本号",ene="步骤1文字",tne="步骤1附件",nne="步骤2文字",sne="步骤2附件",rne="步骤3文字",ane="步骤3附件",one=[{columnDesc:ene,columnMedia:tne},{columnDesc:nne,columnMedia:sne},{columnDesc:rne,columnMedia:ane}],cL=async()=>{const e=await Gte("6fcef75c-2637-42e8-86d7-2d59bdef4807",{onError:t=>{console.warn("err: ",t)},convertToTargets:(t,n,s)=>t.map(a=>{const o={blockId:a.uuid,title:S_(a,s,Xte),features:[]};return one.forEach(i=>{const l=Kte(a,s,i.columnDesc);if(l){const c=Wte(a,s,i.columnMedia);c.length>0&&o.features.push({desc:l,medias:c})}}),o}),filter:(t,n,s)=>!(S_(t,s,Qte)==="YES")||S_(t,s,Zte)!==Xj?!1:S_(t,s,Jte).includes(un?"PC":"Web")});if((e==null?void 0:e.length)===1)return e[0]};let uL;const ine=e=>{uL=e},lne=({onCloseModal:e,blockId:t,version:n})=>{const s=F.useRef(null);return r.jsxs("div",{className:"next-modal flex max-h-120 w-96 flex-col p-7 pb-5",children:[r.jsx("div",{className:"text-h2 h-10 px-2.5",children:"版本更新"}),r.jsxs("div",{className:"text-t2 mb-5 px-2.5 text-grey3",children:["FlowUs 息流 ",n]}),r.jsx("div",{className:"max-h-full flex-1 overflow-y-auto",ref:s,children:r.jsx(Al.Provider,{value:Tt.UPDATE_LOG,children:r.jsx(au.Provider,{value:s,children:r.jsx(uL,{uuid:t,readonly:!0})})})}),r.jsx("div",{className:"flex h-10 items-center justify-end",children:r.jsxs("a",{href:An.updateLog,target:"_blank",rel:"noreferrer",className:"text-t2 flex items-center text-grey4",onClick:()=>e(),children:["了解更多产品进展 ",r.jsx(H,{name:"IcArrowDateNext",className:"ml-1",size:"middle"})]})})]})},cne=()=>{const e=me();return F.useCallback(async()=>{const t=document.querySelector(".service-center"),n=await cL();n&&t&&e.dropdown({offset:[0,20],arrow:!0,arrayClassName:"translate-x-[-10px]",popcorn:t,content:({onCloseModal:s})=>r.jsx(qte,{importantFeature:n,onComplete:()=>{s()}})})},[e])},une=()=>{const e=me(),t=La(),n=cne();return F.useCallback(async()=>{var i;let s=$F();const a=!s.pageId;if(!s.open&&!un){const l=await GF(),c=(i=l==null?void 0:l.version)!=null?i:"",u=Qa(s.version);if(Qa(c)<=u||(s=await Np(c,{open:!a}),!s.pageId||a))return}if(!s.open)return;await t(s.pageId||"");const o=Vm();tE({open:!1}),e.dropdown({modalId:"UPDATE_LOG",popcorn:o.popcorn,placement:"top-start",offset:[-50,0],closeAfterCallBack:()=>{o.remove(),n()},content:l=>{var c;return r.jsx(lne,{blockId:`${s.pageId}`,version:(c=s.version)==null?void 0:c.slice(0,6),onCloseModal:l.onCloseModal})}})},[t,n,e])},PC=()=>{const e=ke(),t=dL(),n=OC(),s=(a,o,i)=>{var g,_,x,y,b;const l=Zt(a);if(!l)return;const{view:c,collection:u,properties:d}=l,f=(g=u.data.schema)!=null?g:{},h={...c.format,formShared:!1};let p=[];if(p=da(d),i!==m.CollectionViewType.TABLE?p.forEach(E=>{E.property!=="title"&&(E.visible=!1)}):(c==null?void 0:c.type)!==m.CollectionViewType.TABLE&&p.forEach(E=>E.visible=!0),i===m.CollectionViewType.TABLE){let E=h.tableProperties;E||(E=p),e(()=>{Kn(a,{title:o,format:Rc({tableProperties:E,oldViewFormat:h}),type:i})})}if(i===m.CollectionViewType.GALLERY){let E=h.galleryProperties;E||(E=p),e(()=>{Kn(a,{title:o,format:VF({galleryProperties:E,oldViewFormat:c.format}),type:i})})}if(i===m.CollectionViewType.LIST){let E=h.listProperties;E||(E=p),e(()=>{Kn(a,{title:o,format:qF({listProperties:E,oldViewFormat:h}),type:i})})}if(i===m.CollectionViewType.BOARD){const E=(x=(_=h.boardGroupBy)==null?void 0:_.property)!=null?x:"",w=f[E];!w||w.type!==m.CollectionSchemaType.SELECT?t(a,o):e(()=>{Kn(a,{title:o,type:i})})}if(i===m.CollectionViewType.TIMELINE&&n(a,{viewTitle:o,targetType:m.CollectionViewType.TIMELINE}),i===m.CollectionViewType.CALENDAR&&n(a,{viewTitle:o,targetType:m.CollectionViewType.CALENDAR}),i===m.CollectionViewType.FORM){let E=h.formProperties;E||(E=Zu(f,i)),e(()=>{Kn(a,{title:o,format:TC({formProperties:E,oldViewFormat:h}),type:i})}),(b=(y=K.blocks[u.uuid])==null?void 0:y.views)!=null&&b.some(w=>{var k;return((k=K.collectionViews[w])==null?void 0:k.type)===m.CollectionViewType.TABLE})||Ka({title:"表格",format:Rc({tableProperties:p}),pageSort:u.subNodes,type:m.CollectionViewType.TABLE},{parentId:u.uuid})}};return F.useCallback(s,[t,n,e])},dL=()=>{const e=ke(),t=(n,s)=>{var f,h;const a=Zt(n);if(!a)return;const{view:o,collection:i}=a,l=(f=i.data.schema)!=null?f:{},c={...o.format};let u=c.boardProperties;u||(u=Zu(l,m.CollectionViewType.BOARD));const d=Object.keys(l).find(p=>{var g;return((g=l[p])==null?void 0:g.type)===m.CollectionSchemaType.SELECT});if(d){const p=hm({groupProperty:d,options:(h=l[d])==null?void 0:h.options,boardProperties:u,oldViewFormat:c});e(()=>{Kn(n,{title:s!=null?s:o.title,format:p,type:m.CollectionViewType.BOARD})})}else{const p=qe(),g=UF(),{visibleProperty:_,inVisibleProperty:x}=Xg(p),y=hm({groupProperty:p,boardProperties:u.concat(x),options:g,oldViewFormat:c});vl.forEach(b=>{if(b==="boardProperties")return;const E=y[b];E&&(y[b]=[...E,_])}),e(()=>{pe(i.uuid,{data:{schema:{...l,[p]:{name:Ko(i.data.schema,"分类"),type:m.CollectionSchemaType.SELECT,options:g}}}}),Kn(n,{title:s!=null?s:o.title,format:y,type:m.CollectionViewType.BOARD}),Ju(i.uuid,[p],n)})}};return F.useCallback(t,[e])},OC=()=>{const e=ke(),t=(n,s)=>{var T,v,I;const a=Zt(n);if(!a)return;const{view:o,collection:i}=a,{viewTitle:l=o.title,targetType:c=o.type}=s!=null?s:{},u=c===m.CollectionViewType.TIMELINE,{calendarBy:d,calendarByEnd:f,timelineBy:h,timelineByEnd:p}=a;let g=u?h:d,_=u?p:f;const x=(T=i.data.schema)!=null?T:{},y={...o.format,formShared:!1};let b=y.calendarProperties?[...y.calendarProperties]:void 0;b||(b=Zu(x,m.CollectionViewType.CALENDAR));const E=Object.entries(x).filter(([j,D])=>D.type===m.CollectionSchemaType.DATE);let w,k;const C=E.filter(j=>j[0]===g?(w=!0,!1):j[0]===_?(k=!0,!1):!0);if(g=w?g:(v=C[0])==null?void 0:v[0],_=k?_:(I=C[w?0:1])==null?void 0:I[0],g&&_){const j=u?pm({oldViewFormat:y,timelineProperties:b,timelineBy:g,timelineByEnd:_}):gm({oldViewFormat:y,calendarProperties:b,calendarBy:g,calendarByEnd:_});e(()=>{Kn(n,{title:l||o.title,format:j,type:c})})}else{const j=[],D={...x};if(!g){g=qe();const R={property:g,visible:!1};j.push(R),b.push(R),D[g]={name:Ko(i.data.schema,"开始时间"),type:m.CollectionSchemaType.DATE}}if(!_){_=qe();const R={property:_,visible:!1};j.push(R),b.push(R),D[_]={name:Ko(i.data.schema,"结束时间"),type:m.CollectionSchemaType.DATE}}const S=u?pm({timelineProperties:b,timelineBy:g,timelineByEnd:_}):gm({calendarProperties:b,calendarBy:g,calendarByEnd:_});vl.forEach(R=>{if(u&&R==="timelineProperties"||!u&&R==="calendarProperties")return;const A=S[R];A&&(S[R]=[...A,...j])}),e(()=>{pe(i.uuid,{data:{schema:D}}),Kn(n,{title:l||o.title,format:S,type:c}),Ju(i.uuid,j.map(R=>R.property),n)})}};return F.useCallback(t,[e])},fL=()=>{let e;return(t,n=0)=>{e&&clearTimeout(e),e=setTimeout(()=>t==null?void 0:t(),n)}},zF=e=>{const{viewId:t,viewType:n,managerReadonly:s,readonly:a}=Te(),o=dL(),i=F.useMemo(()=>fL(),[]);F.useEffect(()=>{if(s||a||!e)return;i(()=>{const c=n===m.CollectionViewType.BOARD;if(e.withoutValidGroup&&c){o(t);return}e.needUpdateGroups&&yt(t,{[`${c?"boardGroups":"collectionGroups"}`]:e.newViewGroups}),e.needUpdateSubGroups&&yt(t,{collectionGroups:e.newViewSubGroups})},300)},[e,i,o,s,a,t,n])},Wh=10*60*1e3,R_=24,bN=40,Bc=zt.memo(({type:e="page"})=>{const t=gt(),[n,s]=F.useState(0),a=F.useRef(null),o=pw(),i=ae(f=>{const h=Date.now();return Object.entries(o).filter(([p,g])=>h-g.activityTime<Wh&&g.userId!==f.user.uuid&&g.present).map(([p,g])=>Jn(g,"activityTime")).sort((p,g)=>p.userId.localeCompare(g.userId))},{equalityFn:kn});F.useEffect(()=>{const f=setInterval(()=>{s(Date.now())},Wh);return()=>{clearInterval(f)}},[]);const l=F.useMemo(()=>{const f={};return i.forEach(h=>{var p;t===h.pageId&&h.blockId&&(f[h.blockId]||(f[h.blockId]=[]),(p=f[h.blockId])==null||p.push(h))}),f},[i,t]),c=F.useMemo(()=>{const f=[];for(const[h,p]of Object.entries(l))f.push(...p.map((g,_)=>r.jsx(EN,{blockId:g.blockId,position:_,userId:g.userId,showType:e,anchorRef:a},`in-block-${g.userId}`)));return f},[l,e]),u=F.useMemo(()=>{const f={};return i.forEach(h=>{var p;if(h.blockId){const g=ls(h.pageId),_=K.blocks[g!=null?g:""];g&&t===g&&((_==null?void 0:_.type)===m.BlockType.COLLECTION_VIEW||(_==null?void 0:_.type)===m.BlockType.COLLECTION_VIEW_PAGE)&&(f[g]||(f[g]=[]),(p=f[g])==null||p.push({userId:h.userId,pageId:g,blockId:h.pageId}))}}),f},[i,t]),d=F.useMemo(()=>{const f=[];for(const[h,p]of Object.entries(u))f.push(...p.map((g,_)=>r.jsx(EN,{blockId:g.blockId,position:_,userId:g.userId,showType:e,anchorRef:a},`in-block-${g.userId}`)));return f},[u,e]);return r.jsxs(r.Fragment,{children:[c,d,r.jsx("div",{className:"hidden",ref:a})]})}),EN=zt.memo(({blockId:e,position:t,userId:n,showType:s,anchorRef:a})=>{const[o,i]=F.useState(),l=On(),c=$i(n),u=Yr(n),[d,f]=F.useState(),h=jn(".block-list",l),p=Ba(h,"height"),g=F.useCallback((_=e===o)=>{const x=dne(a,e,_,s,l,t);return f(x==null?void 0:x.style),x},[a,e,o,l,t,s]);return F.useEffect(()=>{const _=x=>{i(x),g(e===x)};return In.on("hoverId",_),()=>{In.off("hoverId",_)}},[e,g]),F.useEffect(()=>{const _=g();let x;_||(x=setTimeout(()=>{g()},1e3));let y;return _!=null&&_.blockListContainer?(y=new MutationObserver((b,E)=>{let w=!1;b.forEach(k=>{switch(k.type){case"childList":{k.addedNodes.forEach(C=>{w||(w=mb(C,e,!0))}),k.removedNodes.forEach(C=>{w||(w=mb(C,e,!0))});break}case"attributes":{if(w)return;w=mb(k.target,e);break}}}),w&&g()}),y.observe(_.blockListContainer,{childList:!0,subtree:!0})):f(void 0),()=>{x&&clearTimeout(x),y&&y.disconnect()}},[a,e,l,t,s,p.height,g]),!c||!d||!e?null:r.jsx("div",{className:B("absolute flex transition"),style:d,"data-user-id":c.uuid,children:r.jsx(Ps,{className:"rounded-full text-white",name:u,color:c.backgroundColor,icon:{type:"upload",value:c.avatar},imgClassName:"rounded-full"})})}),mb=(e,t,n)=>{var s;return!!(e instanceof HTMLElement&&(((s=e.dataset)==null?void 0:s.blockId)===t||n&&e.querySelector(`[data-block-id="${t}"]`)))},dne=(e,t,n,s,a,o)=>{var u,d,f,h,p,g,_,x;let i,l;if(s==="board"||s==="table")l=(f=(d=(u=e.current)==null?void 0:u.parentElement)==null?void 0:d.parentElement)==null?void 0:f.querySelector(".block-list"),i=(g=(p=(h=e.current)==null?void 0:h.parentElement)==null?void 0:p.parentElement)==null?void 0:g.querySelector("[data-block-id]");else{if(l=jn(".block-list",a),!l)return;i=l.querySelector("[data-block-id]")}if(!l)return;const c=l.querySelector(`[data-block-id="${t}"]`);if(c&&i)if(s==="page"){const y=K.blocks[t];if(!y)return;const b=Wr((_=K.blocks[y.parentId])==null?void 0:_.type),E=jn(".block-content",a);if(!E)return;if(c.firstElementChild){const w=c.firstElementChild.getBoundingClientRect(),k=parseInt(getComputedStyle(c.firstElementChild).getPropertyValue("line-height"),10),C=parseInt(getComputedStyle(c.firstElementChild).getPropertyValue("padding-top"),10),T=E.getBoundingClientRect(),v=w.top-T.top-R_/2,I=w.left-T.left-10*o-R_,j=((x=K.blocks[y.parentId])==null?void 0:x.type)===m.BlockType.QUOTE,D={top:v+C+k/2,left:I-(n?bN+2:2)-(j?20:0)};return b&&(D.top=v+si/2),y.type===m.BlockType.COLLECTION_VIEW&&(D.top=v+15),{blockListContainer:l,style:{transform:`translate(${D.left}px, ${D.top}px)`}}}}else{const y=-10*o-R_,E={top:c.getBoundingClientRect().top-i.getBoundingClientRect().top-R_/2+si/2,left:y-(n?bN+2:2)};return{blockListContainer:l,style:{left:"0px",top:"0px",transform:`translate(${E.left}px, ${E.top}px)`}}}},mL=(e,t)=>{const n=e.left,s=e.top,a=e.left+e.width,o=e.top+e.height,i=t.left,l=t.top,c=t.left+t.width,u=t.top+t.height;return(c-n)*(i-a)<0&&(u-s)*(l-o)<0},hL=(e,t)=>{const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),i=a-s,l=o-n;if(s<a&&n<o){const c=t.width*t.height,d=i*l/c;return Number(d.toFixed(4))}return 0},fne=e=>({x:e.left+e.width*.5,y:e.top+e.height*.5});function mne(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}const wN=50,A_=5,kN=5,{autoScroll:hne,raf:CN}=lB(),pne=()=>{const e=Xr(),t=Dd(),n=ix(),s=Vn(),a=n||t||e||s===Tt.PAGE_LITE_PREVIEW,o=F.useRef(null),i=F.useRef(),[l,c]=F.useState(),u=On(),d=gt();return F.useEffect(()=>{if(a)return;const f=jn(".next-space-page",u);if(!f)return;const h=()=>{i.current=void 0,o.current=null,c(void 0),cancelAnimationFrame(CN.id),qt.removeEventListener("mousemove",g),qt.removeEventListener("mouseup",h)},p=x=>{if(wt.$blockMenuListId||x.button!==0||document.querySelector('[data-modal-id="SETTING"]'))return;const y=x.target;if(Cj(y,w=>!!w.closest("[data-disable-select], [data-draggable], [data-property-id], [data-ignore-draggable]")))return;const E=u?".right-panel":".main-panel";o.current=y.closest(`${E} [data-block-id]`),i.current=[x.clientX,x.clientY,f.scrollTop],qt.addEventListener("mousemove",g),qt.addEventListener("mouseup",h)},g=x=>{const y=i.current&&Math.abs(i.current[0]-x.clientX)<kN&&Math.abs(i.current[1]-x.clientY)<kN;if(!(!i.current||y||K.ui.selectedCells.length>0)){if(o.current){const b=o.current.getBoundingClientRect(),E=o.current.dataset.blockId,w=d===E,k=E&&K.blocks[E];let C=!1;k&&(k==null?void 0:k.type)===m.BlockType.COLLECTION_VIEW&&(C=!0);const T=b.left-(C?A_:wN),v=b.right+(C?A_:wN),I=b.top-A_,j=b.bottom+A_;if(!C&&(w||x.clientX>T&&x.clientX<v)&&x.clientY>I&&x.clientY<j)return}o.current=null,window.getSelection().removeAllRanges(),document.dispatchEvent(new Event("_clearTextSelection")),hne(x.clientX,x.clientY,f),c([x.clientX,x.clientY,f.scrollTop])}},_=()=>{c(x=>{if(!x)return x;const[y,b]=x;return[y,b,f.scrollTop]})};return f.addEventListener("scroll",_),f.addEventListener("mousedown",p),()=>{i.current=void 0,cancelAnimationFrame(CN.id),f.removeEventListener("scroll",_),f.removeEventListener("mousedown",p),qt.removeEventListener("mouseup",h),qt.removeEventListener("mousemove",g)}},[u,a]),F.useMemo(()=>{if(!i.current||!l)return;const[f,h,p]=i.current,[g,_,x]=l,y=x-p,b=h-y,E=Math.min(f,g),w=Math.min(b,_),k=Math.abs(_-b),C=Math.abs(g-f);return{top:w,left:E,width:C,height:k}},[l])},To=({type:e="page"})=>{const t=Qw(),n=Dd(),a=ix()||n,o=On(),i=pne(),l=F.useRef(new Map),c=Vn(),u=c===Tt.MAIN||c===Tt.SHARE,d=()=>{K.ui.selectedBlocks.length===0&&K.ui.selectedCells.length===0||ee(nt.update({selectedBlocks:[],selectedCells:[]}))};F.useEffect(()=>{var S,R,A,L;if(!u)return;const h=document.getElementById("root");if(!i||a){Ye({$isSelecting:!1}),h==null||h.classList.remove("selecting"),l.current=new Map;return}wt.$isSelecting||(Ye({$isSelecting:!0}),h==null||h.classList.add("selecting"),l.current=new Map,ka());const{blocks:p}=K,g=jn("[data-page-id]",o);if(!g)return;const _=(S=g.firstElementChild)==null?void 0:S.getBoundingClientRect();if(!_)return;const{pageId:x}=g.dataset;let y=[],b=[];const E=[],w=ug(".block-content [data-block-id]",o),{collectionViews:k}=le();for(const P of w){const{blockId:M,viewId:U,groupValue:V,subGroupValue:W,syncId:z,mindMapId:Q}=P.dataset;if(!M)return;if(Q)continue;const Z=l.current.get(M),te=U&&((R=k[U])==null?void 0:R.type)===m.CollectionViewType.CALENDAR;if(Z){if(te||V){const re=P.getBoundingClientRect(),ne={left:re.left,width:re.width,height:re.height,offsetTop:re.top-_.top,viewId:U,groupValue:V,subGroupValue:W,syncId:z};l.current.set(M,JI(Z.concat(ne),rn))}}else{const re=P.getBoundingClientRect(),ne={left:re.left,width:re.width,height:re.height,offsetTop:re.top-_.top,viewId:U,groupValue:V,subGroupValue:W,syncId:z};l.current.set(M,[ne])}}let C,T,v,I;for(const[P,M]of l.current){let U=!1,V;const W=[];if(M.forEach((re,ne)=>{const Y={left:re.left,top:_.top+re.offsetTop,width:re.width,height:re.height};ne===0&&(V=Y),mL(Y,i)&&(W.push(re),U=!0)}),!U||!V)continue;const z=p[P];if(!z||z.type===m.BlockType.COLUMN_LIST)continue;const Q=p[z.parentId];if(!Q)continue;(!C||V.top<C)&&(C=V.top,v=z),(!T||V.top>T)&&(T=V.top,I=z);const Z=W[0];if(!Z)return;const te={blockId:P,viewId:Z.viewId,syncId:Z.syncId};if(Z.groupValue){const re={};W.forEach(ne=>{var X;const{groupValue:Y}=ne;if(Y){const oe=(X=re[Y!=null?Y:""])!=null?X:[];re[Y]=ne.subGroupValue?oe.concat(ne.subGroupValue):oe}}),te.groupValues=re}Q.type===m.BlockType.COLUMN?b.push(te):y.push(te),E.push(P)}if(!v||!I){d();return}if(e==="page"){let P=t(v.uuid);v.type===m.BlockType.REFERENCE_COLLECTION&&(P=t((L=(A=v.data.ref)==null?void 0:A.uuid)!=null?L:"")),P.has(I.uuid)?(y=y.filter(M=>{const U=p[M.blockId];return(U==null?void 0:U.parentId)===(I==null?void 0:I.parentId)}),b=b.filter(M=>{const U=p[M.blockId];return(U==null?void 0:U.parentId)===(I==null?void 0:I.parentId)})):y=y.filter(M=>{const U=p[M.blockId];return(U==null?void 0:U.parentId)===x})}const j=[...y,...b].reduce((P,M)=>(P[M.blockId]=M,P),{}),D=E.map(P=>j[P]).filter(P=>{if(!P)return!1;const M=K.blocks[P.blockId],U=M==null?void 0:M.parentId;if(U){const V=K.blocks[U];if(V&&Wr(V.type)){const{role:W}=hn(P.blockId);return W!==m.PermissionRole.READER}}return!0});rn(D,K.ui.selectedBlocks)||ee(nt.updateSelectBlocks(D))},[t,i,a,e,o,u]);const f=F.useMemo(()=>{var h;if(o&&(i!=null&&i.left)&&!ZI){const p=(h=document.querySelector(".main-panel .next-space-page"))==null?void 0:h.getBoundingClientRect().right;return p?i.left-p:void 0}return i==null?void 0:i.left},[o,i==null?void 0:i.left]);return u?r.jsx("div",{style:{...i,left:f,zIndex:1e3},className:"fixed bg-active_color opacity-[0.12] pointer-events-none"}):null},WF=e=>ae(({collectionViews:t})=>{var s;const n=t[e];return(n==null?void 0:n.type)===m.CollectionViewType.BOARD&&((s=n.format.boardGroupBy)==null?void 0:s.enableBoardColorColumns)!==!1}),gne=(e,t=!1)=>ae(({collectionViews:n})=>{var a,o;const s=n[e];return(s==null?void 0:s.type)===m.CollectionViewType.BOARD&&!t?((a=s.format.boardGroupBy)==null?void 0:a.hideEmptyGroups)===!0:((o=s==null?void 0:s.format.collectionGroupBy)==null?void 0:o.hideEmptyGroups)===!0}),_ne=()=>{const e=ke(),t=(n,s,a)=>{e(()=>{var x,y,b,E;const{groups:o=[],subGroups:i=[],subGroupBy:l,groupBy:c,view:u,collection:d}=(x=Zt(n))!=null?x:{};if(!u||!d)return;const f=a?l==null?void 0:l.property:c==null?void 0:c.property,h=a?i:o,p=(y=d.data.schema)==null?void 0:y[f!=null?f:""];if(!p||!f)return;const g=h.concat({property:f,propertyType:p.type,value:s,visible:!0}),_=u.type===m.CollectionViewType.BOARD&&!a;if(Kn(n,{format:{[_?"boardGroups":"collectionGroups"]:g}}),p.type===m.CollectionSchemaType.SELECT||p.type===m.CollectionSchemaType.MULTI_SELECT){const w=(b=p.options)!=null?b:[],k=new Set(w.map(I=>I.color));let C=wr.map(I=>I.key);k.size!==C.length&&(C=C.filter(I=>!k.has(I)));const T={id:qe(),color:(E=od(C))!=null?E:wr[0].key,value:s},v=w.concat(T);pe(d.uuid,{data:{schema:{...d.data.schema,[f]:{...p,options:v}}}})}})};return F.useCallback(t,[e])},Lc=({isSubGroup:e=!1})=>{const{viewId:t,viewType:n,readonly:s,managerReadonly:a,isLocked:o,collectionId:i,embed:l}=Te(),c=me(),u=Lo(t),d=Bo(t),f=su(t,e),h=ru(t,e);if(s||a||o||pt.print)return null;const p=kc(i,h==null?void 0:h.property);if(xne(f==null?void 0:f.type)||p==="text"&&(h==null?void 0:h.groupLevel)===m.GroupLevel.ALPHABET_PREFIX)return null;if(n===m.CollectionViewType.BOARD&&!e){const _=Co(u,d);return r.jsx("div",{className:"flex-shrink-0 bg-white1",style:{width:_},children:r.jsx("div",{className:B("bg-grey/5 rounded-md p-[5px]"),children:r.jsxs("button",{className:"animate-hover-black3 flex h-[38px] w-full items-center rounded-md",onClick:x=>{c.dropdown({popcorn:x.currentTarget,placement:"bottom",content:({onCloseModal:y})=>r.jsx(TN,{isSubGroup:e,width:_,closeModal:y})})},children:[r.jsx(H,{size:"middle",name:"IcAddBoard",className:"text-grey3 mx-[5px]"}),r.jsx("span",{className:"text-t2 text-grey4",children:"创建分组"})]})})})}return r.jsx("div",{children:r.jsxs("button",{className:B("animate-hover-black3 sticky flex h-[38px] items-center rounded-md pr-2 pl-1",l?"left-0":"left-24"),onClick:_=>{c.dropdown({popcorn:_.currentTarget,placement:"bottom-start",content:({onCloseModal:x})=>r.jsx(TN,{isSubGroup:e,width:270,closeModal:x})})},children:[r.jsx(H,{size:"middle",name:"IcAddBoard",className:"text-grey4 mr-[5px]"}),r.jsx("span",{className:"text-t2 text-grey4",children:"创建分组"})]})})},TN=({closeModal:e,isSubGroup:t=!1})=>{const{viewId:n}=Te(),s=me(),a=_ne(),o=F.useRef(""),i=F.useRef(null),l=su(n,t),c=()=>{const d=o.current.replace(/,/g,"").trim();if(!d){e();return}if(C0(n,d,t)){s.warning({title:r.jsx(r.Fragment,{children:"已存在同名分组"}),noCancel:!0,confirm(){var f;(f=i.current)==null||f.focus()}});return}a(n,d,t),e()},u=d=>{if(C0(n,d)){s.warning({title:r.jsx(r.Fragment,{children:"已存在同名分组"}),noCancel:!0});return}a(n,d,t),e()};return(l==null?void 0:l.type)===m.CollectionSchemaType.PERSON?r.jsx("div",{className:"next-modal",children:r.jsx(gF,{onSelect:u})}):(l==null?void 0:l.type)===m.CollectionSchemaType.RELATION?r.jsx(yc,{onSelect:({uuid:d})=>u(d),searchType:"page",source:"relationMenu",canSearchWithEmpty:!0,parentId:l.collectionId}):r.jsxs("div",{className:"next-modal box-border flex w-[320px] py-2 pr-3",children:[r.jsx(xt,{autoFocus:!0,inputRef:i,showBorder:!1,className:"text-t2 h-8 flex-1 rounded-sm border-none !bg-transparent",onEnter:c,onChange:d=>o.current=d}),r.jsx(je,{onClick:c,colorType:"active",className:"text-t4 flex h-[32px] w-[62px] items-center border-none text-white",children:"完成"})]})},xne=e=>e===m.CollectionSchemaType.CHECKBOX||e===m.CollectionSchemaType.NUMBER||e===m.CollectionSchemaType.DATE||e===m.CollectionSchemaType.FORMULA||e===m.CollectionSchemaType.CREATED_AT||e===m.CollectionSchemaType.CREATED_BY||e===m.CollectionSchemaType.UPDATED_AT||e===m.CollectionSchemaType.UPDATED_BY,C0=(e,t,n)=>{var i;const{groups:s=[],subGroups:a=[]}=(i=Zt(e))!=null?i:{};return!!(n?a:s).find(l=>l.value===t)},Fne=()=>{const e=me();return t=>new Promise(n=>{e.warning({title:r.jsx("div",{className:"mb-3",children:"是否禁用排序规则"}),content:r.jsx("div",{className:"text-t2",children:"当前已设置排序规则，这可能导致你找不到插入后的记录，是否将记录顺序调整为当前排序结果并禁用排序规则？"}),confirm:()=>{var i;ce.event("bitable_view_sort_manage",{manage_type:"popoff"});const s=Zt(t);if(!s){n(!0);return}const a=uc({viewId:t,ignoreSearch:!0}),o=(i=da(s.view.format.sorters))!=null?i:[];for(const l of o)l.disable=!0;Zc(t,{pageSort:a,format:{sorters:o}}),n(!0)},cancel:()=>{n(!1)}})})},yne=(e,t)=>{var n,s;switch(e.type){case m.CollectionSchemaType.CHECKBOX:return t==="YES"?mt("YES"):void 0;case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{const a=he(t,Ct);return a.isValid()?[Fn({from:a.toDate()})]:void 0}case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.PERSON:{const a=t==="me"?K.user.uuid:t;return[wc(a)]}case m.CollectionSchemaType.RELATION:return t===""?void 0:t.split(",").filter(Boolean).map(a=>({type:m.TextType.LINK_PAGE,enhancer:{},text:"",uuid:a}));case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:return mt((s=(n=e.options)==null?void 0:n.find(a=>a.id===t))==null?void 0:s.value);case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.URL:default:return mt(t)}};function bne(e,t,n){const s=o=>{const i=li[o];return i!=null?i.fn()[0].format(Ct):o},a=o=>{if(o==null||o.disable)return!0;if(o.type==="group")return o.operator==="and"?o.filters.filter(j=>ci(j,e)).every(j=>a(j)):o.filters.length===0?!0:o.filters.filter(j=>ci(j,e)).some(j=>a(j));const{property:i}=o,l=e[i];if(l==null)return!0;if(im.includes(l.type)||YD.includes(l.type))return!1;const c=n[i],u=j=>(l.type===m.CollectionSchemaType.DATE&&(j=s(j)),n[i]=yne(l,j),!0),d=()=>c===void 0,f=()=>{var j,D;if(c!==void 0)return!0;switch(l.type){case m.CollectionSchemaType.DATE:return u(he().format(Ct));case m.CollectionSchemaType.PERSON:return u("me");case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{const S=(D=(j=l.options)==null?void 0:j[0])==null?void 0:D.id;return S!=null?u(S):!1}case m.CollectionSchemaType.CHECKBOX:return u("YES");default:return!1}},h=j=>{const D=R=>j==="neq"?!R:R,S=R=>j==="eq"?u(R):!0;switch(l.type){case m.CollectionSchemaType.DATE:{const R=he(s(o.value),Ct),A=c==null?void 0:c.find(L=>L.type===m.TextType.DATE||L.type===m.TextType.DATETIME);if(A!=null){const L=he(Ec(A)).startOf("day");return D(L.isSame(R))}return S(o.value)}case m.CollectionSchemaType.NUMBER:{const R=Number(o.value),A=B2(c);return A!==void 0?D(A===R):S(o.value)}default:return c!==void 0?D(de(c)===o.value):S(o.value)}},p=()=>h("eq"),g=()=>h("neq"),_=j=>{switch(l.type){case m.CollectionSchemaType.NUMBER:{const D=Number(o.value),S=B2(c);if(S!==void 0)switch(j){case"lt":return S<D;case"gt":return S>D;case"lte":return S<=D;case"gte":return S>=D;default:return!1}switch(j){case"lt":return u(`${D-1}`);case"gt":return u(`${D+1}`);default:return u(o.value)}}case m.CollectionSchemaType.DATE:{const D=he(s(o.value),Ct),S=c==null?void 0:c.find(R=>R.type===m.TextType.DATE||R.type===m.TextType.DATETIME);if(S!=null){const R=he(Ec(S)).startOf("day");switch(j){case"lt":return R.isBefore(D);case"gt":return R.isAfter(D);case"lte":return R.isBefore(D)||R.isSame(D);case"gte":return R.isAfter(D)||R.isSame(D);default:return!1}}switch(j){case"lt":return u(D.subtract(1,"day").format(Ct));case"gt":return u(D.add(1,"day").format(Ct));default:return u(D.format(Ct))}}default:return!1}},x=()=>_("lt"),y=()=>_("gt"),b=()=>_("lte"),E=()=>_("gte"),w=j=>{const D=R=>j==="nin"?!R:R,S=R=>j==="in"?u(R):!0;switch(l.type){case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return c!==void 0?D(de(c).includes(o.value)):S(o.value);case m.CollectionSchemaType.MULTI_SELECT:return c!==void 0?D(de(c).split(/\s*,\s*/g).findIndex(R=>R===o.value)!==-1):S(o.value);case m.CollectionSchemaType.PERSON:return c!==void 0?D(c.findIndex(R=>R.type===m.TextType.USER&&R.uuid===o.value)!==-1):S(o.value);case m.CollectionSchemaType.RELATION:return c!==void 0?D(c.findIndex(R=>R.type===m.TextType.LINK_PAGE&&R.uuid===o.value)!==-1):S(o.value);case m.CollectionSchemaType.DATE:return c!==void 0?D(c.findIndex(R=>R.type===m.TextType.DATE||R.type===m.TextType.DATETIME)!==-1):S(o.value);default:return!1}},k=()=>w("in"),C=()=>w("nin"),T=j=>{switch(l.type){case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:return c!==void 0?de(c)[j](o.value):u(o.value);default:return!1}},v=()=>T("startsWith"),I=()=>T("endsWith");switch(o.operator){case"isEmpty":return d();case"isNotEmpty":return f();case"eq":return p();case"neq":return g();case"gt":return y();case"gte":return E();case"lt":return x();case"lte":return b();case"in":return k();case"nin":return C();case"startsWith":return v();case"endsWith":return I();default:return!0}};return a(t)}const Gi=e=>{const t=Fne(),n=BJ();return F.useCallback(async({viewId:s,where:a,propertyValues:o,from:i,openInRight:l,templateId:c})=>{var x,y,b,E;const u=le().collectionViews[s];if(!u)return;const d=Sk(s);if(!d)return;const f={},h=async w=>{const k=(w==null?void 0:w.openInRight)||l;n({viewId:s,where:a,propertyValues:f,templateId:c,isOpenInRight:k,from:i})};let p=!1;if(c==null){const w=(y=(x=le().blocks[d])==null?void 0:x.data.schema)!=null?y:{};p=bne(w,u.format.filter,f),Object.assign(f,o)}if(!p){await h({openInRight:!0});return}const _=((b=u.format.sorters)!=null?b:[]).filter(w=>!w.disable).length>0;if(!((E=e==null?void 0:e.ignoreSorters)!=null&&E)&&_){ce.event("bitable_cancel_sort_dialog",{from_scene:"insert_record"});const w=await t(s);await h({openInRight:!w});return}await h()},[t,n,e==null?void 0:e.ignoreSorters])},Ene={[m.CollectionViewType.TABLE]:"table_bottom",[m.CollectionViewType.BOARD]:"kanban_bottom",[m.CollectionViewType.GALLERY]:"gallary",[m.CollectionViewType.TIMELINE]:"timeline",[m.CollectionViewType.CALENDAR]:"calendar",[m.CollectionViewType.FORM]:"form",[m.CollectionViewType.LIST]:"list",[m.CollectionViewType.FORM]:"form",[m.CollectionViewType.SPACE]:""},hu=e=>{const{where:t,groupName:n,subGroupName:s,color:a}=e,{viewId:o,viewType:i,readonly:l,managerReadonly:c}=Te(),u=Gi({ignoreSorters:!0}),d=Xr();if(l||c||!i)return null;const f=i===m.CollectionViewType.BOARD,h=i===m.CollectionViewType.TABLE,p=i===m.CollectionViewType.GALLERY,g=i===m.CollectionViewType.TIMELINE,_=i===m.CollectionViewType.LIST,x=y=>{ce.event("bitable_record_create",{from_scene:Ene[i]});const b=th({viewId:o,groupValue:n,subGroupValue:s,isNewRecord:!0});u({viewId:o,where:t,propertyValues:b,from:g?Kg.TIMELINE_TABLE:void 0}),y.currentTarget.blur()};return r.jsxs("button",{className:B("text-grey4 flex w-full print:hidden",{"h-[36px] min-w-max flex-1 items-center border-b duration-150":h||g,"h-[38px] items-center rounded-md":f,"min-h-[38px] items-center justify-center rounded-md border border-black/10":p,"h-9 items-center rounded-md":_,"animate-hover-black3":!d}),onClick:x,style:{color:pj(a)},children:[h&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-shrink-0 items-center pl-2",style:{height:si-1},children:[r.jsx(H,{size:"middle",name:"IcAddBoard",className:"mr-1 "}),r.jsx("span",{className:"text-t2",children:"创建记录"})]}),r.jsx("div",{className:"w-12 flex-1"})]}),!h&&r.jsxs(r.Fragment,{children:[r.jsx(H,{size:"middle",name:"IcAddBoard",className:B("",{"mr-[5px]":_,"mx-[5px]":f||p})}),r.jsx("span",{className:"text-t2",children:"创建记录"})]})]})},wne=()=>{const e=ke(),t=(n,s,a,o)=>{e(()=>{var w,k,C;const{groups:i=[],subGroups:l=[],groupBy:c,subGroupBy:u,view:d,collection:f}=(w=Zt(n))!=null?w:{};if(!d||!f)return;const h=o?u==null?void 0:u.property:c==null?void 0:c.property,p=o?u:c,g=o?l:i;if(!h)return;const _=g.map(T=>({...T,value:T.value===s?a:T.value})),x=d.type===m.CollectionViewType.BOARD&&!o;Kn(n,{format:{[x?"boardGroups":"collectionGroups"]:_}});const y=(k=f.data.schema)==null?void 0:k[h],{blocks:b,users:E}=le();if(f.subNodes.forEach(T=>{var S,R,A,L;const v=b[T];if(!v)return;const{role:I}=hn(T);if(I===m.PermissionRole.READER)return;if(!y||!p)return null;const j=wp({blocks:b,users:E,collectionId:f.uuid,recordId:T,groupProperty:h,groupBy:p});let D=[];if(j.includes(s)){switch(y.type){case m.CollectionSchemaType.TITLE:{D=mt(a);break}case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:{D=[{type:m.TextType.URL,url:a,text:a,enhancer:{}}];break}case m.CollectionSchemaType.PERSON:{D=((R=(S=v.data.collectionProperties)==null?void 0:S[h])!=null?R:[]).map(M=>({...M,uuid:M.uuid===s?a:M.uuid}));break}case m.CollectionSchemaType.MULTI_SELECT:case m.CollectionSchemaType.SELECT:{const P=(L=(A=v.data.collectionProperties)==null?void 0:A[h])!=null?L:[],M=de(P).split(",").map(U=>U===s?a:U).filter(U=>!!U).join(",");D=mt(M);break}default:D=mt(a);break}y.type===m.CollectionSchemaType.TITLE?pe(T,{data:{segments:D}}):pe(T,{data:{collectionProperties:{...v.data.collectionProperties,[h]:D}}})}}),(y==null?void 0:y.type)===m.CollectionSchemaType.MULTI_SELECT||(y==null?void 0:y.type)===m.CollectionSchemaType.SELECT){const T=(C=y.options)==null?void 0:C.map(v=>({...v,value:v.value===s?a:v.value}));pe(f.uuid,{data:{schema:{...f.data.schema,[h]:{...y,options:T}}}})}})};return F.useCallback(t,[e])},kne=e=>{const{closeModal:t,isSubGroup:n=!1,groupName:s}=e,{viewId:a}=Te(),o=wne(),i=me(),l=F.useRef(""),c=F.useRef(null),u=su(a,n),d=()=>{const h=l.current.replace(/,/g,"").trim();if(!h){t();return}if(C0(a,h,n)){i.warning({title:r.jsx(r.Fragment,{children:"已存在同名分组"}),noCancel:!0,confirm(){var p;(p=c.current)==null||p.focus()}});return}o(a,s,h,n),t()},f=h=>{if(C0(a,h,n)){i.warning({title:r.jsx(r.Fragment,{children:"已存在同名分组"}),noCancel:!0,confirm(){var p;(p=c.current)==null||p.focus()}});return}o(a,s,h,n),t()};return(u==null?void 0:u.type)===m.CollectionSchemaType.PERSON?r.jsx("div",{className:"next-modal",children:r.jsx(gF,{onSelect:f})}):r.jsxs("div",{className:"next-modal box-border flex w-[320px] py-2 pr-3",children:[r.jsx(xt,{autoFocus:!0,showBorder:!1,className:"text-t2 h-8 flex-1 rounded-sm border-none !bg-transparent",onEnter:d,defaultValue:Xa(s),onChange:h=>l.current=h}),r.jsx(je,{onClick:d,colorType:"active",className:"text-t4 flex h-[32px] w-[62px] items-center border-none text-white",children:"完成"})]})};var Zg=(e=>(e.GROUP_HEADER="group_header",e.GROUP_LIST="group_list",e.HIDDEN_GROUP="hidden_group",e))(Zg||{});const KF=e=>{var E;const{isSubGroup:t,groupName:n,scene:s}=e,{viewId:a,collectionId:o,managerReadonly:i,readonly:l,isLocked:c}=Te(),u=Cs(),d=me(),f=ru(a,t),h=tF(a,n,t),p=su(a,t);if(!Xa(n))return r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-t2",children:"无 "}),r.jsx("span",{className:"text-t2-bold text-ellipsis rounded-sm",children:p==null?void 0:p.name})]});let g;const _=p==null?void 0:p.type;switch(_){case m.CollectionSchemaType.CHECKBOX:{const w=n==="YES";g=r.jsx(Ra,{size:"large",checked:w});break}case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{h&&(g=r.jsx(Tl,{color:h.color,value:h.value,label:h.value}));break}case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.PERSON:g=r.jsx(hi,{size:"default",userId:n});break;case m.CollectionSchemaType.RELATION:g=r.jsx(Aa,{uuid:n,className:"mr-2 whitespace-nowrap p-0 leading-none"});break;case m.CollectionSchemaType.NUMBER:{if(n==="out_of_range")g="超出范围";else{const w=n.split(",");g=`${w[0]} 到 ${w[1]}`}break}case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{const w=zf("date",f==null?void 0:f.groupLevel);g=vN(n,w);break}case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:{g=n;break}case m.CollectionSchemaType.FORMULA:{const k=Ln(o).getTypeAsCollectionSchemaType((E=f==null?void 0:f.property)!=null?E:"");let C=f==null?void 0:f.groupLevel;if((k==="text"||k==="date")&&(C=zf(k,C)),k===m.CollectionSchemaType.NUMBER)if(n==="out_of_range")g="超出范围";else{const T=n.split(",");g=`${T[0]} 到 ${T[1]}`}else if(k===m.CollectionSchemaType.DATE)g=vN(n,C);else if(k===m.CollectionSchemaType.CHECKBOX){const T=n==="YES";g=r.jsx(Ra,{size:"large",checked:T})}else g=n;break}}const x=w=>{if(i||l||c||s==="group_list"||(p==null?void 0:p.type)===m.CollectionSchemaType.FORMULA)return;if((p==null?void 0:p.type)===m.CollectionSchemaType.RELATION){u(n);return}const k=kc(o,f==null?void 0:f.property);(k==="text"&&(f==null?void 0:f.groupLevel)===m.GroupLevel.EXACT||k===m.CollectionSchemaType.SELECT||k===m.CollectionSchemaType.MULTI_SELECT||k===m.CollectionSchemaType.PERSON)&&d.dropdown({popcorn:w.currentTarget,placement:"bottom",content:({onCloseModal:C})=>r.jsx(kne,{isSubGroup:t,closeModal:C,groupName:n})})},b=kc(o,f==null?void 0:f.property)==="text"&&_!==m.CollectionSchemaType.FORMULA&&(f==null?void 0:f.groupLevel)===m.GroupLevel.EXACT||_===m.CollectionSchemaType.RELATION||_===m.CollectionSchemaType.SELECT||_===m.CollectionSchemaType.MULTI_SELECT||_===m.CollectionSchemaType.PERSON;return _===m.CollectionSchemaType.CHECKBOX?r.jsx(r.Fragment,{children:g}):r.jsx("div",{onClick:x,className:B("text-t2 text-ellipsis",s!=="group_header"&&"w-full",s!=="group_list"&&"p-1",b&&s!=="group_list"&&"animate-hover cursor-pointer"),children:g})},Cne={today:"今天",tomorrow:"明天",yesterday:"昨天",next_7_day:"未来 7 天",last_7_day:"过去 7 天",last_30_day:"过去 30 天",next_30_day:"未来 30 天",after_next_30_day:"未来 30 天后",before_last_30_day:"过去 30 天前"},vN=(e,t)=>{var s;let n="";if(t===m.GroupLevel.RELATIVE)n=(s=Cne[e])!=null?s:"";else if(t===m.GroupLevel.DAY)n=he(e).format("YYYY年M月D日");else if(t===m.GroupLevel.WEEK){const a=he(e).valueOf()+6*En;n=`${he(e).format("YYYY年M月D日")} - ${he(a).format("YYYY年M月D日")}`}else t===m.GroupLevel.MONTH?n=he(e).format("YYYY年M月"):t===m.GroupLevel.YEAR&&(n=he(e).format("YYYY年"));return n},pL=()=>{const e=({viewId:t,groupName:n,visible:s,isSubGroup:a})=>{var p,g;const{view:o,groups:i,subGroups:l,subGroupBy:c,groupBy:u}=(p=Zt(t))!=null?p:{},d=(o==null?void 0:o.type)===m.CollectionViewType.BOARD,f=(g=a?l:i)==null?void 0:g.map(_=>!_.value&&!n||_.value===n?{..._,visible:s,emptyHidden:s&&(a?c!=null&&c.hideEmptyGroups:u!=null&&u.hideEmptyGroups)?!1:_.emptyHidden}:_);yt(t,{[`${d&&!a?"boardGroups":"collectionGroups"}`]:f})};return F.useCallback(e,[])},Tne=({visible:e,groupName:t,isSubGroup:n,showDragButton:s})=>{const{viewId:a,isLocked:o}=Te(),i=pL();return r.jsxs("div",{className:B("text-t2 animate-hover flex h-8 cursor-pointer items-center justify-between pr-3",s?"pl-3":"pl-4"),children:[r.jsxs("div",{className:"flex flex-1 items-center overflow-hidden",children:[s&&r.jsx("div",{className:"mr-1 flex h-5 w-5 items-center justify-center",children:r.jsx(H,{name:"IcBlockHandle",className:"text-grey4"})}),r.jsx(KF,{isSubGroup:n,groupName:t,scene:Zg.GROUP_LIST})]}),r.jsx("button",{className:B("h-5 w-5",o&&"cursor-not-allowed opacity-20"),onClick:()=>{o||i({viewId:a,groupName:Xa(t),visible:!e,isSubGroup:n})},children:r.jsx(H,{name:e?"IcMenuItemHide":"IcMenuItemShow",size:"middle"})})]})},vne=()=>{const e=(t,n,s=!1)=>{var p,g;const a=Zt(t);if(!a)return;const{view:o,collection:i,groupBy:l,subGroupBy:c}=a,u=s?c:l;let d={property:n,hideEmptyGroups:u==null?void 0:u.hideEmptyGroups,enableBoardColorColumns:u==null?void 0:u.enableBoardColorColumns};switch((g=(p=i.data.schema)==null?void 0:p[n])==null?void 0:g.type){case m.CollectionSchemaType.NUMBER:{d={...d,start:0,end:1e3,size:100,sort:m.GroupSortType.ASCENDING};break}case m.CollectionSchemaType.TITLE:case m.CollectionSchemaType.TEXT:case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.EMAIL:{d={...d,groupLevel:m.GroupLevel.EXACT,sort:m.GroupSortType.ASCENDING};break}case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{d={...d,groupLevel:m.GroupLevel.RELATIVE,sort:m.GroupSortType.ASCENDING};break}case m.CollectionSchemaType.RELATION:{d={...d,sort:m.GroupSortType.ASCENDING};break}}const h=o.type===m.CollectionViewType.BOARD&&!s;yt(t,{[`${h?"boardGroupBy":"collectionGroupBy"}`]:d,[`${h?"boardGroups":"collectionGroups"}`]:[]})};return F.useCallback(e,[])},Nne=({isSubGroup:e})=>{var C,T,v;const{viewId:t,viewType:n,isLocked:s,collectionId:a}=Te(),o=WF(t),i=gne(t,e),l=ru(t,e),c=su(t,e),u=me(),d=n===m.CollectionViewType.BOARD,f=I=>{s||u.dropdown({popcorn:I.currentTarget,placement:"bottom-end",content:()=>r.jsx(Ine,{isSubGroup:e})})},h=I=>{s||u.dropdown({popcorn:I.currentTarget,placement:"bottom-end",content:()=>r.jsx(jne,{isSubGroup:e})})},p=I=>{if(s)return;const j=kc(a,l==null?void 0:l.property);u.dropdown({popcorn:I.currentTarget,placement:"bottom-end",content:()=>j===m.CollectionSchemaType.NUMBER?r.jsx(Sne,{isSubGroup:e}):r.jsx(Dne,{isSubGroup:e})})},g=I=>{var te;if(s)return;const{groups:j=[],subGroups:D=[],view:S}=(te=Zt(t))!=null?te:{};if(!S)return;const R=uc({viewId:t}),{blocks:A,collectionViews:L,users:P}=le(),M=vF({blocks:A,collectionViews:L,users:P,viewId:t,sortedRecordIds:R});if(!M)return;const{groups:U=[],withoutValidGroup:V,subGroups:W=[]}=M;if(!e&&V)return;const z=e?W:U;let Q=[];if(I){const re=new Set;z.forEach(ne=>{ne.recordIds.length===0&&re.add(ne.value)}),Q=(e?D:j).map(ne=>ne.value&&re.has(ne.value)||!ne.value&&re.has(Td)?{...ne,emptyHidden:!0}:{...ne,emptyHidden:void 0})}else Q=(e?D:j).map(re=>({...re,emptyHidden:void 0}));const Z={};d&&!e?(Z.boardGroups=Q,Z.boardGroupBy={...S.format.boardGroupBy,hideEmptyGroups:I}):(Z.collectionGroups=Q,Z.collectionGroupBy={...S.format.collectionGroupBy,hideEmptyGroups:I}),yt(t,Z)},_=I=>{s||yt(t,{boardGroupBy:{...l,enableBoardColorColumns:I}})},x=kc(a,l==null?void 0:l.property);let y;if(x==="date"||x==="number"||x==="text"){const I=gC[x],j=I.find(D=>D.type===(l==null?void 0:l.sort));j?y=j.name:y=(C=I.find(D=>D.type===m.GroupSortType.ASCENDING))==null?void 0:C.name}let b;if(x==="number"){const{start:I,end:j}=_0(l);b=`${I} 到 ${j}`}else if(x==="date"||x==="text"&&(c==null?void 0:c.type)!==m.CollectionSchemaType.RELATION){const I=_C[x],j=I.find(D=>D.type===(l==null?void 0:l.groupLevel));if(j)b=j.name;else{const D=x==="date"?m.GroupLevel.RELATIVE:m.GroupLevel.EXACT;b=(T=I.find(S=>S.type===D))==null?void 0:T.name}}let E="无";$g(a).includes((v=l==null?void 0:l.property)!=null?v:"")&&(c!=null&&c.name)&&(E=c.name);const w=[{name:"分组条件",onClick:f,value:E},{name:"分组方式",onClick:p,value:b},{name:"排序",onClick:h,value:y}],k=[{name:"隐藏无记录分组",onSwitch:g,value:i,visible:!!(l!=null&&l.property)},{name:"分组颜色",onSwitch:_,value:o,visible:d&&!e&&((c==null?void 0:c.type)===m.CollectionSchemaType.SELECT||(c==null?void 0:c.type)===m.CollectionSchemaType.MULTI_SELECT)}];return r.jsxs("div",{className:"px-4",children:[w.map(({name:I,onClick:j,value:D})=>D?r.jsxs("div",{className:"flex h-10 items-center justify-between",children:[r.jsx("span",{className:"text-t2 flex-shrink-0",children:I}),r.jsxs("div",{className:B("ml-2 flex cursor-pointer items-center text-ellipsis",s&&"cursor-not-allowed"),onClick:j,children:[r.jsx("span",{className:"text-t2 mr-2 text-ellipsis text-grey3",children:D}),r.jsx(H,{name:"IcArrow",size:"xxxsmall"})]})]},I):null),k.map(({name:I,onSwitch:j,value:D,visible:S})=>S?r.jsxs("div",{className:"flex h-10 w-full items-center justify-between",children:[r.jsx("span",{className:"text-t2",children:I}),r.jsx(wn,{open:D,onSwitch:j,disabled:s})]},I):null)]})},Ine=({isSubGroup:e})=>{const{viewId:t,viewType:n,collectionId:s}=Te(),a=vne(),o=ae(f=>{var h;return(h=f.blocks[s])==null?void 0:h.data.schema}),i=ru(t,e),[l,c]=F.useState(i==null?void 0:i.property),u=ae(f=>$g(s,f));if(!o)return null;const d=[];return u.forEach(f=>{var p;const h=o[f];h&&d.push({type:$.OPERATION,data:{title:(p=o[f])==null?void 0:p.name,propertyId:f,icon:r.jsx(H,{name:an[h.type],size:"middle"}),hasArrow:l===f,arrow:r.jsx(H,{name:"IcSelectedSpace"})}})}),(n!==m.CollectionViewType.BOARD||e)&&d.unshift({type:$.OPERATION,data:{title:"无",hasArrow:typeof l>"u",arrow:r.jsx(H,{name:"IcSelectedSpace"})}}),r.jsx(ze,{className:"next-modal-scroll w-[160px] py-[5px]",items:d,onItemClick:f=>{const{propertyId:h}=f.data;h!==l&&(c(h),a(t,h,e))}})},jne=({isSubGroup:e})=>{const{viewId:t,viewType:n,collectionId:s}=Te(),a=ru(t,e),o=n===m.CollectionViewType.BOARD,i=kc(s,a==null?void 0:a.property);if(i!=="date"&&i!=="number"&&i!=="text")return null;const l=gC[i],c=Hg(i,a==null?void 0:a.sort),u=l.map(d=>({type:$.OPERATION,data:{title:d.name,sort:d.type,arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:c===d.type}}));return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:u,onItemClick:d=>{const{sort:f}=d.data;(a==null?void 0:a.sort)!==f&&yt(t,{[o&&!e?"boardGroupBy":"collectionGroupBy"]:{...a,sort:f}})}})},Dne=({isSubGroup:e})=>{const{viewId:t,viewType:n,collectionId:s}=Te(),a=ru(t,e),o=kc(s,a==null?void 0:a.property);if(o!=="date"&&o!=="text")return null;const i=_C[o],l=zf(o,a==null?void 0:a.groupLevel),c=i.map(u=>({type:$.OPERATION,data:{title:u.name,groupLevel:u.type,arrow:r.jsx(H,{name:"IcSelectedSpace"}),hasArrow:l===u.type}}));return r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:c,onItemClick:u=>{const{groupLevel:d}=u.data,f=n===m.CollectionViewType.BOARD&&!e;(a==null?void 0:a.groupLevel)!==d&&yt(t,{[f?"boardGroupBy":"collectionGroupBy"]:{...a,groupLevel:d},[f?"boardGroups":"collectionGroups"]:[]})}})},Sne=({isSubGroup:e})=>{const{viewId:t,viewType:n}=Te(),s=ru(t,e),a=F.useCallback($n((c,u)=>{const d=n===m.CollectionViewType.BOARD&&!e;yt(t,{[d?"boardGroupBy":"collectionGroupBy"]:{...s,[u]:parseFloat(c)||1},[d?"boardGroupBy":"collectionGroups"]:[]})}),[s,e,yt,t,n]),{start:o,end:i,size:l}=_0(s);return r.jsxs("div",{className:"next-modal w-[300px] py-1.5",children:[r.jsx("div",{className:"text-t2 flex h-10 items-center pl-4 text-grey3",children:"分组范围"}),r.jsxs("div",{className:"flex h-10 items-center justify-between px-4 py-2",children:[r.jsx(xt,{className:"h-8 w-[120px]",style:{backgroundColor:"transparent"},onChange:c=>a(c,"start"),defaultValue:o,inputType:"number"}),r.jsx(xt,{className:"h-8 w-[120px]",style:{backgroundColor:"transparent"},onChange:c=>a(c,"end"),defaultValue:i,inputType:"number"})]}),r.jsx("div",{className:"text-t2 flex h-10 items-center pl-4 text-grey3",children:"每个分组间隔"}),r.jsx("div",{className:"flex h-10 items-center px-4 py-2",children:r.jsx(xt,{style:{backgroundColor:"transparent"},className:" h-8 w-full",onChange:c=>a(c,"size"),defaultValue:l,inputType:"number"})}),r.jsxs("div",{className:"text-t2 mx-4 flex items-center text-grey3",children:[o,"到",`${$a.sum(o,l)}`,", ",`${$a.sum(o,l)}`,"到",`${$a.sum(o,l*2)}`,", ..."]})]})},Pc=({isSubGroup:e,isFromViewSetting:t})=>{const{viewId:n,viewType:s,isLocked:a}=Te(),o=YF(),i=fu(n),l=Rk(e);if(!i||!s)return null;const c=b=>{var I;if(a)return;const{groups:E=[],subGroups:w=[]}=(I=Zt(n))!=null?I:{},k=s===m.CollectionViewType.BOARD,T=k&&!e?"boardGroups":"collectionGroups",v=k&&e?w:E;yt(n,{[T]:v.map(j=>({...j,visible:b,emptyHidden:!b}))})},{visibleGroups:u,hiddenGroups:d,visibleSubGroups:f=[],hiddenSubGroups:h=[],withoutValidGroup:p,hasValidSubGroup:g}=i,_=(e?f:u).map(b=>b.value),x=(e?h:d).map(b=>b.value),y=e&&g||!e&&!p;return r.jsxs("div",{className:B("py-[5px]",t?"w-full":"next-modal-scroll rounded-sm w-[400px]"),children:[r.jsxs("div",{className:"text-t2 flex h-10 items-center px-4",children:[r.jsx(H,{className:"mr-1",name:lo[s],size:"middle"}),r.jsx("span",{className:"mr-2 font-medium",children:Ac[s]}),r.jsx("span",{className:"max-w-[140px]",children:e?"子分组设置":"分组设置"})]}),r.jsx(Nne,{isSubGroup:e}),y&&r.jsxs(r.Fragment,{children:[r.jsx(Rr,{className:"mx-4 my-1"}),[_,x].map((b,E)=>{if(b.length===0)return null;const w=E===0;return r.jsxs(F.Fragment,{children:[r.jsxs("div",{className:"flex h-10 items-center justify-between px-4",children:[r.jsx("span",{className:"text-t2 text-grey3",children:w?"可见分组":"隐藏分组"}),r.jsx("button",{className:B("text-t2 text-active_color",a&&"cursor-not-allowed opacity-20"),onClick:()=>c(!w),children:w?"全部隐藏":"全部显示"})]}),r.jsx(vr,{virtual:b.length>100,disabled:a||!l,items:b.map(k=>({id:k})),onChange:(k,C)=>o(n,C,e),renderItemContent:({item:k})=>r.jsx(Tne,{groupName:k.id,visible:w,isSubGroup:e,showDragButton:l})})]},E)})]})]})},YF=()=>{const e=(t,{active:n,over:s},a=!1)=>{var g;if(!s||n.id===s.id)return;let o=0,i=0;const{groups:l=[],subGroups:c=[],view:u}=(g=Zt(t))!=null?g:{},d=a?c:l,f=Xa(n.id),h=Xa(s.id);d.forEach((_,x)=>{f===_.value&&(o=x),h===_.value&&(i=x)});const p=(u==null?void 0:u.type)===m.CollectionViewType.BOARD&&!a;yt(t,{[p?"boardGroups":"collectionGroups"]:qc(d,o,i)})};return F.useCallback(e,[])},gL=({className:e,groupName:t,isSubGroup:n,before:s})=>{const a=Gi(),{viewId:o,viewType:i}=Te(),l=()=>{ce.event("bitable_record_create",{from_scene:i===m.CollectionViewType.BOARD&&!n?"kanban_header":"group_header"});const c=th({viewId:o,groupValue:n?void 0:t,subGroupValue:n?t:void 0,isNewRecord:!0});a({viewId:o,where:{before:s},propertyValues:c})};return r.jsx(Fe,{popup:"创建新页面",className:B("flex items-center pr-1 transition duration-300",e),children:r.jsx("button",{onClick:l,className:"animate-hover flex cursor-pointer items-center rounded-sm",children:r.jsx(H,{name:"IcAddBoard",size:"middle"})})})},Rne=()=>{const e=ke(),t=(n,s,a)=>{var _,x;const{view:o,collection:i,groups:l=[],subGroups:c=[],groupBy:u,subGroupBy:d}=(_=Zt(n))!=null?_:{};if(!i||!o)return;const f=a?d==null?void 0:d.property:u==null?void 0:u.property,h=a?c:l,p=a?d:u,g=(x=i.data.schema)==null?void 0:x[f!=null?f:""];!g||!p||!f||e(()=>{var C;const y=h.filter(T=>T.value!==s),b=o.type===m.CollectionViewType.BOARD&&!a;Kn(n,{format:{[`${b?"boardGroups":"collectionGroups"}`]:y}});const E=[],{blocks:w,users:k}=le();if(i.subNodes.forEach(T=>{wp({blocks:w,users:k,collectionId:i.uuid,recordId:T,groupProperty:f,groupBy:p}).includes(s)&&E.push(T)}),E.length>0&&Gs(E),g.type===m.CollectionSchemaType.SELECT||g.type===m.CollectionSchemaType.MULTI_SELECT){const T=(C=g.options)==null?void 0:C.filter(v=>v.value!==s);pe(i.uuid,{data:{schema:{...i.data.schema,[f]:{...g,options:T}}}})}})};return F.useCallback(t,[e])},MC=({groupName:e,visible:t=!0,className:n,isSubGroup:s})=>{const a=me(),{readonly:o,managerReadonly:i,isLocked:l}=Te(),c=u=>{a.dropdown({popcorn:u.currentTarget,placement:"bottom",content({onCloseModal:d}){return r.jsx(Ane,{isSubGroup:s,closeModal:d,visible:t,groupName:e})}})};return o||i||l?null:r.jsx("button",{onClick:c,className:B("animate-hover flex h-5 w-5 cursor-pointer items-center rounded-sm",n),children:r.jsx(H,{name:"IcMore",size:"middle"})})},Ane=({closeModal:e,visible:t,groupName:n,isSubGroup:s})=>{const a=AC(),{collectionId:o,viewId:i}=Te(),l=Rne(),c=pL(),u=me(),d=tF(i,Xa(n),s),f=[{type:$.OPERATION,isHidden:!Xa(n),data:{icon:"IcMenuDelete",type:0,title:"删除"}},{type:$.OPERATION,data:{icon:t?"IcMenuHide":"IcMenuShow",type:1,title:t?"隐藏":"显示"}},{type:$.LINE,isHidden:!d,data:{},disableClick:!0}];return r.jsxs("div",{className:"next-modal w-[240px] py-2",children:[r.jsx(ze,{className:"rounded-r",items:f,onItemClick:h=>{h.data.type===0&&Xa(n)&&u.warning({title:r.jsxs("p",{className:"mt-5 mb-10 w-60",children:["是否确定删除分组？",r.jsx("br",{}),"将同时删除分组内的所有记录"]}),confirmText:"删除",confirm(){l(i,n,s),e()}}),h.data.type===1&&(e(),c({viewId:i,groupName:Xa(n),visible:!t,isSubGroup:s}))}}),d&&r.jsx(Ld,{value:d.color,bgColorFn:XE,onSelect:h=>{var x;const{groupBy:p,subGroupBy:g}=(x=Zt(i))!=null?x:{},_=s?g==null?void 0:g.property:p==null?void 0:p.property;_&&a(o,_,{id:d.id,color:h})}})]})},_L=({recordIds:e,groupName:t,listeners:n,isSubGroup:s})=>{Lr();const{viewId:a,readonly:o,managerReadonly:i}=Te(),l=WF(a),c=tF(a,Xa(t)),u=Lo(a),d=Bo(a),f={color:l?pj(c==null?void 0:c.color):void 0},h={color:l?gU(c==null?void 0:c.color):void 0},p={width:Co(u,d)+10,backgroundColor:l?QE(c==null?void 0:c.color):void 0};return r.jsxs("div",{...n,"data-disable-select":!0,style:p,className:B("z-10 flex h-[50px] items-center px-[5px] pt-2.5 pb-2",s?"mr-2.5 rounded-md":"rounded-t-md",l&&"bg-grey/5",s&&"group bg-grey/5"),children:[r.jsx("div",{className:"flex items-center text-ellipsis pl-1",style:{maxWidth:"calc(100% - 100px)"},children:r.jsx(KF,{groupName:t,scene:Zg.GROUP_HEADER})}),r.jsx("span",{className:"text-t2 ml-1.5 text-grey4",style:h,children:e.length}),r.jsxs("div",{className:"hover-button ml-auto flex items-center text-grey4 opacity-0 transition-all duration-200 group-hover:opacity-100",style:f,children:[r.jsx(MC,{className:"mr-1",groupName:t}),o||i?null:r.jsx(gL,{groupName:t,before:e[0]})]})]})},Bne=(e,t)=>ae(({blocks:n})=>{var s,a;return(a=(s=n[e])==null?void 0:s.data.collectionProperties)==null?void 0:a[t]}),Lne=({progress:e=0})=>e<0?null:r.jsx("div",{className:"absolute top-0 right-0 z-10 flex justify-end w-full h-full bg-black/40",children:r.jsxs("div",{className:"flex flex-row items-center w-[63px] h-7.5 px-1.5 mr-2.5 mt-2.5 rounded-sm bg-black/75 dark:text-black",children:[r.jsx(hs,{size:"middle"}),r.jsxs("div",{className:"text-white1 text-t4",children:[e,"%"]})]})}),xL=F.memo(e=>{var l;const{uuid:t,showLoading:n=!0,src:s,...a}=e,o=Pi(t),i=(l=o==null?void 0:o.progress)!=null?l:-1;return r.jsxs(r.Fragment,{children:[n&&o&&o.status===Yn.uploading&&r.jsx(Lne,{progress:i}),r.jsx(lk,{src:s,draggable:!1,...a})]})},kn),Pne=["study","team","work","tech"],One=({blockId:e,selectImage:t,deleteCoverImage:n})=>{const[s,a]=F.useState([]),[o,i]=F.useState([]),l=Ma(),c=Kt(),[u,d]=F.useState("");F.useEffect(()=>{(async()=>{const g=await Ce.editor.getCoverImageList();a(g)})()},[]);const f=F.useMemo(()=>$n(async g=>{var x;const _=await Ce.infra.getExternalUrlList({search:g,source:"unsplash"});_&&i([{groupName:"图片来源于 Unsplash",list:((x=_.results)==null?void 0:x.map(y=>{var b,E,w,k,C,T;return{ossName:(b=y.name)!=null?b:"",author:(E=y.name)!=null?E:"",description:(w=y.name)!=null?w:"",illegal:!1,url:(k=y.raw)!=null?k:"",download:(C=y.links)==null?void 0:C.download_location,html:(T=y.html)!=null?T:""}}))||[]}])},200),[]);F.useEffect(()=>{var g;f(u||((g=Pne[Date.now()%4])!=null?g:""))},[f,u]);const h=g=>t({ossName:g,type:"click"}),p=g=>{ye.loading({key:"uploadCover",content:"上传中"}),c(Xe.HEADER_COVER_IMAGE),l({file:g,key:e,searchType:"cover",type:"file",onComplete(_){_.success&&(t({ossName:_.ossName,type:"upload",file:g}),ye.success("上传完成"),ye.closeMessage("uploadCover"))}})};return r.jsxs($d,{className:"next-modal w-[534px] overflow-y-auto",customButtons:()=>n&&r.jsxs("div",{className:"animate-hover mr-2 flex cursor-pointer items-center rounded py-1.5 px-1",onClick:n,children:[r.jsx(H,{size:"middle",name:"MIcClear"}),r.jsx("div",{className:"text-t2 text-grey3",children:"清除"})]}),children:[r.jsx(Zs,{title:"图库",children:r.jsx("div",{className:"max-h-[35vh] overflow-y-auto px-3 py-1",children:s.map(g=>{var _;return r.jsxs("div",{children:[r.jsx("div",{className:"text-grey3 text-t2 flex h-9 items-center",children:g.groupName}),r.jsx("div",{className:"flex flex-wrap",children:(_=g.list)==null?void 0:_.map((x,y)=>r.jsx(v2,{description:x.description,illegal:x.illegal,url:`${x.url}/resize,w_640/quality,q_80/`,onClick:()=>{x.illegal?ye.error("图片无法使用"):h(x.ossName)}},`${x.url}${y}`))})]},g.groupName)})})}),r.jsx(Zs,{title:"上传",children:r.jsx(y6,{tip:"建议上传宽度大于 1500 像素的图片",onSelectImage:g=>{var _;t({ossName:(_=g.ossName)!=null?_:"",type:"click"})},fileType:"cover",onUploadFile:p,style:{height:"35vh"}})}),r.jsx(Zs,{title:"链接",children:r.jsx(_k,{placeholder:"输入图片链接",onInputUrl:g=>t({type:"http",url:g})})}),r.jsx(Zs,{icon:"IcUnsplash",title:"Unsplash",children:r.jsxs("div",{className:"max-h-[35vh] overflow-y-auto px-3 py-1",children:[r.jsx("div",{className:"bg-grey8 text-t2 border-grey6 my-4 flex w-full items-center rounded-sm border",children:r.jsx("input",{spellCheck:!1,placeholder:"搜索图片...",className:"text-t2 h-7.5 placeholder-grey4 w-full flex-grow cursor-text bg-transparent px-2 align-middle text-black outline-none",value:u,onChange:g=>{const _=g.target.value.trim();d(_)}})}),o.map(g=>{var _,x;return r.jsxs("div",{children:[r.jsx("div",{className:"text-grey3 text-t2 flex h-9 items-center",children:g.groupName}),r.jsx("div",{className:"flex flex-wrap",children:((_=g.list)==null?void 0:_.length)!==0?(x=g.list)==null?void 0:x.map((y,b)=>{var E;return r.jsx(v2,{description:(E=y.description)!=null?E:"",node:r.jsx("a",{href:y.html,target:"_blank",className:"text-ellipsis text-t4 text-grey3 mt-0.5 animate-hover px-1",rel:"noreferrer",children:`by: ${y.author}`}),url:`${y.url}&w=200&q=80`,onClick:()=>{y.illegal?ye.error("图片无法使用"):(t({type:"http",url:`${y.url}&q=80&w=1920`}),y.download&&FI(y.download))}},`${y.url}${b}`)}):r.jsx("div",{className:"text-grey2 my-2",children:"无结果"})})]},g.groupName)})]})})]})},Mne=e=>{const t=F.useRef(null),{onMoveStart:n,onMove:s,onMoveEnd:a,moveContainer:o}=e,i=F.useCallback(u=>{var d,f;s==null||s({deltaX:u.clientX-(((d=t.current)==null?void 0:d.deltaX)||0),deltaY:u.clientY-(((f=t.current)==null?void 0:f.deltaY)||0)}),t.current={deltaX:u.clientX,deltaY:u.clientY}},[s]),l=F.useCallback(()=>{a==null||a(),(o!=null?o:document).removeEventListener("pointermove",i),document.removeEventListener("pointerup",l)},[i,o,a]);return{moveProps:{onPointerDown:F.useCallback(u=>{n==null||n(),u.stopPropagation(),u.preventDefault(),t.current={deltaX:u.nativeEvent.clientX,deltaY:u.nativeEvent.clientY},(o!=null?o:document).addEventListener("pointermove",i),document.addEventListener("pointerup",l)},[n,o,i,l])}}},nf=F.memo(({uuid:e,height:t,className:n,isCardCover:s,isGalleryCard:a,isVertical:o,width:i,fitImage:l,hiddenEditorButton:c,ossName:u,shareId:d})=>{var Q,Z,te,re;const f=ks(),h=_e(e,["data"],["cover","coverPos","localUrl","size"]),p=(Q=h==null?void 0:h.data.coverPos)!=null?Q:50,[g,_]=F.useState(p),x=F.useRef(g),[y,b]=F.useState(!1),E=F.useRef(null),w=F.useRef(null),k=rD(),C=(Z=Ba(w.current).height)!=null?Z:0,T=(te=Ba(E,"width").width)!=null?te:i,[v,I]=F.useState((re=h==null?void 0:h.data.localUrl)!=null?re:""),j=Ve(e),D=me(),S=ke(),R=F.useRef(""),A=F.useMemo(()=>{var Y;const ne=(Y=u!=null?u:h==null?void 0:h.data.cover)!=null?Y:"";return lj(ne)||ne},[h==null?void 0:h.data.cover,u]);let L=t!=null?t:Math.min(Math.max((k!=null?k:1024)*.3,220));(s||a)&&T&&(L=T*(o?1.5:.55)),F.useEffect(()=>{if(vd(A)){I(A);return}h!=null&&h.data.localUrl?I(h.data.localUrl):Ls.fetchImageUrl(e,A,void 0,{shareId:d}).then(ne=>{const{extName:Y}=sn(A);if(R.current=bo(ne,Y),Rd.test(Y)){let X=`${ne}&img_process=/quality,q_100/`;(a||s)&&i&&(X=`${ne}&img_process=/resize,w_${Math.floor(a?i*2*Math.ceil(window.devicePixelRatio):i*Math.ceil(window.devicePixelRatio))}/quality,q_100/`),I(bo(X,Y))}else I(bo(ne,Y))})},[A,h==null?void 0:h.data.localUrl,s,a,i,e,u,d]),F.useEffect(()=>_(p),[p]);const P=()=>{S(()=>{pe(e,{data:{coverPos:x.current}})}),b(!1)},M=()=>{_(p),b(!1)},{moveProps:U}=Mne({onMove(ne){const Y=X=>Number(Math.min(Math.max(X,-(C-L))).toFixed(2));_(X=>{let oe=Y(X-ne.deltaY/5);return oe<=0?oe=0:oe>100&&(oe=100),x.current=oe,oe})}}),V=async ne=>{let Y="";ne.imageFile&&(Y=(await zw(ne.imageFile)).url),S(()=>{pe(e,{data:{cover:ne.ossName,coverPos:50,localUrl:Y}})})},W=()=>{S(()=>{pe(e,{data:{cover:"",localUrl:void 0}})})},z=ne=>{ne.currentTarget.parentElement&&D.dropdown({modalId:Xe.HEADER_COVER_IMAGE,popcorn:ne.currentTarget.parentElement,placement:"bottom-end",offset:[75,0],content:({onCloseModal:Y})=>r.jsx(One,{blockId:e,selectImage:({ossName:X,type:oe,file:ie,url:ue})=>{if(oe==="http"){S(()=>{pe(e,{data:{cover:ue,coverPos:50}})});return}V({ossName:X,imageFile:ie}),oe==="upload"&&(f(Ae.GUIDE_FIRST_TIME_UPLOAD_COVER,We.basicList),Y())},deleteCoverImage:()=>{Y(),W()}})})};return r.jsxs("div",{className:B("bg-cover group absolute top-0 left-0 w-full overflow-hidden transition-all",n),ref:E,style:{height:L},children:[y&&r.jsx("span",{className:"tran text-t4 pointer-events-none absolute top-1/2 left-1/2 z-10 -translate-x-1/2 -translate-y-1/2 rounded-sm bg-black-base/75 px-6 py-1 text-white",children:"拖动图片以调整位置"}),v&&r.jsx("div",{ref:w,children:r.jsx(xL,{uuid:e,...y?U:{},src:v,onError:()=>{h!=null&&h.data.localUrl&&c6(h),R.current&&I(R.current)},className:B('w-full after:absolute after:top-0 after:left-0 after:h-full after:w-full after:bg-white1 after:content-[""]',y?"relative z-[1] cursor-move":"pointer-events-none",l?"object-contain":"object-cover"),style:{height:L,objectPosition:`center ${g}%`,transition:"height 0.2s"}})}),!j&&!s&&!c&&!u&&r.jsxs("div",{className:B("text-t4 absolute bottom-2.5 right-[90px] z-10 flex items-center rounded-sm bg-black-base/50 text-white opacity-0 transition-opacity",y&&"opacity-100",!y&&"group-hover:opacity-100"),children:[y&&r.jsxs(r.Fragment,{children:[r.jsx("span",{onClick:P,className:"cursor-pointer border-r border-white/10 px-2 leading-[26px] hover:opacity-50",children:"保存"}),r.jsx("span",{onClick:M,className:"cursor-pointer px-2 leading-[26px] hover:opacity-50",children:"取消"})]}),!y&&r.jsxs(r.Fragment,{children:[r.jsx("span",{onClick:z,className:"cursor-pointer border-r border-white/10 px-2 leading-[26px] hover:opacity-50",children:"更换封面"}),r.jsx("span",{onClick:()=>b(!0),className:"cursor-pointer px-2 leading-[26px] hover:opacity-50",children:"调整位置"})]})]})]})}),zi=e=>{var M,U,V,W,z,Q;const{id:t,root:n,defaultWidth:s=Da,defaultHeight:a,defaultBlockFullWidth:o,fullPageContentWidth:i,throttleMilliseconds:l=500,resizeWidth:c=!0}=e,u=ke(),d=gt(),f=_e(d,["data"],["directoryMenu"]),h=_e(t,["data"],["format","width","height","link"]),p=Ve(t),[g,_]=F.useState({width:0,height:0}),x=!((M=h==null?void 0:h.data.format)!=null&&M.width),y=F.useRef(null),b=Xr(),E=Wc(),w=f==null?void 0:f.data.directoryMenu,k=F.useRef(fs(Z=>u(()=>pe(t,{data:{format:Z}})),l)),C=ZY(),T=JY(),v=w?C:T,I=n||!y.current||!c;let j;I?j=null:j=y.current;const D=no(j,{type:"width",wait:100}),S=I?v:(U=D.width)!=null?U:0,R=F.useCallback(Z=>{if(p)return;const te=n?Z.width===v:Z.width===S,re=i&&te,ne={...(h==null?void 0:h.data.format)||{},...Z,blockPageWidth:re};n&&!w&&(ne.blockFullWidth=Z.width===T,ne.blockFullWidth&&(ne.blockPageWidth=!1)),ne.blockFullWidth&&ne.blockPageWidth&&(ne.blockFullWidth=!1),k.current(ne)},[h==null?void 0:h.data.format,S,w,i,v,T,p,n]),A=!!(i&&((V=h==null?void 0:h.data.format)!=null&&V.blockPageWidth||x&&Number(h==null?void 0:h.data.width)>=C&&!(h!=null&&h.data.link))),L=F.useMemo(()=>{var Z,te;return{defaultWidth:A?C:((Z=h==null?void 0:h.data.format)==null?void 0:Z.width)||(h==null?void 0:h.data.width)||(h!=null&&h.data.link||(h==null?void 0:h.type)===m.BlockType.FILE?void 0:C||s),blockFullWidth:o||((te=h==null?void 0:h.data.format)==null?void 0:te.blockFullWidth)}},[(W=h==null?void 0:h.data.format)==null?void 0:W.blockFullWidth,(z=h==null?void 0:h.data.format)==null?void 0:z.width,h==null?void 0:h.data.link,h==null?void 0:h.data.width,h==null?void 0:h.type,o,s,A,C]),P=F.useMemo(()=>[S,C,Da,...Bj({maxWidth:S,mode:"gradual"})],[S,C]);return{renderSize:g,onRenderSize:_,containerRef:y,changeSize:R,containerWidth:S,defaultBlockFullWidth:L.blockFullWidth,defaultWidth:L.defaultWidth,defaultHeight:((Q=h==null?void 0:h.data.format)==null?void 0:Q.height)||(h==null?void 0:h.data.height)||a,isDisable:b||E,widthBreakPoints:P,pageContentWidth:C}},XF=()=>F.useCallback(async e=>{var o;const{blocks:t}=le(),n=t[e];if(!n)return;let s,a;n.type===m.BlockType.EXTERNAL_FILE?(s=n.data.link,a=n.data.link):(a=de(n.data.segments),s=await Ls.fetchDownloadUrl(n.uuid,(o=n.data.ossName)!=null?o:"",a)),s&&Tc(s,a!=null?a:`${Date.now()}`)},[]),UC=({width:e=0,height:t=0,maxWidth:n=Da,maxHeight:s})=>(e>n&&(t=t*n/e,e=n),s&&t>s&&(t=t*s/e),{width:e,height:t}),mxe=e=>new Promise((t,n)=>{const s=document.createElement("canvas"),a=s.getContext("2d");if(a){const{width:o,height:i}=e;s.width=o,s.height=i,a.drawImage(e,0,0,o,i),s.toBlob(l=>{t(l||void 0)},"image/png",1)}}),wo=F.memo(e=>{var c,u;const t=F.useRef(null),n=_e(e.blockId,["data"],["showEmptyCaption","caption","format"]),s=Sd(),a=(u=(c=n==null?void 0:n.data.format)==null?void 0:c.isShowCaption)!=null?u:!0,o=!!(n!=null&&n.data.showEmptyCaption||de(n==null?void 0:n.data.caption))&&a,i=MR(e.blockId),l=xn();return F.useEffect(()=>{var f,h,p,g;!!(de((f=K.blocks[e.blockId])==null?void 0:f.data.caption)&&((g=(p=(h=K.blocks[e.blockId])==null?void 0:h.data.format)==null?void 0:p.isShowCaption)==null||g))&&pe(e.blockId,{data:{showEmptyCaption:!0}},!0)},[e.blockId]),F.useEffect(()=>{const d=()=>{var p;const f=l(e.blockId);if(!f)return;const h=!!de((p=K.blocks[e.blockId])==null?void 0:p.data.caption);!f.hasFocus&&!h&&pe(e.blockId,{data:{showEmptyCaption:!1}},!0)};return document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}},[l,e.blockId]),!o||!n?null:r.jsx($f,{disableSpring:s,domRef:t,className:B("cursor-text relative rounded w-full my-px flex items-center min-h-[36px] max-w-full",e.className),"data-ignore-draggable":!0,style:{...e.style,...i},children:r.jsx(Mo,{uuid:n.uuid,className:"text-t2 text-grey3 w-full",placeholder:"添加说明",segmentType:"caption",keydownOption:hQ})})}),Une=e=>{const t=n=>{var s;(s=e==null?void 0:e.onSelectPageInfo)==null||s.call(e,n)};return r.jsx(Tk,{className:"py-2.5 relative",searchType:"file",placeholder:e.placeholder||"搜索文件",onSelect:t,fileType:e.fileType})},Vne=e=>{const t=n=>{var o;const s=n.target.files;if(!s)return;const a=[];for(const i of s)a.push(i);(o=e.onSelectLocalFolder)==null||o.call(e,a)};return r.jsx("div",{className:"flex justify-center items-center h-[62px]",children:r.jsxs("label",{className:"w-[300px] h-8",children:[r.jsx("div",{className:"flex justify-center items-center rounded text-t4-medium active:opacity-50 text-align-center h-8 px-3.5 bg-active_color text-white hover:bg-active_color/90",children:e.title}),r.jsx("input",{type:"file",className:"hidden",webkitdirectory:"",mozdirectory:"",onChange:t})]})})},FL=e=>{var t;return r.jsxs($d,{className:"next-modal w-[534px] sm:w-[370px]",children:[r.jsx(Zs,{title:"上传",children:e.uploadFolder?r.jsx(Vne,{title:e.title,onSelectLocalFolder:e.onSelectFolder}):r.jsx(xk,{inputAttribute:{accept:e.inputAccept},title:e.title,onSelect:e.onSelectFile})}),!e.hideLink&&r.jsx(Zs,{title:(t=e.linkTitle)!=null?t:"链接",children:r.jsx(_k,{placeholder:e.linkPlaceHolder,onInputUrl:n=>{var s;(s=e.onSelectFile)==null||s.call(e,n)}})}),!e.hideLinkBlock&&r.jsx(Zs,{title:"引用文件",children:r.jsx(Une,{fileType:e.fileType,placeholder:e.searchLinkFilePlaceholder,onSelectPageInfo:e.onSelectPageInfo})})]})},qne=e=>{const{defaultOpenPanel:t,readonly:n,ownerBlockId:s,uuid:a,title:o="添加附件"}=e,i=sf({uuid:a,ownerBlockId:s}),l=ke();return r.jsx(uu,{className:B(n?"cursor-default":"cursor-pointer"),readonly:n,defaultOpenPanel:t,iconProp:{name:"IcUploadFile"},text:o,onClick:c=>{const u=c.currentTarget.getBoundingClientRect();l(()=>{i({getBoundingClientRect:()=>u})})}})},sf=e=>{const{uuid:t,ownerBlockId:n}=e,s=_e(n||t,["data"],["display","segments"]),a=me(),o=Hne(e),i=ke();return F.useCallback((l,c,u)=>{if(!s)return;let d,f="文件",h=!1;switch(s.data.display){case"image":d="image/*,image/heic,image/heif",f="图片";break;case"video":d=w$,f="视频";break;case"audio":d=k$,f="音频";break;default:h=!0}a.dropdown({popcorn:l,placement:c!=null?c:"bottom",offset:u!=null?u:[],content:({onCloseModal:p})=>{let g=s.data.display;if(s.data.display)["image","audio","video"].includes(s.data.display)||(g=void 0);else{const{extName:_}=up(s.data.segments);cn.image.test(_)&&(g="image"),cn.video.test(_)&&(g="video"),cn.audio.test(_)&&(g="audio")}return r.jsx(FL,{hideLink:h,linkTitle:`${f}链接`,linkPlaceHolder:`粘贴来自于网络的${f}链接`,inputAccept:d,title:`选择${f}(支持多选)`,searchLinkFilePlaceholder:`搜索${f}`,fileType:g,onSelectFile:_=>{p(),o(_)},onSelectPageInfo:_=>{_.uuid&&(i(()=>{var x;_s([s.uuid],{type:m.BlockType.REFERENCE,data:{ref:{uuid:_.uuid},display:((x=s.data.display)!=null?x:"file")==="file"?"file":g}})}),p())}})}})},[s,o,a,i])},Hne=e=>{const{uuid:t,ownerBlockId:n}=e,s=_e(n||t,["data"],["viewMode","display"]),a=ke(),o=Dz(),i=s==null?void 0:s.data.viewMode,l=F.useCallback(c=>{const u=iF(c);let d=i;return i===Vs.preview&&!u&&(d=Vs.card,ye.warning("当前格式不支持预览")),{newViewModel:d}},[i]);return F.useCallback(async c=>{if(typeof c=="string"){const d=c,f=sn(d),{newViewModel:h}=l(f.extName);a(()=>{pe(t,{type:m.BlockType.EXTERNAL_FILE,data:{link:c,viewMode:h,extName:f.extName,segments:mt(d)}})});return}const u=[n||t];c.forEach((d,f)=>{f!==0&&u.push(qe())}),o({files:c,inTransferList:!0,blockIds:u,type:"file",keys:u,onCapacitySuccess:async()=>{if(a(()=>{var f,h,p;let d=t;for(let g=1;g<c.length;g++){const _=u[g];d=Qe({uuid:_,type:s==null?void 0:s.type,data:{display:s==null?void 0:s.data.display}},{parentId:(p=(h=s==null?void 0:s.parentId)!=null?h:ls((f=s==null?void 0:s.uuid)!=null?f:""))!=null?p:"",after:d})}}),ee(Er()),s!=null&&s.data.display&&["image","video"].includes(s==null?void 0:s.data.display))for(let d=0;d<c.length;d++){const f=c[d],h=u[d];try{const p=(s==null?void 0:s.data.display)==="video"?await DS(f):await zw(f),g=sn(f.name);pe(h,{data:{segments:mt(f.name),extName:g.extName,localUrl:URL.createObjectURL(f),viewMode:l(g.extName).newViewModel,...p}},!0)}catch(p){}}},onComplete:async d=>{if(d.success){const f=d.key,h=u.indexOf(f),p=c[h];if(!p||!f)return;const g=le(),_=await mp(p),x=sn(p.name);a(()=>{pe(f,{type:m.BlockType.FILE,data:{segments:mt(p.name),ossName:d.ossName,extName:x.extName,localUrl:d.url,viewMode:l(x.extName).newViewModel,..._,size:p.size}})},{state:g})}}})},[l,n,t,o,s==null?void 0:s.uuid,s==null?void 0:s.data.display,s==null?void 0:s.type,s==null?void 0:s.parentId,a])};function $ne(e){return r.jsx(uu,{defaultOpenPanel:e.defaultOpenPanel,readonly:e.readonly,iconProp:{name:"IcUploadImage"},text:"添加图片",onClick:e.onClick,className:e.readonly?"cursor-default":"cursor-pointer"})}const Gne=()=>{const e=me();return F.useCallback(t=>{const{popcorn:n,blockId:s}=t;e.dropdown({popcorn:n,placement:"bottom-start",content:({onCloseModal:a})=>r.jsx(zne,{close:a,blockId:s})})},[e])},zne=({blockId:e,close:t})=>{const n=_e(e,["data"],["segments"]),s=(n==null?void 0:n.type)===m.BlockType.FILE,a=ke(),o=s?up(n.data.segments).name:de(n==null?void 0:n.data.segments),i=l=>{a(()=>{if(s){const c=up(n.data.segments);if(!l)return;pe(e,{data:{segments:mt(Gw(l,c.extName))}})}else pe(e,{data:{segments:mt(l)}})})};return n?r.jsx("div",{className:"next-modal flex items-center p-1 rounded-t",style:{width:"365px"},children:r.jsx(xt,{autoFocus:!0,showBorder:!1,defaultValue:o,onEnter:t,onChange:i,placeholder:Ot(n.type),className:"w-full h-8 bg-grey8"})}):null},Wne=()=>{const e=me(),t=gt();return F.useCallback((n,s)=>{const a=K.blocks[n];if(!a)return;const o=t===Kc("right"),i=jn(`[data-block-id="${n}"]`,o);i instanceof HTMLElement&&e.warning({title:r.jsx("div",{className:"w-[338px]",children:"确认取消同步?"}),content:a.type===m.BlockType.SYNC_CONTAINER?`取消后,其他${i.dataset.syncCount}个页面的同步块将无法再同步内容`:" ",confirmText:"取消同步",cancelText:"我再想想",confirm:s})},[e,t])},Kne=()=>{const e=me();return F.useCallback((t,n)=>{const s=`当前同步块有${t?"1":"多"}个页面正在同步,删除后其他同步块也将一并删除`;e.warning({title:r.jsx("div",{className:"w-[338px]",children:"确定删除吗?"}),content:s,confirmText:"全部删除",cancelText:"取消",confirm:n})},[e])},Yne=()=>{const e=F.useCallback((n,s)=>{var o;let a=(o=K.blocks[n])==null?void 0:o.data;a||(a={}),pe(n,{data:{...a,format:{contentGravity:s}}})},[]),t=F.useCallback((n,s)=>{var o;let a=(o=K.blocks[n])==null?void 0:o.data;a||(a={}),pe(n,{data:{...a,format:{captionGravity:s}}})},[]);return{alignBlock:e,alignBlockCaption:t}},nE=e=>{var d,f,h;const t=_e(e.blockIds[0],["data"],["display","format"]),n=ke(),s=gt(),{alignBlock:a,alignBlockCaption:o}=Yne(),i=(t==null?void 0:t.type)===m.BlockType.FILE&&t.data.display==="image",l=Dl((d=t==null?void 0:t.uuid)!=null?d:"",s);m.ContentGravity.LEFT,i&&!l&&m.ContentGravity.CENTER;const c=(h=(f=t==null?void 0:t.data.format)==null?void 0:f.isShowCaption)!=null?h:!0,u=F.useMemo(()=>{const p=[{type:$.OPERATION,data:{title:"左对齐",rightText:"L",onClick:()=>{var g;ce.event(e.isCaption?"caption_align":"block_align",{align_type:"left",block_name:e.isCaption?void 0:Ya((g=t==null?void 0:t.uuid)!=null?g:"")}),n(()=>{e.blockIds.forEach(_=>{e.isCaption||a(_,m.ContentGravity.LEFT),o(_,m.ContentGravity.LEFT)}),e.closeModal()})}}},{type:$.OPERATION,data:{title:"居中对齐",rightText:"C",onClick:()=>{var g;ce.event(e.isCaption?"caption_align":"block_align",{align_type:"center",block_name:e.isCaption?void 0:Ya((g=t==null?void 0:t.uuid)!=null?g:"")}),n(()=>{e.blockIds.forEach(_=>{e.isCaption||a(_,m.ContentGravity.CENTER),o(_,m.ContentGravity.CENTER)}),e.closeModal()})}}},{type:$.OPERATION,data:{title:"右对齐",rightText:"R",onClick:()=>{var g;ce.event(e.isCaption?"caption_align":"block_align",{align_type:"right",block_name:e.isCaption?void 0:Ya((g=t==null?void 0:t.uuid)!=null?g:"")}),n(()=>{e.blockIds.forEach(_=>{e.isCaption||a(_,m.ContentGravity.RIGHT),o(_,m.ContentGravity.RIGHT)}),e.closeModal()})}}}];return e.isCaption&&e.blockIds.length===1&&p.unshift({type:$.TEXT_SWITCH,data:{switch:c,title:"显示说明",onSwitch:g=>{n(()=>{var y,b,E;const _=(y=e.blockIds[0])!=null?y:"",x=(b=K.blocks[_])==null?void 0:b.data;ce.event("block_caption",{block_name:Ya((E=t==null?void 0:t.uuid)!=null?E:""),switch:g?1:0}),pe(_,{data:{...x,format:{isShowCaption:g}}})}),e.closeModal()}}},{type:$.LINE,data:{},disableClick:!0}),p},[e,t==null?void 0:t.uuid,n,o,a,c]);return r.jsx(ze,{className:Mi,items:u,keyDownPriority:Tr+1})},yL=e=>{const{onCloseModal:t,blockId:n,items:s,disabledHasRecently:a,onColorSelect:o}=e,i=_e(n,[]),{selectedBlockHistory:l,selectedBlock:c}=Ol(),u=ke();return r.jsx(vx,{disabledHasRecently:a,items:s||Dg,onColorSelect:d=>{o==null||o(d);const f=c.length?Es(c):[n];ce.event("color",{block_name:Ya(n),is_background:d.isBgColor}),u(()=>{f.forEach(h=>{pe(h,{backgroundColor:d.isBgColor?d.colorkey:"",textColor:d.isBgColor?"":d.colorkey})}),l([])}),t(),(i==null?void 0:i.type)===m.BlockType.MARK&&BF({backgroundColor:d.isBgColor?d.colorkey:"",textColor:d.isBgColor?"":d.colorkey})}})},bL=e=>{const{uuid:t}=e,n=me(),s=ke(),a=F6(),o=F.useCallback(async i=>{s(()=>{a({ownerPageId:t,files:i,spaceId:Ut(),userId:K.user.uuid,type:"file",onComplete(){},inTransferList:!0})})},[s,a,t]);return F.useCallback((i,l,c)=>{n.dropdown({popcorn:i,placement:l!=null?l:"bottom",offset:c!=null?c:[],content:({onCloseModal:u})=>r.jsx(FL,{hideLinkBlock:!0,title:"请选择一个文件夹",uploadFolder:!0,onSelectFolder:d=>{u(),o(d)}})})},[o,n])},Xne=e=>{const{blockId:t,onCloseModal:n}=e,s=ke(),[a,o]=F.useState(0),i=ae(c=>{var u;return(u=c.blocks[t])==null?void 0:u.parentId}),l=()=>{var f,h;n();const{blocks:c}=le(),u=c[(h=(f=c[t])==null?void 0:f.parentId)!=null?h:""];let d="";if((u==null?void 0:u.type)===m.BlockType.COLUMN&&(d=u.uuid),d){const p=c[d];p&&s(()=>{const g=[];for(let _=0;_<a;_++){const x=Qe({type:m.BlockType.TEXTAREA},{parentId:p.uuid});x&&g.push(x)}g.length&&(p.uuid,g.forEach(_=>{F0([_],p.uuid,"right")}))})}else{const p=[];s(()=>{for(let g=0;g<a;g++){const _=Qe({type:m.BlockType.TEXTAREA},{parentId:i!=null?i:"",after:t});_&&p.push(_)}if(p.length){let g=t;p.forEach(_=>{g=F0([_],g!=null?g:t,"right")})}})}};return r.jsxs("div",{className:"next-modal flex h-14 py-2.5 px-4 space-x-[5px] content-between",onMouseLeave:()=>{o(0)},children:[r.jsx(Fe,{popup:"一列分栏",children:r.jsx("div",{className:B("cursor-pointer w-5 h-full bg-grey5 opacity-30",{"opacity-100":a>=1}),onMouseEnter:()=>{o(1)},onClick:l})}),r.jsx(Fe,{popup:"两列分栏",children:r.jsx("div",{className:B("cursor-pointer w-5 h-full bg-grey5 opacity-30",{"opacity-100":a>=2}),onMouseEnter:()=>{o(2)},onClick:l})}),r.jsx(Fe,{popup:"三列分栏",children:r.jsx("div",{className:B("cursor-pointer w-5 h-full bg-grey5 opacity-30",{"opacity-100":a>=3}),onMouseEnter:()=>{o(3)},onClick:l})}),r.jsx(Fe,{popup:"四列分栏",children:r.jsx("div",{className:B("cursor-pointer w-5 h-full bg-grey5 opacity-30",{"opacity-100":a>=4}),onMouseEnter:()=>{o(4)},onClick:l})})]})},Qne=({onCloseModal:e,blockId:t})=>{const n=_e(t,["data"],["format"]),s=ke();if(!n)return null;const a=n.type===m.BlockType.LIST,o=i=>i.map(l=>({type:$.OPERABLE_BLOCK_TEXT,data:l}));return r.jsx(ze,{className:Yt(Mi,"w-[200px]"),items:o(a?BS:LS),onItemClick:i=>{const{value:l}=i.data;s(()=>{ck({data:{format:{[a?"listFormat":"orderListFormat"]:l}}})}),e()},keyDownPriority:Tr+1})},QF=()=>{const e=me();return F.useCallback((t,n)=>{e.warning({title:"升级「个人专业版/团队版」可体验完整功能",confirmText:"立即升级",cancelText:"取消",confirm:t,cancel:n})},[e])},EL=e=>{var y,b,E,w,k,C,T,v,I,j,D,S,R,A,L,P;const t=_e(e.blockId,["data","backgroundColor"]),n=ke(),s=me(),a=F.useRef((b=(y=t==null?void 0:t.data.format)==null?void 0:y.cardFormat)==null?void 0:b.cardCaption),o=mj(),i=di(),l=(w=(E=t==null?void 0:t.data.format)==null?void 0:E.cardFormat)==null?void 0:w.cardStyle,c=(T=(C=(k=t==null?void 0:t.data.format)==null?void 0:k.cardFormat)==null?void 0:C.showType)!=null?T:"default",u=Jne(l),d=l==="thumbnailImage"||l==="thumbnailPage",f=QF(),h=Ro(),p=(j=!!(t!=null&&t.data.cover)&&((I=(v=t==null?void 0:t.data.format)==null?void 0:v.cardFormat)==null?void 0:I.isShowCover))!=null?j:!0;let g=!1;if(l==="regular"?g=!0:p||(g=!0),!t)return null;const _=M=>`${c==="large"?"large":"small"}-card-${(M===0||M===2)&&o?"dark-":""}${M}.png`,x=[{type:$.CUSTOM_RENDER,disableCustomHoverBg:!0,render:()=>r.jsx("div",{className:"flex space-x-3 px-3 mt-4 mb-2.5",children:Array.from({length:4}).map((M,U)=>r.jsxs("div",{className:"relative",children:[r.jsx("img",{className:B("cursor-pointer hover:opacity-90 border border-transparent rounded-sm",{"border-active_color":u===U,"h-[64px]":c==="large","h-[35px]":c==="small"}),src:`https://cdn.flowus.cn/emoji/website/${_(U)}`,onClick:()=>{var W,z,Q,Z,te,re,ne,Y,X;if(U===3&&i){f(()=>{h(Vt.page_card)});return}let V="regular";switch(U){case 1:V="fill";break;case 2:V="thumbnailPage";break;case 3:V="thumbnailImage";break}n(()=>{var oe;pe(e.blockId,{data:{format:{cardFormat:{...(oe=t.data.format)==null?void 0:oe.cardFormat,cardStyle:V}}}})}),ce.event("page_card_style",{style_type:{showType:(Q=(z=(W=t==null?void 0:t.data.format)==null?void 0:W.cardFormat)==null?void 0:z.showType)!=null?Q:"default",cardStyle:V,isShowCover:(te=(Z=t==null?void 0:t.data.format)==null?void 0:Z.cardFormat)==null?void 0:te.isShowCover,isShowIcon:(ne=(re=t==null?void 0:t.data.format)==null?void 0:re.cardFormat)==null?void 0:ne.isShowIcon,cardCaption:!!((X=(Y=t==null?void 0:t.data.format)==null?void 0:Y.cardFormat)!=null&&X.cardCaption)}})}},U),U===3&&i&&r.jsx("div",{className:"flex items-center justify-center w-7 h-4 absolute right-[-4px] top-[-8px]",style:{background:"linear-gradient(89.52deg, #F3E4B5 0.34%, #E9C770 99.54%)",borderRadius:"10px 10px 10px 2px"},children:r.jsx("span",{className:"text-t4",style:{color:"#8F6C28"},children:"Pro"})})]}))})},{type:$.TEXT_SWITCH,isHidden:d,data:{title:"显示页面图标",switch:(R=(S=(D=t.data.format)==null?void 0:D.cardFormat)==null?void 0:S.isShowIcon)!=null?R:!0,onSwitch:M=>{var U,V,W,z,Q,Z,te,re,ne,Y,X,oe;n(()=>{var ie;pe(e.blockId,{data:{format:{cardFormat:{...(ie=t.data.format)==null?void 0:ie.cardFormat,isShowIcon:M}}}})}),ce.event("page_card_style",{style_type:{showType:(W=(V=(U=t==null?void 0:t.data.format)==null?void 0:U.cardFormat)==null?void 0:V.showType)!=null?W:"default",cardStyle:(Z=(Q=(z=t==null?void 0:t.data.format)==null?void 0:z.cardFormat)==null?void 0:Q.cardStyle)!=null?Z:"regular",isShowCover:(re=(te=t==null?void 0:t.data.format)==null?void 0:te.cardFormat)==null?void 0:re.isShowCover,isShowIcon:(Y=(ne=t==null?void 0:t.data.format)==null?void 0:ne.cardFormat)==null?void 0:Y.isShowIcon,cardCaption:!!((oe=(X=t==null?void 0:t.data.format)==null?void 0:X.cardFormat)!=null&&oe.cardCaption)}})}}},{type:$.TEXT_SWITCH,data:{title:"显示配图",switch:(P=(L=(A=t.data.format)==null?void 0:A.cardFormat)==null?void 0:L.isShowCover)!=null?P:!0,onSwitch:M=>{var U,V,W,z,Q,Z,te,re,ne,Y,X,oe;n(()=>{var ie;pe(e.blockId,{data:{format:{cardFormat:{...(ie=t.data.format)==null?void 0:ie.cardFormat,isShowCover:M}}}})}),ce.event("page_card_style",{style_type:{showType:(W=(V=(U=t==null?void 0:t.data.format)==null?void 0:U.cardFormat)==null?void 0:V.showType)!=null?W:"default",cardStyle:(Z=(Q=(z=t==null?void 0:t.data.format)==null?void 0:z.cardFormat)==null?void 0:Q.cardStyle)!=null?Z:"regular",isShowCover:(re=(te=t==null?void 0:t.data.format)==null?void 0:te.cardFormat)==null?void 0:re.isShowCover,isShowIcon:(Y=(ne=t==null?void 0:t.data.format)==null?void 0:ne.cardFormat)==null?void 0:Y.isShowIcon,cardCaption:!!((oe=(X=t==null?void 0:t.data.format)==null?void 0:X.cardFormat)!=null&&oe.cardCaption)}})}}},{type:$.CUSTOM_RENDER,disableCustomHoverBg:!0,render:()=>r.jsx("div",{className:B("mx-1.5 h-11 pl-2 flex justify-between items-center",{"animate-hover":g,"cursor-not-allowed":!g}),onClick:M=>{g&&s.dropdown({popcorn:M.currentTarget,content:({onCloseModal:U})=>r.jsx("div",{className:"next-modal py-1.5",children:r.jsx(Ld,{hideHeader:!0,className:"pb-2",colors:Zne,value:t.backgroundColor,selectedIcon:r.jsx(H,{name:"IcSelectedSpace",className:"text-[18px] text-white"}),onSelect:V=>{U(),n(()=>{pe(e.blockId,{backgroundColor:V,textColor:""})})},bgColorFn:Rn})})})},children:r.jsxs(Fe,{disabled:g,popup:"配图开启后无法填充卡片颜色",className:B("w-full flex justify-between items-center"),children:[r.jsx("span",{className:"text-t2",children:"卡片填充色"}),r.jsx(Lw,{disable:!g,colorkey:t.backgroundColor,desc:"",selected:!1,hover:!1,isBgColor:!0})]})})},{type:$.LINE,data:{},disableClick:!0},{type:$.OPERATION,data:{title:"自定义说明文字",onClick:M=>{var U;(U=e.onClose)==null||U.call(e),s.dropdown({popcorn:Br(M.currentTarget),closeAfterCallBack:()=>{var V,W,z,Q,Z,te,re,ne,Y,X;a.current!==void 0&&(n(()=>{var oe;pe(e.blockId,{data:{format:{cardFormat:{...(oe=t.data.format)==null?void 0:oe.cardFormat,cardCaption:a.current}}}})}),ce.event("page_card_style",{style_type:{showType:(z=(W=(V=t==null?void 0:t.data.format)==null?void 0:V.cardFormat)==null?void 0:W.showType)!=null?z:"default",cardStyle:(te=(Z=(Q=t==null?void 0:t.data.format)==null?void 0:Q.cardFormat)==null?void 0:Z.cardStyle)!=null?te:"regular",isShowCover:(ne=(re=t==null?void 0:t.data.format)==null?void 0:re.cardFormat)==null?void 0:ne.isShowCover,isShowIcon:(X=(Y=t==null?void 0:t.data.format)==null?void 0:Y.cardFormat)==null?void 0:X.isShowIcon,cardCaption:!!a.current}}))},content:({onCloseModal:V})=>{var W,z;return r.jsx(NR,{content:mt((z=(W=t.data.format)==null?void 0:W.cardFormat)==null?void 0:z.cardCaption),onTextChange:Q=>{a.current=Q},onEnter:Q=>{Q.preventDefault(),V()}})}})}},disableClick:!0}];return r.jsx("div",{className:"next-modal w-[400px] pb-1",children:r.jsx(ze,{items:x,className:"w-full mt-1"})})},Jne=e=>{let t=0;return e==="fill"?t=1:e==="thumbnailPage"?t=2:e==="thumbnailImage"&&(t=3),t},Zne=_p.items.map(e=>({key:e.colorkey,name:e.desc})),ese=()=>{const e=ke(),t=n=>{const s=le(),{blocks:a,collectionViews:o,users:i}=s,l=a[n];l&&e(()=>{var c,u,d,f,h,p,g,_,x,y;if(l.type===m.BlockType.TABLE){const{tableBlockColumnOrder:b,tableBlockRowHeader:E}=(c=l==null?void 0:l.data.format)!=null?c:{};if(!b)return;const w=l.subNodes[0];if(!w)return;const k=a[w];if(!k)return;const C={},T=[];b.forEach((I,j)=>{var S;let D="";if(E){const R=(S=k.data.collectionProperties)==null?void 0:S[I];D=de(R)}j===0?C.title={name:D||"标题",type:m.CollectionSchemaType.TITLE}:C[I]={name:Ko(C,D||void 0),type:m.CollectionSchemaType.TEXT},T.push({property:j===0?"title":I,visible:!0})});const v=E?l.subNodes.slice(1):l.subNodes;pe(n,{data:{schema:C},type:m.BlockType.COLLECTION_VIEW}),E&&Gs(w),v.forEach(I=>{var D,S,R;const j=a[I];j&&pe(I,{type:m.BlockType.PAGE,data:{segments:(R=(S=j==null?void 0:j.data.collectionProperties)==null?void 0:S[(D=b[0])!=null?D:""])!=null?R:[]}})}),Ka({title:"默认视图",format:{tableProperties:T,tableWrap:!0},pageSort:v,type:m.CollectionViewType.TABLE},{parentId:n})}if(l.type===m.BlockType.COLLECTION_VIEW){const b=(d=(u=l.views)!=null?u:[])==null?void 0:d.find(j=>{var D;return((D=o[j])==null?void 0:D.type)===m.CollectionViewType.TABLE}),E=o[b!=null?b:""];if(!E||!b)return;const w=qe(),k=(h=(f=E.format.tableProperties)==null?void 0:f.map(({property:j})=>j==="title"?w:j))!=null?h:[];l.subNodes.forEach(j=>{var S;const D=a[j];D&&pe(j,{type:m.BlockType.TABLE_ROW,data:{collectionProperties:{...D.data.collectionProperties,[w]:(S=D.data.segments)!=null?S:[]}}})});let T=JA({state:s,collectionId:l.uuid,records:l.subNodes.map(j=>a[j]).filter(j=>!!j),tableSchema:(p=l.data.schema)!=null?p:{},users:i,sorters:E.format.sorters,sort:E.pageSort}).map(j=>j.uuid);const v=vF({blocks:a,collectionViews:o,users:i,viewId:b,sortedRecordIds:T});v&&!v.withoutValidGroup&&(T=((_=(g=v.groups)==null?void 0:g.map(D=>D.recordIds))!=null?_:[]).flat()),pe(n,{subNodes:T,data:{format:{tableBlockColumnOrder:k,tableBlockRowHeader:!0}},type:m.BlockType.TABLE});const I={};(y=(x=E.format.tableProperties)!=null?x:[])==null||y.forEach(({property:j})=>{var D,S;I[j==="title"?w:j]=mt((S=(D=l.data.schema)==null?void 0:D[j])==null?void 0:S.name)}),Qe({data:{collectionProperties:I},type:m.BlockType.TABLE_ROW},{first:!0,parentId:n}),M6(b)}})};return F.useCallback(t,[e])},tse=()=>{const e=me(),t=gt();return F.useCallback(n=>{e.warning({title:n?"当前客户端版本过小":"达文件数量/大小处理上限",content:n?"请到官网下载最新1.1.5版本":"请下载/打开客户端",cancelText:"取消",confirmText:n?"去下载":"下载/打开客户端",colorType:"active",confirm:()=>{n||(window.location.href=`flowus://flowus.cn/${t}`),setTimeout(()=>{window.location.href="https://flowus.cn/download"},3e3)}})},[e,t])},rf=()=>{const e=me(),t=Ro(),n=XF(),s=tse(),a=LC();return async o=>{var c,u,d;o=o.filter(f=>{const h=K.blocks[f];return h?!![m.BlockType.FOLDER,m.BlockType.FILE,m.BlockType.EXTERNAL_FILE].includes(h.type):!1});const i=o[0];if(!i){ye.error("没有可下载的内容");return}if(o.length===1&&((c=K.blocks[i])==null?void 0:c.type)!==m.BlockType.FOLDER){n(i);return}const l=(d=(u=K.blocks[i!=null?i:""])==null?void 0:u.spaceId)!=null?d:Tn().uuid;if(s6(l)){if(ht()){ye.warning("批量下载仅面向个人专业版/团队版空间,你可联系空间所有者进行升级");return}e.warning({maxWidth:360,title:"批量下载仅面向个人专业版/团队版空间",content:`当前空间为${cr(Lm(l).planType)}`,confirm:()=>t(Vt.bulk_download),colorType:"active",confirmText:"立即升级",cancelText:"暂不考虑"})}else{if(!K.user.uuid){ye.warning("批量下载需要先登陆");const f=nh(Rt.login,[{key:ms.callbackPath,value:location.pathname},{key:ms.quickRegister,value:"true"}]);setTimeout(()=>{Bs(`${dd()}${f}`)},2500);return}if(un){const f=Qa(a);if(!a||f<115){s(!0);return}const p=(await Ce.editor.blocksOssFileBatch({userId:K.user.uuid,spaceId:l,blockIds:o})).blocks.flatMap(x=>x.id==null||x.ossName==null||x.title==null?[]:[{blockId:x.id,ossName:x.ossName,fileName:x.title}]),g=await Ce.infra.createUrls({batch:p}),_=p.map((x,y)=>({...x,url:g[y].url}));await Bk.downloadMany({id:qe(),list:_})}else{const{modalId:f}=e.loading({title:"文件打包中"}),h=await Ce.editor.filesDownloadBlocksOssZip.raw({userId:K.user.uuid,spaceId:l,blockIds:o});if(h.code===200){const p=h.data;Tc(p.url,p.name),ye.success("打包成功"),e.closeModal(f);return}if(h.code===3223){s(!1),e.closeModal(f);return}ye.success("失败"),e.closeModal(f)}}}},nse=e=>{var s,a;const t=HS(e);let n=K.blocks[e];n&&(n.type===m.BlockType.SYNC_REFERENCE&&(n=K.blocks[(a=(s=n.data.ref)==null?void 0:s.uuid)!=null?a:""]),n&&(Ri(n.subNodes,{parentId:n.parentId,after:t,first:!t}),Gs(e)))},sse=async(e,t)=>{var s,a;let n=K.blocks[e];if(n&&n.type===m.BlockType.SYNC_REFERENCE){if(n=K.blocks[(a=(s=n.data.ref)==null?void 0:s.uuid)!=null?a:""],!n)return;await t(kd(n.subNodes,void 0,e),e),Gs(e)}},wL=()=>{const e=Oee(),t=Gi(),n=On(),s=ke(),{selectedBlockHistory:a}=Ol();return(o,i)=>{var p;const{isOpenMenuList:l=!0,newBlock:c,syncId:u,pos:d="after"}=i||{},f=K.blocks[o],h=f&&Wr((p=K.blocks[f.parentId])==null?void 0:p.type);if(f){if(f.type===m.BlockType.TEXTAREA&&xc(f.data)&&!c){ce.event("block_add"),xs(100).then(()=>e(f.uuid,{isOpenMenuList:l,syncId:u})),a([]);return}if(h){const g=jn(`[data-block-id="${o}"]`,n),{viewId:_,groupValue:x}=g.dataset;if(_){const y=d==="after",b=th({viewId:_,groupValue:x});t({viewId:_,where:y?{after:f.uuid}:{before:f.uuid},propertyValues:b}),a([])}return}s(()=>{const g=Qe({},{parentId:f.parentId,[d]:f.uuid});g&&(ce.event("block_add"),xs(100).then(()=>e(g,{isOpenMenuList:l,syncId:u})),a([]))})}}},kL=()=>{const e=wL();return t=>{const{pos:n}=t||{},s=n==="before"?Sa(K.ui.selectedBlocks):pn(K.ui.selectedBlocks);s&&(ce.event(n==="before"?"insert_up":"insert_below",{block_name:Ya(s.blockId)}),e(s.blockId,{newBlock:!0,pos:n,syncId:s.syncId}))}},rse=e=>{const t=_e(e,["subNodes"]);return t&&t.subNodes.length>0&&[m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.TODO].includes(t.type)},CL=({popcorn:e,blockId:t,collectionId:n,selectedBlocks:s})=>{const a=JB(n),o=zs(),i=me(),l=Kt(),c=ae(({blocks:f})=>{var h,p;return Object.entries((p=(h=f[n])==null?void 0:h.data.schema)!=null?p:{}).map(([g,_])=>({..._,propertyId:g}))}),u=(f,h,p)=>{var y,b,E;const g=Es(s),_=s[0],x=g[0];if(!(!x||!_))if(h===m.CollectionSchemaType.CHECKBOX){const{blocks:w}=K,k=(b=(y=w[x])==null?void 0:y.data.collectionProperties)==null?void 0:b[f];o(g,f,de(k).toUpperCase()==="YES"?"NO":"YES")}else if(h===m.CollectionSchemaType.ROLLUP)a(p,f,(E=_.viewId)!=null?E:"",e);else{const w={};(h===m.CollectionSchemaType.TEXT||h===m.CollectionSchemaType.TITLE||h===m.CollectionSchemaType.NUMBER||h===m.CollectionSchemaType.EMAIL||h===m.CollectionSchemaType.URL||h===m.CollectionSchemaType.PHONE)&&(w.width=250,w.minHeight=36),(h===m.CollectionSchemaType.SELECT||h===m.CollectionSchemaType.MULTI_SELECT)&&(w.minWidth=250,w.maxWidth=320,w.minHeight=36),ee(nt.update({selectedBlocks:[]})),i.dropdown({popcorn:e,placement:"right",content:({onCloseModal:T})=>r.jsx("div",{className:"next-modal",style:w,children:r.jsx(XB,{site:Me.CELL,recordIds:g,viewId:_.viewId,recordId:x,propertyId:f,onUpdate:()=>{},onClose:T})})})}},d=[];return c.forEach(f=>{im.includes(f.type)||d.push({type:$.OPERATION,data:{propertyId:f.propertyId,title:f.name,schemaType:f.type,icon:an[f.type]}})}),r.jsx(ze,{className:"next-modal-scroll w-[200px] py-[6px]",items:d,onItemClick:(f,h,p)=>{const{propertyId:g,schemaType:_}=f.data;l(t),u(g,_,p)}})},ase=e=>{var Ne,De,Se,Ie,Ke,dt,$e,ut,Ee,Ge,Je,et,$t;const{onCloseModal:t,blockId:n,popcorn:s,focusEditableAt:a,viewId:o,syncId:i}=e,l=_e(n,["views","updatedBy","updatedAt","data"]),c=(De=(Ne=l==null?void 0:l.data.ref)==null?void 0:Ne.uuid)!=null?De:n,u=(l==null?void 0:l.type)===m.BlockType.FILE,d=Yr((Se=l==null?void 0:l.updatedBy)!=null?Se:""),f=ke(),h=Ug(),p=rf(),g=Qd(),_=Gne(),x=sf({uuid:n}),y=bL({uuid:n}),{selectedBlockHistory:b,selectedBlock:E}=Ol(),w=mu(),k=ht(),C=pg(),T=Wne(),v=ese(),I=tf(),j=kL(),D=Kne(),S=Cs(),R=lu(),A=ks(),{illegal:L,role:P}=it(n);if(!l)return null;const M=()=>{const tt=s.getBoundingClientRect();u?x(s,"bottom",[0,-tt.height/2]):y(s,"bottom",[0,-tt.height/2])},{blocks:U,collectionViews:V}=K,W=tt=>E.every(Ze=>{var It;const jt=U[Ze.blockId];return!jt||Wr((It=U[jt.parentId])==null?void 0:It.type)?!1:tt.includes(jt.type)}),z=_G(E),Q=E.filter(tt=>{const Ze=K.blocks[tt.blockId];return nm(Ze)}).map(tt=>tt.blockId),Z=E.every(tt=>{const{role:Ze,isRestricted:jt}=hn(tt.blockId);return jt?Ze===m.PermissionRole.EDITOR:Ze===m.PermissionRole.EDITOR||Ze===m.PermissionRole.WRITER}),te=()=>{if(l.type!==m.BlockType.LIST&&l.type!==m.BlockType.ORDER_LIST)return!1;const tt=U[l.parentId];if(!tt)return!1;const{subNodes:Ze}=tt,jt=Ze.indexOf(l.uuid);if(jt===0)return!0;if(jt>0){const It=Ze[jt-1],nn=U[It];return nn?l.type===m.BlockType.LIST&&nn.type!==m.BlockType.LIST||l.type===m.BlockType.ORDER_LIST&&nn.type!==m.BlockType.ORDER_LIST:!1}return!1},re=()=>{var tt,Ze,jt;if(l.type===m.BlockType.TABLE)return!0;if(l.type===m.BlockType.COLLECTION_VIEW){const{collectionViews:It}=K,nn=(tt=l.views)==null?void 0:tt.filter(J=>!!It[J]);if(!nn||nn.length>1||((jt=It[(Ze=nn[0])!=null?Ze:""])==null?void 0:jt.type)!==m.CollectionViewType.TABLE)return!1;const N=l.data.schema;if(!N)return!1;const O=new Set([m.CollectionSchemaType.RELATION,m.CollectionSchemaType.ROLLUP,m.CollectionSchemaType.FORMULA,m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.UPDATED_AT,m.CollectionSchemaType.CREATED_BY,m.CollectionSchemaType.UPDATED_BY,m.CollectionSchemaType.FILE]);return!Object.values(N).find(({type:J})=>O.has(J))}},ne=pG(l.type),Y=Wr((Ie=U[l.parentId])==null?void 0:Ie.type);let X=!0;if(Y){const tt=V[o!=null?o:""];tt&&(tt.type===m.CollectionViewType.TIMELINE&&((Ke=tt.format.timelineColorSetting)==null?void 0:Ke.type)===m.CardColorSource.CUSTOM||tt.type===m.CollectionViewType.CALENDAR&&((dt=tt.format.calendarColorSetting)==null?void 0:dt.type)===m.CardColorSource.CUSTOM)&&(X=!1)}const oe=u&&l.data.display==="image",ie=tt=>{var jt,It;const Ze=(It=(jt=l.data.segments)==null?void 0:jt.map(nn=>nn.type))!=null?It:[];return tt.some(nn=>Ze.includes(nn))},ue={ai:!Qk.has(l.type)||!g||ie([m.TextType.LINK_PAGE]),isRefBlock:l.type===m.BlockType.REFERENCE&&(l.data.display==="audio"||l.data.display==="video"||l.data.display==="image"),copyCutDelete:!1,tableConvert:!re(),turn:!W(Yw)||!Z||L,insert:!Z||!!(o&&(($e=K.collectionViews[o])==null?void 0:$e.type)===m.CollectionViewType.CALENDAR),turnInner:K.ui.selectedBlocks.length>1||l.type!==m.BlockType.COLLECTION_VIEW_PAGE&&l.type!==m.BlockType.REFERENCE_COLLECTION_PAGE&&l.type!==m.BlockType.MIND_MAPPING_PAGE,turnToPage:![m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.MIND_MAPPING].includes(l.type),color:!W([...Kw,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.BOOKMARK])||L||xo(l.type)||[m.BlockType.CODE].includes(l.type),down:!([m.BlockType.FILE,m.BlockType.EXTERNAL_FILE].includes(l.type)&&(l.data.ossName||l.data.link)||l.type===m.BlockType.FOLDER)&&!L,replace:![m.BlockType.FILE].includes(l.type)||!l.data.ossName||L,rename:![m.BlockType.FILE,m.BlockType.FOLDER].includes(l.type)||m.BlockType.FILE===l.type&&!l.data.ossName||L,copy:L||!Fs(hn(l.parentId).role,m.PermissionRole.WRITER),formatList:!te(),move:!Z,wordWrap:!nG(l)||![m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(hn(l.parentId).role),caption:!nm(l),updatedBy:![m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(P)&&!k,template:m.BlockType.TEMPLATE!==l.type,unSync:K.ui.selectedBlocks.length>1||!ne||hn(l.uuid).role!==m.PermissionRole.EDITOR,editProperty:!Y,recordColor:X,comment:K.ui.selectedBlocks.length>1||!fg(l)||Y||!Fs(hn(l.uuid).role,m.PermissionRole.COMMENTER),isPageBlock:Xt(l.type)||ki(l)||B1(l),copyPageLink:!Xt(l.type)&&!ki(l)&&!B1(l),changeToDoc:!xo(l.type)||K.ui.selectedBlocks.length>1,contentAlignStyle:z.length!==K.ui.selectedBlocks.length,captionAlignStyle:Q.length!==K.ui.selectedBlocks.length,pageFormat:K.ui.selectedBlocks.length!==1||l.type!==m.BlockType.PAGE&&!(l.type===m.BlockType.REFERENCE&&l.data.display==="linkPage")||((Ee=(ut=l.data.format)==null?void 0:ut.cardFormat)==null?void 0:Ee.showType)==="default"||((Je=(Ge=l.data.format)==null?void 0:Ge.cardFormat)==null?void 0:Je.showType)===void 0,insertColumn:!Z||Y};Fs(P,m.PermissionRole.WRITER)||Object.keys(ue).forEach(tt=>{tt==="copy"||tt==="comment"||(ue[tt]=!0)});const ge=[{type:$.BLOCK_TRANSFORM,isHidden:!ue.isRefBlock,render:()=>{var jt,It,nn,N,O,G,J,se;let tt=(N=(nn=U[(It=(jt=l.data.ref)==null?void 0:jt.uuid)!=null?It:""])==null?void 0:nn.parentId)!=null?N:"",Ze=0;for(;((O=U[tt])==null?void 0:O.type)!==m.BlockType.PAGE&&((G=U[tt])==null?void 0:G.type)!==m.BlockType.FILE&&Ze<100;)Ze++,tt=(se=(J=U[tt])==null?void 0:J.parentId)!=null?se:"";return r.jsxs("div",{className:"rounded w-full pl-3 pr-2",children:[r.jsx("div",{className:"text-grey4 text-t4 ml-1 my-2",children:"引用源"}),r.jsx(Aa,{uuid:tt,interactable:!0,showUnderLine:!1,className:"flex items-center text-black text-t2 break-all mb-2 line-clamp-1 active-bg animate-hover w-full"})]})}},{isHidden:!ue.isRefBlock,type:$.LINE,data:{},disableClick:!0},{type:$.OPERATION,isHidden:!ue.isPageBlock,data:{type:Oe.OPEN_RIGHT_PAGE,icon:"IcOpenRight",title:"在侧边栏中打开"}},{type:$.OPERATION,isHidden:ue.ai,data:{type:Oe.AI_EDITOR,icon:"IcAi",title:"AI 辅助",rightText:`${Gt}+J`}},{type:$.OPERATION,isHidden:ue.copyCutDelete,data:{type:Oe.COPY_CLIPBOARD,icon:"IcMenuCopy",title:"复制",rightText:`${Gt}+C`}},{type:$.OPERATION,isHidden:ue.copyCutDelete,data:{type:Oe.CUT,icon:"IcMenuCut",title:"剪切",rightText:`${Gt}+X`}},{type:$.OPERATION,isHidden:ue.copyCutDelete,data:{type:Oe.DELETE,icon:"IcMenuDelete",title:"删除",rightText:"Del"}},{type:$.OPERATION,isHidden:ue.copy,data:{type:Oe.COPY,icon:"IcMenuDuplicate",title:"拷贝副本",rightText:`${Gt}+D`}},{type:$.OPERATION,isHidden:ue.copy,data:{type:Oe.COPY_MOVE,icon:"IcMenuCopyToPage",title:"拷贝副本至页面"}},{type:$.OPERATION,isHidden:ue.template,data:{type:Oe.TEMPLATE,icon:"MIcListSeetings",title:"设置模板按钮",onClick:()=>{Po(n,!0,!1),ee(nt.updateSelectBlocks([])),a(n,de(l.data.segments).length)}}},{type:$.OPERATION,isHidden:ue.turnToPage,data:{type:Oe.TURN_TO_PAGE,icon:"IcMenuTurnInto",title:"转换为页面"}},{type:$.OPERATION,isHidden:ue.changeToDoc,data:{icon:"IcMenuTurnInto",title:"转换为页面内容",onClick:()=>{f(()=>{var Ze,jt,It;const tt=(It=(jt=(Ze=l.data.format)==null?void 0:Ze.mindMappingFormat)==null?void 0:jt.oldBlockType)!=null?It:m.BlockType.TEXTAREA;_s([l.uuid],{type:tt})}),ce.event("turninto_page_content")}}},{type:$.OPERATION,isHidden:ue.tableConvert,data:{type:Oe.TABLE_CONVERT,icon:"IcMenuTurnInto",title:l.type===m.BlockType.TABLE?"转换为多维表":"转换为简单表格"}},{type:$.OPERATION,isHidden:ue.turnInner,data:{type:Oe.TURN_TO_EMBED,icon:"IcMenuTurnInto",title:"转换为嵌入"}},{type:$.OPERATION,isHidden:ue.rename,data:{type:Oe.RENAME,icon:"IcMenuRename",title:"重命名"}},{type:$.OPERATION,isHidden:ue.turn,data:{icon:"IcMenuTurnInto",title:"转换为",hasArrow:!0,renderSubMenu:()=>r.jsx(DC,{...e})}},{type:$.OPERATION,isHidden:ue.isPageBlock,data:{icon:"IcUrl",title:"拷贝块访问链接",onClick:()=>{const tt=i?"?s=t":"",Ze=ls(l.uuid);on(`${Sn()}/${Ze}${tt}#${l.uuid}`)},rightText:"F"}},{type:$.OPERATION,isHidden:ue.copyPageLink,data:{icon:"IcUrl",title:"拷贝页面访问链接",onClick:()=>{var jt;const Ze=ki(l)?(jt=Vd(n))==null?void 0:jt.uuid:n;ce.event("copy_page_link"),on(`${Sn()}/${Ze}`)},rightText:"F"}},{isHidden:ue.move,type:$.LINE,data:{},disableClick:!0},{type:$.OPERATION,isHidden:ue.down,data:{icon:"IcMenuDownload",title:"下载",onClick:()=>p(Es(K.ui.selectedBlocks))}},{type:$.OPERATION,isHidden:ue.replace,data:{icon:"IcMenuReplace",title:"替换",onClick:M}},{type:$.OPERATION,isHidden:ue.unSync,data:{icon:"IcMenuUnsync",title:l.type===m.BlockType.SYNC_REFERENCE?"取消同步":"取消全部同步",onClick:()=>{const tt=qT(kd(n),!0),Ze=()=>{C(async()=>{l.type===m.BlockType.SYNC_CONTAINER?nse(n):await sse(n,h)})};tt?T(n,Ze):Ze()}}},{type:$.OPERATION,isHidden:ue.editProperty,data:{icon:"IcEditProperty",title:"编辑属性",hasArrow:!0,renderSubMenu:()=>r.jsx(CL,{popcorn:s,blockId:l.uuid,collectionId:l.parentId,selectedBlocks:K.ui.selectedBlocks})}},{type:$.OPERATION,isHidden:ue.recordColor,data:{icon:"IcMenuColor",title:"颜色",hasArrow:!0,renderSubMenu:()=>r.jsx("div",{className:"next-modal py-1.5",children:r.jsx(Ld,{value:l.data.collectionCardColor,onSelect:tt=>{o&&f(()=>{pe(l.uuid,{data:{collectionCardColor:tt}})})}})})}},{type:$.OPERATION,isHidden:ue.move,data:{icon:"IcMenuMove",title:"移动到",rightText:`${Gt}+Shift+P`,onClick:()=>{ce.event("moveto_blockmenu_click",{block_name:Ya(n)}),w({popcorn:s,uuid:n,placement:"left",offset:[0,20]})}}},{isHidden:ue.color,type:$.LINE,data:{},disableClick:!0},{type:$.OPERATION,isHidden:ue.color,data:{icon:"IcMenuColor",title:"颜色",hasArrow:!0,renderSubMenu:()=>r.jsx(yL,{blockId:n,onCloseModal:t})}},{type:$.OPERATION,isHidden:ue.pageFormat,data:{icon:"IcMenuPageStyle",title:"样式设置",hasArrow:!0,renderSubMenu:()=>r.jsx(EL,{blockId:l.uuid,onClose:t})}},{type:$.OPERATION,isHidden:ue.contentAlignStyle,data:{icon:"IcAlignLeft",title:"对齐方式",hasArrow:!0,renderSubMenu:()=>r.jsx(nE,{blockIds:z,closeModal:t})}},{isHidden:ue.color||ue.contentAlignStyle,type:$.LINE,data:{},disableClick:!0},{type:$.OPERATION,isHidden:ue.caption,data:{icon:"IcMenuListDescription",title:"添加说明",onClick:()=>{ee(nt.updateSelectBlocks([])),pe(n,{data:{showEmptyCaption:!0,format:{isShowCaption:!0}}}),l.type===m.BlockType.FILE&&l.data.display==="image"&&A(Ae.CREATE_IMAGE_BLOCK,We.basicList,{step2:!0}),a(n,0,"caption"),ce.event("block_caption",{block_name:Ya(n)})}}},{type:$.OPERATION,isHidden:ue.captionAlignStyle,data:{icon:"IcMenuListDescriptionSetting",title:"说明设置",hasArrow:!0,renderSubMenu:()=>r.jsx(nE,{blockIds:Q,isCaption:!0,closeModal:t})}},{type:$.OPERATION,isHidden:ue.comment,data:{icon:"IcMenuComment",title:"添加评论",rightText:`${Gt}+Shift+M`,onClick:()=>{I({blockId:n})}}},{type:$.TEXT_SWITCH,isHidden:ue.wordWrap,data:{title:"自动换行",switch:($t=(et=l.data.format)==null?void 0:et.codeWrap)!=null?$t:!1,onSwitch:()=>{f(()=>{var tt,Ze;pe(n,{data:{format:{codeWrap:!((Ze=(tt=l.data.format)==null?void 0:tt.codeWrap)!=null&&Ze)}}})})}}},{isHidden:ue.formatList,type:$.LINE,data:{},disableClick:!0},{type:$.OPERATION,isHidden:ue.formatList,data:{icon:"IcMenuListFormat",title:"标记格式设置",hasArrow:!0,renderSubMenu:()=>r.jsx(Qne,{blockId:n,onCloseModal:t})}},{type:$.LINE,data:{},disableClick:!0,isHidden:ue.insert},{type:$.OPERATION,isHidden:ue.insert,data:{icon:"IcMenuInsertUp",title:"在上方插入块",rightText:"A",onClick:()=>{j({pos:"before"})}}},{type:$.OPERATION,isHidden:ue.insert,data:{icon:"IcMenuInsertDown",title:"在下方插入块",rightText:"B",onClick:()=>{j({pos:"after"})}}},{type:$.OPERATION,isHidden:ue.insertColumn,data:{icon:"IcMenuBlockRightColumns",title:"向右方添加分栏",hasArrow:!0,renderSubMenu:()=>r.jsx(Xne,{blockId:n,onCloseModal:t})}},{isHidden:ue.updatedBy,type:$.LINE,data:{},disableClick:!0}];return ose(ge),r.jsx(ze,{className:Mi,items:ge,customFooter:!ue.updatedBy&&r.jsx(Km,{className:"!py-2",name:d,updatedAt:l.updatedAt}),onItemClick:async tt=>{var Ze,jt,It,nn;if(!tt.data.hasArrow){t();const{type:N}=tt.data,O=E.length?E:kd(n,o,i);switch(N){case Oe.CUT:{document.execCommand("cut");break}case Oe.COPY_CLIPBOARD:{document.execCommand("copy");break}case Oe.DELETE:{const G=qT(O);if(G){D(G.onlyOne,async()=>{l.type===m.BlockType.SYNC_CONTAINER&&f(()=>{Gs(Es(O)),b([])})});return}const J=ls(n);if(xo((Ze=K.blocks[J!=null?J:""])==null?void 0:Ze.type)&&oe){f(()=>{_s([n],{type:m.BlockType.TEXTAREA,data:{segments:l.data.caption}})});return}ce.event("delete",{block_name:Ya(n)}),f(()=>{Gs(Es(O)),b([])});break}case Oe.COPY:{ce.event("duplicate",{block_name:Ya(n)}),h(O,void 0,i);break}case Oe.COPY_MOVE:{w({popcorn:s,uuid:n,placement:"left",offset:[0,20],placeholder:"搜索拷贝到...的页面",copyAndMove:{syncId:i,viewId:o}});break}case Oe.TABLE_CONVERT:{v(n);break}case Oe.TURN_TO_EMBED:{switch(l.type){case m.BlockType.COLLECTION_VIEW_PAGE:Ce.editor.getDoc(n).then(G=>{ee(Gn.update({blocks:G.blocks})),ee(Am.update(G.collectionViews)),f(()=>{pe(n,{type:m.BlockType.COLLECTION_VIEW})})});break;case m.BlockType.REFERENCE_COLLECTION_PAGE:{f(()=>{pe(n,{type:m.BlockType.REFERENCE_COLLECTION})});break}case m.BlockType.MIND_MAPPING_PAGE:{f(()=>{pe(n,{type:m.BlockType.MIND_MAPPING})});break}}break}case Oe.TURN_TO_PAGE:{let G=m.BlockType.PAGE;switch(l.type){case m.BlockType.COLLECTION_VIEW:G=m.BlockType.COLLECTION_VIEW_PAGE;break;case m.BlockType.REFERENCE_COLLECTION:G=m.BlockType.REFERENCE_COLLECTION_PAGE;break;case m.BlockType.MIND_MAPPING:G=m.BlockType.MIND_MAPPING_PAGE;break}f(()=>{pe(n,{type:G})}),ce.event("turninto_page",{block_type:l.type});break}case Oe.RENAME:{_({popcorn:s,blockId:n});break}case Oe.OPEN_RIGHT_PAGE:{S(c,{forceOpenInRight:!0});break}case Oe.AI_EDITOR:{let G=0;const J=(It=(jt=U[l.parentId])==null?void 0:jt.subNodes)!=null?It:[];K.ui.selectedBlocks.forEach(({blockId:Be})=>{G=Math.max(J.indexOf(Be),G)});const se=(nn=J[G])!=null?nn:n;let xe=document.querySelector(`[data-block-id="${se}"]`);if(xe||(xe=document.querySelector(`[data-block-id="${n}"]`)),!xe)return;R({blockId:n,popcorn:xe,editorScene:ct.BlockSelected,from:Ll.BlockMenu});break}}}}})},ose=e=>{let t=-1,n=-1;for(const s of e)s.isHidden||n++,t!==-1&&(s==null?void 0:s.type)===$.LINE&&t+1===n&&(s.isHidden=!0),!s.isHidden&&s.type===$.LINE&&(t=n)},e_=()=>{const e=F.useContext(xl),t=jg(),n=me();return F.useCallback(s=>{const{blockId:a,menuPosition:o,blockNode:i,noSelect:l,offset:c=[0,22]}=s,u=Br(o||i),{blocks:d}=K,f=d[a],p=(f==null?void 0:f.type)===m.BlockType.COLLECTION_VIEW||(f==null?void 0:f.type)===m.BlockType.REFERENCE_COLLECTION?"left-start":"left",{syncId:g,viewId:_}=i.dataset,x=_ee(i)||Si(a,void 0,g),y=(E,w,k,C)=>{var v;if(!E)return;K.blocks[E];const T=Si(E,void 0,(v=C==null?void 0:C.syncId)!=null?v:g);yF(T,w,k)};n.dropdown({modalId:a,popcorn:u,placement:p,offset:c,modifiers:[{name:"flip",options:{fallbackPlacements:[p,"right"]}}],closeBeforeCallBack:t,content:({onCloseModal:E})=>r.jsx(xl.Provider,{value:e,children:r.jsx(ase,{focusEditableAt:y,blockId:a,syncId:g,viewId:_,editorKey:x,popcorn:u,onCloseModal:E})})});const{selectedBlocks:b}=K.ui;if(!l){const{viewId:E,groupValue:w,syncId:k}=i.dataset;b.find(C=>C.blockId===a&&C.viewId===E?!C.groupValues||!w?!0:Object.keys(C.groupValues).includes(w):!1)||ee(nt.updateSelectBlocks([{blockId:a,viewId:E,syncId:k,groupValues:w?{[w]:[]}:void 0}])),Ye({$focusedInSyncBlockId:""})}Ye({$blockMenuListId:a})},[t,n,e])},TL=e=>{const t=e_(),n=me();return r.jsxs("div",{className:B("flex bg-black/75 rounded-sm z-20 self-end mt-2.5 mr-2.5 absolute right-0 top-0 opacity-0 group-hover:opacity-100",{"cursor-pointer":!e.externalLink}),children:[e.showAlign&&r.jsx("div",{className:"flex justify-center items-center w-[26px] h-[26px] cursor-pointer",onClick:s=>{ee(nt.updateSelectBlocks([{blockId:e.blockId}])),n.dropdown({placement:"top",popcorn:s.currentTarget,content:({onCloseModal:a})=>r.jsx(nE,{blockIds:[e.blockId],closeModal:a})})},children:r.jsx(H,{size:"middle",name:"IcAlignLeft",className:"text-white1"})}),r.jsx("div",{className:"flex justify-center items-center w-[26px] h-[26px]",onClick:s=>{if(e.externalLink)window.open(e.link);else{const a=document.querySelector(`[data-block-id="${e.blockId}"]`);t({menuPosition:s.currentTarget,blockId:e.blockId,blockNode:a,placement:"right-end",offset:[0,8]})}},children:r.jsx(H,{size:"middle",name:e.externalLink?"IcUploadWeb":"IcMore",className:"text-white1"})}),e.onAddComment&&r.jsx(Fe,{popup:"添加评论",children:r.jsx("div",{className:"flex justify-center items-center w-[26px] h-[26px] cursor-pointer",onClick:e.onAddComment,children:r.jsx(H,{size:"middle",name:"IcMenuReply",className:"text-white1"})})})]})};function vL(e){return r.jsxs("div",{className:"flex flex-col justify-center items-center bg-grey8 h-[114px] cursor-pointer my-1",onClick:e.readonly?void 0:e.onClick,contentEditable:!1,children:[r.jsx(H,{name:"IcUploadImageFaild",className:"text-grey4",size:"large"}),r.jsx("div",{className:"mt-2 text-t2 text-grey4",children:"图片加载失败，请点击重新上传"})]})}function ise(e){const t=F.useRef(null),n=F.useRef();return n.current=e,F.useEffect(()=>{const s=t.current;let a=null;s.addEventListener("pointerdown",o=>{if(n.current.disabled||a!==null)return;a={type:"beforestart",startX:o.clientX,startY:o.clientY,x:o.clientX,y:o.clientY,stop:!1};const i=()=>{a!=null&&(document.removeEventListener("pointermove",l),document.removeEventListener("pointerup",c),a=null)},l=u=>{var d,f,h,p,g,_;if(a===null)return i();if(a.x=u.clientX,a.y=u.clientY,a.type==="beforestart")if(Math.max(Math.abs(a.x-a.startX),Math.abs(a.y-a.startY))>=((f=(d=n.current)==null?void 0:d.touchSlorp)!=null?f:5)){if(a.type="start",(p=(h=n.current).onDragStart)==null||p.call(h,a,t),a.stop)return i()}else return;a.type="move",(_=(g=n.current).onDragMove)==null||_.call(g,a,t),u.preventDefault()},c=u=>{var d,f;if(a===null)return i();if(u.button===0)return a.type==="beforestart"?(setTimeout(()=>{u.target.dispatchEvent(new MouseEvent("click",{button:u.button,clientX:u.clientX,clientY:u.clientY}))}),i()):(a.type="end",a.x=u.clientX,a.y=u.clientY,(f=(d=n.current).onDragEnd)==null||f.call(d,a,t),a.stop||u.preventDefault(),i())};o.preventDefault(),document.addEventListener("pointermove",l),document.addEventListener("pointerup",c)})},[]),r.jsx(r.Fragment,{children:e.children({ref:t})})}const NN={hidden:()=>{document.body.setAttribute("style","pointer-events:none;"),document.body.classList.add("hiddenScroll")},show:()=>{document.body.removeAttribute("style"),document.body.classList.remove("hiddenScroll")}},lse=()=>"CSS"in window&&CSS.supports("overflow","overlay"),cse=()=>{var a;const e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",document.body.appendChild(e);const t=e.offsetWidth;e.style.overflow="scroll";const n=document.createElement("div");n.style.width="100%",e.appendChild(n);const s=n.offsetWidth;return(a=e==null?void 0:e.parentNode)==null||a.removeChild(e),t-s};var ca=(e=>(e[e.left=0]="left",e[e.right=1]="right",e[e.rightBottom=2]="rightBottom",e[e.leftBottom=3]="leftBottom",e[e.bottom=4]="bottom",e))(ca||{});const IN=e=>{const{size:t,stateSize:n,blockFullWidth:s,breakPoints:a=!0,widthBreakPoints:o,maxWidth:i,minWidth:l,fullHeight:c,maxHeight:u,minHeight:d}=e,f=da(t),h={...n};return s?h.width=i:(a&&[...new Set([...o,i].filter(p=>p>0))].sort((p,g)=>g-p).some(p=>Math.abs(p-f.width)<=15?(f.width=p,!0):!1),f.width>=i?i&&(h.width=i):f.width<=l?h.width=l:h.width=f.width),c?(h.height=f.height,u&&(h.height=u)):!u&&!d?h.height=f.height:(d||u)&&(d&&f.height<=d?h.height=d:u&&f.height>u?h.height=u:h.height=f.height),h.height=J3(h.height,2),h.width=J3(h.width,2),{size:h,blockFullWidth:h.width===i}},Wi=F.memo(e=>{var ie,ue;const{readonly:t,resizeHeight:n,resizeWidth:s=!0,children:a,className:o,maxHeight:i=null,maxWidth:l=Da,defaultHeight:c=500,defaultWidth:u,minWidth:d=100,debounceSize:f=0,minHeight:h=0,defaultBlockFullWidth:p=!1,doubleResize:g,fullHeight:_,disableStyle:x,onChange:y,onRenderSize:b,childrenClassName:E,widthBreakPoints:w=[l,d],customFooter:k,outerLayoutClassName:C,outerLayoutStyle:T={},onKeyDownMoveBar:v,onKeyUpMoveBar:I,...j}=e,D=Cr(),S=Sd(),R=F.useRef(null),A=F.useRef({deltaX:0,deltaY:0}),[L,P]=F.useState(!1),[M,U]=F.useState({width:u,height:c}),V=F.useRef({size:M,blockFullWidth:p}),W=no(R.current,{mode:"throttle",wait:200});F.useEffect(()=>{b==null||b({width:W.width||0,height:W.height||0})},[W]);const z=F.useRef({width:((ie=R.current)==null?void 0:ie.getBoundingClientRect().width)||0,height:((ue=R.current)==null?void 0:ue.getBoundingClientRect().height)||0}),Q=F.useCallback(ge=>{if(!R.current)return null;z.current.width||(z.current.width=R.current.getBoundingClientRect().width);const Ne={...z.current};let De=Math.abs(ge.moveRes.deltaX)*(g?2:1),Se=Math.abs(ge.moveRes.deltaY);f>0&&(A.current={deltaX:A.current.deltaX+De,deltaY:A.current.deltaY+Se},A.current.deltaX>=f?(De=A.current.deltaX,A.current.deltaX=0):De=0,A.current.deltaY>=f?(Se=A.current.deltaY,A.current.deltaY=0):Se=0),[ca.left,ca.right,ca.rightBottom,ca.leftBottom].includes(ge.type)&&([ca.left,ca.leftBottom].includes(ge.type)?ge.moveRes.deltaX>0?Ne.width-=De:Ne.width+=De:ge.moveRes.deltaX>0?Ne.width+=De:Ne.width-=De),[ca.rightBottom,ca.leftBottom,ca.bottom].includes(ge.type)&&(ge.moveRes.deltaY>0?Ne.height+=Se:Ne.height-=Se);const Ie=IN({size:Ne,stateSize:M,fullHeight:_,maxHeight:i,maxWidth:l,minHeight:h,minWidth:d,widthBreakPoints:w});U(Ie.size)},[g,f,M,_,i,l,h,d,w]),Z=F.useRef($n(ge=>{const{callback:Ne,...De}=ge,Se=IN(De);ge==null||ge.callback(Se)},50));F.useEffect(()=>{const ge={stateSize:M,fullHeight:_,maxHeight:i,maxWidth:l,minHeight:h,minWidth:d,widthBreakPoints:w,blockFullWidth:p};V.current.size.width!==u||V.current.size.height!==c?Z.current({...ge,size:{width:u,height:c},breakPoints:!0,isMaxWidthChange:!1,callback:Ne=>{V.current={...Ne,blockFullWidth:p},U(Ne.size)}}):Z.current({...ge,size:V.current.size,breakPoints:!0,isMaxWidthChange:!0,callback:Ne=>{V.current={...Ne,blockFullWidth:p},U(Ne.size)}})},[c,u,p,l]);const te=B("absolute group-hover:opacity-100 transition-opacity",!L&&"opacity-0"),re=ge=>{t||(ge?(z.current={width:M.width,height:M.height},NN.hidden()):(NN.show(),V.current={size:{width:M.width,height:M.height},blockFullWidth:M.width===l},y==null||y({width:V.current.size.width,height:V.current.size.height,blockFullWidth:V.current.blockFullWidth})),P(ge))},ne=ge=>{ge.preventDefault(),v==null||v()},Y=ge=>{ge.preventDefault(),I==null||I()},X=x?{}:{width:D||V.current.blockFullWidth&&!s?"auto":M.width?M.width:void 0,height:_?"auto":M.height};if(pt.print)return r.jsxs("div",{className:B("max-w-full",C,o),style:{...X,...T},children:[a,k]});const oe={onMoveStart:re,onMoveEnd:re,onMoveBar:Q,onPointerDown:ne,onPointerUp:Y};return r.jsxs("div",{className:B("flex flex-col justify-center flex-shrink-0",C),style:{...T},children:[r.jsxs($f,{disableSpring:S,config:{duration:100},className:B("relative group flex-shrink-0 overflow-hidden max-w-full",!L&&"transition-all duration-75 ease-in-out",o),domRef:R,style:X,...j,children:[r.jsx("div",{className:B("w-full h-full",L&&"pointer-events-none",E),children:a}),!t&&r.jsxs(r.Fragment,{children:[r.jsx(Ch,{...oe,type:ca.left,className:B(te,"flex items-center justify-center top-0 left-0 h-full w-2 cursor-[col-resize] py-1 z-10",!s&&"hidden"),children:r.jsx("div",{className:"w-1.5 h-full border border-white max-h-20 rounded-tr-md rounded-br-md bg-black-base/75"})}),r.jsx(Ch,{...oe,className:B(te,"bottom-0 left-0 z-[11] cursor-move",(!n||!s)&&"hidden"),type:ca.leftBottom,children:r.jsx("img",{className:"w-6 h-6",src:Dn.resizeLeft})}),r.jsx(Ch,{...oe,type:ca.right,className:B(te,"flex items-center justify-center top-0 right-0 h-full w-2 cursor-[col-resize] py-1 z-10",!s&&"hidden"),children:r.jsx("div",{className:"w-1.5 h-full border border-white max-h-20 rounded-tl-md rounded-bl-md bg-black-base/75"})}),r.jsx(Ch,{...oe,type:ca.rightBottom,className:B(te,"bottom-0 right-0 z-[11] cursor-move",(!n||!s)&&"hidden"),children:r.jsx("img",{className:"w-6 h-6 rotate-[270deg]",src:Dn.resizeLeft})}),r.jsx(Ch,{...oe,type:ca.bottom,className:B(te,"items-center flex justify-center bottom-0 left-0 w-full h-2 cursor-[row-resize] z-10",!n&&"hidden"),children:r.jsx("div",{className:"w-20 h-1.5 border border-white rounded-tl-md rounded-tr-md bg-black-base/75"})})]})]}),k]})}),Ch=e=>{const{children:t,type:n,onMoveBar:s,onMoveStart:a,onMoveEnd:o,...i}=e;return r.jsx(ise,{onDragStart:()=>a==null?void 0:a(!0),onDragMove:l=>{s({type:n,moveRes:{deltaX:l.x-l.startX,deltaY:l.y-l.startY}})},onDragEnd:()=>o==null?void 0:o(!1),children:({ref:l})=>r.jsx("div",{...i,ref:l,children:t})})},Ni=e=>{const t=Vn();return!e.children||t===Tt.PAGE_FEEDS?null:r.jsxs("div",{className:"group-scope relative pl-6 block-child-line-box",style:e.style,children:[r.jsx("span",{className:"block-child-line absolute left-3 w-px opacity-100 group-hover:opacity-0 group-scope-hover:opacity-0 bg-grey6 h-full transition-opacity duration-300 ease-linear dark:bg-white-base/10"}),e.children]})},VC=F.memo(e=>{var ne;const{id:t,root:n,ownerBlockId:s,children:a}=e,o=s!=null?s:t,i=_e(t,["data","local"],["ossName","height","width","format","size","link"]),l=Ve(o),c=Pi(o),u=gt(),{role:d}=it(u),f=tf(),h=XF(),{renderSize:p,onRenderSize:g,changeSize:_,containerWidth:x,containerRef:y,isDisable:b,defaultWidth:E,defaultHeight:w,defaultBlockFullWidth:k,widthBreakPoints:C}=zi({id:o,root:n,fullPageContentWidth:!0}),T=F.useContext(nx),v=no(T==null?void 0:T.current,{type:"width"}).width,I=aX(o,v!=null?v:-1,!!n),j=rX(o),{contentGravity:D}=Ng(o),S=Vn(),{formatUrl:R,loading:A,loadingCalcSize:L,srcSetParams:P,url:M,imageLink:U}=qC(t,{containerWidth:x,defaultWidth:E!=null?E:v}),V=(c==null?void 0:c.status)===Yn.failure||!vd(R)&&!R.startsWith("blob")&&!R.endsWith("=")&&R,W=sf({uuid:t}),z=F.useCallback(Y=>{const X=Y.getBoundingClientRect();W({getBoundingClientRect:()=>X},"bottom",[0,-(X.height*.6)])},[W]),Q=F.useCallback(()=>{y.current&&z(y.current)},[y,z]),Z=F.useMemo(()=>({width:pt.print?"auto":p.width||L.width,textAlign:pt.print?"center":"left"}),[L.width,p.width]);if(!i)return null;if((!R||V)&&!A)return r.jsxs(ln,{id:o,blockRef:y,horizontal:n,className:"my-1",style:{height:L.height>0?L.height:void 0,...I},children:[V?r.jsxs(r.Fragment,{children:[r.jsx(vL,{readonly:l,onClick:Y=>z(Y.currentTarget)}),r.jsx(wo,{blockId:o})]}):r.jsx($ne,{readonly:l,defaultOpenPanel:!!i.local,onClick:Y=>z(Y.currentTarget)}),a&&r.jsx(Ni,{blockId:o,children:a})]});const te=r.jsx(use,{uuid:t,srcSetParams:P,blockId:o,formatUrl:R,url:M,ownerBlockId:s,maxWidth:x,imageLink:U},M||i.data.link),re=r.jsxs(Wi,{fullHeight:!0,resizeWidth:!0,doubleResize:D===m.ContentGravity.CENTER,readonly:l||b,disableStyle:!E,defaultWidth:E!=null?E:0,defaultHeight:w,defaultBlockFullWidth:k,maxWidth:x,widthBreakPoints:C,minHeight:36,minWidth:36,onChange:_,onRenderSize:g,outerLayoutClassName:B(s&&"pl-1 border-dashed border-grey5 border-l-[2px]"),outerLayoutStyle:j,className:B("max-w-full cursor-pointer",b&&"pointer-events-none",pt.print&&"my-2.5",pt.print&&n&&"mx-auto"),customFooter:r.jsx(wo,{blockId:o,style:Z}),children:[A?r.jsx(NL,{uuid:o,maxWidth:((ne=i==null?void 0:i.data.format)==null?void 0:ne.width)||x}):te,!pt.print&&!l&&!b&&!s&&r.jsx(TL,{showAlign:!0,blockId:t,onReplace:Q,onDownload:()=>h(t),onAddComment:Fs(d,m.PermissionRole.COMMENTER)&&!s?()=>{f({blockId:t})}:void 0,externalLink:i.type===m.BlockType.EXTERNAL_FILE,link:i.data.link})]});return pt.print?r.jsxs("div",{children:[re,a&&r.jsx(Ni,{blockId:o,children:a})]}):S&&S===Tt.ONLY_IMAGE?te:S&&[Tt.NOTIFICATION,Tt.PAGE_FEEDS,Tt.UPDATE_LOG].includes(S)?r.jsxs("div",{className:"flex flex-col",children:[te,r.jsx(wo,{blockId:o,style:{width:"100%",textAlign:"center"}})]}):r.jsxs(ln,{blockRef:y,id:o,horizontal:n,fullWidth:!1,"data-draggable":!0,className:B("my-2.5 group",n&&"self-center"),style:{...I},children:[re,a&&r.jsx(Ni,{blockId:o,children:a})]})}),use=F.memo(e=>{const{blockId:t,maxWidth:n,uuid:s}=e,a=Os(),o=iu(t),i=ah(),l=Vn()===Tt.ONLY_IMAGE;return r.jsx(JF,{...e,maxWidth:n,className:B("transition-border w-full border-transparent border-[3px] preview-file",{"cursor-[zoom-in] border-active_color":o,"border-0 object-cover":l}),unloader:c=>r.jsxs("div",{...Jn(c,["unloader","loader","src","onError"]),className:B("flex h-24 text-t3 flex-col items-center justify-center bg-grey8",c.className),children:[r.jsx("div",{children:"图片加载失败"}),r.jsx("div",{children:"可能是图片格式不支持"})]}),onClick:c=>{if(!o&&!a){ee(nt.updateSelectBlocks([{blockId:t}]));return}i({uuid:s,src:c.target.src})}})},kn),NL=e=>{var s,a,o;const t=_e(e.uuid,["data"],["width","height","format"]),n=UC({width:(t==null?void 0:t.data.width)||((s=t==null?void 0:t.data.format)==null?void 0:s.width),height:(t==null?void 0:t.data.height)||((a=t==null?void 0:t.data.format)==null?void 0:a.height),maxWidth:e.maxWidth});return r.jsx(os,{style:{height:n.height,width:(o=t==null?void 0:t.data.format)!=null&&o.blockFullWidth?"100%":n.width,maxWidth:"100%"}})},qC=(e,t)=>{var h,p;const{containerWidth:n,defaultWidth:s}=t,{url:a,loading:o,isOssNameUrl:i}=Vi(e,{isImage:!0}),l=_e(e,["data","local"],["ossName","height","width","format","size","link"]),c=(l==null?void 0:l.type)===m.BlockType.PDF_ANNOTATION,u=F.useMemo(()=>{if(c||!i)return a;if(!l)return"";const{extName:g}=sn(l.data.ossName);return bo(a,g)},[l,c,a,i]),d=F.useMemo(()=>{var x,y,b,E;if(!i||!l||!u||pt.print)return{};const{extName:g}=sn(l.data.ossName);return!Rd.test(g)||((y=(x=l.data)==null?void 0:x.size)!=null?y:0)>=50*ij?{}:((b=l==null?void 0:l.data.height)!=null?b:0)>=4096||((E=l==null?void 0:l.data.width)!=null?E:0)>=4096?{}:BU(u,l==null?void 0:l.data.width,s)},[l,i,s,u]),f=F.useMemo(()=>{var g,_,x;return UC({width:(l==null?void 0:l.data.width)||((g=l==null?void 0:l.data.format)==null?void 0:g.width),height:(l==null?void 0:l.data.height)||((_=l==null?void 0:l.data.format)==null?void 0:_.height),maxWidth:((x=l==null?void 0:l.data.format)==null?void 0:x.width)||n})},[n,(h=l==null?void 0:l.data.format)==null?void 0:h.height,(p=l==null?void 0:l.data.format)==null?void 0:p.width,l==null?void 0:l.data.height,l==null?void 0:l.data.width]);return{srcSetParams:d,loadingCalcSize:f,url:a,loading:o,isOssNameUrl:i,formatUrl:u,imageLink:l==null?void 0:l.data.link}},JF=F.memo(e=>{const{blockId:t,formatUrl:n,srcSetParams:s,maxWidth:a,url:o,imageLink:i,unloader:l,...c}=e,[u,d]=F.useState(!!i),[f,h]=F.useState(!0),[p,g]=F.useMemo(()=>u&&i?[i,{}]:f?[n,s!=null?s:{}]:[o,{}],[n,i,f,u,s,o]),_=()=>{u?d(!1):f&&h(!1)};return r.jsx(xL,{showLoading:!u,loader:pt.print?void 0:r.jsx(r.Fragment,{children:s?r.jsx(JF,{...Jn(e,"srcSetParams")}):r.jsx(NL,{uuid:t,maxWidth:a})}),unloader:x=>(_(),l==null?void 0:l(x)),uuid:t,src:p,...g,onError:_,...c,"data-no-cancel-selected":!0})},kn),dse="w-5 h-6 flex items-center justify-center animate-hover rounded text-grey1 animate-hover",HC=F.memo(({id:e})=>{const{expand:t,toggle:n}=$C(e,{defaultOpen:!0}),s=_e(e,["subNodes"]),[a,o]=F.useState(!1);if(F.useEffect(()=>{const l=c=>o(c===e);return In.on("hoverId",l),()=>{In.off("hoverId",l)}},[e]),!(s!=null&&s.subNodes.length))return null;const i=pt.print||t;return r.jsx(Fe,{popup:r.jsx("span",{children:i?"展开":"收起"}),className:B("absolute top-1.5 -left-5",dse),placement:"bottom","data-no-cancel-selected":!0,children:r.jsx(H,{size:"large",name:"IcToggleBlack",onClick:n,className:B("transition duration-150 cursor-pointer",{"rotate-90 opacity-0":i,"opacity-30":a,"opacity-100":!i})})})}),$C=(e,t)=>{const{defaultOpen:n}=t||{},[s=n,a]=cu(e),o=Lx(),i=c=>{const u=o(c);return K.ui.selectedBlocks.some(d=>u.has(d.blockId)||d.blockId===c)};return{expand:s,toggle:()=>{if(a(!s),!i(e)){ee(nt.update({selectedBlocks:[],selectedCells:[]}));return}const u=K.blocks[e];if(!u)return;const d=K.blocks[u.parentId];if(!d)return;const f=[];d.subNodes.forEach(h=>{i(h)&&f.push(h)}),Po(f,!s)}}},t_=e=>{const{className:t,onClick:n,children:s,...a}=e;return s?r.jsx("div",{className:B("flex items-start justify-center w-6 mr-1",t),onClick:n,...a,children:s}):null},hb={disc:"•",circle:"◦",square:"▪"},fse=({id:e,root:t,children:n})=>{const s=ae(({blocks:i})=>IL(e,i)),[a=!0]=cu(e),o=pt.print||a;return r.jsxs("div",{className:"relative",children:[r.jsx(HC,{id:e}),r.jsxs(ln,{id:e,className:"my-px",horizontal:t,children:[r.jsxs("div",{className:"block-has-icon-container flex-1",children:[r.jsx(t_,{className:"h-7",children:r.jsx("div",{className:"pseudoBefore",style:{"--pseudoBefore--content":`"${s}"`}})}),r.jsx(Mo,{placeholder:"项目列表",className:"self-start flex-1 w-0",uuid:e})]}),n&&o&&r.jsx(Ni,{blockId:e,children:n})]})]})};function IL(e,t){var a;const n=mg(e,t,m.BlockType.LIST),s=(n==null?void 0:n.format)||(n==null?void 0:n.defaultFormat);return s&&(a=hb[s])!=null?a:hb.disc}const jL=e=>r.jsxs("div",{className:B("flex items-start py-2.5",e.className),style:e.style,children:[r.jsx(tn,{blockId:e.id,className:B("ml-1.5 mt-[5px]",e.iconClassName),hideRemoveBtn:!0,trigger:!e.readonly,iconSize:22,defaultEmoji:"💡",onSelectEmoji:t=>{e.onChange&&e.onChange(t)}}),r.jsx("div",{className:B("w-[calc(100%-36px)] ml-2",e.childrenClassName),children:e.children})]}),mse=({id:e,root:t,children:n})=>{Lr();const s=_e(e,["textColor","backgroundColor"]),a=Ve(e);if(!s)return null;const o=DL(s.textColor,s.backgroundColor);return r.jsx(ln,{id:e,className:"border border-transparent my-1 rounded",horizontal:t,style:{borderColor:o},children:r.jsxs(jL,{id:e,readonly:a,className:"pr-4 leading-8",onChange:i=>{BF({icon:i})},children:[r.jsx(ln,{dropInChild:!0,className:"my-1",bindId:!1,id:e,children:r.jsx(Mo,{uuid:e,className:"leading-6",placeholder:"着重文字"})}),n&&r.jsx("div",{className:"-ml-0.5 mb-1",children:n})]})})},DL=(e,t)=>{if(!e&&!t&&iT(e||Pe.grey),!t)return iT(e||Pe.grey)},hse=({uuid:e})=>{const t=_e(e,["data"],["segments","level"]);if(!t)return null;const{segments:n,level:s}=t.data;return r.jsx(Pn,{segments:n,className:B("w-full font-bold",{"text-[24px]":s===1,"text-[19px]":s===2,"text-[16px]":s===3,"text-[14px]":s===4})})},pse=({uuid:e,children:t})=>{const n=_e(e,["data"],["segments"]);if(!n)return null;const{segments:s}=n.data;return r.jsxs(r.Fragment,{children:[r.jsx(Pn,{segments:s,className:"text-t4 py-0.5"}),t&&r.jsx(dh,{children:t})]})},gse=({uuid:e,children:t})=>{const n=_e(e,["textColor","backgroundColor","data"],["segments"]);if(!n)return null;const{segments:s}=n.data,a=DL(n.textColor,n.backgroundColor);return r.jsxs("div",{style:{borderColor:a},children:[r.jsxs("div",{className:"flex pl-1 py-0.5",children:[r.jsx(tn,{blockId:e,hideRemoveBtn:!0,trigger:!1,iconSize:18,defaultEmoji:"💡"}),r.jsx(Pn,{segments:s,className:"text-t4 w-full ml-2 overflow-hidden"})]}),t&&r.jsx(dh,{children:t})]})},_se=({uuid:e,children:t})=>{const n=_e(e,["data"],["checked","segments"]);if(!n)return null;const{checked:s,segments:a}=n.data;return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex text-t4 py-0.5",children:[r.jsx(H,{size:"middle",name:s?"IcCheckbox2Check":"IcCheckbox2",className:B("mt-0.5 mr-1.5 w-[18px] h-[18px]",s?"text-active_color":"")}),r.jsx(Pn,{className:B("flex-1 mr-4",s?"opacity-50":"no-underline",{"line-through":s}),segments:a})]}),t&&r.jsx(dh,{children:t})]})},xse=({uuid:e,children:t})=>{const n=_e(e,["data"],["segments"]);if(!n)return null;const{segments:s}=n.data,a=IL(e,le().blocks);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex text-t4 flex-1 py-0.5",children:[r.jsx("div",{className:"pseudoBefore pt-0.5 w-6 flex justify-center",style:{"--pseudoBefore--content":`"${a}"`}}),r.jsx(Pn,{className:"self-start flex-1",segments:s})]}),t&&r.jsx(dh,{children:t})]})},Fse=({uuid:e,children:t})=>{const n=_e(e,["data"],["segments"]);if(!n)return null;const{segments:s}=n.data,a=NC(e,le().blocks);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex text-t4 flex-1 py-0.5",children:[r.jsx("div",{className:"min-w-[24px] mr-1 text-center inline-block dot",children:a}),r.jsx(Pn,{className:"self-start flex-1",segments:s})]}),t&&r.jsx(dh,{children:t})]})},yse=({uuid:e})=>{const t=_e(e,["subNodes","data"],["segments"]);if(!t)return null;const{segments:n}=t.data;return r.jsxs("div",{className:"flex text-t4 ignore-focus-click flex-1 overflow-hidden py-0.5",children:[r.jsx("span",{className:"flex",children:r.jsx(H,{size:"middle",name:"IcToggleBlack",className:B("transform duration-150 cursor-pointer",{"opacity-30":t.subNodes.length===0})})}),r.jsx(Pn,{className:"self-start mr-4 flex-1 w-0",segments:n})]})},bse=({uuid:e,children:t})=>{const n=_e(e,["data"],["segments"]);if(!n)return null;const{segments:s}=n.data;return r.jsxs("div",{className:"border-l-[3px] border-solid border-current py-0.5",children:[r.jsx("div",{className:"pl-2",children:r.jsx(Pn,{className:"w-full text-t4 px-0.5",segments:s})}),t&&r.jsx(dh,{children:t})]})},Ese=({uuid:e})=>{var s,a,o,i;const t=_e(e,["data"],["ref","display"]),n=t==null?void 0:t.type;if(!t)return null;switch(n){case m.BlockType.REFERENCE_COLLECTION_PAGE:case m.BlockType.PAGE:{let l=e;return n===m.BlockType.REFERENCE_COLLECTION_PAGE&&(l=(a=(s=t.data.ref)==null?void 0:s.uuid)!=null?a:""),r.jsx(Aa,{uuid:l,className:"flex text-t4 p-0.5",autoIconSize:!0})}case m.BlockType.REFERENCE:{if(t.data.display==="linkPage"&&((o=t.data.ref)!=null&&o.uuid))return r.jsx(Aa,{uuid:(i=t.data.ref)==null?void 0:i.uuid,isLinkPage:!0,className:"flex text-t4 py-0.5",autoIconSize:!0});break}}return null},dh=e=>e.children?r.jsx("div",{className:"relative pl-6",children:e.children}):null,wse=e=>{switch(e){case m.BlockType.TEXTAREA:return pse;case m.BlockType.HEADER:return hse;case m.BlockType.MARK:return gse;case m.BlockType.TODO:return _se;case m.BlockType.LIST:return xse;case m.BlockType.ORDER_LIST:return Fse;case m.BlockType.FOLD_LIST:case m.BlockType.TOGGLE_HEADER:return yse;case m.BlockType.QUOTE:return bse;default:return Ese}},SL=({uuid:e,renderIds:t})=>{const n=_e(e,["subNodes"]),s=Ig(e),a=wse(n==null?void 0:n.type),o=x8(n==null?void 0:n.subNodes,t),i=F.useMemo(()=>o.map(l=>r.jsx(SL,{uuid:l,renderIds:t},l)),[o,t]);return n?r.jsx("div",{style:s,className:"pointer-events-none",children:r.jsx(a,{uuid:e,children:i})}):null},kse=[m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MARK,m.BlockType.QUOTE,m.BlockType.IMAGE,m.BlockType.FILE,m.BlockType.PAGE,m.BlockType.REFERENCE,m.BlockType.COLUMN_LIST,m.BlockType.COLUMN,m.BlockType.SYNC_CONTAINER,m.BlockType.SYNC_REFERENCE,m.BlockType.EXTERNAL_FILE],_1=(e,t,n=le().blocks)=>{var a,o,i,l,c;const s=new Set(kse);for(const u of e){if(t.ids.length>=6||t.imageBlockId)return;const d=n[u];if(!d)continue;const f=d.type;if(s.has(f))switch(f){case m.BlockType.TODO:case m.BlockType.MARK:case m.BlockType.HEADER:case m.BlockType.TEXTAREA:case m.BlockType.LIST:case m.BlockType.ORDER_LIST:case m.BlockType.FOLD_LIST:case m.BlockType.TOGGLE_HEADER:case m.BlockType.QUOTE:{de(d.data.segments).trim()&&(t.ids.push(u),f!==m.BlockType.FOLD_LIST&&f!==m.BlockType.TOGGLE_HEADER&&_1((a=d.subNodes)!=null?a:[],t,n));break}case m.BlockType.COLUMN_LIST:case m.BlockType.SYNC_CONTAINER:case m.BlockType.COLUMN:{_1((o=d.subNodes)!=null?o:[],t,n);break}case m.BlockType.SYNC_REFERENCE:{const h=n[(l=(i=d.data.ref)==null?void 0:i.uuid)!=null?l:""];h&&_1((c=h.subNodes)!=null?c:[],t,n);break}case m.BlockType.EXTERNAL_FILE:{d.data.link&&(t.imageBlockId=u);break}case m.BlockType.FILE:{const{extName:h}=sn(de(d.data.segments));(d.data.ossName||d.data.localUrl)&&cn.image.test(h)&&(t.imageBlockId=u);break}case m.BlockType.PAGE:case m.BlockType.REFERENCE_COLLECTION_PAGE:{t.ids.push(u);break}case m.BlockType.REFERENCE:{d.data.display==="linkPage"&&t.ids.push(u);break}}}},Cse=e=>ae(({blocks:n})=>{var i;const s=n[e],a=(i=s==null?void 0:s.subNodes)!=null?i:[],o={ids:[],imageBlockId:void 0};return _1(a,o,n),o},{equalityFn:rn}),Tse=({recordId:e})=>{const{ids:t=[],imageBlockId:n}=Cse(e),{viewId:s,viewType:a}=Te(),o=Lo(s),i=Bo(s);if(!ae(({blocks:d})=>{var f;return(f=d[e])==null?void 0:f.subNodes.length}))return null;if(n)return r.jsx(vse,{uuid:n});const c=a===m.CollectionViewType.GALLERY,u={width:c?void 0:Co(o,i),height:c?void 0:pH[o]};return t.length>0?r.jsx("div",{className:"w-full h-full p-2 overflow-hidden opacity-60 bg-grey7 border-b border-black_006",style:u,children:t.map((d,f)=>{var p,g;const{blocks:h}=le();return t.slice(0,f).includes((g=(p=h[d])==null?void 0:p.parentId)!=null?g:"")?null:r.jsx(SL,{root:!0,uuid:d,renderIds:t},d+f)})}):null},vse=({uuid:e})=>{const{viewId:t,viewType:n}=Te(),s=Lo(t),a=nF(t),o=Bo(t),i=n===m.CollectionViewType.GALLERY,l=Co(s,o),c={width:i?void 0:l,height:i?void 0:l*p2(o)},{url:u,formatUrl:d,srcSetParams:f}=qC(e,{containerWidth:l,defaultWidth:l}),h=a===m.CoverAspectType.CONTAIN?"object-contain":"object-cover";return r.jsx(JF,{srcSetParams:f,blockId:e,style:c,className:B("w-full h-full flex items-center justify-center border-b border-black/[0.06]",h),url:u,formatUrl:d})},Nse=({recordId:e})=>{var b;const{viewId:t,viewType:n}=Te(),s=F.useRef(null),a=(b=no(s.current))==null?void 0:b.width,o=_e(e,["data"]),i=Lo(t),l=Bo(t),{previewType:c,previewProperty:u}=Kd(t),d=nF(t),f=n===m.CollectionViewType.GALLERY,p=n===m.CollectionViewType.BOARD&&c===m.CoverType.PAGE_COVER&&(o==null?void 0:o.data.cover)||f&&c===m.CoverType.PAGE_COVER,[g,_]=F.useState(!1);F.useEffect(()=>{if(g)return;const E=s.current;E&&(f&&(E.style.height=`${E.clientWidth*p2(l)}px`),_(!0))},[l,f,g]);const x=()=>{var E;if(u)return r.jsx(Ise,{recordId:e,propertyId:u});if(p)return r.jsx(nf,{className:"relative rounded-t border-b border-black_006",uuid:e,fitImage:d===m.CoverAspectType.CONTAIN,width:(E=s.current)==null?void 0:E.clientWidth,isGalleryCard:f,isVertical:l===m.CollectionCardImageDir.VERTICAL,isCardCover:!0});if(c===m.CoverType.PAGE_CONTENT)return r.jsx(Tse,{recordId:e})},y=Co(i,l);return r.jsx("div",{ref:s,style:{height:f?(a!=null?a:y)*p2(l):void 0},className:"flex items-center overflow-hidden",children:g&&x()})},Ise=({recordId:e,propertyId:t})=>{var g;const{viewId:n,viewType:s}=Te(),a=nF(n),o=(g=Bne(e,t))!=null?g:[],[i,l]=F.useState(!1),c=Lo(n),u=Bo(n),d=o.find(_=>_.type===m.TextType.URL&&_.fileStorageType==="internal"&&(!_.size||_.size<=SF));if(!d||!zp(d.url)||i)return null;const h=Co(c,u),p=s===m.CollectionViewType.GALLERY;return r.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:r.jsx(oh,{className:B("object-center border-b border-black_006",a===m.CoverAspectType.CONTAIN?"object-contain h-full w-auto":"object-cover w-full h-full"),uuid:e,ossName:d.url,defaultIcon:r.jsx(os,{className:"text-grey3",description:"加载中..."}),options:{resizeWidth:Math.round((p?h*1.2:h)*window.devicePixelRatio),hideVideoIcon:!0,onError:()=>l(!0)}})})},jse=({recordId:e})=>{const{viewId:t,managerReadonly:n,readonly:s,viewType:a}=Te(),o=a===m.CollectionViewType.GALLERY,i=jg(),l=me(),c=Os(),u=Ve(e,!1);if(s||n||u)return null;const d=f=>{f.stopPropagation(),f.preventDefault();const{selectedBlocks:h}=K.ui,p=f.currentTarget.getBoundingClientRect(),g={getBoundingClientRect:()=>p},{modalId:_}=l.dropdown({modalId:e,popcorn:g,placement:"right-start",closeBeforeCallBack:i,content:({onCloseModal:y})=>r.jsx(Dse,{popcorn:g,onCloseModal:y,blockId:e,viewId:t})}),x=h.findIndex(y=>y.blockId===e)===-1?kd(e,t,c):h;Ye({$blockMenuListId:_}),ee(nt.update({selectedBlocks:x,selectedCells:[]}))};return r.jsx("div",{className:B("operator-button absolute right-1.5 z-10 flex opacity-0 transition duration-300",o?"top-1.5":"top-3"),children:r.jsx(Fe,{className:"ml-2 flex items-center transition duration-300",placement:"bottom",popup:"点击打开菜单",children:r.jsx("button",{onClick:d,className:"animate-hover-opaque flex h-6 w-6 cursor-pointer items-center justify-center rounded border border-grey6 bg-white1",children:r.jsx(H,{name:"IcMore",size:"middle",className:"text-grey3"})})})})},Dse=e=>{var E;const{onCloseModal:t,blockId:n,popcorn:s,viewId:a}=e,{illegal:o,role:i}=it(n),l=_e(n,["updatedBy","updatedAt"]),c=ke(),u=MA(),d=mu(),{selectedBlockHistory:f}=Ol(),h=ht(),p=$i((l==null?void 0:l.updatedBy)||""),g=kL(),_=Yr((E=p==null?void 0:p.uuid)!=null?E:""),x=Cs(),y=[m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(i);if(!l)return null;const b=[{type:$.OPERATION,data:{type:5,icon:"IcOpenRight",title:"在侧边栏中打开"}},{type:$.OPERATION,data:{type:1,icon:"IcMenuDelete",title:"删除"}},{type:$.OPERATION,isHidden:o,data:{type:2,icon:"IcMenuDuplicate",title:"拷贝副本"}},{type:$.OPERATION,isHidden:o||!Fs(hn(l.parentId).role,m.PermissionRole.WRITER),data:{type:3,icon:"IcMenuCopyToPage",title:"拷贝副本至页面"}},{type:$.OPERATION,data:{icon:"IcUrl",title:"拷贝页面访问链接",onClick:()=>{ce.event("copy_page_link"),on(`${Sn()}/${n}`)},rightText:"F"}},{type:$.LINE,data:{},disableClick:!0},{type:$.OPERATION,data:{icon:"IcEditProperty",title:"编辑属性",hasArrow:!0,renderSubMenu:()=>r.jsx(CL,{popcorn:s,blockId:l.uuid,collectionId:l.parentId,selectedBlocks:K.ui.selectedBlocks})}},{type:$.OPERATION,data:{type:4,icon:"IcMenuMove",title:"移动到"}},{type:$.LINE,isHidden:!(y&&!h),data:{},disableClick:!0},{type:$.OPERATION,isHidden:!(y&&!h),data:{icon:"IcMenuInsertUp",title:"在上方插入块",rightText:"A",onClick:()=>{g({pos:"before"})}}},{type:$.OPERATION,isHidden:!(y&&!h),data:{icon:"IcMenuInsertDown",title:"在下方插入块",rightText:"B",onClick:()=>{g({pos:"after"})}}},{type:$.LINE,data:{},disableClick:!0}];return r.jsx(ze,{className:"py-2 rounded next-modal w-[260px]",items:b,customFooter:y&&!h&&r.jsx(Km,{className:"!py-2",name:_,updatedAt:l.updatedAt}),onItemClick:async w=>{const{type:k}=w.data;k===1&&c(()=>{Gs(Es(K.ui.selectedBlocks))}),k===2&&u(a,K.ui.selectedBlocks,{effects:f}),k===4&&d({popcorn:s,uuid:n,placement:"left",offset:[0,20]}),k===3&&d({popcorn:s,uuid:n,placement:"left",offset:[0,20],placeholder:"搜索拷贝到...的页面",copyAndMove:{viewId:a}}),k===5&&x(n,{forceOpenInRight:!0}),t()}})},Ha=(e,t)=>{const n=ae(({collectionViews:a})=>{var o;return(o=a[e])==null?void 0:o.type}),{previewType:s}=Kd(e);return ae(a=>{const i=(()=>{var w;const u=Zt(e,a.blocks,a.collectionViews);if(!u)return;const{view:d,collection:f,properties:h,timelineTableProperties:p=[],timelineShowTable:g}=u,_=d.type===m.CollectionViewType.TABLE,x=d.type===m.CollectionViewType.FORM,y=d.type===m.CollectionViewType.TIMELINE,b=[h];y&&b.push(p);const E=(w=f.data.schema)!=null?w:{};return b.map((k,C)=>{var S;const T=[],v=[],I=new Set;let j=!1;k.forEach(R=>{const A=E==null?void 0:E[R.property];if(!A){j=!0;return}I.has(R.property)||(T.push({...R}),I.add(R.property),v.push({...R,name:A.name,type:A.type}))}),Object.entries(E).forEach(([R,A])=>{if(I.has(R))return;const L={property:R,visible:R==="title"||_||x,width:_||y&&C===1?Eo:void 0};j=!0,I.add(R),T.push(L),v.push({...L,name:A.name,type:A.type})});const D=v.filter(R=>pt.dataBaseRange==="current"?R.visible:pt.print||R.visible);if(pt.print){const R=Number((S=pt.scale)!=null?S:1),A=1123/R,L=794/R,P=(pt.format==="a3"?A:L)-96*2;D.reduce((U,V)=>{var W;return U+=(W=V.width)!=null?W:Eo},0)>P&&D.forEach(U=>U.width=P/D.length)}if(C===1&&g&&D.length===0){j=!0;const R=T.find(L=>L.property==="title");R&&(R.visible=!0);const A=v.find(L=>L.property==="title");A&&(A.visible=!0,D.push({...A,visible:!0}))}if(C===0){const R=T.find(A=>A.property==="title");if(R&&(n===m.CollectionViewType.TABLE||n===m.CollectionViewType.LIST||n===m.CollectionViewType.TIMELINE||n===m.CollectionViewType.CALENDAR||(n===m.CollectionViewType.BOARD||n===m.CollectionViewType.GALLERY)&&s===m.CoverType.NONE)&&!R.visible){const L=v.find(P=>P.property==="title");L&&(j=!0,R.visible=!0,L.visible=!0,D.push({...L,visible:!0}))}}return{newProperties:T,needUpdateProperties:j,sorted:v,collectionId:f.uuid,visibleProperties:D}})})(),[l,c]=i!=null?i:[];return[t!=null&&t.visible?l==null?void 0:l.visibleProperties:l==null?void 0:l.sorted,t!=null&&t.visible?c==null?void 0:c.visibleProperties:c==null?void 0:c.sorted,l,c]},{equalityFn:kn})},RL=(e,t)=>{const[n,s,a,o]=Ha(e);return F.useEffect(()=>{var i;if(!t&&a&&(a.needUpdateProperties||o!=null&&o.needUpdateProperties)){const l={};if(a.needUpdateProperties){const{propertiesName:c}=(i=Zt(e))!=null?i:{};c&&(l[c]=a.newProperties)}o!=null&&o.needUpdateProperties&&(l.timelineTableProperties=o.newProperties),yt(e,l)}},[t,a,o==null?void 0:o.needUpdateProperties,o==null?void 0:o.newProperties,e]),!t&&(a!=null&&a.needUpdateProperties||o!=null&&o.needUpdateProperties)?null:[n,s]},Sse=({recordId:e})=>{var _,x,y;const{viewId:t,viewType:n}=Te(),s=zs(),a=_e(e,["subNodes","data"],["segments","icon"]),[o=[]]=Ha(t),{previewType:i}=Kd(t),l=i===m.CoverType.NONE,c=n===m.CollectionViewType.GALLERY,u=Tm(),d=e===(u==null?void 0:u.id)&&t===u.viewId,f=((_=a==null?void 0:a.subNodes)!=null?_:[]).length>0||!!((x=a==null?void 0:a.data.icon)!=null&&x.type),[h,p]=F.useState(d);return!((y=o.find(b=>b.property==="title"))==null?void 0:y.visible)||!a?null:r.jsxs("div",{className:B(c?"my-1.5 px-2":"my-[5px] p-2"),children:[(f&&!d||c&&l)&&r.jsx(tn,{className:"mr-1 !inline-block p-0 align-middle",blockId:e,trigger:!1,iconSize:16,defaultIcon:r.jsx(as,{uuid:e,size:"small"})}),h?r.jsx(co,{uuid:e,className:"text-t2-medium inline whitespace-pre-wrap break-words align-middle",plugins:kr,keydownOption:{bracketRightKey:!1},placeholder:aa,autoFocus:!0,toolbar:!1,autoFocusCaretToEnd:!0,segments:a.data.segments,interactable:d,onChange:b=>s(e,"title",b),onBlur:()=>{p(!1),Ye({$newCreatedRecord:void 0})},onKeyDown:b=>{if(be("mod+a")(b)){b.stopPropagation();return}(be("enter")(b)||be("esc")(b))&&b.currentTarget.blur()}}):r.jsx(Pn,{className:"text-t2-medium inline whitespace-pre-wrap break-words align-middle",plugins:kr,segments:a==null?void 0:a.data.segments,placeholder:aa,interactable:!1}),r.jsx(Zd,{className:"inline-flex align-middle pointer-events-none",blockId:e})]})},n_=({recordId:e})=>{var k;const{viewId:t,collectionId:n,viewType:s}=Te(),a=Ve(e),o=zs(),i=ps(t),l=_e(e,["data","createdAt","updatedAt"],["schema","collectionProperties"]),c=ae(({blocks:C})=>{var T;return(T=C[n])==null?void 0:T.data.schema}),u=Ln(n),d=iR(t);if(!i||!l||!c)return null;const{properties:f}=Zt(i),h=[],p=s===m.CollectionViewType.LIST,g=s===m.CollectionViewType.TIMELINE,_=s===m.CollectionViewType.CALENDAR,x=p||g?Me.LIST:_?Me.CALENDAR:Me.CARD,y=(k=l.data.collectionProperties)!=null?k:{},b=p||g||_,E=[];if(f.forEach(C=>{var R,A,L,P,M;if(!C.visible)return;const T=C.property;if(T==="title")return;const v=c[T];if(!v)return;let I=v.type,j=(R=y[T])!=null?R:[];I===m.CollectionSchemaType.FORMULA&&(I=u.getTypeAsCollectionSchemaType(T),j=(A=u.getValueAsSegments(e,T))!=null?A:[]);const D=r.jsx("span",{className:"mr-1.5 text-t4 text-grey3 text-ellipsis h-full flex-shrink-0 w-1/5 pt-0.5",children:v.name});E.push(D);const S=x===Me.CARD&&d?r.jsx("div",{className:B("text-t4 min-w-[20px] break-words py-0.5 whitespace-nowrap"),children:r.jsx("span",{className:"text-t4 text-grey4",children:"未填写"})}):null;switch(I){case m.CollectionSchemaType.TEXT:{de(j)?h.push(r.jsx("div",{className:B("text-t4 min-w-[20px] break-words py-0.5",!b&&"whitespace-pre-wrap"),children:r.jsx(Pn,{className:B(b&&"text-ellipsis"),segments:j,interactable:!0})})):h.push(S);break}case m.CollectionSchemaType.NUMBER:{let U,V;U=de(j);let W=parseFloat(U);Number.isNaN(W)&&(W=parseFloat((P=(L=U.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:L[0])!=null?P:""));const{numberFormat:z,showAs:Q}=v;U=(M=Sc(W,z))==null?void 0:M.toString();const{showNumber:Z}=Q!=null?Q:{};typeof W<"u"&&(V=Ep({num:Math.max(0,W),showAs:Q,numberFormat:z,from:"property-value"})),U?h.push(r.jsxs("div",{className:B("text-t4 flex min-w-[20px] items-center break-words py-0.5 min-h-[22px]"),children:[(Q&&Z||!Q)&&r.jsx("span",{className:B(b&&"text-ellipsis","flex-shrink-0"),children:U}),V]})):h.push(S);break}case m.CollectionSchemaType.CREATED_AT:case m.CollectionSchemaType.UPDATED_AT:case m.CollectionSchemaType.DATE:{let U;if(I===m.CollectionSchemaType.CREATED_AT||I===m.CollectionSchemaType.UPDATED_AT)U=he(I===m.CollectionSchemaType.CREATED_AT?l.createdAt:l.updatedAt).format(us);else if(I===m.CollectionSchemaType.DATE){const V=j==null?void 0:j.find(W=>W.type===m.TextType.DATE||W.type===m.TextType.DATETIME);V&&(U=Wp(V,v.dateFormat,(V==null?void 0:V.type)===m.TextType.DATETIME,v.timeFormat))}U?h.push(r.jsx("div",{className:B("text-t4 flex min-w-[20px] items-center break-words py-0.5"),children:r.jsx("span",{className:B(b&&"text-ellipsis"),children:U})})):h.push(S);break}case m.CollectionSchemaType.CHECKBOX:{const V=de(j).toUpperCase()==="YES";h.push(r.jsxs("div",{className:B("text-t4 pointer-events-auto flex min-w-[20px] items-center justify-start break-words py-0.5"),children:[r.jsx("button",{className:"flex items-center",disabled:a,onClick:W=>{W.stopPropagation(),o(e,T,V?"NO":"YES")},children:r.jsx(H,{size:"small",className:V?"text-active_color":"",name:V?"IcCheckbox2Check":"IcCheckbox2"})}),(x!==Me.CARD||!d)&&r.jsx("span",{className:B("ml-[7px]",b&&"text-ellipsis"),children:v.name})]}));break}case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:{de(j)?h.push(r.jsx("div",{className:B("flex-1 text-t4 break-words"),children:r.jsx(HF,{site:x,recordId:e,multiple:I===m.CollectionSchemaType.MULTI_SELECT,propertyId:T,className:B(b&&"whitespace-nowrap"),itemClassName:B("text-t4 mr-1",_?"my-[1px]":"my-0.5",!b&&"max-w-[calc(100%-6px)]")})})):h.push(S);break}case m.CollectionSchemaType.PHONE:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.URL:{if(pi(j)){const U=Su(I);h.push(r.jsx("div",{className:B("text-t4 relative min-w-[20px] break-words py-0.5",b&&"text-ellipsis",_&&"py-[1px]"),children:r.jsx(U,{site:x,recordId:e,propertyId:T})}))}else h.push(S);break}case m.CollectionSchemaType.FILE:{if(j.filter(V=>V.type===m.TextType.URL&&V.fileStorageType==="internal").length>0){const V=Su(I);h.push(r.jsx("div",{className:B("text-t4 relative min-w-[20px] text-ellipsis break-words",!b&&"max-w-[calc(100%-6px)]"),children:r.jsx(V,{site:x,recordId:e,propertyId:T})}))}else h.push(S);break}case m.CollectionSchemaType.CREATED_BY:case m.CollectionSchemaType.UPDATED_BY:case m.CollectionSchemaType.PERSON:{if(I===m.CollectionSchemaType.CREATED_BY&&!l.createdAt||I===m.CollectionSchemaType.UPDATED_BY&&!l.updatedAt||I===m.CollectionSchemaType.PERSON&&j.filter(V=>V.type===m.TextType.USER).length===0){h.push(S);break}const U=Su(I);h.push(r.jsx("div",{className:B("text-t4 relative min-w-[20px] text-ellipsis break-words",!b&&"max-w-[calc(100%-6px)]"),children:r.jsx(U,{site:x,recordId:e,propertyId:T})}));break}case m.CollectionSchemaType.RELATION:{const U=Su(I);if(du(e,T).relationRecords.length===0&&_)return;h.push(r.jsx("div",{className:B("text-t4 flex min-w-[20px] items-center break-words py-0.5",b&&"whitespace-nowrap"),children:r.jsx(U,{site:x,recordId:e,propertyId:T})}));break}case m.CollectionSchemaType.ROLLUP:{const U=Su(I);h.push(r.jsx("div",{className:B("text-t4 flex min-w-[20px] items-center break-words overflow-hidden",!_&&"py-0.5",b&&"text-ellipsis whitespace-nowrap"),children:r.jsx(U,{site:x,recordId:e,propertyId:T})}));break}}}),h.length<=0)return null;const w=h.map((C,T)=>C?r.jsxs("div",{className:B("flex",(p||g)&&"ml-5 items-center"),children:[x===Me.CARD&&d&&E[T],r.jsx("div",{className:B("flex-1",x===Me.CARD?"w-0":"",_&&"overflow-hidden"),children:C})]},T):null);return p?r.jsx("div",{className:"flex overflow-hidden",children:w}):g||_?r.jsx(r.Fragment,{children:w}):r.jsx("div",{className:"mt-[5px] mb-2 px-2",children:w})},GC=zt.memo(e=>{const{recordId:t,groupValue:n,subGroupValue:s}=e,{viewId:a,viewType:o}=Te(),i=_e(t,[]),{illegal:l}=it(t),c=Cs(),u=F.useRef(null),{previewType:d}=Kd(a),f=d===m.CoverType.NONE,h=o===m.CollectionViewType.GALLERY,p=Tm(),g=t===(p==null?void 0:p.id)&&a===p.viewId;if(!i)return null;const _=x=>{const y=x.target.closest("a");if(y&&x.currentTarget.contains(y))return;c(t,{illegal:l,onOpenInRight:()=>{var E;if(h){const w=(E=u.current)==null?void 0:E.closest(".block-list");w&&(w.style.width=`${w==null?void 0:w.clientWidth}px`,setTimeout(()=>{w.style.width="unset"},1e3))}},forceOpenInRight:x.altKey,forceOpenNewTab:x.ctrlKey||x.metaKey})};return r.jsx(ln,{id:t,viewId:a,blockRef:u,hideHoverMenu:!0,"data-draggable":!0,horizontal:h,groupValue:n,subGroupValue:s,"data-only-horizontal":h,onClick:_,"data-no-cancel-selected":!0,className:B("sub-group-card relative w-full cursor-pointer list-none rounded border border-black/10 bg-white1 dark:bg-white/5 dark:hover:bg-white/10",l&&"opacity-30",!g&&"animate-hover-black3",h&&"h-full",f?"min-h-[38px]":"min-h-[48px]"),children:l?r.jsxs("div",{className:"text-t2-medium whitespace-pre-wrap break-words px-2 py-2",children:[r.jsx(tn,{className:"mr-1 inline p-0 align-middle",blockId:t,trigger:!1,iconSize:20,defaultIcon:r.jsx(as,{uuid:t,size:"middle"})}),r.jsx("span",{className:"border-b border-grey6",children:rs})]}):r.jsxs(r.Fragment,{children:[!f&&r.jsx(Nse,{recordId:t}),r.jsx(Sse,{recordId:t}),r.jsx(n_,{recordId:t}),r.jsx(jse,{recordId:t})]})})}),AL=e=>{const t=F.useRef(null),[n,s]=F.useState(!1);return F.useEffect(()=>{var l,c;const a=t.current;if(!a)return;a.style.height=`${(c=(l=a.previousElementSibling)==null?void 0:l.clientHeight)!=null?c:200}px`,a.style.borderWidth="1px";const o=u=>{u.forEach(d=>{s(()=>d.isIntersecting?(a.style.height="unset",a.style.borderWidth="0px",!0):(a.style.height=`${a.offsetHeight}px`,a.style.borderWidth="1px",!1))})},i=new IntersectionObserver(o,{rootMargin:"600px 0px"});return i.observe(a),()=>i.disconnect()},[]),r.jsx("div",{ref:t,className:"rounded cursor-pointer","data-card-id":e.recordId,children:n&&r.jsx(GC,{...e})})},BL=()=>{var u;const{viewId:e,readonly:t,managerReadonly:n,isLocked:s}=Te(),{hiddenGroups:a=[]}=(u=fu(e))!=null?u:{},o=Lo(e),i=Bo(e),l=YF(),c=Rk();return t&&n||a.length===0?null:r.jsx("div",{className:"ml-2.5 flex-shrink-0 bg-white1",style:{width:Co(o,i)},"data-disable-select":!0,children:r.jsxs("div",{className:"rounded-md bg-grey/5 p-[5px] px-1",children:[r.jsx("div",{className:"text-t2 flex h-[38px] w-full items-center pl-[4px] text-grey4",children:"隐藏分组"}),r.jsx(vr,{disabled:t||n||s||!c,items:a.map(d=>({id:d.value,...d})),onChange:(d,f)=>l(e,f),renderItemContent:({item:d})=>r.jsx(Rse,{groupName:d.value,recordIds:d.recordIds})})]})})},Rse=({groupName:e,recordIds:t})=>{const{viewId:n}=Te();return su(n)?r.jsxs("div",{className:"group animate-hover-black3 flex h-[38px] cursor-pointer items-center justify-between rounded-sm px-1",children:[r.jsx("div",{className:"flex items-center",style:{maxWidth:"calc(100% - 40px)"},children:r.jsx(KF,{groupName:e,scene:Zg.HIDDEN_GROUP})}),r.jsx("span",{className:"mx-1.5 text-grey4",children:t.length}),r.jsx(MC,{visible:!1,className:"ml-auto mr-2 text-grey3 opacity-0 group-hover:opacity-100",groupName:e})]}):null},Ase=()=>{var c;const{viewId:e,managerReadonly:t,isLocked:n,readonly:s,embed:a}=Te(),{visibleGroups:o}=(c=fu(e))!=null?c:{},i=YF(),l=Rk();return o?r.jsxs("div",{className:"flex pt-4 border-t border-grey6",children:[r.jsx(vr,{className:"flex",isHorizontalAxis:!0,disabled:t||n||!l,strategy:Z0,modifiers:[J0,Gp],items:o.map(u=>({id:u.value,...u})),onChange:(u,d)=>i(e,d),onlyHandleDraggable:!0,renderItemContent:({item:u,listeners:d})=>r.jsx(Bse,{recordIds:u.recordIds,groupName:u.value,groupProperty:u.groupProperty,listeners:d})}),r.jsx(Lc,{}),r.jsx(BL,{}),!s&&!a&&r.jsx(To,{type:"collection"})]}):null},Bse=e=>{Lr();const{groupProperty:t,groupName:n,recordIds:s,listeners:a}=e,{viewId:o,embed:i}=Te(),l=WF(o),c=tF(o,Xa(n)),u=Lo(o),d=Bo(o),f=Xd(o),h=sr();if(!h.current)return null;const p={height:"fit-content",width:Co(u,d)+10,backgroundColor:l?QE(c==null?void 0:c.color):void 0};return r.jsxs("div",{"data-is-empty":s.length===0?!0:null,"data-is-board":!0,"data-group-property":t,"data-group-value":n,"data-view-id":o,style:{width:Co(u,d)+10},className:B("mr-2.5 h-full flex flex-col board-group group"),children:[r.jsx(_L,{groupName:n,recordIds:s,listeners:a}),r.jsxs("div",{style:p,className:B("w-full relative flex-1 block-list flex flex-col items-center rounded-b-md pb-[5px] px-[5px]",l&&"bg-grey/5"),children:[r.jsx(As,{className:"w-full",customScrollParent:h.current,overscan:300,totalCount:s.length,itemContent:g=>{const _=s[g];return _?r.jsx("div",{className:"pb-[5px]","data-card-id":_,children:r.jsx(GC,{recordId:_,groupValue:n})},_):null}}),!i&&r.jsx(Bc,{type:"board"}),f&&r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-black/30 opacity-0 group-hover:opacity-100"}),r.jsx(hu,{where:{after:s[s.length-1]},groupName:n,color:l?c==null?void 0:c.color:void 0})]})]})};const Lse=()=>{var n,s,a;const e=gt(),t=_e(e,["data"],["pageFixedWidth","directoryMenu"]);return(a=(s=(n=t==null?void 0:t.data)!=null?n:{})==null?void 0:s.pageFixedWidth)!=null?a:!0},s_=F.memo(e=>{const{isSubGroup:t=!1,tableGroup:{recordIds:n,value:s,visible:a},isInTable:o,index:i}=e,{viewId:l,readonly:c,managerReadonly:u,embed:d,isColumnListChildren:f,isFoldListChildren:h,viewType:p}=Te(),g=Nm(l,s),_=Vn(),x=F.useRef(null),y=p===m.CollectionViewType.TIMELINE,b=Lse();F.useEffect(()=>{if(!d&&!(y&&!o)||pt.print)return;const w=x.current,k=w==null?void 0:w.closest(".next-space-page");if(!k||!w)return;const C=()=>{var S;const T=w.parentElement,v=T==null?void 0:T.getBoundingClientRect();if(!v)return;const I=k.getBoundingClientRect(),j=y&&!o?74:0,D=I.y+j;if(D>v.y){let R=Math.abs(D-v.y);const A=T==null?void 0:T.nextSibling;if(A){const P=A.getBoundingClientRect();P.y-D<w.clientHeight&&(R=R-(w.clientHeight-(P.y-D)))}const L=(S=T==null?void 0:T.querySelector(".table-footer"))==null?void 0:S.getBoundingClientRect();L&&L.y-D<w.clientHeight&&(R=R-(w.clientHeight-(L.y-D))),w.style.transform=`translateY(${R+(d?hC:cc)}px)`,w.style.backgroundColor="var(--white1)"}else w.style.transform="none",y&&(w.style.backgroundColor="unset")};return k.addEventListener("scroll",C),window.addEventListener("resize",C),()=>{k.removeEventListener("scroll",C),window.removeEventListener("resize",C)}},[d,o,y]);const E=()=>{var k;const w=(k=wt.$tableGroupFoldStatus)!=null?k:{};Ye({$tableGroupFoldStatus:{...w,[l]:{...w[l],[s]:!g}}}),Nn(TF(l,s,t),JSON.stringify(!g))};return r.jsxs("div",{className:B("sticky z-20",!t&&"border-t border-grey6",!(y&&!o)&&"bg-white1"),style:{top:d?void 0:_===Tt.PAGE_LITE_PREVIEW?cc-11:cc},ref:x,children:[r.jsxs("div",{className:B("sticky flex h-[38px] w-96 items-center bg-white1 pl-1",d?b?"left-8":"left-0":_===Tt.PAGE_LITE_PREVIEW?"left-10":"left-24",y&&(o?"h-[37px] w-auto":"bg-transparent"),!(f||h)&&"-translate-x-8"),children:[r.jsx("button",{className:"animate-hover mr-1.5 h-6 w-6 rounded text-grey4",onClick:E,children:r.jsx(H,{name:"IcToggleBlackUnfold",size:"large",className:"transition-all duration-200 print:hidden",style:{transform:g?"rotate(0deg)":"rotate(-90deg)"}})}),r.jsx(KF,{isSubGroup:t,groupName:s,scene:Zg.GROUP_HEADER}),r.jsx("span",{className:"text-t2 mx-1.5 text-grey4",children:n.length}),!pt.print&&r.jsxs(r.Fragment,{children:[r.jsx(MC,{isSubGroup:t,groupName:s,visible:a,className:"ml-3 mr-1 text-grey3"}),c||u?null:r.jsx(gL,{groupName:s,before:n[0],isSubGroup:t,className:"text-grey3"})]})]}),y&&o&&a&&i===0&&r.jsx(Fe,{popup:"收起表格",onClick:w=>{w.stopPropagation(),yt(l,{timelineShowTable:!1})},children:r.jsx(H,{name:"IcUnfold",size:"middle",className:"animate-hover absolute right-2 top-2 rotate-180 text-grey3"})})]})},rn),fh=e=>{const{hiddenGroupsLength:t,hiddenGroups:n,isTimelineTable:s}=e,{viewId:a,embed:o}=Te(),i=SV(a),l=Wm(a),{viewType:c}=Te();if(t===0)return null;const u=c===m.CollectionViewType.TIMELINE;return r.jsxs(r.Fragment,{children:[u&&l&&!s?r.jsx("div",{className:"h-[42px]"}):r.jsx("div",{className:"mb-1",children:r.jsxs("button",{"data-disable-select":"true",className:B("sticky left-0 animate-hover-black3 text-grey3 h-[38px] pl-1 pr-2 rounded flex items-center",o?"left-0":"left-24"),onClick:()=>{Ye({$tableShowHiddenGroup:{...wt.$tableShowHiddenGroup,[a]:!i}})},children:[r.jsx(H,{name:"IcArrowShow",size:"middle",className:"mr-1 text-grey4 duration-200 transition-all",style:{transform:i?"rotate(0deg)":"rotate(-90deg)"}}),r.jsxs("span",{className:"text-t2 text-grey4",children:[t," 隐藏分组"]})]})}),i&&n]})},Pse=()=>{const{viewId:e,embed:t,readonly:n,managerReadonly:s,isLocked:a}=Te(),o=fu(e),i=YF(),l=sr(),[c,u]=F.useState(l==null?void 0:l.current);if(F.useEffect(()=>{u(l==null?void 0:l.current)},[c,l]),!c||!o)return null;const{visibleGroups:d,visibleSubGroups:f=[],hiddenSubGroups:h=[]}=o;return r.jsxs("div",{className:"flex border-t border-grey6 pt-2",children:[r.jsxs("div",{children:[r.jsx(vr,{className:"flex pb-2",isHorizontalAxis:!0,appendChild:r.jsx(Lc,{}),disabled:s||a,strategy:Z0,modifiers:[J0,Gp],items:d.map(p=>({id:p.value,...p})),onChange:(p,g)=>i(e,g),renderItemContent:({item:p})=>r.jsx(_L,{groupName:p.value,recordIds:p.recordIds,isSubGroup:!0})}),f.length>100?r.jsx(As,{customScrollParent:c,overscan:300,totalCount:f.length,itemContent:p=>{const g=f[p];return g?r.jsx(B_,{tableGroup:g},g.value):null}}):r.jsx(r.Fragment,{children:f.map(p=>r.jsx(B_,{tableGroup:p},p.value))}),r.jsx(fh,{hiddenGroupsLength:h.length,hiddenGroups:h.length>100?r.jsx(As,{customScrollParent:c,overscan:300,totalCount:h.length,itemContent:p=>{const g=h[p];return g?r.jsx(B_,{tableGroup:g},g.value):null}}):r.jsx(r.Fragment,{children:h.map(p=>r.jsx(B_,{tableGroup:p},p.value))})}),r.jsx(Lc,{isSubGroup:!0}),!n&&!t&&r.jsx(To,{type:"collection"})]}),r.jsx(BL,{})]})},B_=F.memo(e=>{const{tableGroup:t}=e,{viewId:n}=Te(),s=Nm(n,t.value);return r.jsxs("div",{className:"pb-5",children:[r.jsx(s_,{isSubGroup:!0,tableGroup:t}),s&&r.jsx(Ose,{tableGroup:t})]})},rn),Ose=({tableGroup:e})=>{const{viewId:t}=Te(),n=WF(t),s=su(t),a=Lo(t),o=Bo(t),i=Xd(t),l=sr();return l.current?r.jsx("div",{className:"flex",children:e.groups.map(({recordIds:c,value:u,visible:d,groupProperty:f})=>{var p;if(!d||!l.current)return null;const h=(p=s==null?void 0:s.options)==null?void 0:p.find(g=>g.value===u);return r.jsxs("div",{"data-is-empty":c.length===0?!0:null,"data-is-board":!0,"data-group-property":f,"data-group-value":u,"data-subgroup-property":e.groupProperty,"data-sub-group-value":e.value,"data-view-id":t,className:B("relative group flex flex-col items-center rounded-md p-[5px] mr-2.5 min-h-[45px]",(n&&!(h!=null&&h.color)||!n)&&"bg-grey/5"),style:{width:Co(a,o)+10,backgroundColor:n?QE(h==null?void 0:h.color):void 0},children:[r.jsx(As,{className:"w-full",customScrollParent:l.current,overscan:300,totalCount:c.length,itemContent:g=>{const _=c[g];return _?r.jsx("div",{className:"pb-[5px]","data-card-id":_,children:r.jsx(GC,{recordId:_,groupValue:u,subGroupValue:e.value})},_):null}}),i&&r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-black/30 opacity-0 group-hover:opacity-100"}),r.jsx(hu,{where:{after:c[c.length-1]},groupName:u,subGroupName:e.value,color:n?h==null?void 0:h.color:void 0})]},u)})}):null},LL=e=>{const{viewId:t}=Te(),{previewType:n}=Kd(t),s=RG();F.useEffect(()=>{if(n!==m.CoverType.PAGE_CONTENT)return;const a=e,o=a==null?void 0:a.closest(".next-space-page");if(!a||!o)return;const i=fL(),l=()=>{const u=a.querySelectorAll("[data-card-id]"),d=o.getBoundingClientRect(),f=new Set;u.forEach(h=>{const{cardId:p,loaded:g}=h.dataset;if(!p||g==="true"||f.size>=50)return;const _=h.getBoundingClientRect();hL(_,d)>0&&(f.add(p),h.dataset.loaded="true")}),f.size>0&&s([...f])};setTimeout(()=>l());const c=()=>i(l,100);return o.addEventListener("scroll",c),()=>{o.removeEventListener("scroll",c)}},[e,s,n])},Mse=({embed:e})=>{var c,u;const{viewId:t,readonly:n,managerReadonly:s}=Te(),a=Gg(t);zF(a);const o=F.useRef(null),[i,l]=F.useState(o.current);return LL(i),F.useEffect(()=>{i||l(o.current)}),a?(a.withoutValidGroup||a.needUpdateGroups)&&((u=(c=a.newViewGroups)==null?void 0:c[0])==null?void 0:u.propertyType)===m.CollectionSchemaType.SELECT?n||s?r.jsx("div",{className:"text-t2 h-[35px] flex items-center pl-2",children:"当前视图无有效分组属性，无法展示"}):null:a.needUpdateSubGroups&&!(n||s)?null:r.jsx("div",{ref:o,style:{width:"fit-content",minWidth:"100%"},className:B(!e&&"-mr-24 pr-24 box-content sm:-mr-12 sm:pr-12"),children:a.hasValidSubGroup?r.jsx(Pse,{}):r.jsx(Ase,{})}):null};const pr=12,Ip=18,Yo=10,pb=5,Kh=90;var T0=(e=>(e.DAY="day",e.MONTH="month",e))(T0||{});const v0=[{type:"day",name:"日视图"},{type:"month",name:"月视图"}],zC=(e,t)=>{const n=sF(e);return ae(({blocks:s})=>{var i,l,c,u,d,f;const a=s[t];if(!a)return;let o="";if((n==null?void 0:n.type)===m.CardColorSource.CUSTOM&&(o=a.data.collectionCardColor),(n==null?void 0:n.type)===m.CardColorSource.PROPERTY){if(!n.propertyId)return;const h=(c=(i=s[a.parentId])==null?void 0:i.data.schema)==null?void 0:c[(l=n.propertyId)!=null?l:""];if(!h||h.type!==m.CollectionSchemaType.SELECT)return;const p=(d=a.data.collectionProperties)==null?void 0:d[(u=n.propertyId)!=null?u:""],g=de(p),_=(f=h.options)==null?void 0:f.find(x=>x.value===g.trim());o=_==null?void 0:_.color}return _U(o)})},Th=(e,t)=>{e-=Yo;let n=Math.floor(e/t);return n=e-n*t>t/2?n+1:n,n},Use=(e,t,n,s,a,o)=>{const{autoScrollY:i,rafY:l}=FC(),{disableTop:c,disableBottom:u}=o;let d=!1;const f=Yo,h=n.clientHeight-Yo,p=y=>{y.preventDefault();const b=y.target;if(!b)return;let{clientY:E}=y;const w=y.clientY,k=b.classList.contains("resize-top"),C={top:parseInt(e.style.top,10),height:parseInt(e.style.height,10),bottom:parseInt(e.style.height,10)+parseInt(e.style.top,10)},T=j=>{if(!d){if(Math.abs(j.clientY-w)<5)return;d=!0}i({y:j.clientY,container:t,offset:{top:120}}),E=j.clientY,v()},v=()=>{const j=n.getBoundingClientRect(),D=E-j.y;if(k){let S=D;const R=S<f?f:S;S=Th(R,pr)*pr+Yo;const L=Zn(S,f,C.bottom),P=S>C.bottom?Math.min(S,h)-C.bottom:C.bottom-S;if(u&&L+P>C.bottom)return;e.style.top=`${L}px`,e.style.height=`${Math.max(P,Ip)}px`}else{let S=D;S=Th(S,pr)*pr+Yo;const A=Zn(S,f,h),L=S>C.top?C.top:A,P=Math.abs(A-C.top);if(c&&L<C.top)return;e.style.top=`${L}px`,e.style.height=`${Math.max(P,Ip)}px`}},I=()=>{d=!1,document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",I),t.removeEventListener("scroll",v),cancelAnimationFrame(l.id);const j=parseInt(e.style.top,10),D=parseInt(e.style.height,10),S=Th(j,pr);s==null||s(S,D<pr?0:D/pr,d)};document.addEventListener("mousemove",T),document.addEventListener("mouseup",I),t.addEventListener("scroll",v)},g=y=>{if(y.preventDefault(),!y.target)return;let{clientY:E}=y;const w=y.clientY,k=e.getBoundingClientRect(),C=y.clientY-k.top,T={top:parseInt(e.style.top,10),height:parseInt(e.style.height,10),bottom:parseInt(e.style.height,10)+parseInt(e.style.top,10)},v=D=>{if(!d){if(Math.abs(D.clientY-w)<5)return;d=!0}E=D.clientY,i({y:E,container:t,offset:{top:120}}),I()},I=()=>{const D=n.getBoundingClientRect(),S=E-D.y,R=Zn(S-C,f,h-T.height),L=Th(R,pr)*pr+Yo;e.style.top=`${L}px`},j=()=>{document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",j),t.removeEventListener("scroll",I),cancelAnimationFrame(l.id);const D=parseInt(e.style.top,10),S=parseInt(e.style.height,10),R=Th(D,pr);s==null||s(R,S<pr?0:S/pr,d)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",j),t.addEventListener("scroll",I)},_=y=>{const b=y.target;if(!b)return;if(b.classList.contains("resize-top")||b.classList.contains("resize-bottom"))p(y);else{if(c||u)return;g(y)}},x=y=>{d||a(y),d=!1};return e.addEventListener("mousedown",_),e.addEventListener("mouseup",x),()=>{e.removeEventListener("mouseup",x),e.removeEventListener("mousedown",_)}},PL=e=>{var l,c,u;const t=Zt(e);if(!t)return{calendarByType:void 0,calendarByEndType:void 0};const{view:n,collection:s}=t,{calendarBy:a="",calendarByEnd:o=""}=n.format,i=(l=s==null?void 0:s.data.schema)!=null?l:{};return{calendarByType:(c=i[a])==null?void 0:c.type,calendarByEndType:(u=i[o])==null?void 0:u.type}},Vse=e=>{const{viewId:t,collectionId:n}=Te();vm(t);const s=ae(i=>{const{blocks:l,collectionViews:c}=i,u=l[n],d={allDayRecord:[],timeRangeRecord:[]},f=c[t];if(!f||!u)return d;const{calendarBy:h="",calendarByEnd:p=""}=f.format,{calendarByType:g,calendarByEndType:_}=PL(t);return uc({viewId:t}).map(y=>l[y]).filter(y=>!!y).sort((y,b)=>{var E,w;return((E=y.createdAt)!=null?E:0)-((w=b==null?void 0:b.createdAt)!=null?w:0)}).map(y=>y.uuid).forEach(y=>{var I,j;const b=l[y];if(!b)return;let E=0,w=0,k=!0,C=!0;if(g===m.CollectionSchemaType.CREATED_AT||g===m.CollectionSchemaType.UPDATED_AT)k=!0,E=g===m.CollectionSchemaType.CREATED_AT?b.createdAt:b.updatedAt;else{const{textType:D,timestamp:S}=(I=Gr(b,h))!=null?I:{};k=D===m.TextType.DATETIME,E=S}if(_===m.CollectionSchemaType.CREATED_AT||_===m.CollectionSchemaType.UPDATED_AT)C=!0,w=_===m.CollectionSchemaType.CREATED_AT?b.createdAt:b.updatedAt;else{const{textType:D,timestamp:S}=(j=Gr(b,p))!=null?j:{};C=D===m.TextType.DATETIME,w=S}if(!g||!_||!E&&!E||(E||(E=w,k=C),w||(w=E,C=k),!E)||!w)return;w<E&&(w=E,C=k);const T=ns(E),v=ns(w);if(T===e||v===e||T<e&&w>=e+Hn){T===v&&C&&!k&&(E=w,k=C);const R={uuid:y,startTime:E,endTime:w};if(T===e&&k||v===e&&C){d.timeRangeRecord.push(R);return}d.allDayRecord.push(R)}}),d}),{timeRangeRecord:a}=s;a.sort((i,l)=>(i.startTime||i.endTime||0)-(l.startTime||l.endTime||0));const o=[];return a.forEach((i,l)=>{if(l===0){o.push([i]);return}for(const c of o)if(!c.find(d=>jN(d,i))){c.push(i);return}o.push([i])}),o.forEach((i,l)=>{i.forEach(c=>{c.left=l;const u=o.slice(l+1);let d=l+1;for(const f of u)if(f.find(p=>jN(c,p)))d++;else if(l+1!==d){const p=u.findIndex(g=>g===f);d+=u.length-p;break}else continue;c.recordCount=d})}),s},jN=(e,t)=>{const{startTime:n,endTime:s}=e,{startTime:a,endTime:o}=t;if(!(!n||!a||!s||!o))return n<a?a>=n&&a<s:n>=a&&n<o},OL=(e,t)=>{var o;const n=_e(t,["data"],["collectionCardColor"]),{type:s}=(o=sF(e))!=null?o:{},a=ke();F.useEffect(()=>{var i;if(n&&s===m.CardColorSource.CUSTOM){const l=n.data.collectionCardColor,c=wr.map(u=>u.key);if(!l||!c.includes(l)){const{role:u}=hn(t);if(u===m.PermissionRole.WRITER||u===m.PermissionRole.EDITOR){const d=(i=od(c))!=null?i:Pe.grey;a(()=>{pe(t,{data:{collectionCardColor:d}})})}}}},[n,t,a,s,e])},ML=100;let Af,Vu;const DN=(e,t,n=ML)=>{const s=t.getBoundingClientRect(),a=()=>{if(e-s.left<n){const i=(n-(e-s.left))/10;t.scrollLeft-=i,Af=requestAnimationFrame(a)}if(s.right-e<n){const i=(n-(s.right-e))/10;t.scrollLeft+=i,Af=requestAnimationFrame(a)}};cancelAnimationFrame(Af),Af=requestAnimationFrame(a)},sE=({y:e,container:t,threshold:n=ML,offset:s})=>{var c,u;const a=t.getBoundingClientRect(),o=n+((c=s==null?void 0:s.top)!=null?c:0),i=n+((u=s==null?void 0:s.bottom)!=null?u:0),l=()=>{if(e-a.top<o){const f=(o-(e-a.top))/10;t.scrollTop-=f,Vu=requestAnimationFrame(l)}if(a.bottom-e<i){const f=(n-(a.bottom-e))/10;t.scrollTop+=f,Vu=requestAnimationFrame(l)}};cancelAnimationFrame(Vu),Vu=requestAnimationFrame(l)},N0=({base:e=Date.now(),dir:t=Cd.NEXT,length:n=100,includeBase:s=!1,zoomLevel:a=ot.MONTH})=>{const o=[],i=t===Cd.NEXT;if(mh(a)||a===ot.QUARTER){let l=xm(e);a===ot.QUARTER&&(l-=(new Date(e).getDay()-1)*En);const c=a===ot.QUARTER?En*7:En,u=s?n:n+1;for(let d=0;d<u;d++)if(!(!s&&d===0))if(i){const f=l+d*c;o.push(f)}else{const f=l-d*c;o.unshift(f)}}else if(a===ot.YEAR){const l=new Date(e),c=xm(l.setDate(1));if(s)o.push(c);else{const u=new Date(c).getMonth();o.push(new Date(c).setMonth(i?u+1:u-1,1))}for(let u=0;u<n-1;u++)if(i){const d=o[o.length-1],f=new Date(d).getMonth();o.push(new Date(d).setMonth(f+1,1))}else{const d=o[0],f=new Date(d).getMonth();o.unshift(new Date(d).setMonth(f-1,1))}}else if(a===ot.DAY||a===ot.HOUR){const l=a===ot.DAY?UL(e):Dp(e),c=a===ot.DAY?h0:Dc,u=s?n:n+1;for(let d=0;d<u;d++)if(!(!s&&d===0))if(i){const f=l+d*c;o.push(f)}else{const f=l-d*c;o.unshift(f)}}return o},jp=({zoomLevel:e,length:t,base:n})=>[...N0({base:n,dir:Cd.PREV,zoomLevel:e,length:t}),...N0({base:n,dir:Cd.NEXT,zoomLevel:e,length:t,includeBase:!0})],xm=e=>new Date(new Date(e).toDateString()).getTime(),UL=e=>new Date(e).setHours(new Date(e).getHours(),0,0,0),Dp=e=>{const t=UL(e);return t+Math.floor((e-t)/Dc)*Dc},gr=e=>{const t=new Date(e);return{year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate(),day:t.getDay(),monthDesc:PJ[t.getMonth()],time:e}},yi=(e,t,n)=>{const s=new Date(t);return n===ot.DAY||n===ot.HOUR?new Date(t):he(e).year(s.getFullYear()).month(s.getMonth()).date(s.getDate()).toDate()},er=(e,t,n,s)=>{const{needDateStart:a=!1,abs:o=!0}=s!=null?s:{};let i=0;return n===ot.HOUR||n===ot.DAY?i=(a?Dp(e)-Dp(t):e-t)/Dc:i=(a?xm(e)-xm(t):e-t)/En,o?Math.abs(i):i},qse=[31,28,31,30,31,30,31,31,30,31,30,31],Hse=e=>{const t=new Date(e),n=t.getFullYear(),s=t.getMonth();return s===1?n%4===0&&n%100!==0||n%400===0?29:28:qse[s]},mh=e=>e===ot.MONTH||e===ot.WEEK||e===ot.BIWEEK,ed=e=>e===ot.DAY||e===ot.HOUR?Dc:En,mf=(e,t)=>t===m.TextType.DATETIME||e===ot.DAY||e===ot.HOUR,$se=(e,t)=>{const n=Hs[e];let s=t.length*n;if(e===ot.YEAR){const a=t[t.length-1],o=Gse(a);s=(er(o,t[0],e)+1)*n}else e===ot.QUARTER?s=7*t.length*n:e===ot.DAY&&(s=4*t.length*n);return s},Gse=e=>new Date(e).setMonth(new Date(e).getMonth()+1,0),zse=e=>e===ot.DAY||e===ot.HOUR,VL=F.createContext(void 0),r_=()=>{const e=F.useContext(VL);if(!e)throw new Error("useBitable");return e},Wse=(e,t,n)=>{const s=ns(new Date(e).setDate(1)),a=ns(new Date(e).setMonth(new Date(e).getMonth()+1,0)),o=t.indexOf(s),i=(a-s)/Hn+1;n.querySelectorAll(".calender-date.current-month-date").forEach(u=>{u.classList.remove("current-month-date")});const c=n.querySelectorAll(".calender-date");Array.from(c).slice(o,o+i).forEach(u=>{u.classList.add("current-month-date")})},Kse=(e,t,n)=>{const s=n.querySelector(".calender-date.drag-hover-highlight");s==null||s.classList.remove("drag-hover-highlight");const a=n.querySelectorAll(".calender-date");let o,i;return Array.from(a).forEach((l,c)=>{const u=l.getBoundingClientRect();e>=u.left&&e<=u.right&&t>=u.top&&t<=u.bottom&&(o=c,i=l,l.classList.add("drag-hover-highlight"))}),{targetIndex:o,targetNode:i}},gb=new Map,qL=e=>{const{recordId:t,calendarBy:n,calendarByEnd:s,blocks:a=le().blocks}=e,o=a[t],i=`${t}-${n}-${s}-${o==null?void 0:o.updatedAt}`;if(gb.has(i))return gb.get(i);const l=Cl(o,n),c=Cl(o,s),u=l||c;let d=c;l&&c&&(d=c>=l?c:l),c||(d=l);const f={rawStartTime:l,renderStartTime:u,rawEndTime:c,renderEndTime:d};return gb.set(i,f),f},Yse=4,Xse=4,Qse=22,HL=36,I0=e=>Yse*2+Qse*e+Xse,Jse=F.memo(e=>{var V,W;const{recordId:t,renderStartTime:n,renderEndTime:s,weekStartDate:a,weekEndDate:o,isStartTime:i,isEndTime:l,weekFirstDay:c,order:u,calendarBy:d,calendarByEnd:f,calendarByType:h,calendarByEndType:p}=e,{container:g,calenderDatesRef:_}=r_(),{viewId:x}=Te(),y=Cs(),b=Ve(t,!1),[E=[]]=Ha(x,{visible:!0}),w=E.length,{illegal:k}=it(t),C=_e(t,["data","subNodes"],["segments","icon"]),T=F.useRef({renderStartTime:n,renderEndTime:s,weekStartDate:a,weekEndDate:o});T.current={renderStartTime:n,renderEndTime:s,weekStartDate:a,weekEndDate:o};const v=ke(),I=F.useRef({x:0,y:0}),j=zC(x,t);OL(x,t);const D=me(),S=Tm(),R=t===(S==null?void 0:S.id)&&x===S.viewId,A=F.useRef(null);F.useEffect(()=>{if(!R)return;const z=A.current;z&&D.dropdown({placement:"bottom-start",popcorn:z,offset:[-2,-z.clientHeight-3],closeAfterCallBack:()=>{Ye({$newCreatedRecord:void 0})},content({onCloseModal:Q}){return r.jsx("div",{className:"next-modal max-h-[80vh]",style:{width:z.clientWidth+4},children:r.jsx(eE,{site:Me.CELL,viewId:x,recordId:t,propertyId:"title",onUpdate:()=>{},onClose:Q})})}})},[]);const L=(z,Q)=>{if(z.preventDefault(),z.stopPropagation(),b)return;const Z=g.current,te=Z==null?void 0:Z.closest("[data-page-id]");if(!Z||!te)return;const re=Q===zu.left;let ne,Y={x:z.clientX,y:z.clientY};const X=ge=>{Y={x:ge.clientX,y:ge.clientY},sE({y:ge.clientY,container:te}),ue(ge.clientX,ge.clientY)},oe=()=>{te.removeEventListener("scroll",ie),document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",oe),cancelAnimationFrame(Vu),v(()=>{const ge=Zt(x);if(!ge)return;const{calendarBy:Ne,calendarByEnd:De}=ge;if(!Ne||!De)return;const{blocks:Se}=le(),Ie=Se[t];Ie&&pe(t,{data:{collectionProperties:{...Ie.data.collectionProperties}}})})},ie=()=>ue(Y.x,Y.y),ue=(ge,Ne)=>{var $t,tt;let De=1/0;if(Z.querySelectorAll(".calender-date").forEach((Ze,jt)=>{const It=Ze.getBoundingClientRect(),nn=mne(fne(It),{x:ge,y:Ne});nn<De&&(De=nn,ne=jt)}),typeof ne>"u")return;const Ie=_.current[ne];if(!Ie||re&&(Ie>ns(T.current.renderEndTime)||Ie===T.current.weekStartDate)||!re&&(Ie<ns(T.current.renderStartTime)||Ie===T.current.weekEndDate))return;const Ke=Zt(x);if(!Ke)return;const{calendarBy:dt,calendarByEnd:$e}=Ke;if(!dt||!$e)return;const{blocks:ut}=le(),Ee=ut[t];if(!Ee)return;const Ge={},Je=($t=Gr(Ee,dt))==null?void 0:$t.textType;Ge[dt]=re?[Fn({from:yi(n,Ie),includeTime:Je===m.TextType.DATETIME})]:[Fn({from:new Date(n),includeTime:Je===m.TextType.DATETIME})];const et=(tt=Gr(Ee,$e))==null?void 0:tt.textType;Ge[$e]=re?[Fn({from:s>n?new Date(s):yi(s,n),includeTime:et===m.TextType.DATETIME})]:[Fn({from:yi(s,Ie),includeTime:et===m.TextType.DATETIME})],pe(t,{data:{collectionProperties:{...Ee.data.collectionProperties,...Ge}}},!0)};te.addEventListener("scroll",ie),document.addEventListener("mousemove",X),document.addEventListener("mouseup",oe)},P=z=>{z.preventDefault();const{ui:Q}=le();if(Q.selectedBlocks.map(Ee=>Ee.blockId).includes(t)||ee(nt.updateSelectBlocks([{blockId:t,viewId:x}])),b)return;const te=[m.CollectionSchemaType.CREATED_AT,m.CollectionSchemaType.UPDATED_AT];if(h&&te.includes(h)||p&&te.includes(p))return;I.current={x:z.clientX,y:z.clientY};const re=g.current,ne=re==null?void 0:re.closest("[data-page-id]");if(!re||!ne)return;const Y=z.currentTarget,{parentElement:X}=Y;if(!X)return;const oe=Y.getBoundingClientRect(),ue=X.clientWidth/(parseFloat(X.style.width)/100)/7,ge=a+Math.floor((z.clientX-oe.left)/ue)*Hn;let Ne=!1,De,Se,Ie={x:z.clientX,y:z.clientY};const Ke=Ee=>{if(Ie={x:Ee.clientX,y:Ee.clientY},!(!Ne&&Math.abs(Ee.clientX-I.current.x)<5&&Math.abs(Ee.clientY-I.current.y)<5)){if(!Ne){Ne=!0,De=document.createElement("div"),De.style.pointerEvents="none",De.style.opacity="0.5",De.style.position="fixed",De.style.inset="0",De.style.zIndex="100";const{ui:Ge}=le();Ge.selectedBlocks.map(et=>et.blockId).forEach(et=>{re.querySelectorAll(`[data-record-id="${et}"]`).forEach(tt=>{const Ze=tt.getBoundingClientRect(),jt=tt.cloneNode(!0);jt.style.position="absolute",jt.style.width=`${Ze.width}px`,jt.style.height=`${Ze.height}px`,jt.style.top=`${Ze.top}px`,jt.style.left=`${Ze.left}px`,De==null||De.appendChild(jt)})}),document.body.appendChild(De)}sE({y:Ee.clientY,container:ne}),dt(Ee.clientX,Ee.clientY)}},dt=(Ee,Ge)=>{De&&(De.style.transform=`translate(${Ee-I.current.x}px, ${Ge-I.current.y}px)`,Se=Kse(Ee,Ge,re).targetIndex)},$e=()=>{ne.removeEventListener("scroll",ut),document.removeEventListener("mousemove",Ke),document.removeEventListener("mouseup",$e),cancelAnimationFrame(Vu),De==null||De.remove();const Ee=re.querySelector(".calender-date.drag-hover-highlight");Ee==null||Ee.classList.remove("drag-hover-highlight"),Ne&&v(()=>{if(typeof Se>"u")return;const Ge=Zt(x);if(!Ge)return;const{calendarBy:Je,calendarByEnd:et}=Ge;if(!Je||!et)return;const{blocks:$t,ui:tt}=le(),Ze=_.current[Se];if(!Ze||Ze===ge)return;const jt=Ze-ge;tt.selectedBlocks.map(nn=>nn.blockId).forEach(nn=>{var vt,_n;const{renderStartTime:N,renderEndTime:O}=qL({recordId:nn,calendarBy:Je,calendarByEnd:et,blocks:$t});if(!N||!O)return;const G=$t[nn];if(!G)return;const J=N+jt,se=J+O-N,xe={},Be=(vt=Gr(G,Je))==null?void 0:vt.textType;xe[Je]=[Fn({from:yi(N,J),includeTime:Be===m.TextType.DATETIME})];const Re=(_n=Gr(G,et))==null?void 0:_n.textType;xe[et]=[Fn({from:yi(O,se),includeTime:Re===m.TextType.DATETIME})],pe(nn,{data:{collectionProperties:{...G.data.collectionProperties,...xe}}})})})},ut=()=>{dt(Ie.x,Ie.y)};ne.addEventListener("scroll",ut),document.addEventListener("mousemove",Ke),document.addEventListener("mouseup",$e)},M={top:(u-1)*I0(w)+HL,left:fa((a-c)/Hn/7),width:fa(((o-a)/Hn+1)/7),height:I0(w)},U=((V=C==null?void 0:C.subNodes)!=null?V:[]).length>0||!!((W=C==null?void 0:C.data.icon)!=null&&W.type);return r.jsx("div",{style:M,className:B("absolute pb-1",{"pl-1.5":i,"pr-1.5":l}),children:r.jsxs(ln,{blockRef:A,id:t,viewId:x,"data-record-id":t,"data-no-cancel-selected":!0,"data-disable-select":!0,onMouseDown:P,className:"w-full h-full cursor-pointer",children:[r.jsx("div",{className:"bg-white1 relative h-full",children:r.jsxs("div",{className:B("h-full p-1",{border:!j,"rounded-l-l":i,"rounded-r":l}),onClick:z=>y(t,{illegal:k,forceOpenInRight:z.altKey,forceOpenNewTab:z.ctrlKey||z.metaKey}),style:{backgroundColor:j},children:[k&&r.jsxs(r.Fragment,{children:[r.jsx(tn,{className:"text-t2-medium mr-1 inline p-0 align-middle opacity-30",blockId:t,trigger:!1,iconSize:16,defaultIcon:r.jsx(H,{name:"MIcPage",size:"small"})}),r.jsx("span",{className:"border-b border-grey6 opacity-30",children:rs})]}),!k&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex",children:[U&&r.jsx(tn,{className:"mr-1.5 inline-flex p-0 align-middle",blockId:t,trigger:!1,iconSize:16,defaultIcon:r.jsx(as,{uuid:t,size:"small"})}),r.jsx(Pn,{className:"text-t4-medium text-ellipsis whitespace-nowrap align-middle leading-[22px]",plugins:kr,segments:C==null?void 0:C.data.segments,placeholder:aa,interactable:!1}),r.jsx(Zd,{className:"inline-flex align-middle pointer-events-none",blockId:t})]}),r.jsx(n_,{recordId:t})]})]})}),!b&&d!==f&&FH.map(z=>z===zu.left&&i&&h!==m.CollectionSchemaType.CREATED_AT&&h!==m.CollectionSchemaType.UPDATED_AT?r.jsx("div",{className:"absolute top-0 left-0 bottom-0 z-10 w-[4px] rounded-full py-0.5 hover:cursor-col-resize hover:bg-black",onMouseDown:Q=>L(Q,z)},z):z===zu.right&&l&&p!==m.CollectionSchemaType.CREATED_AT&&p!==m.CollectionSchemaType.UPDATED_AT?r.jsx("div",{className:"absolute top-0 right-0 bottom-0 z-10 w-[4px] rounded-full py-0.5 hover:cursor-col-resize hover:bg-black",onMouseDown:Q=>L(Q,z)},z):null)]},t)})}),SN=e=>{var R;const{record:t,base:n,container:s,viewType:a,isAllDay:o}=e,{uuid:i,startTime:l,endTime:c,left:u=0,recordCount:d=1}=t;_e(i,["data"],["segments"]);const f=Cs(),h=Ve(i),p=F.useRef(null),{width:g}=(R=Ba(s,"width"))!=null?R:{},{illegal:_}=it(i),{viewId:x}=Te(),y=ke(),b=zC(x,i),[E=[]]=Ha(x,{visible:!0}),w=E.length,k=ns(l),C=ns(c);let T=!1,v=!1;const{calendarByType:I,calendarByEndType:j}=PL(x);if((I===m.CollectionSchemaType.CREATED_AT||I===m.CollectionSchemaType.UPDATED_AT||I===m.CollectionSchemaType.DATE&&k!==n)&&(T=!0),(j===m.CollectionSchemaType.CREATED_AT||j===m.CollectionSchemaType.UPDATED_AT||j===m.CollectionSchemaType.DATE&&C!==n)&&(v=!0),F.useEffect(()=>{const A=p.current,L=s.current,P=A==null?void 0:A.closest("[data-page-id]");if(!A||!L||!P)return;const V=Use(A,P,L,(W,z)=>{const Q=n+W*il,Z=Q+Math.floor(z)*il,te=Zt(x);if(!te)return;const{calendarBy:re,calendarByEnd:ne}=te;if(!re||!ne)return;const Y={};T||(Y[re]=[Fn({from:new Date(Q),includeTime:!0})]),v||(Y[ne]=[Fn({from:new Date(Z),includeTime:!0})]),y(()=>{const{blocks:X}=le(),oe=X[i];oe&&pe(i,{data:{collectionProperties:{...oe.data.collectionProperties,...Y}}})})},W=>{f(i,{illegal:_,forceOpenInRight:W.altKey,forceOpenNewTab:W.ctrlKey||W.metaKey})},{disableTop:T||h||!!o,disableBottom:v||h||!!o});return()=>{V()}},[s,n,f,i,_,o,x,y,T,v,h]),F.useEffect(()=>{const A=p.current,L=s.current;if(!A||!L)return;if(o){A.style.opacity="1",A.style.width=`${L.clientWidth-Kh-13}px`;return}const P=(d-1)*pb;if(a===T0.DAY){const U=(L.clientWidth-Kh-13-P)/d;A.style.width=`${U}px`,A.style.left=`${(U+pb)*u+6}px`}else{const M=(L.clientWidth-Kh)/7,V=(M-P)/d,W=new Date(n).getDay()||7;A.style.width=`${V}px`,A.style.left=`${(V+pb)*u+(W-1)*M}px`}A.style.opacity="1"},[d,n,s,u,a,g,o]),!l||!c)return null;let D=0,S;if(o)D=I0(w);else{const A=Math.max(l,n)-n,L=Math.min(c,n+Hn)-Math.max(l,n);S=A/il*pr+Yo,D=L/il*pr}return r.jsxs(ln,{id:i,viewId:x,"data-record-id":i,blockRef:p,style:{top:S,height:D,minHeight:Ip},className:B("rounded border bg-white1 flex-shrink-0 opacity-0 overflow-hidden cursor-pointer",o?"mt-1.5":"absolute"),children:[r.jsxs("div",{className:B("relative h-full p-1",D<=pr*2?"py-0":""),style:{boxShadow:"0px 1px 3px var(--black_006)",backgroundColor:b},children:[_&&r.jsxs(r.Fragment,{children:[r.jsx(tn,{className:"text-t2-medium mr-1 inline p-0 align-middle opacity-30",blockId:i,trigger:!1,iconSize:16,defaultIcon:r.jsx(H,{name:"MIcPage",size:"small"})}),r.jsx("span",{className:"border-b border-grey6 opacity-30",children:rs})]}),!_&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex",children:r.jsx(Zse,{recordId:i,height:D})}),r.jsx(n_,{recordId:i})]})]}),!o&&!h&&r.jsxs(r.Fragment,{children:[!T&&r.jsx("div",{className:"resize-top",onClick:A=>A.stopPropagation()}),!v&&r.jsx("div",{className:"resize-bottom",onClick:A=>A.stopPropagation()})]})]},i)},Zse=({recordId:e,height:t})=>{var d,f;const{viewId:n}=Te(),s=sh(e),a=zs(),o=Tm(),i=((d=s==null?void 0:s.subNodes)!=null?d:[]).length>0||!!((f=s==null?void 0:s.data.icon)!=null&&f.type),l=e===(o==null?void 0:o.id)&&n===o.viewId,[c,u]=F.useState(l);return s?r.jsxs(r.Fragment,{children:[i&&r.jsx(tn,{className:"mr-1.5 inline-flex p-0 align-middle",blockId:e,trigger:!1,iconSize:16,defaultIcon:r.jsx(as,{uuid:e,size:"small"})}),c?r.jsx(co,{uuid:e,className:B("text-t4-medium whitespace-nowrap align-middle flex-grow-0",t>=Ip&&"leading-[22px]"),plugins:kr,keydownOption:{bracketRightKey:!1},placeholder:aa,autoFocus:!0,toolbar:!1,autoFocusCaretToEnd:!0,segments:s.data.segments,interactable:!0,onChange:h=>a(e,"title",h),onBlur:()=>{u(!1),Ye({$newCreatedRecord:void 0})},onKeyDown:h=>{if(be("mod+a")(h)){h.stopPropagation();return}(be("enter")(h)||be("esc")(h))&&h.currentTarget.blur()}}):r.jsx(Pn,{className:B("text-t4-medium text-ellipsis whitespace-nowrap align-middle",t>=Ip&&"leading-[22px]"),plugins:kr,segments:s==null?void 0:s.data.segments,placeholder:aa,interactable:!1}),r.jsx(Zd,{className:"inline-flex align-middle pointer-events-none",blockId:e})]}):null},RN=e=>(new Date().setSeconds(0,0)-ns(Date.now()))/il*e+Yo,ere=({date:e,unitHeight:t=pr})=>{const[n,s]=F.useState(RN(t)),a=F.useRef(),o=F.useRef(null),i=F.useRef(null),l=ns(Date.now());return F.useEffect(()=>(a.current=setInterval(()=>{s(RN(t))},uw),()=>{a.current&&clearInterval(a.current)}),[t]),F.useEffect(()=>{const c=o.current,u=i.current;!c||!u||(c.style.left="-5px")},[e,l]),e!==l?null:r.jsxs("div",{className:"absolute right-0 border-t border-red bg-white",style:{top:n,left:1},ref:i,children:[r.jsx("span",{className:"absolute -ml-[30px] -translate-x-full -translate-y-1/2 text-xs text-red bg-white1",children:he(new Date).format("HH:mm")}),r.jsx("span",{ref:o,className:"absolute overflow-hidden rounded-full bg-red p-1 text-red",style:{top:-4}})]})},tre=()=>{const e=he().startOf("year").valueOf();return r.jsx("div",{className:"pointer-events-none",children:new Array(24).fill(1).map((t,n)=>r.jsxs("div",{style:{height:pr*4},className:B("relative border-t",n===23?"border-b":""),children:[r.jsx("span",{className:"absolute -ml-[30px] text-t4-medium text-grey3 -translate-x-full -translate-y-1/2",children:he(e+n*il*4).format("HH:mm")}),n===23&&r.jsx("span",{className:"absolute bottom-0  -ml-[30px] -translate-x-full translate-y-1/2 text-t4-medium text-grey3",children:he(e+(n+1)*il*4).format("HH:mm")})]},n))})},nre=({currentDate:e,setToday:t})=>{var c;const{isLocked:n,managerReadonly:s,viewId:a}=Te(),o=rF(a),i=me(),l=u=>{if(n||s)return;const d=v0.map(f=>({type:$.OPERABLE_BLOCK_TEXT,data:{title:f.name,...f,selected:f.type===o}}));i.dropdown({popcorn:u.currentTarget,placement:"bottom",content:({onCloseModal:f})=>r.jsx(ze,{className:"next-modal w-[100px] py-2",items:d,onItemClick:({data:h})=>{yt(a,{calendarType:h.type}),f()}})})};return r.jsxs("div",{className:"text-t2-medium pl-2 border-t",children:[r.jsxs("div",{className:"flex items-center py-1 h-[38px]",children:[r.jsx("p",{className:"mr-auto",children:he(e).format("YYYY年MM月")}),r.jsxs("div",{className:"ml-auto flex items-center",children:[r.jsxs("button",{onClick:l,className:"text-t2 flex h-full items-center px-3 text-grey3",children:[(c=v0.find(u=>u.type===o))==null?void 0:c.name,!s&&r.jsx(H,{size:"xxxsmall",name:"IcArrow",className:"ml-1"})]}),r.jsx(Fe,{className:"rounded-sm animate-hover",onClick:()=>t(e-Hn),children:r.jsx(H,{name:"IcArrowDateBack",size:"middle"})}),r.jsx("span",{className:"bg-white1 px-2 cursor-pointer",onClick:()=>t(ns(Date.now())),children:"今天"}),r.jsx(Fe,{className:"rounded-sm animate-hover",onClick:()=>t(e+Hn),children:r.jsx(H,{name:"IcArrowDateNext",size:"middle"})})]})]}),r.jsx("div",{className:"flex h-[38px] text-t4-medium text-grey3 items-center",children:`周${"日_一_二_三_四_五_六".split("_")[he(e).day()]}`})]})},sre=()=>{const[e,t]=F.useState(ns(Date.now())),n=F.useRef(null),{isLocked:s,managerReadonly:a,viewId:o,readonly:i}=Te();rF(o),me();const l=Gi({ignoreSorters:!0}),{allDayRecord:c,timeRangeRecord:u}=Vse(e),d=h=>{if(i)return;const p=n.current;if(!p)return;const g=p.getBoundingClientRect(),_=h.clientY-Yo-g.top,x=Math.floor(_/pr),y=e+x*il,b=y+sx,E=Zt(o);if(!E)return;const{calendarBy:w,calendarByEnd:k}=E;w&&k&&l({viewId:o,where:{last:!0},propertyValues:{[w]:[Fn({from:new Date(y),includeTime:!0})],[k]:[Fn({from:new Date(b),includeTime:!0})]}})},f=h=>{if(i||h.target!==h.currentTarget)return;const p=Zt(o);if(!p)return;const{calendarBy:g,calendarByEnd:_}=p;g&&_&&l({viewId:o,where:{last:!0},propertyValues:{[g]:[Fn({from:new Date(e)})],[_]:[Fn({from:new Date(e)})]}})};return r.jsxs("div",{className:"relative flex flex-1 flex-col min-w-[300px]",children:[r.jsxs("div",{className:"sticky top-0 bg-white1 z-10 ",children:[r.jsx(nre,{setToday:t,currentDate:e}),r.jsxs("div",{className:"border min-h-[62px] flex",style:{boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.06)"},children:[r.jsx("div",{className:"flex items-center justify-center text-grey3 text-t2-medium flex-shrink-0 ",style:{width:Kh},children:"全天"}),r.jsxs("div",{className:"border-l flex-1",onDoubleClick:f,children:[r.jsx("p",{className:"pt-2 pl-3 text-t2-medium flex mb-1.5",children:r.jsx("span",{className:B(e===ns(Date.now())&&"w-6 h-6 rounded-full flex items-center justify-center -mt-0.5 -ml-1 bg-red text-white"),children:he(e).format("DD")})}),r.jsx("div",{className:"flex-1 p-1.5 pt-0 max-h-[150px] overflow-auto",onDoubleClick:f,children:c.map(h=>r.jsx(SN,{base:e,record:h,viewType:T0.DAY,container:n,isAllDay:!0},h.uuid))})]})]})]}),r.jsx("div",{className:"flex-1 border-x border-b",ref:n,style:{paddingLeft:Kh},children:r.jsxs("div",{className:"relative border-l bg-grey8",style:{padding:`${Yo}px 0`,height:24*pr*4+Yo*2},children:[r.jsx(tre,{}),r.jsx("div",{className:"absolute inset-0 overflow-hidden",onDoubleClick:d,children:u.map(h=>r.jsx(SN,{base:e,record:h,viewType:T0.DAY,container:n},h.uuid))}),r.jsx(ere,{date:e})]})})]})},rre={lunarInfo:[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,92821,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42416,83315,21168,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448,84835,37744,18936,18800,25776,92326,59984,27424,108228,43744,37600,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,84821,19296,42352,21732,53600,59752,54560,55968,92838,22224,19168,43476,41680,53584,62034,54560],solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],Gan:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],Zhi:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],Animals:["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],festival:{"1-1":{title:"元旦节"},"2-14":{title:"情人节"},"5-1":{title:"劳动节"},"5-4":{title:"青年节"},"6-1":{title:"儿童节"},"9-10":{title:"教师节"},"10-1":{title:"国庆节"},"12-25":{title:"圣诞节"},"3-8":{title:"妇女节"},"3-12":{title:"植树节"},"4-1":{title:"愚人节"},"5-12":{title:"护士节"},"7-1":{title:"建党节"},"8-1":{title:"建军节"},"12-24":{title:"平安夜"}},lFestival:{"12-30":{title:"除夕"},"1-1":{title:"春节"},"1-15":{title:"元宵节"},"2-2":{title:"龙抬头"},"5-5":{title:"端午节"},"7-7":{title:"七夕节"},"7-15":{title:"中元节"},"8-15":{title:"中秋节"},"9-9":{title:"重阳节"},"10-1":{title:"寒衣节"},"10-15":{title:"下元节"},"12-8":{title:"腊八节"},"12-23":{title:"北方小年"},"12-24":{title:"南方小年"}},getFestival(){return this.festival},getLunarFestival(){return this.lFestival},setFestival(e={}){this.festival=e},setLunarFestival(e={}){this.lFestival=e},solarTerm:["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],sTermInfo:["9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","9778397bd19801ec9210c965cc920e","97b6b97bd19801ec95f8c965cc920f","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd197c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bcf97c3598082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd19801ec9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bd07f1487f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b97bd197c36c9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b70c9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","977837f0e37f149b0723b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0723b06bd","7f07e7f0e37f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f595b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e37f14998083b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14898082b0723b02d5","7f07e7f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66aa89801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e26665b66a449801e9808297c35","665f67f0e37f1489801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722"],nStr1:["日","一","二","三","四","五","六","七","八","九","十"],nStr2:["初","十","廿","卅"],nStr3:["正","二","三","四","五","六","七","八","九","十","冬","腊"],lYearDays:function(e){let t,n=348;for(t=32768;t>8;t>>=1)n+=this.lunarInfo[e-1900]&t?1:0;return n+this.leapDays(e)},leapMonth:function(e){return this.lunarInfo[e-1900]&15},leapDays:function(e){return this.leapMonth(e)?this.lunarInfo[e-1900]&65536?30:29:0},monthDays:function(e,t){return t>12||t<1?-1:this.lunarInfo[e-1900]&65536>>t?30:29},solarDays:function(e,t){if(t>12||t<1)return-1;const n=t-1;return n===1?e%4===0&&e%100!==0||e%400===0?29:28:this.solarMonth[n]},toGanZhiYear:function(e){var t=(e-3)%10,n=(e-3)%12;return t===0&&(t=10),n===0&&(n=12),this.Gan[t-1]+this.Zhi[n-1]},toAstro:function(e,t){const n="魔羯水瓶双鱼白羊金牛双子巨蟹狮子处女天秤天蝎射手魔羯",s=[20,19,21,21,21,22,23,23,23,23,22,22];return n.substr(e*2-(t<s[e-1]?2:0),2)+"座"},toGanZhi:function(e){return this.Gan[e%10]+this.Zhi[e%12]},getTerm:function(e,t){if(e<1900||e>2100||t<1||t>24)return-1;const n=this.sTermInfo[e-1900],s=[];for(let a=0;a<n.length;a+=5){const o=parseInt("0x"+n.substr(a,5)).toString();s.push(o[0],o.substr(1,2),o[3],o.substr(4,2))}return parseInt(s[t-1])},toChinaMonth:function(e){if(e>12||e<1)return-1;let t=this.nStr3[e-1];return t+="月",t},toChinaDay:function(e){let t;switch(e){case 10:t="初十";break;case 20:t="二十";break;case 30:t="三十";break;default:t=this.nStr2[Math.floor(e/10)],t+=this.nStr1[e%10]}return t},getAnimal:function(e){return this.Animals[(e-4)%12]},solar2lunar:function(e,t,n){let s=parseInt(e),a=parseInt(t),o=parseInt(n);if(s<1900||s>2100||s===1900&&a===1&&o<31)return-1;let i;s?i=new Date(s,parseInt(a)-1,o):i=new Date;let l,c=0,u=0;s=i.getFullYear(),a=i.getMonth()+1,o=i.getDate();let d=(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())-Date.UTC(1900,0,31))/864e5;for(l=1900;l<2101&&d>0;l++)u=this.lYearDays(l),d-=u;d<0&&(d+=u,l--);let f=new Date,h=!1;f.getFullYear()===s&&f.getMonth()+1===a&&f.getDate()===o&&(h=!0);let p=i.getDay(),g=this.nStr1[p];p===0&&(p=7);const _=l;c=this.leapMonth(l);let x=!1;for(l=1;l<13&&d>0;l++)c>0&&l===c+1&&x===!1?(--l,x=!0,u=this.leapDays(_)):u=this.monthDays(_,l),x===!0&&l===c+1&&(x=!1),d-=u;d===0&&c>0&&l===c+1&&(x?x=!1:(x=!0,--l)),d<0&&(d+=u,--l);const y=l,b=d+1,E=a-1,w=this.toGanZhiYear(_),k=this.getTerm(s,a*2-1),C=this.getTerm(s,a*2);let T=this.toGanZhi((s-1900)*12+a+11);o>=k&&(T=this.toGanZhi((s-1900)*12+a+12));let v=!1,I=null;k===o&&(v=!0,I=this.solarTerm[a*2-2]),C===o&&(v=!0,I=this.solarTerm[a*2-1]);const j=Date.UTC(s,E,1,0,0,0,0)/864e5+25567+10,D=this.toGanZhi(j+o-1),S=this.toAstro(a,o),R=s+"-"+a+"-"+o,A=_+"-"+y+"-"+b,L=this.festival,P=this.lFestival,M=a+"-"+o;let U=y+"-"+b;return y===12&&b===29&&this.monthDays(_,y)===29&&(U="12-30"),{date:R,lunarDate:A,festival:L[M]?L[M].title:null,lunarFestival:P[U]?P[U].title:null,lYear:_,lMonth:y,lDay:b,Animal:this.getAnimal(_),IMonthCn:(x?"闰":"")+this.toChinaMonth(y),IDayCn:this.toChinaDay(b),cYear:s,cMonth:a,cDay:o,gzYear:w,gzMonth:T,gzDay:D,isToday:h,isLeap:x,nWeek:p,ncWeek:"星期"+g,isTerm:v,Term:I,astro:S}},lunar2solar:function(e,t,n,s){e=parseInt(e),t=parseInt(t),n=parseInt(n),s=!!s;const a=this.leapMonth(e);if(this.leapDays(e),s&&a!==t||e===2100&&t===12&&n>1||e===1900&&t===1&&n<31)return-1;const o=this.monthDays(e,t);let i=o;if(s&&(i=this.leapDays(e,t)),e<1900||e>2100||n>i)return-1;let l=0,c;for(c=1900;c<e;c++)l+=this.lYearDays(c);let u=0,d=!1;for(c=1;c<t;c++)u=this.leapMonth(e),d||u<=c&&u>0&&(l+=this.leapDays(e),d=!0),l+=this.monthDays(e,c);s&&(l+=o);const f=Date.UTC(1900,1,30,0,0,0),h=new Date((l+n-31)*864e5+f),p=h.getUTCFullYear(),g=h.getUTCMonth()+1,_=h.getUTCDate();return this.solar2lunar(p,g,_)}},are=(e,t)=>{const{viewId:n,collectionId:s}=Te();return vm(n),ae(a=>{const{blocks:o,collectionViews:i}=a,l=o[s],c=[],u=i[n];if(!u||!l)return c;const{calendarBy:d="",calendarByEnd:f=""}=u.format,h=uc({viewId:n,state:a}),{schema:p={}}=l.data;h.forEach(x=>{var I,j;const{rawStartTime:y,renderStartTime:b,rawEndTime:E,renderEndTime:w}=qL({recordId:x,calendarBy:d,calendarByEnd:f,blocks:o});if(!b||!w)return;const k=ns(b),C=ns(w);if(C<e||k>t)return;const T=k>=e&&k<=t?k:e,v=C>=e&&C<=t?C:t;c.push({calendarBy:d,calendarByEnd:f,calendarByType:(I=p[d])==null?void 0:I.type,calendarByEndType:(j=p[f])==null?void 0:j.type,recordId:x,rawStartTime:y,rawEndTime:E,renderStartTime:b,renderEndTime:w,weekStartDate:T,weekEndDate:v,isStartTime:T===k,isEndTime:v===C,order:1})});const g=Xb(c,x=>x.weekStartDate),_={};return g.forEach(x=>{var w,k;let y=0;const b=_[x.weekStartDate];b&&(y=Object.entries(Xb(b)).findIndex(([C,T])=>Number(C)!==T),y=y===-1?b.length:y);let E=x.weekStartDate;for(;E<=x.weekEndDate;)_[E]=(w=_[E])!=null?w:[],(k=_[E])==null||k.push(y),E+=Hn;x.order=y+1}),g},{equalityFn:rn})},ore=F.memo(({weekFirstDay:e,weekLastDay:t,weekRef:n})=>{const s=are(e,t),{viewId:a}=Te(),o=Cr(),[i=[]]=Ha(a,{visible:!0}),l=i.length;return F.useEffect(()=>{const c=n.current;if(!c)return;const u=o?80:124;if(s.length===0)c.style.height=`${u}px`;else{const d={};s.forEach(p=>{let g=p.weekStartDate;for(;g<=p.weekEndDate;)d[g]=(d[g]||0)+1,g=g+Hn});const h=Math.max(...Object.values(d))*I0(l)+HL;c.style.height=`${Math.max(h,u)}px`}},[o,s,l,n]),s.length===0?null:r.jsx(r.Fragment,{children:s.map(c=>F.createElement(Jse,{...c,key:c.recordId,weekFirstDay:e}))})}),ire=F.memo(({dates:e,setCurrentMonth:t})=>{const{container:n,calenderHeader:s}=r_(),a=Cr(),o=F.useRef(null);return F.useEffect(()=>{var d;const i=(d=n.current)==null?void 0:d.closest("[data-page-id]"),l=o.current,c=s.current;if(!i||!l||!c)return;const u=()=>{const f=l.getBoundingClientRect(),h=c.getBoundingClientRect();f.top<h.bottom&&f.bottom>h.bottom&&t(p=>{const g=e[e.length-1];if(!g)return p;const _=g+Hn;return _!==p?ns(new Date(_).setDate(1)):p})};return i.addEventListener("scroll",u),()=>i.removeEventListener("scroll",u)},[s,n,e,t]),r.jsxs("div",{className:B("flex w-full relative calender-week",a?"min-h-[64px]":"min-h-[124px]"),ref:o,children:[e.map(i=>r.jsx(lre,{date:i},i)),r.jsx(ore,{weekFirstDay:e[0],weekLastDay:e[e.length-1],weekRef:o})]})},kn),lre=F.memo(({date:e})=>{e+=12*sx;const{startDay:t}=r_(),{viewId:n,readonly:s}=Te(),a=oR(n),o=Gi({ignoreSorters:!0}),i=Cr(),l=oD()===ns(e),c=new Date(e),u=c.getDate(),d=c.getDay()===0,f=c.getDay()===1,h=c.getMonth()+1,p=rre.solar2lunar(c.getFullYear(),h,u),g=()=>{if(s)return;const _=Zt(n);if(!_)return;const{calendarBy:x,calendarByEnd:y}=_;x&&y&&o({viewId:n,where:{last:!0},propertyValues:{[x]:[Fn({from:new Date(e)})],[y]:[Fn({from:new Date(e)})]}})};return r.jsx("div",{onDoubleClick:g,"data-date":e,className:B("min-h-full border-r border-b border-grey6 calender-date flex-1 text-right flex justify-between group relative flex-shrink-0 text-t2 text-grey3",t===m.DaySetting.MON?f&&"border-l":d&&"border-l"),children:r.jsxs("div",{className:"h-10 pt-2 px-2 flex justify-between w-full",children:[!s&&r.jsx(Fe,{popup:"创建新页面",placement:"top",className:`absolute top-1.5 left-1.5 opacity-0 group-hover:opacity-100 cursor-pointer duration-150
            text-black text-sm w-6 h-6 bg-white1 border rounded flex items-center justify-center text-center`,onClick:g,children:r.jsx(H,{name:"IcBtnNew",size:"middle",className:"text-grey3"})}),r.jsxs("div",{className:B("flex w-full",a?"justify-between":"justify-end"),children:[a&&r.jsx("span",{className:"text-t3",children:!i&&p!==-1&&r.jsx(r.Fragment,{children:p.lunarFestival||p.Term?p.lunarFestival||p.Term:p.lDay===1?p.IMonthCn:p.IDayCn})}),r.jsx("span",{className:B("ml-1",l&&"calendar-today w-6 h-6 bg-red inline-block text-center text-white rounded-full"),children:u===1?`${h}月${u}日`:u})]})]})})}),Sp=(e,t="init",n)=>{let s=0,a=0;if(t==="init"){const u=n?new Date(n):new Date,d=u.getMonth(),f=u.setMonth(d,1),h=u.setMonth(d+2,0);s=ns(f-((new Date(f).getDay()||7)-1)*Hn)-Hn,a=ns(h-((new Date(h).getDay()||7)-1)*Hn)+Hn*5}if(t==="append"&&n){const u=new Date(n),d=u.setMonth(u.getMonth()+2,0);s=n,a=ns(d-((new Date(d).getDay()||7)-1)*Hn)+Hn*5}const o=t==="append"?n:e===m.DaySetting.MON?s+Hn:s,i=e===m.DaySetting.MON?a+Hn:a,l=[];let c=o;if(!c)return l;for(;c<=i;)l.push(c),c+=Hn;return l},rE=(e,t=Date.now())=>{const n=new Date(t),s=n.getMonth(),a=n.setMonth(s,1),o=n.setMonth(s+1,0),i=ns(a-((new Date(a).getDay()||7)-1)*Hn),l=i-Hn,u=ns(o-((new Date(o).getDay()||7)-1)*Hn)+Hn*5,d=e===m.DaySetting.MON?i:l,f=e===m.DaySetting.MON?u+Hn:u,h=[];let p=d;for(;p<=f;)h.push(p),p+=Hn;return h},cre=({currentMonth:e,setCurrentMonth:t})=>{var x;const{calenderHeader:n,setCalenderDates:s,container:a,calenderDates:o,embed:i,startDay:l}=r_(),{isLocked:c,managerReadonly:u,viewId:d}=Te(),f=rF(d),h=me();F.useEffect(()=>{const y=a.current;y&&Wse(e,o,y)},[o,a,e]);const p=y=>{let b=Date.now();if(y==="today")b=new Date().setDate(2);else{const E=new Date(e),w=E.getMonth(),k=y==="pre"?w-1:w+1;b=E.setMonth(k,1)}if(t(b),i)s(rE(l,b));else{const E=a.current,w=E==null?void 0:E.closest("[data-page-id]");if(!w)return;s(Sp(l,"init",b)),w.scrollTop=0}},g=y=>{if(c||u)return;const b=v0.map(E=>({type:$.OPERABLE_BLOCK_TEXT,data:{title:E.name,...E,selected:E.type===f}}));h.dropdown({popcorn:y.currentTarget,placement:"bottom",content:({onCloseModal:E})=>r.jsx(ze,{className:"next-modal w-[100px] py-2",items:b,onItemClick:({data:w})=>{yt(d,{calendarType:w.type}),E()}})})},_=new Date(e);return r.jsxs("div",{className:"sticky w-full flex-shrink-0 justify-between border-b border-t bg-white1 z-10 text-t2-medium",style:{top:i?hC:cc},ref:n,children:[r.jsxs("div",{className:"flex items-center h-[38px] pl-4",children:[r.jsx("div",{className:"h-full flex bg-white1",children:e&&r.jsxs("span",{className:"h-full inline-flex items-center",children:[_.getFullYear(),"年",_.getMonth()+1,"月"]})}),r.jsxs("div",{className:"ml-auto flex items-center",children:[r.jsxs("button",{onClick:g,className:"text-t2 flex h-full items-center px-3 text-grey3",children:[(x=v0.find(y=>y.type===f))==null?void 0:x.name,!u&&r.jsx(H,{size:"xxxsmall",name:"IcArrow",className:"ml-1"})]}),r.jsx(Fe,{className:"rounded-sm animate-hover",onClick:()=>p("pre"),children:r.jsx(H,{name:"IcArrowDateBack",size:"middle"})}),r.jsx("span",{className:"bg-white1 px-2 cursor-pointer",onClick:()=>p("today"),children:"今天"}),r.jsx(Fe,{className:"rounded-sm animate-hover",onClick:()=>p("next"),children:r.jsx(H,{name:"IcArrowDateNext",size:"middle"})})]})]}),r.jsx("div",{className:"flex h-[38px]",children:(l===m.DaySetting.MON?"一_二_三_四_五_六_日":"日_一_二_三_四_五_六").split("_").map(y=>r.jsxs("div",{className:"flex-1 flex items-center justify-center text-grey3",children:["周",y]},y))})]})},ure=F.memo(({embed:e})=>{const t=Vw(),[n,s]=F.useState(e?rE(t):Sp(t)),a=F.useRef([]),o=F.useRef(null),i=F.useRef(null);F.useEffect(()=>{s(e?rE(t):Sp(t))},[e,t]);const l=F.useMemo(()=>({embed:e,startDay:t,container:o,calenderDates:n,setCalenderDates:s,calenderDatesRef:a,calenderHeader:i}),[n,e,t]);return a.current=n,r.jsx(VL.Provider,{value:l,children:r.jsx(dre,{})})}),dre=()=>{const{viewId:e}=Te(),{container:t,calenderDates:n,setCalenderDates:s,embed:a,startDay:o}=r_(),i=F.useRef(!1),[l,c]=F.useState(ns(new Date().setDate(2)));return F.useEffect(()=>{var f;if(a)return;const u=(f=t.current)==null?void 0:f.closest("[data-page-id]");if(!u)return;const d=()=>{u.scrollHeight<u.scrollTop+u.clientHeight+200&&!i.current&&(i.current=!0,s(h=>h.concat(Sp(o,"append",h[h.length-1]+Hn))))};return u.addEventListener("scroll",d),()=>u.addEventListener("scroll",d)},[t,a,s,o]),F.useEffect(()=>{var d;if(a)return;i.current=!1;const u=(d=t.current)==null?void 0:d.closest("[data-page-id]");u&&u.scrollHeight<=u.clientHeight&&s(f=>f.concat(Sp(o,"append",f[f.length-1]+Hn)))},[n.length,t,a,s,o]),r.jsxs(r.Fragment,{children:[r.jsx(cre,{currentMonth:l,setCurrentMonth:c}),r.jsx("div",{"data-view-id":e,className:"max-h-full w-full mx-auto flex items-center flex-col overflow-auto relative calendar-container",style:{background:o===m.DaySetting.MON?"linear-gradient(90deg, transparent 71.42857142857143%, var(--grey8) 71.42857142857143%)":"linear-gradient(90deg, var(--grey8) 14.285714285%, transparent 14.285714285%, transparent 85.714285714%, var(--grey8) 85.714285714%)"},ref:t,children:r.jsx("div",{className:"w-full",children:n.map((u,d)=>d%7===0?r.jsx(ire,{dates:n.slice(d,d+7),setCurrentMonth:c},u):null)})})]})};const fre=()=>{const{viewId:e,collectionId:t,readonly:n,managerReadonly:s,embed:a}=Te(),o=OC(),i=fu(e),l=ae(u=>{const{collectionViews:d}=u,f=d[e];if(!f)return J2(()=>null);const{calendarBy:h=""}=f.format,p=hr(g=>{const _=le().blocks[g];return Cl(_,h)},Fa(Iu));return J2(g=>{if(i==null)return null;if(i.withoutValidGroup){const _=i.sortedRecordIds.slice(0);_.sort(p);const x=_.indexOf(g);return x>=0?{records:_,index:x}:null}for(const _ of i.visibleGroups){const x=_.recordIds.slice(0);x.sort(p);const y=x.indexOf(g);if(y>=0)return{records:x,index:y}}return null})});oZ(e,l);const c=ae(({blocks:u,collectionViews:d})=>{var E,w,k;const f=u[t],h=d[e],p=(E=f==null?void 0:f.data.schema)!=null?E:{};if(!h)return;const{calendarBy:g="",calendarByEnd:_=""}=h.format,x={updateCalendarBy:!1,updateCalendarByEnd:!1},y=(w=p[g])==null?void 0:w.type,b=(k=p[_])==null?void 0:k.type;return y!==m.CollectionSchemaType.DATE&&y!==m.CollectionSchemaType.CREATED_AT&&y!==m.CollectionSchemaType.UPDATED_AT&&(x.updateCalendarBy=!0),b!==m.CollectionSchemaType.DATE&&b!==m.CollectionSchemaType.CREATED_AT&&b!==m.CollectionSchemaType.UPDATED_AT&&(x.updateCalendarByEnd=!0),x},{equalityFn:Cn});return F.useEffect(()=>{n||s||c&&(c.updateCalendarBy||c.updateCalendarByEnd)&&o(e)},[o,c,n,e,s]),c?c.updateCalendarBy||c.updateCalendarByEnd?n||s?r.jsx("div",{className:"text-t2 h-[35px] flex items-center pl-2",children:"当前视图无有效日期属性，无法展示"}):null:i!=null&&i.sortedRecordIds?r.jsxs("div",{className:"min-w-[300px]",children:[r.jsx(ure,{embed:!!a}),!n&&!a&&r.jsx(To,{type:"collection"})]}):null:null},mre=()=>{const{viewId:e}=Te();return rF(e)==="month"?r.jsx(fre,{}):r.jsx(sre,{})};var Rp=(e=>(e.lxgwWenKai="LXGW WenKai",e.sourceHanSerif="source-han-serif-sc-regular",e))(Rp||{});const $L=e=>{var l,c;const t=_e(e,["data"],["format"]),n=t==null?void 0:t.data.format,s=t==null?void 0:t.spaceId,a=di(s),o=(l=n==null?void 0:n.pageLayout)!=null?l:"default",i=(c=n==null?void 0:n.fontFormat)!=null?c:"default";return a?{pageLayout:"default",fontFormat:"default"}:{pageLayout:o,fontFormat:i}},ZF=e=>{const{fontFormat:t,pageLayout:n}=$L(e);let s="";const a={};return n==="compact"?s="line-compact":n==="loose"&&(s="line-loose"),t==="lxgwWenKai"?a.fontFamily="LXGW WenKai":t==="sourceHanSerif"&&(a.fontFamily="source-han-serif-sc-regular"),{fontStyle:a,pageLayoutClassName:s}},WC=ia(null),hre=e=>{var C;const{required:t,children:n,index:s,renderDragHandle:a,title:o,description:i,showDescription:l,formSerialNumber:c=!0,viewId:u,property:d,titleAfter:f,titleBefore:h,readonly:p}=e,g=uh(),_=iL(u,d),x=F.useRef(null),y=ps(u),E=((C=y==null?void 0:y.format.formLogic)!=null?C:[]).filter(T=>T.condition.property===d||T.gotoProperty===d),w=sa(WC),k=T=>{g(e.property,Br(T.currentTarget),qn.FORM_PROPERTIES,"left")};return r.jsxs("div",{className:"mb-5 px-2","data-form-property":d,children:[r.jsx("div",{className:"text-t1-medium flex items-center min-h-10 py-2.5 relative group",children:r.jsxs("div",{className:"flex w-full",children:[!p&&a({className:"absolute -left-6 top-4 pr-1.5 opacity-0 group-hover:opacity-80 transition-opacity",popup:"拖拽排列顺序",onClick:T=>{T.preventDefault(),k(T)}}),h&&r.jsx("span",{className:"flex-shrink-0",children:h}),c&&r.jsxs("span",{className:"flex-shrink-0",children:[s,"."]}),r.jsx(oo,{ref:x,readonly:!0,boxClassName:o?"":"min-w-[80px]",value:o,placeholder:p?"未命名标题":"请输入标题"}),t&&r.jsx("span",{className:"text-red",children:"*"}),f&&r.jsx("span",{className:"flex-shrink-0",children:f}),E.length>=1&&!p&&r.jsxs("span",{onClick:()=>{w(()=>d)},className:"cursor-pointer text-t4 text-[#717374] bg-grey bg-opacity-20 rounded-sm inline-block px-1.5 my-1 leading-5 ml-2",children:["跳题逻辑 ",E.length,"项"]})]})}),l&&(p&&i||!p)&&r.jsx("div",{className:"py-2",onPointerDown:T=>T.stopPropagation(),children:r.jsx(co,{keydownOption:sA,readonly:p,uuid:d,className:"text-grey3 text-t1 whitespace-pre-wrap",placeholder:p?"":"请输入说明介绍",segments:i,onChange:T=>{de(T).length<=1e3&&_("description",T)}})}),r.jsx("div",{onPointerDown:T=>T.stopPropagation(),children:n})]})},pre=e=>{const{submitData:t,property:n,handleChangeSubmitData:s}=e,a=de(t).toUpperCase()==="YES",o=()=>{s(n,mt(a?"NO":"YES"))};return r.jsx("div",{className:"h-11 flex items-center w-full animate-hover-black3 rounded-none",onClick:o,children:r.jsx(Js,{size:24,className:"cursor-pointer",children:r.jsx(Ra,{checked:a})})})},gre=e=>{const{type:t,schema:n,submitData:s,property:a,handleChangeSubmitData:o,collectionId:i,readonly:l}=e,{options:c=[]}=n||{},u=t===m.CollectionSchemaType.MULTI_SELECT,d=me(),f=SC(),h=_a(),p=AC(),g=$B(),_=On(),x=T=>{let v=de(s).split(",");v.some(j=>T===j&&T&&j)&&s?v=v.filter(j=>j!==T):u?v.push(T):v=[T],o(a,mt(v.join(",")))},y=T=>{h(i,a,{options:T})},b=F.useMemo(()=>{var v,I,j;const T=wr.map(D=>D.key);return(j=RC(T,(I=(v=n==null?void 0:n.options)==null?void 0:v.map(D=>D.color))!=null?I:[]))!=null?j:wr[0].key},[n==null?void 0:n.options]),E=()=>{const T=qe(),v=`选项${c.length+1}`;f(i,a,{id:T,value:v,color:b}),setTimeout(()=>{const I=ug(`[data-form-property="${a}"] [data-form-select-option-id="${T}"]`,_)[0];I&&I.click()},0)},w=(T,v)=>{p(i,a,{id:T,value:v})},k=T=>{d.warning({title:r.jsx("div",{className:"mt-5 mb-5 w-80",children:"是否确认删除该选项？"}),confirm:()=>{g(i,a,T)}})},C=(T,v,I)=>{T.stopPropagation();let j=I,D=!1;const S=T.currentTarget.parentNode.getBoundingClientRect();d.dropdown({popcorn:T.currentTarget,placement:"bottom-start",offset:[-4,0],escCloseBeforeCallBack:()=>{D=!0},closeAfterCallBack:()=>{j=j.split(",").join(""),!(D||!j)&&(c.some(R=>R.value===j&&R.id!==v)?ye.error("已存在同名选项"):w(v,j))},content:R=>r.jsx("div",{className:"next-modal p-2",style:{width:S.width},children:r.jsx(xt,{defaultValue:j,autoFocus:!0,showBorder:!1,inputClassName:"text-t2 bg-white2 px-1",className:"bg-white2",onChange:A=>{A.split(",").join(""),c.some(L=>L.value===j&&L.id!==v)&&ye.error("已存在同名选项"),j=A},onEnter:()=>R.onCloseModal()})})})};return r.jsxs(r.Fragment,{children:[r.jsx(vr,{disabled:l,items:c,onChange:y,renderItemContent:({item:T,renderDragHandle:v})=>{const I=de(s).split(",").some(j=>j===T.value&&j&&T.value);return r.jsxs("div",{className:"group relative flex w-full animate-hover-black3 rounded-none py-2 mx-1 mr-4",onClick:()=>x(T.value),children:[!l&&v({className:"absolute -left-5 top-3 opacity-0 group-hover:opacity-80 transition-opacity"}),u?r.jsx(Ra,{size:"large",checked:I}):r.jsx(H,{className:B("mr-1.5 mt-0.5",I&&"text-active_color"),name:I?"MIcRadioSelected":"IcRadio",size:"middle"}),r.jsx("div",{"data-form-select-option-id":T.id,className:B("break-words",l&&"pointer-events-none"),onClick:j=>C(j,T.id,T.value),children:r.jsx(Fe,{popup:"点击修改选项名",children:r.jsx(oo,{readonly:!0,className:"cursor-pointer min-w-[80px]",placeholder:"输入选项名",value:T.value})})}),!l&&r.jsx(H,{className:"ml-2 absolute right-1 text-grey4 opacity-0 group-hover:opacity-100 transition-opacity",name:"IcOptionDelete",size:"middle",onClick:j=>{j.stopPropagation(),k(T.id)}})]})}}),!l&&r.jsxs("div",{className:"flex items-center px-1 cursor-pointer animate-hover text-t1 text-grey4 py-1.5",onClick:E,children:[r.jsx(H,{name:"MIcAddNew",size:"middle",className:"mr-1 opacity-60"}),r.jsx("span",{children:"添加选项"})]})]})},_re=e=>{var h,p,g,_;const[t,n]=F.useState(!1),{submitData:s,handleChangeSubmitData:a,property:o,collectionId:i}=e,l=s==null?void 0:s.find(x=>[m.TextType.DATE,m.TextType.DATETIME].includes(x.type)),c=l?Ec(l):null,u=_a(),d=qa(i,o),f=l&&Wp(l,(h=d.propertySchema)==null?void 0:h.dateFormat,(l==null?void 0:l.type)===m.TextType.DATETIME,(p=d.propertySchema)==null?void 0:p.timeFormat);return r.jsx(og,{visible:t,onClick:()=>n(!0),onChange:n,placement:"bottom",content:r.jsx(_F,{uiOption:{hasFormatSetting:!e.readonly},dateInfo:{from:c!=null?c:new Date,includeTime:(l==null?void 0:l.type)===m.TextType.DATETIME,dateFormat:(g=d.propertySchema)==null?void 0:g.dateFormat,timeFormat:(_=d.propertySchema)==null?void 0:_.timeFormat},onChange:x=>{a(o,[Fn(x)]),e.readonly||u(i,o,{dateFormat:x.dateFormat,timeFormat:x.timeFormat})},onClear:()=>{a(o,mt("")),n(!1)}}),children:r.jsx("div",{className:B("text-t1 py-2.5 px-2 border border-grey6 rounded cursor-pointer",!f&&"text-grey6"),children:f||"年/月/日"})})},xre=e=>{const{submitData:t,handleChangeSubmitData:n,property:s,pushUploadFileList:a,uploadFileList:o=[],readonly:i,spaceId:l,viewId:c}=e,u=Ma(),d=jz(),f=fk(),h=me(),p=Kt(),g=y=>{var C;let b=0;const E=qe();if(!i||!l){ye.error("当前状态无法上传");return}if(!y[0])return;((C=K.collectionViews[c])==null?void 0:C.format.formPermission)===m.FormPermission.NO_LOGIN?Array.from(y).forEach(T=>{d({file:T,type:"file",spaceId:l,viewId:c,isDatabase:!0,onProgress(v){h.loading({modalId:E,title:`正在上传 ${v}%`})},async onComplete(v){if(b++,b===y.length&&p(E),v.success){const I=await f(T),j=b2({name:T.name,ossName:v.ossName,...I});ye.success(`${T.name}上传成功`),n(s,[j],{concatSegment:!0}),a(s,`${j.uuid}`,URL.createObjectURL(T))}}})}):Array.from(y).forEach(T=>{u({file:T,type:"file",spaceId:l,isDatabase:!0,onProgress(v){h.loading({modalId:E,title:`正在上传 ${v}%`})},async onComplete(v){if(b++,b===y.length&&p(E),v.success){const I=await f(T),j=b2({name:T.name,ossName:v.ossName,...I});ye.success(`${T.name}上传成功`),n(s,[j],{concatSegment:!0}),a(s,`${j.uuid}`,URL.createObjectURL(T))}}})})},_=y=>{if(!y)return;const b=t==null?void 0:t.filter(E=>E.uuid!==y);n(s,b)},x=y=>{n(s,y)};return t!=null&&t.length?r.jsx(og,{placement:"bottom",content:r.jsxs("div",{className:"next-modal max-w-lg min-w-[500px]",children:[r.jsx("div",{className:"overflow-y-auto max-h-[50vh]",children:r.jsx(vr,{modifiers:[qE],items:t.map(y=>({id:`${y.uuid}`,data:y})),onChange:y=>x(y.map(b=>b.data)),renderItemContent:({item:y,renderDragHandle:b})=>{var C;const E=cn.image.test(sn(y.data.text).extName),w=(C=o.find(T=>T.id===y.data.uuid))==null?void 0:C.url;let k=r.jsxs("span",{className:"text-t2 px-1 flex items-center w-full",children:[r.jsx(H,{name:pa(sn(y.data.text).extName),size:"middle",className:"mr-2"}),y.data.text]});return E&&(k=r.jsx("img",{className:"max-h-[165px]",src:w,alt:y.data.text})),r.jsxs("div",{className:"flex px-4 py-2.5 pr-11 relative",children:[b({className:"mr-2 mt-1"}),k,r.jsx(Fe,{popup:"移除文件",className:"absolute right-4 top-3 animate-hover cursor-pointer text-grey4",children:r.jsx(H,{onClick:()=>_(y.data.uuid),name:"IcOptionDelete",size:"middle"})})]},y.data.uuid)}})}),r.jsxs(Z2,{className:"animate-hover rounded-none relative flex items-center text-t2 w-full text-grey3 h-10 border-t border-grey6 cursor-pointer px-4",multiple:!0,onSelect:y=>{g(y)},children:[r.jsx(H,{name:"MIcAddNew",size:"middle",className:"mr-1"}),"添加附件或图片"]})]}),children:r.jsx("div",{className:B("border border-grey6 rounded px-1 pt-2 cursor-pointer flex items-center flex-wrap",t.length===0&&"pb-2"),children:t.map(y=>{var w;const b=cn.image.test(sn(y.text).extName),E=(w=o.find(k=>k.id===y.uuid))==null?void 0:w.url;return E&&b?r.jsx("img",{className:"h-7 mr-1.5 mb-2",src:E,alt:y.text},y.uuid):r.jsx("span",{className:"text-t2 px-1 bg-grey6 mr-1.5 mb-2",children:y.text},y.uuid)})})}):r.jsx(Fe,{popup:"支持多选",children:r.jsxs(Z2,{className:"relative flex items-center text-t1 w-full text-grey4 h-11 rounded bg-grey8 cursor-pointer px-2",multiple:!0,onSelect:y=>{g(y)},children:[r.jsx(H,{name:"IcBlockFile",size:"middle",className:"mr-1"}),"点击上传文件"]})})},Fre=e=>{var f;const{property:t,schema:n,submitData:s,handleChangeSubmitData:a,type:o}=e,i=F.useMemo(()=>{const h={tooltip:"",icon:"",url:pi(s),href:""};switch(o){case m.CollectionSchemaType.EMAIL:GI(h.url)&&(h.tooltip="发送邮件",h.icon="IcTitleEmail",h.href=`mailto:${h.url}`);break;case m.CollectionSchemaType.PHONE:h6(h.url)&&(h.tooltip="拨打电话",h.icon="IcTitlePhone",h.href=`tel:${h.url}`);break;case m.CollectionSchemaType.URL:vd(h.url)&&(h.tooltip="访问链接",h.icon="IcTitleUrl",h.href=fm(h.url));break;default:return null}return h},[s,o]),l=h=>{const p=/^\d+$/.test(h);m.CollectionSchemaType.PHONE===o&&!p&&h||a(t,mt(h))},c=h=>{var g,_;let p=Z3(h);return Number.isNaN(p)&&(p=Z3((_=(g=h.match(/[+-]?\d+(?:\.?\d+)?/))==null?void 0:g[0])!=null?_:"")),Number.isNaN(p)?"":`${p}`},u=((f=Aw.find(h=>h.type===(n==null?void 0:n.type)))==null?void 0:f.title)||"文本",d=!!(o&&[m.CollectionSchemaType.TEXT,m.CollectionSchemaType.TITLE].includes(o));return r.jsxs("div",{className:"border border-grey6 rounded text-t1 py-2.5 px-2 relative group",children:[r.jsx(oo,{singleLine:!d,shiftEnter:d,fontClassName:B(d&&"max-h-[100px] overflow-y-auto"),onBlur:()=>{if(m.CollectionSchemaType.NUMBER===o){const h=c(de(s||[]));a(t,mt(h))}},placeholder:`请输入${u}`,value:de(s||[]),onChange:h=>{l(h.currentTarget.value)}}),(i==null?void 0:i.href)&&r.jsx(Fe,{popup:i.tooltip,className:"opacity-0 group-hover:opacity-100 transition-opacity absolute right-2 top-3",children:r.jsx("a",{href:i.href,target:"_blank",rel:"noopener noreferrer",className:"w-6 h-6 flex items-center justify-center border rounded bg-white1 animate-hover-opaque",children:r.jsx(H,{name:i.icon,size:"middle",className:"text-grey3"})})})]})},yre=e=>{const{submitData:t,handleChangeSubmitData:n,property:s}=e,a=Va(),o=me(),i=u=>{n(s,u)},l=({defaultValue:u,onUpdate:d,onCloseModal:f})=>{const[h,p]=F.useState(u);return r.jsx("div",{className:"next-modal",children:r.jsx(gF,{value:h,includeGroup:!1,onClose:()=>f(),onUpdate:g=>{p(g),d(g)}})})},c=u=>{o.dropdown({popcorn:u.currentTarget,placement:"bottom",content:d=>r.jsx(l,{defaultValue:t,onUpdate:i,onCloseModal:d.onCloseModal})})};return r.jsx("div",{onClick:c,className:B("px-2 border border-grey6 rounded cursor-pointer",t!=null&&t.length?"py-0.5":"py-2"),children:t!=null&&t.length?r.jsx("div",{className:"flex items-center flex-wrap cursor-pointer py-px",children:t.map(u=>u.uuid&&a[u.uuid]?r.jsx(pF,{userId:u.uuid},u.uuid):null)}):r.jsx("div",{className:"text-t1 text-grey4",children:"添加成员"})})},bre=({collectionId:e,viewId:t})=>{const{isLocked:n}=Te(),s=ih(),a=uh();if(n)return null;const o=i=>{ce.event("bitable_property_create",{from_scene:"form"});const l=s({collectionId:e,viewId:t});l&&(Ye({$newTableProperty:{propertyId:l,from:qn.FORM_PROPERTIES}}),a(l,Br(i.currentTarget),qn.FORM_PROPERTIES,"bottom-start"))};return r.jsxs("div",{className:"flex items-center px-2 text-t2 animate-hover text-grey4 py-2",onClick:o,children:[r.jsx(H,{name:"MIcAddNew",size:"middle",className:"mr-1 opacity-60"}),r.jsx("span",{children:"添加属性"})]})},Ji={Person:yre,CheckBox:pre,Select:gre,DateElement:_re,File:xre,FormatTextarea:Fre,Container:hre,CreateFormProperty:bre},Ere=({isFromViewSetting:e})=>{var g,_;const{viewId:t,collectionId:n,isLocked:s}=Te(),a=ps(t),[o=[]]=Ha(t,{visible:!0}),i=(g=ae(({blocks:x})=>{var y;return(y=x[n])==null?void 0:y.data.schema}))!=null?g:{},l=k0(i,o.map(x=>x.property),(_=a==null?void 0:a.format.formLogic)!=null?_:[]),[c,u]=wm(WC),d=()=>{const x=l.slice(0);if(o.length===0)return;const y=o[0];x.push({condition:{property:y.property,propertyType:y.type,operator:"isNotEmpty",type:"filter",value:""},gotoProperty:Wf}),yt(t,{formLogic:x}),ce.event("form_logic_manage",{manage_type:"create"})},f=(x,y)=>{const b=l.slice(0);b[x]=y,yt(t,{formLogic:b})},h=x=>{const y=l.slice(0);y.splice(x,1),yt(t,{formLogic:y}),ce.event("form_logic_manage",{manage_type:"delete"})},p=x=>{yt(t,{formLogic:x.map(y=>y.rule)})};return Em(()=>{u(null)}),r.jsxs("div",{className:B("min-w-[560px]",!e&&"rounded-sm next-modal-scroll"),children:[l.length===0&&r.jsx("div",{className:"text-grey3 text-t2 mx-4 my-2 select-none",children:"当前无跳题逻辑"}),r.jsx(vr,{className:"min-h-0 max-h-[calc(80vh-90px)] flex-1 overflow-y-auto",onlyHandleDraggable:!0,items:l.map((x,y)=>({id:`${y}`,rule:x})),renderItemContent:({item:{id:x,rule:y},renderDragHandle:b})=>{const E=Number(x);return r.jsxs("div",{className:B("px-4 py-2 space-y-2 border-grey6 text-t2",x!=="0"&&"border-t",(c===y.condition.property||c===y.gotoProperty)&&"bg-light_yellow bg-opacity-20"),children:[r.jsxs("div",{className:"flex items-center",children:[r.jsxs("div",{className:"flex flex-1 min-w-0 items-center",children:[r.jsxs("div",{className:"flex items-center justify-between w-[64px] text-grey3",children:[b({className:"cursor-pointer"}),r.jsx("span",{className:"select-none",children:"若"})]}),r.jsx(AN,{className:"w-[160px] mx-2",value:y.condition.property,onChange:w=>{f(E,Mh(y,k=>{g1(n,k.condition,"property",w)}))}}),r.jsx(sL,{className:"mr-2",property:y.condition.property,value:y.condition.operator,onChange:w=>{f(E,Mh(y,k=>{g1(n,k.condition,"operator",w)}))}}),r.jsx(rL,{path:[],className:"w-[160px]",property:y.condition.property,operator:y.condition.operator,value:y.condition.value,onChange:w=>{f(E,Mh(y,k=>{g1(n,k.condition,"value",w)}))}})]}),!s&&r.jsx(H,{size:"large",className:"ml-3 cursor-pointer text-grey3 hover:text-grey1",name:"IcToastClose",onClick:()=>{h(E)}})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex justify-end w-[64px] text-grey3",children:r.jsx("span",{className:"select-none",children:"则跳转"})}),r.jsx(AN,{className:"w-[160px] mx-2",value:y.gotoProperty,mustGtValue:y.condition.property,allowEndPage:!0,onChange:w=>{f(Number(x),{...y,gotoProperty:w})}}),r.jsx("span",{className:"text-grey3 select-none",children:"，不符合条件将正常进入下一题"})]})]})},onChange:p}),r.jsxs("button",{className:B("flex items-center w-full h-10 p-2 animate-hover pl-4 border-t border-grey6",s&&"cursor-not-allowed"),onClick:d,disabled:s,children:[r.jsx(H,{className:"mr-1",name:"MIcAddNew",size:"middle"}),r.jsx("span",{className:"text-t2 text-grey3",children:"创建跳题逻辑"})]})]})},AN=({className:e,value:t,mustGtValue:n,onChange:s,allowEndPage:a=!1})=>{const{viewId:o,isLocked:i}=Te(),[l=[]]=Ha(o,{visible:!0}),c=l.filter(d=>!Bw.includes(d.type)),u=n?c.findIndex(d=>d.property===n):-1;return r.jsx(Uo,{readonly:i,className:e,dropdownClassName:"max-w-[260px]",value:t,onChange:s,options:[...c.map((d,f)=>{const{type:h}=d;return{value:d.property,title:`${f+1}. ${d.name}`,icon:h&&an[h]}}).filter((d,f)=>f>u),...a?[{value:Wf,title:"结束页",icon:"IcEndPage"}]:[]]})},KC=({isFromViewSetting:e})=>{const{collectionId:t,viewId:n,readonly:s,isLocked:a,viewType:o}=Te(),[i,l]=F.useState(!1),c=ps(n),[u=[],d=[]]=Ha(n),f=ih(),h=me();if(!c||!o)return null;const p=o===m.CollectionViewType.FORM?u.filter(b=>!Bw.includes(b.type)):i?d:u,g=p.every(b=>b.visible===!0),_=async b=>{var j;const{active:E,over:w}=b;if(!w)return;const{properties:k=[],timelineTableProperties:C=[],formLogic:T=[]}=(j=Zt(n))!=null?j:{},v=i?C:k;let I;if(E.id!==w.id){const D=v.findIndex(A=>A.property===E.id),S=v.findIndex(A=>A.property===w.id),R=qc(v,D,S);if(o===m.CollectionViewType.FORM&&(I=Tp(t,n,R.map(A=>A.property),T),I!=null&&!await new Promise(L=>{h.warning({title:r.jsx(r.Fragment,{children:"确认调整题目顺序吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){L(!0)},cancel(){L(!1)}})})))return;yt(n,{[i?"timelineTableProperties":`${o}Properties`]:R,...I?{formLogic:I}:{}})}},x=async()=>{var j;if(a)return;const b=!g,{previewType:E}=lR(n),{properties:w=[],timelineTableProperties:k=[],formLogic:C=[]}=(j=Zt(n))!=null?j:{},v=(i?k:w).map(D=>c.type!==m.CollectionViewType.FORM&&D.property==="title"&&!i&&(o===m.CollectionViewType.TABLE||o===m.CollectionViewType.LIST||o===m.CollectionViewType.TIMELINE||o===m.CollectionViewType.CALENDAR||E===m.CoverType.NONE)?D:{...D,visible:b}),I={[i?"timelineTableProperties":`${o}Properties`]:v};if(i&&(I.timelineShowTable=b),o===m.CollectionViewType.FORM&&!b){const D=Tp(t,n,v.filter(S=>S.visible).map(S=>S.property),C);if(D!=null){if(!await new Promise(R=>{h.warning({title:r.jsx(r.Fragment,{children:"确认隐藏题目吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){R(!0)},cancel(){R(!1)}})}))return;I.formLogic=D}}yt(n,I)},y=()=>{ce.event("bitable_property_create",{from_scene:"menu"});const b=f({collectionId:t,viewId:n,visible:!0,isTimelineTable:i});b&&Ye({$newTableProperty:{propertyId:b,from:qn.PROPERTY_LIST}})};return r.jsxs("div",{className:B("pt-[5px]",e?"w-full":"next-modal-scroll rounded-sm w-[400px]"),children:[r.jsxs("div",{className:"flex h-10 items-center justify-between px-4",children:[r.jsxs("div",{className:"text-t2 flex items-center",children:[r.jsx(H,{className:"mr-1",name:lo[o],size:"middle"}),r.jsx("span",{className:"mr-2 font-medium",children:Ac[o]}),r.jsx("span",{className:"max-w-[140px] overflow-hidden overflow-ellipsis whitespace-nowrap",children:c.title})]}),[m.CollectionViewType.TABLE,m.CollectionViewType.LIST,m.CollectionViewType.CALENDAR,m.CollectionViewType.TIMELINE,m.CollectionViewType.FORM].includes(o)&&r.jsx("button",{className:B("text-t2 text-active_color",a&&"cursor-not-allowed opacity-20"),onClick:x,children:g?"全部隐藏":"全部显示"})]}),[m.CollectionViewType.BOARD,m.CollectionViewType.GALLERY].includes(o)&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"flex h-10 items-center justify-between px-4",children:[r.jsxs("span",{className:"text-t2 text-grey3",children:["在",Ac[o],"中显示"]}),r.jsx("button",{className:B("text-t2 text-active_color",a&&"cursor-not-allowed opacity-20"),onClick:x,children:g?"全部隐藏":"全部显示"})]})}),o===m.CollectionViewType.TIMELINE&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"border-b border-grey6 py-1.5 px-2",children:[r.jsx("button",{onClick:()=>l(!1),className:B("mr-2 rounded-sm py-1.5 px-4",!i&&"bg-black_006"),children:"时间轴"}),r.jsx("button",{onClick:()=>l(!0),className:B("rounded-sm py-1.5 px-4",i&&"bg-black_006"),children:"表格"})]})}),r.jsx(vr,{disabled:a,items:p.map(b=>({id:b.property,...b})),onChange:(b,E)=>_(E),renderItemContent:({item:b})=>r.jsx(wre,{...b,isTimelineTable:i})}),!s&&!a&&r.jsxs(r.Fragment,{children:[r.jsx(Rr,{}),r.jsxs("button",{className:"animate-hover flex h-10 w-full items-center px-3",onClick:y,children:[r.jsx(H,{className:"mr-1",name:"MIcAddNew",size:"middle"}),r.jsx("span",{className:"text-t2 text-grey3",children:"创建属性"})]})]})]})},wre=e=>{const t=me(),{property:n,visible:s,name:a,type:o,dragOverlay:i,isTimelineTable:l}=e,{viewId:c,viewType:u,collectionId:d,isLocked:f}=Te(),h=lL(),{previewType:p}=Kd(c),g=uh(),_=F.useRef(null),x=gw(n,qn.PROPERTY_LIST),y=async k=>{var C,T;if(!f){if(u===m.CollectionViewType.FORM&&!k){const v=le().collectionViews[c],I=(C=v==null?void 0:v.format.formProperties)!=null?C:[],j=(T=v==null?void 0:v.format.formLogic)!=null?T:[];if(Tp(d,c,I.filter(S=>S.property===n?k:S.visible).map(S=>S.property),j)!=null){if(!await new Promise(R=>{t.warning({title:r.jsx(r.Fragment,{children:"确认隐藏题目吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){R(!0)},cancel(){R(!1)}})}))return;yt(c,{formLogic:j})}}h(d,c,n,k,l)}};F.useEffect(()=>{_.current&&x&&(g(n,_.current,l?qn.PROPERTY_LIST_TIMELINE_TABLE:qn.PROPERTY_LIST),Ye({$newTableProperty:void 0}))},[x,l,g,n]);const b=n==="title",E=u!==m.CollectionViewType.FORM&&b&&!l&&(u===m.CollectionViewType.TABLE||u===m.CollectionViewType.LIST||u===m.CollectionViewType.TIMELINE||u===m.CollectionViewType.CALENDAR||p===m.CoverType.NONE),w=k=>{f||g(n,k.currentTarget,l?qn.PROPERTY_LIST_TIMELINE_TABLE:qn.PROPERTY_LIST)};return r.jsxs("div",{ref:_,className:B("text-t2 animate-hover flex h-8 cursor-pointer items-center justify-between px-3",i&&"cursor-[grabbing]"),onClick:w,children:[r.jsxs("div",{className:"flex flex-1 items-center overflow-hidden",children:[r.jsx("div",{className:"mr-1 flex h-5 w-5 items-center justify-center",children:r.jsx(H,{name:"IcBlockHandle",className:"text-grey4"})}),r.jsx(H,{className:"mr-1",size:"middle",name:an[o]}),r.jsx("span",{className:"flex-1 overflow-hidden overflow-ellipsis whitespace-nowrap pr-2",children:a})]}),r.jsx(wn,{open:s,disabled:E||f,onSwitch:y})]})},YC=({children:e,header:t,report:n,className:s,hiddenFooter:a,headerClassName:o,containerClassName:i})=>r.jsxs("div",{className:B("relative flex flex-col items-center",i),children:[r.jsx("div",{className:B("w-full flex-shrink-0 h-[320px]",o),children:t}),r.jsx("div",{className:B("px-20 -mt-[150px] next-modal shadow-light w-full relative z-10 max-w-[960px] mb-10",s),children:e}),r.jsx("div",{className:B("flex items-center w-full max-w-[1420px] border-t border-grey6 h-24 flex-shrink-0 mt-auto",a&&"border-none hidden"),children:!a&&r.jsxs("div",{className:"flex items-center justify-between w-full max-w-[960px] mx-auto",children:[r.jsx("span",{className:"text-t2 flex items-center",children:r.jsx(rh,{className:"mr-2",description:r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"ml-2",children:"FlowUs 息流"}),r.jsx("span",{className:"text-grey3",children:" 提供技术支持 "})]})})}),n?r.jsx("span",{className:"text-t2 cursor-pointer",onClick:n,children:"举报违法信息"}):r.jsx("span",{})]})})]}),kre=()=>F.useCallback(async(e,t)=>{await Ce.editor.restoreDocHistory(e,t),ee(Pu.update({[e]:{tag:"CACHE_EXPIRED",timestamp:Date.now()}}))},[]),Cre=20,Tre=["一","二","三","四","五","六","七","八","九","十","十一","十二"];let GL;const vre=e=>{GL=e},Nre=({docId:e,initialSelectedSnapshotId:t})=>{const n=me(),s=Ft(),a=di(),o=Pa(),i=Ro(),l=Kt(),c=xV(),u=dr(()=>({nextPage:1,selected:t,history:[],initialLoaded:!1,loading:!1,more:!1})),d=kre(),f=F.useCallback(async()=>{var y,b;if(u.loading)return;u.loading=!0,c();const _=u.nextPage,x=await Ce.editor.getDocHistories(e,_,Cre);x.results&&(u.nextPage=_+1,_===1&&t==null&&(u.history=[],u.selected=(y=x.results[0])==null?void 0:y.uuid),u.history.push(...x.results)),u.initialLoaded=!0,u.loading=!1,u.more=(b=x.more)!=null?b:!1,c(),u.selected!=null&&u.history.findIndex(E=>E.uuid===u.selected)===-1&&u.more&&setTimeout(()=>f())},[e,t,c,u]);F.useEffect(()=>{u.nextPage=1,f()},[f,u]);const[h]=F8({loading:u.loading,hasNextPage:u.more,onLoadMore:f}),g=(_=>{var C;const x=[],y=[],b=[],E=new Map,w=he();for(const T of _){const v=he(T.createdAt);if(v.isSame(w,"day"))x.push(T);else if(v.isSame(w.subtract(1,"day"),"day"))y.push(T);else if(v.isSame(w,"week"))b.push(T);else{const I=v.startOf("month").toDate().getTime();E.has(I)||E.set(I,[]),(C=E.get(I))==null||C.push(T)}}const k=[];return x.length>=1&&k.push({label:"今天",snapshots:x}),y.length>=1&&k.push({label:"昨天",snapshots:y}),b.length>=1&&k.push({label:"本周",snapshots:b}),k.push(...[...E.entries()].sort($o(hr(T=>T[0]))).map(([T,v])=>{const I=he(T);return{label:I.isSame(w,"month")?"本月":I.isSame(w,"year")?`${Tre[I.month()]}月`:I.format("YYYY年M月"),snapshots:v}})),k})(u.history);return u.initialLoaded?r.jsx("div",{className:"w-[80vw] h-[80vh] rounded-md overflow-hidden",children:r.jsxs("div",{className:"flex h-full",children:[a?r.jsx("div",{className:"flex-1 h-full min-w-0 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{children:r.jsx(H,{name:"IcMenuPageHistory",className:"!w-12 !h-12 text-grey4"})}),r.jsx("h3",{className:"text-t1-bold",children:"升级空间，即刻查看和恢复页面历史"}),r.jsx("div",{className:"flex justify-center mt-2",children:r.jsx(je,{colorType:"active",onClick:()=>{s.planType==="freeTeam"?i(Vt.pageHistory):o({defaultMenuType:Jt.upgrade,from:Vt.pageHistory})},children:"升级空间"})})]})}):g.length<=0?r.jsx("div",{className:"w-[80vw] h-[80vh] flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{children:r.jsx(H,{name:"IcMenuPageHistory",className:"!w-12 !h-12 text-grey4"})}),r.jsx("h3",{className:"text-t1-bold",children:"尚未生成历史页面"}),r.jsxs("p",{className:"text-t2 mt-2",children:["继续编辑，FlowUs会帮助你生成页面历史，",r.jsx("br",{}),"然后你可以选择将页面内容恢复成某个历史时间的内容。"]})]})}):r.jsx("div",{className:"flex-1 h-full flex min-w-0 bg-white1",onContextMenu:_=>{_.stopPropagation()},children:u.selected&&r.jsx(jre,{docId:e,snapshotId:u.selected},u.selected)}),r.jsxs("div",{className:B("w-[240px] h-full border-l-black_006 border-l flex flex-col",g.length<=0&&"hidden"),children:[r.jsxs("div",{className:"flex-1 py-2 overflow-y-auto",children:[g.map(_=>r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"text-t2 text-grey3 px-3 mb-1",children:_.label}),r.jsx("div",{className:"flex flex-col",children:_.snapshots.map(x=>r.jsx(Ire,{className:"px-3 py-1 my-0.5",snapshot:x,selected:x.uuid!=null&&x.uuid===u.selected,onClick:()=>{u.selected=x.uuid,c()}},x.uuid))})]},_.label)),(u.loading||u.more)&&r.jsx("div",{className:"h-10 overflow-hidden",ref:h,children:r.jsx(os,{})})]}),r.jsxs("div",{className:"h-[60px] border-t-black_006 border-t flex items-center justify-evenly",children:[r.jsx(je,{colorType:"active",className:B("w-[132px]"),disable:a||!u.selected,onClick:()=>{const _=u.history.find(E=>E.uuid===u.selected),x=he(),y=he(_==null?void 0:_.createdAt),b=y.isSame(x,"year")?y.format("M月D日 HH:mm"):y.format("YYYY年M月D日 HH:mm");n.warning({title:r.jsx("div",{className:"w-80",children:"确认恢复页面？"}),content:r.jsxs("p",{children:["页面将恢复为 ",b," 的版本"]}),confirm(){l(Xe.DOC_HISTORY_MODAL_ID),u.selected&&(ce.event("page_history"),d(e,u.selected))}})},children:"恢复此版本"}),r.jsx(je,{className:"w-[60px]",onClick:()=>{l(Xe.DOC_HISTORY_MODAL_ID)},children:"取消"})]})]})]})}):r.jsx("div",{className:"w-[80vw] h-[80vh]",children:r.jsx(os,{})})},Ire=({snapshot:e,selected:t,className:n,onClick:s})=>{var l;const a=he(),o=he(e.createdAt),i=o.isSame(a,"year")?o.format("M月D日 HH:mm"):o.format("YYYY年M月D日 HH:mm");return r.jsxs("div",{className:B("animate-hover",{"bg-grey9":t},n),onClick:s,children:[r.jsx("div",{className:"text-t2",children:i}),r.jsx("div",{className:"text-t4 text-grey3",children:(l=e.userList)==null?void 0:l.map(c=>r.jsx("span",{children:ss(c.uuid)},c.uuid))})]})},jre=({docId:e,snapshotId:t})=>{const n=nD(async()=>Ce.editor.getDocHistoryDetail(e,t),[e,t]);return n[0]==="pending"?r.jsx(os,{}):r.jsx(Dre,{docId:e,snapshot:n[1]})},Dre=({docId:e,snapshot:t})=>{const n=F.useMemo(()=>Sre(t),[t]);return r.jsx(ej,{store:n,children:r.jsx(GL,{docId:e,pageScene:Tt.PAGE_HISTORY,nameSpace:zc.PAGE_HISTORY})})},Sre=e=>{const t=y8(bS),{users:n,spaces:s,spaceViews:a}=le();return vI({reducer:t,preloadedState:{spaceViews:a,spaces:s,users:n,blocks:e.blocks,collectionViews:e.collectionViews,discussions:e.discussions,comments:e.comments}})},zL=({docId:e,pageScene:t,nameSpace:n})=>r.jsx(Nd,{scope:ur,initialValues:[[Yx,e]],children:r.jsx(Al.Provider,{value:t,children:r.jsx(mi.Provider,{value:n,children:r.jsx(jl,{children:r.jsx(dP,{uuid:e})})})})});vre(zL);const WL=({uuid:e})=>r.jsx(zL,{docId:e,pageScene:Tt.FORM_ENG_PAGE,nameSpace:zc.FORM_END_PAGE}),Rre=e=>{var b;const{collectionId:t,viewId:n,onCloseModal:s}=e,a=ps(n),o=La(),i=_e(t,["data"],["cover","coverPos"]),[l,c]=F.useState((b=a==null?void 0:a.format.formEndPage)!=null?b:""),[u,d]=F.useState(""),[f,h]=F.useState(!0),p=async()=>{var C;const E=new jx,w=Jp(l),k=(C=pn(w==null?void 0:w.pathname.split(Rt.share)))==null?void 0:C.slice(0,36);if(MV(l)){ye.error("暂不支持收集表链接");return}if(!_w(l)||!k){ye.error("链接不正确，请填写公开分享链接");return}return await o(k,{callback:T=>{if(T.code===200&&hn(k).shared){E.resolve(k);return}ye.error("链接未开启分享"),E.resolve("")}}).catch(()=>{ye.error("链接未开启分享"),E.resolve("")}),E.promise},g=async()=>{if(!l)return;const E=await p();E&&d(E)},_=async()=>{l?await p()&&(ce.event("end_page"),yt(n,{formEndPage:l})):yt(n,{formEndPage:l}),s()},x=()=>{a!=null&&a.format.formEndPage&&(yt(n,{formEndPage:void 0}),ye.success("设置成功")),d(""),c("")};if(F.useEffect(()=>{a!=null&&a.format.formEndPage?g().then(()=>{h(!1)}):h(!1)},[]),!i)return null;if(f)return r.jsx(os,{});const y=r.jsxs("div",{className:"pt-14 px-24 mx-auto h-full flex flex-col text-left",children:[r.jsx("div",{className:"text-h3",children:"支持在结束页嵌入分享页面，用于提交后的信息展示"}),r.jsxs("div",{className:"mt-10 text-t2",children:["1. 自行撰写内容  2.开启“",Wj,"”并粘贴至下方"]}),r.jsx(xt,{autoFocus:!0,value:l,onChange:c,className:"h-8 w-full mt-7",placeholder:"粘贴分享链接",addonAfter:r.jsx("div",{onClick:g,className:B("w-24 h-full flex items-center justify-center border-l bg-white2 rounded-l-none",!l&&"cursor-not-allowed",l&&"animate-hover animate-click"),children:"预览"})})]});return r.jsxs("div",{className:"flex flex-col h-full relative",children:[r.jsxs("div",{className:"w-full flex items-center justify-between h-14 px-4 text-t1-medium bg-white2 flex-shrink-0 sticky top-0 left-0 z-20",children:[r.jsx("div",{className:"text-t2-medium",children:"结束页设计"}),r.jsxs("div",{className:"flex",children:[r.jsx(je,{colorType:"base_white",className:"mr-2",onClick:()=>s(),children:"取消"}),r.jsx(je,{colorType:"active",onClick:_,children:"完成"})]})]}),r.jsxs("div",{className:"flex absolute top-16 right-4 z-50",children:[l&&r.jsx(je,{colorType:"base_white",className:"mr-4",onClick:x,children:"恢复默认"}),u&&r.jsx(je,{colorType:"base_white",onClick:()=>d(""),children:"修改链接"})]}),r.jsx(YC,{className:"h-[60vh] flex px-0",containerClassName:"pb-20",header:r.jsx(nf,{uuid:i.uuid,ossName:i.data.cover||"cover/flowus2",hiddenEditorButton:!0,height:320}),hiddenFooter:!0,children:u?r.jsx(WL,{uuid:u}):y})]})},KL=()=>{const e=me(),t=n=>{e.modal({className:"w-[95vw] h-[95vh]",content:s=>r.jsx(Rre,{viewId:n.viewId,collectionId:n.collectionId,onCloseModal:s.onCloseModal})})};return F.useCallback(t,[e])},YL=()=>{const e=ke(),t=n=>{const s=Zt(n);if(!s)return;const{view:a}=s,o=qe(),i=Date.now(),l={...a,format:{...a.format,formShared:!1},uuid:o,status:1,createdAt:i,updatedAt:i,version:0,title:a.title?`副本 ${a.title}`:"",shareId:void 0};return e(()=>(ee(jm({collectionView:l})),ee(fd({uuid:o,parentId:a.parentId,after:n})),o))};return F.useCallback(t,[e])},XL=()=>{const e=ke(),t=n=>{e(()=>{M6(n)})};return F.useCallback(t,[e])},Are=()=>{const e=(t,n)=>{const{collectionViews:s}=K,a=s[t];if(!a)return;const o={boardCardSize:n};switch(a.type){case m.CollectionViewType.BOARD:o.boardCardSize=n;break;case m.CollectionViewType.GALLERY:o.galleryCardSize=n;break}yt(t,o)};return F.useCallback(e,[])},Bre=()=>{const e=ke(),{getState:t}=Kr(),n=(s,a,o)=>{e(()=>{const{collectionViews:i}=t(),l=i[s];if(!l)return;const c={};switch(l.type){case m.CollectionViewType.BOARD:{c.boardCoverType=a,c.boardCoverProperty=o;break}case m.CollectionViewType.GALLERY:{c.galleryCoverType=a,c.galleryCoverProperty=o;break}}Kn(s,{format:c})})};return F.useCallback(n,[t,e])},Lre={[m.CardSize.SMALL]:"小",[m.CardSize.MEDIUM]:"中",[m.CardSize.LARGE]:"大"},Pre={[m.CollectionCardImageDir.HORIZONTAL]:"横向",[m.CollectionCardImageDir.VERTICAL]:"纵向"},Ore={[m.CoverType.NONE]:"无",[m.CoverType.PAGE_COVER]:"封面",[m.CoverType.PAGE_CONTENT]:"页面内容"},Mre=()=>{const e=ks(),{viewId:t,viewType:n,isLocked:s}=Te(),[a=[]]=Ha(t),o=Lo(t),i=Bo(t),l=nF(t),c=iR(t),{previewType:u,previewProperty:d}=Kd(t),f=me(),h=Bre(),p=Are(),g=n===m.CollectionViewType.BOARD,_=w=>{if(s)return;const k=a.filter(C=>C.type===m.CollectionSchemaType.FILE);f.dropdown({popcorn:w.currentTarget,placement:"bottom-end",offset:[-8,0],content:({onCloseModal:C})=>r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:[{type:$.OPERABLE_BLOCK_TEXT,data:{title:"无",type:m.CoverType.NONE,selected:u===m.CoverType.NONE}},{type:$.OPERABLE_BLOCK_TEXT,data:{title:"封面",type:m.CoverType.PAGE_COVER,selected:u===m.CoverType.PAGE_COVER}},{type:$.OPERABLE_BLOCK_TEXT,data:{title:"页面内容",type:m.CoverType.PAGE_CONTENT,selected:u===m.CoverType.PAGE_CONTENT}},{type:$.LINE,isHidden:k.length<=0},...k.map(T=>({type:$.OPERATION,data:{title:T.name,icon:"IcTitleFiles",type:m.CoverType.FILE_PROPERTY,property:T.property,selected:u===m.CoverType.FILE_PROPERTY&&d===T.property}}))],onItemClick:T=>{(T.data.type!==u||T.data.property!==d)&&(h(t,T.data.type,T.data.property),T.data.type===m.CoverType.PAGE_COVER&&(e(Ae.GUIDE_FIRST_TIME_BOARD_VIEW,We.advancedList),g||e(Ae.CREATE_GALLERY_VIEW,We.advancedList,{step2:!0}))),C()}})})},x=w=>{s||f.dropdown({popcorn:w.currentTarget,placement:"bottom-end",offset:[-8,0],content:({onCloseModal:k})=>r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:[{type:$.OPERABLE_BLOCK_TEXT,data:{title:"小",type:m.CardSize.SMALL,selected:o===m.CardSize.SMALL}},{type:$.OPERABLE_BLOCK_TEXT,data:{title:"中",type:m.CardSize.MEDIUM,selected:o===m.CardSize.MEDIUM}},{type:$.OPERABLE_BLOCK_TEXT,data:{title:"大",type:m.CardSize.LARGE,selected:o===m.CardSize.LARGE}}],onItemClick:C=>{C.data.type!==o&&(p(t,C.data.type),k())}})})},y=w=>{s||f.dropdown({popcorn:w.currentTarget,placement:"bottom-end",offset:[-8,0],content:({onCloseModal:k})=>r.jsx(ze,{className:"next-modal w-[160px] py-[5px]",items:[{type:$.OPERABLE_BLOCK_TEXT,data:{title:"横向",type:m.CollectionCardImageDir.HORIZONTAL,selected:i===m.CollectionCardImageDir.HORIZONTAL}},{type:$.OPERABLE_BLOCK_TEXT,data:{title:"纵向",type:m.CollectionCardImageDir.VERTICAL,selected:i===m.CollectionCardImageDir.VERTICAL}}],onItemClick:C=>{C.data.type!==i&&(yt(t,{[g?"boardImageDir":"galleryImageDir"]:C.data.type}),k())}})})},b=w=>{s||yt(t,{[g?"boardCoverAspect":"galleryCoverAspect"]:w?m.CoverAspectType.CONTAIN:m.CoverAspectType.COVER})},E=w=>{s||yt(t,{[g?"boardShowPropertyName":"galleryShowPropertyName"]:w})};return r.jsxs("div",{children:[r.jsxs("button",{className:"animate-hover flex h-10 w-full items-center justify-between px-2",onClick:_,children:[r.jsx("span",{className:"text-t2",children:"卡片预览"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-t2 mr-2 text-grey3",children:u===m.CoverType.FILE_PROPERTY?(()=>{const w=a.find(k=>k.property===d);return r.jsxs("span",{className:"flex items-center",children:[r.jsx(H,{name:"IcTitleFiles",size:"middle"}),r.jsx("span",{children:w==null?void 0:w.name})]})})():Ore[u]}),r.jsx(H,{name:"IcArrow",size:"xxxsmall"})]})]}),u!==m.CoverType.FILE_PROPERTY&&r.jsxs("button",{className:"animate-hover flex h-10 w-full items-center justify-between px-2",onClick:y,children:[r.jsx("span",{className:"text-t2",children:"卡片样式"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-t2 mr-2 text-grey3",children:Pre[i]}),r.jsx(H,{name:"IcArrow",size:"xxxsmall"})]})]}),r.jsxs("button",{className:"animate-hover flex h-10 w-full items-center justify-between px-2",onClick:x,children:[r.jsx("span",{className:"text-t2",children:"卡片大小"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"text-t2 mr-2 text-grey3",children:Lre[o]}),r.jsx(H,{name:"IcArrow",size:"xxxsmall"})]})]}),u!==m.CoverType.NONE&&r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"适应预览图"}),r.jsx(wn,{open:l===m.CoverAspectType.CONTAIN,onSwitch:b,disabled:s})]}),r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示属性名"}),r.jsx(wn,{open:c,onSwitch:E,disabled:s})]})]})},Ure=()=>{const e=ke(),{getState:t}=Kr(),n=(s,a,o)=>{const{collectionViews:i}=t(),l=i[s];if(!l)return;const c=l.type===m.CollectionViewType.TIMELINE,u={};a==="startTime"&&(u[c?"timelineBy":"calendarBy"]=o),a==="endTime"&&(u[c?"timelineByEnd":"calendarByEnd"]=o),e(()=>{Kn(s,{format:u})})};return F.useCallback(n,[t,e])},Vre=({isStartTime:e,onCloseModal:t})=>{const{viewId:n,collectionId:s}=Te(),a=Ure(),{startBy:o,endBy:i}=ae(({collectionViews:u})=>{var x;const d=u[n],{timelineBy:f,timelineByEnd:h,calendarBy:p,calendarByEnd:g}=(x=d==null?void 0:d.format)!=null?x:{},_=(d==null?void 0:d.type)===m.CollectionViewType.TIMELINE;return{startBy:_?f:p,endBy:_?h:g}}),l=ae(({blocks:u})=>{var p;const d=u[s],f=(p=d==null?void 0:d.data.schema)!=null?p:{},h=[];return Object.entries(f).forEach(([g,_])=>{(_.type===m.CollectionSchemaType.CREATED_AT||_.type===m.CollectionSchemaType.UPDATED_AT||_.type===m.CollectionSchemaType.DATE)&&h.push({id:g,..._})}),h}),c=()=>l.map(u=>({type:$.OPERATION,data:{id:u.id,title:u.name,icon:an.date,hasArrow:e?u.id===o:u.id===i,arrow:r.jsx(H,{name:"IcSelectedSpace"})}}));return r.jsx(ze,{className:"w-[160px] rounded-sm next-modal-scroll py-[5px]",items:c(),onItemClick:u=>{u.data.id!==(e?o:i)&&(a(n,e?"startTime":"endTime",u.data.id),t==null||t())}})},QL=[{type:m.CardColorSource.EMPTY,name:"不显示"},{type:m.CardColorSource.CUSTOM,name:"自定义颜色"},{type:m.CardColorSource.PROPERTY,name:"跟随单选属性颜色"}],qre=()=>{var f,h;const{viewId:e,viewType:t,collectionId:n}=Te(),{propertyId:s,type:a}=(f=sF(e))!=null?f:{},[o=[]]=Ha(e),i=(h=ae(({blocks:p})=>{var g;return(g=p[n])==null?void 0:g.data.schema}))!=null?h:{},[l,c]=F.useState(a==="property"),u=[];Object.keys(i).forEach(p=>{const g=i[p];(g==null?void 0:g.type)===m.CollectionSchemaType.SELECT&&u.push({type:$.OPERATION,data:{title:g.name,property:p,order:o.findIndex(_=>_.property===p),icon:"IcTitleSelect",hasArrow:p===s,arrow:r.jsx(H,{name:"IcSelectedSpace"})}})}),u.sort((p,g)=>p.data.order-g.data.order);const d=[];return QL.forEach(p=>{d.push({type:$.OPERATION,data:{title:p.name,type:p.type,hasArrow:p.type===a,arrow:r.jsx(H,{name:"IcSelectedSpace"})}})}),l&&d.push({type:$.LINE},{type:$.OPERATION,data:{title:"单选",hasArrow:!0,type:"property",renderSubMenu:()=>r.jsx(ze,{className:"next-modal-scroll py-1.5 w-[160px]",items:u,onItemClick:p=>{const{property:g}=p.data;g!==s&&yt(e,{[t===m.CollectionViewType.TIMELINE?"timelineColorSetting":"calendarColorSetting"]:{type:m.CardColorSource.PROPERTY,propertyId:g}})}})}}),r.jsx("div",{className:"next-modal-scroll w-[160px] py-[5px]",children:r.jsx(ze,{items:d,onItemClick:async p=>{var _;const{type:g}=p.data;a!==g&&(yt(e,{[t===m.CollectionViewType.TIMELINE?"timelineColorSetting":"calendarColorSetting"]:{type:g,propertyId:g==="property"?(_=u[0])==null?void 0:_.data.property:s}}),c(g==="property"))}})})},Hre=({onChange:e})=>{const{viewId:t,viewType:n,collectionId:s,viewParentId:a}=Te(),o=ps(t),i=PC(),l=s!==a,c=[];return _m.forEach(u=>{l&&u.type===m.CollectionViewType.FORM||c.push({type:$.OPERATION,data:{title:u.name,type:u.type,icon:r.jsx(H,{name:lo[u.type],size:"middle"}),hasArrow:u.type===n,arrow:r.jsx(H,{name:"IcSelectedSpace"})}})}),r.jsx(ze,{className:"next-modal-scroll w-[160px] py-[5px]",items:c,onItemClick:u=>{var f;const{type:d}=u.data;n!==d&&i(t,(f=o==null?void 0:o.title)!=null?f:"",d),e()}})},$re=({onCloseModal:e,viewTitleRef:t})=>{var R,A,L,P,M,U,V,W,z;const{changeView:n,embed:s,viewType:a,viewId:o,collectionId:i,isLocked:l,managerReadonly:c,viewParentId:u}=Te(),d=Cg(o),f=oR(o),h=ae(({collectionViews:Q})=>{var Z,te;return(te=(Z=Q[o])==null?void 0:Z.format.showTitle)!=null?te:!0}),p=KL(),g=YL(),_=XL(),x=me(),y=sF(o),b=ps(o),[E,w]=F.useState((R=b==null?void 0:b.title)!=null?R:""),{views:k=[]}=(A=sh(u))!=null?A:{};F.useEffect(()=>{var Q;w((Q=b==null?void 0:b.title)!=null?Q:""),t&&(t.current=b==null?void 0:b.title)},[b==null?void 0:b.title,t]);const{startBy:C,endBy:T}=ae(({collectionViews:Q})=>{var oe;const Z=Q[o],{timelineBy:te,timelineByEnd:re,calendarBy:ne,calendarByEnd:Y}=(oe=Z==null?void 0:Z.format)!=null?oe:{},X=(Z==null?void 0:Z.type)===m.CollectionViewType.TIMELINE;return{startBy:X?te:ne,endBy:X?re:Y}}),v=_e(i,["data"],["schema"]),I=a===m.CollectionViewType.BOARD||a===m.CollectionViewType.GALLERY,j=Q=>{l||x.dropdown({popcorn:Q.currentTarget,placement:"bottom-end",content:({onCloseModal:Z})=>r.jsx(Hre,{onChange:Z})})},D=(Q,Z)=>{l||x.dropdown({popcorn:Q.currentTarget,placement:"bottom-end",content:({onCloseModal:te})=>r.jsx(Vre,{isStartTime:Z,onCloseModal:te})})},S=Q=>{l||x.dropdown({popcorn:Q.currentTarget,placement:"bottom-end",content:()=>r.jsx(qre,{})})};return b?r.jsxs("div",{className:"pb-[5px] px-2",children:[r.jsx(xt,{autoFocus:!0,readonly:l,placeholder:"请输入名称",className:"h-8 flex-1 my-2.5",value:E,onEnter:e,onChange:Q=>{w(Q),t&&(t.current=Q)}}),r.jsxs("div",{className:"w-full py-2.5 text-t2 text-grey3 mb-1 px-2 flex justify-between animate-hover cursor-pointer",onClick:j,children:[r.jsx("p",{className:"text-black",children:"视图类型"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",children:[Ac[b.type],r.jsx(H,{name:"IcArrow",className:"ml-2",size:"xxxsmall"})]})]}),s&&r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示多维表名称"}),r.jsx(wn,{open:h,onSwitch:Q=>{yt(o,{showTitle:Q})},disabled:l})]}),a===m.CollectionViewType.TABLE&&r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"自适应行高"}),r.jsx(wn,{open:!!d,onSwitch:Q=>{yt(o,{tableWrap:Q})},disabled:l})]}),a===m.CollectionViewType.CALENDAR&&r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示农历"}),r.jsx(wn,{open:f,onSwitch:Q=>{yt(o,{showLunarCalendar:Q})},disabled:l})]}),I&&r.jsxs(r.Fragment,{children:[r.jsx(Rr,{className:"my-1 mx-2"}),r.jsx(Mre,{})]}),(a===m.CollectionViewType.CALENDAR||a===m.CollectionViewType.TIMELINE)&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",onClick:S,children:[r.jsx("span",{className:"text-t2",children:"颜色显示"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",children:[(P=(L=QL.find(Q=>Q.type===(y==null?void 0:y.type)))==null?void 0:L.name)!=null?P:"不显示",r.jsx(H,{name:"IcArrow",className:"ml-2",size:"xxxsmall"})]})]}),r.jsx(Rr,{className:"my-1 mx-2"}),r.jsxs("div",{className:"w-full py-2.5 text-t2 text-grey3 mb-1 px-2 flex justify-between animate-hover cursor-pointer",onClick:Q=>D(Q,!0),children:[r.jsx("p",{className:"text-black",children:"开始日期"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",disabled:l,children:[(U=(M=v==null?void 0:v.data.schema)==null?void 0:M[C!=null?C:""])==null?void 0:U.name,r.jsx(H,{name:"IcArrow",className:"ml-2",size:"xxxsmall"})]})]}),r.jsxs("div",{className:"w-full py-2.5 text-t2 text-grey3 mb-1 px-2 flex justify-between animate-hover cursor-pointer",onClick:Q=>D(Q,!1),children:[r.jsx("p",{className:"text-black",children:"结束日期"}),r.jsxs("button",{className:"text-t2 text-grey3 flex items-center",disabled:l,children:[(W=(V=v==null?void 0:v.data.schema)==null?void 0:V[T!=null?T:""])==null?void 0:W.name,r.jsx(H,{name:"IcArrow",className:"ml-2",size:"xxxsmall"})]})]})]}),a===m.CollectionViewType.FORM&&r.jsxs(r.Fragment,{children:[r.jsx(Rr,{className:"my-1 mx-2"}),r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示收集表说明"}),r.jsx(wn,{open:!!(b!=null&&b.format.formShowDescription),onSwitch:Q=>{yt(o,{formShowDescription:Q})},disabled:l})]}),r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2",children:[r.jsx("span",{className:"text-t2",children:"显示序号"}),r.jsx(wn,{open:!!((z=b==null?void 0:b.format.formSerialNumber)==null||z),onSwitch:Q=>{yt(o,{formSerialNumber:Q})},disabled:l})]}),r.jsxs("div",{className:"flex h-10 w-full items-center justify-between px-2 animate-hover animate-click",onClick:()=>p({viewId:o,collectionId:i}),children:[r.jsx("span",{className:"text-t2",children:"结束页设计"}),r.jsxs("span",{className:"text-t2 text-grey3 flex items-center",children:[b.format.formEndPage?"已设置":"未设置",r.jsx(H,{className:"ml-2",size:"xxxsmall",name:"IcArrowUnfold"})]})]})]}),!l&&!c&&r.jsxs(r.Fragment,{children:[r.jsx(Rr,{className:"my-1 mx-2"}),r.jsxs("button",{className:"h-10 px-2 flex w-full items-center animate-hover rounded",onClick:()=>{ce.event("bitable_view_create",{from_scene:s?"inline":"inthepage",view_type:a});const Q=g(o);Q&&n(Q)},children:[r.jsx(H,{className:"mr-1",size:"middle",name:"IcMenuDuplicate"}),r.jsx("span",{className:"text-t2",children:"拷贝"})]}),k.length>1&&r.jsxs("button",{className:"h-10 px-2 flex w-full items-center animate-hover rounded",onClick:()=>{x.warning({title:r.jsx(r.Fragment,{children:"是否确认删除该视图？"}),confirm:()=>{_(o)}})},children:[r.jsx(H,{className:"mr-1",size:"middle",name:"IcMenuDelete"}),r.jsx("span",{className:"text-t2",children:"删除"})]})]})]}):null};var XC=(e=>(e.VIEW="view",e.PROPERTY="property",e.FILTER="filter",e.SORT="sort",e.GROUP="group",e.SUB_GROUP="sub_group",e.FORM_LOGIC="form_logic",e))(XC||{});const _b=[{name:"视图",type:"view",Component:$re},{name:"属性",type:"property",Component:KC},{name:"筛选",type:"filter",Component:Jg},{name:"排序",type:"sort",Component:ch},{name:"分组",type:"group",Component:Pc}],QC=e=>{var i,l;const{viewType:t}=Te(),[n,s]=F.useState((i=e.defaultItemType)!=null?i:"view");let a=[..._b];t===m.CollectionViewType.FORM?(a=_b.filter(c=>c.type==="view"||c.type==="property"),a.push({name:"跳题逻辑",type:"form_logic",Component:Ere})):t===m.CollectionViewType.BOARD?a.push({name:"子分组",type:"sub_group",Component:Pc}):t===m.CollectionViewType.CALENDAR&&(a=_b.filter(c=>c.type!=="group"));const o=(l=a.find(c=>c.type===n))==null?void 0:l.Component;return o?r.jsxs("div",{className:B("next-modal-scroll rounded-sm pt-[5px]",n==="filter"?"min-w-[400px]":n==="form_logic"?"min-w-[560px]":"w-[400px]"),children:[r.jsx("div",{className:"border-b border-grey6 py-1.5 px-2 flex",children:a.map(c=>r.jsx("button",{onClick:()=>s(c.type),className:B("mr-2 rounded-sm py-1.5 px-2 animate-hover-black3 text-t2",c.type===n&&"bg-black_006"),children:c.name},c.name))}),r.jsx(o,{...e,isSubGroup:n==="sub_group",isFromViewSetting:!0})]}):null},Gre=()=>{const e=ae(t=>t.spaces);return Object.values(e).every(t=>!t.permissions)},nl=({icon:e,description:t,children:n})=>{const s=Gre();return r.jsxs("div",{className:"flex flex-col h-[480px]",children:[r.jsxs("div",{className:"flex flex-col items-center justify-center flex-1",children:[r.jsx($s,{emojiStr:e,disableHover:!0,iconSize:70}),r.jsx("div",{className:"text-t1-medium mt-2.5",children:t}),n]}),r.jsxs("a",{href:s?`${Sn()}${Rt.create}`:location.origin,onClick:()=>Nn(eV,"true"),className:"inline-flex items-center justify-center border-b border-black mx-auto flex-shrink-0 mb-10 cursor-pointer",rel:"noreferrer",children:[r.jsx($s,{emojiStr:"👉",disableHover:!0,iconSize:14})," 使用 Flowus 免费创建收集表 ",r.jsx($s,{emojiStr:"👈",disableHover:!0,iconSize:14})]})]})},zre=e=>{const t=La(),{formOnlyOneSubmit:n,resubmit:s,viewId:a}=e,o=ps(a),[i,l]=F.useState("padding"),[c,u]=F.useState(!1),d=F.useMemo(()=>{var y,b;let g=o==null?void 0:o.format.formEndPage;if(g!=null&&g.includes(id)&&(g=(y=g.split(id))==null?void 0:y[0]),g!=null&&g.includes(" ")&&(g=(b=g.split(" "))==null?void 0:b[0]),!g)return"";const _=Jp(g);return lx((_==null?void 0:_.pathname)||"")},[o==null?void 0:o.format.formEndPage]),f=()=>{u(!0)},h=async()=>{if(!d){l("hidden");return}await t(d,{callback:g=>{g.code===200&&hn(d).shared?l("show"):l("hidden")}}).catch(()=>{l("hidden")})},p=()=>{dg(o==null?void 0:o.format.formEndPage)};return F.useEffect(()=>{h()},[]),c?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-end absolute -top-10 z-[100] w-full",children:[n?r.jsx("div",{}):r.jsx(je,{className:"text-t2",colorType:"base_white",onClick:s,children:"返回再次填写"}),r.jsx(je,{className:"text-t2 ml-4",colorType:"base_white",onClick:p,children:"查看原页面"})]}),r.jsx("div",{className:"flex max-h-[60vh] min-h-[58vh]",children:r.jsx(WL,{uuid:d})})]}):r.jsxs(nl,{icon:"😀",description:"您已提交成功",children:[i==="hidden"&&!n&&r.jsx(je,{className:"mt-10 w-44",colorType:"active",size:"middle",onClick:()=>s==null?void 0:s(),children:"再填写一次"}),i==="show"&&r.jsxs("div",{className:"text-t1 text-grey3 mt-3 select-none",children:["即将自动跳转至信息展示页 ",r.jsx(Dx,{time:3,onFinish:f}),r.jsx("span",{className:"ml-2 animate-click text-active_color",onClick:f,children:"立即跳转"})]})]})},JL=({shareId:e})=>{const t=NF(),{collectionId:n,viewId:s}=Te(),[a,o]=F.useState(null),i=ps(s),{formIllegal:l,formOnlyOneSubmit:c}=(i==null?void 0:i.format)||{},u=xC(s,{blockType:"form"}),d=_e(n,["data"],["cover","coverPos"]),f=Gi({ignoreSorters:!0}),h=!e,p=Yd(n),g=r.jsx(zre,{viewId:s,formOnlyOneSubmit:c,resubmit:()=>{o(null)}}),_=x=>{if(e){if(!i)return ye.success("提交失败，请刷新后重试");const{title:y,...b}=x;Ce.editor.formViewPostBlock.raw(e,{id:qe(),spaceId:i.spaceId,segments:y,collectionProperties:b}).then(E=>{E.code===200?(o(g),K.user.uuid&&t(Ae.LIMITED_TIME_COLLECTION_TABLE,{createdBy:i.createdBy})):o(r.jsx(nl,{icon:"😑",description:E.msg}))}),ce.event("submit_form")}else f({viewId:s,where:{},propertyValues:x}),o(g)};return d?r.jsx(YC,{className:"p-0",containerClassName:"relative min-h-[100%]",header:r.jsx(nf,{shareId:e,uuid:d.uuid,ossName:d.data.cover||"cover/flowus2",hiddenEditorButton:!0,height:320}),report:!p&&!l?u:void 0,hiddenFooter:h,children:a||r.jsx(ZL,{shareOrPreview:!0,className:"px-20",onSubmit:_})}):null},JC=()=>{const e=me();return F.useCallback(t=>{const{viewId:n,collectionId:s}=t,a={viewId:n,collectionId:s,viewParentId:s,readonly:!0,managerReadonly:!0,changeView:()=>{},isColumnListChildren:!1,isFoldListChildren:!1,viewType:m.CollectionViewType.FORM};e.modal({modalId:Xe.PREVIEW_FORM,className:"form-scroll-container w-[90vw] h-[90vh] pb-10 overflow-y-auto",content:()=>r.jsx(_l.Provider,{value:a,children:r.jsx(jl,{children:r.jsx(mi.Provider,{value:zc.FORM_PREVIEW,children:r.jsx(JL,{})})})})})},[e])},Wre=e=>{var d;const{width:t=370,tabs:n,main:s}=e,a=-t,[o,i]=F.useState(0),[l,c]=F.useState(((d=n[0])==null?void 0:d.id)||""),u=f=>{c(f),i(a)};return r.jsx("div",{className:"sm:mx-3 sm:w-[calc(100vw-24px)] next-modal overflow-hidden",style:{width:t},children:r.jsxs("div",{className:"flex transition-transform ease-in-out",style:{transform:`translateX(${o}px)`},children:[r.jsx(BN,{width:t,active:o===0,children:s(u)}),r.jsx(BN,{width:t,active:o===a,children:n.map(f=>f.id!==l?null:r.jsx(F.Fragment,{children:f.content(()=>i(0))},f.id))})]})})},BN=({active:e,children:t,width:n})=>r.jsx("div",{className:"flex-shrink-0",style:{width:n},children:e&&t}),ZC=()=>{const e=me();return F.useCallback(t=>{const{popcorn:n,viewId:s,placement:a,collectionId:o}=t,i=[{id:"FormUserList",content:l=>r.jsx(FR,{uuid:s,backToMainPanel:l})},{id:"SelectUsers",content:l=>r.jsx(Ak,{searchType:"form",uuid:s,backToMainPanel:l})}];e.dropdown({popcorn:n,placement:a,content:({onCloseModal:l})=>r.jsx(Wre,{main:c=>r.jsx(Kre,{onChangeTab:c,viewId:s,onCloseModal:l,collectionId:o}),tabs:i})})},[e])},Kre=({viewId:e,onChangeTab:t,collectionId:n})=>{const a=Tg(e),o=So(a),l=Ao()?{[m.FormPermission.LOGIN]:"任何获得此链接的人，登录后可填写",[m.FormPermission.NO_LOGIN]:"任何获得此链接的人，无需登录即可填写",[m.FormPermission.WORKSPACE]:"仅当前空间成员可填写",[m.FormPermission.INVITE]:"仅邀请的人可填写"}:{[m.FormPermission.LOGIN]:"任何获得此链接的人，登录后可填写",[m.FormPermission.NO_LOGIN]:"任何获得此链接的人，无需登录即可填写"},c=me(),u=ps(e),d=$i(u==null?void 0:u.createdBy),{formPermission:f=m.FormPermission.LOGIN,formInviteUserPermissions:h=[]}=(u==null?void 0:u.format)||{},p=!!(u!=null&&u.format.formShared),g=f===m.FormPermission.INVITE,_=f===m.FormPermission.NO_LOGIN,x=`${Sn()}${Rt.form}${u==null?void 0:u.shareId}${d!=null&&d.inviteCode?`?${ms.inviteCode}=${d.inviteCode}`:""}`;F.useEffect(()=>{Jx(Tn().uuid)},[]);const y=async(k=!p)=>{var T,v;if(o)return;if(ce.event("form_share_switch",{is_open:k}),k&&!(u!=null&&u.shareId)){const j=(await Ce.editor.getCollectionView(e)).shareId||qe();Zc(e,{shareId:j})}const C=(T=le().collectionViews)==null?void 0:T[e];C&&yt(e,{formShared:k,formPermission:(v=C.format.formPermission)!=null?v:m.FormPermission.LOGIN,formOnlyOneSubmit:C.format.formPermission===m.FormPermission.NO_LOGIN?!1:C.format.formOnlyOneSubmit})},b=(k=!(u!=null&&u.format.formOnlyOneSubmit))=>{o||yt(e,{formOnlyOneSubmit:k})},E=k=>{o||c.dropdown({popcorn:k.currentTarget,content:C=>r.jsx(ze,{className:"next-modal py-2.5 w-80",onItemClick:()=>C.onCloseModal(),items:Object.keys(l).map(T=>({type:$.OPERATION,data:{title:l[T],selected:f===Number(T),onClick:()=>{var j;const v={[m.FormPermission.LOGIN]:"Anyone_login",[m.FormPermission.NO_LOGIN]:"Anyone",[m.FormPermission.WORKSPACE]:"Space_member",[m.FormPermission.INVITE]:"people_invite"};ce.event("form_authority",{authority_is:v[T]});const I=(j=le().collectionViews)==null?void 0:j[e];I&&yt(e,{formPermission:Number(T),formOnlyOneSubmit:I.format.formPermission===m.FormPermission.NO_LOGIN?!1:I.format.formOnlyOneSubmit})}}}))})})},w=()=>{var k;on(`${x}
${id}${(k=u==null?void 0:u.title)!=null?k:zj}`,{message:"已复制链接"})};return r.jsxs("div",{className:B("pt-2.5",!p&&"pb-2.5"),children:[r.jsxs("div",{className:"animate-hover rounded-none cursor-pointer py-2.5 px-4 flex items-center justify-between",onClick:()=>y(),children:[r.jsxs("div",{children:[r.jsx(eu,{popup:"了解收集表分享",className:"text-t2 mb-px",link:Ta.shareFormLink,children:"分享表单"}),r.jsx("div",{className:"text-t4 text-grey3",children:"开启后可进行分享设置"})]}),r.jsx(wn,{open:p,onSwitch:y,disabled:o})]}),p&&r.jsxs(r.Fragment,{children:[r.jsx(Rr,{className:"mx-4 my-1"}),r.jsxs("div",{className:B("animate-hover rounded-none cursor-pointer py-2.5 px-4 flex items-center justify-between",_&&"pointer-events-none opacity-30"),onClick:()=>b(),children:[r.jsx("div",{className:"text-t2 mb-px",children:"允许填写人提交多次"}),r.jsx(wn,{open:!u.format.formOnlyOneSubmit,onSwitch:()=>b(),disabled:o})]}),r.jsx(Rr,{className:"mx-4 my-1"}),r.jsx("div",{className:B("animate-hover rounded-none cursor-pointer py-2.5 px-4 flex items-center justify-between mb-1",o&&"cursor-not-allowed"),onClick:k=>E(k),children:r.jsxs("div",{className:"text-t2 mb-px flex items-center justify-between w-full",children:[r.jsxs("span",{className:"flex items-center",children:[r.jsx(H,{name:"IcUrl",className:"mr-2",size:"middle"}),l[f]]}),r.jsx(H,{name:"IcArrow",className:"text-grey3 ml-2",size:"xxxsmall"})]})}),g&&r.jsxs(r.Fragment,{children:[r.jsx(Rr,{className:"mx-4 my-1"}),r.jsx(gR,{className:"px-4 py-2.5",uuid:n,onClick:()=>t("SelectUsers")}),h.length>0&&r.jsx("div",{className:"px-4 py-2.5",children:r.jsx(FR,{uuid:e,num:5,onlyUserList:!0})}),5<h.length&&r.jsxs("div",{onClick:()=>t("FormUserList"),className:"flex items-center animate-click animate-hover rounded-none px-4 py-2.5",children:[r.jsx(H,{size:"middle",className:"text-grey4",name:"IcShareAnyone"}),r.jsxs("div",{className:"text-t3 text-grey4 pl-4",children:["查看所有填写者（",h.length," 个）"]})]})]}),r.jsx(pR,{uuid:e,url:x,onCopyLink:w})]})]})},Yre=()=>{var p;const{viewId:e,collectionId:t,viewParentId:n,changeView:s}=Te(),a=me(),o=ps(e),i=ZC(),l=Qg(),c=JC(),u=KL(),d=F.useRef((p=o==null?void 0:o.title)!=null?p:"");F.useEffect(()=>{var g;d.current=(g=o==null?void 0:o.title)!=null?g:""},[o==null?void 0:o.title]);const f=F.useRef(e);f.current=e;const h=g=>{a.dropdown({popcorn:g.currentTarget,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],closeBeforeCallBack(){var y;const _=d.current,x=(y=le().collectionViews)==null?void 0:y[f.current];_!==(x==null?void 0:x.title)&&Zc(f.current,{title:_})},content:({onCloseModal:_})=>r.jsx(QC,{viewTitleRef:d,onCloseModal:_,defaultItemType:XC.FORM_LOGIC})})};return r.jsxs("div",{className:"py-2 next-modal w-[70px] ml-5 h-min",children:[r.jsx(vh,{icon:"IcSkipQuestion",text:"逻辑",onClick:g=>{h(g)}}),r.jsx(vh,{icon:"IcEndPage",text:"结束页",onClick:()=>{u({viewId:e,collectionId:t})}}),r.jsx(vh,{icon:"IcMenuShow",text:"预览",onClick:()=>{c({viewId:e,collectionId:t})}}),r.jsx(vh,{icon:"IcFormShare",text:"分享",onClick:g=>{i({popcorn:g.currentTarget,viewId:e,collectionId:t,placement:"bottom"})}}),r.jsx(vh,{icon:"IcDataCollection",text:"数据",onClick:()=>{var _,x;const g=(x=(_=K.blocks[t])==null?void 0:_.views)==null?void 0:x.find(y=>{var b;return((b=K.collectionViews[y])==null?void 0:b.type)===m.CollectionViewType.TABLE});if(g)s(g);else{const y=l(n,"表格",m.CollectionViewType.TABLE);y?s(y):ye.error("切换失败")}}})]})},vh=e=>r.jsxs("div",{className:"cursor-pointer flex flex-col items-center py-1 mx-1 animate-hover",onClick:e.onClick,children:[r.jsx(H,{name:e.icon,size:"middle"}),r.jsx("span",{className:"text-t2 mt-1",children:e.text})]}),ZL=({onSubmit:e,shareOrPreview:t=!1,className:n})=>{var re,ne;const s=me(),{viewId:a,collectionId:o,readonly:i,isLocked:l}=Te(),c=_w(),[u,d]=F.useState(null),f=ps(a),h=f==null?void 0:f.format.formIllegal,p=!!(i||h||c||l),[g,_]=F.useState(!1),x=(re=ae(({blocks:Y})=>{var X;return(X=Y[o])==null?void 0:X.data.schema}))!=null?re:{},[y=[]]=Ha(a,{visible:!0}),[b,E]=F.useState({}),[w,k]=F.useState({}),{fontStyle:C}=ZF(o),T=(ne=f==null?void 0:f.format.formLogic)!=null?ne:[],v=t,I=F.useMemo(()=>(f==null?void 0:f.format.formPermission)&&[m.FormPermission.WORKSPACE].includes(f.format.formPermission),[f==null?void 0:f.format.formPermission]),j=(Y,X,oe)=>{k(ie=>({...ie,[Y]:[...ie[Y]||[],{id:X,url:oe}]}))},D=y.filter(Y=>!(!I&&p&&Y.type===m.CollectionSchemaType.PERSON||Bw.includes(Y.type))),S=k0(x,D.map(Y=>Y.property),T),[R,A]=F.useState(null),[L,P]=F.useState(0),U=(Y=>{if(!v||S.length<=0)return y;const X=Y===null?0:y.findIndex(ue=>ue.property===Y),ie=(ue=>{for(let ge=ue;ge<y.length;ge++)if(S.some(Ne=>Ne.condition.property===y[ge].property))return ge;return-1})(X);return ie!==-1?y.slice(X,ie+1):y.slice(X)})(R),V=D.filter(Y=>U.some(X=>X.property===Y.property)).map(Y=>{var X;return{id:Y.property,data:Y,submitData:b[Y.property],formProperty:(X=f==null?void 0:f.format.formProperties)==null?void 0:X.find(oe=>oe.property===Y.property)}}),W=async Y=>{var ue;const X=Y.map(ge=>ge.data),oe=Tp(o,a,X.map(ge=>ge.property),T);if(oe!=null&&!await new Promise(Ne=>{s.warning({title:r.jsx(r.Fragment,{children:"确认调整题目顺序吗？"}),content:r.jsx(r.Fragment,{children:"会导致部分跳题逻辑失效，将自动删除失效逻辑。"}),confirm(){Ne(!0)},cancel(){Ne(!1)}})}))return;const ie=K.collectionViews[a];ie&&yt(a,{[`${ie.type}Properties`]:Bm([...X,...(ue=ie.format.formProperties)!=null?ue:[]],"property"),...oe?{formLogic:oe}:{}})},z=(Y,X,oe)=>{const{concatSegment:ie=!1}=oe||{};E(ie?ue=>({...ue,[Y]:[...ue[Y]||[],...X||[]]}):ue=>({...ue,[Y]:X||[]}))},Q=Y=>{yt(a,{formDescription:Y})},Z=Y=>{Zc(a,{title:Y.replace(/[\r\n]/g,"")})},te=()=>{var X;if(V.every(oe=>{var ge;const ie=()=>{var Ie;const Ne=document.querySelector(`.form-scroll-container [data-form-property="${(Ie=oe.formProperty)==null?void 0:Ie.property}"]`),De=document.querySelector(".form-scroll-container"),{top:Se}=Zw(Ne,De);Ne.classList.add("animate__flash","animate__animated"),setTimeout(()=>{Ne.classList.remove("animate__flash","animate__animated")},2e3),De.scrollTo({top:Se-200,behavior:"smooth"})},ue=de(oe.submitData);if((ge=oe.formProperty)!=null&&ge.required){if(oe.data.type===m.CollectionSchemaType.CHECKBOX&&ue!=="YES")return ie(),ye.error("请填写必填项"),!1;if(!oe.submitData||oe.submitData.length===0||!ue)return ie(),ye.error("请填写必填项"),!1}return!0}))if(v){const oe=(X=V[V.length-1].formProperty)==null?void 0:X.property,ie=T.filter(Ne=>Ne.condition.property===oe),ge=(Ne=>{var Se,Ie;const De=D.findIndex(Ke=>Ke.property===oe);if(De===-1||De===D.length-1)return Wf;for(const Ke of Ne)if(zA(Ke.condition,{collectionId:o,schemas:x})({data:{segments:b.title,collectionProperties:b}}))return Ke.gotoProperty;return(Ie=(Se=D[De+1])==null?void 0:Se.property)!=null?Ie:Wf})(ie);ge===Wf?e==null||e(b):(A(ge),P(Ne=>Ne+V.length))}else e==null||e(b)};return f?r.jsxs("div",{"data-disable-select":!0,className:B("line-default flex flex-col justify-between h-full",n),style:C,children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-h1 text-center w-full pt-10 pb-2",children:r.jsx(oo,{readonly:p,placeholder:g?"":"未命名收集表",fontClassName:"text-center",maxLength:1e3,value:f.title,onChange:Y=>Z(Y.currentTarget.value),onFocus:()=>_(!0),onBlur:()=>_(!1)})}),f.format.formShowDescription&&(p&&f.format.formDescription||!p)&&r.jsx("div",{className:"py-2 text-center",children:r.jsx(co,{keydownOption:sA,readonly:p,uuid:a,className:"text-t1",placeholder:p?"":"请输入收集表说明",segments:typeof f.format.formDescription=="string"?mt(f.format.formDescription):f.format.formDescription,onChange:Y=>{de(Y).length<=1e3&&Q(Y)}})}),r.jsx("div",{className:"h-5"}),r.jsx(vr,{disabled:p,onDragStart:Y=>d(Y.active.id),onDragEnd:()=>d(null),items:V,onChange:W,modifiers:[qE],renderItemContent:({item:Y,renderDragHandle:X})=>r.jsx(Xre,{...Y.data,hiddenElement:u===Y.id,readonly:p,formProperties:Y.formProperty,renderDragHandle:X,index:L+V.findIndex(oe=>oe.data.property===Y.data.property),handleChangeSubmitData:z,submitData:Y.submitData,uploadFileList:w,pushUploadFileList:j})}),!p&&r.jsx(Ji.CreateFormProperty,{viewId:a,collectionId:o})]}),p&&!c&&!h?r.jsx(je,{colorType:"active",size:"auto",className:"h-12 w-44 self-end my-10",onClick:te,children:"提交"}):r.jsx("div",{className:"h-20"})]}):null},Xre=e=>{const{readonly:t,handleChangeSubmitData:n,property:s,uploadFileList:a,submitData:o,type:i,name:l,pushUploadFileList:c,renderDragHandle:u,index:d,formProperties:f,hiddenElement:h}=e,{collectionId:p,viewId:g,readonly:_}=Te(),x=ps(g),{formPermission:y,formSerialNumber:b}=(x==null?void 0:x.format)||{},E=y&&[m.FormPermission.WORKSPACE].includes(y),{propertySchema:w}=qa(p,s),k=_w(),C={readonly:t,schema:w,collectionId:p,submitData:o,key:s,property:s,handleChangeSubmitData:n,spaceId:x==null?void 0:x.spaceId,viewId:g,type:i},T={};let v=r.jsx(Ji.FormatTextarea,{...C});switch(i){case m.CollectionSchemaType.CHECKBOX:v=r.jsx(Ji.CheckBox,{...C});break;case m.CollectionSchemaType.DATE:v=r.jsx(Ji.DateElement,{...C});break;case m.CollectionSchemaType.FILE:v=r.jsx(Ji.File,{...C,uploadFileList:a[s],pushUploadFileList:c});break;case m.CollectionSchemaType.SELECT:case m.CollectionSchemaType.MULTI_SELECT:T.after=r.jsx("span",{className:"text-grey3",children:i===m.CollectionSchemaType.SELECT?"【单选】":"【多选】"}),v=r.jsx(Ji.Select,{...C,type:i});break;case m.CollectionSchemaType.PERSON:E||(T.after=r.jsx(Fe,{hideOnClick:!1,className:"w-3.5 pt-px",maxWidth:300,onClick:j=>j.stopPropagation(),popup:"非当前空间成员无法填写成员属性",children:r.jsx(H,{name:"IcBadgeDanger",size:"xsmall",className:"ml-0.5 mt-1.5"})})),v=r.jsx(Ji.Person,{...C});break;case m.CollectionSchemaType.NUMBER:case m.CollectionSchemaType.EMAIL:case m.CollectionSchemaType.URL:case m.CollectionSchemaType.PHONE:v=r.jsx(Ji.FormatTextarea,{...C,type:i});break}const I=typeof(f==null?void 0:f.description)=="string"?mt(f==null?void 0:f.description):f==null?void 0:f.description;return r.jsx(Ji.Container,{readonly:h||t,titleAfter:T.after,titleBefore:T.before,renderDragHandle:u,collectionId:p,index:d+1,property:s,formSerialNumber:b,title:l,required:f==null?void 0:f.required,showDescription:(f==null?void 0:f.showDescription)&&!h,description:I,viewId:g,children:!h&&(k?r.jsx("div",{className:"pointer-events-none cursor-default",children:v}):v)})},Qre=()=>{const{viewId:e,collectionId:t,readonly:n}=Te(),s=ps(e),a=Ek(e,{blockType:"form"}),o=s==null?void 0:s.format.formIllegal,i=wk(t);return r.jsxs(r.Fragment,{children:[o&&r.jsxs("div",{className:"flex items-center justify-between bg-red text-white h-14 text-t2 px-4",children:[r.jsx("span",{}),r.jsx("span",{children:"当前页面违反平台分享协作条例，已禁止使用"}),i&&r.jsx(je,{colorType:"white",onClick:a,children:"申诉"})]}),r.jsxs("div",{className:"flex mx-auto mt-5 max-w-[1050px]",children:[r.jsx("div",{className:"next-modal shadow-light px-20 w-full",children:r.jsx(ZL,{})}),!n&&r.jsx(Yre,{})]})]})},Jre=e=>{const t=tf();return r.jsx("div",{"data-disable-select":!0,onClick:()=>{t({blockId:e.blockId})},children:r.jsx(H,{name:"IcMenuComment",size:"small",className:"pointer-events-none"})})},Zre=({hoverNode:e})=>{const t=e_();return r.jsx("div",{id:cg,"data-draggable":!0,"data-disable-select":!0,"data-block-id":e.id,"data-view-id":e.node.dataset.viewId,"data-group-value":e.node.dataset.groupValue,onClick:n=>{const s=Ya(e.id);ce.event("block_menu",{block_name:s}),t({blockId:e.id,blockNode:e.node,menuPosition:n.currentTarget})},className:"w-5 h-6 flex items-center justify-center animate-hover rounded text-grey4 hover:text-grey1 cursor-[grab]",children:r.jsx(H,{name:"IcBlockHandle",size:"small",className:"pointer-events-none"})})},eae=({id:e,className:t})=>{const n=ae(s=>{var o;const a=s.blocks[e];if(a&&[m.BlockType.HEADER,m.BlockType.TOGGLE_HEADER].includes(a.type))return(o=a.data.level)!=null?o:1});return n?r.jsx("div",{className:B("text-grey4 pointer-events-none",t),children:`H${n}`}):null},tae=()=>{const e=Wc(),t=ix(),[n,s]=F.useState(),a=On(),o=F.useCallback(()=>{In.emit("hoverId"),s(void 0)},[]);return F.useEffect(()=>(In.on("removeHoverMenu",o),()=>{In.off("removeHoverMenu",o)}),[o]),F.useEffect(()=>{const i=jn(".block-content",a),l=jn(".next-space-page",a);if(!i||e||t||!l){o();return}const u=fs(d=>{var _;const{blockId:f,node:h}=kB(d,i);let p=f,g=h;if(!(h!=null&&h.dataset.hideHoverMenu)){if(h!=null&&h.dataset.dropInChild)g=h.closest("[data-block-id]");else if((h==null?void 0:h.tagName)==="TD")g=(_=h.parentElement)==null?void 0:_.closest("[data-block-id]"),p=g==null?void 0:g.dataset.blockId;else if(h!=null&&h.dataset.mindMapId)return;if(p&&(g!=null&&g.firstElementChild)){if(g.id===cg)return;const x=g.firstElementChild.getBoundingClientRect(),y=getComputedStyle(g.firstElementChild),b=parseInt(y.getPropertyValue("line-height"),10),E=parseInt(y.getPropertyValue("padding-top"),10),w=i.getBoundingClientRect();let k=x.left-w.left,C=x.top-w.top;const T=parseInt(y.getPropertyValue("padding-left"),10);T>90&&(k+=T-2,C+=20),(n==null?void 0:n.id)!==p&&(In.emit("hoverId",p),s({id:p,node:g,lineHeight:b,paddingTop:E,offsetTop:C,offsetLeft:k}))}else o()}},32);return l.addEventListener("mousemove",u),l.addEventListener("keydown",o),()=>{l.removeEventListener("mousemove",u),l.removeEventListener("keydown",o)}},[n==null?void 0:n.id,n==null?void 0:n.offsetTop,e,a,o,t]),n},Fm=({readonly:e=!1})=>{var I,j;const t=wL(),n=tae(),s=$$(),a=Dd(),o=Wc(),i=Xp(),l=ae(D=>D.collectionViews),c=_e(n==null?void 0:n.id,["data","status"],["segments"]),u=_e(c==null?void 0:c.parentId,[]),d=rse(c==null?void 0:c.uuid),f=c&&n&&Wr(u==null?void 0:u.type),h=Im(),p=ht(),g=Vn()===Tt.MAIN,_=!e&&(f||!d&&(c==null?void 0:c.type)===m.BlockType.TEXTAREA&&xc(c.data));let x=!1;(!n||!(n!=null&&n.node.clientHeight)||s||a||i||o)&&(x=!0),c||(x=!0);const y=c&&u,b=(y==null?void 0:y.type)===m.BlockType.QUOTE,E=n?{top:n.offsetTop+n.lineHeight/2+n.paddingTop,left:n.offsetLeft-2-(b?20:0)}:{};if(f){E.top=n.offsetTop+si/2;const D=(I=n.node.dataset.viewId)!=null?I:"",S=l[D],{role:R}=hn((j=S==null?void 0:S.parentId)!=null?j:""),{role:A}=hn(c.parentId);if(R===m.PermissionRole.READER||A===m.PermissionRole.READER||(S==null?void 0:S.type)===m.CollectionViewType.CALENDAR||(S==null?void 0:S.type)===m.CollectionViewType.BOARD)return null;(S==null?void 0:S.type)===m.CollectionViewType.LIST&&(E.top=n.offsetTop+si/2-5)}n&&(c!=null&&c.type)&&([m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.MIND_MAPPING_PAGE].includes(c.type)&&(E.top=n.offsetTop+16),[m.BlockType.SYNC_CONTAINER,m.BlockType.TABLE].includes(c.type)&&(E.top=n.offsetTop+32),[m.BlockType.CODE].includes(c.type)&&(E.top=n.offsetTop+19));const w=fg(c),k=Fs(hn(c==null?void 0:c.uuid).role,m.PermissionRole.COMMENTER),v=!p&&!f&&w&&k&&g||p&&!f&&w&&k&&h;if(e&&!v)return null;if(c){const{role:D}=hn(c.uuid);if(D===m.PermissionRole.READER)return null}return r.jsx(OR,{children:r.jsx(r.Fragment,{children:!x&&n&&r.jsxs("div",{id:Y$,className:"absolute",style:E,onClick:D=>{D.preventDefault()},children:[_&&r.jsx(Fe,{className:B("w-5 h-6 flex items-center justify-center animate-hover rounded text-grey4 hover:text-grey1 cursor-pointer absolute -top-3 -left-10"),placement:"bottom",popup:"添加块",children:r.jsx("div",{id:"addMenu","data-disable-select":!0,onClick:D=>{c!=null&&c.uuid&&(D.stopPropagation(),t(c.uuid,{syncId:n.node.dataset.syncId}))},children:r.jsx(H,{name:"IcBlockAdd",className:"pointer-events-none",size:"small"})})}),!e&&r.jsxs(r.Fragment,{children:[r.jsx(Fe,{className:B("absolute -top-3 -left-5",d&&"-left-10"),placement:"bottom",popup:r.jsxs("span",{className:"text-center",children:[r.jsx("div",{children:"长按拖拽"}),r.jsx("div",{children:"点击打开菜单"})]}),children:r.jsx(Zre,{hoverNode:n})}),r.jsx(eae,{id:n.id,className:"absolute -top-3 -left-10"})]}),e&&v&&r.jsx(Fe,{className:B("absolute -top-3 -left-5 cursor-pointer",d&&"-left-9"),children:r.jsx(Jre,{blockId:n.id})})]})})})},e9=e=>ae(t=>{const n=Zt(e,t.blocks,t.collectionViews);if(!n)return!1;const{view:s,collection:a}=n;return qg(s.format.filter,a.data.schema)}),t9=({filterEnabled:e,groupValue:t})=>{const{viewId:n}=Te(),s=Gi(),a=vm(n),o=Xd(n),i=()=>{e&&a&&s({viewId:n,where:{last:!0}})};return r.jsxs("div",{"data-is-empty":!0,"data-group-value":t,"data-view-id":n,onClick:i,className:B("group text-t2 relative flex h-[37px] items-center border-b pl-2 text-grey4",e&&a&&" cursor-pointer"),children:[o&&r.jsx("div",{className:"absolute top-0 left-0 h-1 w-full bg-black/30 opacity-0 group-hover:opacity-100"}),e?a?"无记录，点击创建新记录 ，或调整视图筛选设置":"没有找到符合筛选条件的记录":"表格内容为空"]})},e3=F.memo(e=>{const{viewId:t}=Te();return Cg(t)?r.jsx(nae,{...e}):r.jsx(sae,{...e})},rn),nae=F.memo(({tableGroup:e,recordIds:t,withoutValidGroup:n,embed:s,properties:a})=>{const{viewId:o,readonly:i}=Te(),l=e9(o),c=ou(),[u,d]=F.useState(c==null?void 0:c.current);return F.useEffect(()=>{d(c==null?void 0:c.current)},[c]),u?r.jsxs("div",{className:"block-list relative","data-view-id":o,"data-group-value":e==null?void 0:e.value,children:[r.jsx(As,{customScrollParent:u,overscan:300,totalCount:t.length,itemContent:f=>{const h=t[f];return h?r.jsx(w0,{recordId:h,tableCellWrap:!0,groupProperty:e==null?void 0:e.groupProperty,groupValue:e==null?void 0:e.value,properties:a},h):null}}),t.length===0&&r.jsx(t9,{filterEnabled:l,groupValue:e==null?void 0:e.value}),r.jsx(hu,{where:{after:n?void 0:t[t.length-1]},groupName:e==null?void 0:e.value}),!i&&!s&&r.jsx(Bc,{type:"table"})]}):null},rn),sae=F.memo(({recordIds:e,tableGroup:t,withoutValidGroup:n,embed:s,properties:a})=>{const{viewId:o,readonly:i,viewType:l}=Te(),c=e.length===0,u=e9(o),d=ou(),f=sr(),[h,p]=F.useState(d==null?void 0:d.current);return F.useEffect(()=>{p(l===m.CollectionViewType.TIMELINE?f==null?void 0:f.current:d==null?void 0:d.current)},[f,d,l]),h?r.jsxs("div",{className:"block-list relative","data-view-id":o,"data-group-value":t==null?void 0:t.value,children:[r.jsx(As,{customScrollParent:h,overscan:200,fixedItemHeight:37,totalCount:e.length,itemContent:g=>{const _=e[g];return _?r.jsx(w0,{recordId:_,groupProperty:t==null?void 0:t.groupProperty,groupValue:t==null?void 0:t.value,properties:a},_):null}}),!i&&!s&&r.jsx(Bc,{type:"table"}),c&&r.jsx(t9,{filterEnabled:u}),r.jsx(hu,{where:{after:n?void 0:e[e.length-1]},groupName:t==null?void 0:t.value})]}):null},rn),rae=()=>{const e=ke(),t=(n,s,a)=>{var c,u;const{collectionViews:o}=le(),i=o[n];if(!i||a===((u=(c=i.format.aggregations)==null?void 0:c[s])==null?void 0:u.action))return;const l={...i.format.aggregations,[s]:{action:a}};e(()=>{Kn(n,{format:{aggregations:l}})})};return F.useCallback(t,[e])},aae=({recordIds:e,propertyId:t,width:n,index:s})=>{const{collectionId:a,viewId:o,managerReadonly:i,isLocked:l}=Te(),c=me(),u=rae(),{propertySchema:d,targetPropertySchema:f}=qa(a,t),h=ae(y=>{var C,T,v;const{collectionViews:b}=y,E=(v=(T=(C=b[o])==null?void 0:C.format.aggregations)==null?void 0:T[t])==null?void 0:v.action,k=p0(a,t).find(I=>I.type===E&&E!==m.AggregationAction.NONE);return k==null?void 0:k.type}),{aggregation:p,type:g}=d!=null?d:{},_=ae(y=>{if(!h||!d)return;const b=Zt(o,y.blocks,y.collectionViews);if(!b)return;const{view:E,collection:w}=b,{blocks:k,user:C}=y,T=ZA({collectionId:a,records:e.map(S=>k[S]).filter(S=>!!S),schemas:w.data.schema,userId:C.uuid,filter:E.format.filter}),v=Ln(a),I=GA(T,t,h,a,v),j=I==null?void 0:I.result,D=(S,R)=>(S==null?void 0:S.type)===m.CollectionSchemaType.NUMBER&&S.numberFormat&&typeof R<"u"||(S==null?void 0:S.type)===m.CollectionSchemaType.FORMULA&&v.getType(t)===He.ValueTool.numberType&&S.numberFormat&&typeof R<"u"?Sc(Number(R),S.numberFormat):R;return g===m.CollectionSchemaType.ROLLUP?Vf(h)&&Vf(p)?D(f,j):j:Vf(h)?D(d,j):j}),x=y=>{if(i||l)return;const E=p0(a,t).map(w=>({type:$.OPERABLE_BLOCK_TEXT,data:w}));c.dropdown({popcorn:y.currentTarget,placement:"bottom",content:({onCloseModal:w})=>r.jsx(ze,{className:"w-[200px] py-2 next-modal",items:E,onItemClick:k=>{u(o,t,k.data.type),w()}})})};return r.jsx("button",{onClick:x,style:{width:n!=null?n:Eo},className:"cursor-default flex-shrink-0 text-right overflow-hidden whitespace-nowrap duration-150",dir:"rtl",children:r.jsx("div",{className:B("opacity-0 animate-hover-black3 w-full h-full px-2 flex items-center",(l||i)&&!h?"pointer-events-none":"group-hover:opacity-100 cursor-pointer",h||!i&&!l&&s===0?"opacity-100 cursor-pointer":"pointer-events-none"),children:h?r.jsxs(r.Fragment,{children:[_!==void 0&&r.jsx("span",{className:"ml-2 text-t2 text-grey3",dir:"ltr",children:_}),r.jsx("span",{className:"text-t2 text-grey3",children:V6[h]})]}):r.jsxs(r.Fragment,{children:[r.jsx(H,{name:"IcArrow",size:"xxxsmall",className:"ml-1 text-grey4"}),r.jsx("span",{className:"text-t2 text-grey4",children:"统计"})]})})})},t3=F.memo(({recordIds:e})=>{const{viewId:t,embed:n,viewType:s}=Te(),a=s===m.CollectionViewType.TIMELINE,[o=[],i=[]]=Ha(t,{visible:!0}),l=F.useRef(null);return F.useEffect(()=>{if(!n)return;const c=l.current,u=c==null?void 0:c.parentElement,d=c==null?void 0:c.closest(".next-space-page");if(!c||!u||!d)return;const f=()=>{const h=u.getBoundingClientRect(),p=d.getBoundingClientRect();if(h.bottom>p.bottom){let g=Math.abs(p.bottom-h.bottom);const _=u.querySelector(`.${bl.tableHeader}`),x=_==null?void 0:_.getBoundingClientRect();x&&p.bottom-x.bottom<c.clientHeight&&(g=g-(c.clientHeight-(p.bottom-x.bottom))),g-=parseInt(getComputedStyle(u).getPropertyValue("padding-bottom"),10),c.style.transform=`translate3d(0,-${Math.round(g)}px,0)`,c.style.borderTopWidth="1px"}else c.style.transform="none",c.style.borderTopWidth="0px"};return d.addEventListener("scroll",f),window.addEventListener("resize",f),()=>{d.removeEventListener("scroll",f),window.removeEventListener("resize",f)}},[n]),r.jsxs("div",{className:B("group sticky bottom-0 flex w-full min-w-max transition-none print:hidden bg-white1",bl.tableFooter),style:{height:si},ref:l,children:[(a?i:o).map((c,u)=>r.jsx(aae,{recordIds:e,index:u,propertyId:c.property,width:c.width?Math.max(lc,c.width):Eo},c.property)),!a&&r.jsx("div",{className:"w-12 flex-1"})]})},Cn),xb=F.memo(({embed:e})=>{const{viewId:t,readonly:n,viewType:s}=Te(),a=Gg(t),[o=[],i=[]]=Ha(t,{visible:!0});ey(),zF(a);const l=F.useRef(null),c=ou(),u=s===m.CollectionViewType.TIMELINE?i:o,[d,f]=F.useState(!0);F.useLayoutEffect(()=>{a!=null&&a.withoutValidGroup||f(!1)},[a==null?void 0:a.withoutValidGroup]);const h=()=>{var E,w;let b=tj(u.map(k=>k!=null&&k.width?Math.max(lc,k.width):Eo));return l.current&&(b<=((w=(E=l.current.parentElement)==null?void 0:E.clientWidth)!=null?w:0)?b=void 0:b+=48),b};if(!a)return null;const{withoutValidGroup:p,sortedRecordIds:g,visibleGroups:_,hiddenGroups:x}=a;if(p)return r.jsxs("div",{className:B("relative min-w-max print:border-l",!e&&"-mr-24 pr-24"),children:[r.jsx(vp,{isGroup:!1,properties:u}),r.jsx(e3,{recordIds:g,embed:e,properties:u}),r.jsx(t3,{recordIds:g}),!n&&!e&&r.jsx(To,{type:"collection"}),!e&&r.jsx(Fm,{readonly:n})]});const y={width:h()};return r.jsxs("div",{ref:l,className:B("relative min-w-max",!e&&"-mr-24 pr-24"),children:[d&&r.jsx(os,{className:"h-[300px]"}),!d&&(c==null?void 0:c.current)&&r.jsxs(r.Fragment,{children:[x.length>100?r.jsx(As,{style:y,customScrollParent:c.current,overscan:300,totalCount:_.length,itemContent:b=>{const E=_[b];return E?r.jsx(nc,{tableGroup:E,withoutValidGroup:p,embed:e,properties:u},E.value):null}}):r.jsx(r.Fragment,{children:_.map(b=>r.jsx(nc,{tableGroup:b,withoutValidGroup:p,embed:e,properties:u},b.value))}),r.jsx(fh,{hiddenGroupsLength:x.length,hiddenGroups:x.length>100?r.jsx(As,{style:y,customScrollParent:c.current,overscan:300,totalCount:x.length,itemContent:b=>{const E=x[b];return E?r.jsx(nc,{tableGroup:E,withoutValidGroup:p,embed:e,properties:u},E.value):null}}):r.jsx(r.Fragment,{children:x.map(b=>r.jsx(nc,{tableGroup:b,withoutValidGroup:p,embed:e,properties:u},b.value))})}),r.jsx(Lc,{}),!n&&!e&&r.jsx(To,{type:"collection"}),!e&&r.jsx(Fm,{readonly:n})]})]})}),nc=F.memo(e=>{const{tableGroup:t,embed:n,withoutValidGroup:s,properties:a,index:o}=e,{viewId:i}=Te(),{recordIds:l,value:c}=t,u=Nm(i,c);return r.jsxs("div",{className:"pb-5","data-group-property":t.groupProperty,"data-group-value":t.value,children:[r.jsx(s_,{tableGroup:t,isInTable:!0,index:o}),u&&r.jsxs(r.Fragment,{children:[r.jsx(vp,{isGroup:!0,groupName:c,properties:a}),r.jsx(e3,{recordIds:l,embed:n,tableGroup:t,withoutValidGroup:s,properties:a}),r.jsx(t3,{recordIds:l})]})]})},rn),ey=()=>{const{viewId:e}=Te(),t=ae(({collectionViews:n})=>{var s;return(s=n[e])==null?void 0:s.format.collectionGroups});F.useEffect(()=>{var a;const n={};(t!=null?t:[]).forEach(o=>{var i,l;n[(i=o.value)!=null?i:Td]=localStorage.getItem(TF(e,(l=o.value)!=null?l:Td))!=="false"});const s=(a=wt.$tableGroupFoldStatus)!=null?a:{};Ye({$tableGroupFoldStatus:{...s,[e]:n}})},[t,e])},oae=e=>{const{viewId:t,readonly:n,embed:s}=Te(),a=Gg(t),o=Lo(t),i=Bo(t),l=Xd(t);ey(),zF(a);const c=F.useRef(null),[u,d]=F.useState(c.current);LL(u),F.useEffect(()=>{u||d(c.current)});const f=sr(),[h,p]=F.useState(f==null?void 0:f.current);if(F.useEffect(()=>{p(f==null?void 0:f.current)},[h,f]),!h||!a)return null;const{withoutValidGroup:g,sortedRecordIds:_,visibleGroups:x,hiddenGroups:y}=a;return r.jsxs(r.Fragment,{children:[g?r.jsxs("div",{ref:c,"data-is-empty":_.length===0?!0:null,"data-view-id":t,className:"block-list grid gap-4 relative border-t border-grey6 pt-5 group",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${Co(o,i)}px, 1fr))`},children:[_.map(b=>r.jsx(AL,{recordId:b},b)),l&&r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-black/30 opacity-0 group-hover:opacity-100"}),!n&&!e.embed&&r.jsx(Bc,{}),r.jsx(hu,{})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"block-list",ref:c,children:[x.length>100?r.jsx(As,{customScrollParent:h,overscan:300,totalCount:x.length,itemContent:b=>{const E=x[b];return E?r.jsx(L_,{tableGroup:E},E.value):null}}):r.jsx(r.Fragment,{children:x.map(b=>r.jsx(L_,{tableGroup:b},b.value))}),r.jsx(fh,{hiddenGroupsLength:y.length,hiddenGroups:y.length>100?r.jsx(As,{customScrollParent:h,overscan:300,totalCount:y.length,itemContent:b=>{const E=y[b];return E?r.jsx(L_,{tableGroup:E},E.value):null}}):r.jsx(r.Fragment,{children:y.map(b=>r.jsx(L_,{tableGroup:b},b.value))})}),!n&&!e.embed&&r.jsx(Bc,{})]}),r.jsx(Lc,{})]}),!n&&!s&&r.jsx(To,{type:"collection"})]})},L_=F.memo(e=>{const{tableGroup:t}=e,{viewId:n}=Te(),s=Lo(n),a=Bo(n),{recordIds:o,value:i,groupProperty:l}=t,c=Xd(n),u=Nm(n,i);return r.jsxs("div",{"data-is-empty":o.length===0?!0:null,"data-view-id":n,"data-group-value":i,"data-group-property":l,className:"relative group pb-5",children:[r.jsx(s_,{tableGroup:t}),c&&r.jsx("div",{className:"absolute top-10 left-0 w-full h-1 bg-black/30 opacity-0 group-hover:opacity-100"}),u&&r.jsxs("div",{className:"grid gap-4 block-list",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${Co(s,a)}px, 1fr))`},children:[o.map(d=>r.jsx(AL,{recordId:d,groupValue:i},d)),r.jsx(hu,{where:{after:o[o.length-1]},groupName:t.value})]})]})},rn),iae=({embed:e})=>{const{viewId:t,readonly:n}=Te(),s=Gg(t),a=Xd(t);ey(),zF(s);const o=F.useMemo(()=>e?r.jsx(r.Fragment,{}):r.jsx(Fm,{readonly:n}),[e,n]),i=sr(),[l,c]=F.useState(i==null?void 0:i.current);if(F.useEffect(()=>{c(i==null?void 0:i.current)},[l,i]),!l||!s)return null;const{withoutValidGroup:u,sortedRecordIds:d,visibleGroups:f,hiddenGroups:h}=s;return u?r.jsxs("div",{"data-is-empty":d.length===0?!0:null,"data-view-id":t,className:"block-list group relative border-t border-grey6 sm:w-max min-w-[500px]",children:[r.jsx(As,{customScrollParent:l,overscan:300,fixedItemHeight:38,totalCount:d.length,itemContent:p=>{const g=d[p];return g?r.jsx(n9,{uuid:g},g):null}}),o,!n&&!e&&r.jsx(To,{type:"collection"}),!n&&!e&&r.jsx(Bc,{}),a&&r.jsx("div",{className:"absolute top-0 left-0 h-1 w-full bg-black/30 opacity-0 group-hover:opacity-100"}),r.jsx(hu,{})]}):r.jsxs("div",{className:"block-list relative sm:w-max min-w-[500px]",children:[f.length>100?r.jsx(As,{customScrollParent:l,overscan:300,totalCount:f.length,itemContent:p=>{const g=f[p];return g?r.jsx(P_,{tableGroup:g},g.value):null}}):r.jsx(r.Fragment,{children:f.map(p=>r.jsx(P_,{tableGroup:p},p.value))}),r.jsx(fh,{hiddenGroupsLength:h.length,hiddenGroups:h.length>100?r.jsx(As,{customScrollParent:l,overscan:300,totalCount:h.length,itemContent:p=>{const g=h[p];return g?r.jsx(P_,{tableGroup:g},g.value):null}}):r.jsx(r.Fragment,{children:h.map(p=>r.jsx(P_,{tableGroup:p},p.value))})}),o,!n&&!e&&r.jsx(To,{type:"collection"}),!n&&!e&&r.jsx(Bc,{}),r.jsx(Lc,{})]})},P_=F.memo(({tableGroup:e})=>{const{viewId:t}=Te(),{recordIds:n,value:s,groupProperty:a}=e,o=Xd(t),i=Nm(t,s),l=sr();return l.current?r.jsxs("div",{"data-is-empty":n.length===0?!0:null,"data-view-id":t,"data-group-value":s,"data-group-property":a,className:"group relative pb-5",children:[r.jsx(s_,{tableGroup:e}),o&&r.jsx("div",{className:"absolute top-10 left-0 h-1 w-full bg-black/30 opacity-0 group-hover:opacity-100"}),i&&r.jsxs(r.Fragment,{children:[r.jsx(As,{customScrollParent:l.current,overscan:300,fixedItemHeight:38,totalCount:n.length,itemContent:c=>{const u=n[c];return u?r.jsx(n9,{groupValue:s,uuid:u},u):null}}),r.jsx(hu,{where:{after:n[n.length-1]},groupName:e.value})]})]}):null},rn),n9=({uuid:e,groupValue:t})=>{const n=_e(e,["data"],["segments"]),{illegal:s}=it(e),{viewId:a}=Te(),o=Cs();return n?r.jsx("div",{className:"py-px",children:r.jsxs(ln,{id:e,viewId:a,groupValue:t,onClick:i=>o(e,{illegal:s,forceOpenInRight:i.altKey,forceOpenNewTab:i.ctrlKey||i.metaKey}),className:"animate-hover-black3 flex h-9 cursor-pointer items-center justify-between rounded pr-1",children:[s&&r.jsxs("div",{className:"flex min-w-[240px] items-center whitespace-nowrap opacity-30",children:[r.jsx(tn,{className:"mr-1 inline-block h-5 w-5 min-w-[20px] p-0 align-middle",blockId:e,trigger:!1,iconSize:20,defaultIcon:r.jsx(as,{uuid:e,size:"middle"})}),r.jsx("span",{className:"text-t2 text-ellipsis border-b border-grey6 align-middle",children:rs})]}),!s&&r.jsxs(r.Fragment,{children:[r.jsx(lae,{recordId:e}),r.jsx(n_,{recordId:e})]})]})}):null},lae=({recordId:e})=>{const{viewId:t}=Te(),n=zs(),s=sh(e),a=Tm(),o=e===(a==null?void 0:a.id)&&t===a.viewId,[i,l]=F.useState(o);return s?r.jsxs("div",{className:"flex min-w-[240px] items-center whitespace-nowrap",children:[r.jsx(tn,{className:"mr-1 inline-block h-5 w-5 min-w-[20px] p-0 align-middle",blockId:e,trigger:!1,iconSize:20,defaultIcon:r.jsx(as,{uuid:e,size:"middle"})}),r.jsx("span",{className:"text-t2 text-ellipsis border-b border-grey6 align-middle",children:i?r.jsx(co,{uuid:e,className:"text-t2-medium inline break-words align-middle",plugins:kr,keydownOption:{bracketRightKey:!1},placeholder:aa,autoFocus:!0,autoFocusCaretToEnd:!0,toolbar:!1,segments:s.data.segments,interactable:o,onChange:c=>n(e,"title",c),onBlur:()=>{l(!1),Ye({$newCreatedRecord:void 0})},onKeyDown:c=>{if(be("mod+a")(c)){c.stopPropagation();return}(be("enter")(c)||be("esc")(c))&&c.currentTarget.blur()}}):r.jsx(Pn,{className:"text-t2-medium inline break-words align-middle",plugins:kr,segments:s==null?void 0:s.data.segments,placeholder:aa,interactable:!1})}),r.jsx(Zd,{className:"inline-flex align-middle pointer-events-none",blockId:e})]}):null};const a_=(e,t)=>{const{enable:n=!0}=t||{},s=ix();F.useEffect(()=>{const a=e.current;if(!a||!n||!s)return;let o=!1,i=0,l=0,c=0,u=0;const d=!a.className.includes("select-none"),f=document.createElement("div");f.className="absolute top-0 left-0 z-20 cursor-grab",f.id="drag-scroll-mask",sd(f.style,{width:`${a.scrollWidth}px`,height:`${a.scrollHeight}px`}),a.appendChild(f);const h=()=>{qt.removeEventListener("mouseup",g),a.removeEventListener("mousemove",_),d&&a.classList.remove("select-none")},p=x=>{if(x.stopPropagation(),!(x.metaKey||x.ctrlKey||x.altKey)){h(),Ye({$isCtrlKeyDown:!1});return}o=!0,i=x.pageX-a.offsetLeft,l=x.pageY-a.offsetTop,c=a.scrollLeft,u=a.scrollTop,a.addEventListener("mousemove",_),qt.addEventListener("mouseup",g),f.classList.replace("cursor-grab","cursor-grabbing"),d&&a.classList.add("select-none")},g=()=>{f.classList.replace("cursor-grabbing","cursor-grab"),s||f.remove(),h(),o=!1,i=0,l=0,c=0,u=0},_=x=>{if(!o)return;const y=x.pageX-a.offsetLeft,b=x.pageY-a.offsetTop,E=y-i,w=b-l;sd(a,{scrollLeft:c-E,scrollTop:u-w})};return a.addEventListener("mousedown",p),()=>{h(),a.removeEventListener("mousedown",p),f.remove()}},[n,s,e])},s9=F.createContext(void 0),xa=()=>{const e=F.useContext(s9);if(!e)throw new Error("useBitable");return e},r9=()=>{const{timelineDates:e,zoomLevel:t}=xa(),n=t===ot.HOUR||t===ot.DAY,[s,a]=F.useState(0),o=F.useRef(),i=F.useCallback(()=>n?(new Date().setSeconds(0,0)-e[0])/Dc*Hs[t]:er(Date.now(),e[0],t,{abs:!1})*Hs[t],[n,t,e]);return F.useEffect(()=>{a(i());const l=()=>{o.current=setTimeout(l,yp),a(i())};return o.current=setTimeout(l,yp),()=>{o.current&&clearTimeout(o.current)}},[i]),s},cae=()=>{const{timelineDates:e,zoomLevel:t}=xa(),n=t===ot.HOUR||t===ot.DAY,s=r9();if(Date.now()>e[e.length-1]||Date.now()<e[0])return null;let a=s;mh(t)&&(a=er(Date.now(),e[0],t,{abs:!1,needDateStart:!0})*Hs[t]+Hs[t]/2);const o=()=>n?he(new Date).format("HH:mm"):t===ot.WEEK||t===ot.BIWEEK?`周${m0[gr(Date.now()).day]} ${gr(Date.now()).date}`:new Date().getDate();return r.jsxs(r.Fragment,{children:[r.jsx("span",{style:{left:a},className:B("px-1 absolute inline-flex justify-center items-center rounded-full -translate-x-1/2  z-10",n?"text-red":"text-white bg-red",t===ot.MONTH||t===ot.QUARTER||t===ot.YEAR?"w-6 h-6":"h-[25px]"),children:o()}),r.jsx("span",{style:{left:s},className:"w-2 h-2 rounded-full bg-red -bottom-2 absolute -translate-x-1/2 -translate-y-1/2"})]})},uae=()=>{const{timelineDates:e}=xa(),t=r9();return Date.now()>e[e.length-1]||Date.now()<e[0]?null:r.jsx("div",{style:{left:t,height:"calc(100% - 76px)"},className:"absolute w-px bg-red bottom-0 top-[76px]"})},dae=F.memo(()=>{const[e,t]=F.useState(Date.now()),n=F.useRef(),{containerWidth:s,timelineDates:a,datesContainer:o,zoomLevel:i}=xa(),l=Hs[i];F.useEffect(()=>{if(i===ot.DAY||i===ot.HOUR){const u=()=>{n.current=setTimeout(u,yp),t(Date.now())};n.current=setTimeout(u,yp)}return()=>{n.current&&clearTimeout(n.current)}},[i]);const c=u=>{let d=u;i!==ot.DAY&&i!==ot.HOUR&&(d=u+12*h0);let f=0,h="";return mh(i)?(i===ot.WEEK||i===ot.BIWEEK?h=`周${m0[gr(d).day]}  ${gr(d).date}`:h=gr(d).date,f=l):i===ot.YEAR?(h=`${gr(d).month}月`,f=l*Hse(d)):i===ot.QUARTER?(h=`${gr(d).date}`,f=l*7):i===ot.DAY?(h=Math.abs(e-d)<h0?"":he(new Date(d)).format("HH:00"),f=l*4):i===ot.HOUR&&(h=Math.abs(e-d)<Dc?"":he(new Date(d)).format("HH:mm"),f=l),r.jsx("div",{className:B("inline-flex h-full items-center",i!==ot.DAY&&i!==ot.HOUR&&i!==ot.QUARTER&&"justify-center"),style:{width:f},children:i===ot.DAY||i===ot.HOUR||i===ot.QUARTER?r.jsxs("span",{className:"-translate-x-1/2",children:[" ",h]}):h},d)};return r.jsxs("div",{ref:o,className:"text-t2-medium relative z-30 h-[38px] border-b bg-white1 py-1.5 font-medium text-grey4",style:{width:s},children:[a.map(u=>c(u)),r.jsx(cae,{})]})},Cn),fae=F.memo(F.forwardRef((e,t)=>{const{containerWidth:n,timelineDates:s,zoomLevel:a}=xa(),o=Hs[a],i=l=>{let c=!1,u="",d=0;return mh(a)?(c=new Date(l).getDate()===1,u=`${new Date(l).getMonth()+1}月`,d=er(l,s[0],a)*o):a===ot.YEAR?(c=new Date(l).setMonth(0,1)===l,u=`${new Date(l).getFullYear()}年`,d=er(l,s[0],a)*o):a===ot.QUARTER?(new Date(l).getMonth()!==new Date(l+6*En).getMonth()||new Date(l).getDay()===0)&&(c=!0,u=`${new Date(l+6*En).getMonth()+1}月`,d=(er(l,s[0],a)+(7-new Date(l+6*En).getDate()))*o):(a===ot.DAY||a===ot.HOUR)&&(c=xm(l)===l,u=`${new Date(l).getMonth()+1}月${new Date(l).getDate()}日`,d=er(l,s[0],a)*o),c?r.jsx("div",{style:{left:d},className:"absolute h-full inline-flex items-center justify-center flex-shrink-0",children:u},l):null};return r.jsx("div",{ref:t,className:"timeline-month relative z-30 h-[38px] bg-white1 text-t2-medium border-t transition-none",style:{width:n},children:s.map(i)})}),Cn),mae=F.memo(()=>{const{containerWidth:e,timelineDates:t,zoomLevel:n}=xa(),s=Hs[n];return r.jsxs("div",{className:"absolute top-0 h-full",style:{width:e},children:[t.map(a=>{const o=er(a,t[0],n)*s;return n===ot.HOUR||n===ot.DAY||n===ot.QUARTER||n===ot.YEAR?r.jsx("div",{style:{left:o},className:"absolute h-full bg-grey6 w-[1px]"},a):n===ot.WEEK?r.jsx("div",{style:{left:o,width:s},className:B("absolute h-full border-l border-grey6",(gr(a).day===6||gr(a).day===0)&&"bg-grey8 dark:bg-grey8/5")},a):gr(a).day===6?r.jsx("div",{style:{left:o,width:s*2},className:"absolute h-full bg-grey8 dark:bg-white3 flex-shrink-0 flex flex-col items-center justify-center"},a):null}),r.jsx(uae,{})]})},Cn),hae=F.memo(F.forwardRef((e,t)=>{var k;const{container:n,setTimelineDates:s,scrollLeft:a,stepLength:o,timelineDates:i,zoomLevel:l}=xa(),{viewId:c,managerReadonly:u,isLocked:d,embed:f}=Te(),h=Wm(c),p=Cr(),g=me(),[_,x]=F.useState(),y=Hs[l];F.useEffect(()=>{const C=n.current;if(!C)return;const T=()=>{const I=Math.floor(C.scrollLeft/Hs[l]),j=i[0]+I*ed(l);j&&x(D=>{let S=0;return mh(l)||l===ot.QUARTER?S=new Date(j).setDate(2):l===ot.YEAR?S=new Date(j).setMonth(0,2):(l===ot.DAY||l===ot.HOUR)&&(S=xm(j)+12*sx),S!==D?S:D})};T();const v=fs(T,60);return C.addEventListener("scroll",v),()=>C.removeEventListener("scroll",v)},[y,n,l,i]);const b=C=>{if(d||u)return;const T=Yv.map(v=>({type:$.OPERABLE_BLOCK_TEXT,data:{title:v.name,...v,selected:v.level===l}}));g.dropdown({popcorn:C.currentTarget,placement:"bottom",content:({onCloseModal:v})=>r.jsx(ze,{className:"next-modal w-[100px] py-2",items:T,onItemClick:({data:I})=>{if(!n.current)return;o.current=VA[I.level];const j=jp({zoomLevel:I.level,length:o.current});s(j),a.current=er(Date.now(),j[0],I.level)*Hs[I.level]-n.current.clientWidth/2,yt(c,{timelinePreference:{zoomLevel:I.level}}),v()}})})},E=()=>{if(!n.current)return;const C=jp({zoomLevel:l,length:o.current});s(C),a.current=er(Date.now(),C[0],l)*Hs[l]-n.current.clientWidth/2},w=C=>{n.current&&(C===zu.left?n.current.scrollLeft-=n.current.clientWidth/2:n.current.scrollLeft+=n.current.clientWidth/2)};return r.jsx("div",{className:"absolute top-0.5 left-0 z-40 flex h-[36px] w-full items-center whitespace-nowrap",ref:t,children:_&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex h-full",children:[r.jsxs("div",{className:B("flex items-center bg-white1",h?"pl-2":"pl-4"),children:[!h&&!u&&!d&&r.jsx(Fe,{popup:"显示表格",onClick:()=>yt(c,{timelineShowTable:!0}),children:r.jsx(H,{name:"IcUnfold",size:"middle",className:"animate-hover mr-4 text-grey3"})}),r.jsxs("span",{className:"text-t2-medium inline-flex h-full items-center bg-white1",children:[gr(_).year,"年",l!==ot.YEAR&&r.jsxs(r.Fragment,{children:[gr(_).month,"月"]}),(l===ot.DAY||l===ot.HOUR)&&r.jsxs(r.Fragment,{children:[gr(_).date,"日"]})]})]}),r.jsx("span",{className:"h-full w-6",style:{backgroundImage:"linear-gradient(to right, var(--white1) 20%, transparent 100%)"}})]}),r.jsxs("div",{className:"ml-auto flex h-full items-center",children:[r.jsx("span",{className:"h-full w-6",style:{backgroundImage:"linear-gradient(to left, var(--white1) 20%, transparent 100%)"}}),r.jsxs("div",{className:B("flex h-full items-center bg-white1",!f&&!p&&"pr-24"),children:[r.jsxs("button",{onClick:b,className:"text-t2 flex h-full items-center px-3 text-grey3",children:[(k=Yv.find(C=>C.level===l))==null?void 0:k.name,!u&&r.jsx(H,{size:"xxxsmall",name:"IcArrow",className:"ml-1"})]}),r.jsx(Fe,{className:"animate-hover rounded-sm",children:r.jsx(H,{name:"IcArrowDateBack",size:"middle",onClick:()=>w(zu.left)})}),r.jsx("span",{className:"text-t2-medium mx-1.5 cursor-pointer",onClick:E,children:"今天"}),r.jsx(Fe,{className:"animate-hover rounded-sm",children:r.jsx(H,{name:"IcArrowDateNext",size:"middle",onClick:()=>w(zu.right)})})]})]})]})})}),Cn),a9=({startTime:e,unitLength:t})=>{const{timelineDates:n,zoomLevel:s}=xa(),a=e+t*ed(s),o=Hs[s],i=er(e,n[0],s,{needDateStart:!0,abs:!1})*Hs[s],l=s===ot.DAY||s===ot.HOUR?t*o:(t+1)*o,c=()=>{if((s===ot.YEAR||s===ot.QUARTER)&&e&&a){const u=he(e).format("YYYY-MM"),d=he(a).format("YYYY-MM");return u===d&&l<90?`${he(e).format("MM/DD")} - ${he(a).format("DD")}`:r.jsxs(r.Fragment,{children:[r.jsx("span",{children:he(e).format("MM/DD")}),r.jsx("span",{children:he(a).format("MM/DD")})]})}else if(mh(s)){const u=o;let d=gr(e).date,f=gr(a).date;return(s===ot.WEEK||s===ot.BIWEEK)&&(d=`周${m0[gr(e).day]}  ${gr(e).date}`,f=`周${m0[gr(a).day]}  ${gr(a).date}`),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"inline-flex h-full items-center justify-center text-black",style:{width:u},children:d}),f!==d&&r.jsx("div",{className:"inline-flex h-full items-center justify-center text-black",style:{width:u},children:f})]})}};return r.jsx("div",{className:B("absolute top-1.5 flex h-6 justify-between rounded-xl",s===ot.YEAR||s===ot.QUARTER?"bg-grey9 px-1 text-black ":"bg-black_003"),style:{left:i,minWidth:l},children:c()})},pae=e=>{const t=e.getBoundingClientRect(),n=document.createElement("div");n.style.position="fixed",n.style.width=`${t.width}px`,n.style.height=`${t.height}px`,n.style.top=`${t.top}px`,n.style.left=`${t.left}px`,n.style.opacity="0.5",n.style.zIndex="100";const s=e.cloneNode(!0);return n.appendChild(s),document.body.appendChild(n),n},gae=(e,t,n)=>{let s;const a=e.querySelectorAll(".record-line-container [data-record-id]");let o=0;const i=t.getBoundingClientRect();let l;a.forEach(u=>{var h;if(u.dataset.recordId===Qu)return;const d=u.getBoundingClientRect();(h=u.lastElementChild)!=null&&h.classList.contains("indicator")&&u.lastElementChild.remove();const f=hL(i,d);f>o&&(o=f,i.top<d.top?l="top":l="bottom",s=u)});const c=document.createElement("div");return c.classList.add("indicator"),c.style.position="absolute",c.style.zIndex="100",c.style.width="100%",c.style.height="4px",c.style.backgroundColor="rgba(0, 0, 0, 0.3)",l==="top"?c.style.top="-2px":c.style.bottom="-2px",s&&s.dataset.recordId!==n&&s.appendChild(c),{target:s,position:l}};let LN;const o9=e=>{const{zoomLevel:t}=xa(),{viewId:n,collectionId:s}=Te(),a=t===ot.DAY||t===ot.HOUR;return ae(({collectionViews:o,blocks:i})=>{var w,k,C,T,v,I;const l=o[n];if(!l)return;const c=(w=l.format.timelineBy)!=null?w:"",u=(k=l.format.timelineByEnd)!=null?k:"",d=i[s],f=i[e];if(!d||!f)return;const h=(C=d.data.schema)==null?void 0:C[c],p=(T=d.data.schema)==null?void 0:T[u];if(!h||!p)return;let g,_,x=m.TextType.DATE,y=m.TextType.DATE;if(h.type===m.CollectionSchemaType.CREATED_AT||h.type===m.CollectionSchemaType.UPDATED_AT)x=m.TextType.DATETIME,g=h.type===m.CollectionSchemaType.CREATED_AT?f.createdAt:f.updatedAt;else if(h.type===m.CollectionSchemaType.DATE){const j=Gr(f,c);x=(v=j==null?void 0:j.textType)!=null?v:m.TextType.DATE,g=j==null?void 0:j.timestamp}if(p.type===m.CollectionSchemaType.CREATED_AT||p.type===m.CollectionSchemaType.UPDATED_AT)y=m.TextType.DATETIME,_=p.type===m.CollectionSchemaType.CREATED_AT?f.createdAt:f.updatedAt;else if(p.type===m.CollectionSchemaType.DATE){const j=Gr(f,u);y=(I=j==null?void 0:j.textType)!=null?I:m.TextType.DATE,_=j==null?void 0:j.timestamp}if(!g&&!_)return;let b=g||_,E=_;if(g&&_&&(E=_>=g?_:g),_||(E=g),!(!b||!E)&&(a&&(x===m.TextType.DATE&&(b=ns(b)),y===m.TextType.DATE&&(E=ns(E)+En)),!(!b||!E)))return{timelineBy:c,timelineByEnd:u,renderStartTime:b,renderEndTime:E}})},_ae=({recordId:e,card:t})=>{var Y;const{container:n,datesContainer:s,timelineDatesRef:a,draggingRecordId:o,zoomLevel:i,containerWidth:l}=xa(),c=Ve(e,!1),{viewId:u,managerReadonly:d}=Te(),f=ke(),h=Cs(),p=sh(e),[g,_]=F.useState(),[x,y]=F.useState(),[b,E]=F.useState(),{illegal:w}=it(e),k=zs(),C=F.useRef(null),T=F.useRef({x:0,y:0}),v=o9(e),I=zC(u,e),j=Tm();if(!v)return null;let{renderStartTime:D,renderEndTime:S}=v;const{timelineBy:R,timelineByEnd:A}=v,L=!!((Y=p==null?void 0:p.data.icon)!=null&&Y.type),P=Hs[i],M=i===ot.DAY||i===ot.HOUR,U=e===(j==null?void 0:j.id)&&u===j.viewId&&j.from===Kg.TIMELINE,V=X=>{if(X.preventDefault(),c||d)return;const oe=s.current,ie=n.current,ue=t.current,ge=C.current,Ne=X.currentTarget.closest(".next-space-page");if(!Ne||!ue||!ie||!ge||!oe)return;T.current={x:X.clientX,y:X.clientY};let De={x:X.clientX,y:X.clientY};const Se=ue.getBoundingClientRect(),Ie=Se.width,Ke=X.clientX-Se.left;let dt,$e=!1,ut,Ee,Ge;const Je=Ze=>{if(De={x:Ze.clientX,y:Ze.clientY},!$e){if(Math.abs(Ze.clientX-T.current.x)<5&&Math.abs(Ze.clientY-T.current.y)<5)return;$e=!0,o.current=e,ut=pae(ge)}DN(Ze.clientX,ie),sE({y:Ze.clientY,container:Ne}),tt(Ze.clientX,Ze.clientY)},et=()=>{var It;if(Ne.removeEventListener("scroll",$t),ie.removeEventListener("scroll",$t),document.removeEventListener("mousemove",Je),document.removeEventListener("mouseup",et),cancelAnimationFrame(Af),cancelAnimationFrame(Vu),ut==null||ut.remove(),y(void 0),o.current=void 0,Ee&&((It=Ee.lastElementChild)!=null&&It.classList.contains("indicator"))&&Ee.lastElementChild.remove(),!$e||!p)return;const Ze=Ee==null?void 0:Ee.dataset.recordId,jt=Ze&&Ze!==e;f(()=>{var _n,rr,Ks,Le,fe,st,St;const{timelineBy:nn,timelineByEnd:N}=(_n=Zt(u))!=null?_n:{};if(!nn||!N)return;const O=dt+ed(i)*(M?Ie/P:Ie/P-1),{blocks:G,collectionViews:J}=le(),se=G[p.parentId],xe=J[u];if(!se||!xe)return;const Be=(rr=se.data.schema)==null?void 0:rr[nn],Re=(Ks=se.data.schema)==null?void 0:Ks[N];let vt={};if((Be==null?void 0:Be.type)===m.CollectionSchemaType.DATE){const Pt=(Le=Gr(p,nn))==null?void 0:Le.textType;vt[nn]=[Fn({from:yi(D,dt,i),includeTime:mf(i,Pt)})]}if((Re==null?void 0:Re.type)===m.CollectionSchemaType.DATE){const Pt=(fe=Gr(p,N))==null?void 0:fe.textType;vt[N]=[Fn({from:yi(S,O,i),includeTime:mf(i,Pt)})]}if(jt){const Pt=(st=ge.parentElement)==null?void 0:st.dataset.groupValue,en=Ee==null?void 0:Ee.dataset.groupValue;if(Pt!==en){const dn=th({viewId:u,groupValue:Ee==null?void 0:Ee.dataset.groupValue});vt={...vt,...dn}}}if(pe(e,{data:{segments:(St=vt.title)!=null?St:p.data.segments,collectionProperties:{...p.data.collectionProperties,...vt}}}),jt){const{newPageSort:Pt}=Vg(xe.pageSort,se.subNodes),en=Pt.indexOf(e);let dn=Pt.indexOf(Ze);dn=Ge==="top"?en<dn?dn-1:dn:en<dn?dn:dn+1,en!==dn&&Kn(u,{pageSort:qc(Pt,en,dn)})}})},$t=()=>tt(De.x,De.y),tt=(Ze,jt)=>{if(!ut)return;ut.style.transform=`translate(${Ze-T.current.x}px, ${jt-T.current.y}px)`;const It=ie.getBoundingClientRect(),nn=ie.scrollLeft+Ze-It.x-Ke,N=Math.round(nn/P);dt=a.current[0]+N*ed(i),y(dt);const O=gae(ie,ut,e);Ee=O.target,Ge=O.position};Ne.addEventListener("scroll",$t),ie.addEventListener("scroll",$t),document.addEventListener("mousemove",Je),document.addEventListener("mouseup",et)},W=(X,oe)=>{if(c)return;X.preventDefault(),X.stopPropagation();const ie=s.current,ue=n.current;if(!ue||!ie)return;E(oe);const ge=oe===bp.left;let Ne,De=X.clientX;const Se=$e=>{De=$e.clientX,DN($e.clientX,ue),o.current=e,dt($e.clientX)},Ie=()=>{ue.removeEventListener("scroll",Ke),document.removeEventListener("mousemove",Se),document.removeEventListener("mouseup",Ie),cancelAnimationFrame(Af),E(void 0),_(void 0),o.current=void 0,!(!p||!le().blocks[p.parentId])&&f(()=>{var $t,tt,Ze,jt;if(!Ne)return;const{blocks:ut}=le(),Ee=ut[p.parentId];if(!Ee)return;const Ge=($t=Ee.data.schema)==null?void 0:$t[R],Je=(tt=Ee.data.schema)==null?void 0:tt[A],et={};if((Ge==null?void 0:Ge.type)===m.CollectionSchemaType.DATE){const It=(Ze=Gr(p,R))==null?void 0:Ze.textType;et[R]=ge?[Fn({from:yi(D,Ne,i),includeTime:mf(i,It)})]:[Fn({from:new Date(D),includeTime:mf(i,It)})]}if((Je==null?void 0:Je.type)===m.CollectionSchemaType.DATE){const It=(jt=Gr(p,A))==null?void 0:jt.textType;et[A]=ge?[Fn({from:S>D?new Date(S):yi(S,D,i),includeTime:mf(i,It)})]:[Fn({from:yi(S,Ne,i),includeTime:mf(i,It)})]}pe(e,{data:{collectionProperties:{...p.data.collectionProperties,...et}}})})},Ke=()=>dt(De),dt=$e=>{const ut=ue.getBoundingClientRect(),Ee=ue.scrollLeft+$e-ut.x,Ge=ge||M?Math.round(Ee/P):Math.round(Ee/P)-1,Je=a.current[0]+Ge*ed(i);Je&&(ge&&Je<=Math.max(D,S)||!ge&&Je>=(zse(i)?Dp(D):ns(D)))&&(Ne=Je,_(Je))};ue.addEventListener("scroll",Ke),document.addEventListener("mousemove",Se),document.addEventListener("mouseup",Ie)};g&&(b===bp.left?D=g:S=g);const z=er(D,a.current[0],i,{needDateStart:!0,abs:!1})*P,Q=er(S,D,i,{needDateStart:!0,abs:!0}),Z=M?Math.max(Q*P,10):(Q+1)*P,te=fa((z+Z)/l),re=`linear-gradient(90deg, rgb(0, 0, 0) ${te}, rgba(0, 0, 0, 0.4) ${te})`,ne=r.jsxs("div",{className:"absolute left-0 flex h-full w-full items-center overflow-hidden",ref:C,children:[r.jsxs("div",{ref:t,onMouseDown:V,"data-block-id":e,"data-view-id":u,"data-hide-hover-menu":!0,className:"absolute flex h-[34px] cursor-pointer items-center whitespace-nowrap",style:{left:z,width:Z,boxShadow:"0px 1px 3px var(--black_006-base)"},children:[r.jsx("div",{className:"h-full w-full",onClick:X=>h(e,{illegal:w,forceOpenInRight:X.altKey,forceOpenNewTab:X.ctrlKey||X.metaKey})}),A!==R&&!c&&r.jsx(r.Fragment,{children:qA.map(X=>r.jsxs("div",{className:B("group absolute z-10 h-full w-[9px] rounded-full px-[3px] py-1.5 hover:cursor-col-resize",b&&b!==X&&"pointer-events-none",X==="left"?"-left-[5px]":"-right-[5px]"),onMouseDown:oe=>W(oe,X),children:[r.jsx("span",{className:B("inline-block h-full w-[3px] rounded-full group-hover:bg-black",b===X&&"bg-black")}),b===X&&g&&r.jsx("div",{className:B("text-t4 absolute top-1.5 flex items-center rounded bg-white1 px-1 text-black",X==="left"?"right-3":"left-3"),children:M?he(Dp(g)).format("MM/DD HH:mm"):he(g).format("MM/DD")})]},X))}),r.jsx("div",{className:"absolute pointer-events-none right-0 top-0 rounded h-full z-10 w-full bg-white3",children:r.jsx("span",{style:{backgroundColor:I},className:"absolute w-full h-full rounded border border-black/10"})})]}),r.jsx("div",{className:"pointer-events-none absolute left-0 flex h-full w-full items-center z-10",style:{WebkitMaskImage:re},children:r.jsxs("div",{className:"absolute flex h-[34px] cursor-pointer items-center px-2",style:{left:z,minWidth:Z},children:[w&&r.jsxs(r.Fragment,{children:[r.jsx(tn,{className:"text-t2-medium mr-1 inline p-0 align-middle opacity-30",blockId:e,trigger:!1,iconSize:16,defaultIcon:r.jsx(H,{name:"MIcPage",size:"small"})}),r.jsx("span",{className:"border-grey6 border-b opacity-30",children:rs})]}),!w&&r.jsxs(r.Fragment,{children:[L&&!U&&r.jsx(tn,{className:"mr-1.5 inline-flex p-0 align-middle",blockId:e,trigger:!1,iconSize:20}),U?r.jsx(co,{uuid:e,className:"text-t2-medium inline whitespace-nowrap",plugins:kr,placeholder:aa,segments:p==null?void 0:p.data.segments,autoFocus:!0,autoFocusCaretToEnd:!0,onChange:X=>k(e,"title",X),onFocus:()=>clearTimeout(LN),onBlur:()=>{LN=setTimeout(()=>{Ye({$newCreatedRecord:void 0})},1e3)},onKeyDown:X=>{(be("enter")(X)||be("esc")(X))&&X.currentTarget.blur()}}):r.jsx(Pn,{className:"text-t2-medium inline whitespace-nowrap",segments:p==null?void 0:p.data.segments,placeholder:aa,interactable:!1,plugins:kr}),!U&&r.jsx(n_,{recordId:e})]})]})}),s.current&&(g||x)&&Is.createPortal(r.jsx(a9,{startTime:x!=null?x:D,unitLength:Q}),s.current)]});return r.jsx(r.Fragment,{children:ne})},xae=F.memo(({recordId:e,card:t})=>{const{setTimelineDates:n,container:s,scrollLeft:a,stepLength:o,timelineDates:i,zoomLevel:l}=xa(),[c,u]=F.useState(!1),[d,f]=F.useState(!1),h=o9(e),p=Ba(s.current).width,{renderStartTime:g,renderEndTime:_}=h!=null?h:{},x=F.useCallback(()=>{if(!s.current||!t.current)return;const b=t.current.getBoundingClientRect(),E=s.current.getBoundingClientRect();b.left<E.left!==c&&u(b.left<E.left),b.right>E.right!==d&&f(b.right>E.right)},[t,s,c,d]);F.useEffect(()=>{if(!s.current)return;const b=s.current;return b.addEventListener("scroll",x),()=>b.addEventListener("scroll",x)},[s,x]),F.useEffect(()=>{x()},[x,g,_,i,p]);const y=b=>{if(!s.current||!g||!_)return;const E=100,w=b===bp.left,k=jp({zoomLevel:l,base:w?g:_,length:o.current});w?a.current=er(g,k[0],l)*Hs[l]-E:a.current=er(_,k[0],l)*Hs[l]-(s.current.clientWidth-E),n(k),w?u(!1):f(!1)};return!g||!_?null:r.jsx(r.Fragment,{children:qA.map(b=>{if(!s.current)return null;const E=b===bp.right,w=E?d:c;return r.jsxs("button",{onClick:()=>y(b),className:B("sticky h-full px-2 flex items-center pointer-events-auto group z-[20] duration-150"),style:{left:E?s.current.clientWidth-32:0,opacity:w?1:0,transform:w?"scale(1)":"scale(0)"},children:[r.jsx(H,{name:"IcDateBack",size:"small",className:B("text-white1 bg-black/30 rounded",E&&"rotate-180")}),r.jsxs("span",{className:B("absolute px-1 flex items-center text-black bg-white1 rounded text-t4 opacity-0 group-hover:opacity-100 pointer-events-none",E?"right-[30px]":"left-[30px]"),children:[he(g).format(Ct),r.jsx(H,{name:"IcDateEnd",size:"xxsmall",className:"mx-0.5"}),he(Math.max(g,_)).format(Ct)]})]},b)})})},kn),Fae=({initDateRangeLength:e,movingStartDate:t,recordId:n})=>{const{timelineDates:s,zoomLevel:a}=xa(),{viewId:o}=Te(),i=Wm(o),l=ae(({blocks:u})=>{var d;return(d=u[n])==null?void 0:d.data.segments}),c=Hs[a]*e;return n===Qu?i&&!t?null:r.jsxs("div",{className:B("h-[34px] top-0.5 rounded flex items-center whitespace-nowrap pr-2 pl-1",t?"absolute bg-black_006 pointer-events-none":"sticky left-24 text-grey3"),style:{width:c,left:t?er(t,s[0],a)*Hs[a]:void 0},children:[r.jsx(H,{name:"IcAddBoard",size:"middle",className:"mr-1.5"}),r.jsx("span",{className:"text-t2",children:"创建页面"})]}):t?r.jsx("div",{className:"absolute h-[34px] top-0.5 bg-black_006 rounded pointer-events-none px-1.5 flex items-center whitespace-nowrap",style:{width:c,left:er(t,s[0],a)*Hs[a]},children:r.jsx(Pn,{className:"inline text-t2-medium",plugins:kr,segments:l,placeholderColor:"var(--black)",placeholder:aa,interactable:!1})}):null},j0=F.memo(e=>{const{recordId:t,groupName:n,lastRecordId:s}=e,{viewId:a}=Te(),o=ke(),i=Ve(t,!1),{container:l,datesContainer:c,draggingRecordId:u,zoomLevel:d,timelineDatesRef:f}=xa(),h=F.useRef(null),p=_e(t,["data"],["collectionProperties"]),{illegal:g}=it(t),_=Gi(),[x,y]=F.useState(),{timelineBy:b,timelineByEnd:E,recordStartTime:w,recordEndTime:k}=ae(({collectionViews:S,blocks:R})=>{var U,V;const A=R[t],L=S[a],P=(U=L==null?void 0:L.format.timelineBy)!=null?U:"",M=(V=L==null?void 0:L.format.timelineByEnd)!=null?V:"";return{timelineBy:P,timelineByEnd:M,recordStartTime:Cl(A,P),recordEndTime:Cl(A,M)}},{equalityFn:Cn});OL(a,t);const C=b===E?1:OJ[d],T=S=>{if(w||k||g||t!==Qu&&i||u.current)return;const R=c.current;if(!l.current||!R)return;const A=l.current.getBoundingClientRect(),L=l.current.scrollLeft+S.clientX-A.x,P=Math.floor(L/Hs[d]);y(f.current[0]+P*ed(d))},v=()=>{y(void 0)},I=()=>{if(!g&&!(t!==Qu&&i)&&x){const S=x,R=S+(D?C:C-1)*ed(d),A={[b]:[Fn({from:new Date(S),includeTime:D})],[E]:[Fn({from:new Date(R),includeTime:D})]};t===Qu?_({viewId:a,where:{after:s},propertyValues:{...th({viewId:a,groupValue:n,isNewRecord:!0}),...A},from:Kg.TIMELINE}):p&&o(()=>{var L;pe(t,{data:{collectionProperties:{...(L=p.data.collectionProperties)!=null?L:{},...A}}})}),y(void 0)}},j=w||k,D=d===ot.DAY||d===ot.HOUR;return r.jsxs("div",{"data-disable-select":!0,"data-record-id":t,"data-group-value":n,onMouseMove:T,onMouseLeave:v,onClick:I,className:B("relative flex h-[37px] w-full hover:bg-green-100",!j&&"cursor-pointer"),children:[r.jsx(Fae,{recordId:t,initDateRangeLength:C,movingStartDate:x}),c.current&&x&&Is.createPortal(r.jsx(a9,{startTime:x,unitLength:D?C:C-1}),c.current),j&&r.jsxs(r.Fragment,{children:[r.jsx(xae,{recordId:t,card:h}),r.jsx(_ae,{recordId:t,card:h})]})]})},Cn),yae=({recordIds:e})=>{const{viewId:t}=Te(),n=DK(t),s=F.useRef(VA[n]),a=jp({zoomLevel:n,length:s.current}),[o,i]=F.useState(a),l=F.useRef(null),c=F.useRef(null),u=F.useRef(),d=F.useRef(o),f=F.useRef();d.current=o;const h=F.useMemo(()=>({containerWidth:$se(n,o),zoomLevel:n,timelineDatesRef:d,stepLength:s,timelineDates:o,setTimelineDates:i,container:l,scrollLeft:u,datesContainer:c,draggingRecordId:f}),[n,o]);return r.jsx(s9.Provider,{value:h,children:r.jsx(bae,{recordIds:e})})},bae=F.memo(({recordIds:e})=>{var S,R;const{embed:t,readonly:n,viewId:s}=Te(),{timelineDates:a,setTimelineDates:o,container:i,datesContainer:l,scrollLeft:c,stepLength:u,zoomLevel:d,timelineDatesRef:f}=xa(),h=F.useRef(null),p=F.useRef(null),g=Cr(),_=Wm(s),{withoutValidGroup:x,visibleGroups:y=[],hiddenGroups:b=[]}=(S=fu(s))!=null?S:{},E=F.useRef(null),[w,k=[]]=Ha(s,{visible:!0}),C=Hs[d];a_(i),F.useLayoutEffect(()=>{i.current&&(i.current.scrollLeft=er(Date.now(),a[0],d)*C-i.current.clientWidth/2)},[]),F.useLayoutEffect(()=>{!i.current||!c.current||(i.current.scrollLeft=c.current,c.current=void 0)},[a,i,c]),F.useEffect(()=>{if(i.current&&i.current.scrollWidth<i.current.clientWidth*2){u.current=Math.ceil(u.current*1.5);const A=jp({zoomLevel:d,length:u.current});o(A),c.current=er(Date.now(),A[0],d)*C-i.current.clientWidth/2}},[(R=i.current)==null?void 0:R.clientWidth,C]),F.useEffect(()=>{if(!i.current||!l.current)return;const A=i.current,L=()=>{if(!(typeof c.current<"u"||!i.current)){if(A.scrollWidth-A.scrollLeft-A.clientWidth<Kv){const M=f.current,U=er(M[u.current],M[0],d)*C;c.current=i.current.scrollLeft-U,o(V=>{const W=pn(V),z=N0({zoomLevel:d,base:W,length:u.current,dir:Cd.NEXT});return[...V.slice(u.current),...z]})}if(A.scrollLeft<Kv){const M=f.current,U=er(M[M.length-1],M[u.current-1],d)*C;c.current=i.current.scrollLeft+U,o(V=>{const W=V[0];return[...N0({zoomLevel:d,base:W,length:u.current,dir:Cd.PREV}),...V.slice(0,V.length-u.current)]})}}},P=yH?$n(L):fs(L,60);return A.addEventListener("scroll",P),()=>A.removeEventListener("scroll",P)},[i,c,u,l,o,f,d,C]),F.useEffect(()=>{const A=i.current,L=l.current,P=h.current,M=p.current,U=L==null?void 0:L.closest(".next-space-page");if(!A||!L||!P||!M||!U)return;const V=t?hC:cc,W=()=>{const z=A.getBoundingClientRect(),Q=U.getBoundingClientRect();if(z.top<Q.top){let Z=Math.abs(Q.top-z.top);z.bottom<Q.top+111&&(Z-=Q.top+111-z.bottom),P.style.transform=`translate3d(0,${Math.round(Z+V)}px,0)`,M.style.transform=`translate3d(0,${Math.round(Z+V)}px,0)`,L.style.transform=`translate3d(0,${Math.round(Z+V)}px,0)`}else P.style.transform="none",M.style.transform="none",L.style.transform="none"};return U.addEventListener("scroll",W),window.addEventListener("resize",W),()=>{U.removeEventListener("scroll",W),window.removeEventListener("resize",W)}},[i,l,t]);const T=sr(),[v,I]=F.useState(T==null?void 0:T.current);F.useEffect(()=>{I(T==null?void 0:T.current)},[T]);const j=tj(k.map(A=>A!=null&&A.width?Math.max(lc,A.width):Eo)),D=()=>x?r.jsxs("div",{className:"relative border-r",children:[r.jsx(vp,{isGroup:!1,properties:k}),r.jsx(e3,{recordIds:e,embed:t,properties:k}),r.jsx(t3,{recordIds:e}),!n&&!t&&r.jsx(To,{type:"collection"}),!t&&r.jsx(Fm,{readonly:n})]}):r.jsx(u0.Provider,{value:E,children:r.jsxs("div",{className:"relative border-r",children:[v&&r.jsxs(r.Fragment,{children:[y.length>100?r.jsx(As,{style:{width:j},customScrollParent:v,overscan:300,totalCount:y.length,itemContent:A=>{const L=y[A];return L?r.jsx(nc,{tableGroup:L,withoutValidGroup:x,embed:t,properties:k,index:A},L.value):null}}):r.jsx(r.Fragment,{children:y.map((A,L)=>r.jsx(nc,{tableGroup:A,withoutValidGroup:x,embed:t,properties:k,index:L},A.value))}),r.jsx(fh,{hiddenGroupsLength:b.length,isTimelineTable:!0,hiddenGroups:b.length>100?r.jsx(As,{style:{width:j},customScrollParent:v,overscan:300,totalCount:b.length,itemContent:A=>{const L=b[A];return L?r.jsx(nc,{tableGroup:L,withoutValidGroup:x,embed:t,properties:k},L.value):null}}):r.jsx(r.Fragment,{children:b.map(A=>r.jsx(nc,{tableGroup:A,withoutValidGroup:x,embed:t,properties:k},A.value))})})]}),r.jsx(Lc,{}),!n&&!t&&r.jsx(To,{type:"collection"}),!t&&r.jsx(Fm,{readonly:n})]})});return r.jsxs("div",{ref:E,className:B("flex",!t&&(g?"-mx-10 sm:-mx-10":"-mr-24"),!t&&!_&&"-ml-24"),children:[!g&&_&&D(),r.jsxs("div",{className:"relative flex-1 overflow-hidden",children:[r.jsx(hae,{ref:h}),r.jsxs("div",{ref:i,className:"relative h-full w-full overflow-auto pb-[40px]",children:[r.jsx(fae,{ref:p}),r.jsx(dae,{}),r.jsx(mae,{}),r.jsx(Eae,{recordIds:e})]})]})]})}),Eae=({recordIds:e})=>{var f;const{viewId:t,readonly:n,managerReadonly:s}=Te(),a=F.useRef(null),o=Wm(t),{containerWidth:i}=xa(),{withoutValidGroup:l,visibleGroups:c=[],hiddenGroups:u=[]}=(f=fu(t))!=null?f:{};ey();const d=sr();return d.current?r.jsxs("div",{ref:a,className:B("record-line-container relative",o&&!l&&"-translate-y-[75px]"),style:{width:i},children:[l&&r.jsxs(r.Fragment,{children:[r.jsx(As,{customScrollParent:d.current,overscan:300,fixedItemHeight:37,totalCount:e.length,itemContent:h=>{const p=e[h];return p?r.jsx(j0,{recordId:p},p):null}}),o&&e.length===0&&r.jsx("div",{className:"h-[37px]"}),n||s?null:r.jsx(j0,{recordId:Qu,lastRecordId:e[e.length-1]})]}),!l&&r.jsxs(r.Fragment,{children:[c.length>100?r.jsx(As,{customScrollParent:d.current,overscan:300,totalCount:c.length,itemContent:h=>{const p=c[h];return p?r.jsx(O_,{tableGroup:p},p.value):null}}):r.jsx(r.Fragment,{children:c.map(h=>r.jsx(O_,{tableGroup:h},h.value))}),r.jsx(fh,{hiddenGroupsLength:u.length,hiddenGroups:u.length>100?r.jsx(As,{customScrollParent:d.current,overscan:300,totalCount:u.length,itemContent:h=>{const p=u[h];return p?r.jsx(O_,{tableGroup:p},p.value):null}}):r.jsx(r.Fragment,{children:u.map(h=>r.jsx(O_,{tableGroup:h},h.value))})}),!o&&r.jsx(Lc,{})]})]}):null},O_=F.memo(({tableGroup:e,className:t})=>{const{viewId:n,readonly:s,managerReadonly:a}=Te(),{recordIds:o,value:i}=e,l=Wm(n),c=Nm(n,i),u=sr();return u.current?l&&!c?r.jsx("div",{className:"h-[57px]"}):r.jsxs("div",{className:B(t,l?"pt-[75px] pb-[57px]":"pb-5"),children:[!l&&r.jsx(s_,{tableGroup:e}),c&&r.jsxs(r.Fragment,{children:[r.jsx(As,{customScrollParent:u.current,overscan:300,fixedItemHeight:37,totalCount:o.length,itemContent:d=>{const f=o[d];return f?r.jsx(j0,{recordId:f},f):null}}),l&&o.length===0&&r.jsx("div",{className:"h-[37px]"}),s||a?null:r.jsx(j0,{recordId:Qu,lastRecordId:o[o.length-1],groupName:i})]})]}):null},kn),wae=()=>{const{viewId:e,collectionId:t,readonly:n,managerReadonly:s}=Te(),a=OC(),o=Gg(e),i=ae(({blocks:l,collectionViews:c})=>{var y,b,E;const u=l[t],d=c[e],f=(y=u==null?void 0:u.data.schema)!=null?y:{};if(!d)return;const{timelineBy:h="",timelineByEnd:p=""}=d.format,g={updateTimelineBy:!1,updateTimelineByEnd:!1},_=(b=f[h])==null?void 0:b.type,x=(E=f[p])==null?void 0:E.type;return _!==m.CollectionSchemaType.DATE&&_!==m.CollectionSchemaType.CREATED_AT&&_!==m.CollectionSchemaType.UPDATED_AT&&(g.updateTimelineBy=!0),x!==m.CollectionSchemaType.DATE&&x!==m.CollectionSchemaType.CREATED_AT&&x!==m.CollectionSchemaType.UPDATED_AT&&(g.updateTimelineByEnd=!0),g});return F.useEffect(()=>{n||s||i&&(i.updateTimelineBy||i.updateTimelineByEnd)&&a(e)},[a,s,i,n,e]),F.useEffect(()=>{o&&o.needUpdateGroups&&yt(e,{collectionGroups:o.newViewGroups})},[o,e]),!i||o!=null&&o.needUpdateGroups?null:i.updateTimelineBy||i.updateTimelineByEnd?n||s?r.jsx("div",{className:"text-t2 h-[35px] flex items-center pl-2",children:"当前视图无有效日期属性，无法展示"}):null:o!=null&&o.sortedRecordIds?r.jsx(yae,{recordIds:o.sortedRecordIds}):null},ty=e=>{const t=gt(),n=xC(),s=I6(),a=_e(t,[]),o=zg(t),i=ak(a==null?void 0:a.spaceId),l=ui(a==null?void 0:a.spaceId),c=hw(),u=Vn(),{illegal:d}=it(t),f=Yd(t),h=s||(o==null?void 0:o.tag)==="NO_PERMISSION"||(o==null?void 0:o.tag)==="NOT_FOUND"||c||f;if(!ht()||f||u===Tt.FORM_ENG_PAGE)return r.jsx("div",{className:"footer h-[15vh] flex-shrink-0"});if(A1)return null;const p=!d&&i,g=!(l&&!i),_=!h;return!p&&!g&&!_?r.jsx("div",{className:"mt-20"}):r.jsx("div",{className:B("footer flex w-full max-w-[1420px] mx-auto flex-shrink-0 bg-white1 mt-20 line-default justify-center border-t",e.className),style:{fontFamily:cw},children:r.jsxs("div",{className:"flex w-full max-w-[860px] flex-col items-center justify-center px-10",children:[p&&r.jsx(r.Fragment,{children:r.jsx(GE,{loop:!0,autoplay:{delay:8e3},slidesPerView:"auto",watchSlidesProgress:!0,modules:[b8],className:"max-w-[960px] mt-2.5",children:[...Array(3).keys()].map(x=>r.jsx(zE,{className:"flex items-center justify-center transform-gpu",children:r.jsx("a",{href:sT,children:r.jsx("img",{className:"inline h-full max-h-[150px] w-full rounded-[10px]",src:`${bt}/footer/footer-${x}.svg`,alt:sT})})},x))})}),r.jsxs("div",{className:B("text-t3 text-grey3 my-5 flex justify-between w-full",!g&&"justify-center"),children:[r.jsxs("div",{hidden:!g,children:["本页面由",r.jsx("a",{href:An.learnMore,className:"mx-1 text-black",children:"FlowUs 息流"}),"提供技术支持"]}),r.jsx("div",{children:_&&r.jsxs("div",{className:"flex whitespace-nowrap flex-shrink-0",children:["如内容涉及违法违规或侵权，点击",r.jsx("div",{className:"ml-0.5 cursor-pointer text-black",onClick:n,children:"投诉/举报"})]})})]})]})})},ny=()=>{const e=ke(),t=fr(),n=s=>{const{blocks:a}=le(),o=a[s];if(!o)return;const i=pn(o.subNodes),l=i?a[i]:void 0;if(K.ui.selectedBlocks.length&&ee(nt.update({selectedBlocks:[]})),(l==null?void 0:l.type)===m.BlockType.TEXTAREA&&xc(l.data)&&l.subNodes.length===0){t(i,de(l.data.segments).length);return}e(()=>{const c=Qe({},{parentId:s,last:!0});t(c,0)})};return F.useCallback(n,[t,e])},kae=({uuid:e,className:t})=>{const n=ny();return r.jsx("div",{className:B("page-footer min-h-[30vh] flex-1 cursor-text",t),onClick:()=>n(e)})},Cae=e=>ae(({blocks:t})=>{const n=new Set,s=t[e];if(!s)return[];const a=i=>{i==null||i.forEach(l=>{l.type===m.TextType.LINK_PAGE&&l.uuid&&n.add(l.uuid)})},o=i=>{const l=t[i];if(!l)return;if(l.type===m.BlockType.REFERENCE){const f=Vd(i);f&&n.add(f.uuid)}const{segments:c,caption:u,collectionProperties:d={}}=l.data;a(c),a(u),d!==null&&Object.keys(d).forEach(f=>a(d[f])),!Xt(l.type)&&l.subNodes.forEach(o)};return s.subNodes.forEach(o),a(s.data.segments),[...n]},{equalityFn:kn}),n3=e=>{const{blockId:t,updateByBlock:n,...s}=e,{visible:a,setVisible:o,params:i,ref:l,content:c}=Tae(e);return r.jsxs(r.Fragment,{children:[n&&r.jsx(vae,{blockId:t,visible:a,setVisible:o}),r.jsx("div",{...Jn(s,["children","placeHolder","renderMode","rootMargin","container","delay","trackVisibility"]),...i,ref:l,children:c})]})},Tae=e=>{const{children:t,renderMode:n=dc.innerHtml,rootMargin:s,blockId:a,trackVisibility:o=!0,delay:i=150}=e,l=ou(),c=n===dc.innerHtml,u=n===dc.blank,[d,f]=F.useState(!1),h=F.useRef({visible:!1,html:""}),{ref:p,inView:g,entry:_}=kI({root:l==null?void 0:l.current,rootMargin:s||"500px 0px",fallbackInView:!0,trackVisibility:o,delay:i});F.useEffect(()=>{var b,E;if(_)if(g)h.current={visible:!0,html:"",height:_.boundingClientRect.height,width:_.boundingClientRect.width},f(!0);else{if((E=(b=_.target).contains)!=null&&E.call(b,document.activeElement))return;h.current={visible:!1,html:u?"":_.target.innerHTML,height:_.boundingClientRect.height,width:_.boundingClientRect.width},f(!1)}},[_,g,u]);let x={},y;return d?y=r.jsx(r.Fragment,{children:t}):(u&&(x={style:{height:h.current.height},"data-block-id":a}),c&&(x={dangerouslySetInnerHTML:{__html:h.current.html},...h.current.html?{}:{"data-block-id":a}})),{params:x,content:y,visible:d,setVisible:f,ref:p}},vae=e=>{const{blockId:t,visible:n,setVisible:s}=e,a=_e(t,["status","subNodes","data"],["segments","format"]);return F.useLayoutEffect(()=>{n||s(!0)},[a]),r.jsx(r.Fragment,{})},s3=({uuid:e,canClick:t})=>{const n=_e(e,["data"],["segments"]),a=Mg()(e),o=Cs(),{illegal:i}=it(e);if(!n)return null;const l=r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex items-center",children:r.jsx(tn,{blockId:e,trigger:!1,iconSize:16,defaultIcon:r.jsx(as,{uuid:e,size:"small"}),className:"my-1",hasOverlay:!t})}),r.jsx("div",{className:"underline ml-1 mr-1.5 text-black decoration-grey5 break-words flex-shrink-0",children:i?rs:de(n.data.segments)||Ot(n.type)}),!!(a.length&&!i)&&r.jsx(lg,{showAll:!0,className:"flex-shrink-0 text-t3 text-grey3 my-1",navs:a})]}),c=B("flex items-center p-1 text-grey3 text-t2-medium overflow-x-auto",t&&"animate-hover",i&&"opacity-30");return t?r.jsx("div",{onClick:u=>o(e,{forceOpenInRight:u.altKey,forceOpenNewTab:u.ctrlKey||u.metaKey}),className:c,children:l}):r.jsx("div",{className:c,children:l})},i9=({uuid:e,children:t})=>{const[n,s]=F.useState(!1);return r.jsxs(n3,{rootMargin:"100px 0px",children:[r.jsxs("div",{className:"flex items-center py-0.5",children:[r.jsx(H,{name:"IcToggleBlackUnfold",size:"middle",className:B("animate-hover",n&&"-rotate-90"),onClick:()=>{s(a=>!a)}}),r.jsx(s3,{canClick:!0,uuid:e})]}),!n&&t]})},Nae=({uuid:e,callback:t})=>{const n=me(),s=gt(),a=ke();if(!_e(e,["data"],["collectionProperties"]))return null;const i=(l,c)=>{var d,f;const u=K.blocks[c];if(u)if(u.type===m.BlockType.REFERENCE){const h=Vd(c);if(!h)return;pe(c,{type:m.BlockType.TEXTAREA,data:h.data})}else{const h=x=>{if(x.type===m.TextType.LINK_PAGE&&x.uuid&&x.uuid===l){const y=K.blocks[x.uuid];return y?{text:de(y.data.segments),type:m.TextType.TEXT,enhancer:x.enhancer}:x}return x},p=(d=u.data.segments)==null?void 0:d.map(h),g=(f=u.data.caption)==null?void 0:f.map(h),_=Vp(u.data.collectionProperties,x=>x.map(h));pe(c,{data:{...u.data,segments:p,caption:g,collectionProperties:_}})}};return r.jsx("div",{className:"flex-shrink-0 text-grey3 bg-black_006 rounded-xl text-t2 px-2 mr-3 animate-click hidden group-hover:block",onClick:l=>{l.preventDefault(),l.stopPropagation(),n.warning({title:"确定取消该引用？",content:"取消后，原引用页面位置将变为纯文字",confirm:()=>{a(()=>{i(s,e)}),t==null||t()}})},children:"取消引用"})},Iae=({pageId:e,uuid:t,index:n,callback:s,isLocked:a})=>{var h,p,g,_;const o=Qt(),i=Lx(),l=Ao(),c=Cs(),u=_e(t,["data"],["ref","segments","caption","collectionProperties"]),d=F.useMemo(()=>{if(!u)return!1;const x=K.blocks[u.parentId];return x?Wr(x.type):!1},[u]);if(!u)return null;const f=u.type===m.BlockType.TABLE_ROW;return r.jsxs("div",{onClick:x=>{c(e,{hash:`#${f?u.parentId:t}`,forceOpenInRight:x.altKey,forceOpenNewTab:x.ctrlKey||x.metaKey})},className:"animate-hover group flex items-center justify-between mt-1 text-t2-medium",children:[r.jsxs("div",{className:"flex w-full group-hover:w-[calc(100%-80px)]",children:[r.jsxs("div",{className:"flex flex-shrink-0 h-9 items-center justify-end text-right text-t5 w-12 mr-1",children:[n+1,"."]}),u.type===m.BlockType.REFERENCE?r.jsx(s3,{uuid:(p=(h=u.data.ref)==null?void 0:h.uuid)!=null?p:""}):f||d?r.jsxs("div",{className:"flex divide-x-[1px] divide-grey5 space-x-2 items-center h-full flex-wrap",children:[d&&((g=u.data.segments)==null?void 0:g.length)&&r.jsx("div",{className:"text-t3 pointer-events-none flex items-center h-9",children:de(u.data.segments)}),Object.entries((_=u.data.collectionProperties)!=null?_:{}).map(([x,y],b)=>{const E=y.filter(w=>{var k;if(d){const C=K.blocks[u.parentId];if(!C)return null;if(!((k=C.data.schema)==null?void 0:k[x]))return!1}if(w.type===m.TextType.LINK_PAGE&&w.uuid){const C=K.blocks[w.uuid];return C?C.status===m.BlockStatus.NORMAL:!1}return!0});return E.length?r.jsx(Pn,{segments:E,className:"px-1 text-t3 text-grey3 pointer-events-none flex items-center"},b):null})]}):r.jsx(Pn,{segments:u.type===m.BlockType.FILE?u.data.caption:u.data.segments,className:"pointer-events-none"}),hn(t).permissions.every(x=>pn([...i(t)])!==u.spaceId||!l?!1:x.type===m.PermissionType.SPACE||x.type===m.PermissionType.GROUP?x.role===m.PermissionRole.NONE:x.type===m.PermissionType.USER?x.role!==m.PermissionRole.NONE&&x.userId===o.uuid:!0)&&r.jsxs("span",{className:"flex flex-shrink-0 items-center text-red text-t4-medium",children:[r.jsx(H,{name:"IcLock",size:"middle"}),r.jsx("span",{children:"仅我可见"})]})]}),!a&&r.jsx(Nae,{uuid:t,callback:s})]})},r3=({children:e})=>r.jsx("div",{className:"py-4 text-center text-t2 text-grey4",children:e}),a3=({describe:e,tip:t,link:n,type:s})=>{const o=`TIPS::${Qt().uuid}::${s}`,[i,l]=F.useState(!!localStorage.getItem(o));return r.jsxs("div",{hidden:i,className:"flex justify-between items-center space-x-8 text-t2 text-orange min-h-14 p-4 bg-orange/10 mb-2",children:[r.jsx("div",{children:e}),r.jsxs("div",{className:"flex flex-shrink-0 items-center space-x-4",children:[r.jsxs("a",{href:n,target:"_blank",rel:"noreferrer",onClick:c=>{c.stopPropagation()},className:"flex items-center animate-click",children:[r.jsx(H,{name:"IcInviteHelp",size:"middle",className:"mr-1"}),t]}),r.jsx("div",{className:"w-px bg-orange/20 h-4"}),r.jsx(H,{name:"IcTitleClose",size:"middle",className:"animate-click",onClick:()=>{Nn(o,"1"),l(!0)}})]})]})},jae=({uuid:e,setState:t})=>{const[n,s]=F.useState([]),a=So(e),o=Ve(e,!1),i=ae(d=>n.filter(({pageId:f,subNodes:h})=>{if(h.size===0)return!1;const{role:p}=hn(f,d);return p!==m.PermissionRole.NONE})),l=F.useCallback(async d=>{t(f=>({...f,currentLoading:!0}));try{const{recordMap:f,results:h}=await Ce.editor.getDocBacklinks(e);ee(Gn.update({blocks:f.blocks}));const p=[];h.forEach(({pageId:g,uuid:_})=>{if(!f.blocks||!g||!_)return;const x=f.blocks[_];if(!x)return;const{segments:y}=x.data;if(y!=null&&y.some(E=>d.parentId===_&&E.uuid===e))return;const b=p.find(E=>E.pageId===g);if(b)b.subNodes.add(_);else{const E=new Set;E.add(_),p.push({pageId:g,subNodes:E})}}),s(p)}finally{t(f=>({...f,init:!1,currentLoading:!1}))}},[t,e]);F.useEffect(()=>{const d=K.blocks[e];!o&&d&&!d.local&&l(d)},[]);const c=i.length;F.useEffect(()=>{t(d=>({...d,currentNum:c}))},[c,t]);const u=F.useCallback((d,f)=>{s(h=>h.map(p=>(p.pageId===d&&p.subNodes.delete(f),p)))},[]);return o?null:r.jsxs(r.Fragment,{children:[r.jsx(a3,{type:"LINK_TABS_CURRENT",link:An.quotePage,describe:"💡 在其他页面中引用了当前页面，将在此展示被引用记录",tip:"如何引用页面"}),c?i.map(({pageId:d,subNodes:f})=>r.jsx(i9,{uuid:d,children:[...f].map((h,p)=>r.jsx(Iae,{pageId:d,uuid:h,index:p,isLocked:a,callback:()=>u(d,h)},h))},d)):r.jsx(r3,{children:"当前页面暂未被其他页面引用"})]})},l9=e=>e==null?void 0:e.map(t=>t.type==="suggest"?{...t,type:m.TextType.LINK_PAGE}:t),Dae=({uuid:e,segments:t,callback:n,upgrade:s,type:a})=>{const o=me(),i=ke();return r.jsx("div",{className:"flex-shrink-0 text-grey3 bg-black_006 rounded-xl text-t2 px-2 mr-3 animate-click hidden group-hover:block",onClick:l=>{l.preventDefault(),!s()&&o.warning({title:"确定建立该引用？",content:"建立后，原纯文字位置将变为引用页面",confirm:()=>{ce.event(a==="mention"?"sug_reference_current_page_link":"sug_current_reference_others_link"),i(()=>{pe(e,{data:{segments:l9(t)}})}),oa(n)}})},children:"建立引用"})},Sae=({onClick:e})=>r.jsxs("div",{className:"text-grey3 text-t2 p-3",children:["升级「个人专业版/团队版」可体验完整功能",r.jsx("span",{className:"ml-1 text-blue_cobalt animate-click",onClick:e,children:"立即升级"})]}),c9=({uuid:e,fetchSuggest:t,show:n,setShow:s,pages:a,pageIds:o,upgrade:i,isPro:l,linkAll:c,title:u,type:d,isLocked:f})=>{const h=Cs();return r.jsxs("div",{hidden:!o.length,children:[r.jsxs("div",{className:"flex justify-between text-t2 text-grey3 p-3",children:[r.jsx("div",{className:"animate-click",onClick:()=>{t(),s(p=>!p)},children:u}),!!o.length&&l&&r.jsx("div",{className:"animate-click",onClick:c,children:"全部建立引用"})]}),n&&o.map(p=>{var g;return r.jsx(i9,{uuid:p,children:(g=a==null?void 0:a[p])==null?void 0:g.map((_,x)=>r.jsxs("div",{onClick:y=>{h(e||p,{hash:`#${_.uuid}`,forceOpenInRight:y.altKey,forceOpenNewTab:y.ctrlKey||y.metaKey})},className:"group flex items-center justify-between animate-hover",children:[r.jsxs(Fe,{className:"flex items-center",popup:de(_.segments),children:[r.jsxs("div",{className:"flex-shrink-0 text-t2 text-right w-12 mr-1",children:[x+1,"."]}),r.jsx(Pn,{segments:_.segments,className:"leading-7 pointer-events-none w-full",plugins:[...EF,Aae]})]}),!f&&r.jsx(Dae,{type:d,uuid:_.uuid,segments:_.segments,upgrade:i,callback:t})]},x))},p)}),!l&&r.jsx(Sae,{onClick:i})]})},Rae=({pageId:e,htmlDataProps:t,textFormat:n})=>{const s=_e(e,["data"],["segments"]),a=ro(n),o=eF(a);if(!s)return null;const i={...o};return a.lineThrough&&(i.textDecoration!=null?i.textDecoration+=" line-through":i.textDecoration="line-through"),r.jsx("span",{className:"mx-0.5 px-1 bg-grey5 rounded-sm",...t,style:i,children:de(s.data.segments)})},u9={tag:Z6,hasContent:!1,setFormat:(e,t)=>{e.props.textFormat=ro(t,e.props.textFormat)}};Bi(u9);const Aae={elementMeta:u9,initialize(e){e.setElementComponent(this.elementMeta.tag,Rae)}},d9=({uuid:e,setState:t,type:n})=>{const s=Pa(),a=Ft(),[o,i]=F.useState(),l=_e(e,["subNodes","data"],["segments"]),[c,u]=F.useState(!0),d=!di(),f=So(e),h=me(),p=ke(),g=F.useCallback(()=>d?!1:(s({defaultMenuType:Jt.upgrade,from:Vt.link_suggest}),!0),[d,s]),_=Object.keys(o!=null?o:{}).slice(0,d?1/0:2);F.useEffect(()=>{o&&t(y=>({...y,[n]:!!_.length}))},[o,_.length,t,n]);const x=F.useCallback(()=>{ce.event(n==="mention"?"sug_reference_current_page_link_all":"sug_current_reference_others_link_all"),h.warning({title:"确定建立全部引用？",content:"建立后，原纯文字位置将变为引用页面",confirm:()=>{p(()=>{_.forEach(y=>{const b=o==null?void 0:o[y];b&&b.forEach(({uuid:E,segments:w})=>{pe(E,{data:{segments:l9(w)}})})})}),i({})}})},[n,h,_,o,p]);return{upgrade:g,spaceId:a.uuid,show:c,setShow:u,block:l,setPages:i,pages:o,pageIds:_,isPro:d,linkAll:x,isLocked:f}},Bae=({uuid:e,setState:t})=>{const{block:n,setPages:s,spaceId:a,...o}=d9({uuid:e,setState:t,type:"other"}),i=F.useCallback(async()=>{const{blocks:l}=await Ce.infra.searchReferences(a,{pageId:e});if(l){ee(Gn.update({blocks:l}));const c={};Object.keys(l).filter(u=>u!==e).slice(0,o.isPro?1/0:2).forEach(u=>{const d=l[u];if(!d)return;const f=de(d.data.segments);if(E8(+f)||!f)return;const h=(g,_)=>{var y;if(!_||_.every(({text:b})=>b.indexOf(f)<0))return;const x={uuid:g,segments:_.reduce((b,E,w)=>{const k=C=>{const T=C.text.indexOf(f);if(T>-1){const v=C.text.slice(0,T);v&&b.push({...C,text:v}),b.push({type:"suggest",uuid:u,text:"",enhancer:{}});const I=C.text.substring(T).replace(f,"");I&&k({...C,text:I})}else b.push(C)};return k(E),b},[])};Array.isArray(c[u])?(y=c[u])==null||y.push(x):c[u]=[x]},p=g=>{const _=K.blocks[g];if(!_||Xt(_.type))return;const{segments:x,collectionProperties:y={}}=_.data;h(g,x),Object.keys(y).forEach(b=>h(g,y[b])),_.subNodes.forEach(p)};n==null||n.subNodes.forEach(p)}),s(c)}},[n==null?void 0:n.subNodes,o.isPro,s,a,e]);return F.useEffect(()=>{i()},[i]),r.jsx(c9,{type:"other",uuid:e,title:"当前提及了其他页面",fetchSuggest:i,...o})},Lae=({uuid:e,setState:t})=>{const{block:n,setPages:s,spaceId:a,...o}=d9({uuid:e,setState:t,type:"mention"}),i=de(n==null?void 0:n.data.segments),l=F.useCallback(async()=>{if(!i){s({});return}const c=await Ce.infra.searchDocs(a,{page:1,perPage:100,query:i}),{recordMap:u,results:d}=c,f=new Set;if(d.forEach(({pageId:h})=>h&&h!==e&&f.add(h)),u){ee(Gn.update({blocks:u.blocks}));const h={};[...f].slice(0,o.isPro?1/0:2).forEach(p=>{const g=(x,y)=>{var E;if(!y||y.every(({text:w,type:k})=>k===m.TextType.URL||w.indexOf(i)<0))return;const b={uuid:x,segments:y.reduce((w,k,C)=>{const T=v=>{const I=v.text.indexOf(i);if(I>-1){const j=v.text.slice(0,I);j&&w.push({...v,text:j}),w.push({type:"suggest",uuid:e,text:"",enhancer:{}});const D=v.text.substring(I).replace(i,"");D&&T({...v,text:D})}else w.push(v)};return T(k),w},[])};Array.isArray(h[p])?(E=h[p])==null||E.push(b):h[p]=[b]},_=x=>{const y=K.blocks[x];if(!y||Xt(y.type))return;const{segments:b,collectionProperties:E={}}=y.data;g(x,b),Object.keys(E).forEach(w=>g(x,E[w]))};d.filter(x=>x.pageId===p).forEach(({uuid:x})=>_(x))}),s(h)}},[o.isPro,s,a,i,e]);return F.useEffect(()=>{l()},[l]),r.jsx(c9,{type:"mention",title:"提及当前页面",fetchSuggest:l,...o})},Pae=({uuid:e})=>{const t=_e(e,[]),n=(t==null?void 0:t.type)===m.BlockType.FOLDER,[s,a]=F.useState({mention:!0,other:!n});return r.jsxs("div",{children:[r.jsx(a3,{type:"LINK_TABS_SUGGEST",describe:"💡 当前页面与其他页面或有相互提及的情况，但并未建立引用链接，将给出引用建议",tip:"了解引用建议",link:An.quoteSuggestion}),!s.mention&&!s.other?r.jsx(r3,{children:"暂无引用建议"}):r.jsxs(r.Fragment,{children:[r.jsx(Lae,{setState:a,uuid:e}),!n&&r.jsx(Bae,{setState:a,uuid:e})]})]})},Oae=({linkPages:e})=>r.jsxs("div",{children:[r.jsx(a3,{type:"LINK_TABS_MENTION",link:An.quotePage,describe:"💡 当前页面中引用了其他页面，将在此展示记录",tip:"如何引用页面"}),e.length?r.jsx(n3,{rootMargin:"100px 0px",children:e.map((t,n)=>r.jsx(Mae,{uuid:t,index:n},t))}):r.jsx(r3,{children:"当前页面暂未引用其他页面"})]}),Mae=({uuid:e,index:t})=>{const n=Cs();return r.jsx("div",{onClick:s=>{n(e,{forceOpenInRight:s.altKey,forceOpenNewTab:s.ctrlKey||s.metaKey})},className:"group flex items-center justify-between animate-hover",children:r.jsxs("div",{className:"flex py-1",children:[r.jsxs("div",{className:"flex-shrink-0 text-t2 text-right w-12 mt-2 mr-1",children:[t+1,"."]}),r.jsx(s3,{uuid:e})]})})},PN={current:"引用当前页面",mention:"提及的页面引用",suggest:"引用建议"},o3=({uuid:e})=>{var _;const t=_e(e,[]),[n,s]=F.useState("current"),[a,o]=F.useState({init:!0,currentLoading:!1,currentNum:-1}),[i,l]=F.useState(!1),c=Ve(e,!1),u=ny(),d=Ft(),f=Cae(e);if(c)return null;const{isShowBacklink:h}=(_=d.setting)!=null?_:{};if(typeof h=="boolean"&&!h||!t)return null;const p=t.type===m.BlockType.FOLDER,g=Wr(t.type);return r.jsxs("div",{hidden:!a.currentLoading&&a.currentNum===0,className:B("line-default",a.init&&"invisible"),style:{fontFamily:cw},children:[!g&&r.jsx("div",{className:"h-24",onClick:()=>u(e)}),r.jsxs("div",{className:"bg-grey9 rounded",children:[r.jsxs("div",{className:"flex justify-between items-center py-1",children:[r.jsx("div",{className:"px-1 flex space-x-1 text-t2 flex-wrap",children:Object.keys(PN).filter(x=>!p&&!g||x==="current").map(x=>r.jsxs("div",{className:B("h-10 min-w-[138px] animate-hover flex items-center justify-center",x!==n&&"text-grey3"),onClick:()=>s(x),children:[r.jsx("div",{children:PN[x]}),x==="suggest"?r.jsxs(r.Fragment,{children:[r.jsx(H,{name:"IcInviteHelp",size:"small",className:"mx-1 text-grey4 animate-hover",onClick:()=>{window.open(An.quoteSuggestion)}}),r.jsx("div",{className:"rounded-sm bg-grey5 px-1.5 text-grey2 text-t2",children:"Beta"})]}):r.jsx("div",{className:"ml-1 flex justify-center",children:r.jsx(Uae,{tab:x,state:a,mentionNum:f.length})})]},x))}),r.jsx(H,{name:"IcArrowHide",size:"middle",className:B("animate-hover mr-3",i&&"rotate-180"),onClick:()=>l(x=>!x)})]}),r.jsx(Rr,{hidden:i,className:"mb-2"}),r.jsxs("div",{hidden:i,className:"pb-2 px-2 overflow-hidden",children:[n==="current"&&r.jsx(jae,{setState:o,uuid:e}),n==="mention"&&r.jsx(Oae,{linkPages:f}),n==="suggest"&&r.jsx(Pae,{uuid:e})]})]})]})},Uae=({state:e,tab:t,mentionNum:n})=>t==="current"&&e.currentLoading?r.jsx(hs,{size:"small"}):t==="current"?r.jsx("div",{children:e.currentNum}):t==="mention"?r.jsx("div",{children:n}):null,f9=e=>{const t=Ve(e);F.useEffect(()=>{if(t)return;const n=K.blocks[e];if(!n)return;const s=n.subNodes.filter(a=>{const o=K.blocks[a];return o&&o.type!==m.BlockType.PAGE});s.length>0&&Di(()=>{s.forEach(a=>{const{role:o}=hn(a);o===m.PermissionRole.EDITOR&&pe(a,{type:m.BlockType.PAGE})})})},[e,t])},m9=(e,t=!1)=>{const n=`viewId:${e}`,s=ae(({blocks:l,collectionViews:c})=>{var d,f;return(f=(d=l[e])==null?void 0:d.views)==null?void 0:f.filter(h=>{const p=c[h];return p&&p.status!==-1})},{equalityFn:Cn}),a=F.useCallback(()=>{var d;const l=location.hash.slice(1).trim(),c=(d=localStorage.getItem(n))==null?void 0:d.trim();let u="";if(t?u=c!=null?c:"":l?u=l:u=c!=null?c:"",!(u&&(s!=null&&s.includes(u)))){const f=s==null?void 0:s[0];f&&(u=f)}return s!=null&&s.includes(u)?u:""},[t,n,s]),[o,i]=F.useState(a());return F.useEffect(()=>{Nn(n,o),t||history.replaceState(null,"",`#${o}`);const l=a();l!==o&&i(l)},[t,a,n,o]),[o,i]},h9=e=>{const t=jF();F.useEffect(()=>{if(e)return t.subscribeCollectionView(e,async()=>{const n=await Ce.editor.getCollectionView(e);Kn(e,n,!0)})},[e,t])},p9=ia(!1),g9=ia(null),Vae=e=>{const t=dr(()=>new mF),n=ae(_=>{var y,b;const x=((b=(y=_.blocks[e.pageId])==null?void 0:y.discussions)!=null?b:[]).map(E=>_.discussions[E]).filter(E=>E!=null&&!E.resolved);return x.sort($o(hr(E=>E.createdAt))),x},{equalityFn:Cn}),s=ht(),a=Tn(),o=cF(e.pageId),i=(a.planType===Et.team||a.planType===Et.freeTeam)&&o,[l,c]=wm(p9,ur),u=Ar(g9,ur),d=gt(),f=Ve(d,!1,!0),h=Im(),p=s&&h,g=!s&&(i||l)||p;return n.length<=0&&!g?null:r.jsx(hF,{manager:t,children:r.jsxs("div",{"data-disable-select":!0,className:"border-b border-b-grey6  pb-1 text-t2",children:[n.map(_=>r.jsx(f0,{readonly:f,allowCommentInSharePage:h,draftKey:`PageOpenDiscussion:${_.uuid}`,discussionId:_.uuid,autoFocus:u===_.uuid||h,onResolve:()=>{n.length===1&&c(!1)}},_.uuid)),!f&&n.length===0&&g&&r.jsx(qae,{draftKey:`PageTempDiscussion:${e.pageId}`,pageId:e.pageId,autoFocus:!o&&l||p})]})})},qae=e=>{const t=ke(),n=Zm(),s=sa(g9,ur),a=o=>{t(()=>{const i=n.addDiscussion({blockId:e.pageId});i!=null&&(s(i),setTimeout(()=>{s(null)},200),n.appendComment({discussionId:i,text:o}))})};return r.jsx("div",{className:B("py-0.5",e.className),children:r.jsx(aC,{draftKey:e.draftKey,autoFocus:e.autoFocus,onComment:a})})},M_=({onClick:e,className:t,icon:n,text:s})=>r.jsxs("div",{onClick:e,className:B("w-22.5 whitespace-nowrap cursor-pointer flex items-center mt-1 pl-[3px] pr-1.5 text-t2 text-grey3 rounded animate-hover mb-1 mr-2 h-8 opacity-0 group-hover:opacity-100 transition-opacity",t),children:[r.jsx(H,{size:"middle",name:n,style:{display:"flex"}}),r.jsx("div",{className:"ml-1",style:{display:"block"},children:s})]}),Hae=e=>{const{uuid:t,showDescription:n}=e,s=`${t}_mock`,a=_e(t,["data"],["description","showEmptyDescription"]),o=Ve(e.uuid),i=xn(),l=ae(u=>{var d;return de((d=u.blocks[t])==null?void 0:d.data.description).length>0}),c=Pr(t,"description");return F.useEffect(()=>{a!=null&&a.data.showEmptyDescription&&Fr(s,0,0)},[a==null?void 0:a.data.showEmptyDescription,s]),pt.print||!n?null:a!=null&&a.data.showEmptyDescription||l?r.jsx(co,{keydownOption:pQ,uuid:s,"data-disable-select":"true",className:"text-t2 break-words whitespace-pre-wrap",placeholder:"在此添加说明",alwaysShowPlaceholder:!0,onKeyDown:u=>{if(be(["Enter","Shift+Enter"])(u)){u.preventDefault();const d=i(s,!1);if(!d)return;const{selection:f}=d;if(!(f!=null&&f.isCollapsed))return;d.performChange(h=>{h.delete().insert(`
`)})}},readonly:o,segments:a==null?void 0:a.data.description,segmentType:"description",onChange:(u,d,f)=>{c(u,[d,f])},history:!1}):null},ON="一级分类",MN="二级分类",UN="三级分类",$ae="模板名称",Gae="模板来源",zae="模板来源配图",Wae="模板介绍配图",Kae="上线",Yae="模板介绍",Xae="模板链接",Qae=()=>F.useCallback(async()=>{var i;const e=await Ce.editor.getDoc.raw("6a4efea1-e023-4e99-bb69-d69af5909412");if(e.code!==200){ye.error("模板中心加载失败[101]");return}const t=e.data.blocks["6a4efea1-e023-4e99-bb69-d69af5909412"];if(!t||!t.data.schema){ye.error("模板中心加载失败[102]");return}const n=(i=t.views)==null?void 0:i[0];if(!n){ye.error("模板中心加载失败[103]");return}const{blocks:s,collectionViews:a}=e.data;a&&ee(Am.update(a)),ee(Gn.update({blocks:s}));const o=Jae(e.data,n).filter(l=>xi(l,Kae)==="YES");return Zae(o)},[]);function Jae(e,t){var i;const n=(i=e.collectionViews)==null?void 0:i[t],s=e.blocks["6a4efea1-e023-4e99-bb69-d69af5909412"];if(!n||!s)return[];const a=[],{newPageSort:o}=Vg(n.pageSort,s.subNodes);for(const l of o){const c=e.blocks[l];c&&a.push(c)}return a}const xi=(e,t)=>{var i,l;let n;if(typeof e=="string"){const{blocks:c}=le();n=c[e]}else n=e;if(!n)return"";const a=_9(n.parentId)[t],o=a==null?void 0:a.id;if(!o)return"";switch(a.schema.type){case m.CollectionSchemaType.TITLE:return de(n.data.segments);case m.CollectionSchemaType.FILE:case m.CollectionSchemaType.URL:{const c=(i=n.data.collectionProperties)==null?void 0:i[o];return pi(c)}default:return de((l=n.data.collectionProperties)==null?void 0:l[o])}},Zae=e=>{var f,h,p;const t=[],n={};e.forEach(g=>{var v,I,j,D;const _=xi(g,ON);if(!_)return;const x=xi(g,MN);if(!x)return;const y=xi(g,UN),b=D0(g);if(!b)return;let E=n[_];E||(E={name:_,subGroups:[]},t.push(E),n[_]=E);const w=_+x;let k=n[w];if(k||(k={name:x,subGroups:[]},(v=E.subGroups)==null||v.push(k),n[w]=k),!y){k.templates=[...(I=k.templates)!=null?I:[]].concat(b);return}const C=_+x+y;let T=n[C];T||(T={name:y,templates:[]},(j=k.subGroups)==null||j.push(T),n[C]=T),T.templates=[...(D=T.templates)!=null?D:[]].concat(b)});const{blocks:s}=le(),a=_9("6a4efea1-e023-4e99-bb69-d69af5909412");if(!s["6a4efea1-e023-4e99-bb69-d69af5909412"])return;const{schema:i}=(f=a[ON])!=null?f:{},{schema:l}=(h=a[MN])!=null?h:{},{schema:c}=(p=a[UN])!=null?p:{};if(!(i!=null&&i.options)||!(l!=null&&l.options)||!(c!=null&&c.options))return;const u={};i.options.forEach(({value:g},_)=>u[`1${g}`]=_),l.options.forEach(({value:g},_)=>u[`2${g}`]=_),c.options.forEach(({value:g},_)=>u[`3${g}`]=_);const d=(g,_=1)=>{g.forEach(x=>{var y;x.subGroups&&d((y=x.subGroups)!=null?y:[],_+1)}),g.sort((x,y)=>{var b,E;return((b=u[_+x.name])!=null?b:0)-((E=u[_+y.name])!=null?E:0)})};return d(t),t},D0=e=>{let t;if(typeof e=="string"){const{blocks:a}=le();t=a[e]}else t=e;if(!t)return;const n=xi(t,Xae);return{id:n.trim().substring(n.lastIndexOf("/")+1),pageId:t.uuid,name:xi(t,$ae),source:xi(t,Gae),sourceImage:xi(t,zae),desc:xi(t,Yae),image:xi(t,Wae)}},_9=e=>{var a;const t={},{blocks:n}=le(),s=n[e];return s&&Object.entries((a=s.data.schema)!=null?a:{}).forEach(([o,i])=>{t[i.name]={id:o,schema:i}}),t},sy=()=>F.useCallback((e,t)=>{ee(px({uuid:e,patch:t}))},[]),i3=F.createContext("quickSetting"),eoe=()=>F.useContext(i3),ry=ia({hasResult:!1,templates:[]}),ay=e=>{var t;return(t=Ft().customTemplates)==null?void 0:t.includes(e)},x9=()=>{const e=gt(),t=Hd(),n=ow(),s=ke();return F.useCallback(async(a,o)=>{var d,f;let i=n||e;if(o==="quickSetting"||o==="templateBar"){const h=Ut(),p=pn(Gx(K.blocks,h)),g=t(m.BlockType.PAGE,{parentId:h,after:p},cs.PRIVATE);if(!g)return;i=g}let l=(d=K.blocks[a])==null?void 0:d.type;K.blocks[a]||(l=(f=(await Ce.editor.getDoc(a)).blocks[a])==null?void 0:f.type);const c=M2(i)&&Wr(l),u=M2(i)&&xo(l);if(c||u||l===m.BlockType.FOLDER){const h=Qe({},{parentId:i});ee(Er()),i=h}return await oa(async()=>Ce.editor.copyTemplate({uuid:a,targetId:i})),l!==void 0&&c&&s(()=>{l!==void 0&&[m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.REFERENCE_COLLECTION].includes(l)?_s([i],{type:m.BlockType.REFERENCE_COLLECTION}):_s([i],{type:m.BlockType.COLLECTION_VIEW})},{noThrottle:!0}),l!==void 0&&u&&s(()=>{_s([i],{type:m.BlockType.MIND_MAPPING})},{noThrottle:!0}),await Za(800),i},[t,e,n,s])},l3=()=>{const e=x9(),t=ks(),n=La(),s=Un();return F.useCallback(async(a,o)=>{if(Sl(),!a.id)return;ye.loading({key:"templateLoading",content:"正在加载模板..."});const i=await e(a.id,o);if(i)return ce.event("copy_template",{is_from:a!=null&&a.isCustom?"custom":"new_page",template_id:a.id}),t(Ae.GUIDE_FIRST_TIME_COPY_TEMPLATE,We.basicList),await n(i,{force:!0}),o!=="record"&&s.push(`/${i}`),ye.closeMessage("templateLoading"),i},[e,n,s,t])},toe=e=>e.isCustomTemplate?r.jsx("div",{className:B("absolute w-full h-full top-0 lef-0 flex items-center justify-center cursor-pointer"),onClick:()=>e.onClick(),children:r.jsx("img",{className:"w-[100px]",src:e.imageUrl})}):r.jsx("img",{className:B("cursor-pointer w-full h-full rounded scale-[1.1] object-cover",e.className),src:e.imageUrl,onClick:()=>{e.onClick()},style:{objectPosition:"0px -10px"}}),noe=0,soe=1,F9=e=>{const t=me(),n=a=>(o,i)=>{switch(a(),i){case noe:e.onEdit();break;case soe:e.onDelete();break}},s=[{type:$.OPERATION,data:{icon:"IcMenuEditor",title:"编辑"}},{type:$.OPERATION,data:{icon:"IcMenuDelete",title:"删除"}}];return r.jsx("div",{onClick:a=>{a.stopPropagation(),t.dropdown({popcorn:a.currentTarget,placement:"bottom-start",content:({onCloseModal:o})=>r.jsx(ze,{className:"w-[200px] py-2 next-modal",items:s,onItemClick:n(o)})})},className:B("flex justify-center items-center cursor-pointer  self-end",e.className),children:r.jsx(H,{size:"middle",name:"IcMore",style:{color:e.moreColor||"white"}})})},Yh=({template:e,onPreviewOpen:t,className:n})=>{var T,v;const s=Un(),a=La(),o=ks(),i=eoe(),l=Kt(),[c,u]=F.useState(""),[d,f]=F.useState(""),{role:h}=it(e.id),p=ay(e.id),g=me(),_=ke(),x=Yr((T=e.userId)!=null?T:""),[y,b]=Li(),E=l3(),w=async()=>{const I=await E(e,i);I&&(ce.event("copy_template",{is_from:e!=null&&e.isCustom?"custom":"new_page",template_id:e.id}),o(Ae.COPY_PAGE_FROM_TEMPLATE,We.basicList),await a(I,{force:!0}),i!=="record"&&s.push(`/${I}`),ye.closeMessage("templateLoading"),l(Xe.TEMPLATE_CENTER))};F.useEffect(()=>{if(y&&!c&&e.image){if(e.image.startsWith("http")){u(e.image);return}Ls.fetchImageUrl(e.pageId,e.image).then(I=>u(`${I}&img_process=/resize,w_${Math.floor(360*1.5*Math.ceil(window.devicePixelRatio))}/quality,q_90/`))}},[y,c,e.pageId,e.image,u]),F.useEffect(()=>{y&&(d||e.sourceImage&&Ls.fetchImageUrl(e.pageId,e.sourceImage).then(I=>f(`${I}&img_process=/resize,w_${Math.floor(24*1.5*Math.ceil(window.devicePixelRatio))}/quality,q_90/`)))},[y,d,e.pageId,e.sourceImage,u]);const k=h===m.PermissionRole.EDITOR||h===m.PermissionRole.WRITER;if(!p&&e.isCustom)return null;const C=i==="titleSearchFooter";return r.jsxs("div",{className:n,ref:b,children:[r.jsxs("div",{className:B("group relative bg-grey9 rounded-[6px] overflow-hidden h-0 pb-[66%] w-full"),style:{border:"1px solid var(--black_006)",boxShadow:"0px 1px 3px var(--black_006)"},children:[c&&r.jsx(toe,{imageUrl:c,isCustomTemplate:e.isCustom,templateId:e.id,className:"absolute",onClick:()=>{C&&w(),t(e.id)}}),r.jsx("div",{className:"opacity-0 group-hover:opacity-100 flex justify-end items-center absolute h-[56px] w-full top-0 rounded-b-1.5",children:e.isCustom&&k&&r.jsx(F9,{className:"absolute z-20 w-[26px] h-[26px] group-hover:opacity-100 right-0 top-0 opacity-0 mt-2.5 mr-2.5 bg-black/75 rounded-sm",onEdit:()=>{window.open(`/${e.id}`)},onDelete:()=>{g.warning({title:"确认删除模板？",content:"删除后，该模板将从模板库移除并进入回收站",confirmText:"确认删除",colorType:"red",confirm:()=>{_(()=>{Gs(e.id)})}})}})}),!C&&r.jsxs("div",{className:"opacity-0 group-hover:opacity-100 border-t flex justify-between items-center absolute h-[56px] w-full bottom-0 rounded-b-1.5 px-2.5 bg-white3",children:[r.jsx("p",{className:"text-t3 text-grey3 line-clamp-2 overflow-ellipsis",children:e.desc}),r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex justify-center items-center w-[56px] h-8 cursor-pointer border border-solid border-grey5 rounded text-black text-t2-medium  bg-white1 hover:bg-white1/90",onClick:()=>t(e.id),children:"预览"}),r.jsx("div",{className:"flex justify-center items-center ml-2.5 w-[56px] h-8 cursor-pointer bg-active_color text-t2-medium text-white hover:bg-active_color/90 rounded",onClick:w,children:"使用"})]})]})]}),r.jsxs("div",{className:"relative flex justify-between items-center mt-4 mb-[30px] overflow-hidden w-full",children:[r.jsxs("div",{className:"flex-1 overflow-hidden",children:[r.jsx("div",{className:"text-t2-medium text-ellipsis",children:e.isCustom?r.jsx(vc,{uuid:e.id}):e.name}),r.jsx("div",{className:"text-t2 text-grey3 mt-[2px] text-ellipsis",children:e.source||x})]}),d&&r.jsx("img",{className:"w-9 h-9 md:w-5 md:h-5 rounded-full mr-1",src:d}),e.isCustom&&r.jsx(roe,{userId:(v=e.userId)!=null?v:""})]})]})},roe=e=>{const t=$i(e.userId),n=Yr(e.userId);return t?r.jsx(Ps,{className:"rounded-full text-white w-9 h-9 mr-1",name:n||"客",color:(t==null?void 0:t.backgroundColor)||void 0,icon:t!=null&&t.avatar?{type:"upload",value:t.avatar}:void 0,imgClassName:"rounded-full"}):null};let y9;const aoe=e=>{y9=e},ooe=({searchResult:e,setDisableRecommend:t,keyword:n})=>{const s=me(),a=ke(),o=F.useRef(null),{width:i}=Ba(o),l=sy(),c=()=>{s.modal({modalId:Xe.TEMPLATE_CENTER,content:()=>r.jsx(y9,{from:"titleSearch",keyword:n})})},u=d=>{s.dropdown({popcorn:d.currentTarget,placement:"top-end",offset:[0,10],content:({onCloseModal:f})=>r.jsxs("div",{className:"border rounded-sm bg-white1 text-grey3 text-t4 flex whitespace-nowrap",children:[r.jsx("button",{className:"border-r px-1.5",onClick:()=>{a(()=>{l(le().user.currentSpaceViewId,{setting:{closeTemplateRecommend:!0}})}),f()},children:"永久关闭"}),r.jsx("button",{className:"px-1.5",onClick:()=>{t(!0),f()},children:"本次关闭"})]})})};return r.jsx(i3.Provider,{value:"titleSearchFooter",children:r.jsxs("div",{className:"pt-4 bg-grey9 absolute bottom-0 w-full z-[100]",children:[r.jsxs("div",{className:"flex justify-between pr-8",children:[r.jsx("p",{className:"text-t1 py-2 pl-[30px]",children:"为你找到一些模板，试试看？"}),r.jsxs("div",{className:"text-grey3 flex items-center",children:[r.jsx("button",{className:"underline mr-5",onClick:c,children:"查看更多相关模板"}),r.jsx(H,{name:"IcUploadCancel",onClick:u,className:"text-grey4",size:"middle"})]})]}),r.jsx("div",{className:"pl-8 pr-4 overflow-auto flex flex-nowrap",ref:o,children:e.map(d=>r.jsx(Yh,{template:d,className:B("flex-shrink-0 mr-4",(i!=null?i:0)>800?"w-[225px]":"w-[180px]"),onPreviewOpen:()=>{t(!0)}},d.pageId))})]})})},ioe=F.memo(({uuid:e})=>{var Q,Z,te,re,ne,Y;const t=pt.print,n=xn(),s=ks(),a=_e(e,["local","data"]),o=a==null?void 0:a.type,{data:i,local:l}=a||{},c=Pl(e),u=n(e,!0,kr),d=On(),f=qw(),{planType:h}=Ft(),p=Cs(),g=F.useRef(),_=F.useRef(NaN),x=ke(),y=Pr(e),b=Ve(e),E=IC(e,"segments",Ic),w=jC(e,"segments",Ic),k=o===m.BlockType.REFERENCE_COLLECTION||o===m.BlockType.REFERENCE_COLLECTION_PAGE,C=o===m.BlockType.FOLDER,T=o===m.BlockType.COLLECTION_VIEW_PAGE||o===m.BlockType.COLLECTION_VIEW||o===m.BlockType.REFERENCE_COLLECTION||o===m.BlockType.REFERENCE_COLLECTION_PAGE,v=ae(({blocks:X})=>{var oe,ie,ue,ge,Ne;if(o===m.BlockType.REFERENCE_COLLECTION||o===m.BlockType.REFERENCE_COLLECTION_PAGE){const De=X[(ie=(oe=i==null?void 0:i.ref)==null?void 0:oe.uuid)!=null?ie:""];return De?!!((ge=(ue=De.data.icon)==null?void 0:ue.value)!=null&&ge.trim()&&((Ne=De.data.icon.type)!=null&&Ne.trim())):!1}return!1}),I=fr(),j=Ui(),D=h!=="personal"&&h!=="freePersonal"||j||!!(f!=null&&f.setting.closeTemplateRecommend),S=ae(({blocks:X})=>{var oe,ie;return((ie=(oe=X[e])==null?void 0:oe.subNodes)!=null?ie:[]).length>0}),[R,A]=F.useState([]),L=((Q=K.blocks[e])==null?void 0:Q.createdAt)===((Z=K.blocks[e])==null?void 0:Z.updatedAt),[P,M]=F.useState(!(l||L)||C);F.useEffect(()=>{S&&(M(!0),A([]))},[S]),F.useEffect(()=>{u.setReadonly(b||k)},[u,k,b]);const U=F.useRef(null);F.useEffect(()=>{const X=U.current;if(X)return X.addEventListener("inlinedinput",E),()=>{X.removeEventListener("inlinedinput",E)}},[E]),F.useEffect(()=>(u[Jm]=g,u[Pg]=_,zR(c,u),()=>{Yk(c)}),[c,u]),yA(c,u),F.useEffect(()=>{za.activeEditorKey===c&&u.requestFocus()},[c,u]),F.useEffect(()=>{var oe,ie,ue;let X=i==null?void 0:i.segments;(o===m.BlockType.REFERENCE_COLLECTION||o===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(X=(ue=le().blocks[(ie=(oe=i==null?void 0:i.ref)==null?void 0:oe.uuid)!=null?ie:""])==null?void 0:ue.data.segments),FF(u,X)},[e,u,i==null?void 0:i.segments,(te=i==null?void 0:i.ref)==null?void 0:te.uuid,o]),F.useEffect(()=>{var oe,ie,ue;let X=i==null?void 0:i.segments;(o===m.BlockType.REFERENCE_COLLECTION||o===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(X=(ue=le().blocks[(ie=(oe=i==null?void 0:i.ref)==null?void 0:oe.uuid)!=null?ie:""])==null?void 0:ue.data.segments),(!X||X.length===0)&&u.requestFocus()},[]);const V=F.useCallback(fs(async X=>{const oe=de(X);if(!oe){A([]);return}const{uuid:ie}=Tn(),ue=await Ce.editor.searchTemplates(oe,ie,"docTitle"),{recommendResult:ge,recordMap:Ne,searchResult:De,hasSearchResult:Se}=ue;ee(Gn.update({blocks:Ne.blocks}));const{my:Ie=[],official:Ke=[]}=De!=null?De:{},$e=(Se?[...new Set(Ie.concat(Ke))]:ge!=null?ge:[]).map(ut=>D0(ut)).filter(ut=>!!ut);A($e)},600),[]);F.useEffect(()=>{if(b)return;const X=u.onChange.subscribe(async({previousContent:oe,previousSelection:ie})=>{const{content:ue}=u;if(ue===oe)return;const ge=Qs(ue);_.current!==u.revision&&(g.current=ge,y(ge,[oe,ie]),_.current=u.revision),!D&&!P&&V(ge)});return()=>{X.unsubscribe()}},[u,y,b,P,D,V]),F.useEffect(()=>{var X;if(!P&&!D&&o===m.BlockType.PAGE){const oe=(X=U.current)==null?void 0:X.closest(".next-space-page");if(!oe)return;oe.style.paddingBottom="400px"}},[o,D,P]);const W=F.useMemo(()=>r.jsx(HE,{className:B("break-words",gn({outline:"0 !important"})),emptyClassName:gn(t?{}:{selectors:{"&::after":{content:JSON.stringify(Ot(o)),pointerEvents:"none",color:"var(--grey5)"},"& > br":{display:"none"}}}),ref:U,model:u,spellCheck:!1,onKeyDown:X=>{b||T||C||k||be(["ArrowDown","ArrowRight","Enter","Shift+Enter","mod+a"])(X)||w(X)}}),[o,w,u,T,C,k,t,b]);if(!i)return null;const z=((re=U.current)==null?void 0:re.closest(".next-space-page"))||document.body;return r.jsxs("div",{...bn(Bn.DocTitle),"data-block-id":e,"data-disable-select":!0,className:B("relative text-h0 text-black whitespace-pre-wrap",k&&"flex items-center"),onKeyDown:X=>{var oe;if(be("mod+a")(X)){X.stopPropagation();return}if(be(["Enter","Shift+Enter"])(X)){Sl();const ie=nr(c);if(!ie)return;const{selection:ue}=ie;if(!(ue!=null&&ue.isCollapsed))return;if(X.shiftKey){u.performChange(Ie=>{Ie.delete().insert(`
`)});return}if(T||C)return;const{offset:ge}=ue,Ne=Qs(yr(ie.content,0,ge)),De=Qs(yr(ie.content,ge,ie.content.length)),Se=(oe=K.blocks[e])==null?void 0:oe.subNodes.length;(Se===0||!Se)&&s(Ae.CREATE_NEW_PAGE,We.basicList),x(()=>{pe(e,{data:{segments:Ne}});const Ie=Qe({data:{segments:De}},{parentId:e,first:!0});ee(bs({init(){I(Ie,0)},undo(){I(e,ge)},redo(){I(Ie,0)}}))});return}if(!(T||C)){if(be("ArrowRight")(X)){const ie=Zr(e);if(!(ie!=null&&ie.collapsed)||!ie.isLastChar)return!1;const[ue]=_d(d);if(ue){I(ue.blockId,0);return}x(()=>{const ge=Qe({},{parentId:e,first:!0});ee(bs({init(){I(ge,0)},undo(){I(e,0)},redo(){I(ge,0)}}))})}if(be("ArrowDown")(X)){const ie=Zr(e);if(!(ie!=null&&ie.collapsed)||!ie.isLastLine)return!1;const[ue]=_d(d);if(ue){Fr(ue.editorKey,ie.caretRect.x,0);return}x(()=>{const ge=Qe({},{parentId:e,first:!0});ee(bs({init(){I(ge,0)},undo(){I(e,0)},redo(){I(ge,0)}}))})}}},children:[k&&r.jsx(Fe,{popup:"点击访问原始多维表",className:"animate-hover",onClick:X=>{var oe,ie;(oe=i==null?void 0:i.ref)!=null&&oe.uuid&&p((ie=i==null?void 0:i.ref)==null?void 0:ie.uuid,{forceOpenInRight:X.altKey,forceOpenNewTab:X.ctrlKey||X.metaKey})},children:r.jsx(tn,{trigger:!1,className:"mr-1",tooltipClassName:"flex-shrink-0",hasOverlay:v,blockId:(Y=(ne=i==null?void 0:i.ref)==null?void 0:ne.uuid)!=null?Y:"",offset:[100,0],defaultIcon:r.jsx(H,{name:"IcPagelink"})})}),d?r.jsx(mi.Provider,{value:zc.RIGHT_PAGE,children:W}):W,R.length>0&&!P&&!D&&Is.createPortal(r.jsx(ooe,{searchResult:R,setDisableRecommend:M,keyword:de(i==null?void 0:i.segments)}),z)]})}),c3=({uuid:e,className:t,children:n,hiddenCover:s})=>{var j,D,S;const a=_e(e,["data"],["icon","cover","showEmptyDescription"]),o=cF(e),i=Tn(),l=(i.planType===Et.team||i.planType===Et.freeTeam)&&o,c=ke(),u=ae(R=>{var A;return de((A=R.blocks[e])==null?void 0:A.data.description).length>0}),[d,f]=WE(`collection:${e}:showDescription`,void 0),{role:h}=it(e),p=Ve(e),[g,_]=wm(p9,ur),x=ae(R=>{var L,P;return((P=(L=R.blocks[e])==null?void 0:L.discussions)!=null?P:[]).map(M=>R.discussions[M]).filter(M=>M!=null&&!M.resolved).length}),y=!!(a!=null&&a.data.cover)&&!s,b=no(y?document.body:void 0,{type:"height"});if(!a)return null;const E=!!((j=a.data.icon)!=null&&j.value&&a.data.icon.type),w=((D=a.data.icon)==null?void 0:D.type)==="upload",k=Math.min(Math.max(((S=b.height)!=null?S:1024)*.3,220)),C=E?80:pt.print?0:56,T=E?k-(w?65:45):k+20,v=y?T:C,I=[];if(!E&&!p&&I.push(r.jsx(M_,{text:"添加图标",icon:"MIcEmoji",className:"text-grey4 font-normal",onClick:()=>{const R=Ex(!0);c(()=>{pe(e,{data:{icon:{type:"emoji",value:R}}})})}},"addIcon")),!y&&!p&&I.push(r.jsx(M_,{text:"添加封面",icon:"MIcCover",className:"text-grey4 font-normal",onClick:async()=>{const R=await Ce.editor.getCoverImage();c(()=>{pe(e,{data:{cover:R,coverPos:50}})})}},"addCover")),Wr(a.type)&&(!p||u)){const R=(d||d===void 0)&&u||a.data.showEmptyDescription;I.push(r.jsx(M_,{text:R?"隐藏说明":u?"显示说明":"添加说明",icon:"MIcDescription",className:"text-grey4 font-normal",onClick:()=>{R?Is.unstable_batchedUpdates(()=>{f(!1),pe(e,{data:{showEmptyDescription:!1}},!0)}):u?f(void 0):(f(void 0),ce.event("add_description"),pe(e,{data:{showEmptyDescription:!0}},!0))}},"addDesc"))}return!ht()&&Fs(h,m.PermissionRole.COMMENTER)&&x<=0&&!l&&!g&&I.push(r.jsx(M_,{text:"添加评论",icon:"MIcComments",className:"text-grey4 font-normal",onClick:()=>{_(!0)}},"addComment")),r.jsxs("div",{className:B("page-header line-default",t),children:[r.jsxs("div",{className:"group",children:[y&&r.jsx(nf,{uuid:e}),r.jsxs("div",{className:"relative",children:[!s&&r.jsx("div",{className:"transition-all",style:{height:v}}),E&&r.jsx(tn,{blockId:e,className:"inline-block relative z-10",iconSize:w?130:78}),r.jsx("span",{className:"flex h-8 group-hover:visible",children:I})]})]}),r.jsxs("div",{children:[r.jsx(ioe,{uuid:e},e),r.jsx(Hae,{uuid:e,showDescription:d||d===void 0}),n,r.jsx(Vae,{pageId:e})]})]})};let b9;const loe=e=>{b9=e},E9=F.memo(({uuid:e})=>{const t=F.useRef(null),n=F.useRef(null),s=ae(({blocks:x})=>{var E,w;let y=e;const b=x[e];return((b==null?void 0:b.type)===m.BlockType.REFERENCE_COLLECTION||(b==null?void 0:b.type)===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(y=(w=(E=b.data.ref)==null?void 0:E.uuid)!=null?w:""),y}),a=So(e),o=Ve(s,!1),i=Ve(e,!1),[l,c]=m9(e),u=Qg();h9(l),l6(e,t),f9(s);const d=RL(l,i),f=ae(({collectionViews:x})=>{var y;return(y=x[l!=null?l:""])==null?void 0:y.type}),h=w9(f),{fontStyle:p}=ZF(e),g=f&&![m.CollectionViewType.TIMELINE].includes(f);a_(t,{enable:g}),F.useEffect(()=>{if(!o&&!l){const x=u(e,"表格",m.CollectionViewType.TABLE);x&&c(x)}},[u,o,l,e,c]);const _=F.useMemo(()=>({collectionId:s,viewParentId:e,viewType:f,viewId:l!=null?l:"",readonly:o,managerReadonly:i,isLocked:a,changeView:c,pageManager:n}),[s,a,i,o,c,e,l,f]);return!s||!l||!d?null:r.jsx(_l.Provider,{value:_,children:r.jsx(jl,{children:r.jsx("div",{className:B("overflow-auto next-space-page will-change-scroll",pt.print?"overflow-x-hidden":"relative flex flex-col flex-1"),ref:t,"data-page-id":e,onScroll:()=>In.emit("removeHoverMenu"),style:p,children:r.jsxs(au.Provider,{value:t,children:[r.jsx(c3,{uuid:e,className:"md:px-12 px-24 sticky left-0"}),r.jsx(b9,{className:"md:px-12 px-24 left-0 mt-5 sticky top-0 z-50"}),r.jsx("div",{className:"flex-1 md:px-12 px-24 pb-12",children:r.jsx("div",{className:"block-content",children:r.jsx(h,{scrollRef:t})})}),r.jsx("div",{hidden:o,className:"sticky left-0 px-24 md:px-12 mb-24",children:r.jsx(o3,{uuid:e})}),o&&r.jsx("div",{className:"sticky left-0",children:r.jsx(ty,{})})]})})})})}),w9=e=>{if(pt.print)return xb;switch(e){case m.CollectionViewType.TABLE:return xb;case m.CollectionViewType.BOARD:return Mse;case m.CollectionViewType.GALLERY:return oae;case m.CollectionViewType.LIST:return iae;case m.CollectionViewType.TIMELINE:return wae;case m.CollectionViewType.CALENDAR:return mre;case m.CollectionViewType.FORM:return Qre;default:return xb}},coe=500,uoe=200,doe=200,foe=1e3,moe=100,hoe=100,poe=100,goe=500,k9=(e=[])=>{const t={count:0,textCount:0,imageCount:0},{blocks:n}=le(),s=a=>{a.forEach(o=>{const i=n[o];i&&(t.count++,yD(i.type)&&t.textCount++,eq(i)&&t.imageCount++,Xt(i.type)||s(i.subNodes))})};return s(e),t},_oe={TEXT_THRESHOLD:coe,COUNT_THRESHOLD:uoe,VISIBLE_RENDER_THRESHOLD:doe,SUPER_VISIBLE_RENDER_THRESHOLD:foe},xoe={TEXT_THRESHOLD:moe,COUNT_THRESHOLD:hoe,VISIBLE_RENDER_THRESHOLD:poe,SUPER_VISIBLE_RENDER_THRESHOLD:goe},C9=e=>e?xoe:_oe,aE=(e,t,n)=>{F.useEffect(()=>{var l;if(!e.current)return;const{width:s,height:a}=e.current.getBoundingClientRect();t({width:s,height:a});const o=$n(c=>{const{offsetWidth:u,offsetHeight:d}=c.target;t({width:u,height:d})},(l=n==null?void 0:n.wait)!=null?l:200);return Pd.observe(e.current,o)},[t,n==null?void 0:n.wait,e])},Foe=e=>{const t=sa(SR,ur),n=sa(AR,ur),s=sa(DR,ur);aE(e,a=>{t(a.width),n(a.height)}),aE(e,a=>{s(a.width<=860)},{wait:0})},yoe=e=>{const t=sa(RR,ur);aE(e,n=>{t(n.width)})},oE=(e,t,n)=>{typeof e.scrollTo=="function"?(n&&e.scrollTo({top:n,behavior:"auto"}),e.scrollTo({top:t,behavior:"smooth"})):e.scrollTop=t},boe=F.memo(e=>e.isLiteSize?r.jsx(woe,{...e}):r.jsx(Eoe,{...e}),kn),VN=F.memo(e=>{const t=K.blocks[e.uuid],n=t==null?void 0:t.data.segments;return n&&de(n)?r.jsx(Pn,{className:e.className,segments:n,interactable:!1,plugins:kr}):r.jsxs(r.Fragment,{children:[e.title,e.level]})},kn),Eoe=F.memo(e=>{const{onToggle:t,jumpTop:n,active:s,text:a,uuid:o,paddingLeft:i,deep:l,subCount:c,closed:u}=e;return r.jsxs("div",{className:"flex items-center",style:{paddingLeft:i},children:[r.jsx("div",{onClick:()=>t(o),className:B("flex items-center",c?"animate-hover animate-click":"opacity-0"),children:r.jsx(H,{name:"IcNaviFold",size:"middle",className:B("text-grey3 transition-all",{"rotate-90":!u})})}),r.jsx(Fe,{offset:[0,i+32],placement:"left",popup:r.jsx(VN,{...e}),"data-menu-id":o,onClick:()=>{ce.event("float_catalog_clickcatalog"),n(o)},className:B("flex items-center h-9 rounded cursor-pointer animate-hover animate-click",s&&"bg-black_006"),style:{width:"calc(100% - 20px)"},children:r.jsx("div",{className:B("w-full min-w-0 px-1.5 text-ellipsis",{"text-grey4":!a,"text-t1-medium":l===0,"text-t2-medium":l===2||l===1,"text-t2":l===3}),children:r.jsx(VN,{...e,className:"text-ellipsis"})})})]})},kn),woe=F.memo(e=>{const{uuid:t,active:n,jumpTop:s}=e;return r.jsx("div",{"data-menu-id":t,children:r.jsx("div",{"data-menu-id":t,className:"w-[30px] h-[30px] flex items-center justify-center animate-hover rounded","data-id":t,onClick:()=>{ce.event("float_catalog_clickcatalog"),s(t)},children:r.jsx("div",{className:B("w-2.5 h-2.5 cursor-pointer rounded-full",n?"bg-black":"bg-grey4")})})})},kn),koe=({uuid:e,closeAll:t,expandAll:n,onCloseModal:s,isInRight:a,isReadonly:o})=>{const i=ke(),l=[{type:$.OPERATION,data:{title:"全部折叠",onClick(){t(),s()}}},{type:$.OPERATION,data:{title:"全部展开",onClick(){n(),s()}}},{type:$.LINE},{type:$.OPERATION,data:{title:"跳到页首",onClick(){const c=jn(".next-space-page",a);if(!c)return;let u=0;c.scrollTop>50&&(u=50),oE(c,0,u),s()}}},{type:$.OPERATION,data:{title:"跳到页尾",onClick(){const c=jn(".next-space-page",a);if(!c)return;let u=0;const d=c.scrollHeight-c.clientHeight;d-c.scrollTop>50&&(u=d-50),oE(c,d,u),s()}}}];return o||(l.push({type:$.LINE}),l.push({type:$.OPERATION,data:{title:"关闭目录",onClick(){i(()=>{pe(e,{data:{directoryMenu:!1}})}),s()}}})),r.jsx(ze,{className:"py-1 rounded w-48 next-modal",items:l})},Coe=Ai((e,t)=>e.blocks,(e,t)=>t,(e,t)=>{const n=[...bD,m.BlockType.TEMPLATE],s=[m.BlockType.HEADER,m.BlockType.TOGGLE_HEADER],a=new Set,o={},i=l=>{const c=e[l];c&&!a.has(l)&&(!n.includes(c.type)||l===t)&&(a.add(l),c.subNodes.forEach(u=>{var f;const d=e[u];d&&s.includes(d.type)&&(o[u]=d),d&&((f=d.data.ref)!=null&&f.uuid)&&d.type===m.BlockType.SYNC_REFERENCE?i(d.data.ref.uuid):i(u)}))};return i(t),o},{memoizeOptions:{maxSize:200}}),T9=400,Toe=200,voe=54,qN=240,HN=15,Fb="DIRECTORY_MENU_WIDTHS",Tu="DIRECTORY_MENU_CLOSED",v9="DIRECTORY_MENU_MORE_BTN_ID",$N=F.memo(e=>{var P,M,U;const{uuid:t,isLiteSize:n,fixed:s}=e,[a,o]=F.useState([]),i=On(),l=no(jn(".page-header",i),{type:"height"}),c=ou(),u=eX(),d=w8(c),f=F.useRef(!1),h=BA(),p=F.useRef(null),g=me(),[_,x]=F.useState((P=vf(Tu)[t])!=null?P:[]),y=Ve(t),b=F.useCallback((V,W=0)=>h(V,W,z=>{(z==="animateStart"||z==="animateScrollStart")&&k(V),z==="animateScrollStart"&&(f.current=!0),z==="animateScrollEnd"&&(f.current=!1)}),[h]),E=ae(V=>Coe(V,t),{equalityFn:rn}),[w,k]=F.useState(""),C=F.useRef(),T=F.useMemo(()=>{const V=[];return Object.values(E).forEach(W=>{var Y;let z=0,Q=0,Z="";const te=(Y=W.data.level)!=null?Y:1,re=pn(V);if(re)if(te>=re.level)te===re.level?(Z=re.parentId,z=re.paddingLeft,Q=re.deep):(Z=re.uuid,z=re.paddingLeft+HN,Q=re.deep+1);else{const X=eT(V,ue=>ue.level<te),oe=eT(V,ue=>ue.level===te),ie=X||oe;ie&&(ie.level<te?(z=ie.paddingLeft+HN,Q=ie.deep+1,Z=ie.uuid):(z=ie.paddingLeft,Q=ie.deep,Z=ie.parentId))}let ne="标题";W.type===m.BlockType.TOGGLE_HEADER&&(ne="折叠标题"),V.push({parentId:Z,uuid:W.uuid,level:te,deep:Q,paddingLeft:z,text:de(W.data.segments),subNodes:[],active:!1,closed:!1,subCount:0,title:ne})}),V.forEach(W=>{const z=new Set,Q=Z=>{z.has(Z)||(z.add(Z),V.forEach(te=>{te.parentId===Z&&W.subNodes.push(te.uuid)}),W.subNodes.forEach(Q))};Q(W.uuid)}),V},[E]),v=F.useCallback(()=>{const V=[];T.forEach(W=>{var Z;const z=jn(`.next-space-page-content [data-block-id="${W.uuid}"]`,i);if(!z)return;const Q=(Z=qS(z))==null?void 0:Z.top;Q&&V.push({id:W.uuid,top:Q})}),V.sort((W,z)=>W.top-z.top),o(V)},[i,T]);tT(()=>{v()},[u,T,i,d],{wait:1e3}),tT(()=>{if(f.current||!(d!=null&&d.top))return;const V=d.top+100,W=Sa(a);if(W&&W.top>V&&W.id!==w){k(W.id),I(W.id);return}for(let z=0;z<a.length;z++){const Q=a[z],Z=a[z+1];if(Q&&Q.top<=V&&(!Z||Z.top>V)&&Q.id!==w){k(Q.id);let te=Q.id;T.forEach(re=>{_.includes(re.uuid)&&re.subNodes.forEach(ne=>{ne===te&&(te=re.uuid)})}),I(te);return}}},[d==null?void 0:d.top,a,u,_,T,w,i],{wait:200});const I=V=>{const W=jn(`.directory-scroll-container [data-menu-id="${V}"]`,i),z=jn(".directory-scroll-container",i);oE(C.current,Zw(W,z).top-54)},j=T.length!==0,D=F.useMemo(()=>{if(!_.length)return T.map(z=>({...z,active:z.uuid===w}));let V=w;const W=new Set;return T.forEach(z=>{_.includes(z.uuid)&&z.subNodes.forEach(Q=>{Q===V&&(V=z.uuid),W.add(Q)})}),T.filter(z=>!W.has(z.uuid)).map(z=>({...z,closed:_.includes(z.uuid),active:z.uuid===V}))},[T,_,w]),S=F.useCallback(()=>{x([]);const{[t]:V,...W}=vf(Tu);Nn(Tu,JSON.stringify(W))},[t]),R=F.useCallback(()=>{const V=D.filter(W=>W.subNodes.length).map(W=>W.uuid);x(V),Nn(Tu,JSON.stringify({...vf(Tu),[t]:V}))},[D,t]),A=F.useCallback(()=>{p.current&&g.dropdown({modalId:v9,popcorn:Br(p.current),placement:"bottom-end",offset:[0,4],mask:!1,content({onCloseModal:V}){return r.jsx(koe,{uuid:t,onCloseModal:V,closeAll:R,expandAll:S,isInRight:i,isReadonly:y})}})},[R,S,i,y,g,t]),L=F.useCallback(V=>{x(W=>{const z=new Set(W);z.has(V)?z.delete(V):z.add(V);const Q=[...z];return Nn(Tu,JSON.stringify({...vf(Tu),[t]:Q})),Q})},[t]);return s&&D.length===0||n&&D.length===0?null:r.jsxs(r.Fragment,{children:[!n&&r.jsxs("div",{className:"group flex items-center justify-between px-2 pl-3 py-1",children:[r.jsx("div",{className:"text-t2-medium text-grey3 py-2",children:"目录"}),r.jsx("div",{ref:p,onClick:A,className:"p-1 animate-hover opacity-0 group-hover:opacity-100",children:r.jsx(H,{size:"middle",name:"IcMore",className:"text-grey3"})})]}),r.jsx("div",{ref:C,className:B("text-t2 transition-all overflow-x-hidden overflow-y-auto block overscroll-y-contain px-2",n&&"hidden-scrollbar"),style:{paddingBottom:l.height+96,maxHeight:((U=(M=c==null?void 0:c.current)==null?void 0:M.getBoundingClientRect().height)!=null?U:0)-44-24},children:j?D.map(V=>F.createElement(boe,{onToggle:L,isLiteSize:n,...Jn(V,"subNodes"),subCount:V.subNodes.length,key:V.uuid,jumpTop:b})):!n&&r.jsx("div",{className:"flex items-center whitespace-nowrap h-10 pointer-events-none text-grey4 text-t2-medium",children:"请添加标题生成目录"})})]})}),Noe=F.memo(e=>{var p;const{uuid:t}=e,n=Sd(),s=$k(),a=Xr(),[o,i]=F.useState((p=vf(Fb)[t])!=null?p:qN),l=Rm(v9),c=F.useRef(0),u=F.useMemo(()=>r.jsx($N,{...e,isLiteSize:!1,fixed:!0}),[e]),d=F.useMemo(()=>s?r.jsx($N,{...e,isLiteSize:!0}):null,[s,e]),f=g=>{i(g),Nn(Fb,JSON.stringify({...vf(Fb),[t]:g}))},h=$E(({offset:[g]})=>{const _=Math.floor(Math.max(Math.min(2*c.current-g,T9),Toe));f(_)},{from:o,preventDefault:!0});return r.jsx(Hm,{wait:800,waitMode:"debounce",children:r.jsx("div",{className:"select-none cursor-default",children:r.jsx($f,{disableSpring:n,config:{duration:100},className:B("line-default ml-10 mt-6 h-full",{"!pl-3 pr-0 ml-0":s,"flex-shrink-0 max-w-[calc(100%-40px)] min-w-[200px]":!s}),style:{width:s?"auto":o},children:r.jsx("div",{className:"h-full relative z-50 group",children:r.jsxs("div",{className:B("directory-scroll-container sticky left-0 top-0",!s&&"pb-2.5 pl-3.5"),children:[!s&&r.jsx("div",{...h(),onMouseEnter:()=>{c.current=o},onClick:()=>{c.current=o},onDoubleClick:()=>{f(qN)},className:"touch-none group absolute top-0 -left-1 w-3 h-full flex justify-center hover:cursor-col-resize",children:r.jsx("div",{className:"w-[3px] h-full bg-grey9 group-hover:bg-grey6"})}),s?d:u,s&&!a&&r.jsx("div",{className:B("bg-aside w-52 rounded-l rounded-r-none duration-200 transition-all absolute top-0 right-0 translate-x-[110%] group-hover:pointer-events-auto pointer-events-none group-hover:-translate-x-3 group-hover:shadow-sidebar group-hover:delay-150 delay-300",l&&"-translate-x-3"),children:u})]})})})})})}),Ioe=e=>{const t=ke(),n=Ve(e),s=ae(({blocks:a})=>{if(!e)return;const o=a[e];if(!o)return;const{schema:i,collectionPageProperties:l=[]}=o.data;if(!i)return;const c=[],u=[],d=new Set;let f=!1;return l.forEach(h=>{const p=i==null?void 0:i[h.property];if(!p){f=!0;return}d.has(h.property)||(c.push({...h}),d.add(h.property),u.push({...h,schema:p}))}),Object.entries(i).forEach(([h,p])=>{if(d.has(h))return;f=!0;const g={property:h,visible:!0};d.add(h),c.push(g),u.push({...g,schema:p})}),{needUpdateProperties:f,newProperties:c,sorted:u}});return F.useEffect(()=>{!(s!=null&&s.needUpdateProperties)||!s.newProperties||n||s.needUpdateProperties&&t(()=>{e&&pe(e,{data:{collectionPageProperties:s.newProperties}})})},[e,n,s==null?void 0:s.needUpdateProperties,s==null?void 0:s.newProperties,t]),s==null?void 0:s.sorted},joe=({uuid:e})=>{const t=Ve(e),n=ke(),[s,a]=F.useState(!1),o=ih(),i=ae(F.useCallback(({blocks:g})=>{const _=g[e];if(!_)return;const x=g[_.parentId];if(x&&!(x.type!==m.BlockType.COLLECTION_VIEW&&x.type!==m.BlockType.COLLECTION_VIEW_PAGE))return{viewId:"",collectionId:x.uuid,parentRole:hn(x.uuid).role}},[e]),{equalityFn:Cn}),l=So(i==null?void 0:i.collectionId),c=Ve(i==null?void 0:i.collectionId),u=Ioe(i==null?void 0:i.collectionId);if(!i||!u)return null;const d=()=>{ce.event("bitable_property_create",{from_scene:"page"});const g=o({collectionId:i.collectionId});g&&Ye({$newTableProperty:{propertyId:g,from:qn.PAGE_PROPERTIES}})},f=u.filter(g=>g.property==="title"?!1:s?!0:g.visible),h=u.filter(g=>!g.visible).length,p=g=>{const{active:_,over:x}=g;if(x&&_.id!==x.id){const y=u.findIndex(w=>w.property===_.id),b=u.findIndex(w=>w.property===x.id),E=qc(u,y,b);n(()=>{pe(i.collectionId,{data:{collectionPageProperties:E.map(({property:w,visible:k})=>({property:w,visible:k}))}})})}};return r.jsx(_l.Provider,{value:{readonly:t,collectionId:i.collectionId,viewId:"",viewParentId:"",changeView(){}},children:r.jsxs(jl,{children:[r.jsx(vr,{disabled:l||c,items:f.map(g=>({id:g.property,...g})),onChange:(g,_)=>p(_),renderItemContent:({item:g})=>r.jsx(Doe,{recordId:e,propertyId:g.id,schema:g.schema,disabled:l||c},g.id)}),!t&&!l&&(h===0||s)&&i.parentRole!==m.PermissionRole.READER&&r.jsxs("button",{"data-disable-select":"true",onClick:d,className:B("h-[36px] pl-1 rounded flex items-center duration-150 bg-white1 animate-hover w-[188px]"),children:[r.jsx(H,{size:"middle",name:"MIcAddNew",className:"text-grey3 mr-1"}),r.jsx("span",{className:"text-grey3 text-t2",children:"添加属性"})]}),h>0&&r.jsxs("button",{"data-disable-select":"true",className:"animate-hover text-grey3 min-h-[36px] pl-1 pr-2 rounded flex items-center w-[188px]",onClick:()=>a(!s),children:[r.jsx(H,{name:"IcArrowDateBack",size:"middle",className:"mr-1",style:{transform:s?"rotate(90deg)":"rotate(-90deg)"}}),r.jsx("span",{className:"text-t2 ",children:s?`隐藏 ${h} 个属性`:`${h} 个隐藏属性`})]}),r.jsx("hr",{className:"mt-2 mb-2 border-grey6"})]})})},Doe=F.memo(({schema:e,propertyId:t,recordId:n,disabled:s})=>{const a=uh(),o=F.useRef(null),i=gw(t,qn.PAGE_PROPERTIES);return F.useEffect(()=>{o.current&&i&&(a(t,o.current,qn.PAGE_PROPERTIES),Ye({$newTableProperty:void 0}))},[i,a,t]),r.jsxs("li",{"data-disable-select":"true",className:"flex group relative",children:[r.jsxs("div",{className:"",onClick:l=>{s||a(t,l.currentTarget,qn.PAGE_PROPERTIES)},children:[!s&&r.jsx("button",{className:B("absolute -left-5 top-1.5 opacity-0 w-5 h-6 flex items-center justify-center rounded text-grey4  animate-hover hover:text group-hover:opacity-100"),children:r.jsx(H,{name:"IcBlockHandle",size:"small",className:"pointer-events-none"})}),r.jsxs("button",{ref:o,className:B("flex pl-1 self-start items-center min-h-[36px] text-left rounded",{"animate-hover":!s}),children:[r.jsx(H,{className:"mr-1 text-grey3",size:"middle",name:an[e.type]}),r.jsx("div",{className:"flex-shrink-0 mr-1 overflow-hidden text-t2 text-grey3 w-36 overflow-ellipsis whitespace-nowrap",children:e.name})]})]}),r.jsx("div",{className:"flex-1 relative overflow-hidden animate-hover",children:r.jsx(Soe,{schema:e,recordId:n,propertyId:t})})]})}),Soe=({schema:e,recordId:t,propertyId:n})=>{const s=me(),{getState:a}=Kr(),o=Ve(t),i=zs(),l=Su(e.type),c=YB(e.type),u=F.useRef(null),d=f=>{var x,y,b;if(o&&e.type!==m.CollectionSchemaType.FILE&&e.type!==m.CollectionSchemaType.RELATION)return;if(e.type===m.CollectionSchemaType.RELATION&&((x=a().blocks[t])!=null&&x.isTemplate)){ye.warning("模板中暂不支持设置关联属性！");return}if(im.includes(e.type)||e.type===m.CollectionSchemaType.ROLLUP)return;if(e.type===m.CollectionSchemaType.CHECKBOX){const E=(b=(y=a().blocks[t])==null?void 0:y.data.collectionProperties)==null?void 0:b[n];de(E).toUpperCase()==="YES"?i(t,n,mt("NO")):i(t,n,mt("YES"));return}const h={},p=e.type===m.CollectionSchemaType.DATE||e.type===m.CollectionSchemaType.FILE||e.type===m.CollectionSchemaType.FORMULA,g=f.currentTarget.getBoundingClientRect();p||(h.width=g.width);const _=g.height;s.dropdown({popcorn:f.currentTarget,placement:"bottom-start",offset:[0,-_],content({onCloseModal:E}){return r.jsx("div",{ref:u,className:"next-modal",style:h,children:r.jsx(nx.Provider,{value:u,children:r.jsx(c,{site:Me.FIELD,recordId:t,propertyId:n,onClose:E,onUpdate:()=>{},width:g.width})})})}})};return r.jsx("div",{className:B("text-t2 relative text-left whitespace-pre-wrap break-all min-w-[260px] min-h-[36px]",gn({selectors:{":empty:before":{content:'"未填写"',display:"block",fontSize:"14px",color:"var(--grey4)",padding:"8px",lineHeight:"20px"}}})),onClick:d,children:r.jsx(Wg,{children:r.jsx(l,{site:Me.FIELD,recordId:t,propertyId:n})})})};let x1;const Roe=e=>{x1=e},S0=({uuid:e})=>{const t=F.useRef(!1),n=F.useRef(null),s=F.useRef(null),a=$k(),o=Aoe(e),i=Ve(e),l=Cr(),c=F.useContext(mi),u=Xp();l6(e,n);const d=ae(I=>{var j;return(j=I.user.setting)==null?void 0:j.enableHighPerformance}),f=me(),h=Hx(),{fontStyle:p,pageLayoutClassName:g}=ZF(e);Foe(s);const _=lF(),x=Sd(),y=Vn();if(F.useEffect(()=>{if(i||typeof d<"u")return;const{blocks:I}=le(),j=I[e];if(!j)return;const D=A=>{h({setting:{...le().user.setting,enableHighPerformance:A}},!0)},{count:S}=k9(j.subNodes),{COUNT_THRESHOLD:R}=C9(x);S>R&&f.warning({title:r.jsxs("div",{children:[r.jsx("p",{className:"mb-4",children:"在全局设置中开启高性能模式，将可以在编辑时获取极致流畅的体验"}),r.jsx("p",{className:"mb-4",children:"但会无法使用一些功能，例如浏览器自带的搜索功能"})]}),cancelText:"以后再说",confirmText:"马上开启",confirm:()=>D(!0),cancel:()=>D(!1),closeBeforeCallBackForClickOutSide:()=>{D(!1)}})},[d,f,i,h,e,x]),!o)return r.jsx($m,{});const b=I=>{var L,P,M;const{selectedBlocks:j}=le().ui;if(j.length||t.current||["input","textarea"].includes((M=(P=(L=document.activeElement)==null?void 0:L.tagName)==null?void 0:P.toLowerCase())!=null?M:"")&&!I.target.closest(".CodeMirror")||I.target.closest("table")||I.target instanceof Element&&(I.target.closest("[contenteditable]")||I.target.closest(".ignore-focus-click")))return;const{blockId:D,node:S}=kB(I,n.current),R=(S==null?void 0:S.id)===cg?document.querySelector(`[data-block-id="${D}"]`):I.target,A=yB(D,S==null?void 0:S.dataset.syncId);!i&&A&&!R.isContentEditable&&I.currentTarget.contains(R)&&!R.closest(".CodeMirror")&&Fr(A,I.clientX,I.clientY)},E=pt.print,{directoryMenu:w,pageFixedWidth:k=!0}=o,C=!E&&!l&&w&&!(l&&i)&&c!==zc.PAGE_HISTORY&&y&&[Tt.MAIN,Tt.SHARE].includes(y);if(x1===void 0)return null;let T="100%";k&&(!a&&C?T=`${Da+T9}px`:C?T=`${Da+voe}px`:T=`${Da}px`);const v=y===Tt.PAGE_LITE_PREVIEW;return v&&(T="100%"),r.jsx(au.Provider,{value:n,children:r.jsxs("div",{ref:n,onPointerEnter:()=>t.current=!0,onPointerLeave:()=>t.current=!1,onClick:b,id:"next-space-page",className:B(g,"next-space-page",!E&&"flex flex-col flex-1 overflow-x-hidden",u?"overflow-y-hidden":"overflow-y-auto"),onScroll:()=>In.emit("removeHoverMenu"),style:p,children:[r.jsxs("div",{ref:s,className:B("transition-all items-center",!E&&"flex relative flex-1 flex-col",a?"px-12":"px-24",C&&"pl-28 pr-4",C&&a&&"pl-12 pr-0",l&&"px-5",E&&"px-0"),children:[!v&&r.jsxs("div",{className:"w-full transition-all flex-shrink-0",style:{maxWidth:T},children:[r.jsx(c3,{uuid:e,children:r.jsx(joe,{uuid:e})}),r.jsxs("div",{className:B("text-t2 text-grey3 flex items-center px-1 h-5 opacity-0 transition-opacity",_&&"opacity-100"),children:["文档加载中",r.jsx(hs,{size:"middle"})]})]}),E?r.jsx(x1,{uuid:e,readonly:i}):r.jsxs("div",{className:"flex flex-grow flex-shrink-0 transition-all w-full cursor-text",style:{maxWidth:T},children:[r.jsxs("div",{className:"flex flex-col relative w-full block-content transition-all flex-1 min-w-0",children:[r.jsx(x1,{visibleRender:!0,uuid:e,readonly:i}),r.jsx(o3,{uuid:e}),!i&&r.jsx(kae,{uuid:e})]}),C&&r.jsx(Noe,{uuid:e})]})]}),i&&r.jsx(ty,{})]})})},Aoe=e=>ae(({blocks:t})=>{const n=t[e];if(n)return{title:de(n.data.segments)||aa,icon:n.data.icon,iconUrl:n.data.iconUrl,pageFixedWidth:pt.print?!1:n.data.pageFixedWidth,directoryMenu:n.data.directoryMenu}},{equalityFn:Cn}),u3=e=>{const t=Vc(),n=gt(),s=Qw(),a=lF();F.useEffect(()=>{if(a)return;const o=GS(t.hash);o&&N9(n,o,s,e)},[e,s,t,t.hash,n,a])},N9=(e,t,n,s)=>{const a=o=>{const i=ji(o);i.delete(o);const l=[...i].filter(c=>{const u=K.blocks[c],d=wt.$expandFoldRecord[c];return u&&!d});if(l.length)return Po(l,!0,!1),!0};if(t){const o=a(t);setTimeout(()=>{var l;const i=((l=s==null?void 0:s.current)!=null?l:document).querySelector(`[data-block-id='${t}']`);if(i instanceof HTMLElement){setTimeout(()=>{i.scrollIntoView({behavior:"auto",block:"center"})},i.dataset.mindMapId?500:0);const c=[],{syncId:u}=i.dataset;c.push({blockId:t,syncId:u}),(()=>{var p,g;if(!u)return;let f=K.blocks[u];if(!f||(f.type===m.BlockType.SYNC_REFERENCE&&(f=K.blocks[(g=(p=f.data.ref)==null?void 0:p.uuid)!=null?g:""]),!f))return;n(e,[]).forEach(_=>{var y,b;if(_===u)return;const x=K.blocks[_];if(x){if(x.type===m.BlockType.SYNC_CONTAINER)(f==null?void 0:f.uuid)===_&&c.push({blockId:t,syncId:_});else if(x.type===m.BlockType.SYNC_REFERENCE){const E=K.blocks[(b=(y=x.data.ref)==null?void 0:y.uuid)!=null?b:""];if(!E)return;E.uuid===(f==null?void 0:f.uuid)&&c.push({blockId:t,syncId:x.uuid})}}})})(),ee(nt.update({selectedBlocks:c}))}},o?150:0)}},Boe=e=>{const{readonly:t}=e;return r.jsxs("div",{className:"cursor-default login-wrapper",children:[r.jsx("div",{className:"text-[70px] leading-[80px]",children:"☕️"}),r.jsx("div",{className:"text-grey4 text-t1",children:"当前文件夹为空"}),!t&&r.jsx("div",{className:"flex items-center justify-center h-10",children:r.jsx("span",{className:"text-grey3 text-t2",children:"拖拽文件到此处或点击“上传”按钮"})})]})},Loe=e=>t=>{const n=Qj();t===ys.TABLE?delete n[e]:n[e]=t,Nn(Gj,JSON.stringify(n)),Ye({$folderListViewTypeList:n})},Poe=({uuid:e,className:t})=>{const n=fD(e),s=me(),a=[{icon:"IcEditProperty",type:ys.TABLE,title:"列表模式"},{icon:"IcFolderGrid",type:ys.THUMBNAIL,title:"缩略图模式"},{icon:"IcFolderGridLarge",type:ys.PREVIEW,title:"大图模式"}],o=a.find(c=>c.type===n),i=Loe(e),l=c=>{s.dropdown({popcorn:c.currentTarget,placement:"bottom-start",offset:[0,10],content:({onCloseModal:u})=>r.jsx(ze,{className:"next-modal w-44 py-2.5",onItemClick:()=>u(),items:a.map(d=>({type:$.OPERATION,data:{icon:d.icon,title:d.title,selected:d.type===n,onClick:()=>i(d.type)}}))})})};return r.jsx("div",{className:B("text-t2 flex items-center h-full cursor-pointer text-black",t),onClick:l,children:(o==null?void 0:o.icon)&&r.jsxs(r.Fragment,{children:[r.jsx(H,{name:o.icon,size:"middle",className:"mr-1"}),r.jsx(H,{name:"IcArrow",size:"xxxsmall"})]})})},Ooe=F.memo(({ids:e,className:t})=>{const n=ae(i=>i.ui.selectedBlocks),s=F.useMemo(()=>{const i=n.map(u=>u.blockId),l=e.some(u=>i.includes(u));return e.every(u=>i.includes(u))&&l?0:l?1:2},[n,e]),a=i=>{i.stopPropagation(),i.preventDefault(),ee(s===0?nt.updateSelectBlocks([]):nt.updateSelectBlocks(e.map(l=>({blockId:l}))))},o={[0]:{title:"取消全选",name:"IcCheckbox2Check"},[1]:{title:"部分选中",name:"IcSelectedPart"},[2]:{title:"全选",name:"IcCheckbox2"}};return r.jsx(Fe,{"data-no-cancel-selected":!0,popup:o[s].title,onClick:a,className:B(t,n.length&&"opacity-100"),children:r.jsx(Ra,{checkbox2:!0,checked:[0,1].includes(s),name:o[s].name})})}),iE=e=>({[ys.PREVIEW]:{class:"w-[110px] h-[110px]",size:220},[ys.THUMBNAIL]:{class:"w-[50px] h-[50px]",size:100},[ys.TABLE]:{class:"w-[28px] h-[28px] p-1",size:56}})[e],d3=({progress:e,fail:t,...n})=>r.jsx("span",{...n,children:r.jsx("div",{className:B("h-full opacity-80 bg-active_color transition-all rounded-full",t&&"bg-grey3 opacity-100"),style:{width:`${e}%`}})}),I9=({className:e,children:t,uuid:n,noSelectedName:s,...a})=>{const o=Xr(),i=G$(n),l=iu(n),c=Wc();return r.jsx("div",{...a,"data-draggable":!0,"data-no-cancel-selected":!0,"data-block-id":n,className:B("transition-border",o&&"pointer-events-none",o&&i?"border border-black":s,l&&"bg-active_color_10",e),children:r.jsx("div",{className:B("contents",c&&"pointer-events-none"),children:t})})},j9=e=>{var o,i;const t=_e(e,["data"],["format"]),n=Ve(e),s=ke(),{sortType:a}=ex((i=(o=t==null?void 0:t.data)==null?void 0:o.format)==null?void 0:i.orderFolder);return l=>{if(n)return;let c=a;switch(l){case"size":ce.event("sort_file_size"),a===m.OrderFolderType.SIZE?c=m.OrderFolderType.SIZE_REVERSED:c===m.OrderFolderType.SIZE_REVERSED?c=m.OrderFolderType.SIZE:c=m.OrderFolderType.SIZE_REVERSED;break;case"time":ce.event("sort_update_time"),a===m.OrderFolderType.TIME?c=m.OrderFolderType.TIME_REVERSED:c===m.OrderFolderType.TIME_REVERSED?c=m.OrderFolderType.TIME:c=m.OrderFolderType.TIME_REVERSED;break;default:case"name":ce.event("sort_file_name"),a===m.OrderFolderType.NAME?c=m.OrderFolderType.NAME_REVERSED:c===m.OrderFolderType.NAME_REVERSED?c=m.OrderFolderType.NAME:c=m.OrderFolderType.NAME_REVERSED;break}s(()=>{pe(e,{data:{format:{orderFolder:c}}})})}},oy=()=>{const e=Vc();return F.useCallback((t,n)=>{const a=new URLSearchParams(e.search).get(t);return a||n},[e.search])};let D9;const Moe=e=>{D9=e},Uoe=({uuid:e})=>{const[t,n]=F.useState(!1),a=oy()(ms.password),o=F.useCallback(async i=>{IU(nw.PASSWORD,i),(await Ce.editor.getDoc.raw(e)).code===200?(localStorage.setItem(`share-psw-${e}`,i),location.reload(),n(!1)):(sessionStorage.clear(),n(!0))},[e]);return F.useEffect(()=>{a&&o(a)},[a,o]),r.jsxs(r.Fragment,{children:[r.jsx(D9,{emptyStyle:!0}),r.jsxs(S6,{icon:"🔐",title:r.jsx("span",{className:"text-h2",children:"分享访问密码"}),children:[r.jsx("div",{className:"flex my-2.5",children:r.jsx(jU,{size:4,success:o,onError:()=>n(!0),onChange:()=>n(!1)})}),t&&r.jsxs("div",{className:"text-t2 text-red flex",children:[r.jsx($s,{emojiStr:"⚠️",className:"mr-1"}),"密码错误"]})]})]})},Voe=()=>F.useCallback(async()=>{const{results:e}=await Ce.editor.getNotificationUnreadCount(lV),t={strategyGuides:0,messageBoard:0,mentions:0};return e==null||e.forEach(({unread:n})=>{n!=null&&n.mentions&&(t.mentions=n==null?void 0:n.mentions),n!=null&&n.strategyGuides&&(t.strategyGuides=n==null?void 0:n.strategyGuides),n!=null&&n.messageBoard&&(t.messageBoard=n==null?void 0:n.messageBoard)}),t},[]),Oc=ia(!1),S9=(e,t,n)=>ae(s=>qoe(e,t,s,n),{equalityFn:kn}),qoe=(e,t,n,s)=>{const{blocks:a,ui:o,spaceViews:i,user:l}=n,c=Gx(a,e),u=new Set([...c,...wt.$sharedPages]),d=[],f=[],h=[];u.forEach(_=>{const x=a[_];if(!x||x.status!==m.BlockStatus.NORMAL)return;const{roleWithoutPublic:y}=hn(_);if(y===m.PermissionRole.NONE)return;const{permissions:b}=x,E=YS(b.filter(C=>C.role!==m.PermissionRole.NONE));if(x.parentId!==x.spaceId){h.push(_);return}const w=E.find(C=>C.type===m.PermissionType.SPACE);if(!s&&w){d.push(_);return}if(E.find(C=>C.userId===t)&&E.length===1){f.push(_);return}h.push(_)});const p=[],g=i[l.currentSpaceViewId];return g&&g.sharePages.forEach(_=>h.includes(_)&&p.push(_)),h.forEach(_=>!p.includes(_)&&p.push(_)),{team:d,person:f,share:p}};const Hoe=e=>{const t=Un(),n=Ft(),s=S9(n.uuid,K.user.uuid),a=ke(),o=()=>{const i=Ut(),l=localStorage.getItem(`${i}_template_id`),c=Tn();a(()=>{ce.event("preset_template_click"),c.planType==="freePersonal"||c.planType==="personal"?Gs(s.person.filter(u=>u!==l)):Gs(s.team),localStorage.removeItem(`${i}_template_id`),t.push(Rt.main),e.closeModal()})};return r.jsxs("div",{className:"next-modal w-[332px] h-[178px] rounded",children:[r.jsx("div",{className:"text-t1-medium ml-8 mt-8",children:"这里帮你准备了一些模板,"}),r.jsx("div",{className:"text-t1-medium ml-8",children:"帮助你快速了解和使用 ~"}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex ml-8",children:[r.jsx(je,{colorType:"secondary",onClick:o,children:"清空"}),r.jsx(je,{colorType:"active",className:"ml-2.5",onClick:()=>e.closeModal(),children:"好的"})]}),r.jsx("img",{src:Dn.clearTemplate,className:"w-[98px] mr-5"})]})]})},$oe=()=>{const e=me(),t=Ao();return F.useCallback(()=>{var a;const n=Object.values(K.spaces);if(n.length===1&&((a=Sa(n))==null?void 0:a.planType)===Et.freePersonal)return;const s=document.querySelector(`#${t?VS:w2} [data-block-id]`);s&&e.dropdown({modalId:Xe.CLEAR_TEMPLATE,autoClose:!1,keyboard:!1,popcorn:Br(s),placement:"right-start",offset:[-15,-10],arrow:!0,content:o=>r.jsx(Hoe,{closeModal:o.onCloseModal})})},[t,e])},GN=F.memo(()=>{const e=une(),t=$oe(),n=TV(),s=CV(),o=!!Qt().uuid,i=rx(),l=ow(),[c,u]=wm(Oc),d=Voe(),f=F.useRef(null);F.useEffect(()=>{if(!n)return;const b=Tn().uuid;localStorage.getItem(`${oV}_${b}`)==="true"?t():pt.print||e()},[t,e,n]);const h=jF(),p=ae(({user:y})=>y.uuid),g=Rm(Xe.MESSAGE_NOTIFICATION),_=F.useCallback(()=>{d().then(({strategyGuides:y,messageBoard:b})=>{(y>0||b>0)&&Ye({$serviceCenterRedBadge:!0})})},[d]);if(F.useEffect(()=>h.subscribeNotifications(()=>{_()}),[h,g,p,_]),F.useEffect(()=>{cL(),_()},[]),!o||ht()||pt.print)return null;const x=async()=>{ce.event("service_ball_clk"),typeof c=="string"&&["service-center-right","service-center"].includes(c)?u(!1):u(l?"service-center-right":"service-center")};return r.jsxs("div",{ref:f,className:B("service-center fixed bottom-10 transition-all z-50 select-none",c&&!l?"right-[380px]":"right-5",i?"duration-500 opacity-0":"duration-100 opacity-100"),children:[s&&r.jsx("div",{className:"absolute right-0 top-0 w-2.5 h-2.5 bg-red rounded-full"}),r.jsx(Fe,{onClick:x,popup:"点我查看使用帮助信息",placement:"top-end",className:"animate-click btn-helper",arrow:!0,children:r.jsx("img",{className:"pointer-events-none",src:Dn.service})})]})}),R9=({uuid:e,isPreviewPage:t,hideHeader:n,pageScene:s,forceImage:a})=>{const{illegal:o}=it(e),i=_e(e,["data"],["segments","display"]),l=de(i==null?void 0:i.data.segments),c=La(),u=Kt(),{url:d,imageUrl:f}=Vi(o?"":e,{isImage:a}),h=Un(),p=zg(e),{role:g}=it(e),_=kF(e),x=()=>u(Xe.FILE_PREVIEW),{extName:y}=sn(l),[b,E]=F.useState(!0),w=Um();if(F.useEffect(()=>{t?c(e).then(()=>{E(!1);const{blocks:C}=K,T=C[e];T&&(g===m.PermissionRole.EDITOR||g===m.PermissionRole.WRITER)&&w(T.spaceId).then(()=>{Ye({$pageRootLoaded:!0})})}):E(!1)},[c,w,t,g,e]),F.useEffect(()=>{l&&ce.event("file_preview",{file_format:y})},[y,l]),(p==null?void 0:p.tag)==="NEED_PASSWORD")return r.jsx(Uoe,{uuid:e});if(b)return null;if(!i){if(t){if((p==null?void 0:p.tag)==="NOT_FOUND")return r.jsxs(r.Fragment,{children:[r.jsx($m,{showBackButton:!0}),r.jsx(GN,{})]});if((p==null?void 0:p.tag)==="NO_PERMISSION"||g===m.PermissionRole.NONE)return r.jsxs(r.Fragment,{children:[r.jsx(jW,{}),r.jsx(ty,{}),r.jsx(GN,{})]})}return null}if(i.type!==m.BlockType.FILE&&i.type!==m.BlockType.EXTERNAL_FILE&&i.type!==m.BlockType.PDF_ANNOTATION)return h.push(`/${e}`),null;const k=y.toLowerCase()==="pdf";return r.jsxs("div",{className:B("fixed top-0 bottom-0 left-0 right-0",{"bg-black-base/80":!n}),children:[!k&&!n&&r.jsx(aB,{onClose:x,isPreviewPage:t,uuid:e,downloadUrl:d,pageScene:s}),_&&r.jsx("div",{className:"absolute z-10 w-full top-[55px] h-14",children:r.jsx(dC,{uuid:e,onDelete:x})}),r.jsx("div",{className:"file-preview absolute bottom-0 flex items-center justify-center w-full overflow-y-hidden text-white",style:{top:k?_?55:0:_?111:55},onClick:C=>C.target===C.currentTarget&&x(),children:r.jsx(qk,{uuid:e,downloadUrl:f,forceImage:a||i.data.display==="image"})})]})},Goe=({uuid:e,scene:t,ownerBlockId:n})=>{const s=n!=null?n:e,a=F.useMemo(()=>ls(s),[s]),o=PA({uuid:s,pageId:a}),[i,l]=F.useState(Math.max(o.indexOf(s),0)),c=F.useCallback(()=>{l(f=>o[f-1]?f-1:(ye.warning("当前为第一张"),f))},[o]),u=F.useCallback(()=>{l(f=>o[f+1]?f+1:(ye.warning("当前为最后一张"),f))},[o]);F.useEffect(()=>{const f=p=>{ju("ArrowLeft")(p)?c():ju("ArrowRight")(p)&&u()};return qt.addEventListener("keydown",f)},[u,c]);const d=F.useMemo(()=>{var p;const f=o[i],h=K.blocks[`${f}`];return(h==null?void 0:h.type)===m.BlockType.REFERENCE?(p=h==null?void 0:h.data.ref)==null?void 0:p.uuid:o[i]},[o,i]);return r.jsxs("div",{className:"file-preview",children:[r.jsx(R9,{uuid:d!=null?d:"",pageScene:t,forceImage:!0}),r.jsx(Fe,{popup:"上一张",className:"cursor-pointer absolute left-0 pl-2 top-[50%]",children:r.jsx(H,{name:"MIcBtnPre",size:"xxxlarge",onClick:f=>{f.stopPropagation(),c()}})}),r.jsx(Fe,{popup:"下一张",className:"cursor-pointer absolute right-0 pr-2 top-[50%]",children:r.jsx(H,{name:"MIcBtnNext",size:"xxxlarge",onClick:f=>{f.stopPropagation(),u()}})})]})},hh=()=>{const e=me(),t=Vn();return F.useCallback((n,s)=>{const{blocks:a}=le(),o=a[n];if(!o)return;const i=cn.image.test(sn(o.data.ossName).extName)||o.data.display==="image"||o.type===m.BlockType.PDF_ANNOTATION;e.modal({modalId:Xe.FILE_PREVIEW,noAnimation:!0,content:()=>i?r.jsx(Goe,{uuid:n,ownerBlockId:s,scene:t}):r.jsx(R9,{uuid:n,pageScene:t})})},[e,t])},f3=({uuid:e,formHeaderMenu:t})=>{var ne;const n=_e(e,["updatedBy","updatedAt","data"]),s=Un(),a=ke(),o=me(),i=rf(),l=hh(),c=mu(),u=o6(),d=Og(e),f=ah(),{selectedBlockHistory:h}=Ol(),p=Mx(e),g=Ve(e),x=ae(Y=>Es(Y.ui.selectedBlocks),{equalityFn:kn}).some(Y=>Y===e),y=Xr(),b=kF(e),E=Ug(),{illegal:w,role:k}=it(e),C=(n==null?void 0:n.type)===m.BlockType.FOLDER,T=w?rs:de(n==null?void 0:n.data.segments),v=F.useMemo(()=>sn(T),[T]),I=F.useRef(),[j,D]=F.useState(v.name),[S,R]=F.useState(!1),A=Yr((ne=n==null?void 0:n.updatedBy)!=null?ne:""),L=ht(),P=[m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(k);F.useEffect(()=>()=>{o.closeModal(Xe.DRIVE_FILE_CONTEXTMENU)},[o]),F.useEffect(()=>{D(C?T:v.name)},[T,C]);const M=()=>{R(!1),!(j===v.name||C&&j===T)&&a(()=>{!j&&!C?D(v.name):pe(e,{updatedAt:Date.now(),data:{segments:mt(C?j:Gw(j,v.extName))}})})},U=F.useCallback(()=>{E(K.ui.selectedBlocks)},[E]),V=()=>{I.current&&c({popcorn:I.current,uuid:e,placement:"left",offset:[0,20],placeholder:"搜索拷贝到...的页面",copyAndMove:{}})},W=F.useCallback(()=>{if(C){s.push(`/${e}`);return}if(ew(v.extName)){f({uuid:e});return}l(e)},[C,v.extName,l,e,s,f]),z=()=>{ce.event("content_view"),C?s.push(`/${L?"share/":""}${e}`):Hr.pdf.test(v.extName)?window.open(`/${L?"share/":"preview/"}${e}`):W()},Q=F.useCallback(()=>{i(K.ui.selectedBlocks.map(Y=>Y.blockId))},[i]);return{selectCurrentBlock:Y=>{Y.preventDefault(),Y.stopPropagation(),!g&&ee(nt.updateSelectBlocks([{blockId:e}]))},selectBlock:Y=>{Y.preventDefault(),Y.stopPropagation(),ee(x?nt.updateSelectBlocks(K.ui.selectedBlocks.filter(X=>X.blockId!==e)):nt.updateSelectBlocks([...K.ui.selectedBlocks,{blockId:e}]))},isSelected:x,openMenuList:Y=>{if(Y.preventDefault(),Y.stopPropagation(),g)return;ce.event("content_menu"),I.current=lm(Y),x||ee(nt.updateSelectBlocks([{blockId:e}]));const X=P&&K.ui.selectedBlocks.length===1&&!L;let oe=[{type:$.OPERATION,isHidden:K.ui.selectedBlocks.length>1,data:{type:2,icon:"IcMenuOpen",title:"打开",onClick:W}},{type:$.OPERATION,isHidden:t,data:{type:0,icon:"IcMenuDownload",title:"下载",onClick:Q}},{type:$.OPERATION,isHidden:K.ui.selectedBlocks.length>1||g||t,data:{type:4,icon:"IcMenuRename",title:"重命名",onClick:()=>R(!0)}},{type:$.OPERATION,data:{type:3,icon:"IcMenuDuplicate",title:"拷贝副本",onClick:U}},{type:$.OPERATION,data:{type:9,icon:"IcMenuCopyToPage",title:"拷贝副本至页面",onClick:V}},{type:$.OPERATION,data:{type:8,icon:"IcUrl",title:(n==null?void 0:n.type)===m.BlockType.FILE?"拷贝块访问链接":"拷贝页面访问链接",onClick:$n(()=>{if(ce.event("copy_page_link"),(n==null?void 0:n.type)===m.BlockType.FILE){const ie=ls(e);ie&&on(`${Sn()}/${ie}#${e}`,{message:"已复制链接"})}else on(`${Sn()}/${e}`,{message:"已复制链接"})},300,{leading:!0})}},{type:$.LINE,isHidden:g||t,data:{}},{type:$.OPERATION,isHidden:!p,data:{type:1,icon:"IcMenuMove",title:"移动到",onClick:()=>{I.current&&c({popcorn:I.current,uuid:e})}}},{type:$.LINE,isHidden:g||t,data:{}},{type:$.OPERATION,isHidden:b||g||t,data:{type:5,icon:"IcMenuDelete",title:"删除",onClick:()=>{a(()=>{Gs(Es(K.ui.selectedBlocks)),h([])})}}},{type:$.OPERATION,isHidden:!b||g,data:{type:6,icon:"IcTrashRestore",title:"恢复",onClick:()=>{u(e)}}},{type:$.LINE,isHidden:!b||g,data:{}},{type:$.OPERATION,isHidden:!b||g,data:{type:7,icon:"IcMenuDelete",title:"彻底删除",onClick:d}}];X&&oe.push({type:$.LINE,isHidden:!1,data:{}}),w&&(oe=[{type:$.OPERATION,isHidden:g,data:{type:7,icon:"IcMenuDelete",title:"彻底删除",onClick:()=>d()}}]),o.dropdown({modalId:Xe.DRIVE_FILE_CONTEXTMENU,popcorn:I.current,placement:"right-start",content:ie=>r.jsx(ze,{className:"w-[200px] py-2 overflow-y-auto max-h-[80vh] next-modal",onItemClick:()=>ie.onCloseModal(),items:oe,customFooter:X&&r.jsx(Km,{name:A,updatedAt:n==null?void 0:n.updatedAt})})})},handleClick:z,rename:M,isDragging:y,showRename:S,illegal:w,name:j,readonly:g,isFolder:C,setName:D,fileName:T}},m3="grid grid-cols-11 gap-x-2 h-[46px] items-center text-t2 border-b border-grey6",zoe=e=>{const{uuid:t,canDownload:n}=e,s=_e(t,["data","updatedAt","createdAt"],["size","ossName"]),{selectCurrentBlock:a,openMenuList:o,handleClick:i,rename:l,setName:c,selectBlock:u,isDragging:d,showRename:f,illegal:h,name:p,readonly:g,isFolder:_,fileName:x,isSelected:y}=f3({uuid:t}),b=rf();if(!s)return null;const E=h?"-":yR(s.updatedAt||s.createdAt||0),w=s.data.size&&!h?es(s.data.size):"-";return r.jsxs(I9,{uuid:s.uuid,onContextMenu:o,onClick:i,noSelectedName:"border-b border-grey7",className:B("flex items-center group relative",h&&"opacity-30",!d&&!y&&"hover:bg-active_color_10"),...bn(Bn.driveFileItem),children:[n&&r.jsx(Fe,{popup:y?"取消选中":"选中",className:B("transition-opacity opacity-0 absolute -left-6 z-10 group-hover:opacity-100",y&&"opacity-100"),children:r.jsx(Ra,{size:"small",checkbox2:!0,checked:!!y,onClick:u})}),r.jsxs("div",{className:B(m3,"flex-1 grid grid-cols-11 gap-x-2 transition-none cursor-pointer relative"),children:[r.jsxs("span",{className:"flex relative items-center col-span-7",children:[r.jsx("span",{className:"mr-2",children:r.jsx(oh,{ossName:s.data.ossName,className:iE(ys.TABLE).class,uuid:s.uuid,options:{videoPlayIconSize:"small",resizeWidth:iE(ys.TABLE).size},defaultIcon:r.jsx(tn,{trigger:_,blockId:s.uuid,iconSize:18,className:"p-1",defaultIcon:r.jsx(as,{uuid:s.uuid,size:"middle",className:"flex-shrink-0"})})})}),f?r.jsx(xt,{selection:[0,p.length],onEnter:l,className:"h-8 w-full max-w-[360px]",autoFocus:!0,placeholder:Ot(s.type),value:p,onBlur:l,...bn(Bn.driveFileItemInput),onChange:k=>c(k)}):x&&!_?r.jsx(Bl,{className:"w-[calc(100%-100px)]",fileName:x}):r.jsx("span",{className:"text-ellipsis",children:x||Ot(s.type)}),n&&ht()&&r.jsx("div",{className:"ml-auto flex items-center transition-opacity opacity-0 group-hover:opacity-100",children:r.jsx(Fe,{popup:"下载",className:"cursor-pointer animate-hover rounded",children:r.jsx(H,{name:"IcMenuDownload",size:"middle",onClick:k=>{k.preventDefault(),k.stopPropagation(),b([t])}})})}),!g&&r.jsxs("div",{className:"ml-auto flex items-center transition-opacity opacity-0 group-hover:opacity-100",children:[!h&&r.jsx(vg,{pos:"fileItem",uuid:s.uuid,className:"mr-2"}),r.jsx(Fe,{popup:"更多",className:"cursor-pointer animate-hover rounded",children:r.jsx(H,{...bn(Bn.driveFileMore),name:"IcMore",size:"middle",onClick:k=>{a(k),o(k)}})})]})]}),r.jsx(Fe,{placement:"top-start",popup:E,className:"col-span-2 text-ellipsis",children:E}),r.jsx("span",{className:"text-ellipsis col-span-2",children:w})]})]})},Woe=({uuid:e})=>{var o,i;const t=Pi(e);if(!t)return null;const n=l=>{Fg.abort(l),Mw(t.key)},s=(o=t.name)!=null?o:"",a=sn(s);return r.jsxs("div",{className:B("relative p-px",m3),children:[r.jsxs("span",{className:"flex items-center col-span-7",children:[r.jsx(H,{name:pa(a.extName),size:"xxlarge",className:"flex-shrink-0 mr-2 p-1"}),r.jsx(Bl,{className:"w-[calc(100%-100px)]",fileName:s})]}),r.jsxs("span",{className:"col-span-2",style:{color:Us(t.status===Yn.uploading?Pe.blue:Pe.red)},children:[t.status===Yn.uploading&&`已上传${t.progress}%`,t.status===Yn.failure&&"上传失败"]}),r.jsx("span",{className:"col-span-2",children:es(t.size)}),r.jsx(H,{size:"middle",name:"IcUploadCancel",className:"absolute right-3 text-grey3",onClick:()=>{var l;return n((l=t.uploadId)!=null?l:"")}}),r.jsx(d3,{progress:(i=t.progress)!=null?i:-1,fail:t.status===Yn.failure,className:"absolute h-[3px] right-0 bottom-[-1px] w-[36%]"})]},t.key)},Koe=F.memo(({uuid:e})=>{var l,c;const t=Ve(e),n=_e(e,["data"],["format"]),s=j9(e);if(!n)return null;const{sortType:a,reverse:o}=ex((c=(l=n.data)==null?void 0:l.format)==null?void 0:c.orderFolder),i=u=>r.jsx(H,{size:"middle",className:B(o&&"rotate-180",!u&&"hidden"),name:"IcMenuInsertUp"});return r.jsxs("div",{className:B(m3,"text-grey3 flex-1",t&&"pointer-events-none"),children:[r.jsxs("span",{onClick:()=>s("name"),className:"cursor-pointer items-center flex col-span-7",children:["文件名",i([m.OrderFolderType.NAME,m.OrderFolderType.NAME_REVERSED].includes(a))]}),r.jsxs("span",{onClick:()=>s("time"),className:"col-span-2 text-ellipsis cursor-pointer items-center flex",children:["上次修改时间",i([m.OrderFolderType.TIME,m.OrderFolderType.TIME_REVERSED].includes(a))]}),r.jsxs("span",{onClick:()=>s("size"),className:"col-span-2 text-ellipsis cursor-pointer items-center flex",children:["文件大小",i([m.OrderFolderType.SIZE,m.OrderFolderType.SIZE_REVERSED].includes(a))]})]})}),Yoe=F.memo(e=>{const{uuid:t,isPreView:n,canDownload:s}=e,a=_e(t,["data","updatedAt","createdAt"],["ossName","size"]),{selectCurrentBlock:o,openMenuList:i,handleClick:l,rename:c,setName:u,showRename:d,name:f,isDragging:h,selectBlock:p,illegal:g,readonly:_,isFolder:x,fileName:y,isSelected:b}=f3({uuid:t}),E=rf(),w=iE(n?ys.PREVIEW:ys.THUMBNAIL);return a?r.jsxs(I9,{uuid:a.uuid,onContextMenu:i,onClick:l,noSelectedName:"border border-transparent",className:B("flex relative m-2.5 ml-0 px-1.5 py-2.5 group cursor-pointer",n?"w-44":"w-28",g&&"opacity-30",!h&&!b&&"hover:bg-active_color_10"),...bn(Bn.driveFileItem),children:[s&&r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:b?"取消选中":"选中",className:B("transition-opacity opacity-0 absolute left-2 top-2 z-10 group-hover:opacity-100",b&&"opacity-100"),children:r.jsx(Ra,{size:"small",checkbox2:!0,checked:!!b,onClick:p})}),s&&ht()&&r.jsx(Fe,{popup:"下载",className:"transition-opacity opacity-0 right-2 top-2 z-10 group-hover:opacity-100 absolute cursor-pointer animate-hover",children:r.jsx(H,{name:"IcMenuDownload",size:"middle",onClick:k=>{k.preventDefault(),k.stopPropagation(),E([t])}})}),!_&&r.jsx(Fe,{popup:"更多",className:"transition-opacity opacity-0 right-2 top-2 z-10 group-hover:opacity-100 absolute cursor-pointer animate-hover",children:r.jsx(H,{...bn(Bn.driveFileMore),name:"IcMore",size:"small",onClick:k=>{o(k),i(k)}})})]}),r.jsxs("div",{className:"flex items-center justify-center flex-col w-full",children:[r.jsx(oh,{ossName:a.data.ossName,className:w.class,options:{videoPlayIconSize:"xxxlarge",resizeWidth:w.size},uuid:a.uuid,defaultIcon:r.jsx(tn,{trigger:!1,blockId:a.uuid,iconSize:n?100:50,defaultIcon:r.jsx(as,{uuid:a.uuid,size:n?"preview":"max"})})}),r.jsxs("div",{className:"w-full text-center mt-2 text-t2 h-6",children:[d&&r.jsx(xt,{selection:[0,f.length],onEnter:c,className:"h-6 w-full",autoFocus:!0,placeholder:Ot(a.type),value:f,onBlur:c,...bn(Bn.driveFileItemInput),onChange:k=>u(k)}),!d&&(y&&!x?r.jsx(Bl,{className:"flex justify-center",fileName:y}):r.jsx("div",{className:"text-ellipsis",children:y||Ot(a.type)}))]}),r.jsx("div",{className:"text-t4 text-grey3 text-center",children:g?"-":yR(a.updatedAt||a.createdAt||0)}),r.jsx("div",{className:"text-t4 text-center text-grey3",children:a.data.size&&!g?es(a.data.size):"-"})]})]}):null}),Xoe=F.memo(({uuid:e})=>{var d,f;let t;(h=>{h.name="文件名",h.time="上次修改时间",h.size="文件大小"})(t||(t={}));const n=me(),s=_e(e,["data"],["format"]),a=j9(e),o=Ve(e),{sortType:i,reverse:l}=ex((f=(d=s==null?void 0:s.data)==null?void 0:d.format)==null?void 0:f.orderFolder),c=F.useMemo(()=>{const h={title:"上次修改时间",type:"time"};switch(i){case m.OrderFolderType.NAME:case m.OrderFolderType.NAME_REVERSED:{h.type="name";break}case m.OrderFolderType.TIME:case m.OrderFolderType.TIME_REVERSED:{h.type="time";break}case m.OrderFolderType.SIZE:case m.OrderFolderType.SIZE_REVERSED:{h.type="size";break}}return h.title=t[h.type],h},[i,t]);if(!s||o)return null;const u=h=>{n.dropdown({popcorn:h.currentTarget,placement:"bottom-start",content:({onCloseModal:p})=>r.jsx(ze,{className:"next-modal py-2.5 w-40",onItemClick:()=>p(),items:em(t).map(g=>({type:$.OPERATION,data:{title:t[g],type:g,selected:c.type===g,onClick:()=>a(g)}}))})})};return r.jsx("div",{className:"text-grey3 text-t2-medium flex items-center h-10 justify-between w-full",children:r.jsxs("div",{className:"flex items-center h-full",children:["排序方式：",r.jsx("span",{className:B("flex items-center cursor-pointer h-full mr-2"),onClick:u,children:c.title}),r.jsx(H,{size:"middle",className:B("animate-hover",l&&"rotate-180"),name:"IcMenuInsertDown",onClick:()=>a(c.type)})]})})}),Qoe=({uuid:e,isPreView:t})=>{var i,l;const n=Pi(e),s=c=>{Fg.abort(c),n&&Mw(n.key)};if(!n)return null;const a=(i=n==null?void 0:n.name)!=null?i:"",o=ac(a);return r.jsxs("div",{className:B("relative flex flex-col items-center justify-center m-2.5 px-1.5 py-2.5",t?"w-52":"w-28"),children:[r.jsx(H,{size:"middle",name:"IcUploadCancel",className:"absolute right-1 top-1 text-grey3",onClick:()=>{var c;return s((c=n.uploadId)!=null?c:"")}}),r.jsx(H,{name:pa(o.extName),size:t?"preview":"max",className:"flex-shrink-0"}),r.jsx(Bl,{className:"w-full flex items-center justify-center mt-2 text-t2 h-6",fileName:a}),r.jsx("div",{className:"text-t4 text-grey3",children:es(n.size)}),r.jsxs("div",{className:"text-t4",style:{color:Us(n.status===Yn.uploading?Pe.blue:Pe.red)},children:[n.status===Yn.uploading&&`已上传${n.progress}%`,n.status===Yn.failure&&"上传失败"]}),r.jsx(d3,{progress:(l=n.progress)!=null?l:-1,fail:n.status===Yn.failure,className:"absolute h-[3px] left-0 bottom-0 w-full"})]},n.key)},Joe=F.memo(({uuid:e,listView:t,canDownload:n})=>{switch(t){case ys.PREVIEW:case ys.THUMBNAIL:return r.jsx(Yoe,{isPreView:t===ys.PREVIEW,uuid:e,canDownload:n});case ys.TABLE:default:return r.jsx(zoe,{uuid:e,canDownload:n})}}),Zoe=F.memo(({listView:e,uuid:t})=>{switch(e){case ys.PREVIEW:case ys.THUMBNAIL:return r.jsx(Qoe,{uuid:t,isPreView:e===ys.PREVIEW});case ys.TABLE:default:return r.jsx(Woe,{uuid:t})}}),eie=F.memo(({listView:e,uuid:t})=>{switch(e){case ys.PREVIEW:case ys.THUMBNAIL:return r.jsx(Xoe,{uuid:t});case ys.TABLE:default:return r.jsx(Koe,{uuid:t})}}),tie=({uuid:e,container:t})=>{const n=fD(e),s=n===ys.TABLE,a=Ve(e),{allowDuplicate:o}=it(e),i=_e(e,[]),l=wF(e),c=oS(e),u=!!(l.files.length+l.folder.length+c.length),d=o&&ht()||!a,f=F.useMemo(()=>{const p=[];return l.folder.forEach(g=>{p.push({uuid:g.uuid,type:2})}),c.filter(g=>g.uploadId).forEach(g=>{g.key&&p.push({uuid:g.key,type:0})}),l.files.forEach(g=>{p.push({uuid:g.uuid,type:2})}),p},[l.files,l.folder,c]);if(!i)return null;const h={overscan:200,customScrollParent:t,totalCount:f.length,itemContent:p=>{const g=f==null?void 0:f[p];return g?g.type===0?r.jsx(Zoe,{uuid:g.uuid,listView:n}):r.jsx(Joe,{uuid:g.uuid,listView:n,canDownload:d},g.uuid):null}};return r.jsx("div",{className:"px-24 sm:px-10 select-none flex flex-col flex-1","data-page-id":e,children:r.jsxs("div",{className:"w-full h-full block-content flex-1",children:[u&&r.jsxs("div",{className:"flex items-center group relative",children:[d&&r.jsx(Ooe,{className:"absolute -left-6 opacity-0 transition-opacity group-hover:opacity-100 cursor-pointer",ids:[...l.files,...l.folder].map(p=>p.uuid)}),r.jsx(eie,{uuid:i.uuid,listView:n})]}),u?r.jsxs("div",{children:[s?r.jsx(As,{...h}):r.jsx(k8,{...h,listClassName:"flex flex-wrap"}),d&&r.jsx(To,{})]}):r.jsx(Boe,{readonly:a})]})})},nie=({uuid:e})=>{var y;const t=Ve(e),{allowDuplicate:n}=it(e),s=n&&ht()||!t,a=Un(),o=Hd(),i=me(),l=F6(),c=Kt(),d=(y=ae(b=>b.ui.selectedBlocks)[0])==null?void 0:y.blockId,f=ks(),h=b=>{const E=b.target.files;E!=null&&E.length&&(l({ownerPageId:e,files:Array.from(E),type:"file",spaceId:Ut(),userId:K.user.uuid,onComplete:()=>{},inTransferList:!0}),b.target.value="",f(Ae.CREATE_FOLDER_AND_UPLOAD,We.basicList,{step2:!0})),c(Xe.DRIVE_UPLOAD_MENU)},p=async b=>{const E=b.target.files;if(!E)return;const w=[];for(const k of E)w.push(k);l({inTransferList:!0,ownerPageId:e,files:w,type:"file",spaceId:Ut(),userId:K.user.uuid,onComplete:()=>{}}),c(Xe.DRIVE_UPLOAD_MENU)},g=()=>{const b=o(m.BlockType.FOLDER,{parentId:e,last:!0});b&&(ox([e],!0),a.push(`/${b}`))},_=[{type:$.CUSTOM_RENDER,render:()=>r.jsxs("label",{className:"flex items-center h-10 px-1.5 animate-hover cursor-pointer",children:[r.jsx(H,{name:"IcUploadDocMenu",size:"middle",className:"mr-2"}),"上传文件",r.jsx("input",{multiple:!0,type:"file",className:"hidden",onChange:h})]})},{type:$.CUSTOM_RENDER,render:()=>r.jsxs("label",{className:"flex items-center h-10 px-1.5 animate-hover cursor-pointer",children:[r.jsx(H,{name:"MIcUploadFolderMenu",size:"middle",className:"mr-2"}),"上传文件夹",r.jsx("input",{webkitdirectory:"",mozdirectory:"",multiple:!0,type:"file",className:"hidden",onChange:p})]})}],x=b=>{ce.event("content_add"),i.dropdown({popcorn:b.currentTarget,modalId:Xe.DRIVE_UPLOAD_MENU,offset:[0,10],content:()=>r.jsx(ze,{className:"w-[200px] py-1.5 px-2 next-modal text-t2",items:_})})};return r.jsxs("div",{className:"relative text-h0 sm:text-h1 sm:flex-col text-black px-24 sm:px-10",children:[r.jsx(c3,{className:"flex flex-col",uuid:e}),r.jsxs("div",{className:B("flex items-center justify-between py-1.5 sm:mt-2 mt-5",!s&&"hidden pl-0"),children:[r.jsx(Poe,{uuid:e}),r.jsxs("div",{className:"flex items-center h-8",children:[d&&r.jsx(sie,{uuid:d,canDownload:s,readonly:t}),!t&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"whitespace-nowrap flex items-center mr-5 text-t2 text-grey3 animate-hover px-2 h-8",...bn(Bn.driveHeaderFolder),onClick:g,children:[r.jsx(H,{name:"MIcAddNew",className:"mr-1",size:"middle"}),r.jsx("span",{children:"新建文件夹"})]}),r.jsxs(je,{className:"text-t2-medium",colorType:"active",onClick:x,...bn(Bn.driveHeaderUpload),children:[r.jsx(H,{name:"IcBtnUpload",className:"mr-1",size:"middle"}),"上传"]})]})]})]})]})},sie=({uuid:e,canDownload:t,readonly:n})=>{const{openMenuList:s}=f3({uuid:e,formHeaderMenu:!0}),a=rf(),o=ke(),{selectedBlockHistory:i}=Ol(),l=()=>{a(K.ui.selectedBlocks.map(d=>d.blockId))},c=()=>{o(()=>{Gs(Es(K.ui.selectedBlocks)),i([])})},u=ht();return r.jsxs("div",{className:"flex items-center text-t2 text-grey3","data-no-cancel-selected":!0,children:[t&&r.jsxs(Fe,{popup:u?"批量下载":"下载",className:B("flex whitespace-nowrap items-center px-2 h-8 animate-hover",{"mr-2.5":!u}),onClick:l,children:[r.jsx(H,{name:"IcMenuDownload",className:"mr-1",size:"middle"}),u?"批量下载":"下载"]}),!n&&r.jsxs(r.Fragment,{children:[r.jsxs(Fe,{popup:"删除",className:"flex whitespace-nowrap items-center mr-2.5 px-2 h-8 animate-hover",onClick:c,children:[r.jsx(H,{name:"IcMenuDelete",className:"mr-1",size:"middle"}),"删除"]}),r.jsx(Fe,{className:"animate-hover",popup:"更多",children:r.jsx(H,{size:"middle",name:"IcMore",onClick:s})})]}),t&&!u&&r.jsx("span",{className:"w-px h-5 bg-grey6 mx-2.5"})]})},A9=({uuid:e})=>{const t=F.useRef(null),[n,s]=F.useState(t.current),a=Ve(e),{fontStyle:o}=ZF(e);return u3(),F.useEffect(()=>{s(t.current)},[]),r.jsx("div",{className:B("flex flex-col flex-1 overflow-x-hidden next-space-page"),ref:t,style:o,children:r.jsxs("div",{id:Ud,className:"flex relative flex-col flex-1",children:[r.jsx(nie,{uuid:e}),r.jsx(tie,{uuid:e,container:n}),r.jsx("div",{className:"px-24 sm:px-10 mt-8",children:r.jsx(o3,{uuid:e})}),a&&r.jsx(ty,{className:"mt-auto"})]})})},B9=e=>ae(t=>{var s,a;const n=(a=(s=t.blocks[e])==null?void 0:s.data.format)==null?void 0:a.mindMappingFormat;return!!(n!=null&&n.siblingNodeAlignment)}),o_=e=>ae(t=>{var o,i,l,c;const n=(i=(o=t.blocks[e])==null?void 0:o.data.format)==null?void 0:i.mindMappingFormat,s=(l=n==null?void 0:n.type)!=null?l:m.MindMappingType.LOGIC_DIAGRAM_LEFT,a=(c=n==null?void 0:n.lineStyle)!=null?c:m.MindMappingLineStyle.NORMAL;return{mindMapStyle:s,mindMapLineStyle:a}},{equalityFn:Cn}),rie=e=>{const{mindMapStyle:t,mindMapLineStyle:n}=o_(e.mindMapId),s=B9(e.mindMapId),a=ke(),o=Ve(e.mindMapId),i=F.useCallback(u=>{if(t===u)return;const d=K.blocks[e.mindMapId];if(!d)return;const f=h=>{var p;pe(e.mindMapId,{data:{format:{mindMappingFormat:{...(p=d.data.format)==null?void 0:p.mindMappingFormat,type:u}}}},h),ce.event("switch_layout")};o?f(!0):a(()=>{f(!1)})},[t,e.mindMapId,o,a]),l=F.useCallback(u=>{if(n===u)return;const d=K.blocks[e.mindMapId];if(!d)return;const f=h=>{var p;pe(e.mindMapId,{data:{format:{mindMappingFormat:{...(p=d.data.format)==null?void 0:p.mindMappingFormat,lineStyle:u}}}},h),ce.event("switch_line")};o?f(!0):a(()=>{f(!1)})},[n,e.mindMapId,o,a]),c=F.useCallback(u=>{if(u===s)return;const d=K.blocks[e.mindMapId];if(!d)return;ce.event("node_align",{is_align:u});const f=h=>{var p;pe(e.mindMapId,{data:{format:{mindMappingFormat:{...(p=d.data.format)==null?void 0:p.mindMappingFormat,siblingNodeAlignment:u}}}},h),ce.event("switch_layout")};o?f(!0):a(()=>{f(!1)})},[s,e.mindMapId,o,a]);return r.jsxs("div",{className:"next-modal px-4 pt-3 pb-2 w-60","data-ignore-double-click":!0,children:[r.jsx("div",{className:"text-t2 text-grey3",children:"结构"}),r.jsxs("div",{className:"flex items-center mt-3 justify-between",children:[r.jsx(hf,{name:"IcSkeleton1",className:"p-1",active:t===m.MindMappingType.LOGIC_DIAGRAM_LEFT,onClick:()=>{i(m.MindMappingType.LOGIC_DIAGRAM_LEFT)}}),r.jsx(hf,{name:"IcSkeleton2",className:"py-1 px-1.5",active:t===m.MindMappingType.LOGIC_DIAGRAM_RIGHT,onClick:()=>{i(m.MindMappingType.LOGIC_DIAGRAM_RIGHT)}}),r.jsx(hf,{name:"IcSkeleton3",className:"p-1 px-1.5",active:t===m.MindMappingType.MIND_MAPPING,onClick:()=>{i(m.MindMappingType.MIND_MAPPING)}}),r.jsx(hf,{name:"IcSkeleton4",className:"p-1 px-1.5",active:t===m.MindMappingType.ORGANIZATION_STRUCTURE,onClick:()=>{i(m.MindMappingType.ORGANIZATION_STRUCTURE)}})]}),r.jsx("div",{className:"text-t2 text-grey3 mt-3",children:"分支线"}),r.jsxs("div",{className:"flex items-center justify-between mt-3",children:[r.jsx(hf,{name:"IcBranch1",className:"py-1.5 px-8",active:n===m.MindMappingLineStyle.NORMAL,onClick:()=>{l(m.MindMappingLineStyle.NORMAL)}}),r.jsx(hf,{name:"IcBranch2",className:"py-1.5 px-8",active:n===m.MindMappingLineStyle.CUBIC_BEZIER,onClick:()=>{l(m.MindMappingLineStyle.CUBIC_BEZIER)}})]}),r.jsx("div",{className:"text-t2 text-grey3 mt-3",children:"节点宽度"}),r.jsxs("div",{className:"flex items-center justify-between h-10 mt-2",children:[r.jsx("span",{className:"mr-1 text-t2",children:"同级节点对齐"}),r.jsx(wn,{open:s,onSwitch:u=>{c(u)}})]})]})},hf=e=>r.jsx("div",{className:B("hover:animate-hover rounded",{"text-active_color bg-active_color_10":e.active},e.className),onClick:e.onClick,children:r.jsx(H,{name:e.name,size:"xxlarge"})}),aie=()=>{const e=sC(),t=Ws(),n=cQ();return r.jsxs("div",{className:"next-modal flex items-center h-[42px] px-2.5 py-2",style:{boxShadow:"0px 12px 20px rgba(0, 0, 0, 0.16)"},"data-ignore-double-click":!0,children:[r.jsx(Fe,{popup:`缩小画布${Gt}+-`,children:r.jsx(H,{name:"IcPreviewZoomOut",size:"middle",className:"ml-3",onClick:()=>{t.zoomout(),ce.event("zoomout",{from:1})}})}),r.jsx(oie,{scale:e,onZoom:s=>{t.zoom(s)}}),r.jsx(Fe,{popup:`放大画布${Gt}++`,children:r.jsx(H,{name:"IcPreviewZoomIn",size:"middle",onClick:()=>{t.zoomin(),ce.event("zoomin",{from:1})},className:"ml-3 "})}),r.jsx(Fe,{popup:"定位到中心节点",children:r.jsx(H,{name:"IcMenuAnchor",size:"middle",className:"ml-3",onClick:()=>{n()}})})]})},yb=300,bb=110,oie=({scale:e,onZoom:t})=>{const n=F.useRef(null),s=F.useRef(null),a=e*bb/yb;return ig(n,{onResize:o=>{if(o.resizeStatus===ra.RESIZING){const i=(o.deltaX+a)*yb/bb;t(i)}},type:"x"}),r.jsxs("div",{ref:s,className:"flex relative items-center ml-3 cursor-pointer p-2","data-ignore-double-click":!0,style:{width:bb},onClick:o=>{var c;const i=(c=s.current)==null?void 0:c.getBoundingClientRect();if(!i)return;const l=yb*(o.clientX-i.left)/i.width;t(l)},children:[r.jsx("div",{className:"w-full h-[3px] rounded absolute bg-grey7 "}),r.jsx("div",{className:"h-[3px] rounded absolute bg-active_color ",style:{width:a}}),r.jsx("div",{ref:n,className:"absolute bg-white w-[18px] h-[18px] rounded-full cursor-pointer",style:{left:a-9,border:"1px solid rgba(0, 0, 0, 0.1)",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.1)"}})]})},Ea=e=>r.jsx("div",{className:B("flex items-center justify-center w-full h-full rounded-sm",{"cursor-pointer hover:bg-black_006":!e.disabled,"opacity-30":e.disabled,"bg-black_006":e.selected&&!e.disabled},e.className),onClick:e.onClick,onPointerDown:t=>{t.preventDefault(),t.stopPropagation()},children:e.children}),L9=e=>{const t=sC(),n=Ve(e.id),s=So(e.id),a=Vn(),o=km();return a&&[Tt.PAGE_HISTORY,Tt.PAGE_LITE_PREVIEW].includes(a)||s?null:r.jsxs("div",{"data-ignore-double-click":!0,className:"aside-toolbar next-modal absolute p-1 left-10 bottom-7 shadow-light",style:{bottom:"30px"},children:[r.jsx(Fe,{animation:"shift-away",appendTo:"parent",delay:0,className:"w-10 h-10",theme:"none",placement:"right",interactive:!0,maxWidth:1e3,popup:r.jsx(aie,{}),children:r.jsx(Ea,{children:r.jsx("div",{className:"text-t5-medium text-center",children:`${t}%`})})}),r.jsx(Fe,{appendTo:"parent",placement:"right",popupClass:"w-32 text-center",popup:`切换到${o?"编辑":"拖拽"}模式Space`,children:r.jsx(Ea,{selected:o,className:"w-10 h-10",onClick:()=>{Ye({$pressedSpace:!o})},children:r.jsx(H,{name:"IcPreviewMove",size:"middle"})})}),r.jsx(Fe,{animation:"shift-away",appendTo:"parent",delay:0,className:"w-10 h-10",theme:"none",placement:"right",interactive:!0,maxWidth:1e3,popup:r.jsx(rie,{mindMapId:e.id}),children:r.jsx(Ea,{children:r.jsx(H,{name:"IcMindmapStyle",size:"middle"})})}),!n&&r.jsx(Fe,{appendTo:"parent",className:"w-10 h-10",placement:"right",popup:`撤销 ${Gt}+Z`,popupClass:"text-center",children:r.jsx(Ea,{onClick:()=>{ee(Ad()),ce.event("cancel_redo")},children:r.jsx(H,{name:"IcMenuUndo",size:"middle"})})}),!n&&r.jsx(Fe,{appendTo:"parent",className:"w-10 h-10",placement:"right",popupClass:"text-center w-16",popup:`重做
shift+${Gt}+Z`,children:r.jsx(Ea,{onClick:()=>{ee(Dm()),ce.event("cancel_redo")},children:r.jsx(H,{name:"IcMenuRedo",size:"middle"})})})]})},iie=e=>{const[t,n]=F.useState(()=>{var s,a;if(e)return"current"in e?{left:(s=e==null?void 0:e.current)==null?void 0:s.scrollLeft,top:(a=e==null?void 0:e.current)==null?void 0:a.scrollTop}:{left:e==null?void 0:e.scrollLeft,top:e==null?void 0:e.scrollTop}});return F.useEffect(()=>{if(!e)return;let s;if("current"in e?s=e.current:s=e,!e)return;const a=()=>{n({left:s==null?void 0:s.scrollLeft,top:s==null?void 0:s.scrollTop})};return s==null||s.addEventListener("scroll",a),()=>{s==null||s.removeEventListener("scroll",a)}},[e]),t},P9=F.createContext(!1),i_=()=>F.useContext(P9),lie=e=>r.jsx(P9.Provider,{value:!0,children:r.jsx(bd.Provider,{value:!0,children:e.children})}),cie=(e,t)=>{const n=Ig(e),s=uie(e,t);return i_()?{color:n.color||(s==null?void 0:s.color),backgroundColor:n.backgroundColor||(s==null?void 0:s.backgroundColor),left:"-9999px",top:"-9999px"}:{color:n.color||(s==null?void 0:s.color),backgroundColor:n.backgroundColor||(s==null?void 0:s.backgroundColor)}},af=(e,t)=>{const n=Q6(),s=F.useMemo(()=>t===0?30:t===1?20:16,[t]);return{paddingLeft:s,paddingRight:n?0:s}},O9=e=>{const t=Hi();return ae(s=>{var i,l,c;let a=e,o;for(;a&&a!==t;){const u=s.blocks[a];if(o=(l=(i=u==null?void 0:u.data.format)==null?void 0:i.mindMappingFormat)==null?void 0:l.nodeThemeColor,o)break;a=(c=u==null?void 0:u.parentId)!=null?c:""}return o})},uie=(e,t)=>{const n=O9(e);if(!n)return;const s=t===1?Rn(n):gj(n);return{color:Us(n),backgroundColor:s}},M9=[m.BlockType.TABLE,m.BlockType.PAGE,m.BlockType.FOLDER,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE],die=[m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.QUOTE,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MARK,m.BlockType.FILE];m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.QUOTE,m.BlockType.TODO,m.BlockType.MARK,m.BlockType.ORDER_LIST,m.BlockType.LIST;const of=e=>{switch(e){case 0:return"中心节点";default:return"输入文字"}},fie=(e,t,n=!1,s=!1)=>{let a="";switch(e){case 0:{a=" text-t0 rounded-lg focus-within:text-t0 text-black bg-black text-white1 border-2 border-solid py-4 border-black10";break}case 1:{a=" text-t0-1 rounded-md focus-within:text-t0-1 text-black bg-grey5 py-2 border-2 border-solid border-transparent ";break}default:a=" text-t1 rounded-md focus-within:text-t1 text-black bg-grey8 py-0.5 border-2 border-solid border-transparent"}return t?a+=" border-active_color":s&&(a+=" hover:border-active_color/30"),a+=" cursor-default focus-within:cursor-text",a},R0=()=>document.activeElement instanceof HTMLElement?document.activeElement.isContentEditable===!0:!1,U9=(e,t)=>{if(!e)return;const{editorKey:n}=e;return n?nr(n):t(e.blockId)},mie=e=>{const{blockId:t}=e,n=_e(t,["textColor","backgroundColor"]),s=Us(n==null?void 0:n.textColor),a=Rn(n==null?void 0:n.backgroundColor),o=s||a;return r.jsx("div",{className:"rounded-full w-6 h-6 flex items-center justify-center",style:{color:s,backgroundColor:a,borderWidth:"1px",borderColor:o?o.startsWith("linear-gradient")?void 0:E6(o,.1):void 0},children:r.jsx(H,{name:"IcText",size:"small"})})},hie=e=>{const{uuid:t,model:n}=e,s=xn(),a=LF({}),{queryResult:o}=bF(t),i=MF(),l=PF({}),{inCode:c,inEquation:u,disableEquation:d}=o,f=rd(()=>n.onFormatChange.pipe(WI(20),ad(()=>n.format)),n.format,[n]),h=p=>{const g=s(p);g==null||g.performChange(_=>{_.select(0,g.content.length)})};return r.jsxs("div",{className:"flex items-center next-modal","data-no-cancel-selected":!0,onPointerDown:p=>{p.stopPropagation()},children:[r.jsx(Ds,{title:wa("加粗",`${Gt}+B`),icon:"IcBold",highlight:f.bold,onClick:p=>{ce.event("rtf_choose",{rtf_name:"bold"}),ce.event("node_richtext"),p.stopPropagation(),K.ui.selectedBlocks.forEach(g=>{h(g.blockId),i(g.blockId,"bold")})}}),r.jsx(Ds,{title:wa("斜体",`${Gt}+I`),icon:"IcItalic",highlight:f.italic,onClick:p=>{ce.event("rtf_choose",{rtf_name:"italic"}),ce.event("node_richtext"),p.stopPropagation(),K.ui.selectedBlocks.forEach(g=>{h(g.blockId),i(g.blockId,"italic")})}}),r.jsx(Ds,{title:wa("下划线",`${Gt}+U`),icon:"IcUnderline",highlight:f.underline,onClick:p=>{ce.event("rtf_choose",{rtf_name:"underline"}),ce.event("node_richtext"),p.stopPropagation(),K.ui.selectedBlocks.forEach(g=>{h(g.blockId),i(g.blockId,"underline")})}}),r.jsx(Ds,{title:wa("中划线",`${Gt}+Shift+S`),icon:"IcDelete",highlight:f.lineThrough,onClick:p=>{ce.event("rtf_choose",{rtf_name:"deleteline"}),ce.event("node_richtext"),p.stopPropagation(),i(t,"lineThrough"),K.ui.selectedBlocks.forEach(g=>{h(g.blockId),i(g.blockId,"lineThrough")})}}),r.jsx(Ds,{title:wa("代码",`${Gt}+E`),icon:"IcCode",highlight:c,onClick:p=>{ce.event("rtf_choose",{rtf_name:"code"}),ce.event("node_richtext"),p.stopPropagation(),K.ui.selectedBlocks.forEach(g=>{h(g.blockId),l(g.blockId)})}}),r.jsx(Ds,{title:wa("公式",`${Gt}+Shift+X`),disabled:d,icon:"IcEquation",boxClassName:"border-r border-grey6",highlight:u,onClick:p=>{const{selection:g}=n;g!==null&&(ce.event("node_richtext"),ce.event("rtf_choose",{rtf_name:"equation"}),p.stopPropagation(),K.ui.selectedBlocks.forEach(_=>{h(_.blockId),a(_.blockId)}))}})]})},h3=()=>{const e=Ws();return F.useCallback((t,n)=>{var o;const s=(o=wt.$expandFoldRecord[t])!=null?o:!0,a=n!=null?n:!s;e.updateMindNode({id:t,expanded:a}),Po([t],a)},[e])},V9=()=>{const e=Ws();return F.useCallback(t=>{const n=e.getRootMindNode(),s=n.childrenIds.some(l=>{const c=e.getMindNode(l);return c==null?void 0:c.expanded}),a=t!=null?t:!s,o=[],i=l=>{const c=K.blocks[l];c&&(o.push(l),c.subNodes.forEach(u=>{i(u)}))};n.childrenIds.forEach(l=>{i(l)}),e.toggleAllMindNode(o,a),Po(o,a)},[e])},q9=e=>{var b,E,w,k,C,T;const t=Ws(),n=Hi(),s=ke(),a=h3(),o=Ug(),i=lh(),l=ae(v=>v.ui.selectedBlocks),c=(E=(b=l[0])==null?void 0:b.blockId)!=null?E:"",u=(k=(w=l[l.length-1])==null?void 0:w.blockId)!=null?k:"",d=Ym(c),f=Oo(v=>v.rootId===c),h=l.length>1,p=ae(v=>{const I=t.getState();for(const j of v.ui.selectedBlocks){const D=I.mindNodes[j.blockId];if(D&&D.childrenIds.length>0)return{expanded:D.expanded}}},{equalityFn:Cn});if(!d)return null;const g=K.blocks[(T=(C=l[0])==null?void 0:C.blockId)!=null?T:""];if(!g)return null;const _=Xt(g.type)||ki(g)||B1(g),x=[{type:$.OPERATION,isHidden:f||h,data:{title:"插入同级节点",onClick:()=>{s(()=>{var I,j;const v=i({parentId:(j=(I=K.blocks[c])==null?void 0:I.parentId)!=null?j:"",after:c},n);v&&ee(nt.updateSelectBlocks([{blockId:v,mindMapId:n}]))}),ce.event("node_new",{from:2})},rightText:"Enter"}},{type:$.OPERATION,isHidden:!t.option.supportAppendChild(c)||h,data:{title:"插入子节点",onClick:()=>{s(()=>{const v=i({parentId:c,last:!0},n);v&&ee(nt.updateSelectBlocks([{blockId:v,mindMapId:n}]))}),a(c,!0),ce.event("node_new",{from:2})},rightText:"Tab"}},{type:$.OPERATION,isHidden:f||h,data:{title:"插入父节点",onClick:()=>{s(()=>{var I,j;const v=i({parentId:(j=(I=K.blocks[c])==null?void 0:I.parentId)!=null?j:"",after:c},n);v&&(Ri([c],{parentId:v,last:!0}),ee(nt.updateSelectBlocks([{blockId:v,mindMapId:n}])),ce.event("node_new",{from:2}))})},rightText:`${Gt}+Tab`}},{type:$.LINE,data:{},disableClick:!0},{type:$.OPERATION,isHidden:_||l.length>1,data:{title:"拷贝块访问链接",onClick:()=>{const v=ls(g.uuid);on(`${Sn()}/${v}#${g.uuid}`)}}},{type:$.OPERATION,isHidden:!_||l.length>1,data:{title:"拷贝页面访问链接",onClick:()=>{var j;const I=ki(g)?(j=Vd(c))==null?void 0:j.uuid:c;ce.event("copy_page_link"),on(`${Sn()}/${I}`)}}},{type:$.OPERATION,isHidden:f,data:{title:"拷贝副本",onClick:()=>{o(l,u)},rightText:`${Gt}+D`}},{type:$.OPERATION,isHidden:f,data:{title:"复制",onClick:()=>{document.execCommand("copy")},rightText:`${Gt}+c`}},{type:$.OPERATION,isHidden:f,data:{title:"剪切",onClick:()=>{document.execCommand("cut")},rightText:`${Gt}+x`}},{type:$.OPERATION,data:{title:"删除",onClick:()=>{s(()=>{Gs(Es(iG(l)))})},rightText:"Del"}},{type:$.OPERATION,isHidden:h,data:{title:"定位到中心节点",onClick:()=>{t.fitCenter()}}},{type:$.LINE,isHidden:(d==null?void 0:d.childrenIds.length)===0,data:{},disableClick:!0},{type:$.OPERATION,isHidden:!p,data:{title:`${p!=null&&p.expanded?"折叠":"展开"}子节点`,onClick:()=>{const v=t.getState();l.forEach(I=>{const j=v.mindNodes[I.blockId];j&&j.childrenIds.length>0&&a(I.blockId,!(p!=null&&p.expanded))}),ce.event("node_fold",{from:2})},rightText:`${Gt}+.`}}],y=x.find(v=>!v.isHidden);return(y==null?void 0:y.type)===$.LINE&&(y.isHidden=!0),r.jsx("div",{"data-no-cancel-selected":!0,children:r.jsx(ze,{className:Mi,items:x,onItemClick:e.onItemClick})})},zN=e=>{const{accept:t,iconName:n,onSuccess:s,blockId:a}=e,o=me(),i=Ma(),l=Kt();return r.jsxs("label",{className:"flex items-center",children:[r.jsx(H,{name:n,size:"middle",className:e.disabled?"":"cursor-pointer"}),r.jsx("input",{disabled:e.disabled,type:"file",accept:t,className:"hidden",onChange:async c=>{const u=c.target.files;if(!u)return;const d=u[0];if(!d)return;const f=qe();i({key:a,inTransferList:!0,file:d,blockId:a,type:"file",spaceId:Ut(),onProgress(h){o.loading({modalId:f,title:`正在上传 ${h}%`})},onComplete(h){l(f),h.success&&s(d,h.ossName)}})}})]})},pie=10,gie=42,_ie=e=>{var ne,Y,X,oe,ie,ue,ge,Ne,De,Se;const t=ae(Ie=>Ie.ui.selectedBlocks),n=ke(),s=t.length===1&&t.some(Ie=>Ie.blockId===e.id),a=xn(),[o,i]=F.useState(void 0),l=Vn()===Tt.MAIN,c=Hi(),u=Ve(c),d=ae(Ie=>{var Ke,dt;if(Ie.ui.selectedBlocks.length===1){const $e=(dt=(Ke=Ie.ui.selectedBlocks[0])==null?void 0:Ke.blockId)!=null?dt:"",ut=Ie.blocks[$e];if(ut)return!die.includes(ut.type)}return!0}),f=t.length===1,h=CF(),p=tf(),g=_e((ne=t[0])==null?void 0:ne.blockId,[]),_=O9((X=(Y=t[0])==null?void 0:Y.blockId)!=null?X:""),x=Im(),y=fg(g),b=Fs(hn(g==null?void 0:g.uuid).role,m.PermissionRole.COMMENTER),E=ht(),w=!E&&y&&b&&l,k=E&&y&&b&&x,C=sr(),T=Wc(),v=Xr(),I=w||k,j=iie(C),[D,S]=F.useState(0),R=F.useMemo(()=>{var dt,$e,ut;if(T||!f)return;const Ie=(dt=C.current)==null?void 0:dt.querySelector(`[data-block-id="${g==null?void 0:g.uuid}"]`),Ke=($e=C.current)==null?void 0:$e.getBoundingClientRect();if(Ie instanceof HTMLElement&&Ke){const Ee=Ie==null?void 0:Ie.getBoundingClientRect();return{left:Ee.left-((ut=Ke==null?void 0:Ke.left)!=null?ut:0),top:Ee.top-gie-pie}}},[g==null?void 0:g.uuid,T,f,C,j,D]);Ws();const A=Oo(Ie=>{var Ke;return(Ke=Ie.mindNodes[Ie.rootId])==null?void 0:Ke.childrenIds}),L=F.useMemo(()=>{if(t.length===0)return!1;const Ie=new Set(A);return!t.some(Ke=>Ie.has(Ke.blockId))},[A,t]);F.useEffect(()=>{f&&(g!=null&&g.uuid)&&setTimeout(()=>{S(Ie=>++Ie)},100)},[g==null?void 0:g.uuid,f]),F.useEffect(()=>{o!==void 0&&i(void 0)},[o]);const P=U9(t[0],a),[M,U]=F.useState(!1),V=F.useMemo(()=>t.every(Ie=>{const{role:Ke,isRestricted:dt}=hn(Ie.blockId);return dt?Ke===m.PermissionRole.EDITOR:Ke===m.PermissionRole.EDITOR||Ke===m.PermissionRole.WRITER}),[t]),W=Ie=>t.every(Ke=>{var $e;const dt=K.blocks[Ke.blockId];return!dt||Wr(($e=K.blocks[dt.parentId])==null?void 0:$e.type)?!1:Ie.includes(dt.type)});if(F.useEffect(()=>{const Ie=P==null?void 0:P.onSelectionChange.subscribe(()=>{U(!!(P.selection&&P.selection.length))});return()=>{U(!1),Ie==null||Ie.unsubscribe()}},[a,P,t]),M||T||v||t.length===0||f&&!R)return null;const z=!W(Xw)||!V,Q=(g==null?void 0:g.type)===m.BlockType.CODE,Z=Qm((oe=t[0])==null?void 0:oe.editorKey)||((ie=t[0])==null?void 0:ie.blockId)||"";if(s||u&&I)return f?r.jsx("div",{className:B("absolute bottom-7 h-[42px]",{"w-full":!R}),"data-no-cancel-selected":!0,style:R,children:r.jsx("div",{className:"w-full h-full flex justify-center",children:r.jsx("div",{className:"flex items-center h-full next-modal px-1 py-1",children:r.jsx(Ea,{className:"w-10 h-full",onClick:()=>{var Ie,Ke;p({blockId:(Ke=(Ie=t[0])==null?void 0:Ie.blockId)!=null?Ke:""})},children:r.jsx(H,{name:"IcMenuComment",size:"middle"})})})})}):null;const re=t.some(Ie=>{var Ke,dt;return[m.BlockType.CODE,m.BlockType.EQUATION].includes((dt=(Ke=K.blocks[Ie.blockId])==null?void 0:Ke.type)!=null?dt:0)});return r.jsx("div",{className:B("absolute bottom-7 h-[42px]",{"w-full":!R}),"data-no-cancel-selected":!0,style:R,children:r.jsx("div",{className:"w-full h-full flex justify-center",children:r.jsxs("div",{className:"flex items-center h-full next-modal px-1 py-1",children:[r.jsx(Fe,{delay:0,popupClass:"next-modal",disabled:z,className:"h-full",interactive:!0,maxWidth:1e3,theme:"none",animation:"shift-away",popup:r.jsx(DC,{onCloseModal:()=>{},blockId:(ge=(ue=t[0])==null?void 0:ue.blockId)!=null?ge:""}),children:r.jsx(Ea,{className:"w-10",disabled:z,children:r.jsx(H,{name:"IcMenuTurnInto",size:"large"})})}),r.jsx(Fe,{delay:0,popupClass:"next-modal",disabled:!P||re,className:"h-full",interactive:!0,maxWidth:1e3,theme:"none",animation:"shift-away",popup:P&&r.jsx(hie,{uuid:Z,model:P}),children:r.jsx(Ea,{className:"w-10",disabled:!P||re,children:r.jsx(H,{name:"IcMenuTextstyle",size:"large"})})}),r.jsx(Fe,{delay:0,disabled:Q,className:B("h-full",Q&&"pointer-events-none opacity-30"),popupClass:"next-modal",visible:o,interactive:!0,maxWidth:1e3,theme:"none",animation:"shift-away",popup:r.jsx(r.Fragment,{children:r.jsx("div",{onPointerDown:Ie=>{Ie.stopPropagation()},children:r.jsx(vx,{items:Dg,onColorSelect:Ie=>{i(!1),n(()=>{t.forEach(Ke=>{pe(Ke.blockId,{backgroundColor:Ie.isBgColor?Ie.colorkey:"",textColor:Ie.isBgColor?"":Ie.colorkey})})}),ce.event("node_color")},footer:L?r.jsx("div",{className:"w-full p-4",children:r.jsx("div",{className:"cursor-pointer flex items-center rounded justify-center h-8 text-t2 border border-grey5 text-center w-full",onClick:()=>{i(!1),n(()=>{t.forEach(Ie=>{var dt;const Ke=K.blocks[Ie.blockId];pe(Ie.blockId,{backgroundColor:"",textColor:"",data:{format:{mindMappingFormat:{...(dt=Ke==null?void 0:Ke.data.format)==null?void 0:dt.mindMappingFormat,nodeThemeColor:""}}}})})})},children:"跟随分支主题"})}):null})})}),children:r.jsx(Ea,{className:"w-9",children:r.jsx(mie,{blockId:(Ne=g==null?void 0:g.uuid)!=null?Ne:""})})}),r.jsx(Fe,{delay:0,popupClass:"next-modal",visible:o,className:"h-full",interactive:!0,maxWidth:1e3,theme:"none",popup:r.jsx(r.Fragment,{children:r.jsx("div",{className:"w-[240px]",onPointerDown:Ie=>{Ie.stopPropagation()},children:r.jsx(Ld,{className:"pb-2",header:"分支颜色",colors:H9,value:_,selectedIcon:r.jsx(H,{name:"IcSelectedSpace",className:"text-[18px] text-white"}),onSelect:Ie=>{i(!1),ce.event("node_theme"),n(()=>{t.forEach(Ke=>{var dt,$e;pe(Ke.blockId,{data:{format:{mindMappingFormat:{...($e=(dt=K.blocks[Ke.blockId])==null?void 0:dt.data.format)==null?void 0:$e.mindMappingFormat,nodeThemeColor:Ie}}}})})})},bgColorFn:ld})})}),children:r.jsx(Ea,{className:"w-9",children:r.jsx(H,{name:"IcMenuBranch",size:"middle",style:{color:f?ld(_):void 0}})})}),f&&r.jsx(Fe,{"data-no-cancel-selected":!0,popup:d?"":"上传图片（当前节点无法上传时，将创建同级节点上传）",className:"h-full",children:r.jsx(Ea,{className:"w-10",disabled:d,children:r.jsx(zN,{blockId:(De=t[0])==null?void 0:De.blockId,disabled:d,accept:"image/*,image/heic,image/heif",iconName:"IcMenuImage",onSuccess:async(Ie,Ke)=>{var Ee;const dt=await mp(Ie),$e=(Ee=t[0])==null?void 0:Ee.blockId;if(!$e)return;const ut=K.blocks[$e!=null?$e:""];ut&&n(()=>{var Ge,Je,et;if(ut.type!==m.BlockType.FILE)_s([$e],{type:m.BlockType.FILE,data:{display:"image",ossName:Ke,caption:(Ge=K.blocks[$e])==null?void 0:Ge.data.segments,...dt,size:Ie.size,segments:mt(Ie.name)}});else{if(h(c))return;Qe({type:m.BlockType.FILE,data:{display:"image",ossName:Ke,caption:[],...dt,size:Ie.size,segments:mt(Ie.name)}},{parentId:(et=(Je=K.blocks[$e])==null?void 0:Je.parentId)!=null?et:"",after:$e})}ce.event("node_image")})}})})}),f&&r.jsx(Fe,{popup:d?"":"上传附件(当前节点无法上传时，将创建同级节点上传)",className:"h-full",children:r.jsx(Ea,{className:"w-10",disabled:d,children:r.jsx(zN,{blockId:(Se=t[0])==null?void 0:Se.blockId,disabled:d,iconName:"IcBlockFile",onSuccess:async(Ie,Ke)=>{var Ee;const dt=await mp(Ie),$e=(Ee=t[0])==null?void 0:Ee.blockId;if(!$e)return;const ut=K.blocks[$e!=null?$e:""];ut&&n(()=>{var Ge,Je,et;if(ut.type!==m.BlockType.FILE&&ut.subNodes.length===0){_s([$e],{type:m.BlockType.FILE,data:{display:"file",ossName:Ke,caption:(Ge=K.blocks[$e])==null?void 0:Ge.data.segments,...dt,size:Ie.size,segments:mt(Ie.name)}}),ce.event("node_file");return}h(c)||(Qe({type:m.BlockType.FILE,data:{display:"file",ossName:Ke,caption:[],...dt,size:Ie.size,segments:mt(Ie.name)}},{parentId:(et=(Je=K.blocks[$e])==null?void 0:Je.parentId)!=null?et:"",after:$e}),ce.event("node_file"))})}})})}),r.jsx("div",{className:"h-full w-px bg-grey6 mx-1"}),r.jsx(Fe,{delay:0,popupClass:"next-modal",interactive:!0,maxWidth:1e3,theme:"none",className:"h-full",animation:"shift-away",popup:r.jsx(q9,{}),children:r.jsx(Ea,{className:"w-10 h-full",children:r.jsx(H,{name:"IcTitleMore",size:"middle"})})}),f&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-full w-px bg-grey6 mx-1"}),r.jsx(Ea,{className:"w-10 h-full",onClick:()=>{var Ie,Ke;p({blockId:(Ke=(Ie=t[0])==null?void 0:Ie.blockId)!=null?Ke:""})},children:r.jsx(H,{name:"IcMenuComment",size:"middle"})})]})]})})})},H9=wr.map(e=>({...e,name:""}));H9.unshift({key:"",name:""});const U_=60,xie=e=>{const t=Ws(),n=Xr(),s=sr();return F.useEffect(()=>{n||t.clearDropInfo()},[t,n]),F.useEffect(()=>{const a=fs(o=>{const i=s==null?void 0:s.current;if(!i||!!OS())return;const c=t.getState(),u=c.scale*.01,d=i.querySelectorAll("[data-block-id]");let f="";for(const h of d){const{blockId:p}=h.dataset;if(!p)continue;const g=c.mindNodes[p];if(g&&g.height&&(f=Fie(o,t,h,g,u),f))break}t.getState().rootId===f&&(f=void 0),c.hoverId!==f&&t.setHoverId(f)},32);return document.addEventListener("mousemove",a),()=>{document.removeEventListener("mousemove",a)}},[t,s,e.id]),null},Fie=(e,t,n,s,a)=>{const{blockId:o}=n.dataset,{direction:i}=t.getState(),l=yie(i,n,s,a);if(l&&bie(l,{x:e.clientX,y:e.clientY,width:1,height:1}))return o},yie=(e,t,n,s)=>{const a=t.getBoundingClientRect(),o=()=>({x:a.left,y:a.top+(n.height/2-n.regionHeight/2)*s,width:(n.width+U_)*s,height:n.regionHeight*s}),i=()=>({x:a.left-U_*s,y:a.top+(n.height/2-n.regionHeight/2)*s,width:(n.width+U_)*s,height:n.regionHeight*s}),l=()=>({x:a.left,y:a.top,width:n.width*s,height:(n.height+U_/2)*s});if(e===m.MindMappingType.LOGIC_DIAGRAM_LEFT)return o();if(e===m.MindMappingType.LOGIC_DIAGRAM_RIGHT)return i();if(e===m.MindMappingType.MIND_MAPPING)return n.dir==="right"||n.dir===void 0?o():i();if(e===m.MindMappingType.ORGANIZATION_STRUCTURE)return l()},bie=(e,t)=>e.x<=t.x+t.width&&t.x<=e.x+e.width&&e.y<=t.y+t.height&&t.y<=e.y+e.height,Eie=e=>{var g,_;const t=ae(x=>x.ui.selectedBlocks),n=(g=t[0])==null?void 0:g.blockId,s=Ym(n!=null?n:"",["left","top"]),a=F.useRef(null),o=wie(e.container),i=t.length===1,l=xn(),c=U9(t[0],l),u=fr(),d=F.useRef(!1),f=F.useRef();if(F.useEffect(()=>(i&&!o.current&&(f.current=setTimeout(()=>{var x;(x=a.current)==null||x.focus()},100)),()=>{clearTimeout(f.current)}),[o,i,n]),!i||!s)return null;const h=()=>{var y;if(!a.current)return;const{value:x}=a.current;if((x||d.current)&&c&&!c.readonly){Ye({$editingBlockId:n}),(y=a.current)==null||y.blur(),a.current.value="",c.performChange(E=>{E.select(0,c.content.length).applyFormat({underline:!1}).replace(x).collapse("end")});const b=nm(K.blocks[n!=null?n:""]);u(n,x.length,b?"caption":"segments")}};let p=s==null?void 0:s.top;return p!==void 0&&(p+=15),r.jsx("textarea",{"data-editor":n,ref:a,onCompositionUpdate:()=>{c!=null&&c.readonly||setTimeout(()=>{var y;const x=(y=a.current)==null?void 0:y.value;x&&(c==null||c.performChange(b=>{b.select(0,c.content.length).applyFormat({underline:!0}).replace(x)}))},0)},onCompositionStart:()=>{d.current=!0},onCompositionEnd:()=>{h(),d.current=!1},onChange:()=>{d.current||h()},onKeyDown:x=>{d.current&&be(["Backspace","Delete"],{byKey:!0})(x)&&x.stopPropagation()},className:"absolute opacity-0 hidden-textarea",style:{left:(_=s==null?void 0:s.left)!=null?_:"-9999px",top:p!=null?p:"-9999px"}})},wie=e=>{const t=F.useRef(!1);return F.useEffect(()=>{const n=e.current;if(!n)return;const s=()=>{setTimeout(()=>{t.current=!0},100)},a=()=>{t.current=!1};return n.addEventListener("focusin",s),n.addEventListener("focusout",a),()=>{n.removeEventListener("focusin",s),n.removeEventListener("focusout",a)}},[e]),t},kie=new Map([[0,{colorKey:""}],[1,{colorKey:Pe.grey}],[2,{colorKey:Pe.grey,isBgColor:!0}],[3,{colorKey:Pe.brown}],[4,{colorKey:Pe.brown,isBgColor:!0}],[5,{colorKey:Pe.orange}],[6,{colorKey:Pe.orange,isBgColor:!0}],[7,{colorKey:Pe.yellow}],[8,{colorKey:Pe.yellow,isBgColor:!0}],[9,{colorKey:Pe.red}]]),Cie=Array.from(Array(10)).map((e,t)=>{const n=kie.get(t);return{key:`mod+${t}`,isBgColor:n==null?void 0:n.isBgColor,colorKey:n==null?void 0:n.colorKey}}),Tie=()=>{const e=ke(),t=!!F.useContext(io);return F.useCallback(n=>{for(const s of Cie)be(s.key)(n)&&(n.preventDefault(),e(()=>{const a=bB(document.activeElement);if(t&&a){const o=a?nr(a):void 0;if(o&&o.selection&&!o.selection.isCollapsed){o.performChange(i=>{i.applyFormat({color:s.isBgColor?"":s.colorKey,backgroundColor:s.isBgColor?s.colorKey:""})});return}}if(K.ui.selectedBlocks.length>0){K.ui.selectedBlocks.forEach(o=>{pe(o.blockId,{backgroundColor:s.isBgColor?s.colorKey:"",textColor:s.isBgColor?"":s.colorKey})});return}if(a){const o=nr(a);o&&o.performChange(i=>{i.applyFormat({color:s.isBgColor?"":s.colorKey,backgroundColor:s.isBgColor?s.colorKey:""})})}}))},[t,e])},vie=()=>{const e=ke();return F.useCallback(t=>{var n,s;if(be("mod+shift+h")(t)){const a=localStorage.getItem(Yp);if(a&&a!=="undefined"){t.preventDefault();const o=JSON.parse(a),i=(s=(n=document.activeElement)==null?void 0:n.closest("[data-editor]"))==null?void 0:s.getAttribute("data-editor");if(i){const c=nr(i);c&&c.performChange(u=>{o.isBgColor?u.applyFormat({color:void 0,backgroundColor:o.colorkey}):u.applyFormat({backgroundColor:void 0,color:o.colorkey})});return}const l=Es(K.ui.selectedBlocks);e(()=>{let c=!1;l.forEach((u,d)=>{var f,h;if(d===0&&(o.isBgColor?c=o.colorkey===((f=K.blocks[u])==null?void 0:f.backgroundColor):c=o.colorkey===((h=K.blocks[u])==null?void 0:h.textColor)),c){pe(u,{backgroundColor:void 0,textColor:void 0});return}pe(u,{backgroundColor:o.isBgColor?o.colorkey:void 0,textColor:o.isBgColor?void 0:o.colorkey})})}),ee(nt.updateSelectBlocks([]))}}},[e])},Nie=()=>{const e=xn(),t=MF(),n=LF(),s=PF();return F.useCallback((a,o)=>{if(K.ui.selectedBlocks.length===0)return;const i=R0();if(o&&i)return;let l=!1;switch(!0){case be("mod+b")(a):case be("mod+u")(a):case be("mod+i")(a):case be("mod+e")(a):case be("mod+shift+s")(a):case be("mod+shift+x")(a):a.preventDefault(),l=!0;break}if(!l)return;const c=f=>{const h=e(f);h==null||h.performChange(p=>{p.select(0,h.content.length)})},u={},d=f=>{if(u[f])return;const h=K.blocks[f];h&&(Xt(h.type)||(u[f]=f,h.subNodes.forEach(d)))};switch(K.ui.selectedBlocks.forEach(f=>{o?u[f.blockId]=f.blockId:d(f.blockId)}),!0){case be("mod+b")(a):{Object.entries(u).forEach(([f,h])=>{c(f),t(f,"bold")});break}case be("mod+u")(a):{Object.entries(u).forEach(([f,h])=>{c(f),t(f,"underline")});break}case be("mod+i")(a):{Object.entries(u).forEach(([f,h])=>{c(f),t(f,"italic")});break}case be("mod+e")(a):{Object.entries(u).forEach(([f,h])=>{c(f),s(f)});break}case be("mod+shift+s")(a):{Object.entries(u).forEach(([f,h])=>{c(f),t(f,"lineThrough")});break}case be("mod+shift+x")(a):{Object.entries(u).forEach(([f,h])=>{c(f),n(f)});break}}return!0},[e,s,n,t])},Iie=["Enter","Tab","Shift+Tab","Space","mod+.","Shift+mod+.","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","mod+=","mod+-","mod+0","mod+z","mod+shift+z","mod+shift+h"],jie=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Space"],Die=()=>{const e=Hi(),t=Ws(),n=Ve(e),s=h3(),a=V9(),o=ke(),i=lh(),l=fr(),c=Vn(),u=Nie(),d=gt(),f=vie(),h=F.useRef(""),p=Tie(),g=F.useMemo(()=>$n(()=>{R0()||(h.current&&ye.closeMessage(h.current),h.current=ye.success(`切换为${wt.$pressedSpace?"编辑":"拖拽"}模式`),Ye({$pressedSpace:!wt.$pressedSpace}))},100),[]);return F.useCallback(_=>{var E,w,k,C,T;if(c===Tt.PAGE_HISTORY)return;const x=R0();if(d!==Kc()||(E=document.activeElement)!=null&&E.closest(".CodeMirror")||(w=document.activeElement)!=null&&w.closest(".latex-input-panel")||((k=document.activeElement)==null?void 0:k.closest("[data-is-comment]"))||Sie(_)||x&&be(jie)(_))return;if(be(Iie)(_)&&(_.stopPropagation(),_.preventDefault()),be("Shift+mod+.")(_)){a(),ce.event("node_fold",{from:1});return}else if(be("mod+=")(_)){t.zoomin();return}else if(be("mod+-")(_)){t.zoomout();return}else if(be("mod+0")(_)){t.zoom(100);return}else if(be("Enter")(_)){if(x){document.activeElement.blur();return}}else be("Space")(_)&&K.ui.selectedBlocks.length===0&&g();if(n)return;switch(f(_),p(_),!0){case be("mod+z")(_):{ee(Ad());break}case be("mod+shift+z")(_):{ee(Dm());break}}const b=(T=(C=K.ui.selectedBlocks[0])==null?void 0:C.blockId)!=null?T:"";if(K.ui.selectedBlocks.length===1)switch(!0){case be("Enter")(_):{if(b===e)return;o(()=>{var I,j;const v=i({parentId:(j=(I=K.blocks[b])==null?void 0:I.parentId)!=null?j:"",after:b},e);v&&ee(nt.updateSelectBlocks([{blockId:v,mindMapId:e}]))}),ce.event("node_new",{from:1});break}case be("Tab")(_):{if(!t.option.supportAppendChild(b))return;o(()=>{const I=i({parentId:b,last:!0},e);document.activeElement instanceof HTMLElement&&document.activeElement.blur(),I&&(ee(nt.updateSelectBlocks([{blockId:I,mindMapId:e}])),s(b,!0))}),ce.event("node_new",{from:1});break}case be("Shift+Tab")(_):{if(b===e)return;document.activeElement instanceof HTMLElement&&document.activeElement.blur(),o(()=>{var I,j;const v=i({parentId:(j=(I=K.blocks[b])==null?void 0:I.parentId)!=null?j:"",after:b},e);v&&(Ri([b],{parentId:v,last:!0}),ee(nt.updateSelectBlocks([{blockId:v,mindMapId:e}])))}),ce.event("node_new",{from:1});break}case be("Space")(_):{const v=nm(K.blocks[b]);l(b,-1,v?"caption":"segments");break}case be("mod+.")(_):{if(e===b)return;s(b),ce.event("node_fold",{from:1});break}}switch(u(_,!0)&&(_.stopPropagation(),_.preventDefault()),!0){case be("ArrowLeft")(_):{if(K.ui.selectedBlocks.length===0)return;const v=t.getNextNodeIdByArrowKeyboard("left",b);v&&ee(nt.updateSelectBlocks([{blockId:v,mindMapId:e}]));break}case be("ArrowUp")(_):{if(K.ui.selectedBlocks.length===0)return;const v=t.getNextNodeIdByArrowKeyboard("up",b);v&&ee(nt.updateSelectBlocks([{blockId:v,mindMapId:e}]));break}case be("ArrowRight")(_):{if(K.ui.selectedBlocks.length===0)return;const v=t.getNextNodeIdByArrowKeyboard("right",b);v&&ee(nt.updateSelectBlocks([{blockId:v,mindMapId:e}]));break}case be("ArrowDown")(_):{if(K.ui.selectedBlocks.length===0)return;const v=t.getNextNodeIdByArrowKeyboard("down",b);v&&ee(nt.updateSelectBlocks([{blockId:v,mindMapId:e}]));break}}},[i,p,t,l,f,e,d,c,n,u,g,a,s,o])},Sie=e=>{var s,a,o,i,l,c,u,d;const t=R0(),n=(a=(s=K.ui.selectedBlocks[0])==null?void 0:s.blockId)!=null?a:"";return!!(be("Enter")(e)&&t&&((o=K.blocks[n])==null?void 0:o.type)===m.BlockType.CODE||be(["Tab","Tab+shift"])(e)&&t&&(((i=K.blocks[n])==null?void 0:i.type)===m.BlockType.CODE||((l=K.blocks[n])==null?void 0:l.type)===m.BlockType.TABLE)||be("Enter")(e)&&!((c=document.activeElement)!=null&&c.closest(".hidden-textarea"))&&(((u=document.activeElement)==null?void 0:u.tagName)==="INPUT"||((d=document.activeElement)==null?void 0:d.tagName)==="TEXTAREA"))},p3=new Map,Eb=e=>p3.get(e),$9=(e,t)=>{p3.set(e,t)},G9=e=>{p3.delete(e)},z9=e=>{const t=K.blocks[e];return t?t.type===m.BlockType.FILE&&t.data.display==="image"?!0:[m.BlockType.TEXTAREA,m.BlockType.HEADER,m.BlockType.QUOTE,m.BlockType.TODO,m.BlockType.LIST,m.BlockType.ORDER_LIST,m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER,m.BlockType.MARK,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(t.type):!1},W9=(e,t,n)=>{Y9.put(iy(e.getState().rootId,n),t)},K9=(e,t)=>Y9.get(iy(e,t)),iy=(e,t)=>t?`embed_${e}`:e,Rie=(e,t)=>X9.get(iy(e,t)),Aie=(e,t,n)=>{X9.put(iy(e,t),n)},Y9=new jo(localStorage,"mindMap-scale",30),X9=new jo(localStorage,"mindMap-scroll",30);new jo(localStorage,"embed-mindMap-scale",30).clear();const Q9=F.forwardRef((e,t)=>{const n=F.useRef(null),s=F.useRef(null),a=sC(),o=gt(),i=sr(),{offsetX:l,offsetY:c}=lQ(),u=iQ(),d=Die();F.useImperativeHandle(t,()=>n.current,[]);const f=a*1/100,h=tC(),p=Ws(),g=F.useContext(ik),_=Lr(),x=km();F.useEffect(()=>{p.setLineColor(_?"#b8b8b8":"#000000")},[p,_]),F.useEffect(()=>{if(!(u!=null&&u.id))return;const b=i.current;if(!b)return;const E=$n(()=>{b.scrollTop!==0&&Aie(u.id,g,{left:b.scrollLeft,top:b.scrollTop})},500);return b.addEventListener("scroll",E),()=>{b.removeEventListener("scroll",E)}},[g,i,u==null?void 0:u.id]),F.useEffect(()=>{var b,E;if(h&&(u!=null&&u.id)){const w=(b=Rie(u==null?void 0:u.id,g))!=null?b:void 0;w&&((E=i.current)==null||E.scroll(w)),setTimeout(()=>{var k;w&&((k=i.current)==null||k.scroll(w))},500),w||(p.fitCenter(),setTimeout(()=>{p.fitCenter()},200))}},[p,h,g,u==null?void 0:u.id,i]),F.useEffect(()=>{if(!i.current)return;const b=i.current;b.style.cursor=x?"grab":""},[i,x]),F.useEffect(()=>{const b=o===e.id;if(!n.current)return;const E=b?document:n.current,w=k=>{k instanceof KeyboardEvent&&d(k)};return E.addEventListener("keydown",w,!0),()=>{E.removeEventListener("keydown",w,!0)}},[d,o,e.id]);let y;return u!=null&&u.regionWidth&&(y=(u==null?void 0:u.regionWidth)+100),r.jsx("div",{tabIndex:-1,ref:n,className:"w-full block-content ",children:r.jsx("div",{ref:s,className:"flex relative node-drawer w-full",style:{transformOrigin:"center",transform:`scale(${f},${f})`,left:l,top:c,width:y,height:(u==null?void 0:u.regionHeight)||void 0,opacity:h?void 0:0},children:e.children})})}),J9=()=>{const e=Ws();return Xr()?r.jsx("canvas",{className:"absolute left-[-150px] top-[-150px] touch-none",ref:n=>{n&&e.setDragCanvas(n)}}):null},Bie=()=>{const e=me();return F.useCallback(t=>{const n=t.target.closest("[data-block-id]");if(n instanceof HTMLDivElement&&!ht()&&n.dataset.blockId&&K.ui.selectedBlocks.length===0){const{blockId:s}=n.dataset;s&&ee(nt.updateSelectBlocks([{blockId:s,mindMapId:n.dataset.mindMapId}]))}if(t.currentTarget instanceof HTMLElement){const s=t.currentTarget.getBoundingClientRect();e.dropdown({placement:"bottom-start",popcorn:{getBoundingClientRect:()=>({...s,left:t.clientX,top:t.clientY,bottom:t.clientY+1,right:t.clientX+1,width:1,height:1})},content:({onCloseModal:a})=>K.ui.selectedBlocks.length>0&&!ht()?r.jsx(q9,{onItemClick:()=>{a()}}):r.jsx(Lie,{id:"",onItemClick:()=>{a()}})})}},[e])},Lie=e=>{const t=V9(),n=Ws(),s=[{type:$.OPERATION,data:{title:"画布放大",onClick:()=>{n.zoomin(),ce.event("zoomin",{from:2})},rightText:`${Gt}++`}},{type:$.OPERATION,data:{title:"画布缩小",onClick:()=>{n.zoomout(),ce.event("zoomout",{from:2})},rightText:`${Gt}+-`}},{type:$.OPERATION,data:{title:"重置缩放",onClick:()=>{n.zoom(100)},rightText:`${Gt}+O`}},{type:$.OPERATION,data:{title:"定位到中心节点",onClick:()=>{n.fitCenter()}}},{type:$.LINE,data:{},disableClick:!0},{type:$.OPERATION,data:{title:"折叠所有节点",onClick:()=>{t(),ce.event("node_fold",{from:2})},rightText:`${Gt}+Shift+.`}}];return r.jsx(ze,{className:"next-modal w-[260px] rounded py-2",items:s,onItemClick:()=>{e.onItemClick()}})},Pie=e=>{const t=Bie(),n=F.useRef(),s=km(),a=Vn();ig(e,{onResize:o=>{const i=e.current;if(i)switch(o.resizeStatus){case ra.START:n.current=!0,i.style.cursor="grab";break;case ra.RESIZING:n.current=!1,i.scrollBy(-o.deltaX,-o.deltaY);break;case ra.END:{s||(i.style.cursor="");break}}},buttonType:s?E2.leftClick:E2.rightCLick,dispatchEvent:!0}),F.useEffect(()=>{const o=e.current;if(!o)return;const i=c=>{c.preventDefault()},l=c=>{c.button===2&&n.current&&a!==Tt.PAGE_HISTORY&&(c.preventDefault(),t(c))};return o.addEventListener("contextmenu",i,!0),o.addEventListener("mouseup",l,!0),()=>{o.removeEventListener("mouseup",l,!0),o.removeEventListener("contextmenu",i,!0)}},[e,t,a])},Oie=(e,t)=>{const n=Ws(),s=Hi(),a=Vn();F.useEffect(()=>{if(!e.current||!t.current||!s)return;const o=e.current,i=t.current.querySelector(".node-drawer");if(!i)return;const{zoomin:l,zoomout:c}=n,u=p=>{if(p.ctrlKey||p.shiftKey)return p.preventDefault(),!1},f=fs(p=>{if(p.target instanceof Element){const g=p.target.closest(".mind-page");if(!g)return;if(g instanceof HTMLElement){if(g.dataset.mindPageId===s)if(p.ctrlKey){const _=n.getState().scale*.01;p.deltaY<0&&l(8),p.deltaY>0&&c(8);const x=n.getState().scale*.01;if(x!==_){const y=i.getBoundingClientRect(),b=p.clientX-(p.clientX-y.left)/_*x,E=p.clientY-(p.clientY-y.top)/_*x,w=y.left-b,k=y.top-E;requestAnimationFrame(()=>{o.scrollBy(w,k)})}}else if(p.shiftKey)requestAnimationFrame(()=>{o.scrollBy(p.deltaY,0)});else{const _=p.target.closest(".CodeMirror-scroll"),x=p.target.closest(".katex-display");if(_||x)return;requestAnimationFrame(()=>{o.scrollBy(p.deltaX,p.deltaY)})}return!0}}return!1},16),h=a===Tt.PAGE_HISTORY?Tr:GD;return qt.addEventListener("wheel",f,h),o.addEventListener("wheel",u,{capture:!0,passive:!1}),()=>{qt.removeEventListener("wheel",f),o.removeEventListener("wheel",u,{capture:!0})}},[t,n,s,a,e])},Mie=e=>{var i;const t=sr(),n=Ws(),s=Hi(),a=F.useRef(),o=F.useRef((i=t.current)==null?void 0:i.style.cursor);ig(e,{onResize:l=>{var u,d,f;const c=t.current;if(c)switch(l.resizeStatus){case ra.START:{o.current=(u=t.current)==null?void 0:u.style.cursor,a.current=!0,c.style.cursor="grabbing",(d=e.current)==null||d.focus({preventScroll:!0});break}case ra.RESIZING:{a.current=!1,c.scrollBy(-l.deltaX,-l.deltaY);break}case ra.END:{c.style.cursor=(f=o.current)!=null?f:"";break}}}}),F.useEffect(()=>{if(!t.current||!s)return;const l=t.current,{zoomin:c,zoomout:u}=n,d=p=>{if(p.ctrlKey||p.shiftKey)return p.preventDefault(),!1},h=fs(p=>{if(p.target instanceof HTMLElement){const g=p.target.closest(".embed-mind-page");if(!g)return;g instanceof HTMLElement&&g.dataset.mindPageId===s&&(p.ctrlKey?(p.deltaY<0&&c(8),p.deltaY>0&&u(8)):p.shiftKey&&requestAnimationFrame(()=>{l.scrollBy(p.deltaY,0)}))}return!1},16);return document.addEventListener("wheel",h,!0),l.addEventListener("wheel",d,{capture:!0,passive:!1}),()=>{document.removeEventListener("wheel",h,!0),l.removeEventListener("wheel",d,{capture:!0})}},[e,n,s,t])},Z9=()=>{const e=Ws();return r.jsx("canvas",{className:"absolute left-[-150px] top-[-150px] touch-none",ref:t=>{t&&e.setCanvas(t)}})},Uie=e=>r.jsxs("div",{className:"flex flex-col w-[370px] next-modal px-2.5 py-3.5",children:[r.jsx(xt,{autoFocus:!0,className:"h-8 rounded-sm",placeholder:e.placeholder,onChange:e.onChange,onEnter:e.onButtonClick}),r.jsx(je,{size:"large",colorType:"active",className:"mt-3.5 text-t4-medium",onClick:e.onButtonClick,children:"提交"})]}),Vie=e=>{const t=me(),n=ks(),s=F.useRef("");return r.jsx(uu,{readonly:e.readonly,defaultOpenPanel:e.defaultOpenPanel,onClick:a=>{t.dropdown({popcorn:a.currentTarget,placement:"bottom",content:({onCloseModal:o})=>r.jsx(Uie,{onButtonClick:()=>{var i;s.current.trim()&&((i=e.onButtonClick)==null||i.call(e,s.current.trim()),n(Ae.CREATE_WEB_BOOKMARK,We.advancedList),o())},placeholder:"https://www.example.com",onChange:i=>{s.current=i}})})},iconProp:{name:"IcUploadBookmark"},text:"添加网址书签",className:e.readonly?"cursor-default":"cursor-pointer"})},eP=e=>{if(!e.url)return r.jsx(Vie,{readonly:e.readonly,defaultOpenPanel:e.defaultOpenInputPanel,onButtonClick:e.onUrlInput});const t=!!e.title;return r.jsx("a",{className:"flex flex-row justify-between animate-hover border rounded pl-4 h-[89px] overflow-hidden",href:e.url,target:"_blank",rel:"noreferrer",children:e.loading?r.jsx(os,{}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:B("flex flex-col py-[15px] justify-center w-full"),children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("div",{className:`text-ellipsis ${t?"text-t2":"text-t2-bold"}`,children:e.title||mD(e.url)}),e.description&&r.jsx("div",{className:"mt-2 overflow-hidden text-t4 text-grey3 overflow-ellipsis",style:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},children:e.description})]}),r.jsxs("div",{className:"flex flex-row items-center mt-2",children:[e.icon&&r.jsx("img",{className:"w-4 h-4 mr-[6px]",src:e.icon}),r.jsx("span",{className:"text-t4 text-ellipsis",children:e.url})]})]}),e.cover&&r.jsx(lk,{loader:r.jsx(hs,{size:"middle"}),src:e.cover,className:"shrink-0 w-[calc(33.333%)] h-full self-center rounded-r-[3px] object-cover"})]})})},qie=(e,t,n)=>{const s=Xr(),a=ae(l=>l.ui.selectedBlocks.findIndex(c=>c.blockId===e)!==-1&&!s,{equalityFn:Cn}),o=Oo(l=>{var c;return((c=l.dropInfo)==null?void 0:c.parentId)===e});return F.useMemo(()=>fie(t,a||o,!1,n),[n,a,t,o])},Hie=(e,t,n)=>{const s=i_(),a=Oo(o=>{if(o.loading||s)return;const i=o.fixWidthRecord[t];if(i&&i.id!==e)return i.fixWidth});if(!s)return a||void 0},$ie=()=>{const e=Ws();return F.useCallback((t,n,s,a,o)=>{var i;e.updateMindNode({id:t.uuid,parentId:e.getState().rootId===t.uuid?"":t.parentId,childrenIds:!a&&M9.includes(t.type)?[]:t.subNodes.filter(l=>{var c;return((c=K.blocks[l])==null?void 0:c.type)!==m.BlockType.PDF_ANNOTATION}),expanded:(i=wt.$expandFoldRecord[t.uuid])!=null?i:!0,width:n,height:s,themeColor:o})},[e])},Gie=()=>{const e=gt();return ae(n=>{var s;return((s=n.blocks[e])==null?void 0:s.type)===m.BlockType.PAGE})},wb=20,WN=4,zie=e=>{const t=iu(e.id),n=Gie(),s=Ws(),a=Ym(e.id,["childrenIds","expanded","dir"]),o=Xr(),i=i_(),l=ae(w=>{const k=s.option.supportAppendChild(e.id);return w.ui.selectedBlocks.length===1&&!o&&k}),c=Hi(),{mindMapStyle:u}=o_(c),d=Oo(w=>w.hoverId===e.id),f=h3(),h=ke(),p=lh(),{width:g,height:_}=e;if(!a||i||!g||!_)return null;const x=!t&&d&&(a==null?void 0:a.childrenIds.length)!==0;let y,b=!1;if(t&&l&&!e.readonly)y=r.jsx(H,{name:"IcAddMindmap",className:"rounded-full cursor-pointer bg-white1",size:"middle",onClick:()=>{a.expanded||f(e.id),h(()=>{const w=p({parentId:e.id,last:!0},c);w&&ee(nt.updateSelectBlocks([{blockId:w,mindMapId:c}]))})}});else if(!a.expanded&&a.childrenIds.length>0)b=!0,y=r.jsx("div",{className:Yt("text-center px-1.5 text-t2-medium text-black rounded-[10px] border-[1.6px] border-black",{"cursor-pointer":!n}),onClick:()=>{n||(f(e.id),ce.event("node_fold",{from:3}))},children:r.jsx(ER,{blockId:e.id,mindMapId:c})});else if(x){let w="0deg";u===m.MindMappingType.LOGIC_DIAGRAM_RIGHT?w="180deg":u===m.MindMappingType.MIND_MAPPING?a.dir==="right"||a.dir===void 0?w="0deg":w="180deg":u===m.MindMappingType.ORGANIZATION_STRUCTURE&&(w="90deg"),y=r.jsx(H,{name:"IcNodeFold",className:Yt("rounded-full bg-white1"),size:"middle",style:{transform:`rotate(${w})`},onClick:()=>{f(e.id),ce.event("node_fold",{from:3})}})}if(!y||n&&!b)return null;const E=Wie(u);return E?r.jsx(E,{id:e.id,width:e.width,height:e.height,children:y}):null},Wie=e=>{switch(e){case m.MindMappingType.LOGIC_DIAGRAM_LEFT:return lE;case m.MindMappingType.LOGIC_DIAGRAM_RIGHT:return tP;case m.MindMappingType.MIND_MAPPING:return Kie;case m.MindMappingType.ORGANIZATION_STRUCTURE:return Yie;default:return null}},lE=e=>{const{containerStyle:t}=g3(e.id,e.width,e.height);return r.jsxs("div",{"data-no-cancel-selected":!0,className:"absolute",style:t,children:[r.jsx("div",{className:"bg-black h-[3px] w-[4px]"}),e.children]})},tP=e=>{const{containerStyle:t}=g3(e.id,e.width,e.height);return r.jsxs("div",{"data-no-cancel-selected":!0,className:"absolute",style:t,children:[e.children,r.jsx("div",{className:"bg-black h-[3px] w-[4px]"})]})},Kie=e=>{const t=Ym(e.id,["dir"]);return(t==null?void 0:t.dir)===void 0?r.jsx(lE,{...e}):t.dir==="right"||t.dir===void 0?r.jsx(lE,{...e}):r.jsx(tP,{...e})},Yie=e=>{const{containerStyle:t}=g3(e.id,e.width,e.height);return r.jsxs("div",{"data-no-cancel-selected":!0,className:"absolute",style:t,children:[r.jsx("div",{className:"bg-black h-[4px] w-[3px]"}),e.children]})},g3=(e,t,n)=>{const s=Hi(),a=Ym(e,["left","top","dir","width","height"]),{mindMapStyle:o}=o_(s),i={};if(!a)return{containerStyle:i};if(!t||!n)return{containerStyle:i};switch(o){case m.MindMappingType.LOGIC_DIAGRAM_LEFT:{i.display="flex",i.alignItems="center",i.left=a.left+t,i.top=a.top,i.height=n;break}case m.MindMappingType.LOGIC_DIAGRAM_RIGHT:{i.display="flex",i.alignItems="center",i.left=a.left-wb-WN,i.top=a.top,i.height=n;break}case m.MindMappingType.MIND_MAPPING:{i.display="flex",i.alignItems="center",i.top=a.top,i.height=n,a.dir==="right"||a.dir===void 0?i.left=a.left+t:i.left=a.left-wb-WN;break}case m.MindMappingType.ORGANIZATION_STRUCTURE:{i.display="flex",i.alignItems="center",i.flexDirection="column",i.left=a.left+a.width*.5-wb/2,i.top=a.top+a.height,i.height=n;break}}return{containerStyle:i}},KN=4,Xie=F.forwardRef((e,t)=>{var Q,Z;const{id:n,level:s,className:a,style:o,children:i,onDoubleClick:l,...c}=e,u=F.useRef(null),{width:d,height:f}=C8(u)||{},h=Ym(n,["id","left","top","themeColor"]),p=Ws(),g=Hi(),_=rQ(),x=$ie(),y=Ve(n),b=cie(n,e.level),E=km(),w=oQ(),k=iu(n),C=_e(n,["subNodes"]),T=ae(te=>{var re,ne,Y;return(Y=(ne=(re=te.blocks[n])==null?void 0:re.data.format)==null?void 0:ne.mindMappingFormat)==null?void 0:Y.nodeThemeColor}),v=Vn()===Tt.MAIN,I=Hie(n,s),j=fg(C),D=Fs(hn(C==null?void 0:C.uuid).role,m.PermissionRole.COMMENTER),S=ht(),R=Im(),P=!S&&j&&D&&v||S&&j&&D&&R,M=qie(n,s,P),U=i_();F.useImperativeHandle(t,()=>u.current,[]),F.useEffect(()=>{var te;U||_(n,g===n?"":(te=K.blocks[n])==null?void 0:te.parentId)},[_,g,n,U]);const V=d?d+KN:void 0,W=f?f+KN:void 0,z=s===0;return F.useEffect(()=>{U||C&&(!V||!W||x(C,V,W,z,T))},[x,C,V,W,U,z,T]),F.useEffect(()=>{if(!U)return;const te=V;te&&p.updateMindNode({id:n,reallyWidth:te})},[p,V,n,U]),Em(()=>{var te;(C==null?void 0:C.type)===((te=K.blocks[n])==null?void 0:te.type)&&(U||w(n))}),r.jsxs(r.Fragment,{children:[r.jsx("div",{"data-draggable":!y&&s!==0&&!E,"data-block-id":U?void 0:n,ref:u,"data-no-cancel-selected":!0,"data-mind-map-id":g,className:B("node-wrapper absolute max-w-[520px]",M,a),style:{left:(Q=h==null?void 0:h.left)!=null?Q:"-9999px",top:(Z=h==null?void 0:h.top)!=null?Z:"-9999px",...o,...b,width:I},onDoubleClick:te=>{y||(E&&ye.warning({content:"当前处于拖拽模式，无法进行编辑，可在左下角工具栏处切换回编辑模式",duration:3e3}),l==null||l(te))},onMouseDownCapture:te=>{y&&!P||(!k||K.ui.selectedBlocks.length>1)&&te.preventDefault()},onClickCapture:te=>{if(!(y&&!P)&&!(te.target instanceof Element&&!te.metaKey&&te.target.closest(".disable-select"))){if(E){te.preventDefault(),te.stopPropagation();return}if(!k||K.ui.selectedBlocks.length>1){if(te.preventDefault(),te.stopPropagation(),document.activeElement instanceof HTMLElement&&document.activeElement.blur(),te.metaKey){const re=K.ui.selectedBlocks.find(ne=>ne.blockId===n);ee(re?nt.removeSelectBlock(re):nt.addSelectBlock({blockId:n,mindMapId:g}));return}ee(nt.updateSelectBlocks([{blockId:n,mindMapId:g}]))}}},...c,children:r.jsxs("div",{className:"relative flex items-center w-full overflow-auto",children:[i,r.jsx(Zd,{className:"disable-select ml-1 mr-2",blockId:n})]})}),r.jsx(zie,{width:V,height:W,id:n,readonly:y})]})}),Or=zt.memo(Xie),ph=(e,t,n)=>{const s=F.useRef(!1),a=F.useRef(),o=tJ();F.useEffect(()=>{const i=e.current;if(!i)return;const l=()=>{a.current&&(clearTimeout(a.current),a.current=void 0)},c=()=>{l(),a.current=setTimeout(()=>{s.current=!0},500)},u=()=>{l(),s.current=!1},d=f=>{s.current||(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),o(t,f,n))};return i.addEventListener("dblclick",d),i.addEventListener("focusin",c),i.addEventListener("focusout",u),()=>{i.removeEventListener("focusin",c),i.removeEventListener("focusout",u),i.removeEventListener("dblclick",d)}},[t,e,o,n])},uo=e=>{const t=Ve(e.uuid),n=i_(),{uuid:s,...a}=e,o=n?`fixWidth${s}`:s;return r.jsx(co,{uuid:o,comments:!0,keydownOption:Ic,readonly:t,onKeyDown:i=>{be("Enter")(i)&&i.preventDefault()},...a})},Qie=zt.memo(e=>{var c;const{alwaysShowPlaceHolder:t,placeHolder:n}=Cm(e.id),s=Pr(e.id,"caption"),a=_e(e.id,["data","local"]),o=ke(),i=Ve(e.id),l=F.useRef(null);return ph(l,e.id,"caption"),F.useEffect(()=>{var u;a!=null&&a.data.link&&(a.data.linkInfo||a.data.cover||a.data.description||(u=a.data.icon)!=null&&u.value||a.data.headers||jc(a.data.link).then(d=>{if(!d)return;const f={link:d.link,linkInfo:mt(d.title),cover:d.cover,icon:{type:"http",value:d.icon},description:mt(d.description)};i?pe(a.uuid,{data:f},!0):o(()=>{pe(a.uuid,{data:f})})}))},[a,i,o]),a?r.jsx(Or,{id:e.id,level:e.level,ref:l,className:"min-w-[480px] px-0",children:r.jsxs("div",{className:"w-full",children:[r.jsx(uo,{placeholder:n,uuid:e.id,alwaysShowPlaceholder:t,className:"whitespace-pre-wrap break-words mx-2",segments:a.data.caption,segmentType:"caption",onChange:(u,d,f)=>{s(u,[d,f])}}),r.jsx(eP,{readonly:i,title:de(a.data.linkInfo),cover:a.data.cover,description:de(a.data.description),icon:(c=a.data.icon)==null?void 0:c.value,url:a.data.link,onUrlInput:u=>{jc(u).then(d=>{o(()=>{var f;pe(a.uuid,{data:{link:(f=d==null?void 0:d.link)!=null?f:u,linkInfo:mt(d==null?void 0:d.title),cover:d==null?void 0:d.cover,icon:{type:"http",value:d==null?void 0:d.icon},description:mt(d==null?void 0:d.description),headers:d==null?void 0:d.headerMap}})})})},defaultOpenInputPanel:!!a.local,loading:!1})]})}):null}),_3=e=>r.jsxs("div",{className:"flex flex-1",children:[r.jsx("div",{className:Yt("mr-1 flex items-start justify-center mt-[1.5px]",e.symbolClassName),children:e.symbol}),e.editorNode]}),Jie=(e,t)=>{const n=F.useRef(t);n.current=t,F.useEffect(()=>{const s=e.current;if(!s)return;const a=()=>{n.current(!0)},o=()=>{n.current(!1)};return s.addEventListener("focusin",a),s.addEventListener("focusout",o),()=>{s.removeEventListener("focusin",a),s.removeEventListener("focusout",o)}},[e])},gh=(e,t,n,s)=>{const[a,o]=F.useState(void 0),i=IV(e),l=Oo(c=>i?c.scale:1);return Jie(t,c=>{c&&i||Ye({$editingBlockId:c?e:void 0})}),F.useEffect(()=>{var d;if(!i){o(void 0);return}const c=l*.01,u=(d=t.current)==null?void 0:d.getBoundingClientRect().width;u&&o(u/c)},[t,i,l]),a||(n?s>1?"100px":"112px":void 0)},kb={disc:"•",circle:"◦",square:"▪"},Zie=zt.memo(e=>{const t=ae(({blocks:d})=>ele(e.id,d)),n=_e(e.id,["data"],["segments"]),s=of(e.level),a=Pr(e.id),o=F.useMemo(()=>!de(n==null?void 0:n.data.segments),[n==null?void 0:n.data.segments]),i=F.useRef(null),l=gh(e.id,i,o,e.level),{paddingLeft:c,paddingRight:u}=af(e.id,e.level);return n?r.jsx(Or,{id:e.id,ref:i,className:"flex items-center",level:e.level,style:{paddingLeft:`${c}px`,minWidth:l},children:r.jsx(_3,{symbol:r.jsx("div",{className:"pseudoBefore mr-1.5",style:{"--pseudoBefore--content":`"${t}"`}}),editorNode:r.jsx(uo,{placeholder:s,uuid:e.id,className:"whitespace-pre-wrap break-words self-start",segments:n.data.segments,onChange:(d,f,h)=>{a(d,[f,h])},style:{paddingRight:`${u}px`}})})}):null});function ele(e,t){var a;const n=mg(e,t,m.BlockType.LIST),s=(n==null?void 0:n.format)||(n==null?void 0:n.defaultFormat);return s&&(a=kb[s])!=null?a:kb.disc}const tle=zt.memo(e=>{const t=_e(e.id,["data"],["segments"]),n=of(e.level),s=Pr(e.id),a=Ve(e.id),o=F.useMemo(()=>!de(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),i=F.useRef(null),l=gh(e.id,i,o,e.level),{paddingRight:c}=af(e.id,e.level);return t?r.jsx(Or,{id:e.id,ref:i,className:"flex items-center",level:e.level,style:{paddingLeft:"4px",minWidth:l},children:r.jsx(jL,{childrenClassName:"w-full",id:e.id,readonly:a,className:"min-h-[10px] py-0",iconClassName:"mt-0.5 disable-select",onChange:u=>{BF({icon:u})},children:r.jsx(uo,{placeholder:n,uuid:e.id,className:"whitespace-pre-wrap break-words self-start",segments:t.data.segments,onChange:(u,d,f)=>{s(u,[d,f])},style:{paddingRight:`${c}px`}})})}):null}),nle=1e5,sle="text/plain",hxe="text/html",pxe="text/next-space-blocks",gxe="text/next-space-content",_xe="text/next-space-cells";var rle=(e=>(e.CUT="cut",e.COPY="copy",e))(rle||{});const YN=new WeakSet,nP=e=>{const t=Lr(),n=xn(),s=F.useRef(null),a=F.useRef(),o=tD(e),i=F.useRef(!1),l=Pl(`${e.id}_mock`),c=l,u=F.useRef(),d=F.useRef(NaN),f=Ve(e.id);F.useEffect(()=>{var E;const g=s.current;if(!g)return;const _=Qo(g,{value:de(o.current.segments),...e.maxHeight!=null?{}:{viewportMargin:1/0},...(E=e.noScrollbars)!=null&&E?{scrollbarStyle:"null"}:{},lineNumbers:!0,keyMap:"modified",theme:t?"ayu-dark":"default",autoRefresh:!0,highlightSelectionMatches:!0,matchTags:{bothTags:!0},matchBrackets:{strict:!0},extraKeys:{Tab(w){w.somethingSelected()&&w.indentSelection("add"),w.execCommand("insertSoftTab")}}});a.current=_;const x=n(l,!0);YN.has(x)||(Object.defineProperties(x,{content:{get(){return yn([eo(_.getValue())])}},revision:{get(){return _.changeGeneration()}},selection:{get(){const w=_.getDoc().indexFromPos(_.getCursor("anchor")),k=_.getDoc().indexFromPos(_.getCursor("head"));return VI(w,k)}},getBoundingClientRectOfRange:{value:(w,k)=>{const C=_.cursorCoords(_.getDoc().posFromIndex(w),"window"),T=_.cursorCoords(_.getDoc().posFromIndex(k),"window"),v=Math.min(C.left,T.left),I=Math.min(C.top,T.top),j=Math.max(C.left,T.left),D=Math.max(C.bottom,T.bottom);return new DOMRect(v,I,j-v,D-I)}},hitTest:{value:(w,k)=>{const C=_.coordsChar({left:w,top:k},"window");return _.getDoc().indexFromPos(C)}},scrollCaretIntoViewIfNeeded:{value:()=>{}},performChange:{value:w=>{w({load(k){i.current=!0,_.setValue(br(k)),i.current=!1},select(k=0,C=k,T=!1){const v=_.getDoc().posFromIndex(T?C:k),I=_.getDoc().posFromIndex(T?k:C);_.setSelection(v,I,{scroll:!1})},delete(){_.replaceSelection("")},insert(k){typeof k=="string"?_.replaceSelection(k):_.replaceSelection(br(k))}})}},requestFocus:{value:()=>{_.focus()}}}),YN.add(x)),d.current=_.changeGeneration(),x[Jm]=u,x[Pg]=d;let y=_.changeGeneration(),b=[x.content,x.selection];return _.on("beforeChange",()=>{i.current||_.isClean(y)&&(b=[x.content,x.selection])}),_.on("changes",w=>{var k,C;if(!i.current&&(y=w.changeGeneration(),d.current!==x.revision)){const T=[{type:m.TextType.TEXT,enhancer:{},text:w.getValue()}];u.current=T,(C=(k=o.current).onChange)==null||C.call(k,T,b),d.current=x.revision}}),()=>{Yk(l);const w=new Range;w.selectNodeContents(g),w.deleteContents()}},[n,c,l,o,e.maxHeight,e.noScrollbars,t]),F.useEffect(()=>{const g=a.current;g&&g.setOption("readOnly",f)},[f]),F.useEffect(()=>{const g=a.current;if(!g)return;const _=de(e.segments);_!==g.getValue()&&(i.current=!0,g.setValue(_),i.current=!1),u.current=e.segments},[e.segments]),F.useEffect(()=>{var x,y;const g=a.current;if(!g)return;const _=Qo.findModeByExtension((x=e.language)==null?void 0:x.toLocaleLowerCase())||LX(e.language);_&&(g.setOption("mode",(y=_.mime)!=null?y:_.mode),Qo.autoLoadMode(g,_.mode,BX))},[e.language]),F.useEffect(()=>{var _;const g=a.current;g&&g.setOption("lineWrapping",(_=e.wordWrap)!=null?_:!1)},[e.wordWrap]),F.useEffect(()=>{const g=N1(document,"_clearTextSelection").subscribe(()=>{const x=a.current;x&&(x.setSelection({line:0,ch:0},void 0,{scroll:!1}),typeof x.state.selectingText=="function"&&x.state.selectingText())}),_=N1(document,"selectionchange").subscribe(()=>{const x=a.current;if(!x)return;const y=document.getSelection();y&&$p(y.focusNode)!=null&&x.setSelection({line:0,ch:0},void 0,{scroll:!1})});return()=>{g.unsubscribe(),_.unsubscribe()}},[]);const h=EB(c),p=wB(c);return r.jsx("div",{ref:s,"data-disable-select":!0,"data-editor":c,className:B(e.className,"w-full code-mirror",gn({selectors:{"& div.CodeMirror-gutters":{background:"transparent !important"},"& div.CodeMirror":{minHeight:"24px",height:"100%",maxHeight:e.maxHeight?`${e.maxHeight}px`:void 0,background:"transparent",fontSize:"14px",color:"var(--black)",padding:e.padding?e.padding:e.noScrollbars?"8px":"24px"},"& .CodeMirror-cursor":{borderLeftWidth:"1px !important",display:f?"none !important":void 0},"& .CodeMirror-selected":{background:"var(--selection) !important"},"& .CodeMirror-focused .CodeMirror-selected":{background:"var(--selection) !important"},"& .CodeMirror-line::selection, & .CodeMirror-line > span::selection, & .CodeMirror-line > span > span::selection":{background:"var(--selection) !important"},"& .CodeMirror pre.CodeMirror-line, & .CodeMirror pre.CodeMirror-line-like":{fontFamily:'SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace'}}})),onPasteCapture:g=>{g.clipboardData.getData(sle).length>nle&&(g.preventDefault(),ye.warning("内容过大。以防数据丢失，请改用文件形式上传"))},onKeyDownCapture:g=>{var x,y;const _=a.current;if(_){if(be("mod+a")(g)){const b=n(c,!1);if(!b)return;const{selection:E}=b;if(!E||E.length===b.content.length)return;g.stopPropagation(),_.execCommand("selectAll")}be("ArrowUp")(g)?(x=Zr(c))!=null&&x.isFirstLine&&h(g.nativeEvent):be("ArrowDown")(g)&&(y=Zr(c))!=null&&y.isLastLine&&p(g.nativeEvent)}}})},XN=90,ale=zt.memo(e=>{var S,R,A,L,P,M;const{id:t}=e,n=!1,s=Pr(t),a=ke(),o=_e(t,["textColor","data"],["segments","format","description"]),i=Ve(t),l=Vn(),[c=!0,u]=cu(t),[d,f]=F.useState(!1),h=F.useRef(null),p=Ba(h.current,"height"),{onRenderSize:g,changeSize:_,containerWidth:x,containerRef:y,isDisable:b,defaultHeight:E}=zi({id:t,root:n,defaultHeight:(S=o==null?void 0:o.data.format)==null?void 0:S.height,fullPageContentWidth:!0,resizeWidth:!1}),[w,k]=F.useState(!E);if(!o)return null;const C=(L=(A=(R=o.data.format)==null?void 0:R.language)!=null?A:hg())!=null?L:Om,T=(M=(P=o.data.format)==null?void 0:P.codeWrap)!=null?M:!0,v=()=>{a(()=>{var U;(U=o.data.format)!=null,pe(t,{data:{format:{codeWrap:!T}}})})},I=U=>{a(()=>{pe(o.uuid,{updatedAt:Date.now(),data:{description:mt(U)}})})},j=pt.print||c,D=de(o.data.description);return r.jsx(Or,{id:e.id,className:"group !bg-grey8",level:e.level,ref:y,children:r.jsxs("div",{className:"w-full",children:[r.jsxs("div",{className:"disable-select h-10 flex items-center text-t2 justify-between px-2 overflow-x-auto",children:[r.jsxs("div",{className:"flex items-center text-ellipsis flex-shrink-0",children:[r.jsx(H,{name:"IcToggleGrey",size:"middle",className:B("text-grey3 mr-1 animate-hover transition-transform rotate-90",!j&&"rotate-0"),onClick:()=>u(!j)}),d?r.jsx(xt,{autoFocus:!0,showBorder:!1,readonly:i,className:"h-7 w-full rounded-sm",inputClassName:"px-0.5 text-t2 h-7",placeholder:"请输入代码块名称",value:D,onBlur:()=>{d&&f(!1)},onChange:I}):r.jsx("div",{className:B("animate-hover text-black text-ellipsis w-full px-0.5 min-w-[30px] h-[22px] group-hover:opacity-100 transition-opacity",!D&&"text-grey4 opacity-0"),onClick:U=>{i||(U.preventDefault(),U.stopPropagation(),f(!0))},children:D||(i?"":"请输入代码块名称")})]}),r.jsxs("div",{className:"transition-opacity opacity-0 group-hover:opacity-100 flex items-center flex-shrink-0 text-t2 text-grey3 ml-2",children:[r.jsx(ole,{className:"h-7",value:C,readonly:i,onChange:U=>{a(()=>{var W;Nn(Bx,U);const V=(W=o.data.format)!=null?W:{};pe(t,{data:{format:{...V,language:U}}})})}}),!i&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-4 w-px bg-grey4 mx-2.5"}),r.jsxs("div",{className:"flex items-center h-7 px-1 animate-hover",onClick:v,children:[r.jsx(H,{name:"IcCode",size:"middle",className:"mr-1"}),"自动换行",T?"开启":"关闭"]}),r.jsx("div",{className:"h-4 w-px bg-grey4 mx-2.5"})]}),r.jsxs("div",{className:B("h-7 px-1 animate-hover flex items-center",l===Tt.NOTIFICATION&&"hidden"),onClick:()=>{on(de(o.data.segments),{message:"已复制代码"})},children:[r.jsx(H,{size:"middle",className:"mr-1",name:"IcMenuCopy"}),r.jsx("span",{children:"复制"})]})]})]}),j&&r.jsx(Wi,{resizeHeight:!0,readonly:i||b,defaultBlockFullWidth:!0,resizeWidth:!1,maxWidth:x,minHeight:XN,defaultWidth:x,defaultHeight:E||p.height||XN,onChange:_,onRenderSize:g,onKeyDownMoveBar:()=>{k(!1)},onKeyUpMoveBar:()=>{k(!E)},className:B("flex relative z-0 max-[520px] group border-t border-grey6",b&&"pointer-events-none",w&&"!h-full"),children:r.jsx("div",{className:B("h-full",E&&"overflow-y-auto"),children:r.jsx("div",{ref:h,className:B(E&&"h-full"),children:r.jsx(nP,{className:B("pb-4",E&&"h-full"),id:t,noScrollbars:l===Tt.NOTIFICATION,maxHeight:l===Tt.NOTIFICATION?150:void 0,padding:"0px",language:C,wordWrap:T,segments:o.data.segments,onChange:(U,V)=>{s(U,V)}})})})})]})})}),ole=({className:e,value:t,onChange:n,readonly:s})=>{const a=d0.map(o=>({title:o,value:o}));return a.sort(hr(o=>o.title,I1)),r.jsx(Uo,{SelectView:oC,enableSearch:!0,readonly:s,className:e,options:a,value:t,onChange:n})},ile=e=>{const t=F.useRef(!1),n=F.useRef();n.current=e,F.useEffect(()=>{const o=()=>{var i;t.current&&((i=n.current)==null||i.call(n))};return window.addEventListener("blur",o),()=>{window.removeEventListener("blur",o)}},[]);const s=F.useCallback(()=>{t.current=!0},[]),a=F.useCallback(()=>{window.focus(),t.current=!1},[]);return{onMouseOver:s,onMouseOut:a}},lle=zt.memo(e=>{const t=_e(e.id,["data"],["link"]);return t!=null&&t.data.link?r.jsx(cle,{id:e.id,level:e.level}):r.jsx(ule,{id:e.id,level:e.level})}),cle=({id:e,level:t})=>{var L;const n=t===0,s=Hi(),[a,o]=F.useState(!0),[i,l]=F.useState(!1),c=F.useRef(setTimeout(()=>{})),u=_e(e,["data"],["segments","caption","link"]),{alwaysShowPlaceHolder:d,placeHolder:f}=Cm(e,{defaultPlaceholder:"输入文字"}),h=Pr(e,"caption"),p=iu(e),g=Ve(e),_=F.useRef(null),[x,y]=F.useState(""),b=F.useMemo(()=>{const{website:P,url:M}=ZE(x);return P?P===mr.music163&&M.includes("?type=2")?{resizeHeight:!1,defaultHeight:86}:{}:{}},[x]),{onMouseOver:E,onMouseOut:w}=ile(()=>{p||K.ui.selectedBlocks.length>=1||ee(nt.updateSelectBlocks([{blockId:e,mindMapId:s}]))}),{onRenderSize:k,changeSize:C,containerRef:T,isDisable:v,defaultWidth:I,defaultHeight:j,defaultBlockFullWidth:D,widthBreakPoints:S}=zi({id:e,defaultWidth:500,defaultHeight:400,root:n});ph(T,e,"caption"),F.useEffect(()=>{var P;jc((P=u==null?void 0:u.data.link)!=null?P:"",!0).then(M=>{y((M==null?void 0:M.link)||(u==null?void 0:u.data.link)||"")})},[u==null?void 0:u.data.link]);const R=F.useCallback(()=>{var P;on((P=u==null?void 0:u.data.link)!=null?P:"")},[u==null?void 0:u.data.link]),A=F.useCallback(()=>{_.current&&(_.current.src="",o(!0),l(!1),c.current=setTimeout(()=>{l(!0)},1e4),_.current.src=x)},[x]);return F.useEffect(()=>{Za(1e3).then(()=>{l(!1)}),c.current=setTimeout(()=>{l(!0),o(!1)},1e4)},[]),F.useEffect(()=>{var P;(P=_.current)==null||P.addEventListener},[]),u?r.jsx(Or,{id:e,ref:T,level:t,children:r.jsxs("div",{className:"w-[520px] px-3",children:[r.jsx(uo,{placeholder:f,uuid:e,alwaysShowPlaceholder:d,className:"whitespace-pre-wrap break-words",segments:(L=u.data.caption)!=null?L:[],segmentType:"caption",onChange:(P,M,U)=>{h(P,[M,U])}}),r.jsxs(Wi,{resizeHeight:!0,resizeWidth:!0,widthBreakPoints:S,readonly:g,doubleResize:n,defaultWidth:I||Da,defaultHeight:j,defaultBlockFullWidth:D,maxWidth:Da,minWidth:36,minHeight:80,outerLayoutClassName:"w-full",className:"w-full",onChange:C,onRenderSize:k,...b,children:[i&&!a&&r.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full cursor-pointer bg-grey8",onClick:A,children:[r.jsx($s,{emojiStr:"🕸️",iconSize:70,className:"mb-2 pointer-events-none"}),r.jsx("div",{className:"text-grey4 text-t2",children:"网页加载失败，点击刷新"})]}),!i&&a&&r.jsx(os,{}),r.jsxs("div",{className:"w-full h-full",children:[p&&r.jsxs("div",{onClick:R,className:B("flex absolute top-2.5 right-3 z-10 cursor-pointer bg-black/75 opacity-0 group-hover:opacity-100 text-white1 transition-opacity text-t4 px-1 py-0.5 rounded-sm animate-click items-center"),children:[r.jsx(H,{name:"IcUrl",className:"mr-1",size:"middle"}),r.jsx("span",{children:"复制链接"})]}),r.jsx("div",{className:"relative w-full h-full overflow-hidden",onMouseOver:E,onMouseOut:w,children:r.jsx("iframe",{referrerPolicy:"origin",allowFullScreen:!0,className:B("w-full h-full absolute inset-0",v&&"pointer-events-none",{hidden:i}),ref:_,src:x,sandbox:"allow-scripts allow-popups allow-top-navigation-by-user-activation allow-forms allow-same-origin",onLoad:()=>{clearTimeout(c.current),l(!1),o(!1)}})})]})]})]})}):null},ule=({id:e,level:t})=>{var p;const n=_e(e,["data","local"],["link","embedType"]),s=me(),[a,o]=F.useState(!1),i=F.useRef(""),l=ke(),c=Ve(e),u=n==null?void 0:n.data.embedType,d=u?(p=Zk()[u])==null?void 0:p.data:null;F.useEffect(()=>{n&&n.local&&n.data.link&&(pe(e,{local:!1},!0),f(n.data.link))},[]);const f=F.useCallback(async g=>{if(!g.trim())return;o(!0);const _=await jc(g,!0);l(()=>{var x;((x=_==null?void 0:_.headerMap)==null?void 0:x["X-Frame-Options"])!==void 0&&(_.headerMap["X-Frame-Options"].toLocaleLowerCase()==="allow"||_.headerMap["X-Frame-Options"]==="")&&_.link.match(/(https):\/\/([\w.]+\/?)\S*/gi)&&!kA(_.link)?pe(e,{data:{link:g}}):pe(e,{type:m.BlockType.BOOKMARK,data:{link:g,linkInfo:mt(_==null?void 0:_.title),cover:_==null?void 0:_.cover,icon:{type:"http",value:_==null?void 0:_.icon},description:mt(_==null?void 0:_.description),headers:_==null?void 0:_.headerMap}})}),o(!1)},[e,l]),h=F.useCallback(g=>{a||s.dropdown({popcorn:g.currentTarget,placement:"bottom",content:({onCloseModal:_})=>r.jsxs("div",{className:"flex flex-col w-[370px] next-modal px-2.5 py-3.5",children:[r.jsx(xt,{autoFocus:!0,className:"h-8 rounded-sm",placeholder:d?d.placeholder:"https://www.example.com",onChange:x=>i.current=x,onEnter:()=>{f(i.current),_()}}),r.jsx(je,{size:"large",colorType:"active",className:"mt-3.5 text-t4-medium",onClick:()=>{f(i.current),_()},children:"提交"})]})})},[d,a,s,f]);return r.jsx(Or,{id:e,level:t,className:"max-w-[380px]",children:r.jsx(uu,{readonly:c,iconElement:d&&r.jsx("img",{src:d.image,className:"w-6 h-6"}),defaultOpenPanel:!!(n!=null&&n.local&&!n.data.link),iconProp:{name:"IcUploadWeb"},text:a?"正在嵌入内容...":d?`嵌入${d.title}`:"添加嵌入内容",onClick:h,className:c?"cursor-default":"cursor-pointer"})})},dle=zt.memo(e=>{const t=_e(e.id,["data","local"],["segments"]),n=ke(),s=Ve(e.id),a=F.useMemo(()=>de(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]);return F.useEffect(()=>{e.id&&pe(e.id,{local:!1},!0)},[e.id,n]),t?r.jsx(Or,{id:e.id,className:"min-w-[112px] px-2",level:e.level,children:r.jsx(iC,{readonly:s,content:a,onChange:o=>{const i=mt(o);n(()=>{pe(e.id,{data:{segments:i}})})},defaultOpenPanel:!!t.local})}):null}),x3=zt.memo(e=>{var U,V,W,z;const t=(U=e.ownerBlockId)!=null?U:e.id,n=_e(e.id,["data"],["caption","ossName","format","width","height","size"]),s=ah(),a=iu(e.id),o=sf({uuid:e.id}),i=Pi(t),l=Ve(t),{alwaysShowPlaceHolder:c,placeHolder:u}=Cm(e.id),d=XF(),f=gt(),h=tf(),{role:p}=it(f),{onRenderSize:g,changeSize:_,containerRef:x,isDisable:y,defaultWidth:b,defaultHeight:E,defaultBlockFullWidth:w,widthBreakPoints:k,containerWidth:C}=zi({id:t,root:!1,fullPageContentWidth:!1}),{formatUrl:T,loading:v,loadingCalcSize:I,srcSetParams:j,url:D,imageLink:S}=qC(e.id,{containerWidth:C,defaultWidth:b});ph(x,e.id,"caption");const R=MR(e.id),A=(i==null?void 0:i.status)===Yn.failure||!vd(T)&&!T.startsWith("blob")&&!T.endsWith("=")&&T,L=Pr(e.id,"caption");if(!n)return null;const P=Q=>{const Z=Q.getBoundingClientRect();o({getBoundingClientRect:()=>Z},"bottom",[0,-(Z.height*.6)])},M=()=>{x.current&&P(x.current)};return r.jsx(Or,{id:t,level:e.level,ref:x,children:r.jsxs("div",{className:"w-min px-3",children:[((W=(V=n.data.format)==null?void 0:V.isShowCaption)!=null?W:!0)&&r.jsx(uo,{placeholder:u,uuid:e.id,alwaysShowPlaceholder:c,className:"whitespace-pre-wrap break-words",segments:n.data.caption,segmentType:"caption",onChange:(Q,Z,te)=>{L(Q,[Z,te])},style:R}),A?r.jsx(vL,{onClick:Q=>{P(Q.currentTarget)}}):r.jsxs(Wi,{fullHeight:!0,resizeWidth:!0,readonly:l||y,defaultWidth:b!=null?b:200,defaultHeight:E,defaultBlockFullWidth:w,maxWidth:500,maxHeight:200,widthBreakPoints:k,minHeight:36,minWidth:36,onChange:_,onRenderSize:g,className:B("max-[520px]",y&&"pointer-events-none",pt.print&&"my-2.5"),children:[v?r.jsx(os,{style:{height:I.height,width:(z=n.data.format)!=null&&z.blockFullWidth?"100%":I.width,maxWidth:"100%"}}):r.jsx(JF,{className:B("w-full ",{"preview-file cursor-[zoom-in]":a||l}),onClick:Q=>{(a||l)&&s({uuid:e.id,src:Q.target.src})},blockId:e.id,srcSetParams:j,formatUrl:T,url:D,maxWidth:C,imageLink:S}),a&&!l&&!e.ownerBlockId&&r.jsx(TL,{blockId:t,onReplace:M,onDownload:()=>d(e.id),onAddComment:Fs(p,m.PermissionRole.COMMENTER)?()=>{h({blockId:e.id})}:void 0,externalLink:!1})]})]})})}),F3=()=>r.jsx("div",{className:"flex items-center animate-spin",children:r.jsx(H,{name:"IcNaviLoading",size:"middle",style:{fill:"white"}})}),fle=zt.memo(e=>{var b,E;const t=(b=e.ownerBlockId)!=null?b:e.id,n=_e(e.id,["data"],["caption","width","link"]),{alwaysShowPlaceHolder:s,placeHolder:a}=Cm(e.id),o=Ve(t),i=Pr(e.id,"caption"),{url:l}=Vi(e.id),c=Pi(e.id),{onRenderSize:u,changeSize:d,containerWidth:f,containerRef:h,isDisable:p,defaultBlockFullWidth:g,defaultWidth:_,defaultHeight:x,widthBreakPoints:y}=zi({id:t,root:!1,fullPageContentWidth:!1});return ph(h,e.id,"caption"),n?r.jsx(Or,{id:t,level:e.level,ref:h,className:"max-w-[380px]",children:r.jsxs("div",{className:"w-min px-3",children:[r.jsx(uo,{placeholder:a,uuid:e.id,alwaysShowPlaceholder:s,className:"whitespace-pre-wrap break-words",segments:n.data.caption,segmentType:"caption",onChange:(w,k,C)=>{i(w,[k,C])}}),r.jsxs(Wi,{fullHeight:!0,resizeWidth:!0,readonly:o||p,disableStyle:!_,defaultWidth:_!=null?_:0,defaultHeight:x,defaultBlockFullWidth:g,maxWidth:(E=n.data.width)!=null?E:Da,widthBreakPoints:y,minHeight:36,minWidth:36,onChange:d,onRenderSize:u,className:B("max-[520px]",p&&"pointer-events-none",pt.print&&"my-2.5"),children:[l&&r.jsx(Vk,{videoUrl:l,style:{width:f,cursor:"pointer"},options:{fluid:!0,poster:`${l}&x-oss-process=video/snapshot,t_10000,f_jpg,w_800`}}),(c==null?void 0:c.progress)&&r.jsxs("div",{className:"absolute flex items-center px-1.5 right-2.5 top-2.5 rounded-sm bg-black/75",children:[r.jsx(F3,{}),r.jsxs("div",{className:"text-white text-t4",children:[c==null?void 0:c.progress,"%"]})]}),(n==null?void 0:n.data.link)&&r.jsx("div",{className:"absolute flex items-center top-2.5 right-2.5 bg-black/75 group-hover:opacity-100 opacity-0 rounded-sm",children:r.jsx(H,{size:"middle",className:"",name:"IcUploadWeb",style:{color:"white"}})})]})]})}):null}),mle=F.memo(e=>{const t=_e(e.id,["data","local"],["display"]);if(!t)return null;switch(t.data.display){case"image":return r.jsx(x3,{id:t.uuid,level:e.level});case"file":return r.jsx(QN,{id:t.uuid,level:e.level});case"video":return r.jsx(fle,{id:t.uuid,level:e.level});default:return r.jsx(QN,{id:t.uuid,level:e.level})}}),QN=F.memo(e=>{const t=hh(),n=_e(e.id,["data","local"],["segments","ossName","size","caption"]),s=Pr(e.id,"caption"),a=de(n==null?void 0:n.data.segments),{extName:o}=sn(a),i=pa(o),l=es(n==null?void 0:n.data.size),c=iu(e.id),{alwaysShowPlaceHolder:u,placeHolder:d}=Cm(e.id),f=Ve(e.id),h=F.useRef(null);ph(h,e.id,"caption");const p=_=>{const x=ht();Hr.pdf.test(o)?window.open(`/${x?"share/":"preview/"}${_}`):t(_,e.ownerBlockId)};if(!n)return null;const g=r.jsxs(r.Fragment,{children:[r.jsx(tn,{trigger:!1,className:"mr-1 self-center",blockId:e.id,iconSize:18,defaultIcon:r.jsx(H,{size:"middle",name:i})}),r.jsxs("div",{className:"flex max-w-full",children:[r.jsxs("div",{className:"relative w-full text-t1-medium text-ellipsis",children:[a,r.jsx("span",{className:"absolute bottom-px left-0 h-px bg-grey5 w-full"})]}),r.jsx("span",{className:"ml-2 text-t4 self-center mt-1 text-grey3 flex-shrink-0",children:l})]})]});return r.jsx(Or,{id:e.id,level:e.level,ref:h,children:r.jsxs("div",{className:"w-full px-3",children:[r.jsx(uo,{placeholder:d,uuid:e.id,alwaysShowPlaceholder:u,className:"whitespace-pre-wrap",segments:n.data.caption,segmentType:"caption",onChange:(_,x,y)=>{s(_,[x,y])}}),r.jsx("div",{className:B("pl-0.5 group leading-9 flex justify-between items-center h-9",{"animate-hover":c||f}),children:pt.print?r.jsx("a",{href:`${window.location.origin}/preview/${e.id}`,className:"pr-10  text-ellipsis flex w-full cursor-pointer",children:g}):r.jsx("div",{className:B("preview-file pr-10 text-ellipsis flex w-full",{"cursor-pointer":c||f}),onClick:()=>{(c||f)&&p(e.id)},children:g})})]})})}),ly=F.memo(e=>{const t=F.useMemo(()=>mt(Ya(e.id)),[e.id]);return r.jsx(Or,{id:e.id,level:e.level,children:r.jsx(uo,{uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t,readonly:!0})})}),hle=zt.memo(e=>{const t=_e(e.id,["data"],["segments"]),n=of(e.level),s=Pr(e.id),a=F.useMemo(()=>!de(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),o=F.useRef(null),i=gh(e.id,o,a,e.level),{paddingLeft:l,paddingRight:c}=af(e.id,e.level),u=ae(d=>{const{blocks:f}=d;return NC(e.id,f)},{equalityFn:Cn});return t?r.jsx(Or,{id:e.id,ref:o,className:"flex items-center",level:e.level,style:{paddingLeft:"12px",minWidth:i},children:r.jsx(_3,{symbolClassName:"mt-0",symbol:r.jsx("div",{className:"text-center inline-block dot mr-1.5",children:u}),editorNode:r.jsx(uo,{placeholder:n,uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t.data.segments,onChange:(d,f,h)=>{s(d,[f,h])},style:{paddingRight:`${c}px`}})})}):null}),Cb=e=>{const{id:t,ownerBlockId:n,illegal:s}=e,a=!!F.useContext(io),o=Rl(t),i=r.jsx("div",{className:"flex line-clamp-1",children:r.jsxs("div",{className:"relative w-full text-t1-medium text-ellipsis",children:[s?bj:e.title,r.jsx("span",{className:"absolute bottom-px left-0 h-px bg-grey5 w-full"})]})});return r.jsxs("div",{className:Yt("group relative py-1 flex items-center w-full px-0.5 animate-hover",{"max-w-[380px] pr-4":a}),contentEditable:!1,onClick:e.onClick,children:[r.jsx(tn,{trigger:!n,iconSize:20,className:"mr-1",tooltipClassName:"flex-shrink-0",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(as,{uuid:t})}),pt.print?r.jsx(pc,{to:o,children:i}):i]})},cy=e=>{const{blockType:t,desc:n,hasCover:s,title:a,small:o}=e;return r.jsxs("div",{className:B("w-[40%] overflow-hidden",o?"mt-3 ml-3 pr-3":"mt-6 ml-4 pr-2"),children:[r.jsx("div",{className:B("text-ellipsis text-t1-bold text-black break-words",{"text-white":s}),children:a||Ot(t)}),r.jsx("div",{className:B("mt-1 text-t4 break-words text-black/60",{"text-white":s,"line-clamp-2":o}),children:n})]})},A0="text-t4 text-black/60 break-words mt-1 line-clamp-4 leading-5",uy=(e,t)=>{var o;const n=La(),s=ae(i=>WS(e,i.blocks)),a=(o=_e(s,["data"]))==null?void 0:o.data.segments;return F.useLayoutEffect(()=>{(async()=>{!ple(e)&&t&&await n(e)})()},[n,e,t]),a},ple=e=>{const t=K.blocks[e];return t==null?void 0:t.subNodes.some(n=>{const s=K.blocks[n];return!!(s&&!Xt(s==null?void 0:s.type))})},gle=e=>{const{id:t,ownerBlockId:n,illegal:s,showIcon:a,showCover:o,desc:i,isInColumn:l}=e,c=uy(e.id,!i);let u={};return l&&(u={"data-column-item-min-width":"256px"}),r.jsxs("div",{...u,className:B("overflow-hidden flex flex-col relative w-[256px] h-[184px] animate-hover",{"w-full":l}),onClick:e.onClick,children:[o&&r.jsx(nf,{uuid:e.id,height:92,hiddenEditorButton:!0,className:"flex-shrink-0 w-full relative rounded-t"}),!o&&r.jsx("div",{className:"flex-shrink-0 w-full relative rounded-t border-l border-r border-t h-[92px]",style:B7}),a&&r.jsx(tn,{tooltipClassName:"w-fit",trigger:!n,iconSize:40,className:"absolute left-2.5 top-[66px] w-10 h-10",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(as,{uuid:t})}),r.jsxs("div",{className:"border-l border-r border-b rounded-b h-full pb-1 px-4",children:[r.jsx("div",{className:"text-ellipsis text-t1 break-words flex-shrink-0 mt-3",children:s?rs:e.title}),!s&&i&&r.jsx("div",{className:A0,style:{color:e.descColor},children:i}),!s&&!i&&c&&r.jsx(Pn,{className:A0,segments:c})]})]})},lf=(e,t)=>{var i;const n=_e(e,["data"],["cover","coverPos","localUrl","size"]),[s,a]=F.useState((i=n==null?void 0:n.data.localUrl)!=null?i:""),o=F.useMemo(()=>{var c;const l=(c=n==null?void 0:n.data.cover)!=null?c:"";return lj(l)||l},[n==null?void 0:n.data.cover]);return F.useEffect(()=>{if(vd(o)){a(o);return}n!=null&&n.data.localUrl?a(n.data.localUrl):Ls.fetchImageUrl(e,o,void 0).then(l=>{var d,f;const{extName:c}=sn(o),u=Math.max(Math.floor((f=(d=t==null?void 0:t.current)==null?void 0:d.getBoundingClientRect().width)!=null?f:100),800);if(Rd.test(c)){const h=`${l}&img_process=/resize,w_${u}/quality,q_100/`;a(bo(h,c))}else a(bo(l,c))})},[o,n==null?void 0:n.data.localUrl,e,t]),s},Nl=F.forwardRef((e,t)=>{var f;const{blockId:n,showCover:s,className:a,...o}=e,i=F.useRef(null),l=lf(n,i),c=_e(n,["data"],["cover","coverPos","localUrl","size"]),u=(f=c==null?void 0:c.data.coverPos)!=null?f:50;let d={};return s&&(d={backgroundSize:"cover",backgroundImage:`url(${l})`,backgroundPosition:`center ${u}%`,backgroundRepeat:"no-repeat"}),F.useImperativeHandle(t,()=>i.current,[]),r.jsx("div",{ref:i,style:d,className:"w-full h-full relative rounded transition-all",...o,contentEditable:!1,children:r.jsx("div",{className:B("relative",a),style:{background:"linear-gradient(180deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0) 90%)"},children:e.children})})}),_le=e=>{const{id:t,ownerBlockId:n,illegal:s,showIcon:a,showCover:o,desc:i,isInColumn:l}=e,c=uy(e.id,!i),u=!!lf(t)&&o;let d={};return l&&(d={"data-column-item-min-width":"256px"}),r.jsxs(Nl,{blockId:t,showCover:o,...d,className:B("overflow-hidden flex flex-col relative w-[256px] h-[184px] animate-hover border",{"w-full":l}),onClick:e.onClick,children:[a&&r.jsx(tn,{tooltipClassName:"w-fit mt-4",trigger:!n,iconSize:40,className:"left-2.5 w-10 h-10",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(as,{uuid:t})}),r.jsxs("div",{className:"h-full pb-1 px-4",children:[r.jsx("div",{className:B("text-ellipsis text-t1 break-words flex-shrink-0 mt-2",{"text-white":u}),children:s?rs:e.title}),!s&&i&&r.jsx("div",{className:B(A0,{"text-white":u}),style:{color:e.descColor},children:i}),!s&&!i&&c&&r.jsx(Pn,{className:B(A0,{"text-white":u}),segments:c})]})]})},y3=e=>{const t=K.blocks[e],n=[];return((t==null?void 0:t.type)===m.BlockType.FILE&&t.data.display==="image"&&t.data.ossName||(t==null?void 0:t.type)===m.BlockType.EXTERNAL_FILE&&t.data.display==="image"&&t.data.ossName||(t==null?void 0:t.type)===m.BlockType.REFERENCE&&t.data.display==="image")&&n.push(e),t==null||t.subNodes.forEach(s=>{const a=K.blocks[s];if(Xt(a==null?void 0:a.type))return;const o=y3(s);n.push(...o)}),n},sP=new Map,JN=({id:e})=>(_e(e,[]),r.jsx("div",{className:"h-px"})),Mn=(e,t)=>{sP.set(e,t)},b3=e=>{var t;return e==null?JN:(t=sP.get(e))!=null?t:JN},ml=({uuid:e})=>{const t=Ig(e),n=_e(e,["subNodes"]),s=F.useRef(null);F.useLayoutEffect(()=>{var i;const o=(i=s.current)==null?void 0:i.querySelector("[data-block-id]");o&&o.setAttribute("style","margin-top:0px;margin-bottom:0px")},[]);const a=b3(n==null?void 0:n.type);return n?r.jsx("div",{ref:s,style:t,className:"flex w-full h-full pointer-events-none",children:r.jsx(a,{id:e})}):null},xle=e=>{const{id:t,illegal:n,showCover:s,desc:a,isInColumn:o}=e,i=!!lf(t)&&s,[l,c]=Li(),u=Eg(t,l),d=_e(t,["subNodes","data"],["segments"]),f=F.useRef(null),h=F.useRef(),p=n?rs:de(d==null?void 0:d.data.segments),[g,_]=F.useState([]);let x={};return o&&(x={"data-column-item-min-width":"250px"}),F.useEffect(()=>{if(u)return;const y=y3(t);_(y)},[t,u]),F.useLayoutEffect(()=>{var E,w,k,C;if(!l||u)return;const y=(E=f.current)==null?void 0:E.querySelector(".footer");y instanceof HTMLElement&&(y.hidden=!0);const b=(C=(w=f.current)==null?void 0:w.querySelector(`#${Ud}`))!=null?C:(k=f.current)==null?void 0:k.querySelector(".next-space-page");b instanceof HTMLElement&&b.childNodes.forEach(T=>{T instanceof HTMLElement&&T.setAttribute("style","padding-left:12px;padding-right:12px")})},[u,l]),a||o?r.jsxs(Nl,{blockId:t,ref:y=>{c(y),y!=null&&(h.current=y)},showCover:s,...x,className:B("overflow-hidden flex relative w-[400px] h-[184px] animate-hover border",{"w-full":o}),onClick:y=>{const b=window.getSelection();b&&b.isCollapsed&&e.onClick(y)},children:[r.jsx(cy,{title:p,blockType:d==null?void 0:d.type,desc:a,hasCover:i}),r.jsx(Fle,{ids:g,className:"ml-4 mt-10"})]}):r.jsxs(Nl,{blockId:t,ref:y=>{c(y),y!=null&&(h.current=y)},showCover:s,...x,className:B("overflow-hidden flex flex-col relative w-[240px] h-[184px] animate-hover border",{"w-full":o}),onClick:y=>{const b=window.getSelection();b&&b.isCollapsed&&e.onClick(y)},children:[r.jsx("div",{className:B("text-ellipsis ml-4 mt-4 text-t1-bold text-black",{"text-white":i}),children:p||Ot(d==null?void 0:d.type)}),r.jsx(yle,{ids:g,className:"ml-4 mt-4"})]})},Fle=({ids:e,className:t})=>{const n=e[0],s=e[1],a=e[2];return r.jsx(Al.Provider,{value:Tt.ONLY_IMAGE,children:r.jsxs("div",{className:B("relative",t),children:[r.jsx("div",{className:Of.id1,style:{...dl},children:n&&r.jsx(ml,{uuid:n})}),r.jsx("div",{className:Of.id2,style:{...dl},children:s&&r.jsx(ml,{uuid:s})}),r.jsx("div",{className:Of.id3,style:{...dl},children:a&&r.jsx(ml,{uuid:a})})]})})},yle=({ids:e,className:t})=>{const n=e[0],s=e[1],a=e[2];return r.jsx(Al.Provider,{value:Tt.ONLY_IMAGE,children:r.jsxs("div",{className:B("relative",t),children:[r.jsx("div",{className:"absolute rounded-sm left-0 top-0 w-[150px] h-[100px] overflow-hidden",style:{...dl,transform:"matrix(0.99, -0.12, 0.15, 0.99, 0, 0)",zIndex:3},children:n&&r.jsx(ml,{uuid:n})}),r.jsx("div",{className:"absolute rounded-sm left-[50px] top-[56px] w-[150px] h-[100px] overflow-hidden",style:{...dl,transform:"matrix(0.97, -0.25, 0.31, 0.95, 0, 0)",zIndex:2},children:s&&r.jsx(ml,{uuid:s})}),r.jsx("div",{className:"absolute rounded-sm left-[104px] top-[22px] w-[150px] h-[100px] overflow-hidden",style:{...dl,transform:"matrix(1, -0.07, 0.09, 1, 0, 0)",zIndex:1},children:a&&r.jsx(ml,{uuid:a})})]})})},ble=e=>{const{id:t,illegal:n,showCover:s,desc:a,isInColumn:o}=e,i=!!lf(t)&&s,[l,c]=Li(),u=Eg(t,l),d=_e(t,["data"],["segments"]),f=F.useRef(null),h=F.useRef(),{width:p}=no(h.current,{type:"width"}),g=n?rs:de(d==null?void 0:d.data.segments);let _={};return o&&(_={"data-column-item-min-width":"250px"}),F.useLayoutEffect(()=>{var b,E,w,k;if(!l||u)return;const x=(b=f.current)==null?void 0:b.querySelector(".footer");x instanceof HTMLElement&&(x.hidden=!0);const y=(k=(E=f.current)==null?void 0:E.querySelector(`#${Ud}`))!=null?k:(w=f.current)==null?void 0:w.querySelector(".next-space-page");y instanceof HTMLElement&&y.childNodes.forEach(C=>{C instanceof HTMLElement&&C.setAttribute("style","padding-left:12px;padding-right:12px")})},[u,l]),a?r.jsxs(Nl,{blockId:t,ref:x=>{c(x),x!=null&&(h.current=x)},showCover:s,..._,className:B("overflow-hidden flex relative w-[400px] h-[184px] animate-hover border",{"w-full":o}),onClick:x=>{const y=window.getSelection();y&&y.isCollapsed&&e.onClick(x)},children:[r.jsx(cy,{title:g,blockType:d==null?void 0:d.type,desc:a,hasCover:i}),r.jsx("div",{ref:f,className:"self-end mr-4 px-[10px] bottom-0 w-[75%] min-w-[188px] h-[70%] border-t border-l border-r overflow-hidden bg-white1 pt-2",style:{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:r.jsx(Fp.Provider,{value:!1,children:r.jsxs("div",{className:"h-full zoom-03",children:[r.jsx("div",{className:B("cursor-text ml-4 text-h0 text-black break-words",{"text-grey3":!g}),children:g||Ot(d==null?void 0:d.type)}),r.jsx(pp,{pageId:t,loading:u})]})})})]}):r.jsxs(Nl,{blockId:t,ref:x=>{c(x),x!=null&&(h.current=x)},showCover:s,..._,className:B("overflow-hidden flex flex-col relative w-[240px] h-[184px] animate-hover border",{"w-full":o}),onClick:x=>{const y=window.getSelection();y&&y.isCollapsed&&e.onClick(x)},children:[r.jsx("div",{className:B("text-ellipsis ml-4 mt-4 text-t1-bold text-black",{"text-white":i}),children:g||Ot(d==null?void 0:d.type)}),r.jsx("div",{ref:f,className:B("mt-4 w-[75%] min-w-[188px] h-[70%] border-t border-l border-r overflow-hidden bg-white1 pt-2",{"self-end mr-4":p&&p>250,"ml-[55px]":p&&p<250}),style:{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:r.jsx(Fp.Provider,{value:!1,children:r.jsxs("div",{className:"h-full px-12 zoom-03",children:[r.jsx("div",{className:B("text-ellipsis cursor-text ml-4 text-h0 text-black",{"text-grey3":!g}),children:g||Ot(d==null?void 0:d.type)}),r.jsx(pp,{pageId:t,loading:u})]})})})]})},E3=e=>r.jsxs("div",{className:Yt("next-modal flex p-[2px] disable-select",e.className),style:e.style,children:[e.customButton,r.jsx(Ds,{title:"默认样式",className:"px-0",boxClassName:"px-0 py-0",icon:"IcMenuViewNormal",active:e.showType==="default",onClick:()=>{e.onClick("default")}}),r.jsx(Ds,{title:"小卡片样式",className:"px-0 ml-0.5",boxClassName:"px-0 py-0",icon:"IcMenuViewCard",active:e.showType==="small",onClick:()=>{e.onClick("small")}}),r.jsx(Ds,{title:"大卡片样式",className:"px-0 ml-0.5",boxClassName:"px-0 py-0",icon:"IcMenuViewPreview",active:e.showType==="large",onClick:()=>{e.onClick("large")}})]}),Ele=e=>{var i;const t=me(),n=ke(),s=ae(l=>{var c,u;return(u=(c=l.blocks[e.blockId])==null?void 0:c.data.format)==null?void 0:u.cardFormat}),a=_e(e.blockId,["data"]);if(!a)return null;const o=(i=s==null?void 0:s.showType)!=null?i:"default";return r.jsx(E3,{showType:o,customButton:o!=="default"&&!e.illegal?r.jsx(Ds,{title:"样式设置",className:"px-0 mr-0.5",boxClassName:"px-0 py-0",icon:"IcBtnEdit",onClick:l=>{t.dropdown({placement:"right",popcorn:Br(l.currentTarget),content:({onCloseModal:c})=>r.jsx(EL,{blockId:a.uuid,onClose:c})})}}):void 0,onClick:l=>{var c,u,d;l!==(s==null?void 0:s.showType)&&(ce.event("page_card_style",{style_type:{showType:l,cardStyle:(d=(u=(c=a==null?void 0:a.data.format)==null?void 0:c.cardFormat)==null?void 0:u.cardStyle)!=null?d:"regular",isShowCover:s==null?void 0:s.isShowCover,isShowIcon:s==null?void 0:s.isShowIcon,cardCaption:!!(s!=null&&s.cardCaption)}}),n(()=>{var f;pe(e.blockId,{data:{format:{cardFormat:{...(f=a==null?void 0:a.data.format)==null?void 0:f.cardFormat,showType:l}}}})}))}})},wle=e=>{const{id:t,ownerBlockId:n,illegal:s,showIcon:a,showCover:o,desc:i}=e,l=uy(e.id,!i),c=!!F.useContext(io);return r.jsxs("div",{className:B("flex justify-between items-center w-full h-[90px] animate-hover pl-3",{"min-w-[300px] max-w-[800px]":c,"border-l border-t border-b":o,border:!o}),contentEditable:!1,onClick:e.onClick,children:[r.jsxs("div",{className:"flex items-center overflow-hidden",children:[a&&r.jsx(tn,{trigger:!n,iconSize:40,className:"mr-2",tooltipClassName:"flex-shrink-0",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(as,{uuid:t})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-t1 h-6 overflow-hidden break-words line-clamp-1",children:s?rs:e.title}),!s&&i&&r.jsx("div",{className:"text-t4 text-grey3 h-4 overflow-hidden pr-1 mt-1 break-words line-clamp-1",style:{color:e.descColor},children:i}),!s&&!i&&l&&r.jsx(Pn,{className:B("text-t4 text-grey3 h-4 overflow-hidden pr-1 mt-1 line-clamp-1"),segments:l})]})]}),o&&r.jsx(nf,{uuid:e.id,height:90,hiddenEditorButton:!0,className:"flex-shrink-0 relative rounded-r w-[30%]"})]})},kle=e=>{const{id:t,ownerBlockId:n,illegal:s,showIcon:a,showCover:o,desc:i}=e,l=uy(e.id,!i),c=!!F.useContext(io),u=!!lf(t)&&o;return r.jsx(Nl,{blockId:t,showCover:o,className:B("flex justify-between items-center w-full h-[90px] animate-hover pl-3",{"min-w-[300px] max-w-[800px]":c,"border-l border-t border-b":o,border:!o}),onClick:e.onClick,children:r.jsxs("div",{className:"flex items-center overflow-hidden",children:[a&&r.jsx(tn,{trigger:!n,iconSize:40,className:"mr-2",tooltipClassName:"flex-shrink-0",hasOverlay:!!n,blockId:t,offset:[100,0],defaultIcon:r.jsx(as,{uuid:t})}),r.jsxs("div",{children:[r.jsx("div",{className:B("text-t1 h-6 overflow-hidden break-words line-clamp-1",{"text-white":u}),children:s?rs:e.title}),!s&&i&&r.jsx("div",{className:B("text-t4 text-grey3 h-4 overflow-hidden pr-1 mt-1 break-words line-clamp-1",{"text-white":u}),style:{color:e.descColor},children:i}),!s&&!i&&l&&r.jsx(Pn,{className:B("text-t4 text-grey3 h-4 overflow-hidden pr-1 mt-1 line-clamp-1",{"text-white":u}),segments:l})]})]})})},Cle=e=>{const{id:t,illegal:n,showCover:s,desc:a,isInColumn:o}=e,i=!!lf(t)&&s,[l,c]=Li(),u=Eg(t,l),d=_e(t,["subNodes","data"],["segments"]),f=F.useRef(null),h=F.useRef(),p=n?rs:de(d==null?void 0:d.data.segments),[g,_]=F.useState([]);let x={};return o&&(x={"data-column-item-min-width":"250px"}),F.useEffect(()=>{if(u)return;const y=y3(t);_(y)},[t,u]),F.useLayoutEffect(()=>{var E,w,k,C;if(!l||u)return;const y=(E=f.current)==null?void 0:E.querySelector(".footer");y instanceof HTMLElement&&(y.hidden=!0);const b=(C=(w=f.current)==null?void 0:w.querySelector(`#${Ud}`))!=null?C:(k=f.current)==null?void 0:k.querySelector(".next-space-page");b instanceof HTMLElement&&b.childNodes.forEach(T=>{T instanceof HTMLElement&&T.setAttribute("style","padding-left:12px;padding-right:12px")})},[u,l]),r.jsxs(Nl,{blockId:t,ref:y=>{c(y),y!=null&&(h.current=y)},showCover:s,...x,className:B("overflow-hidden flex relative w-full h-[90px] animate-hover border",{"w-full":o}),onClick:y=>{const b=window.getSelection();b&&b.isCollapsed&&e.onClick(y)},children:[r.jsx(cy,{small:!0,title:p,blockType:d==null?void 0:d.type,desc:a,hasCover:i}),r.jsx(Tle,{ids:g,className:B("ml-4 mt-4",{"absolute right-3 ml-0":!o})})]})},Tle=({ids:e,className:t})=>{const n=e[0],s=e[1],a=e[2];return r.jsx(Al.Provider,{value:Tt.ONLY_IMAGE,children:r.jsxs("div",{className:B("relative w-[280px]",t),children:[r.jsx("div",{className:Of.id1,style:{...dl},children:n&&r.jsx(ml,{uuid:n})}),r.jsx("div",{className:Of.id2,style:{...dl},children:s&&r.jsx(ml,{uuid:s})}),r.jsx("div",{className:Of.id3,style:{...dl},children:a&&r.jsx(ml,{uuid:a})})]})})},vle=e=>{const{id:t,illegal:n,showCover:s,desc:a,isInColumn:o}=e,i=!!lf(t)&&s,[l,c]=Li(),u=Eg(t,l),d=_e(t,["data"],["segments"]),f=F.useRef(null),h=F.useRef(),{width:p}=no(h.current,{type:"width"}),g=n?rs:de(d==null?void 0:d.data.segments);let _={};return o&&(_={"data-column-item-min-width":"250px"}),F.useLayoutEffect(()=>{var b,E,w,k;if(!l||u)return;const x=(b=f.current)==null?void 0:b.querySelector(".footer");x instanceof HTMLElement&&(x.hidden=!0);const y=(k=(E=f.current)==null?void 0:E.querySelector(`#${Ud}`))!=null?k:(w=f.current)==null?void 0:w.querySelector(".next-space-page");y instanceof HTMLElement&&y.childNodes.forEach(C=>{C instanceof HTMLElement&&C.setAttribute("style","padding-left:12px;padding-right:12px")})},[u,l]),a?r.jsxs(Nl,{blockId:t,ref:x=>{c(x),x!=null&&(h.current=x)},showCover:s,..._,className:B("overflow-hidden flex relative w-full h-[90px] animate-hover border",{"w-full":o}),onClick:x=>{const y=window.getSelection();y&&y.isCollapsed&&e.onClick(x)},children:[r.jsx(cy,{small:!0,title:g,blockType:d==null?void 0:d.type,desc:a,hasCover:i}),r.jsx("div",{ref:f,className:"self-end mr-4 px-[10px] bottom-0 w-[75%] min-w-[188px] h-[70%] border-t border-l border-r overflow-hidden bg-white1 pt-2",style:{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:r.jsx(Fp.Provider,{value:!1,children:r.jsxs("div",{className:"h-full zoom-03",children:[r.jsx("div",{className:B("text-ellipsis cursor-text ml-4 text-h0 text-black",{"text-grey3":!g}),children:g||Ot(d==null?void 0:d.type)}),r.jsx(pp,{pageId:t,loading:u})]})})})]}):r.jsxs(Nl,{blockId:t,ref:x=>{c(x),x!=null&&(h.current=x)},showCover:s,..._,className:B("overflow-hidden flex flex-col relative w-full h-[90px] animate-hover border",{"w-full":o}),onClick:x=>{const y=window.getSelection();y&&y.isCollapsed&&e.onClick(x)},children:[r.jsx("div",{className:B("ml-4 mt-3 text-t1-bold text-black whitespace-pre-wrap",{"text-white":i}),children:g||Ot(d==null?void 0:d.type)}),r.jsx("div",{ref:f,className:B("w-[75%] min-w-[188px] h-[130px] border-t border-l border-r overflow-hidden bg-white1 pt-2",{"self-end mr-4":p&&p>250,"ml-[55px]":p&&p<250}),style:{boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:r.jsx(Fp.Provider,{value:!1,children:r.jsxs("div",{className:"h-full zoom-03",children:[r.jsx("div",{className:B("cursor-text ml-4 text-h0 text-black break-words",{"text-grey3":!g}),children:g||Ot(d==null?void 0:d.type)}),r.jsx(pp,{pageId:t,loading:u})]})})})]})};T6(IR);const Nle={regular:"regular",fill:"fill",thumbnailPage:"thumbnailPage",thumbnailImage:"thumbnailImage",horizontalRectangle:"regular",smallVerticalRectangle:"regular"},rP=({id:e,ownerBlockId:t})=>{var v,I,j;const n=_e(e,["data"],["segments"]),s=ae(D=>{var S,R;return(R=(S=D.blocks[t!=null?t:e])==null?void 0:S.data.format)==null?void 0:R.cardFormat}),a=t&&!n,{illegal:o,role:i}=it(e),l=Cs(),c=F.useRef(),u=Ig(e),d=ae(D=>{var S;return(S=D.blocks[e])==null?void 0:S.data.cover}),f=gt(),h=!!F.useContext(io),p=Px(),g=Vn(),_=F.useMemo(()=>Dl(t!=null?t:e,f),[t,e,f]);if(!n&&!a)return null;const x=a?"无法访问":r.jsx(vc,{uuid:(v=n==null?void 0:n.uuid)!=null?v:""}),y=(I=s==null?void 0:s.isShowIcon)!=null?I:!0,b=!!d&&((j=s==null?void 0:s.isShowCover)!=null?j:!0);if(i===nj.PermissionRole.NONE)return r.jsx(Wx,{id:e});const E=D=>{l(e,{forceOpenInRight:D.altKey,forceOpenNewTab:D.ctrlKey||D.metaKey})};if((n==null?void 0:n.type)!==m.BlockType.PAGE)return r.jsx(Fe,{lazyLoad:!0,onShow:D=>{c.current=D},theme:"none",placement:_||h?"left":"top-start",popperOptions:{modifiers:[{name:"flip",options:{fallbackPlacements:_||h?["left","right","bottom","bottom-start","top-start"]:["top-start","bottom-start","left","right"]}}]},interactive:!p,disabled:p,popupClass:"next-modal",offset:[0,8],maxWidth:1e4,delay:[1e3,50],animation:"shift-away",className:"w-full",popup:r.jsx(wl,{pageId:e,isLink:!!t,onCloseOutsideModel:()=>{var D;(D=c.current)==null||D.hide()}}),children:r.jsx(Cb,{id:e,title:x,ownerBlockId:t,onClick:E,illegal:o})});const w=(s==null?void 0:s.showType)==="default"||(s==null?void 0:s.showType)===void 0||g===Tt.PAGE_LITE_PREVIEW,k=s!=null&&s.cardStyle?Nle[s.cardStyle]:"regular",C=(s==null?void 0:s.showType)==="large";let T;if(w)T=Cb;else switch(k){case"regular":T=C?gle:wle;break;case"fill":T=C?_le:kle;break;case"thumbnailPage":T=C?ble:vle;break;case"thumbnailImage":T=C?xle:Cle;break;default:T=Cb}return r.jsx(Hm,{wait:1e3,waitMode:"debounce",children:r.jsx(Fe,{interactive:!p,theme:"none",placement:"top-end",animation:"shift-away",className:B("w-full",{"overflow-hidden max-w-full":(s==null?void 0:s.showType)==="large","w-fit":(s==null?void 0:s.showType)==="large"&&!_}),popup:(n==null?void 0:n.type)===m.BlockType.PAGE&&!ht()&&r.jsx(Ele,{blockId:t!=null?t:e,illegal:o}),style:{lineHeight:"36px"},children:r.jsx(Fe,{interactive:!p,lazyLoad:!0,theme:"none",onShow:D=>{c.current=D},placement:w&&!_&&!h?"top-start":"left",popperOptions:{modifiers:[{name:"flip",options:{fallbackPlacements:w&&!_&&!h?["top-start","bottom-start","left","right"]:["left","right","bottom","bottom-start","top-start"]}}]},popupClass:"next-modal",maxWidth:1e4,interactiveDebounce:0,offset:[0,8],delay:[1e3,50],animation:"shift-away",className:"w-full",disabled:p,popup:r.jsx(wl,{pageId:e,isLink:!!t,onCloseOutsideModel:()=>{var D;(D=c.current)==null||D.hide()}}),children:r.jsx(T,{id:e,showCover:b,showIcon:y,title:x,isInColumn:_,ownerBlockId:t,onClick:E,illegal:o,desc:s==null?void 0:s.cardCaption,descColor:u.color})})})})},hl=zt.memo(e=>{var s;const t=(s=e.ownerBlockId)!=null?s:e.id;return _e(e.id,[])?r.jsx(Or,{id:t,className:"py-0 bg-transparent",level:e.level,children:r.jsx(rP,{id:e.id,ownerBlockId:e.ownerBlockId})}):null}),Ile=F.memo(e=>{const t=_e(e.id,["data"],["segments"]),n=of(e.level),s=Pr(e.id),a=F.useMemo(()=>!de(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),o=F.useRef(null),i=gh(e.id,o,a,e.level),{paddingLeft:l,paddingRight:c}=af(e.id,e.level);return t?r.jsx(Or,{id:e.id,ref:o,level:e.level,style:{paddingLeft:`${l}px`,minWidth:i},children:r.jsx("div",{className:"pl-2 border-l-4 border-solid border-current",children:r.jsx(uo,{placeholder:n,uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t.data.segments,onChange:(u,d,f)=>{s(u,[d,f])},style:{paddingRight:`${c}px`}})})}):null}),w3=zt.memo(e=>{var s,a;const t=_e(e.id,["data"],["ref","display"]);if(!t)return null;let n=()=>r.jsx(r.Fragment,{});switch(t.data.display){case"image":{n=x3;break}case"file":{n=hl;break}case"linkPage":{n=hl;break}}return(t.type===m.BlockType.REFERENCE_COLLECTION||t.type===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(n=hl),r.jsx(n,{id:(a=(s=t.data.ref)==null?void 0:s.uuid)!=null?a:"",level:e.level,ownerBlockId:e.id})}),jle=zt.memo(e=>{var d;const t=ae(f=>{var h,p;return(p=(h=f.blocks[e.id])==null?void 0:h.data.segments)!=null?p:[]}),n=F.useRef(null),s=of(e.level),a=Pr(e.id),o=sr(),{paddingLeft:i,paddingRight:l}=af(e.id,e.level),c=F.useRef((d=o.current)==null?void 0:d.style.cursor),u=km();return ph(n,e.id),ig(n,{onResize:f=>{var h,p;if(!(!o.current||!n.current)&&!u)switch(f.resizeStatus){case ra.START:if(c.current=(h=o.current)==null?void 0:h.style.cursor,document.activeElement&&document.activeElement.closest(`[data-block-id='${e.id}']`))return!0;break;case ra.RESIZING:n.current.style.cursor="grabbing",o.current.scrollBy(-f.deltaX,-f.deltaY);break;case ra.END:{n.current.style.cursor=(p=c.current)!=null?p:"";break}}},dispatchEvent:!0}),r.jsx(Or,{ref:n,id:e.id,level:e.level,className:"mind-map-root-node",children:r.jsx(uo,{placeholder:s,uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t,onChange:(f,h,p)=>{a(f,[h,p])},style:{paddingLeft:`${i}px`,paddingRight:`${l}px`}})})}),Dle=()=>{const e=ke();return F.useCallback(()=>{const{chosenCells:t}=K.simpleTable,{tableId:n,recordId:s,propertyId:a}=t!=null?t:{};if(!n)return;const o=K.blocks[n];if(!o)return null;const{subNodes:i}=o;hc(s)||e(()=>{const l=K.blocks[s];l&&Qe({type:m.BlockType.TABLE_ROW,textColor:l.textColor,backgroundColor:l.backgroundColor,data:l.data},{parentId:n,after:s})}),hc(a)||e(()=>{var g,_,x;const l=(g=o.data.format)!=null?g:{},c=(_=l.tableBlockColumnOrder)!=null?_:[],u=qe(),d=c.indexOf(a),f={...l,tableBlockColumnOrder:[...c.slice(0,d+1),u,...c.slice(d+1)]},h=(x=l.tableBlockColumnFormat)!=null?x:{},p=h[a];p&&(f.tableBlockColumnFormat={...h,[u]:p}),pe(n,{data:{format:f}}),i.forEach(y=>{var w;const b=K.blocks[y],E=(w=b==null?void 0:b.data.collectionProperties)==null?void 0:w[a];E&&pe(y,{data:{collectionProperties:{...b.data.collectionProperties,[u]:E}}})})})},[e])},k3=e=>{const{subNodes:t=[],tableBlockColumnOrder:n=[],tableBlockRanges:s=[]}=ae(({blocks:a})=>{const o=a[e];if(!o)return{};const{format:i}=o.data;return i?{subNodes:o.subNodes,tableBlockRanges:i.tableBlockRanges,tableBlockColumnOrder:i.tableBlockColumnOrder}:{}},{equalityFn:rn});return{subNodes:t,tableBlockRanges:s,tableBlockColumnOrder:n}},aP=e=>{const{subNodes:t,tableBlockColumnOrder:n,tableBlockRanges:s}=k3(e);return F.useMemo(()=>s.reduce((a,{start:o,end:i})=>{if(!o||!i)return a;const[l,c]=o,[u,d]=i;if(!l||!c||!u||!d)return a;const f=t.indexOf(l),h=n.indexOf(c),p=t.indexOf(u),g=n.indexOf(d);return a.push([[f,h],[p,g]]),a},[]),[t,n,s])},oP=e=>ae(({ui:n,blocks:s})=>{var c,u;const a=s[e];if(!a)return!0;const o=n.selectedCells[0],i=(u=(c=a.data.format)==null?void 0:c.tableBlockColumnOrder)!=null?u:[],{subNodes:l}=a;return l.some(d=>d===(o==null?void 0:o.recordId))&&i.some(d=>d===(o==null?void 0:o.propertyId))}),Sle=(e,t,n,s)=>{const a=ke(),o=xn(),i=F.useCallback(function*(f){var h;yield*Object.values((h=f.data.collectionProperties)!=null?h:{})},[]),l=F.useRef(),c=F.useRef(ll),u=F.useMemo(()=>fs(f=>{var _,x;const h=l.current,p=le().blocks[t];if(!h||!p)return;if(c.current<ll){c.current=ll;return}const g=(x=(_=p.data.collectionProperties)==null?void 0:_[n])!=null?x:[];a(()=>{ee(bs({init(){pe(t,{data:{collectionProperties:{...p.data.collectionProperties,[n]:g}}}),tc(t,i)},redo(){pe(t,{data:{collectionProperties:{...p.data.collectionProperties,[n]:g}}}),ee(nt.update({selectedCells:[{recordId:t,propertyId:n,viewId:e}]})),tc(t,i);const y=o(s,!0);y.performChange(b=>{b.select(f)}),y.requestFocus()},undo(){var b;pe(t,{data:{collectionProperties:{...p.data.collectionProperties,[n]:(b=h.segments)!=null?b:[]}}}),ee(nt.update({selectedCells:[{recordId:t,propertyId:n,viewId:e}]})),tc(t,i);const y=o(s,!0);y.performChange(E=>{E.select(h.offset)}),y.requestFocus()}}))}),l.current=void 0},500,{leading:!1}),[t,n,a,i,e,o,s]),d=(f,h)=>{var x,y,b,E;const g=(y=(x=o(s,!0).selection)==null?void 0:x.offset)!=null?y:0;c.current=ll;const _=le().blocks[t];if(_){if(!l.current)if(h){const[w,k]=h;l.current={segments:Qs(w),offset:(b=k==null?void 0:k.offset)!=null?b:0}}else{const w=(E=_.data.collectionProperties)==null?void 0:E[n];l.current=w?{segments:w,offset:g}:{segments:void 0,offset:0}}ee(mn({ignoreOp:!0,uuid:t,patch:{data:{collectionProperties:{..._.data.collectionProperties,[n]:f!=null?f:[]}}}})),tc(t,i,a),u(g)}};return F.useCallback(d,[o,s,t,n,i,a,u])},Rle=()=>{const e=ke();return F.useCallback(()=>{e(()=>{K.ui.selectedCells.forEach(t=>{var s;const n=K.blocks[t.recordId];if(n){const{[t.propertyId]:a,...o}=(s=n.data.collectionProperties)!=null?s:{};pe(t.recordId,{data:{...n.data,collectionProperties:o}})}})})},[e])},Ale=({type:e,onCloseModal:t,tableId:n,isFirstColumn:s,isFirstRow:a,recordId:o,propertyId:i})=>{var C,T,v,I,j;const l=_e(n,["data","subNodes","updatedBy","updatedAt"]),c=ke(),u=Rle(),d=Dle(),{selectedBlockHistory:f}=Ol(),h=$i((C=l==null?void 0:l.updatedBy)!=null?C:"");if(!l)return null;const{subNodes:p}=l,g=(T=l.data.format)!=null?T:{},_=(v=g.tableBlockColumnOrder)!=null?v:[],x=(I=g.tableBlockRanges)!=null?I:[],y=D=>{var R;if(i)return i;const S=E0(_,"propertyId")(D);return(R=_[S])!=null?R:""},b=D=>{var R;if(o)return o;const S=E0(p,"recordId")(D);return(R=p[S])!=null?R:""},E=(D,S=!1)=>{const R=_.indexOf(y(S)),A=S?R+1:R;return[..._.slice(0,A),D,..._.slice(A)]},w=[],{selectedCells:k}=K.ui;if(k.length){const D=k.map(L=>L.recordId),S=k.map(L=>L.propertyId),R=({start:L})=>{if(!L)return!1;const[P,M]=L;return!P||!M?!1:D.includes(P)&&S.includes(M)},A=x.some(R);A&&w.push({type:$.OPERATION,data:{title:"拆分单元格",icon:"IcMenuSplitCells",onClick:()=>{ce.event("simpletable_merge_cell",{openclose:"close"});const L=x.reduce((P,{start:M,end:U})=>{if(!M||!U)return P;const[V,W]=M;return!V||!W||D.includes(V)&&S.includes(W)||P.push({start:M,end:U}),P},[]);c(()=>{pe(n,{data:{format:{tableBlockRanges:L}}}),f([])}),t()}}}),k.length>1&&w.push({type:$.OPERATION,data:{title:"合并单元格",icon:"IcMenuMergeCells",onClick:()=>{const L=Sa(D),P=Sa(S),M=pn(D),U=pn(S);!L||!P||!M||!U||(ce.event("simpletable_merge_cell",{openclose:"open"}),c(()=>{var Q,Z;pe(n,{data:{format:{tableBlockRanges:[...x.filter(te=>!R(te)),{start:[L,P],end:[M,U]}]}}});const V=[],W=k.reduce((te,re)=>{var ge;const{recordId:ne,propertyId:Y}=re,X=K.blocks[ne];if(!X)return te;const{collectionProperties:oe={}}=X.data,ie=oe[Y];if(!ie)return te;ie.forEach(Ne=>{var De;(De=Ne.discussions)==null||De.forEach(Se=>V.push(Se))}),pe(ne,{data:{collectionProperties:Jn(oe,Y)},discussions:((ge=X.discussions)!=null?ge:[]).filter(Ne=>!V.includes(Ne))});const ue=pn(te);return ue?te.slice(0,-1).concat({...ue,text:`${ue.text}
`},ie):te.concat(ie)},[]),z=K.blocks[L];z&&pe(L,{data:{collectionProperties:{...(Q=z.data.collectionProperties)!=null?Q:{},[P]:W}},discussions:((Z=z.discussions)!=null?Z:[]).concat(V)}),f([])}),t())}}}),(A||k.length>1)&&w.push({type:$.LINE})}return e!=="contextmenu"&&w.push({type:$.OPERATION,data:{icon:"IcMenuColor",title:"颜色",hasArrow:!0,renderSubMenu:()=>r.jsx(vx,{items:Dg,onColorSelect:D=>{t(),c(()=>{var S,R;if(e==="row"){const{textColor:A,backgroundColor:L,...P}=g,M=D.isBgColor?{...P,backgroundColor:D.colorkey}:{...P,textColor:D.colorkey};pe(b(),{data:{format:M}})}if(e==="column"){const A=(R=(S=g.tableBlockColumnFormat)==null?void 0:S[y()])!=null?R:{},{textColor:L,backgroundColor:P,...M}=A,U=D.isBgColor?{...M,backgroundColor:D.colorkey}:{...M,textColor:D.colorkey};pe(n,{data:{format:{tableBlockColumnFormat:{...g.tableBlockColumnFormat,[y()]:U}}}})}})}})}}),e!=="column"&&(w.push({type:$.OPERATION,data:{title:"向上边插入行",icon:"IcMenuInsertUp",onClick:()=>{ce.event("simpletable_add"),t(),c(()=>{Qe({type:m.BlockType.TABLE_ROW},{parentId:n,before:b()})})}}}),w.push({type:$.OPERATION,data:{title:"向下边插入行",icon:"IcMenuInsertDown",onClick:()=>{ce.event("simpletable_add"),t(),c(()=>{Qe({type:m.BlockType.TABLE_ROW},{parentId:n,after:b(!0)})})}}})),e!=="row"&&(w.push({type:$.OPERATION,data:{title:"向左侧插入列",icon:"IcMenuInsertLeft",onClick:()=>{ce.event("simpletable_add"),t();const D=qe();c(()=>{pe(n,{data:{format:{tableBlockColumnOrder:E(D)}}})})}}}),w.push({type:$.OPERATION,data:{title:"向右侧插入列",icon:"IcMenuInsertRight",onClick:()=>{ce.event("simpletable_add"),t();const D=qe();c(()=>{pe(n,{data:{format:{tableBlockColumnOrder:E(D,!0)}}})})}}})),e!=="contextmenu"&&w.push({type:$.OPERATION,data:{title:"拷贝副本",icon:"IcMenuDuplicate",rightText:`${Gt}+D`,onClick:()=>{t(),d()}}}),w.push({type:$.LINE}),w.push({type:$.OPERATION,data:{title:"清空内容",icon:"IcUploadCancel",onClick:()=>{t(),e==="row"&&c(()=>{pe(b(),{backgroundColor:"",textColor:"",data:{collectionProperties:{}}})}),e==="column"&&c(()=>{l.subNodes.forEach(D=>{var R;const S=K.blocks[D];if(S){const{[y()]:A,...L}=(R=S.data.collectionProperties)!=null?R:{};pe(D,{data:{collectionProperties:L}})}})}),e==="contextmenu"&&u(),fb()}}}),e!=="column"&&w.push({type:$.OPERATION,data:{title:"删除所选行",icon:"IcMenuDelete",onClick:()=>{t(),c(()=>{if(p.length===1)ha(n);else{const{selectedCells:D}=K.ui;if(D.length){Gs(D.map(R=>R.recordId));const S=x.filter(R=>{const{start:A}=R;if(!A)return!1;const[L,P]=A;return!D.some(M=>L===M.recordId&&P===M.propertyId)});S.length!==x.length&&pe(n,{data:{format:{tableBlockRanges:S}}})}else{const S=b();ha(S);const R=p.indexOf(S),A=x.filter(L=>{const{start:P,end:M}=L;if(!P||!M)return!1;const[U]=P,[V]=M;return!(U===S&&V===S)});pe(n,{data:{format:{tableBlockRanges:A.map(L=>{const{start:P,end:M}=L;if(!P||!M)return L;const[U,V]=P,[W,z]=M;return U===S?{...L,start:[p[R+1],V]}:W===S?{...L,end:[p[R-1],z]}:L})}}})}}}),fb()}}}),e!=="row"&&w.push({type:$.OPERATION,data:{title:"删除所选列",icon:"IcMenuDelete",onClick:()=>{t(),c(()=>{var D,S,R;if(((D=g.tableBlockColumnOrder)==null?void 0:D.length)===1)ha(n);else{const{selectedCells:A}=K.ui,L=A.length?A.map(P=>P.propertyId):[i!=null?i:""];if(A.length){const P=x.filter(M=>{const{start:U}=M;if(!U)return!1;const[V,W]=U;return!A.some(z=>V===z.recordId&&W===z.propertyId)});P.length!==x.length&&pe(n,{data:{format:{tableBlockRanges:P}}})}else{const P=x.filter(U=>{const{start:V,end:W}=U;if(!V||!W)return!1;const[,z]=V,[,Q]=W;return!(z===i&&Q===i)}),M=(S=_.indexOf(i!=null?i:""))!=null?S:-1;M>-1&&pe(n,{data:{format:{tableBlockRanges:P.map(U=>{const{start:V,end:W}=U;if(!V||!W)return U;const[z,Q]=V,[Z,te]=W;return Q===i?{...U,start:[z,_[M+1]]}:te===i?{...U,end:[Z,_[M-1]]}:U})}}})}pe(n,{data:{format:{tableBlockColumnFormat:Jn((R=g.tableBlockColumnFormat)!=null?R:{},L),tableBlockColumnOrder:_.filter(P=>!L.includes(P))}}}),l.subNodes.forEach(P=>{var U;const M=K.blocks[P];M&&pe(P,{data:{collectionProperties:Jn((U=M.data.collectionProperties)!=null?U:{},L)}})})}}),fb()}}}),w.push({type:$.LINE}),a&&(w.unshift({type:$.LINE}),w.unshift({type:$.TEXT_SWITCH,data:{title:"标题行",switch:g.tableBlockRowHeader,icon:"IcTableHeaderRow",noCancelSelected:!0,onSwitch:D=>{ce.event("simpletable_titlerow",{openclose:D?"open":"close"}),c(()=>{pe(n,{data:{format:{tableBlockRowHeader:D}}})})}}})),s&&(w.unshift({type:$.LINE}),w.unshift({type:$.TEXT_SWITCH,data:{title:"标题列",switch:g.tableBlockColumnHeader,icon:"IcTableHeaderColumn",noCancelSelected:!0,onSwitch:D=>{ce.event("simpletable_titlecolumn",{openclose:D?"open":"close"}),c(()=>{pe(n,{data:{format:{...g,tableBlockColumnHeader:D}}})})}}})),r.jsx(ze,{className:"py-[5px] rounded-r w-60 next-modal",items:w,customFooter:r.jsx(Km,{name:ss((j=h==null?void 0:h.uuid)!=null?j:""),updatedAt:l.updatedAt})})},ZN=({propertyId:e,rowIndex:t,columnIndex:n,isRowHandle:s})=>{const{recordId:a,tableId:o}=OF(),i=s||t!==0&&n===0,l=ae(({simpleTable:p})=>{const{activityTableId:g,hoveringCell:_}=p;return!_||o!==g?!1:i?_.rowIndex===t:_.columnIndex===n}),c=ae(({simpleTable:p})=>{const{chosenCells:g}=p;return!g||g.tableId!==o?!1:i?g.recordId===a:g.propertyId===e}),u=F.useRef(),d=me(),f=ae(({simpleTable:p})=>!!p.draggingStart);return ae(({simpleTable:p})=>!!p.selecting)||(i?n>0:t>0)||!l&&!c?null:r.jsx("div",{ref:u,"data-disable-select":!0,"data-no-cancel-selected":!0,onClick:()=>{d.dropdown({modalId:tV,popcorn:u.current,placement:"bottom-start",offset:[16,-2],closeNoAnimate:!0,content({onCloseModal:p}){return r.jsx(Ale,{type:i?"row":"column",recordId:a,propertyId:e,isFirstRow:!!s,isFirstColumn:n===0&&t===0&&!s,tableId:o,onCloseModal:()=>p()})}})},onMouseDown:p=>{p.stopPropagation(),ee(nt.update({selectedCells:[],selectedBlocks:[]})),ee(Qn.update({activityTableId:o,chosenCells:i?{tableId:o,recordId:a}:{tableId:o,propertyId:e}}))},className:B("table-handle shadow-button absolute z-10",i?"top-1/2 -left-2.5 -mt-[13px]":"-top-[13px] left-1/2 -ml-2 rotate-90",c?"table-selector bg-black dark:bg-grey6":"bg-white1 hover:bg-grey8",f&&"opacity-0"),children:r.jsx(Fe,{placement:"top",offset:[0,8],popup:r.jsxs("div",{className:"py-1 px-2 text-center font-semibold",children:[r.jsx("div",{children:"长按拖拽"}),r.jsx("div",{children:"点击打开菜单"})]}),children:r.jsx(H,{name:"IcBlockHandle",className:B(c?"text-white":"text-grey4"),size:"xxsmall"})})})},iP=F.memo(({propertyId:e,rowIndex:t,columnIndex:n,span:s})=>{var D;Lr();const{recordId:a,tableId:o,indexRanges:i}=OF(),l=dr(qe),c=Pl(l),u=Os(),d=_e(a,["data"],["format"]),f=ae(({blocks:S})=>{var R,A;return(A=(R=S[a])==null?void 0:R.data.collectionProperties)==null?void 0:A[e]}),h=ae(({blocks:S})=>{var R,A,L;return(L=(A=(R=S[o])==null?void 0:R.data.format)==null?void 0:A.tableBlockColumnFormat)==null?void 0:L[e]}),p=Sle(o,a,e,c),g=ae(({blocks:S})=>{var P;const R=(P=S[o])==null?void 0:P.data.format,A=(R==null?void 0:R.tableBlockRowHeader)&&t===0,L=(R==null?void 0:R.tableBlockColumnHeader)&&n===0;return A||L}),_=ae(({ui:S})=>{const{selectedCells:R}=S;return R.some(A=>A.recordId===a&&A.propertyId===e)}),x=ae(({simpleTable:S})=>{const{activityTableId:R,focus:A}=S;return R===o&&A}),y=Ve(o),b=ae(({simpleTable:S})=>{const{activityTableId:R,draggingStart:A,chosenCells:L}=S;return R===o&&A&&((L==null?void 0:L.recordId)===a||(L==null?void 0:L.propertyId)===e)}),E=ae(({blocks:S})=>{var V,W,z,Q,Z,te;const R=S[o],A=(V=R==null?void 0:R.subNodes)!=null?V:[],L=(W=R==null?void 0:R.data.format)!=null?W:{},P=(z=L==null?void 0:L.tableBlockColumnFormat)!=null?z:{};let M=(Z=(Q=P[e])==null?void 0:Q.width)!=null?Z:b0;const U=i.find(([re,ne])=>re[0]===0&&ne[0]===A.length-1&&re[1]===n&&ne[1]!==n);if(U){const[re,ne]=U,Y=re[1],X=ne[1];((te=L.tableBlockColumnOrder)!=null?te:[]).slice(Y+1,X+1).forEach(ie=>{var ue,ge;M+=(ge=(ue=P[ie])==null?void 0:ue.width)!=null?ge:b0})}return M}),w=ke();if(!d)return null;const k=(D=d.data.format)!=null?D:{},C={width:E},T=Us(h==null?void 0:h.textColor),v=Us(k.textColor),I=Rn(h==null?void 0:h.backgroundColor),j=Rn(k.backgroundColor);return T?C.color=T:I?C.backgroundColor=I:v?C.color=v:j&&(C.backgroundColor=j),r.jsxs("td",{"data-table-row-id":a,"data-table-row-index":t,"data-table-column-index":n,className:B("relative border min-w-[39px] border-grey6 break-words p-2",g?"text-t2-medium bg-grey8":"text-t2",_&&x&&"focused-table-cell"),style:C,...s,onMouseDown:S=>{S.stopPropagation();const R=S.button===fV;if(R){if(ka(!0),_)return}else S.target.tagName==="TD"&&Fr(c,S.clientX,S.clientY);ee(nt.update({selectedCells:[{recordId:a,propertyId:e,viewId:o,syncId:u}]})),ee(Qn.update({activityTableId:o,focus:!R,chosenCells:void 0,selecting:{tableId:o,columnIndex:n,rowIndex:t}}));const A=()=>{ee(Qn.update({selecting:void 0})),document.removeEventListener("mouseup",A)};document.addEventListener("mouseup",A)},onMouseEnter:()=>{var re;const{selecting:S}=K.simpleTable;if(!S||S.tableId!==o)return;const R=K.blocks[o];if(!R)return;ka(!0);const{subNodes:A,data:L}=R,{tableBlockColumnOrder:P=[]}=(re=L.format)!=null?re:{},M=[S.rowIndex,S.columnIndex],U=[t,n];let V=i;const W=()=>{for(const ne of V)T8.boxBox(Math.min(M[1],U[1]),Math.min(M[0],U[0]),Math.abs(U[1]-M[1])+1,Math.abs(U[0]-M[0])+1,ne[0][1],ne[0][0],Math.abs(ne[0][1]-ne[1][1])+1,Math.abs(ne[0][0]-ne[1][0])+1)&&(V=V.filter(X=>X!==ne),M[0]=Math.min(ne[0][0],M[0],t),M[1]=Math.min(ne[0][1],M[1],n),U[0]=Math.max(ne[1][0],U[0],S.rowIndex),U[1]=Math.max(ne[1][1],U[1],S.columnIndex),W())};i.length&&W();const z=(ne,Y,X)=>{const oe=Math.min(X,Y),ie=Math.max(X,Y);return ne.slice(oe,ie+1)},Q=z(A,U[0],M[0]),Z=z(P,U[1],M[1]),te=[];for(const ne of Q)for(const Y of Z)te.push({recordId:ne,propertyId:Y,viewId:o,syncId:u});ee(nt.update({selectedCells:te})),ee(Qn.update({focus:!1}))},onKeyDown:S=>{if(be(["Backspace","Delete"],{byKey:!0})(S)){S.stopPropagation();return}if(be("Shift+Enter")(S)){S.preventDefault();const R=nr(c);R==null||R.performChange(A=>{A.delete().insert(`
`)});return}if(be("Enter")(S)){S.preventDefault(),S.stopPropagation();const R=K.blocks[o];if(!R)return;const{subNodes:A}=R;if(t+1>=A.length)w(()=>{const L=Qe({},{parentId:R.parentId,after:o});ee(bs({init(){ee(nt.update({selectedCells:[]})),setTimeout(()=>Fr(L,1/0,1/0))},redo(){ee(nt.update({selectedCells:[]}))},undo(){ee(nt.update({selectedCells:[{recordId:a,propertyId:e,viewId:o,syncId:u}]})),Fr(c,1/0,1/0)}}))});else{const L=A[t+1];if(L){ee(nt.update({selectedCells:[{recordId:L,propertyId:e,viewId:o,syncId:u}]}));const P=zl(o,t+1,n);Fr(P,1/0,1/0)}}}},children:[b&&r.jsx("div",{className:B("w-full h-full bg-white1 absolute left-0 top-0",g&&"!bg-grey8")}),_&&!x&&r.jsx("div",{className:"w-full h-full absolute left-0 top-0 bg-grey6/30 pointer-events-none"}),r.jsx(Nd,{scope:W6,initialValues:[[K6,a]],children:r.jsx(co,{realBlockId:a,readonly:y,uuid:l,className:B("whitespace-break-spaces",C.width&&"break-all"),segments:f,keydownOption:Ic,onChange:(S,R,A)=>{p(S,[R,A])},history:!1,comments:!0})}),!y&&(n===0||t===0)&&r.jsx(ZN,{rowIndex:t,columnIndex:n,propertyId:e}),!y&&t===0&&n===0&&r.jsx(ZN,{isRowHandle:!0,rowIndex:t,columnIndex:n,propertyId:e})]})},rn),Ble=F.memo(({rowIndex:e})=>{const{tableId:t,spans:n,recordId:s}=OF(),{tableBlockColumnOrder:a}=k3(t);return r.jsx("tr",{className:"align-baseline",children:a.map((o,i)=>{var c,u;const l=(u=(c=n[s])==null?void 0:c[o])!=null?u:{};return l.colSpan===0||l.rowSpan===0?null:r.jsx(iP,{span:l,propertyId:o,rowIndex:e,columnIndex:i},`${i}-${o}`)})})}),Lle=({tableId:e,indexRanges:t})=>{const n=_e(e,["subNodes","data"]),s=F.useMemo(()=>{if(!n)return{};const{data:a,subNodes:o}=n,{format:i={}}=a,{tableBlockColumnOrder:l=[],tableBlockRanges:c=[]}=i;return c.reduce((u,{start:d,end:f})=>{var C,T;if(!d||!f)return u;const[h,p]=d,[g,_]=f;if(!h||!p||!g||!_)return u;const x=o.indexOf(h),y=l.indexOf(p),b=o.indexOf(g),E=l.indexOf(_);u[h]={...(C=u[h])!=null?C:{},[p]:{colSpan:E-y+1,rowSpan:b-x+1}};const w=o.slice(x,b+1),k=l.slice(y,E+1);for(const v of w)for(const I of k)v===h&&I===p||(u[v]={...(T=u[v])!=null?T:{},[I]:{colSpan:0,rowSpan:0}});return u},{})},[n]);return n?r.jsx("tbody",{className:"w-max",onMouseMove:a=>{var u,d;const{hoveringCell:o,draggingStart:i}=K.simpleTable;if(i)return;const c=a.target.closest("td");if(c){const f=Number((u=c.dataset.tableRowIndex)!=null?u:0),h=Number((d=c.dataset.tableColumnIndex)!=null?d:0);(!o||o.rowIndex!==f||o.columnIndex!==h)&&ee(Qn.update({activityTableId:e,hoveringCell:{rowIndex:f,columnIndex:h}}))}},onMouseLeave:()=>{const{draggingStart:a}=K.simpleTable;a||ee(Qn.update({hoveringCell:void 0}))},children:n.subNodes.map((a,o)=>K.blocks[a]&&r.jsx(CC.Provider,{value:{tableId:e,recordId:a,spans:s,indexRanges:t},children:r.jsx(Ble,{rowIndex:o})},a))}):null},Ple=F.memo(({id:e,level:t})=>{const n=F.useRef(null),s=ae(({simpleTable:o})=>!!o.draggingStart);BB(e),F.useEffect(()=>{const o=document.getElementById("root");s?o==null||o.classList.add("dragging"):o==null||o.classList.remove("dragging")},[s]);const a=aP(e);return r.jsx(Or,{id:e,level:t,children:r.jsx(bd.Provider,{value:!0,children:r.jsx("div",{className:B("overflow-x-auto overflow-y-hidden relative",t===0&&"-ml-[104px] pl-24 sm:-ml-12 sm:pl-12"),onScroll:()=>In.emit("removeHoverMenu"),children:r.jsx("table",{ref:n,className:"w-max mt-3 mx-2 mb-[18px]",children:r.jsx(Lle,{tableId:e,indexRanges:a})})})})})}),Ole=zt.memo(e=>{const t=_e(e.id,["data","local"],["segments"]),n=of(e.level),s=Pr(e.id),a=sr(),o=F.useMemo(()=>!de(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),i=F.useRef(null),l=gh(e.id,i,o,e.level),{paddingLeft:c,paddingRight:u}=af(e.id,e.level);return F.useEffect(()=>{t!=null&&t.local&&(setTimeout(()=>{if(!a.current)return;const d=a.current.querySelector(`[data-block-id='${e.id}']`);d&&d.scrollIntoView({block:"nearest",behavior:"auto"})},150),pe(e.id,{local:!1},!0))},[e.id,t==null?void 0:t.local,a]),t?r.jsx(Or,{id:e.id,ref:i,level:e.level,style:{minWidth:l},children:r.jsx(uo,{placeholder:n,uuid:e.id,className:"whitespace-pre-wrap break-words",segments:t.data.segments,onChange:(d,f,h)=>{s(d,[f,h])},style:{paddingLeft:`${c}px`,paddingRight:`${u}px`}})}):null}),Mle=zt.memo(e=>{const t=_e(e.id,["data"],["segments","checked"]),n=of(e.level),s=Pr(e.id),a=ke(),o=F.useMemo(()=>!de(t==null?void 0:t.data.segments),[t==null?void 0:t.data.segments]),i=F.useRef(null),l=gh(e.id,i,o,e.level),c=Ve(e.id),{paddingRight:u}=af(e.id,e.level);if(!t)return null;const{checked:d}=t.data;return r.jsx(Or,{id:e.id,ref:i,className:"flex items-center",level:e.level,style:{paddingLeft:"8px",minWidth:l},children:r.jsx(_3,{symbolClassName:"disable-select",symbol:r.jsx(Ra,{size:"large",checked:d,onClick:f=>{c||(f.stopPropagation(),a(()=>{ck({data:{checked:!d}},e.id)}))}}),editorNode:r.jsx(uo,{placeholder:n,uuid:e.id,className:B("whitespace-pre-wrap break-words self-start",d?"opacity-50":"no-underline",{"line-through":d}),segments:t.data.segments,onChange:(f,h,p)=>{s(f,[h,p])},style:{paddingRight:`${u}px`}})})})}),lP=new Map;let cP;const Ule=e=>{cP=e},Ts=(e,t)=>{lP.set(e,t)},Vle=e=>(_e(e.id,[]),null),qle=[m.BlockType.DIVIDER,m.BlockType.PDF_ANNOTATION],Hle=(e,t)=>{if(e===void 0)return Vle;if(t===0)return jle;if(qle.includes(e))return null;const n=lP.get(e);return n||cP};Ule(Ole);Ts(m.BlockType.FILE,mle);Ts(m.BlockType.TABLE,Ple);Ts(m.BlockType.ORDER_LIST,hle);Ts(m.BlockType.QUOTE,Ile);Ts(m.BlockType.LIST,Zie);Ts(m.BlockType.MARK,tle);Ts(m.BlockType.BOOKMARK,Qie);Ts(m.BlockType.EQUATION,dle);Ts(m.BlockType.CODE,ale);Ts(m.BlockType.PAGE,hl);Ts(m.BlockType.COLLECTION_VIEW_PAGE,hl);Ts(m.BlockType.COLLECTION_VIEW,hl);Ts(m.BlockType.REFERENCE_COLLECTION_PAGE,w3);Ts(m.BlockType.MIND_MAPPING,hl);Ts(m.BlockType.MIND_MAPPING_PAGE,hl);Ts(m.BlockType.FOLDER,hl);Ts(m.BlockType.REFERENCE,w3);Ts(m.BlockType.REFERENCE_COLLECTION,w3);Ts(m.BlockType.EXTERNAL_FILE,x3);Ts(m.BlockType.EMBED,lle);Ts(m.BlockType.TODO,Mle);Ts(m.BlockType.SYNC_REFERENCE,ly);Ts(m.BlockType.SYNC_CONTAINER,ly);Ts(m.BlockType.COLUMN,ly);Ts(m.BlockType.COLUMN_LIST,ly);const B0=F.memo(e=>{const t=_e(e.id,["subNodes","data"]),n=Hle(t==null?void 0:t.type,e.level),[s=!0]=cu(e.id);return!t||!n?null:r.jsxs(Nd,{scope:Gm,initialValues:[[zm,e.id]],children:[r.jsx(n,{id:e.id,level:e.level}),s&&!(M9.includes(t.type)&&e.level!==0)&&t.subNodes.map(a=>r.jsx(B0,{id:a,level:e.level+1},a))]})}),$le=50,e4=50,V_=5,t4=5,{autoScroll:Gle,raf:n4}=lB(),zle=()=>{const e=Xr(),t=Dd(),n=F.useRef(null),s=F.useRef(),[a,o]=F.useState(),i=On(),l=gt();return F.useEffect(()=>{const c=jn(".next-space-page",i);if(!c||e||t)return;const u=()=>{s.current=void 0,n.current=null,o(void 0),cancelAnimationFrame(n4.id),qt.removeEventListener("mousemove",f),qt.removeEventListener("mouseup",u)},d=p=>{if(wt.$blockMenuListId||p.button!==0||document.querySelector('[data-modal-id="SETTING"]'))return;const g=p.target;if(g.closest("[data-disable-select], [data-draggable], [data-property-id], [data-ignore-draggable]"))return;const _=i?".right-panel":".main-panel";n.current=g.closest(`${_} [data-block-id]`),s.current=[p.clientX,p.clientY,c.scrollTop],qt.addEventListener("mousemove",f),qt.addEventListener("mouseup",u)},f=p=>{const g=s.current&&Math.abs(s.current[0]-p.clientX)<t4&&Math.abs(s.current[1]-p.clientY)<t4;if(!(!s.current||g||K.ui.selectedCells.length>0)){if(n.current){const _=n.current.getBoundingClientRect(),x=n.current.dataset.blockId,y=l===x,b=x&&K.blocks[x];let E=!0;b&&[m.BlockType.COLLECTION_VIEW].includes(b.type)&&(E=!1);const w=_.left-(E?e4:V_),k=_.right+(E?e4:V_),C=_.top-V_,T=_.bottom+V_;if((y||p.clientX>w&&p.clientX<k)&&p.clientY>C&&p.clientY<T)return}n.current=null,window.getSelection().removeAllRanges(),document.dispatchEvent(new Event("_clearTextSelection")),Gle(p.clientX,p.clientY,c,$le),o([p.clientX,p.clientY,c.scrollTop])}},h=()=>{o(p=>{if(!p)return p;const[g,_]=p;return[g,_,c.scrollTop]})};return c.addEventListener("scroll",h),c.addEventListener("mousedown",d),()=>{s.current=void 0,cancelAnimationFrame(n4.id),c.removeEventListener("scroll",h),c.removeEventListener("mousedown",d),qt.removeEventListener("mouseup",u),qt.removeEventListener("mousemove",f)}},[t,e,i]),F.useMemo(()=>{if(!s.current||!a)return;const[c,u,d]=s.current,[f,h,p]=a,g=p-d,_=u-g,x=Math.min(c,f),y=Math.min(_,h),b=Math.abs(h-_),E=Math.abs(f-c);return{top:y,left:x,width:E,height:b}},[a])},Wle=({type:e="page"})=>{const t=Dd(),n=On(),s=zle(),a=F.useRef(new Map),o=km(),i=()=>{K.ui.selectedBlocks.length===0&&K.ui.selectedCells.length===0||ee(nt.update({selectedBlocks:[],selectedCells:[]}))};F.useEffect(()=>{var k,C;if(o)return;const c=document.getElementById("root");if(!s||t){Ye({$isSelecting:!1}),c==null||c.classList.remove("selecting"),a.current=new Map;return}wt.$isSelecting||(Ye({$isSelecting:!0}),c==null||c.classList.add("selecting"),a.current=new Map,ka());const{blocks:u}=K,d=jn("[data-mind-page-id]",n);if(!d)return;const f=(k=d.firstElementChild)==null?void 0:k.getBoundingClientRect();if(!f)return;const h=[],p=[],g=ug(".next-space-page [data-block-id]",n),{collectionViews:_}=le();for(const T of g){const{blockId:v,viewId:I,groupValue:j,subGroupValue:D,syncId:S}=T.dataset;if(!v)return;const R=a.current.get(v),A=I&&((C=_[I])==null?void 0:C.type)===m.CollectionViewType.CALENDAR;if(R){if(A||j){const L=T.getBoundingClientRect(),P={left:L.left,width:L.width,height:L.height,offsetTop:L.top-f.top,viewId:I,groupValue:j,subGroupValue:D,syncId:S};a.current.set(v,JI(R.concat(P),rn))}}else{const L=T.getBoundingClientRect(),P={left:L.left,width:L.width,height:L.height,offsetTop:L.top-f.top,viewId:I,groupValue:j,subGroupValue:D,syncId:S};a.current.set(v,[P])}}let x,y,b,E;for(const[T,v]of a.current){let I=!1,j;const D=[];if(v.forEach((P,M)=>{const U={left:P.left,top:f.top+P.offsetTop,width:P.width,height:P.height};M===0&&(j=U),mL(U,s)&&(D.push(P),I=!0)}),!I||!j)continue;const S=u[T];if(!S||S.type===m.BlockType.COLUMN_LIST)continue;const R=u[S.parentId];if(!R)continue;(!x||j.top<x)&&(x=j.top,b=S),(!y||j.top>y)&&(y=j.top,E=S);const A=D[0];if(!A)return;const L={blockId:T,viewId:A.viewId,syncId:A.syncId};if(A.groupValue){const P={};D.forEach(M=>{var V;const{groupValue:U}=M;if(U){const W=(V=P[U!=null?U:""])!=null?V:[];P[U]=M.subGroupValue?W.concat(M.subGroupValue):W}}),L.groupValues=P}R.type===m.BlockType.COLUMN?p.push(L):h.push(L)}if(!b||!E){i();return}let w=[...h,...p];w=w.filter(T=>{const v=K.blocks[T.blockId],I=v==null?void 0:v.parentId;if(I){const j=K.blocks[I];if(j&&Wr(j.type)){const{role:D}=hn(T.blockId);return D!==m.PermissionRole.READER}}return!0}),rn(w,K.ui.selectedBlocks)||ee(nt.updateSelectBlocks(w))},[s,t,e,n,o]);const l=F.useMemo(()=>{var c;if(n&&(s!=null&&s.left)&&!ZI){const u=(c=document.querySelector(".main-panel .next-space-page"))==null?void 0:c.getBoundingClientRect().right;return u?s.left-u:void 0}return s==null?void 0:s.left},[n,s==null?void 0:s.left]);return r.jsx("div",{style:{...s,left:l,zIndex:1e3},className:"fixed bg-active_color opacity-[0.12] pointer-events-none"})},Kle=e=>{const t=F.useRef(null),n=sr(),{mindMapStyle:s,mindMapLineStyle:a}=o_(e.id),o=Ws(),i=Ve(e.id),l=B9(e.id);Oie(n,t),Pie(n),u3(n);const c=tC();return nA(n.current,u=>{var h;const[d,f]=o.getSize();if(u.width&&u.height&&(o.setSize(u.width,u.height),d&&f)){const p=Math.floor(u.width-d),g=Math.floor(u.height-f);(h=n.current)==null||h.scrollBy({left:p,top:g})}},"all"),F.useEffect(()=>{setTimeout(()=>{o.setAlignSiblingNode(l)},l?300:0)},[l,o]),F.useEffect(()=>{o.setRootId(e.id),o.setDirection(s,!0),o.setLineStyle(a)},[o,a,s,e.id]),F.useEffect(()=>{var d;if(!n.current||!t.current)return;const u=(d=n.current)==null?void 0:d.getBoundingClientRect();u&&o.setSize(u.width,u.height),o.setContainer(t.current),o.setScroller(n.current)},[o,n]),Em(()=>{o.destroy()}),F.useEffect(()=>($9(e.id,o),()=>{G9(e.id)}),[o,e.id]),F.useEffect(()=>{if(Ok(K,e.id,e.id)>1e3){const d=K.blocks[e.id];d!=null&&d.subNodes&&Po(d.subNodes,!1,!1)}},[e.id]),r.jsxs(r.Fragment,{children:[r.jsxs(Q9,{ref:t,id:e.id,children:[r.jsx(Eie,{container:t}),r.jsx(Z9,{}),r.jsx(B0,{id:e.id,level:0}),l&&r.jsx(lie,{children:r.jsx(B0,{id:e.id,level:0})}),r.jsx(J9,{})]}),r.jsx(L9,{id:e.id}),r.jsx(_ie,{id:e.id}),r.jsx(xie,{id:e.id}),!c&&r.jsx(os,{className:"absolute left-0 top-0"}),!i&&r.jsx(Wle,{})]})},uP=e=>{const t=_e(e.uuid,[]),n=F.useRef(null),s=On(),a=dr(()=>new eA({getAllElement:()=>{var o;return(o=n.current)==null?void 0:o.querySelectorAll("[data-block-id]")},getCanvasPosition:(o,i,l)=>{if(n.current){const u=o.getState().scale*.01,d=n.current.querySelector(".node-drawer"),f=d==null?void 0:d.getBoundingClientRect();if(!f)return[i,l];const h=i-f.left,p=l-f.top;return[h/u,p/u]}return[i,l]},supportAppendChild:o=>z9(o),getLineColor:o=>ld(o)}));return F.useEffect(()=>{var l;const o=$n(W9,200),i=a.addScaleListener({onScaleChange:(c,u)=>{o(c,u,!1)}});return a.zoom((l=K9(e.uuid,!1))!=null?l:100),i},[a,e.uuid]),t?r.jsx(io.Provider,{value:a,children:r.jsx(jl,{children:r.jsx(mi.Provider,{value:s?zc.RIGHT_PAGE:void 0,children:r.jsx(au.Provider,{value:n,children:r.jsx("div",{className:"w-full next-space-page mind-page overflow-auto h-full",ref:n,"data-mind-page-id":e.uuid,children:r.jsx(Kle,{id:e.uuid},e.uuid)})})})})}):r.jsx($m,{})},dP=({uuid:e})=>{const t=ae(({blocks:a})=>a[e]),{illegal:n}=it(e);if(n)return r.jsx(Qx,{uuid:e});let s=null;switch(t==null?void 0:t.type){case m.BlockType.PAGE:{s=r.jsx(S0,{uuid:e});break}case m.BlockType.REFERENCE_COLLECTION:case m.BlockType.REFERENCE_COLLECTION_PAGE:case m.BlockType.COLLECTION_VIEW:case m.BlockType.COLLECTION_VIEW_PAGE:{s=r.jsx(E9,{uuid:e});break}case m.BlockType.FOLDER:{s=r.jsx(A9,{uuid:e});break}case m.BlockType.MIND_MAPPING:case m.BlockType.MIND_MAPPING_PAGE:{s=r.jsx(uP,{uuid:e});break}default:e?s=r.jsx($m,{showBackButton:!1}):s=r.jsx(S0,{uuid:e});break}return s},Yle=e=>{const{visible:t,placeholder:n,children:s}=e;return t?r.jsx(r.Fragment,{children:s}):r.jsx(r.Fragment,{children:n})},Xle=({id:e,root:t})=>{var d;const n=Os(),s=_e(e,["data","local"],["link","icon","description","cover","linkInfo","headers"]),a=ke(),o=Ve(e),[i,l]=Li();F.useEffect(()=>{pe(e,{local:!1},!0)},[e]),F.useEffect(()=>{var f;!(s!=null&&s.data.link)||!i||s.data.linkInfo||s.data.cover||s.data.description||(f=s.data.icon)!=null&&f.value||s.data.headers||jc(s.data.link).then(h=>{if(!h)return;const p={link:h.link,linkInfo:mt(h.title),cover:h.cover,icon:{type:"http",value:h.icon},description:mt(h.description)};o?pe(s.uuid,{data:{...s.data,...p}},!0):a(()=>{pe(s.uuid,{data:p})})})},[s,o,a,i]);const{title:c,description:u}=F.useMemo(()=>({title:de(s==null?void 0:s.data.linkInfo),description:de(s==null?void 0:s.data.description)}),[s==null?void 0:s.data.description,s==null?void 0:s.data.linkInfo]);return s?r.jsxs("div",{className:"relative","data-block-id":e,"data-horizontal":t,"data-sync-id":n,ref:l,children:[r.jsx(Yle,{visible:i,placeholder:r.jsxs("div",{className:"h-[89px] my-1 text-t4 text-grey3",children:[r.jsx("p",{children:c}),r.jsx("p",{children:u}),r.jsx("p",{children:s.data.link})]}),children:r.jsx(ln,{id:e,className:"my-1 rounded line-default",horizontal:t,children:r.jsx(eP,{readonly:o,title:c,cover:s.data.cover,description:u,icon:(d=s.data.icon)==null?void 0:d.value,url:s.data.link,onUrlInput:f=>{jc(f).then(h=>{a(()=>{var p;pe(s.uuid,{data:{link:(p=h==null?void 0:h.link)!=null?p:f,linkInfo:mt(h==null?void 0:h.title),cover:h==null?void 0:h.cover,icon:{type:"http",value:h==null?void 0:h.icon},description:mt(h==null?void 0:h.description),headers:h==null?void 0:h.headerMap}})})})},defaultOpenInputPanel:!!s.local,loading:!1})})}),r.jsx(wo,{blockId:e})]}):null},Qle=e=>{if(e.createRange){const n=e.createRange();if(n.getBoundingClientRect){const s=e.createElement("boundtest");s.style.height="123px",s.style.display="block",e.body.appendChild(s),n.selectNode(s);const a=n.getBoundingClientRect(),o=Math.round(a.height);if(e.body.removeChild(s),o===123)return!0}}return!1},Jle=e=>{const t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);const n=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";const s=t.firstChild,a=KE(s.data).map(c=>ar(c));let o=0,i={};const l=a.every((c,u)=>{n.setStart(s,o),n.setEnd(s,o+c.length);const d=n.getBoundingClientRect();o+=c.length;const f=d.x>i.x||d.y>i.y;return i=d,u===0?!0:f});return e.body.removeChild(t),l},Zle=()=>typeof new Image().crossOrigin<"u",ece=()=>typeof new XMLHttpRequest().responseType=="string",tce=e=>{const t=new Image,n=e.createElement("canvas"),s=n.getContext("2d");if(!s)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{s.drawImage(t,0,0),n.toDataURL()}catch(a){return!1}return!0},s4=e=>e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255,nce=e=>{const t=e.createElement("canvas"),n=100;t.width=n,t.height=n;const s=t.getContext("2d");if(!s)return Promise.reject(!1);s.fillStyle="rgb(0, 255, 0)",s.fillRect(0,0,n,n);const a=new Image,o=t.toDataURL();a.src=o;const i=cE(n,n,0,0,a);return s.fillStyle="red",s.fillRect(0,0,n,n),r4(i).then(l=>{s.drawImage(l,0,0);const{data:c}=s.getImageData(0,0,n,n);s.fillStyle="red",s.fillRect(0,0,n,n);const u=e.createElement("div");return u.style.backgroundImage=`url(${o})`,u.style.height=`${n}px`,s4(c)?r4(cE(n,n,0,0,u)):Promise.reject(!1)}).then(l=>(s.drawImage(l,0,0),s4(s.getImageData(0,0,n,n).data))).catch(()=>!1)},cE=(e,t,n,s,a)=>{const o="http://www.w3.org/2000/svg",i=document.createElementNS(o,"svg"),l=document.createElementNS(o,"foreignObject");return i.setAttributeNS(null,"width",e.toString()),i.setAttributeNS(null,"height",t.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",n.toString()),l.setAttributeNS(null,"y",s.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),i.appendChild(l),l.appendChild(a),i},r4=e=>new Promise((t,n)=>{const s=new Image;s.onload=()=>t(s),s.onerror=n,s.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(new XMLSerializer().serializeToString(e))}`}),Vr={get SUPPORT_RANGE_BOUNDS(){const e=Qle(document);return Object.defineProperty(Vr,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){const e=Vr.SUPPORT_RANGE_BOUNDS&&Jle(document);return Object.defineProperty(Vr,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){const e=tce(document);return Object.defineProperty(Vr,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){const e=typeof Array.from=="function"&&typeof window.fetch=="function"?nce(document):Promise.resolve(!1);return Object.defineProperty(Vr,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){const e=Zle();return Object.defineProperty(Vr,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){const e=ece();return Object.defineProperty(Vr,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){const e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Vr,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){const e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Vr,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Kl=class{static getOrigin(t){const n=Kl._link;return n?(n.href=t,n.href=n.href,n.protocol+n.hostname+n.port):"about:blank"}static isSameOrigin(t){return Kl.getOrigin(t)===Kl._origin}static setContext(t){Kl._link=t.document.createElement("a"),Kl._origin=Kl.getOrigin(t.location.href)}};let Bf=Kl;q(Bf,"_link"),q(Bf,"_origin","about:blank");class sce{constructor(t,n){q(this,"_cache",{});this.context=t,this._options=n}addImage(t){const n=Promise.resolve();return this.has(t)||(vb(t)||ice(t))&&(this._cache[t]=this.loadImage(t)).catch(()=>{}),n}match(t){return this._cache[t]}async loadImage(t){const n=Bf.isSameOrigin(t),s=!Tb(t)&&this._options.useCORS===!0&&Vr.SUPPORT_CORS_IMAGES&&!n,a=!Tb(t)&&!n&&!vb(t)&&typeof this._options.proxy=="string"&&Vr.SUPPORT_CORS_XHR&&!s;if(!n&&this._options.allowTaint===!1&&!Tb(t)&&!vb(t)&&!a&&!s)return;let o=t;return a&&(o=await this.proxy(o)),this.context.logger.debug(`Added image ${t.substring(0,256)}`),await new Promise((i,l)=>{const c=new Image;c.onload=()=>i(c),c.onerror=l,(lce(o)||s)&&(c.crossOrigin="anonymous"),c.src=o,c.complete===!0&&setTimeout(()=>i(c),500),this._options.imageTimeout>0&&setTimeout(()=>l(`Timed out (${this._options.imageTimeout}ms) loading image`),this._options.imageTimeout)})}has(t){return typeof this._cache[t]<"u"}keys(){return Promise.resolve(Object.keys(this._cache))}proxy(t){const{proxy:n}=this._options;if(!n)throw new Error("No proxy defined");const s=t.substring(0,256);return new Promise((a,o)=>{const i=Vr.SUPPORT_RESPONSE_TYPE?"blob":"text",l=new XMLHttpRequest;l.onload=()=>{if(l.status===200)if(i==="text")a(l.response);else{const u=new FileReader;u.addEventListener("load",()=>a(u.result),!1),u.addEventListener("error",d=>o(d),!1),u.readAsDataURL(l.response)}else o(`Failed to proxy resource ${s} with status code ${l.status}`)},l.onerror=o;const c=n.indexOf("?")>-1?"&":"?";if(l.open("GET",`${n}${c}url=${encodeURIComponent(t)}&responseType=${i}`),i!=="text"&&l instanceof XMLHttpRequest&&(l.responseType=i),this._options.imageTimeout){const u=this._options.imageTimeout;l.timeout=u,l.ontimeout=()=>o(`Timed out (${u}ms) proxying ${s}`)}l.send()})}}const rce=/^data:image\/svg\+xml/i,ace=/^data:image\/.*;base64,/i,oce=/^data:image\/.*/i,ice=e=>Vr.SUPPORT_SVG_DRAWING||!cce(e),Tb=e=>oce.test(e),lce=e=>ace.test(e),vb=e=>e.substr(0,4)==="blob",cce=e=>e.substr(-3).toLowerCase()==="svg"||rce.test(e);class fP{constructor({id:t,enabled:n}){q(this,"id");q(this,"enabled");q(this,"start");this.id=t,this.enabled=n,this.start=Date.now()}debug(...t){this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug(this.id,`${this.getTime()}ms`,...t):this.info(...t))}getTime(){return Date.now()-this.start}info(...t){this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info(this.id,`${this.getTime()}ms`,...t)}warn(...t){this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn(this.id,`${this.getTime()}ms`,...t):this.info(...t))}error(...t){this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error(this.id,`${this.getTime()}ms`,...t):this.info(...t))}}q(fP,"instances",{});const q3=class{constructor(t,n){q(this,"instanceName",`#${q3.instanceCount++}`);q(this,"logger");q(this,"cache");var s;this.windowBounds=n,this.logger=new fP({id:this.instanceName,enabled:t.logging}),this.cache=(s=t.cache)!=null?s:new sce(this,t)}};let F1=q3;q(F1,"instanceCount",1);const Au=class{constructor(t,n,s,a){this.left=t,this.top=n,this.width=s,this.height=a}add(t,n,s,a){return new Au(this.left+t,this.top+n,this.width+s,this.height+a)}static fromClientRect(t,n){return new Au(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height)}static fromDOMRectList(t,n){const s=Array.from(n).find(a=>a.width!==0);return s?new Au(s.left+t.windowBounds.left,s.top+t.windowBounds.top,s.width,s.height):Au.EMPTY}};let ko=Au;q(ko,"EMPTY",new Au(0,0,0,0));const dy=(e,t)=>ko.fromClientRect(e,t.getBoundingClientRect()),uce=e=>{const{body:t}=e,{documentElement:n}=e;if(!t||!n)throw new Error("Unable to get document size");const s=Math.max(Math.max(t.scrollWidth,n.scrollWidth),Math.max(t.offsetWidth,n.offsetWidth),Math.max(t.clientWidth,n.clientWidth)),a=Math.max(Math.max(t.scrollHeight,n.scrollHeight),Math.max(t.offsetHeight,n.offsetHeight),Math.max(t.clientHeight,n.clientHeight));return new ko(0,0,s,a)};var lt=(e=>(e[e.STRING_TOKEN=0]="STRING_TOKEN",e[e.BAD_STRING_TOKEN=1]="BAD_STRING_TOKEN",e[e.LEFT_PARENTHESIS_TOKEN=2]="LEFT_PARENTHESIS_TOKEN",e[e.RIGHT_PARENTHESIS_TOKEN=3]="RIGHT_PARENTHESIS_TOKEN",e[e.COMMA_TOKEN=4]="COMMA_TOKEN",e[e.HASH_TOKEN=5]="HASH_TOKEN",e[e.DELIM_TOKEN=6]="DELIM_TOKEN",e[e.AT_KEYWORD_TOKEN=7]="AT_KEYWORD_TOKEN",e[e.PREFIX_MATCH_TOKEN=8]="PREFIX_MATCH_TOKEN",e[e.DASH_MATCH_TOKEN=9]="DASH_MATCH_TOKEN",e[e.INCLUDE_MATCH_TOKEN=10]="INCLUDE_MATCH_TOKEN",e[e.LEFT_CURLY_BRACKET_TOKEN=11]="LEFT_CURLY_BRACKET_TOKEN",e[e.RIGHT_CURLY_BRACKET_TOKEN=12]="RIGHT_CURLY_BRACKET_TOKEN",e[e.SUFFIX_MATCH_TOKEN=13]="SUFFIX_MATCH_TOKEN",e[e.SUBSTRING_MATCH_TOKEN=14]="SUBSTRING_MATCH_TOKEN",e[e.DIMENSION_TOKEN=15]="DIMENSION_TOKEN",e[e.PERCENTAGE_TOKEN=16]="PERCENTAGE_TOKEN",e[e.NUMBER_TOKEN=17]="NUMBER_TOKEN",e[e.FUNCTION=18]="FUNCTION",e[e.FUNCTION_TOKEN=19]="FUNCTION_TOKEN",e[e.IDENT_TOKEN=20]="IDENT_TOKEN",e[e.COLUMN_TOKEN=21]="COLUMN_TOKEN",e[e.URL_TOKEN=22]="URL_TOKEN",e[e.BAD_URL_TOKEN=23]="BAD_URL_TOKEN",e[e.CDC_TOKEN=24]="CDC_TOKEN",e[e.CDO_TOKEN=25]="CDO_TOKEN",e[e.COLON_TOKEN=26]="COLON_TOKEN",e[e.SEMICOLON_TOKEN=27]="SEMICOLON_TOKEN",e[e.LEFT_SQUARE_BRACKET_TOKEN=28]="LEFT_SQUARE_BRACKET_TOKEN",e[e.RIGHT_SQUARE_BRACKET_TOKEN=29]="RIGHT_SQUARE_BRACKET_TOKEN",e[e.UNICODE_RANGE_TOKEN=30]="UNICODE_RANGE_TOKEN",e[e.WHITESPACE_TOKEN=31]="WHITESPACE_TOKEN",e[e.EOF_TOKEN=32]="EOF_TOKEN",e))(lt||{});const dce=1<<0,fce=1<<1,l_=1<<2,Nb=1<<3,L0=10,a4=47,Xh=92,mce=9,hce=32,q_=34,Nh=61,pce=35,gce=36,_ce=37,H_=39,$_=40,Ih=41,xce=95,va=45,Fce=33,yce=60,bce=62,Ece=64,wce=91,kce=93,Cce=61,Tce=123,G_=63,vce=125,o4=124,Nce=126,Ice=128,i4=65533,Ib=42,qu=43,jce=44,Dce=58,Sce=59,Ap=46,Rce=0,Ace=8,Bce=11,Lce=14,Pce=31,Oce=127,gi=-1,mP=48,hP=97,pP=101,Mce=102,Uce=117,Vce=122,gP=65,_P=69,xP=70,qce=85,Hce=90,ta=e=>e>=mP&&e<=57,$ce=e=>e>=55296&&e<=57343,pf=e=>ta(e)||e>=gP&&e<=xP||e>=hP&&e<=Mce,Gce=e=>e>=hP&&e<=Vce,zce=e=>e>=gP&&e<=Hce,Wce=e=>Gce(e)||zce(e),Kce=e=>e>=Ice,z_=e=>e===L0||e===mce||e===hce,P0=e=>Wce(e)||Kce(e)||e===xce,l4=e=>P0(e)||ta(e)||e===va,Yce=e=>e>=Rce&&e<=Ace||e===Bce||e>=Lce&&e<=Pce||e===Oce,Wl=(e,t)=>e!==Xh?!1:t!==L0,W_=(e,t,n)=>e===va?P0(t)||Wl(t,n):P0(e)?!0:!!(e===Xh&&Wl(e,t)),jb=(e,t,n)=>e===qu||e===va?ta(t)?!0:t===Ap&&ta(n):ta(e===Ap?t:e),Xce=e=>{let t=0,n=1;(e[t]===qu||e[t]===va)&&(e[t]===va&&(n=-1),t++);const s=[];for(;ta(e[t]);)s.push(e[t++]);const a=s.length?parseInt(ar(...s),10):0;e[t]===Ap&&t++;const o=[];for(;ta(e[t]);)o.push(e[t++]);const i=o.length,l=i?parseInt(ar(...o),10):0;(e[t]===_P||e[t]===pP)&&t++;let c=1;(e[t]===qu||e[t]===va)&&(e[t]===va&&(c=-1),t++);const u=[];for(;ta(e[t]);)u.push(e[t++]);const d=u.length?parseInt(ar(...u),10):0;return n*(a+l*Math.pow(10,-i))*Math.pow(10,c*d)},Qce={type:2},Jce={type:3},Zce={type:4},eue={type:13},tue={type:8},nue={type:21},sue={type:9},rue={type:10},aue={type:11},oue={type:12},iue={type:14},K_={type:23},lue={type:1},cue={type:25},uue={type:24},due={type:26},fue={type:27},mue={type:28},hue={type:29},pue={type:31},uE={type:32};class FP{constructor(){q(this,"_value");this._value=[]}write(t){this._value=this._value.concat(KE(t))}read(){const t=[];let n=this.consumeToken();for(;n!==uE;)t.push(n),n=this.consumeToken();return t}consumeToken(){const t=this.consumeCodePoint();switch(t){case q_:return this.consumeStringToken(q_);case pce:const n=this.peekCodePoint(0),s=this.peekCodePoint(1),a=this.peekCodePoint(2);if(l4(n)||Wl(s,a)){const p=W_(n,s,a)?fce:dce;return{type:5,value:this.consumeName(),flags:p}}break;case gce:if(this.peekCodePoint(0)===Nh)return this.consumeCodePoint(),eue;break;case H_:return this.consumeStringToken(H_);case $_:return Qce;case Ih:return Jce;case Ib:if(this.peekCodePoint(0)===Nh)return this.consumeCodePoint(),iue;break;case qu:if(jb(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case jce:return Zce;case va:const o=t,i=this.peekCodePoint(0),l=this.peekCodePoint(1);if(jb(o,i,l))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(W_(o,i,l))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(i===va&&l===bce)return this.consumeCodePoint(),this.consumeCodePoint(),uue;break;case Ap:if(jb(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case a4:if(this.peekCodePoint(0)===Ib)for(this.consumeCodePoint();;){let p=this.consumeCodePoint();if(p===Ib&&(p=this.consumeCodePoint(),p===a4))return this.consumeToken();if(p===gi)return this.consumeToken()}break;case Dce:return due;case Sce:return fue;case yce:if(this.peekCodePoint(0)===Fce&&this.peekCodePoint(1)===va&&this.peekCodePoint(2)===va)return this.consumeCodePoint(),this.consumeCodePoint(),cue;break;case Ece:const c=this.peekCodePoint(0),u=this.peekCodePoint(1),d=this.peekCodePoint(2);if(W_(c,u,d))return{type:7,value:this.consumeName()};break;case wce:return mue;case Xh:if(Wl(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case kce:return hue;case Cce:if(this.peekCodePoint(0)===Nh)return this.consumeCodePoint(),tue;break;case Tce:return aue;case vce:return oue;case Uce:case qce:const f=this.peekCodePoint(0),h=this.peekCodePoint(1);return f===qu&&(pf(h)||h===G_)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case o4:if(this.peekCodePoint(0)===Nh)return this.consumeCodePoint(),sue;if(this.peekCodePoint(0)===o4)return this.consumeCodePoint(),nue;break;case Nce:if(this.peekCodePoint(0)===Nh)return this.consumeCodePoint(),rue;break;case gi:return uE}return z_(t)?(this.consumeWhiteSpace(),pue):ta(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):P0(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:ar(t)}}consumeCodePoint(){const t=this._value.shift();return typeof t>"u"?-1:t}reconsumeCodePoint(t){this._value.unshift(t)}peekCodePoint(t){return t>=this._value.length?-1:this._value[t]}consumeUnicodeRangeToken(){const t=[];let n=this.consumeCodePoint();for(;pf(n)&&t.length<6;)t.push(n),n=this.consumeCodePoint();let s=!1;for(;n===G_&&t.length<6;)t.push(n),n=this.consumeCodePoint(),s=!0;if(s){const o=parseInt(ar(...t.map(l=>l===G_?mP:l)),16),i=parseInt(ar(...t.map(l=>l===G_?xP:l)),16);return{type:30,start:o,end:i}}const a=parseInt(ar(...t),16);if(this.peekCodePoint(0)===va&&pf(this.peekCodePoint(1))){this.consumeCodePoint(),n=this.consumeCodePoint();const o=[];for(;pf(n)&&o.length<6;)o.push(n),n=this.consumeCodePoint();const i=parseInt(ar(...o),16);return{type:30,start:a,end:i}}return{type:30,start:a,end:a}}consumeIdentLikeToken(){const t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===$_?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===$_?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}}consumeUrlToken(){const t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===gi)return{type:22,value:""};const n=this.peekCodePoint(0);if(n===H_||n===q_){const s=this.consumeStringToken(this.consumeCodePoint());return s.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===gi||this.peekCodePoint(0)===Ih)?(this.consumeCodePoint(),{type:22,value:s.value}):(this.consumeBadUrlRemnants(),K_)}for(;;){const s=this.consumeCodePoint();if(s===gi||s===Ih)return{type:22,value:ar(...t)};if(z_(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===gi||this.peekCodePoint(0)===Ih?(this.consumeCodePoint(),{type:22,value:ar(...t)}):(this.consumeBadUrlRemnants(),K_);if(s===q_||s===H_||s===$_||Yce(s))return this.consumeBadUrlRemnants(),K_;if(s===Xh)if(Wl(s,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),K_;else t.push(s)}}consumeWhiteSpace(){for(;z_(this.peekCodePoint(0));)this.consumeCodePoint()}consumeBadUrlRemnants(){for(;;){const t=this.consumeCodePoint();if(t===Ih||t===gi)return;Wl(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}}consumeStringSlice(t){let s="";for(;t>0;){const a=Math.min(5e4,t);s+=ar(...this._value.splice(0,a)),t-=a}return this._value.shift(),s}consumeStringToken(t){let n="",s=0;do{const a=this._value[s];if(a===gi||a===void 0||a===t)return n+=this.consumeStringSlice(s),{type:0,value:n};if(a===L0)return this._value.splice(0,s),lue;if(a===Xh){const o=this._value[s+1];o!==gi&&o!==void 0&&(o===L0?(n+=this.consumeStringSlice(s),s=-1,this._value.shift()):Wl(a,o)&&(n+=this.consumeStringSlice(s),n+=ar(this.consumeEscapedCodePoint()),s=-1))}s++}while(!0)}consumeNumber(){const t=[];let n=l_,s=this.peekCodePoint(0);for((s===qu||s===va)&&t.push(this.consumeCodePoint());ta(this.peekCodePoint(0));)t.push(this.consumeCodePoint());s=this.peekCodePoint(0);let a=this.peekCodePoint(1);if(s===Ap&&ta(a))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),n=Nb;ta(this.peekCodePoint(0));)t.push(this.consumeCodePoint());s=this.peekCodePoint(0),a=this.peekCodePoint(1);const o=this.peekCodePoint(2);if((s===_P||s===pP)&&((a===qu||a===va)&&ta(o)||ta(a)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),n=Nb;ta(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[Xce(t),n]}consumeNumericToken(){const[t=0,n=Nb]=this.consumeNumber(),s=this.peekCodePoint(0),a=this.peekCodePoint(1),o=this.peekCodePoint(2);if(W_(s,a,o)){const i=this.consumeName();return{type:15,number:t,flags:n,unit:i}}return s===_ce?(this.consumeCodePoint(),{type:16,number:t,flags:n}):{type:17,number:t,flags:n}}consumeEscapedCodePoint(){const t=this.consumeCodePoint();if(pf(t)){let n=ar(t);for(;pf(this.peekCodePoint(0))&&n.length<6;)n+=ar(this.consumeCodePoint());z_(this.peekCodePoint(0))&&this.consumeCodePoint();const s=parseInt(n,16);return s===0||$ce(s)||s>1114111?i4:s}return t===gi?i4:t}consumeName(){let t="";for(;;){const n=this.consumeCodePoint();if(l4(n))t+=ar(n);else if(Wl(n,this.peekCodePoint(0)))t+=ar(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(n),t}}}class Kf{constructor(t){q(this,"_tokens");this._tokens=t}static create(t){const n=new FP;return n.write(t),new Kf(n.read())}static parseValue(t){return Kf.create(t).parseComponentValue()}static parseValues(t){return Kf.create(t).parseComponentValues()}parseComponentValue(){let t=this.consumeToken();for(;t.type===lt.WHITESPACE_TOKEN;)t=this.consumeToken();if(t.type===lt.EOF_TOKEN)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);const n=this.consumeComponentValue();do t=this.consumeToken();while(t.type===lt.WHITESPACE_TOKEN);if(t.type===lt.EOF_TOKEN)return n;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")}parseComponentValues(){const t=[];for(;;){const n=this.consumeComponentValue();if(n.type===lt.EOF_TOKEN)return t;t.push(n),t.push()}}consumeComponentValue(){const t=this.consumeToken();switch(t.type){case lt.LEFT_CURLY_BRACKET_TOKEN:case lt.LEFT_SQUARE_BRACKET_TOKEN:case lt.LEFT_PARENTHESIS_TOKEN:return this.consumeSimpleBlock(t.type);case lt.FUNCTION_TOKEN:return this.consumeFunction(t)}return t}consumeSimpleBlock(t){const n={type:t,values:[]};let s=this.consumeToken();for(;;){if(s.type===lt.EOF_TOKEN||_ue(s,t))return n;this.reconsumeToken(s),n.values.push(this.consumeComponentValue()),s=this.consumeToken()}}consumeFunction(t){const n={name:t.value,values:[],type:lt.FUNCTION};for(;;){const s=this.consumeToken();if(s.type===lt.EOF_TOKEN||s.type===lt.RIGHT_PARENTHESIS_TOKEN)return n;this.reconsumeToken(s),n.values.push(this.consumeComponentValue())}}consumeToken(){const t=this._tokens.shift();return typeof t>"u"?uE:t}reconsumeToken(t){this._tokens.unshift(t)}}const c_=e=>e.type===lt.DIMENSION_TOKEN,_h=e=>e.type===lt.NUMBER_TOKEN,ts=e=>e.type===lt.IDENT_TOKEN,gue=e=>e.type===lt.STRING_TOKEN,dE=(e,t)=>ts(e)&&e.value===t,yP=e=>e.type!==lt.WHITESPACE_TOKEN,ym=e=>e.type!==lt.WHITESPACE_TOKEN&&e.type!==lt.COMMA_TOKEN,Ki=e=>{const t=[];let n=[];return e.forEach(s=>{if(s.type===lt.COMMA_TOKEN){if(n.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(n),n=[];return}s.type!==lt.WHITESPACE_TOKEN&&n.push(s)}),n.length&&t.push(n),t},_ue=(e,t)=>t===lt.LEFT_CURLY_BRACKET_TOKEN&&e.type===lt.RIGHT_CURLY_BRACKET_TOKEN||t===lt.LEFT_SQUARE_BRACKET_TOKEN&&e.type===lt.RIGHT_SQUARE_BRACKET_TOKEN?!0:t===lt.LEFT_PARENTHESIS_TOKEN&&e.type===lt.RIGHT_PARENTHESIS_TOKEN,Mc=e=>e.type===lt.NUMBER_TOKEN||e.type===lt.DIMENSION_TOKEN,lr=e=>e.type===lt.PERCENTAGE_TOKEN||Mc(e),bP=e=>e.length>1?[e[0],e[1]]:[e[0]],zr={type:lt.NUMBER_TOKEN,number:0,flags:l_},C3={type:lt.PERCENTAGE_TOKEN,number:50,flags:l_},sc={type:lt.PERCENTAGE_TOKEN,number:100,flags:l_},Ph=(e,t,n)=>{const[s,a]=e;return[ds(s,t),ds(typeof a<"u"?a:s,n)]},ds=(e,t)=>{if(e.type===lt.PERCENTAGE_TOKEN)return e.number/100*t;if(c_(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},EP="deg",wP="grad",kP="rad",CP="turn",fy={name:"angle",parse:(e,t)=>{if(t.type===lt.DIMENSION_TOKEN)switch(t.unit){case EP:return Math.PI*t.number/180;case wP:return Math.PI/200*t.number;case kP:return t.number;case CP:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},TP=e=>e?e.type===lt.DIMENSION_TOKEN&&(e.unit===EP||e.unit===wP||e.unit===kP||e.unit===CP):!1,vP=e=>{switch(e.filter(ts).map(n=>n.value).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[zr,zr];case"to top":case"bottom":return Fo(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[zr,sc];case"to right":case"left":return Fo(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[sc,sc];case"to bottom":case"top":return Fo(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[sc,zr];case"to left":case"right":return Fo(270)}return 0},Fo=e=>Math.PI*e/180,fc={name:"color",parse:(e,t)=>{if(t.type===lt.FUNCTION){const n=xue[t.name];if(typeof n>"u")throw new Error(`Attempting to parse an unsupported color function "${t.name}"`);return n(e,t.values)}if(t.type===lt.HASH_TOKEN){if(t.value.length===3){const n=t.value.substring(0,1),s=t.value.substring(1,2),a=t.value.substring(2,3);return rc(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),1)}if(t.value.length===4){const n=t.value.substring(0,1),s=t.value.substring(1,2),a=t.value.substring(2,3),o=t.value.substring(3,4);return rc(parseInt(n+n,16),parseInt(s+s,16),parseInt(a+a,16),parseInt(o+o,16)/255)}if(t.value.length===6){const n=t.value.substring(0,2),s=t.value.substring(2,4),a=t.value.substring(4,6);return rc(parseInt(n,16),parseInt(s,16),parseInt(a,16),1)}if(t.value.length===8){const n=t.value.substring(0,2),s=t.value.substring(2,4),a=t.value.substring(4,6),o=t.value.substring(6,8);return rc(parseInt(n,16),parseInt(s,16),parseInt(a,16),parseInt(o,16)/255)}}if(t.type===lt.IDENT_TOKEN){const n=pl[t.value.toUpperCase()];if(typeof n<"u")return n}return pl.TRANSPARENT}},mc=e=>(255&e)===0,Nr=e=>{const t=255&e,n=255&e>>8,s=255&e>>16,a=255&e>>24;return t<255?`rgba(${a},${s},${n},${t/255})`:`rgb(${a},${s},${n})`},rc=(e,t,n,s)=>(e<<24|t<<16|n<<8|Math.round(s*255)<<0)>>>0,c4=(e,t)=>{if(e.type===lt.NUMBER_TOKEN)return e.number;if(e.type===lt.PERCENTAGE_TOKEN){const n=t===3?1:255;return t===3?e.number/100*n:Math.round(e.number/100*n)}return 0},u4=(e,t)=>{const n=t.filter(ym);if(n.length===3){const[s,a,o]=n.map(c4);return rc(s,a,o,1)}if(n.length===4){const[s,a,o,i]=n.map(c4);return rc(s,a,o,i)}return 0};function Db(e,t,n){return n<0&&(n+=1),n>=1&&(n-=1),n<1/6?(t-e)*n*6+e:n<1/2?t:n<2/3?(t-e)*6*(2/3-n)+e:e}const d4=(e,t)=>{const n=t.filter(ym),[s,a,o,i]=n,l=((s==null?void 0:s.type)===lt.NUMBER_TOKEN?Fo(s.number):fy.parse(e,s))/(Math.PI*2),c=lr(a)?a.number/100:0,u=lr(o)?o.number/100:0,d=typeof i<"u"&&lr(i)?ds(i,1):1;if(c===0)return rc(u*255,u*255,u*255,1);const f=u<=.5?u*(c+1):u+c-u*c,h=u*2-f,p=Db(h,f,l+1/3),g=Db(h,f,l),_=Db(h,f,l-1/3);return rc(p*255,g*255,_*255,d)},xue={hsl:d4,hsla:d4,rgb:u4,rgba:u4},Qh=(e,t)=>fc.parse(e,Kf.create(t).parseComponentValue()),pl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Fue="data-html2canvas-debug";var O0=(e=>(e[e.NONE=0]="NONE",e[e.ALL=1]="ALL",e[e.CLONE=2]="CLONE",e[e.PARSE=3]="PARSE",e[e.RENDER=4]="RENDER",e))(O0||{});const yue=e=>{switch(e.getAttribute(Fue)){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},fE=(e,t)=>{const n=yue(e);return n===1||t===n},_r=(e,t)=>(e&t)!==0;var Lt=(e=>(e[e.VALUE=0]="VALUE",e[e.LIST=1]="LIST",e[e.IDENT_VALUE=2]="IDENT_VALUE",e[e.TYPE_VALUE=3]="TYPE_VALUE",e[e.TOKEN_VALUE=4]="TOKEN_VALUE",e))(Lt||{}),td=(e=>(e[e.BORDER_BOX=0]="BORDER_BOX",e[e.PADDING_BOX=1]="PADDING_BOX",e[e.CONTENT_BOX=2]="CONTENT_BOX",e))(td||{});const bue={name:"background-clip",initialValue:"border-box",prefix:!1,type:Lt.LIST,parse:(e,t)=>t.map(n=>{if(ts(n))switch(n.value){case"padding-box":return 1;case"content-box":return 2}return 0})},Eue={name:"background-color",initialValue:"transparent",prefix:!1,type:Lt.TYPE_VALUE,format:"color"},my=(e,t)=>{const n=fc.parse(e,t[0]),s=t[1];return s&&lr(s)?{color:n,stop:s}:{color:n,stop:null}},f4=(e,t)=>{const n=e[0],s=e[e.length-1];n.stop===null&&(n.stop=zr),s.stop===null&&(s.stop=sc);const a=[];let o=0;for(let l=0;l<e.length;l++){const{stop:c}=e[l];if(c!==null){const u=ds(c,t);u>o?a.push(u):a.push(o),o=u}else a.push(null)}let i=null;for(let l=0;l<a.length;l++){const c=a[l];if(c===null)i===null&&(i=l);else if(i!==null){const u=l-i,d=a[i-1],f=(c-d)/(u+1);for(let h=1;h<=u;h++)a[i+h-1]=f*h;i=null}}return e.map(({color:l},c)=>({color:l,stop:Math.max(Math.min(1,a[c]/t),0)}))},wue=(e,t,n)=>{const s=t/2,a=n/2,o=ds(e[0],t)-s,i=a-ds(e[1],n);return(Math.atan2(i,o)+Math.PI*2)%(Math.PI*2)},kue=(e,t,n)=>{const s=typeof e=="number"?e:wue(e,t,n),a=Math.abs(t*Math.sin(s))+Math.abs(n*Math.cos(s)),o=t/2,i=n/2,l=a/2,c=Math.sin(s-Math.PI/2)*l,u=Math.cos(s-Math.PI/2)*l;return[a,o-u,o+u,i-c,i+c]},Ho=(e,t)=>Math.sqrt(e*e+t*t),m4=(e,t,n,s,a)=>[[0,0],[0,t],[e,0],[e,t]].reduce((i,l)=>{const[c=0,u=0]=l,d=Ho(n-c,s-u);return(a?d<i.optimumDistance:d>i.optimumDistance)?{optimumCorner:l,optimumDistance:d}:i},{optimumDistance:a?1/0:-1/0,optimumCorner:null}).optimumCorner,Cue=(e,t,n,s,a)=>{let o=0,i=0;switch(e.size){case na.CLOSEST_SIDE:e.shape===ea.CIRCLE?o=i=Math.min(Math.abs(t),Math.abs(t-s),Math.abs(n),Math.abs(n-a)):e.shape===ea.ELLIPSE&&(o=Math.min(Math.abs(t),Math.abs(t-s)),i=Math.min(Math.abs(n),Math.abs(n-a)));break;case na.CLOSEST_CORNER:if(e.shape===ea.CIRCLE)o=i=Math.min(Ho(t,n),Ho(t,n-a),Ho(t-s,n),Ho(t-s,n-a));else if(e.shape===ea.ELLIPSE){const l=Math.min(Math.abs(n),Math.abs(n-a))/Math.min(Math.abs(t),Math.abs(t-s)),[c,u]=m4(s,a,t,n,!0);o=Ho(c-t,(u-n)/l),i=l*o}break;case na.FARTHEST_SIDE:e.shape===ea.CIRCLE?o=i=Math.max(Math.abs(t),Math.abs(t-s),Math.abs(n),Math.abs(n-a)):e.shape===ea.ELLIPSE&&(o=Math.max(Math.abs(t),Math.abs(t-s)),i=Math.max(Math.abs(n),Math.abs(n-a)));break;case na.FARTHEST_CORNER:if(e.shape===ea.CIRCLE)o=i=Math.max(Ho(t,n),Ho(t,n-a),Ho(t-s,n),Ho(t-s,n-a));else if(e.shape===ea.ELLIPSE){const l=Math.max(Math.abs(n),Math.abs(n-a))/Math.max(Math.abs(t),Math.abs(t-s)),[c,u]=m4(s,a,t,n,!1);o=Ho(c-t,(u-n)/l),i=l*o}break}return Array.isArray(e.size)&&(o=ds(e.size[0],s),i=e.size.length===2?ds(e.size[1],a):o),[o,i]},Y_=(e,t)=>{let n=Fo(180);const s=[];return Ki(t).forEach((a,o)=>{if(o===0){const l=a[0];if((l==null?void 0:l.type)===lt.IDENT_TOKEN&&["top","left","right","bottom"].indexOf(l.value)!==-1){n=vP(a);return}else if(TP(l)){n=(fy.parse(e,l)+Fo(270))%Fo(360);return}}const i=my(e,a);s.push(i)}),{angle:n,stops:s,type:ei.LINEAR_GRADIENT}},NP="closest-side",IP="farthest-side",jP="closest-corner",DP="farthest-corner",SP="circle",RP="ellipse",AP="cover",BP="contain",Tue=(e,t)=>{let n=ea.CIRCLE,s=na.FARTHEST_CORNER;const a=[],o=[];return Ki(t).forEach((i,l)=>{let c=!0;if(l===0){let u=!1;c=i.reduce((f,h)=>{if(u)if(ts(h))switch(h.value){case"center":return o.push(C3),f;case"top":case"left":return o.push(zr),f;case"right":case"bottom":return o.push(sc),f}else(lr(h)||Mc(h))&&o.push(h);else if(ts(h))switch(h.value){case SP:return n=ea.CIRCLE,!1;case RP:return n=ea.ELLIPSE,!1;case"at":return u=!0,!1;case NP:return s=na.CLOSEST_SIDE,!1;case AP:case IP:return s=na.FARTHEST_SIDE,!1;case BP:case jP:return s=na.CLOSEST_CORNER,!1;case DP:return s=na.FARTHEST_CORNER,!1}else if(Mc(h)||lr(h))return Array.isArray(s)||(s=[]),s.push(h),!1;return f},c)}if(c){const u=my(e,i);a.push(u)}}),{size:s,shape:n,stops:a,position:o,type:ei.RADIAL_GRADIENT}},X_=(e,t)=>{let n=ea.CIRCLE,s=na.FARTHEST_CORNER;const a=[],o=[];return Ki(t).forEach((i,l)=>{let c=!0;if(l===0?c=i.reduce((d,f)=>{if(ts(f))switch(f.value){case"center":return o.push(C3),!1;case"top":case"left":return o.push(zr),!1;case"right":case"bottom":return o.push(sc),!1}else if(lr(f)||Mc(f))return o.push(f),!1;return d},c):l===1&&(c=i.reduce((d,f)=>{if(ts(f))switch(f.value){case SP:return n=ea.CIRCLE,!1;case RP:return n=ea.ELLIPSE,!1;case BP:case NP:return s=na.CLOSEST_SIDE,!1;case IP:return s=na.FARTHEST_SIDE,!1;case jP:return s=na.CLOSEST_CORNER,!1;case AP:case DP:return s=na.FARTHEST_CORNER,!1}else if(Mc(f)||lr(f))return Array.isArray(s)||(s=[]),s.push(f),!1;return d},c)),c){const u=my(e,i);a.push(u)}}),{size:s,shape:n,stops:a,position:o,type:ei.RADIAL_GRADIENT}},vue=(e,t)=>{const n=Fo(180),s=[];let a=ei.LINEAR_GRADIENT;const o=ea.CIRCLE,i=na.FARTHEST_CORNER,l=[];return Ki(t).forEach((c,u)=>{const d=c[0];if(u===0){if(ts(d)&&d.value==="linear"){a=ei.LINEAR_GRADIENT;return}else if(ts(d)&&d.value==="radial"){a=ei.RADIAL_GRADIENT;return}}if(d.type===lt.FUNCTION){if(d.name==="from"){const f=fc.parse(e,d.values[0]);s.push({stop:zr,color:f})}else if(d.name==="to"){const f=fc.parse(e,d.values[0]);s.push({stop:sc,color:f})}else if(d.name==="color-stop"){const f=d.values.filter(ym);if(f.length===2){const h=fc.parse(e,f[1]),p=f[0];_h(p)&&s.push({stop:{type:lt.PERCENTAGE_TOKEN,number:p.number*100,flags:p.flags},color:h})}}}}),a===ei.LINEAR_GRADIENT?{angle:(n+Fo(180))%Fo(360),stops:s,type:a}:{size:i,shape:o,stops:s,position:l,type:a}},Nue=(e,t)=>{let n=Fo(180);const s=[];return Ki(t).forEach((a,o)=>{if(o===0){const l=a[0];if(l.type===lt.IDENT_TOKEN&&l.value==="to"){n=vP(a);return}else if(TP(l)){n=fy.parse(e,l);return}}const i=my(e,a);s.push(i)}),{angle:n,stops:s,type:ei.LINEAR_GRADIENT}};var ei=(e=>(e[e.URL=0]="URL",e[e.LINEAR_GRADIENT=1]="LINEAR_GRADIENT",e[e.RADIAL_GRADIENT=2]="RADIAL_GRADIENT",e))(ei||{});const Iue=e=>e.type===1,jue=e=>e.type===2;var ea=(e=>(e[e.CIRCLE=0]="CIRCLE",e[e.ELLIPSE=1]="ELLIPSE",e))(ea||{}),na=(e=>(e[e.CLOSEST_SIDE=0]="CLOSEST_SIDE",e[e.FARTHEST_SIDE=1]="FARTHEST_SIDE",e[e.CLOSEST_CORNER=2]="CLOSEST_CORNER",e[e.FARTHEST_CORNER=3]="FARTHEST_CORNER",e))(na||{});const T3={name:"image",parse:(e,t)=>{if(t.type===lt.URL_TOKEN){const n={url:t.value,type:0};return e.cache.addImage(t.value),n}if(t.type===lt.FUNCTION){const n=LP[t.name];if(typeof n>"u")throw new Error(`Attempting to parse an unsupported image function "${t.name}"`);return n(e,t.values)}throw new Error(`Unsupported image type ${t.type}`)}};function Due(e){return!(e.type===lt.IDENT_TOKEN&&e.value==="none")&&(e.type!==lt.FUNCTION||!!LP[e.name])}const LP={"linear-gradient":Nue,"-moz-linear-gradient":Y_,"-ms-linear-gradient":Y_,"-o-linear-gradient":Y_,"-webkit-linear-gradient":Y_,"radial-gradient":Tue,"-moz-radial-gradient":X_,"-ms-radial-gradient":X_,"-o-radial-gradient":X_,"-webkit-radial-gradient":X_,"-webkit-gradient":vue},Sue={name:"background-image",initialValue:"none",type:Lt.LIST,prefix:!1,parse:(e,t)=>{if(t.length===0)return[];const n=t[0];return(n==null?void 0:n.type)===lt.IDENT_TOKEN&&n.value==="none"?[]:t.filter(s=>ym(s)&&Due(s)).map(s=>T3.parse(e,s))}};var M0=(e=>(e[e.BORDER_BOX=0]="BORDER_BOX",e[e.PADDING_BOX=1]="PADDING_BOX",e[e.CONTENT_BOX=2]="CONTENT_BOX",e))(M0||{});const Rue={name:"background-origin",initialValue:"border-box",prefix:!1,type:Lt.LIST,parse:(e,t)=>t.map(n=>{if(ts(n))switch(n.value){case"padding-box":return 1;case"content-box":return 2}return 0})},Aue={name:"background-position",initialValue:"0% 0%",type:Lt.LIST,prefix:!1,parse:(e,t)=>Ki(t).map(n=>n.filter(lr)).map(bP)};var y1=(e=>(e[e.REPEAT=0]="REPEAT",e[e.NO_REPEAT=1]="NO_REPEAT",e[e.REPEAT_X=2]="REPEAT_X",e[e.REPEAT_Y=3]="REPEAT_Y",e))(y1||{});const Bue={name:"background-repeat",initialValue:"repeat",prefix:!1,type:Lt.LIST,parse:(e,t)=>Ki(t).map(n=>n.filter(ts).map(s=>s.value).join(" ")).map(Lue)},Lue=e=>{switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}};var Jh=(e=>(e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover",e))(Jh||{});const Pue={name:"background-size",initialValue:"0",prefix:!1,type:Lt.LIST,parse:(e,t)=>Ki(t).map(n=>n.filter(Oue))},Oue=e=>ts(e)||lr(e),hy=e=>({name:`border-${e}-color`,initialValue:"transparent",prefix:!1,type:Lt.TYPE_VALUE,format:"color"}),Mue=hy("top"),Uue=hy("right"),Vue=hy("bottom"),que=hy("left"),py=e=>({name:`border-radius-${e}`,initialValue:"0 0",prefix:!1,type:Lt.LIST,parse:(t,n)=>bP(n.filter(lr))}),Hue=py("top-left"),$ue=py("top-right"),Gue=py("bottom-right"),zue=py("bottom-left");var ba=(e=>(e[e.NONE=0]="NONE",e[e.SOLID=1]="SOLID",e[e.DASHED=2]="DASHED",e[e.DOTTED=3]="DOTTED",e[e.DOUBLE=4]="DOUBLE",e))(ba||{});const gy=e=>({name:`border-${e}-style`,initialValue:"solid",prefix:!1,type:Lt.IDENT_VALUE,parse:(t,n)=>{switch(n){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}),Wue=gy("top"),Kue=gy("right"),Yue=gy("bottom"),Xue=gy("left"),_y=e=>({name:`border-${e}-width`,initialValue:"0",type:Lt.VALUE,prefix:!1,parse:(t,n)=>c_(n)?n.number:0}),Que=_y("top"),Jue=_y("right"),Zue=_y("bottom"),ede=_y("left"),tde={name:"box-shadow",initialValue:"none",type:Lt.LIST,prefix:!1,parse:(e,t)=>t.length===1&&dE(t[0],"none")?[]:Ki(t).map(n=>{const s={color:255,offsetX:zr,offsetY:zr,blur:zr,spread:zr,inset:!1};let a=0;for(let o=0;o<n.length;o++){const i=n[o];dE(i,"inset")?s.inset=!0:Mc(i)?(a===0?s.offsetX=i:a===1?s.offsetY=i:a===2?s.blur=i:s.spread=i,a++):s.color=fc.parse(e,i)}return s})},nde={name:"color",initialValue:"transparent",prefix:!1,type:Lt.TYPE_VALUE,format:"color"},sde={name:"content",initialValue:"none",type:Lt.LIST,prefix:!1,parse:(e,t)=>{if(t.length===0)return[];const n=t[0];return n.type===lt.IDENT_TOKEN&&n.value==="none"?[]:t}},rde={name:"counter-increment",initialValue:"none",prefix:!0,type:Lt.LIST,parse:(e,t)=>{if(t.length===0)return null;const n=t[0];if(n.type===lt.IDENT_TOKEN&&n.value==="none")return null;const s=[],a=t.filter(yP);for(let o=0;o<a.length;o++){const i=a[o],l=a[o+1];if(i.type===lt.IDENT_TOKEN){const c=l&&_h(l)?l.number:1;s.push({counter:i.value,increment:c})}}return s}},ade={name:"counter-reset",initialValue:"none",prefix:!0,type:Lt.LIST,parse:(e,t)=>{if(t.length===0)return[];const n=[],s=t.filter(yP);for(let a=0;a<s.length;a++){const o=s[a],i=s[a+1];if(ts(o)&&o.value!=="none"){const l=i&&_h(i)?i.number:0;n.push({counter:o.value,reset:l})}}return n}};var PP=(e=>(e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e))(PP||{});const ode={name:"direction",initialValue:"ltr",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"rtl":return 1;case"ltr":default:return 0}}};var sl=(e=>(e[e.NONE=0]="NONE",e[e.BLOCK=2]="BLOCK",e[e.INLINE=4]="INLINE",e[e.RUN_IN=8]="RUN_IN",e[e.FLOW=16]="FLOW",e[e.FLOW_ROOT=32]="FLOW_ROOT",e[e.TABLE=64]="TABLE",e[e.FLEX=128]="FLEX",e[e.GRID=256]="GRID",e[e.RUBY=512]="RUBY",e[e.SUBGRID=1024]="SUBGRID",e[e.LIST_ITEM=2048]="LIST_ITEM",e[e.TABLE_ROW_GROUP=4096]="TABLE_ROW_GROUP",e[e.TABLE_HEADER_GROUP=8192]="TABLE_HEADER_GROUP",e[e.TABLE_FOOTER_GROUP=16384]="TABLE_FOOTER_GROUP",e[e.TABLE_ROW=32768]="TABLE_ROW",e[e.TABLE_CELL=65536]="TABLE_CELL",e[e.TABLE_COLUMN_GROUP=131072]="TABLE_COLUMN_GROUP",e[e.TABLE_COLUMN=262144]="TABLE_COLUMN",e[e.TABLE_CAPTION=524288]="TABLE_CAPTION",e[e.RUBY_BASE=1048576]="RUBY_BASE",e[e.RUBY_TEXT=2097152]="RUBY_TEXT",e[e.RUBY_BASE_CONTAINER=4194304]="RUBY_BASE_CONTAINER",e[e.RUBY_TEXT_CONTAINER=8388608]="RUBY_TEXT_CONTAINER",e[e.CONTENTS=16777216]="CONTENTS",e[e.INLINE_BLOCK=33554432]="INLINE_BLOCK",e[e.INLINE_LIST_ITEM=67108864]="INLINE_LIST_ITEM",e[e.INLINE_TABLE=134217728]="INLINE_TABLE",e[e.INLINE_FLEX=268435456]="INLINE_FLEX",e[e.INLINE_GRID=536870912]="INLINE_GRID",e))(sl||{});const ide={name:"display",initialValue:"inline-block",prefix:!1,type:Lt.LIST,parse:(e,t)=>t.filter(ts).reduce((n,s)=>n|lde(s.value),0)},lde=e=>{switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},OP={name:"time",parse:(e,t)=>{if(t.type===lt.DIMENSION_TOKEN)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},cde={name:"duration",initialValue:"0s",prefix:!1,type:Lt.LIST,parse:(e,t)=>t.filter(c_).map(n=>OP.parse(e,n))};var MP=(e=>(e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.INLINE_START=3]="INLINE_START",e[e.INLINE_END=4]="INLINE_END",e))(MP||{});const ude={name:"float",initialValue:"none",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},dde={name:"font-family",initialValue:"",prefix:!1,type:Lt.LIST,parse:(e,t)=>{const n=[],s=[];return t.forEach(a=>{switch(a.type){case lt.IDENT_TOKEN:case lt.STRING_TOKEN:n.push(a.value);break;case lt.NUMBER_TOKEN:n.push(a.number.toString());break;case lt.COMMA_TOKEN:s.push(n.join(" ")),n.length=0;break}}),n.length&&s.push(n.join(" ")),s.map(a=>a.indexOf(" ")===-1?a:`'${a}'`)}},fde={name:"font-size",initialValue:"0",prefix:!1,type:Lt.TYPE_VALUE,format:"length"},mde={name:"font-style",initialValue:"normal",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},hde={name:"font-variant",initialValue:"none",type:Lt.LIST,prefix:!1,parse:(e,t)=>t.filter(ts).map(n=>n.value)},pde={name:"font-weight",initialValue:"normal",type:Lt.VALUE,prefix:!1,parse:(e,t)=>{if(_h(t))return t.number;if(ts(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},gde={name:"letter-spacing",initialValue:"0",prefix:!1,type:Lt.VALUE,parse:(e,t)=>t.type===lt.IDENT_TOKEN&&t.value==="normal"?0:t.type===lt.NUMBER_TOKEN||t.type===lt.DIMENSION_TOKEN?t.number:0},_de={name:"line-break",initialValue:"normal",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"strict":return"strict";case"normal":default:return"normal"}}},xde={name:"line-height",initialValue:"normal",prefix:!1,type:Lt.TOKEN_VALUE},h4=(e,t)=>ts(e)&&e.value==="normal"?1.2*t:e.type===lt.NUMBER_TOKEN?t*e.number:lr(e)?ds(e,t):t,Fde={name:"list-style-image",initialValue:"none",type:Lt.VALUE,prefix:!1,parse:(e,t)=>t.type===lt.IDENT_TOKEN&&t.value==="none"?null:T3.parse(e,t)},yde={name:"list-style-position",initialValue:"outside",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"inside":return 0;case"outside":default:return 1}}};var Dt=(e=>(e[e.NONE=-1]="NONE",e[e.DISC=0]="DISC",e[e.CIRCLE=1]="CIRCLE",e[e.SQUARE=2]="SQUARE",e[e.DECIMAL=3]="DECIMAL",e[e.CJK_DECIMAL=4]="CJK_DECIMAL",e[e.DECIMAL_LEADING_ZERO=5]="DECIMAL_LEADING_ZERO",e[e.LOWER_ROMAN=6]="LOWER_ROMAN",e[e.UPPER_ROMAN=7]="UPPER_ROMAN",e[e.LOWER_GREEK=8]="LOWER_GREEK",e[e.LOWER_ALPHA=9]="LOWER_ALPHA",e[e.UPPER_ALPHA=10]="UPPER_ALPHA",e[e.ARABIC_INDIC=11]="ARABIC_INDIC",e[e.ARMENIAN=12]="ARMENIAN",e[e.BENGALI=13]="BENGALI",e[e.CAMBODIAN=14]="CAMBODIAN",e[e.CJK_EARTHLY_BRANCH=15]="CJK_EARTHLY_BRANCH",e[e.CJK_HEAVENLY_STEM=16]="CJK_HEAVENLY_STEM",e[e.CJK_IDEOGRAPHIC=17]="CJK_IDEOGRAPHIC",e[e.DEVANAGARI=18]="DEVANAGARI",e[e.ETHIOPIC_NUMERIC=19]="ETHIOPIC_NUMERIC",e[e.GEORGIAN=20]="GEORGIAN",e[e.GUJARATI=21]="GUJARATI",e[e.GURMUKHI=22]="GURMUKHI",e[e.HEBREW=22]="HEBREW",e[e.HIRAGANA=23]="HIRAGANA",e[e.HIRAGANA_IROHA=24]="HIRAGANA_IROHA",e[e.JAPANESE_FORMAL=25]="JAPANESE_FORMAL",e[e.JAPANESE_INFORMAL=26]="JAPANESE_INFORMAL",e[e.KANNADA=27]="KANNADA",e[e.KATAKANA=28]="KATAKANA",e[e.KATAKANA_IROHA=29]="KATAKANA_IROHA",e[e.KHMER=30]="KHMER",e[e.KOREAN_HANGUL_FORMAL=31]="KOREAN_HANGUL_FORMAL",e[e.KOREAN_HANJA_FORMAL=32]="KOREAN_HANJA_FORMAL",e[e.KOREAN_HANJA_INFORMAL=33]="KOREAN_HANJA_INFORMAL",e[e.LAO=34]="LAO",e[e.LOWER_ARMENIAN=35]="LOWER_ARMENIAN",e[e.MALAYALAM=36]="MALAYALAM",e[e.MONGOLIAN=37]="MONGOLIAN",e[e.MYANMAR=38]="MYANMAR",e[e.ORIYA=39]="ORIYA",e[e.PERSIAN=40]="PERSIAN",e[e.SIMP_CHINESE_FORMAL=41]="SIMP_CHINESE_FORMAL",e[e.SIMP_CHINESE_INFORMAL=42]="SIMP_CHINESE_INFORMAL",e[e.TAMIL=43]="TAMIL",e[e.TELUGU=44]="TELUGU",e[e.THAI=45]="THAI",e[e.TIBETAN=46]="TIBETAN",e[e.TRAD_CHINESE_FORMAL=47]="TRAD_CHINESE_FORMAL",e[e.TRAD_CHINESE_INFORMAL=48]="TRAD_CHINESE_INFORMAL",e[e.UPPER_ARMENIAN=49]="UPPER_ARMENIAN",e[e.DISCLOSURE_OPEN=50]="DISCLOSURE_OPEN",e[e.DISCLOSURE_CLOSED=51]="DISCLOSURE_CLOSED",e))(Dt||{});const mE={name:"list-style-type",initialValue:"none",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},xy=e=>({name:`margin-${e}`,initialValue:"0",prefix:!1,type:Lt.TOKEN_VALUE}),bde=xy("top"),Ede=xy("right"),wde=xy("bottom"),kde=xy("left"),Cde={name:"opacity",initialValue:"1",type:Lt.VALUE,prefix:!1,parse:(e,t)=>_h(t)?t.number:1};var hE=(e=>(e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN",e[e.SCROLL=2]="SCROLL",e[e.CLIP=3]="CLIP",e[e.AUTO=4]="AUTO",e))(hE||{});const Tde={name:"overflow",initialValue:"visible",prefix:!1,type:Lt.LIST,parse:(e,t)=>t.filter(ts).map(n=>{switch(n.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})};var UP=(e=>(e.NORMAL="normal",e.BREAK_WORD="break-word",e))(UP||{});const vde={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Fy=e=>({name:`padding-${e}`,initialValue:"0",prefix:!1,type:Lt.TYPE_VALUE,format:"length-percentage"}),Nde=Fy("top"),Ide=Fy("right"),jde=Fy("bottom"),Dde=Fy("left");var pE=(e=>(e[e.FILL=0]="FILL",e[e.STROKE=1]="STROKE",e[e.MARKERS=2]="MARKERS",e))(pE||{});const Sde={name:"paint-order",initialValue:"normal",prefix:!1,type:Lt.LIST,parse:(e,t)=>{const n=[0,1,2],s=[];return t.filter(ts).forEach(a=>{switch(a.value){case"stroke":s.push(1);break;case"fill":s.push(0);break;case"markers":s.push(2);break}}),n.forEach(a=>{s.indexOf(a)===-1&&s.push(a)}),s}};var Ru=(e=>(e[e.STATIC=0]="STATIC",e[e.RELATIVE=1]="RELATIVE",e[e.ABSOLUTE=2]="ABSOLUTE",e[e.FIXED=3]="FIXED",e[e.STICKY=4]="STICKY",e))(Ru||{});const Rde={name:"position",initialValue:"static",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Ade={name:"quotes",initialValue:"none",prefix:!0,type:Lt.LIST,parse:(e,t)=>{if(t.length===0)return null;const n=t[0];if(n.type===lt.IDENT_TOKEN&&n.value==="none")return null;const s=[],a=t.filter(gue);if(a.length%2!==0)return null;for(let o=0;o<a.length;o+=2){const i=a[o].value,l=a[o+1].value;s.push({open:i,close:l})}return s}},p4=(e,t,n)=>{if(!e)return"";const s=e[Math.min(t,e.length-1)];return s?n?s.open:s.close:""};var Yf=(e=>(e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT",e))(Yf||{});const Bde={name:"text-align",initialValue:"left",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Lde={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:Lt.TYPE_VALUE,format:"color"};var b1=(e=>(e[e.NONE=0]="NONE",e[e.UNDERLINE=1]="UNDERLINE",e[e.OVERLINE=2]="OVERLINE",e[e.LINE_THROUGH=3]="LINE_THROUGH",e[e.BLINK=4]="BLINK",e))(b1||{});const Pde={name:"text-decoration-line",initialValue:"none",prefix:!1,type:Lt.LIST,parse:(e,t)=>t.filter(ts).map(n=>{switch(n.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(n=>n!==0)},Ode={name:"text-shadow",initialValue:"none",type:Lt.LIST,prefix:!1,parse:(e,t)=>t.length===1&&dE(t[0],"none")?[]:Ki(t).map(n=>{const s={color:pl.TRANSPARENT,offsetX:zr,offsetY:zr,blur:zr};let a=0;for(let o=0;o<n.length;o++){const i=n[o];Mc(i)?(a===0?s.offsetX=i:a===1?s.offsetY=i:s.blur=i,a++):s.color=fc.parse(e,i)}return s})};var E1=(e=>(e[e.NONE=0]="NONE",e[e.LOWERCASE=1]="LOWERCASE",e[e.UPPERCASE=2]="UPPERCASE",e[e.CAPITALIZE=3]="CAPITALIZE",e))(E1||{});const Mde={name:"text-transform",initialValue:"none",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Ude={name:"transform",initialValue:"none",prefix:!0,type:Lt.VALUE,parse:(e,t)=>{if(t.type===lt.IDENT_TOKEN&&t.value==="none")return null;if(t.type===lt.FUNCTION){const n=Hde[t.name];if(typeof n>"u")throw new Error(`Attempting to parse an unsupported transform function "${t.name}"`);return n(t.values)}return null}},Vde=e=>{const t=e.filter(n=>n.type===lt.NUMBER_TOKEN).map(n=>n.number);return t.length===6?t:null},qde=e=>{const t=e.filter(c=>c.type===lt.NUMBER_TOKEN).map(c=>c.number),[n,s,{},{},a,o,{},{},{},{},{},{},i,l,{},{}]=t;return t.length===16?[n,s,a,o,i,l]:null},Hde={matrix:Vde,matrix3d:qde},g4={type:lt.PERCENTAGE_TOKEN,number:50,flags:l_},$de=[g4,g4],Gde={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:Lt.LIST,parse:(e,t)=>{const n=t.filter(lr);return n.length!==2?$de:[n[0],n[1]]}};var VP=(e=>(e[e.VISIBLE=0]="VISIBLE",e[e.HIDDEN=1]="HIDDEN",e[e.COLLAPSE=2]="COLLAPSE",e))(VP||{});const zde={name:"visible",initialValue:"none",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Wde={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:Lt.TYPE_VALUE,format:"color"},Kde={name:"-webkit-text-stroke-width",initialValue:"0",type:Lt.VALUE,prefix:!1,parse:(e,t)=>c_(t)?t.number:0},Yde={name:"word-break",initialValue:"normal",prefix:!1,type:Lt.IDENT_VALUE,parse:(e,t)=>{switch(t){case"break-all":return"break-all";case"keep-all":return"keep-all";case"normal":default:return"normal"}}},Xde={name:"z-index",initialValue:"auto",prefix:!1,type:Lt.VALUE,parse:(e,t)=>{if(t.type===lt.IDENT_TOKEN)return{auto:!0,order:0};if(_h(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}};class Qde{constructor(t,n){q(this,"animationDuration");q(this,"backgroundClip");q(this,"backgroundColor");q(this,"backgroundImage");q(this,"backgroundOrigin");q(this,"backgroundPosition");q(this,"backgroundRepeat");q(this,"backgroundSize");q(this,"borderTopColor");q(this,"borderRightColor");q(this,"borderBottomColor");q(this,"borderLeftColor");q(this,"borderTopLeftRadius");q(this,"borderTopRightRadius");q(this,"borderBottomRightRadius");q(this,"borderBottomLeftRadius");q(this,"borderTopStyle");q(this,"borderRightStyle");q(this,"borderBottomStyle");q(this,"borderLeftStyle");q(this,"borderTopWidth");q(this,"borderRightWidth");q(this,"borderBottomWidth");q(this,"borderLeftWidth");q(this,"boxShadow");q(this,"color");q(this,"direction");q(this,"display");q(this,"float");q(this,"fontFamily");q(this,"fontSize");q(this,"fontStyle");q(this,"fontVariant");q(this,"fontWeight");q(this,"letterSpacing");q(this,"lineBreak");q(this,"lineHeight");q(this,"listStyleImage");q(this,"listStylePosition");q(this,"listStyleType");q(this,"marginTop");q(this,"marginRight");q(this,"marginBottom");q(this,"marginLeft");q(this,"opacity");q(this,"overflowX");q(this,"overflowY");q(this,"overflowWrap");q(this,"paddingTop");q(this,"paddingRight");q(this,"paddingBottom");q(this,"paddingLeft");q(this,"paintOrder");q(this,"position");q(this,"textAlign");q(this,"textDecorationColor");q(this,"textDecorationLine");q(this,"textShadow");q(this,"textTransform");q(this,"transform");q(this,"transformOrigin");q(this,"visibility");q(this,"webkitTextStrokeColor");q(this,"webkitTextStrokeWidth");q(this,"wordBreak");q(this,"zIndex");var a,o;this.animationDuration=_t(t,cde,n.animationDuration),this.backgroundClip=_t(t,bue,n.backgroundClip),this.backgroundColor=_t(t,Eue,n.backgroundColor),this.backgroundImage=_t(t,Sue,n.backgroundImage),this.backgroundOrigin=_t(t,Rue,n.backgroundOrigin),this.backgroundPosition=_t(t,Aue,n.backgroundPosition),this.backgroundRepeat=_t(t,Bue,n.backgroundRepeat),this.backgroundSize=_t(t,Pue,n.backgroundSize),this.borderTopColor=_t(t,Mue,n.borderTopColor),this.borderRightColor=_t(t,Uue,n.borderRightColor),this.borderBottomColor=_t(t,Vue,n.borderBottomColor),this.borderLeftColor=_t(t,que,n.borderLeftColor),this.borderTopLeftRadius=_t(t,Hue,n.borderTopLeftRadius),this.borderTopRightRadius=_t(t,$ue,n.borderTopRightRadius),this.borderBottomRightRadius=_t(t,Gue,n.borderBottomRightRadius),this.borderBottomLeftRadius=_t(t,zue,n.borderBottomLeftRadius),this.borderTopStyle=_t(t,Wue,n.borderTopStyle),this.borderRightStyle=_t(t,Kue,n.borderRightStyle),this.borderBottomStyle=_t(t,Yue,n.borderBottomStyle),this.borderLeftStyle=_t(t,Xue,n.borderLeftStyle),this.borderTopWidth=_t(t,Que,n.borderTopWidth),this.borderRightWidth=_t(t,Jue,n.borderRightWidth),this.borderBottomWidth=_t(t,Zue,n.borderBottomWidth),this.borderLeftWidth=_t(t,ede,n.borderLeftWidth),this.boxShadow=_t(t,tde,n.boxShadow),this.color=_t(t,nde,n.color),this.direction=_t(t,ode,n.direction),this.display=_t(t,ide,n.display),this.float=_t(t,ude,n.cssFloat),this.fontFamily=_t(t,dde,n.fontFamily),this.fontSize=_t(t,fde,n.fontSize),this.fontStyle=_t(t,mde,n.fontStyle),this.fontVariant=_t(t,hde,n.fontVariant),this.fontWeight=_t(t,pde,n.fontWeight),this.letterSpacing=_t(t,gde,n.letterSpacing),this.lineBreak=_t(t,_de,n.lineBreak),this.lineHeight=_t(t,xde,n.lineHeight),this.listStyleImage=_t(t,Fde,n.listStyleImage),this.listStylePosition=_t(t,yde,n.listStylePosition),this.listStyleType=_t(t,mE,n.listStyleType),this.marginTop=_t(t,bde,n.marginTop),this.marginRight=_t(t,Ede,n.marginRight),this.marginBottom=_t(t,wde,n.marginBottom),this.marginLeft=_t(t,kde,n.marginLeft),this.opacity=_t(t,Cde,n.opacity);const s=_t(t,Tde,n.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=_t(t,vde,n.overflowWrap),this.paddingTop=_t(t,Nde,n.paddingTop),this.paddingRight=_t(t,Ide,n.paddingRight),this.paddingBottom=_t(t,jde,n.paddingBottom),this.paddingLeft=_t(t,Dde,n.paddingLeft),this.paintOrder=_t(t,Sde,n.paintOrder),this.position=_t(t,Rde,n.position),this.textAlign=_t(t,Bde,n.textAlign),this.textDecorationColor=_t(t,Lde,(a=n.textDecorationColor)!=null?a:n.color),this.textDecorationLine=_t(t,Pde,(o=n.textDecorationLine)!=null?o:n.textDecoration),this.textShadow=_t(t,Ode,n.textShadow),this.textTransform=_t(t,Mde,n.textTransform),this.transform=_t(t,Ude,n.transform),this.transformOrigin=_t(t,Gde,n.transformOrigin),this.visibility=_t(t,zde,n.visibility),this.webkitTextStrokeColor=_t(t,Wde,n.webkitTextStrokeColor),this.webkitTextStrokeWidth=_t(t,Kde,n.webkitTextStrokeWidth),this.wordBreak=_t(t,Yde,n.wordBreak),this.zIndex=_t(t,Xde,n.zIndex)}isVisible(){return this.display>0&&this.opacity>0&&this.visibility===VP.VISIBLE}isTransparent(){return mc(this.backgroundColor)}isTransformed(){return this.transform!==null}isPositioned(){return this.position!==Ru.STATIC}isPositionedWithZIndex(){return this.isPositioned()&&!this.zIndex.auto}isFloating(){return this.float!==MP.NONE}isInlineLevel(){return _r(this.display,sl.INLINE)||_r(this.display,sl.INLINE_BLOCK)||_r(this.display,sl.INLINE_FLEX)||_r(this.display,sl.INLINE_GRID)||_r(this.display,sl.INLINE_LIST_ITEM)||_r(this.display,sl.INLINE_TABLE)}}class Jde{constructor(t,n){q(this,"content");q(this,"quotes");this.content=_t(t,sde,n.content),this.quotes=_t(t,Ade,n.quotes)}}class _4{constructor(t,n){q(this,"counterIncrement");q(this,"counterReset");this.counterIncrement=_t(t,rde,n.counterIncrement),this.counterReset=_t(t,ade,n.counterReset)}}const _t=(e,t,n)=>{const s=new FP,a=n!==null&&typeof n<"u"?n.toString():t.initialValue;s.write(a);const o=new Kf(s.read());switch(t.type){case Lt.IDENT_VALUE:{const i=o.parseComponentValue();return t.parse(e,ts(i)?i.value:t.initialValue)}case Lt.VALUE:return t.parse(e,o.parseComponentValue());case Lt.LIST:return t.parse(e,o.parseComponentValues());case Lt.TOKEN_VALUE:return o.parseComponentValue();case Lt.TYPE_VALUE:switch(t.format){case"angle":return fy.parse(e,o.parseComponentValue());case"color":return fc.parse(e,o.parseComponentValue());case"image":return T3.parse(e,o.parseComponentValue());case"length":{const i=o.parseComponentValue();return Mc(i)?i:zr}case"length-percentage":return lr(a)?a:zr;case"time":return OP.parse(e,o.parseComponentValue())}}};class Zde{constructor(){q(this,"counters",{})}getCounterValue(t){const n=this.counters[t];return n&&n.length?n[n.length-1]:1}getCounterValues(t){const n=this.counters[t];return n||[]}pop(t){t.forEach(n=>this.counters[n].pop())}parse(t){const{counterIncrement:n}=t,{counterReset:s}=t;let a=!0;n!==null&&n.forEach(i=>{const l=this.counters[i.counter];l&&i.increment!==0&&(a=!1,l.length||l.push(1),l[Math.max(0,l.length-1)]+=i.increment)});const o=[];return a&&s.forEach(i=>{let l=this.counters[i.counter];o.push(i.counter),l||(l=this.counters[i.counter]=[]),l.push(i.reset)}),o}}const x4={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},F4={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},efe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},tfe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},gf=(e,t,n,s,a,o)=>e<t||e>n?Bp(e,a,o.length>0):s.integers.reduce((i,l,c)=>{for(;e>=l;)e-=l,i+=s.values[c];return i},"")+o,qP=(e,t,n,s)=>{let a="";do n||e--,a=s(e)+a,e/=t;while(e*t>=t);return a},Ys=(e,t,n,s,a)=>{const o=n-t+1;return(e<0?"-":"")+(qP(Math.abs(e),o,s,i=>ar(Math.floor(i%o)+t))+a)},vu=(e,t,n=". ")=>{const s=t.length;return qP(Math.abs(e),s,!1,a=>t[Math.floor(a%s)])+n},yf=1<<0,Ul=1<<1,Vl=1<<2,Oh=1<<3,Qi=(e,t,n,s,a,o)=>{if(e<-9999||e>9999)return Bp(e,Dt.CJK_DECIMAL,a.length>0);let i=Math.abs(e),l=a;if(i===0)return t[0]+l;for(let c=0;i>0&&c<=4;c++){const u=i%10;u===0&&_r(o,yf)&&l!==""?l=t[u]+l:u>1||u===1&&c===0||u===1&&c===1&&_r(o,Ul)||u===1&&c===1&&_r(o,Vl)&&e>100||u===1&&c>1&&_r(o,Oh)?l=t[u]+(c>0?n[c-1]:"")+l:u===1&&c>0&&(l=n[c-1]+l),i=Math.floor(i/10)}return(e<0?s:"")+l},y4="十百千萬",b4="拾佰仟萬",E4="マイナス",Sb="마이너스",Bp=(e,t,n)=>{const s=n?". ":"",a=n?"、":"",o=n?", ":"",i=n?" ":"";switch(t){case Dt.DISC:return`•${i}`;case Dt.CIRCLE:return`◦${i}`;case Dt.SQUARE:return`◾${i}`;case Dt.DECIMAL_LEADING_ZERO:{const l=Ys(e,48,57,!0,s);return l.length<4?`0${l}`:l}case Dt.CJK_DECIMAL:return vu(e,"〇一二三四五六七八九",a);case Dt.LOWER_ROMAN:return gf(e,1,3999,x4,Dt.DECIMAL,s).toLowerCase();case Dt.UPPER_ROMAN:return gf(e,1,3999,x4,Dt.DECIMAL,s);case Dt.LOWER_GREEK:return Ys(e,945,969,!1,s);case Dt.LOWER_ALPHA:return Ys(e,97,122,!1,s);case Dt.UPPER_ALPHA:return Ys(e,65,90,!1,s);case Dt.ARABIC_INDIC:return Ys(e,1632,1641,!0,s);case Dt.ARMENIAN:case Dt.UPPER_ARMENIAN:return gf(e,1,9999,F4,Dt.DECIMAL,s);case Dt.LOWER_ARMENIAN:return gf(e,1,9999,F4,Dt.DECIMAL,s).toLowerCase();case Dt.BENGALI:return Ys(e,2534,2543,!0,s);case Dt.CAMBODIAN:case Dt.KHMER:return Ys(e,6112,6121,!0,s);case Dt.CJK_EARTHLY_BRANCH:return vu(e,"子丑寅卯辰巳午未申酉戌亥",a);case Dt.CJK_HEAVENLY_STEM:return vu(e,"甲乙丙丁戊己庚辛壬癸",a);case Dt.CJK_IDEOGRAPHIC:case Dt.TRAD_CHINESE_INFORMAL:return Qi(e,"零一二三四五六七八九",y4,"負",a,Ul|Vl|Oh);case Dt.TRAD_CHINESE_FORMAL:return Qi(e,"零壹貳參肆伍陸柒捌玖",b4,"負",a,yf|Ul|Vl|Oh);case Dt.SIMP_CHINESE_INFORMAL:return Qi(e,"零一二三四五六七八九",y4,"负",a,Ul|Vl|Oh);case Dt.SIMP_CHINESE_FORMAL:return Qi(e,"零壹贰叁肆伍陆柒捌玖",b4,"负",a,yf|Ul|Vl|Oh);case Dt.JAPANESE_INFORMAL:return Qi(e,"〇一二三四五六七八九","十百千万",E4,a,0);case Dt.JAPANESE_FORMAL:return Qi(e,"零壱弐参四伍六七八九","拾百千万",E4,a,yf|Ul|Vl);case Dt.KOREAN_HANGUL_FORMAL:return Qi(e,"영일이삼사오육칠팔구","십백천만",Sb,o,yf|Ul|Vl);case Dt.KOREAN_HANJA_INFORMAL:return Qi(e,"零一二三四五六七八九","十百千萬",Sb,o,0);case Dt.KOREAN_HANJA_FORMAL:return Qi(e,"零壹貳參四五六七八九","拾百千",Sb,o,yf|Ul|Vl);case Dt.DEVANAGARI:return Ys(e,2406,2415,!0,s);case Dt.GEORGIAN:return gf(e,1,19999,tfe,Dt.DECIMAL,s);case Dt.GUJARATI:return Ys(e,2790,2799,!0,s);case Dt.GURMUKHI:return Ys(e,2662,2671,!0,s);case Dt.HEBREW:return gf(e,1,10999,efe,Dt.DECIMAL,s);case Dt.HIRAGANA:return vu(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case Dt.HIRAGANA_IROHA:return vu(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case Dt.KANNADA:return Ys(e,3302,3311,!0,s);case Dt.KATAKANA:return vu(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",a);case Dt.KATAKANA_IROHA:return vu(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",a);case Dt.LAO:return Ys(e,3792,3801,!0,s);case Dt.MONGOLIAN:return Ys(e,6160,6169,!0,s);case Dt.MYANMAR:return Ys(e,4160,4169,!0,s);case Dt.ORIYA:return Ys(e,2918,2927,!0,s);case Dt.PERSIAN:return Ys(e,1776,1785,!0,s);case Dt.TAMIL:return Ys(e,3046,3055,!0,s);case Dt.TELUGU:return Ys(e,3174,3183,!0,s);case Dt.THAI:return Ys(e,3664,3673,!0,s);case Dt.TIBETAN:return Ys(e,3872,3881,!0,s);case Dt.DECIMAL:default:return Ys(e,48,57,!0,s)}};var ti=(e=>(e[e.CREATES_STACKING_CONTEXT=2]="CREATES_STACKING_CONTEXT",e[e.CREATES_REAL_STACKING_CONTEXT=4]="CREATES_REAL_STACKING_CONTEXT",e[e.IS_LIST_OWNER=8]="IS_LIST_OWNER",e[e.DEBUG_RENDER=16]="DEBUG_RENDER",e))(ti||{});class Yi{constructor(t,n){q(this,"styles");q(this,"textNodes",[]);q(this,"elements",[]);q(this,"bounds");q(this,"flags",0);if(this.context=t,fE(n,O0.PARSE))debugger;this.styles=new Qde(t,window.getComputedStyle(n,null)),_E(n)&&(this.styles.animationDuration.some(s=>s>0)&&(n.style.animationDuration="0s"),this.styles.transform!==null&&(n.style.transform="none")),this.bounds=dy(this.context,n),fE(n,O0.RENDER)&&(this.flags|=16)}}class HP extends Yi{constructor(n,s){super(n,s);q(this,"value");this.value=s.value}}class gE extends Yi{constructor(n,s){super(n,s);q(this,"start");q(this,"reversed");this.start=s.start,this.reversed=typeof s.reversed=="boolean"&&s.reversed===!0}}class $P extends Yi{constructor(n,s){super(n,s);q(this,"value");const a=s.options[s.selectedIndex||0];this.value=a&&a.text||""}}class GP extends Yi{constructor(n,s){super(n,s);q(this,"value");this.value=s.value}}class zP extends Yi{constructor(n,s){super(n,s);q(this,"canvas");q(this,"intrinsicWidth");q(this,"intrinsicHeight");this.canvas=s,this.intrinsicWidth=s.width,this.intrinsicHeight=s.height}}class WP extends Yi{constructor(n,s){super(n,s);q(this,"src");q(this,"width");q(this,"height");q(this,"tree");q(this,"backgroundColor");this.src=s.src,this.width=parseInt(s.width,10)||0,this.height=parseInt(s.height,10)||0,this.backgroundColor=this.styles.backgroundColor;try{if(s.contentWindow&&s.contentWindow.document&&s.contentWindow.document.documentElement){this.tree=QP(n,s.contentWindow.document.documentElement);const a=s.contentWindow.document.documentElement?Qh(n,getComputedStyle(s.contentWindow.document.documentElement).backgroundColor):pl.TRANSPARENT,o=s.contentWindow.document.body?Qh(n,getComputedStyle(s.contentWindow.document.body).backgroundColor):pl.TRANSPARENT;this.backgroundColor=mc(a)?mc(o)?this.styles.backgroundColor:o:a}}catch(a){}}}class KP extends Yi{constructor(n,s){super(n,s);q(this,"src");q(this,"intrinsicWidth");q(this,"intrinsicHeight");this.src=s.currentSrc||s.src,this.intrinsicWidth=s.naturalWidth,this.intrinsicHeight=s.naturalHeight,this.context.cache.addImage(this.src)}}const nfe=[{type:lt.DIMENSION_TOKEN,flags:0,unit:"px",number:3}],sfe=[{type:lt.PERCENTAGE_TOKEN,flags:0,number:50}],rfe=e=>e.width>e.height?new ko(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new ko(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e,afe=e=>{const t=e.type===ofe?new Array(e.value.length+1).join("•"):e.value;return t.length===0?e.placeholder||"":t},U0="checkbox",V0="radio",ofe="password",w4=707406591;class v3 extends Yi{constructor(n,s){super(n,s);q(this,"type");q(this,"checked");q(this,"value");switch(this.type=s.type.toLowerCase(),this.checked=s.checked,this.value=afe(s),(this.type===U0||this.type===V0)&&(this.styles.backgroundColor=3739148031,this.styles.borderTopColor=this.styles.borderRightColor=this.styles.borderBottomColor=this.styles.borderLeftColor=2779096575,this.styles.borderTopWidth=this.styles.borderRightWidth=this.styles.borderBottomWidth=this.styles.borderLeftWidth=1,this.styles.borderTopStyle=this.styles.borderRightStyle=this.styles.borderBottomStyle=this.styles.borderLeftStyle=ba.SOLID,this.styles.backgroundClip=[td.BORDER_BOX],this.styles.backgroundOrigin=[M0.BORDER_BOX],this.bounds=rfe(this.bounds)),this.type){case U0:this.styles.borderTopRightRadius=this.styles.borderTopLeftRadius=this.styles.borderBottomRightRadius=this.styles.borderBottomLeftRadius=nfe;break;case V0:this.styles.borderTopRightRadius=this.styles.borderTopLeftRadius=this.styles.borderBottomRightRadius=this.styles.borderBottomLeftRadius=sfe;break}}}class YP extends Yi{constructor(n,s){super(n,s);q(this,"svg");q(this,"intrinsicWidth");q(this,"intrinsicHeight");const a=new XMLSerializer,o=dy(n,s);s.setAttribute("width",`${o.width}px`),s.setAttribute("height",`${o.height}px`),this.svg=`data:image/svg+xml,${encodeURIComponent(a.serializeToString(s))}`,this.intrinsicWidth=s.width.baseVal.value,this.intrinsicHeight=s.height.baseVal.value,this.context.cache.addImage(this.svg)}}class Zh{constructor(t,n){q(this,"text");q(this,"bounds");this.text=t,this.bounds=n}}const ife=(e,t,n,s)=>{const a=ufe(t,n),o=[];let i=0;return a.forEach(l=>{if(n.textDecorationLine.length||l.trim().length>0)if(Vr.SUPPORT_RANGE_BOUNDS){const c=k4(s,i,l.length).getClientRects();if(c.length>1){const u=N3(l);let d=0;u.forEach(f=>{o.push(new Zh(f,ko.fromDOMRectList(e,k4(s,d+i,f.length).getClientRects()))),d+=f.length})}else o.push(new Zh(l,ko.fromDOMRectList(e,c)))}else{const c=s.splitText(l.length);o.push(new Zh(l,lfe(e,s))),s=c}else Vr.SUPPORT_RANGE_BOUNDS||(s=s.splitText(l.length));i+=l.length}),o},lfe=(e,t)=>{const{ownerDocument:n}=t;if(n){const s=n.createElement("html2canvaswrapper");s.appendChild(t.cloneNode(!0));const{parentNode:a}=t;if(a){a.replaceChild(s,t);const o=dy(e,s);return s.firstChild&&a.replaceChild(s.firstChild,s),o}}return ko.EMPTY},k4=(e,t,n)=>{const{ownerDocument:s}=e;if(!s)throw new Error("Node has no owner document");const a=s.createRange();return a.setStart(e,t),a.setEnd(e,t+n),a},N3=e=>{if(Vr.SUPPORT_NATIVE_TEXT_SEGMENTATION){const t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(n=>n.segment)}return v8(e)},cfe=(e,t)=>{if(Vr.SUPPORT_NATIVE_TEXT_SEGMENTATION){const n=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(n.segment(e)).map(s=>s.segment)}return ffe(e,t)},ufe=(e,t)=>t.letterSpacing!==0?N3(e):cfe(e,t),dfe=[32,160,4961,65792,65793,4153,4241],ffe=(e,t)=>{const n=N8(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap===UP.BREAK_WORD?"break-word":t.wordBreak}),s=[];let a;for(;!(a=n.next()).done;)if(a.value){const o=a.value.slice(),i=KE(o);let l="";i.forEach(c=>{dfe.indexOf(c)===-1?l+=ar(c):(l.length&&s.push(l),s.push(ar(c)),l="")}),l.length&&s.push(l)}return s};class mfe{constructor(t,n,s){q(this,"text");q(this,"textBounds");this.text=hfe(n.data,s.textTransform),this.textBounds=ife(t,this.text,s,n)}}const hfe=(e,t)=>{switch(t){case E1.LOWERCASE:return e.toLowerCase();case E1.CAPITALIZE:return e.replace(pfe,gfe);case E1.UPPERCASE:return e.toUpperCase();default:return e}},pfe=/(^|\s|:|-|\(|\))([a-z])/g,gfe=(e,t,n)=>e.length>0?t+n.toUpperCase():e,_fe=["OL","UL","MENU"],w1=(e,t,n,s)=>{for(let a=t.firstChild,o;a;a=o)if(o=a.nextSibling,JP(a)&&a.data.trim().length>0)n.textNodes.push(new mfe(e,a,n.styles));else if(Lf(a))if(n5(a)&&a.assignedNodes)a.assignedNodes().forEach(i=>w1(e,i,n,s));else{const i=XP(e,a);i.styles.isVisible()&&(xfe(a,i,s)?i.flags|=ti.CREATES_REAL_STACKING_CONTEXT:Ffe(i.styles)&&(i.flags|=ti.CREATES_STACKING_CONTEXT),_fe.indexOf(a.tagName)!==-1&&(i.flags|=ti.IS_LIST_OWNER),n.elements.push(i),a.slot,a.shadowRoot?w1(e,a.shadowRoot,i,s):!q0(a)&&!ZP(a)&&!H0(a)&&w1(e,a,i,s))}},XP=(e,t)=>xE(t)?new KP(e,t):e5(t)?new zP(e,t):ZP(t)?new YP(e,t):yfe(t)?new HP(e,t):bfe(t)?new gE(e,t):Efe(t)?new v3(e,t):H0(t)?new $P(e,t):q0(t)?new GP(e,t):t5(t)?new WP(e,t):new Yi(e,t),QP=(e,t)=>{const n=XP(e,t);return n.flags|=ti.CREATES_REAL_STACKING_CONTEXT,w1(e,t,n,n),n},xfe=(e,t,n)=>t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||I3(e)&&n.styles.isTransparent(),Ffe=e=>e.isPositioned()||e.isFloating(),JP=e=>e.nodeType===Node.TEXT_NODE,Lf=e=>e.nodeType===Node.ELEMENT_NODE,_E=e=>Lf(e)&&typeof e.style<"u"&&!k1(e),k1=e=>typeof e.className=="object",yfe=e=>e.tagName==="LI",bfe=e=>e.tagName==="OL",Efe=e=>e.tagName==="INPUT",wfe=e=>e.tagName==="HTML",ZP=e=>e.tagName==="svg",I3=e=>e.tagName==="BODY",e5=e=>e.tagName==="CANVAS",C4=e=>e.tagName==="VIDEO",xE=e=>e.tagName==="IMG",t5=e=>e.tagName==="IFRAME",T4=e=>e.tagName==="STYLE",kfe=e=>e.tagName==="SCRIPT",q0=e=>e.tagName==="TEXTAREA",H0=e=>e.tagName==="SELECT",n5=e=>e.tagName==="SLOT",v4=e=>e.tagName.indexOf("-")>0,s5="data-html2canvas-ignore";class N4{constructor(t,n,s){q(this,"scrolledElements");q(this,"referenceElement");q(this,"clonedReferenceElement");q(this,"documentElement");q(this,"counters");q(this,"quoteDepth");if(this.context=t,this.options=s,this.scrolledElements=[],this.referenceElement=n,this.counters=new Zde,this.quoteDepth=0,!n.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(n.ownerDocument.documentElement,!1)}toIFrame(t,n){const s=Cfe(t,n);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");const a=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,i=s.contentWindow,l=i.document,c=Nfe(s).then(async()=>{this.scrolledElements.forEach(Sfe),i&&(i.scrollTo(n.left,n.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(i.scrollY!==n.top||i.scrollX!==n.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(i.scrollX-n.left,i.scrollY-n.top,0,0)));const{onclone:u}=this.options,d=this.clonedReferenceElement;return typeof d>"u"?Promise.reject(`Error finding the ${this.referenceElement.nodeName} in the cloned document`):(l.fonts&&l.fonts.ready&&await l.fonts.ready,/(AppleWebKit)/g.test(navigator.userAgent)&&await vfe(l),typeof u=="function"?Promise.resolve().then(()=>u(l,d)).then(()=>s):s)});return l.open(),l.write(`${jfe(document.doctype)}<html></html>`),Dfe(this.referenceElement.ownerDocument,a,o),l.replaceChild(l.adoptNode(this.documentElement),l.documentElement),l.close(),c}createElementClone(t){if(fE(t,O0.CLONE))debugger;if(e5(t))return this.createCanvasClone(t);if(C4(t))return this.createVideoClone(t);if(T4(t))return this.createStyleClone(t);const n=t.cloneNode(!1);return xE(n)&&(xE(t)&&t.currentSrc&&t.currentSrc!==t.src&&(n.src=t.currentSrc,n.srcset=""),n.loading==="lazy"&&(n.loading="eager")),v4(n)?this.createCustomElementClone(n):n}createCustomElementClone(t){const n=document.createElement("html2canvascustomelement");return Rb(t.style,n),n}createStyleClone(t){try{const n=t.sheet;if(n&&n.cssRules){const s=[].slice.call(n.cssRules,0).reduce((o,i)=>i&&typeof i.cssText=="string"?o+i.cssText:o,""),a=t.cloneNode(!1);return a.textContent=s,a}}catch(n){if(this.context.logger.error("Unable to access cssRules property",n),(n==null?void 0:n.name)!=="SecurityError")throw n}return t.cloneNode(!1)}createCanvasClone(t){var s;if(this.options.inlineImages&&t.ownerDocument){const a=t.ownerDocument.createElement("img");try{return a.src=t.toDataURL(),a}catch(o){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}const n=t.cloneNode(!1);try{n.width=t.width,n.height=t.height;const a=t.getContext("2d"),o=n.getContext("2d");if(o)if(!this.options.allowTaint&&a)o.putImageData(a.getImageData(0,0,t.width,t.height),0,0);else{const i=(s=t.getContext("webgl2"))!=null?s:t.getContext("webgl");if(i){const l=i.getContextAttributes();(l==null?void 0:l.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return n}catch(a){this.context.logger.info("Unable to clone canvas as it is tainted",t)}return n}createVideoClone(t){const n=t.ownerDocument.createElement("canvas");n.width=t.offsetWidth,n.height=t.offsetHeight;const s=n.getContext("2d");try{return s&&(s.drawImage(t,0,0,n.width,n.height),this.options.allowTaint||s.getImageData(0,0,n.width,n.height)),n}catch(o){this.context.logger.info("Unable to clone video as it is tainted",t)}const a=t.ownerDocument.createElement("canvas");return a.width=t.offsetWidth,a.height=t.offsetHeight,a}appendChildNode(t,n,s){(!Lf(n)||!kfe(n)&&!n.hasAttribute(s5)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(n)))&&(!this.options.copyStyles||!Lf(n)||!T4(n))&&t.appendChild(this.cloneNode(n,s))}cloneChildNodes(t,n,s){for(let a=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;a;a=a.nextSibling)if(Lf(a)&&n5(a)&&typeof a.assignedNodes=="function"){const o=a.assignedNodes();o.length&&o.forEach(i=>this.appendChildNode(n,i,s))}else this.appendChildNode(n,a,s)}cloneNode(t,n){if(JP(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);const s=t.ownerDocument.defaultView;if(s&&Lf(t)&&(_E(t)||k1(t))){const a=this.createElementClone(t);a.style.transitionProperty="none";const o=s.getComputedStyle(t),i=s.getComputedStyle(t,":before"),l=s.getComputedStyle(t,":after");this.referenceElement===t&&_E(a)&&(this.clonedReferenceElement=a),I3(a)&&Bfe(a);const c=this.counters.parse(new _4(this.context,o)),u=this.resolvePseudoContent(t,a,i,0);v4(t)&&(n=!0),C4(t)||this.cloneChildNodes(t,a,n),u&&a.insertBefore(u,a.firstChild);const d=this.resolvePseudoContent(t,a,l,1);return d&&a.appendChild(d),this.counters.pop(c),(o&&(this.options.copyStyles||k1(t))&&!t5(t)||n)&&Rb(o,a),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([a,t.scrollLeft,t.scrollTop]),(q0(t)||H0(t))&&(q0(a)||H0(a))&&(a.value=t.value),a}return t.cloneNode(!1)}resolvePseudoContent(t,n,s,a){if(!s)return;const o=s.content,i=n.ownerDocument;if(!i||!o||o==="none"||o==="-moz-alt-content"||s.display==="none")return;this.counters.parse(new _4(this.context,s));const l=new Jde(this.context,s),c=i.createElement("html2canvaspseudoelement");Rb(s,c),l.content.forEach(d=>{if(d.type===lt.STRING_TOKEN)c.appendChild(i.createTextNode(d.value));else if(d.type===lt.URL_TOKEN){const f=i.createElement("img");f.src=d.value,f.style.opacity="1",c.appendChild(f)}else if(d.type===lt.FUNCTION){if(d.name==="attr"){const f=d.values.filter(ts);f.length&&c.appendChild(i.createTextNode(t.getAttribute(f[0].value)||""))}else if(d.name==="counter"){const[f,h]=d.values.filter(ym);if(f&&ts(f)){const p=this.counters.getCounterValue(f.value),g=h&&ts(h)?mE.parse(this.context,h.value):Dt.DECIMAL;c.appendChild(i.createTextNode(Bp(p,g,!1)))}}else if(d.name==="counters"){const[f,h,p]=d.values.filter(ym);if(f&&ts(f)){const g=this.counters.getCounterValues(f.value),_=p&&ts(p)?mE.parse(this.context,p.value):Dt.DECIMAL,x=h&&h.type===lt.STRING_TOKEN?h.value:"",y=g.map(b=>Bp(b,_,!1)).join(x);c.appendChild(i.createTextNode(y))}}}else if(d.type===lt.IDENT_TOKEN)switch(d.value){case"open-quote":c.appendChild(i.createTextNode(p4(l.quotes,this.quoteDepth++,!0)));break;case"close-quote":c.appendChild(i.createTextNode(p4(l.quotes,--this.quoteDepth,!1)));break;default:c.appendChild(i.createTextNode(d.value))}}),c.className=`${FE} ${yE}`;const u=a===0?` ${FE}`:` ${yE}`;return k1(n)?n.className.baseValue+=u:n.className+=u,c}static destroy(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1}}const Cfe=(e,t)=>{const n=e.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=t.width.toString(),n.height=t.height.toString(),n.scrolling="no",n.setAttribute(s5,"true"),e.body.appendChild(n),n},Tfe=e=>new Promise(t=>{if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t}),vfe=e=>Promise.all([].slice.call(e.images,0).map(Tfe)),Nfe=e=>new Promise((t,n)=>{const s=e.contentWindow;if(!s)return n("No window assigned for iframe");const a=s.document;s.onload=e.onload=()=>{s.onload=e.onload=null;const o=setInterval(()=>{a.body.childNodes.length>0&&a.readyState==="complete"&&(clearInterval(o),t(e))},50)}}),Ife=["all","d","content"],Rb=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e.item(n);Ife.indexOf(s)===-1&&t.style.setProperty(s,e.getPropertyValue(s))}return t},jfe=e=>{let t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+=`"${e.publicId}"`),e.systemId&&(t+=`"${e.systemId}"`),t+=">"),t},Dfe=(e,t,n)=>{e&&e.defaultView&&(t!==e.defaultView.pageXOffset||n!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,n)},Sfe=([e,t,n])=>{e.scrollLeft=t,e.scrollTop=n},Rfe=":before",Afe=":after",FE="___html2canvas___pseudoelement_before",yE="___html2canvas___pseudoelement_after",I4=`{
    content: "" !important;
    display: none !important;
}`,Bfe=e=>{Lfe(e,`.${FE}${Rfe}${I4}
         .${yE}${Afe}${I4}`)},Lfe=(e,t)=>{const n=e.ownerDocument;if(n){const s=n.createElement("style");s.textContent=t,e.appendChild(s)}},r5=e=>{const{bounds:t}=e,{styles:n}=e;return t.add(n.borderLeftWidth,n.borderTopWidth,-(n.borderRightWidth+n.borderLeftWidth),-(n.borderTopWidth+n.borderBottomWidth))},$0=e=>{const{styles:t}=e,{bounds:n}=e,s=ds(t.paddingLeft,n.width),a=ds(t.paddingRight,n.width),o=ds(t.paddingTop,n.width),i=ds(t.paddingBottom,n.width);return n.add(s+t.borderLeftWidth,o+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+s+a),-(t.borderTopWidth+t.borderBottomWidth+o+i))};var yy=(e=>(e[e.VECTOR=0]="VECTOR",e[e.BEZIER_CURVE=1]="BEZIER_CURVE",e))(yy||{});const j4=(e,t)=>e.length===t.length?e.some((n,s)=>n===t[s]):!1,Pfe=(e,t,n,s,a)=>e.map((o,i)=>{switch(i){case 0:return o.add(t,n);case 1:return o.add(t+s,n);case 2:return o.add(t+s,n+a);case 3:return o.add(t,n+a)}return o});class ft{constructor(t,n){q(this,"type");q(this,"x");q(this,"y");this.type=yy.VECTOR,this.x=t,this.y=n}add(t,n){return new ft(this.x+t,this.y+n)}}const Ofe=(e,t)=>e===M0.BORDER_BOX?t.bounds:e===M0.CONTENT_BOX?$0(t):r5(t),Mfe=(e,t)=>e===td.BORDER_BOX?t.bounds:e===td.CONTENT_BOX?$0(t):r5(t),Ab=(e,t,n)=>{const s=Ofe(bf(e.styles.backgroundOrigin,t),e),a=Mfe(bf(e.styles.backgroundClip,t),e),o=Ufe(bf(e.styles.backgroundSize,t),n,s),[i,l]=o,c=Ph(bf(e.styles.backgroundPosition,t),s.width-i,s.height-l),u=Vfe(bf(e.styles.backgroundRepeat,t),c,o,s,a),d=Math.round(s.left+c[0]),f=Math.round(s.top+c[1]);return[u,d,f,i,l]},_f=e=>ts(e)&&e.value===Jh.AUTO,Q_=e=>typeof e=="number",Ufe=(e,[t,n,s],a)=>{const[o,i]=e;if(!o)return[0,0];if(lr(o)&&i&&lr(i))return[ds(o,a.width),ds(i,a.height)];const l=Q_(s);if(ts(o)&&(o.value===Jh.CONTAIN||o.value===Jh.COVER))return Q_(s)?a.width/a.height<s!=(o.value===Jh.COVER)?[a.width,a.width/s]:[a.height*s,a.height]:[a.width,a.height];const c=Q_(t),u=Q_(n),d=c||u;if(_f(o)&&(!i||_f(i))){if(c&&u)return[t,n];if(!l&&!d)return[a.width,a.height];if(d&&l){const _=c?t:n*s,x=u?n:t/s;return[_,x]}const p=c?t:a.width,g=u?n:a.height;return[p,g]}if(l){let p=0,g=0;return lr(o)?p=ds(o,a.width):lr(i)&&(g=ds(i,a.height)),_f(o)?p=g*s:(!i||_f(i))&&(g=p/s),[p,g]}let f=null,h=null;if(lr(o)?f=ds(o,a.width):i&&lr(i)&&(h=ds(i,a.height)),f!==null&&(!i||_f(i))&&(h=c&&u?f/t*n:a.height),h!==null&&_f(o)&&(f=c&&u?h/n*t:a.width),f!==null&&h!==null)return[f,h];throw new Error("Unable to calculate background-size for element")},bf=(e,t)=>{const n=e[t];return typeof n>"u"?e[0]:n},Vfe=(e,[t,n],[s,a],o,i)=>{switch(e){case y1.REPEAT_X:return[new ft(Math.round(o.left),Math.round(o.top+n)),new ft(Math.round(o.left+o.width),Math.round(o.top+n)),new ft(Math.round(o.left+o.width),Math.round(a+o.top+n)),new ft(Math.round(o.left),Math.round(a+o.top+n))];case y1.REPEAT_Y:return[new ft(Math.round(o.left+t),Math.round(o.top)),new ft(Math.round(o.left+t+s),Math.round(o.top)),new ft(Math.round(o.left+t+s),Math.round(o.height+o.top)),new ft(Math.round(o.left+t),Math.round(o.height+o.top))];case y1.NO_REPEAT:return[new ft(Math.round(o.left+t),Math.round(o.top+n)),new ft(Math.round(o.left+t+s),Math.round(o.top+n)),new ft(Math.round(o.left+t+s),Math.round(o.top+n+a)),new ft(Math.round(o.left+t),Math.round(o.top+n+a))];default:return[new ft(Math.round(i.left),Math.round(i.top)),new ft(Math.round(i.left+i.width),Math.round(i.top)),new ft(Math.round(i.left+i.width),Math.round(i.height+i.top)),new ft(Math.round(i.left),Math.round(i.height+i.top))]}},xf=(e,t,n)=>new ft(e.x+(t.x-e.x)*n,e.y+(t.y-e.y)*n);class ul{constructor(t,n,s,a){q(this,"type");q(this,"start");q(this,"startControl");q(this,"endControl");q(this,"end");this.type=yy.BEZIER_CURVE,this.start=t,this.startControl=n,this.endControl=s,this.end=a}subdivide(t,n){const s=xf(this.start,this.startControl,t),a=xf(this.startControl,this.endControl,t),o=xf(this.endControl,this.end,t),i=xf(s,a,t),l=xf(a,o,t),c=xf(i,l,t);return n?new ul(this.start,s,i,c):new ul(c,l,o,this.end)}add(t,n){return new ul(this.start.add(t,n),this.startControl.add(t,n),this.endControl.add(t,n),this.end.add(t,n))}reverse(){return new ul(this.end,this.endControl,this.startControl,this.start)}}const po=e=>e.type===yy.BEZIER_CURVE,D4=(e,t)=>{switch(t){case 0:return yo(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return yo(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return yo(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return yo(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},qfe=(e,t)=>{switch(t){case 0:return yo(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return yo(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return yo(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return yo(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},Hfe=(e,t)=>{switch(t){case 0:return yo(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return yo(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return yo(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return yo(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},$fe=(e,t)=>{switch(t){case 0:return J_(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return J_(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return J_(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return J_(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},J_=(e,t)=>{const n=[];return po(e)?n.push(e.subdivide(.5,!1)):n.push(e),po(t)?n.push(t.subdivide(.5,!0)):n.push(t),n},yo=(e,t,n,s)=>{const a=[];return po(e)?a.push(e.subdivide(.5,!1)):a.push(e),po(n)?a.push(n.subdivide(.5,!0)):a.push(n),po(s)?a.push(s.subdivide(.5,!0).reverse()):a.push(s),po(t)?a.push(t.subdivide(.5,!1).reverse()):a.push(t),a};class Gfe{constructor(t){q(this,"topLeftBorderDoubleOuterBox");q(this,"topRightBorderDoubleOuterBox");q(this,"bottomRightBorderDoubleOuterBox");q(this,"bottomLeftBorderDoubleOuterBox");q(this,"topLeftBorderDoubleInnerBox");q(this,"topRightBorderDoubleInnerBox");q(this,"bottomRightBorderDoubleInnerBox");q(this,"bottomLeftBorderDoubleInnerBox");q(this,"topLeftBorderStroke");q(this,"topRightBorderStroke");q(this,"bottomRightBorderStroke");q(this,"bottomLeftBorderStroke");q(this,"topLeftBorderBox");q(this,"topRightBorderBox");q(this,"bottomRightBorderBox");q(this,"bottomLeftBorderBox");q(this,"topLeftPaddingBox");q(this,"topRightPaddingBox");q(this,"bottomRightPaddingBox");q(this,"bottomLeftPaddingBox");q(this,"topLeftContentBox");q(this,"topRightContentBox");q(this,"bottomRightContentBox");q(this,"bottomLeftContentBox");const{styles:n}=t,{bounds:s}=t;let[a,o]=Ph(n.borderTopLeftRadius,s.width,s.height),[i,l]=Ph(n.borderTopRightRadius,s.width,s.height),[c,u]=Ph(n.borderBottomRightRadius,s.width,s.height),[d,f]=Ph(n.borderBottomLeftRadius,s.width,s.height);const h=[];h.push((a+i)/s.width),h.push((d+c)/s.width),h.push((o+f)/s.height),h.push((l+u)/s.height);const p=Math.max(...h);p>1&&(a/=p,o/=p,i/=p,l/=p,c/=p,u/=p,d/=p,f/=p);const g=s.width-i,_=s.height-u,x=s.width-c,y=s.height-f,{borderTopWidth:b}=n,{borderRightWidth:E}=n,{borderBottomWidth:w}=n,{borderLeftWidth:k}=n,C=ds(n.paddingTop,t.bounds.width),T=ds(n.paddingRight,t.bounds.width),v=ds(n.paddingBottom,t.bounds.width),I=ds(n.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=a>0||o>0?vs(s.left+k/3,s.top+b/3,a-k/3,o-b/3,0):new ft(s.left+k/3,s.top+b/3),this.topRightBorderDoubleOuterBox=a>0||o>0?vs(s.left+g,s.top+b/3,i-E/3,l-b/3,1):new ft(s.left+s.width-E/3,s.top+b/3),this.bottomRightBorderDoubleOuterBox=c>0||u>0?vs(s.left+x,s.top+_,c-E/3,u-w/3,2):new ft(s.left+s.width-E/3,s.top+s.height-w/3),this.bottomLeftBorderDoubleOuterBox=d>0||f>0?vs(s.left+k/3,s.top+y,d-k/3,f-w/3,3):new ft(s.left+k/3,s.top+s.height-w/3),this.topLeftBorderDoubleInnerBox=a>0||o>0?vs(s.left+k*2/3,s.top+b*2/3,a-k*2/3,o-b*2/3,0):new ft(s.left+k*2/3,s.top+b*2/3),this.topRightBorderDoubleInnerBox=a>0||o>0?vs(s.left+g,s.top+b*2/3,i-E*2/3,l-b*2/3,1):new ft(s.left+s.width-E*2/3,s.top+b*2/3),this.bottomRightBorderDoubleInnerBox=c>0||u>0?vs(s.left+x,s.top+_,c-E*2/3,u-w*2/3,2):new ft(s.left+s.width-E*2/3,s.top+s.height-w*2/3),this.bottomLeftBorderDoubleInnerBox=d>0||f>0?vs(s.left+k*2/3,s.top+y,d-k*2/3,f-w*2/3,3):new ft(s.left+k*2/3,s.top+s.height-w*2/3),this.topLeftBorderStroke=a>0||o>0?vs(s.left+k/2,s.top+b/2,a-k/2,o-b/2,0):new ft(s.left+k/2,s.top+b/2),this.topRightBorderStroke=a>0||o>0?vs(s.left+g,s.top+b/2,i-E/2,l-b/2,1):new ft(s.left+s.width-E/2,s.top+b/2),this.bottomRightBorderStroke=c>0||u>0?vs(s.left+x,s.top+_,c-E/2,u-w/2,2):new ft(s.left+s.width-E/2,s.top+s.height-w/2),this.bottomLeftBorderStroke=d>0||f>0?vs(s.left+k/2,s.top+y,d-k/2,f-w/2,3):new ft(s.left+k/2,s.top+s.height-w/2),this.topLeftBorderBox=a>0||o>0?vs(s.left,s.top,a,o,0):new ft(s.left,s.top),this.topRightBorderBox=i>0||l>0?vs(s.left+g,s.top,i,l,1):new ft(s.left+s.width,s.top),this.bottomRightBorderBox=c>0||u>0?vs(s.left+x,s.top+_,c,u,2):new ft(s.left+s.width,s.top+s.height),this.bottomLeftBorderBox=d>0||f>0?vs(s.left,s.top+y,d,f,3):new ft(s.left,s.top+s.height),this.topLeftPaddingBox=a>0||o>0?vs(s.left+k,s.top+b,Math.max(0,a-k),Math.max(0,o-b),0):new ft(s.left+k,s.top+b),this.topRightPaddingBox=i>0||l>0?vs(s.left+Math.min(g,s.width-E),s.top+b,g>s.width+E?0:Math.max(0,i-E),Math.max(0,l-b),1):new ft(s.left+s.width-E,s.top+b),this.bottomRightPaddingBox=c>0||u>0?vs(s.left+Math.min(x,s.width-k),s.top+Math.min(_,s.height-w),Math.max(0,c-E),Math.max(0,u-w),2):new ft(s.left+s.width-E,s.top+s.height-w),this.bottomLeftPaddingBox=d>0||f>0?vs(s.left+k,s.top+Math.min(y,s.height-w),Math.max(0,d-k),Math.max(0,f-w),3):new ft(s.left+k,s.top+s.height-w),this.topLeftContentBox=a>0||o>0?vs(s.left+k+I,s.top+b+C,Math.max(0,a-(k+I)),Math.max(0,o-(b+C)),0):new ft(s.left+k+I,s.top+b+C),this.topRightContentBox=i>0||l>0?vs(s.left+Math.min(g,s.width+k+I),s.top+b+C,g>s.width+k+I?0:i-k+I,l-(b+C),1):new ft(s.left+s.width-(E+T),s.top+b+C),this.bottomRightContentBox=c>0||u>0?vs(s.left+Math.min(x,s.width-(k+I)),s.top+Math.min(_,s.height+b+C),Math.max(0,c-(E+T)),u-(w+v),2):new ft(s.left+s.width-(E+T),s.top+s.height-(w+v)),this.bottomLeftContentBox=d>0||f>0?vs(s.left+k+I,s.top+y,Math.max(0,d-(k+I)),f-(w+v),3):new ft(s.left+k+I,s.top+s.height-(w+v))}}const vs=(e,t,n,s,a)=>{const o=4*((Math.sqrt(2)-1)/3),i=n*o,l=s*o,c=e+n,u=t+s;switch(a){case 0:return new ul(new ft(e,u),new ft(e,u-l),new ft(c-i,t),new ft(c,t));case 1:return new ul(new ft(e,t),new ft(e+i,t),new ft(c,u-l),new ft(c,u));case 2:return new ul(new ft(c,t),new ft(c,t+l),new ft(e+i,u),new ft(e,u));case 3:default:return new ul(new ft(c,u),new ft(c-i,u),new ft(e,t+l),new ft(e,t))}},G0=e=>[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox],zfe=e=>[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox],z0=e=>[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox];var rl=(e=>(e[e.BACKGROUND_BORDERS=2]="BACKGROUND_BORDERS",e[e.CONTENT=4]="CONTENT",e))(rl||{});class Wfe{constructor(t,n,s){q(this,"type",0);q(this,"target",6);this.offsetX=t,this.offsetY=n,this.matrix=s}}class Z_{constructor(t,n){q(this,"type",1);this.path=t,this.target=n}}class Kfe{constructor(t){q(this,"type",2);q(this,"target",6);this.opacity=t}}const Yfe=e=>e.type===0,a5=e=>e.type===1,Xfe=e=>e.type===2,Qfe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",S4="Hidden Text";class Jfe{constructor(t){q(this,"_data");q(this,"_document");this._data={},this._document=t}parseMetrics(t,n){const s=this._document.createElement("div"),a=this._document.createElement("img"),o=this._document.createElement("span"),i=this._document.body;s.style.visibility="hidden",s.style.fontFamily=t,s.style.fontSize=n,s.style.margin="0",s.style.padding="0",s.style.whiteSpace="nowrap",i.appendChild(s),a.src=Qfe,a.width=1,a.height=1,a.style.margin="0",a.style.padding="0",a.style.verticalAlign="baseline",o.style.fontFamily=t,o.style.fontSize=n,o.style.margin="0",o.style.padding="0",o.appendChild(this._document.createTextNode(S4)),s.appendChild(o),s.appendChild(a);const l=a.offsetTop-o.offsetTop+2;s.removeChild(o),s.appendChild(this._document.createTextNode(S4)),s.style.lineHeight="normal",a.style.verticalAlign="super";const c=a.offsetTop-s.offsetTop+2;return i.removeChild(s),{baseline:l,middle:c}}getMetrics(t,n){const s=`${t} ${n}`;return typeof this._data[s]>"u"&&(this._data[s]=this.parseMetrics(t,n)),this._data[s]}}class o5{constructor(t,n){this.context=t,this.options=n}}class i5{constructor(t){q(this,"element");q(this,"negativeZIndex");q(this,"zeroOrAutoZIndexOrTransformedOrOpacity");q(this,"positiveZIndex");q(this,"nonPositionedFloats");q(this,"nonPositionedInlineLevel");q(this,"inlineLevel");q(this,"nonInlineLevel");this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}}class l5{constructor(t,n){q(this,"effects",[]);q(this,"curves");q(this,"listValue");if(this.container=t,this.parent=n,this.curves=new Gfe(this.container),this.container.styles.opacity<1&&this.effects.push(new Kfe(this.container.styles.opacity)),this.container.styles.transform!==null){const s=this.container.bounds.left+this.container.styles.transformOrigin[0].number,a=this.container.bounds.top+this.container.styles.transformOrigin[1].number,o=this.container.styles.transform;this.effects.push(new Wfe(s,a,o))}if(this.container.styles.overflowX!==hE.VISIBLE){const s=G0(this.curves),a=z0(this.curves);j4(s,a)?this.effects.push(new Z_(s,rl.BACKGROUND_BORDERS|rl.CONTENT)):(this.effects.push(new Z_(s,rl.BACKGROUND_BORDERS)),this.effects.push(new Z_(a,rl.CONTENT)))}}getEffects(t){let n=[Ru.ABSOLUTE,Ru.FIXED].indexOf(this.container.styles.position)===-1,{parent:s}=this;const a=this.effects.slice(0);for(;s;){const o=s.effects.filter(i=>!a5(i));if(n||s.container.styles.position!==Ru.STATIC||!s.parent){if(a.unshift(...o),n=[Ru.ABSOLUTE,Ru.FIXED].indexOf(s.container.styles.position)===-1,s.container.styles.overflowX!==hE.VISIBLE){const i=G0(s.curves),l=z0(s.curves);j4(i,l)||a.unshift(new Z_(l,rl.BACKGROUND_BORDERS|rl.CONTENT))}}else a.unshift(...o);s=s.parent}return a.filter(o=>_r(o.target,t))}}const bE=(e,t,n,s)=>{e.container.elements.forEach(a=>{const o=_r(a.flags,ti.CREATES_REAL_STACKING_CONTEXT),i=_r(a.flags,ti.CREATES_STACKING_CONTEXT),l=new l5(a,e);_r(a.styles.display,sl.LIST_ITEM)&&s.push(l);const c=_r(a.flags,ti.IS_LIST_OWNER)?[]:s;if(o||i){const u=o||a.styles.isPositioned()?n:t,d=new i5(l);if(a.styles.isPositioned()||a.styles.opacity<1||a.styles.isTransformed()){const{order:f}=a.styles.zIndex;if(f<0){let h=0;u.negativeZIndex.some((p,g)=>f>p.element.container.styles.zIndex.order?(h=g,!1):h>0),u.negativeZIndex.splice(h,0,d)}else if(f>0){let h=0;u.positiveZIndex.some((p,g)=>f>=p.element.container.styles.zIndex.order?(h=g+1,!1):h>0),u.positiveZIndex.splice(h,0,d)}else u.zeroOrAutoZIndexOrTransformedOrOpacity.push(d)}else a.styles.isFloating()?u.nonPositionedFloats.push(d):u.nonPositionedInlineLevel.push(d);bE(l,d,o?d:n,c)}else a.styles.isInlineLevel()?t.inlineLevel.push(l):t.nonInlineLevel.push(l),bE(l,t,n,c);_r(a.flags,ti.IS_LIST_OWNER)&&c5(a,c)})},c5=(e,t)=>{let n=e instanceof gE?e.start:1;const s=e instanceof gE?e.reversed:!1;for(let a=0;a<t.length;a++){const o=t[a];o.container instanceof HP&&typeof o.container.value=="number"&&o.container.value!==0&&(n=o.container.value),o.listValue=Bp(n,o.container.styles.listStyleType,!0),n+=s?-1:1}},Zfe=e=>{const t=new l5(e,null),n=new i5(t),s=[];return bE(t,n,n,s),c5(t.container,s),n},eme=1e4;class j3 extends o5{constructor(n,s){super(n,s);q(this,"canvas");q(this,"ctx");q(this,"_activeEffects",[]);q(this,"fontMetrics");this.canvas=s.canvas?s.canvas:document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),s.canvas||(this.canvas.width=Math.floor(s.width*s.scale),this.canvas.height=Math.floor(s.height*s.scale),this.canvas.style.width=`${s.width}px`,this.canvas.style.height=`${s.height}px`),this.fontMetrics=new Jfe(document),this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-s.x,-s.y),this.ctx.textBaseline="bottom",this._activeEffects=[],this.context.logger.debug(`Canvas renderer initialized (${s.width}x${s.height}) with scale ${s.scale}`)}applyEffects(n){for(;this._activeEffects.length;)this.popEffect();n.forEach(s=>this.applyEffect(s))}applyEffect(n){this.ctx.save(),Xfe(n)&&(this.ctx.globalAlpha=n.opacity),Yfe(n)&&(this.ctx.translate(n.offsetX,n.offsetY),this.ctx.transform(n.matrix[0],n.matrix[1],n.matrix[2],n.matrix[3],n.matrix[4],n.matrix[5]),this.ctx.translate(-n.offsetX,-n.offsetY)),a5(n)&&(this.path(n.path),this.ctx.clip()),this._activeEffects.push(n)}popEffect(){this._activeEffects.pop(),this.ctx.restore()}async renderStack(n){const{styles:s}=n.element.container;s.isVisible()&&await this.renderStackContent(n)}async renderNode(n){if(_r(n.container.flags,ti.DEBUG_RENDER))debugger;n.container.styles.isVisible()&&(await this.renderNodeBackgroundAndBorders(n),await this.renderNodeContent(n))}renderTextWithLetterSpacing(n,s,a){s===0?this.ctx.fillText(n.text,n.bounds.left,n.bounds.top+a):N3(n.text).reduce((i,l)=>(this.ctx.fillText(l,i,n.bounds.top+a),i+this.ctx.measureText(l).width),n.bounds.left)}createFontStyle(n){const s=n.fontVariant.filter(i=>i==="normal"||i==="small-caps").join(""),a=ame(n.fontFamily).join(", "),o=c_(n.fontSize)?`${n.fontSize.number}${n.fontSize.unit}`:`${n.fontSize.number}px`;return[[n.fontStyle,s,n.fontWeight,o,a].join(" "),a,o]}async renderTextNode(n,s){const[a,o,i]=this.createFontStyle(s);this.ctx.font=a,this.ctx.direction=s.direction===PP.RTL?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic";let{baseline:l,middle:c}=this.fontMetrics.getMetrics(o,i);l=l-8;const{paintOrder:u}=s;n.textBounds.forEach(d=>{u.forEach(f=>{switch(f){case pE.FILL:{this.ctx.fillStyle=Nr(s.color),this.renderTextWithLetterSpacing(d,s.letterSpacing,l);const h=s.textShadow;h.length&&d.text.trim().length&&(h.slice(0).reverse().forEach(p=>{this.ctx.shadowColor=Nr(p.color),this.ctx.shadowOffsetX=p.offsetX.number*this.options.scale,this.ctx.shadowOffsetY=p.offsetY.number*this.options.scale,this.ctx.shadowBlur=p.blur.number,this.renderTextWithLetterSpacing(d,s.letterSpacing,l)}),this.ctx.shadowColor="",this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0,this.ctx.shadowBlur=0),s.textDecorationLine.length&&(this.ctx.fillStyle=Nr(s.textDecorationColor||s.color),s.textDecorationLine.forEach(p=>{switch(p){case b1.UNDERLINE:this.ctx.fillRect(d.bounds.left,Math.round(d.bounds.top+l),d.bounds.width,1);break;case b1.OVERLINE:this.ctx.fillRect(d.bounds.left,Math.round(d.bounds.top),d.bounds.width,1);break;case b1.LINE_THROUGH:this.ctx.fillRect(d.bounds.left,Math.ceil(d.bounds.top+c),d.bounds.width,1);break}}));break}case pE.STROKE:s.webkitTextStrokeWidth&&d.text.trim().length&&(this.ctx.strokeStyle=Nr(s.webkitTextStrokeColor),this.ctx.lineWidth=s.webkitTextStrokeWidth,this.ctx.lineJoin=window.chrome?"miter":"round",this.ctx.strokeText(d.text,d.bounds.left,d.bounds.top+l)),this.ctx.strokeStyle="",this.ctx.lineWidth=0,this.ctx.lineJoin="miter";break}})})}renderReplacedElement(n,s,a){if(a&&n.intrinsicWidth>0&&n.intrinsicHeight>0){const o=$0(n),i=z0(s);this.path(i),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(a,0,0,n.intrinsicWidth,n.intrinsicHeight,o.left,o.top,o.width,o.height),this.ctx.restore()}}async renderNodeContent(n){this.applyEffects(n.getEffects(rl.CONTENT));const{container:s}=n,{curves:a}=n,{styles:o}=s;for(const i of s.textNodes)await this.renderTextNode(i,o);if(s instanceof KP)try{const i=await this.context.cache.match(s.src);this.renderReplacedElement(s,a,i)}catch(i){this.context.logger.error(`Error loading image ${s.src}`)}if(s instanceof zP&&this.renderReplacedElement(s,a,s.canvas),s instanceof YP)try{const i=await this.context.cache.match(s.svg);this.renderReplacedElement(s,a,i)}catch(i){this.context.logger.error(`Error loading svg ${s.svg.substring(0,255)}`)}if(s instanceof WP&&s.tree){const l=await new j3(this.context,{scale:this.options.scale,backgroundColor:s.backgroundColor,x:0,y:0,width:s.width,height:s.height}).render(s.tree);s.width&&s.height&&this.ctx.drawImage(l,0,0,s.width,s.height,s.bounds.left,s.bounds.top,s.bounds.width,s.bounds.height)}if(s instanceof v3){const i=Math.min(s.bounds.width,s.bounds.height);s.type===U0?s.checked&&(this.ctx.save(),this.path([new ft(s.bounds.left+i*.39363,s.bounds.top+i*.79),new ft(s.bounds.left+i*.16,s.bounds.top+i*.5549),new ft(s.bounds.left+i*.27347,s.bounds.top+i*.44071),new ft(s.bounds.left+i*.39694,s.bounds.top+i*.5649),new ft(s.bounds.left+i*.72983,s.bounds.top+i*.23),new ft(s.bounds.left+i*.84,s.bounds.top+i*.34085),new ft(s.bounds.left+i*.39363,s.bounds.top+i*.79)]),this.ctx.fillStyle=Nr(w4),this.ctx.fill(),this.ctx.restore()):s.type===V0&&s.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(s.bounds.left+i/2,s.bounds.top+i/2,i/4,0,Math.PI*2,!0),this.ctx.fillStyle=Nr(w4),this.ctx.fill(),this.ctx.restore())}if(tme(s)&&s.value.length){const[i,l]=this.createFontStyle(o),{baseline:c}=this.fontMetrics.getMetrics(i,l);this.ctx.font=i,this.ctx.fillStyle=Nr(o.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=sme(s.styles.textAlign);const u=$0(s);let d=0;switch(s.styles.textAlign){case Yf.CENTER:d+=u.width/2;break;case Yf.RIGHT:d+=u.width;break}const f=u.add(d,0,0,-u.height/2+1);this.ctx.save(),this.path([new ft(u.left,u.top),new ft(u.left+u.width,u.top),new ft(u.left+u.width,u.top+u.height),new ft(u.left,u.top+u.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Zh(s.value,f),o.letterSpacing,c),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(_r(s.styles.display,sl.LIST_ITEM)){if(s.styles.listStyleImage!==null){const i=s.styles.listStyleImage;if(i.type===ei.URL){let l;const{url:c}=i;try{l=await this.context.cache.match(c),this.ctx.drawImage(l,s.bounds.left-(l.width+10),s.bounds.top)}catch(u){this.context.logger.error(`Error loading list-style-image ${c}`)}}}else if(n.listValue&&s.styles.listStyleType!==Dt.NONE){const[i]=this.createFontStyle(o);this.ctx.font=i,this.ctx.fillStyle=Nr(o.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right";const l=new ko(s.bounds.left,s.bounds.top+ds(s.styles.paddingTop,s.bounds.width),s.bounds.width,h4(o.lineHeight,o.fontSize.number)/2+1);this.renderTextWithLetterSpacing(new Zh(n.listValue,l),o.letterSpacing,h4(o.lineHeight,o.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"}}}async renderStackContent(n){if(_r(n.element.container.flags,ti.DEBUG_RENDER))debugger;await this.renderNodeBackgroundAndBorders(n.element);for(const s of n.negativeZIndex)await this.renderStack(s);await this.renderNodeContent(n.element);for(const s of n.nonInlineLevel)await this.renderNode(s);for(const s of n.nonPositionedFloats)await this.renderStack(s);for(const s of n.nonPositionedInlineLevel)await this.renderStack(s);for(const s of n.inlineLevel)await this.renderNode(s);for(const s of n.zeroOrAutoZIndexOrTransformedOrOpacity)await this.renderStack(s);for(const s of n.positiveZIndex)await this.renderStack(s)}mask(n){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(n.slice(0).reverse()),this.ctx.closePath()}path(n){this.ctx.beginPath(),this.formatPath(n),this.ctx.closePath()}formatPath(n){n.forEach((s,a)=>{const o=po(s)?s.start:s;a===0?this.ctx.moveTo(o.x,o.y):this.ctx.lineTo(o.x,o.y),po(s)&&this.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})}renderRepeat(n,s,a,o){this.path(n),this.ctx.fillStyle=s,this.ctx.translate(a,o),this.ctx.fill(),this.ctx.translate(-a,-o)}resizeImage(n,s,a){var c;if(n.width===s&&n.height===a)return n;const i=((c=this.canvas.ownerDocument)!=null?c:document).createElement("canvas");return i.width=Math.max(1,s),i.height=Math.max(1,a),i.getContext("2d").drawImage(n,0,0,n.width,n.height,0,0,s,a),i}async renderBackgroundImage(n){let s=n.styles.backgroundImage.length-1;for(const a of n.styles.backgroundImage.slice(0).reverse()){if(a.type===ei.URL){let o;const{url:i}=a;try{o=await this.context.cache.match(i)}catch(l){this.context.logger.error(`Error loading background-image ${i}`)}if(o){const[l,c,u,d,f]=Ab(n,s,[o.width,o.height,o.width/o.height]),h=this.ctx.createPattern(this.resizeImage(o,d,f),"repeat");this.renderRepeat(l,h,c,u)}}else if(Iue(a)){const[o,i,l,c,u]=Ab(n,s,[null,null,null]),[d,f,h,p,g]=kue(a.angle,c,u),_=document.createElement("canvas");_.width=c,_.height=u;const x=_.getContext("2d"),y=x.createLinearGradient(f,p,h,g);if(f4(a.stops,d).forEach(b=>y.addColorStop(b.stop,Nr(b.color))),x.fillStyle=y,x.fillRect(0,0,c,u),c>0&&u>0){const b=this.ctx.createPattern(_,"repeat");this.renderRepeat(o,b,i,l)}}else if(jue(a)){const[o,i,l,c,u]=Ab(n,s,[null,null,null]),d=a.position.length===0?[C3]:a.position,f=ds(d[0],c),h=ds(d[d.length-1],u),[p,g]=Cue(a,f,h,c,u);if(p>0&&g>0){const _=this.ctx.createRadialGradient(i+f,l+h,0,i+f,l+h,p);if(f4(a.stops,p*2).forEach(x=>_.addColorStop(x.stop,Nr(x.color))),this.path(o),this.ctx.fillStyle=_,p!==g){const x=n.bounds.left+.5*n.bounds.width,y=n.bounds.top+.5*n.bounds.height,b=g/p,E=1/b;this.ctx.save(),this.ctx.translate(x,y),this.ctx.transform(1,0,0,b,0,0),this.ctx.translate(-x,-y),this.ctx.fillRect(i,E*(l-y)+y,c,u*E),this.ctx.restore()}else this.ctx.fill()}}s--}}async renderSolidBorder(n,s,a){this.path(D4(a,s)),this.ctx.fillStyle=Nr(n),this.ctx.fill()}async renderDoubleBorder(n,s,a,o){if(s<3){await this.renderSolidBorder(n,a,o);return}const i=qfe(o,a);this.path(i),this.ctx.fillStyle=Nr(n),this.ctx.fill();const l=Hfe(o,a);this.path(l),this.ctx.fill()}async renderNodeBackgroundAndBorders(n){this.applyEffects(n.getEffects(rl.BACKGROUND_BORDERS));const{styles:s}=n.container,a=!mc(s.backgroundColor)||s.backgroundImage.length,o=[{style:s.borderTopStyle,color:s.borderTopColor,width:s.borderTopWidth},{style:s.borderRightStyle,color:s.borderRightColor,width:s.borderRightWidth},{style:s.borderBottomStyle,color:s.borderBottomColor,width:s.borderBottomWidth},{style:s.borderLeftStyle,color:s.borderLeftColor,width:s.borderLeftWidth}],i=nme(bf(s.backgroundClip,0),n.curves);(a||s.boxShadow.length)&&(this.ctx.save(),this.path(i),this.ctx.clip(),mc(s.backgroundColor)||(this.ctx.fillStyle=Nr(s.backgroundColor),this.ctx.fill()),await this.renderBackgroundImage(n.container),this.ctx.restore(),s.boxShadow.slice(0).reverse().forEach(c=>{this.ctx.save();const u=G0(n.curves),d=c.inset?0:eme,f=Pfe(u,-d+(c.inset?1:-1)*c.spread.number,(c.inset?1:-1)*c.spread.number,c.spread.number*(c.inset?-2:2),c.spread.number*(c.inset?-2:2));c.inset?(this.path(u),this.ctx.clip(),this.mask(f)):(this.mask(u),this.ctx.clip(),this.path(f)),this.ctx.shadowOffsetX=c.offsetX.number+d,this.ctx.shadowOffsetY=c.offsetY.number,this.ctx.shadowColor=Nr(c.color),this.ctx.shadowBlur=c.blur.number,this.ctx.fillStyle=c.inset?Nr(c.color):"rgba(0,0,0,1)",this.ctx.fill(),this.ctx.restore()}));let l=0;for(const c of o)c.style!==ba.NONE&&!mc(c.color)&&c.width>0&&(c.style===ba.DASHED?await this.renderDashedDottedBorder(c.color,c.width,l,n.curves,ba.DASHED):c.style===ba.DOTTED?await this.renderDashedDottedBorder(c.color,c.width,l,n.curves,ba.DOTTED):c.style===ba.DOUBLE?await this.renderDoubleBorder(c.color,c.width,l,n.curves):await this.renderSolidBorder(c.color,l,n.curves)),l++}async renderDashedDottedBorder(n,s,a,o,i){this.ctx.save();const l=$fe(o,a),c=D4(o,a);i===ba.DASHED&&(this.path(c),this.ctx.clip());let u,d,f,h;po(c[0])?(u=c[0].start.x,d=c[0].start.y):(u=c[0].x,d=c[0].y),po(c[1])?(f=c[1].end.x,h=c[1].end.y):(f=c[1].x,h=c[1].y);let p;a===0||a===2?p=Math.abs(u-f):p=Math.abs(d-h),this.ctx.beginPath(),i===ba.DOTTED?this.formatPath(l):this.formatPath(c.slice(0,2));let g=s<3?s*3:s*2,_=s<3?s*2:s;i===ba.DOTTED&&(g=s,_=s);let x=!0;if(p<=g*2)x=!1;else if(p<=g*2+_){const y=p/(2*g+_);g*=y,_*=y}else{const y=Math.floor((p+_)/(g+_)),b=(p-y*g)/(y-1),E=(p-(y+1)*g)/y;_=E<=0||Math.abs(_-b)<Math.abs(_-E)?b:E}if(x&&(i===ba.DOTTED?this.ctx.setLineDash([0,g+_]):this.ctx.setLineDash([g,_])),i===ba.DOTTED?(this.ctx.lineCap="round",this.ctx.lineWidth=s):this.ctx.lineWidth=s*2+1.1,this.ctx.strokeStyle=Nr(n),this.ctx.stroke(),this.ctx.setLineDash([]),i===ba.DASHED){if(po(c[0])){const y=c[3],b=c[0];this.ctx.beginPath(),this.formatPath([new ft(y.end.x,y.end.y),new ft(b.start.x,b.start.y)]),this.ctx.stroke()}if(po(c[1])){const y=c[1],b=c[2];this.ctx.beginPath(),this.formatPath([new ft(y.end.x,y.end.y),new ft(b.start.x,b.start.y)]),this.ctx.stroke()}}this.ctx.restore()}async render(n){this.options.backgroundColor&&(this.ctx.fillStyle=Nr(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height));const s=Zfe(n);return await this.renderStack(s),this.applyEffects([]),this.canvas}}const tme=e=>e instanceof GP||e instanceof $P?!0:e instanceof v3&&e.type!==V0&&e.type!==U0,nme=(e,t)=>{switch(e){case td.BORDER_BOX:return G0(t);case td.CONTENT_BOX:return zfe(t);case td.PADDING_BOX:default:return z0(t)}},sme=e=>{switch(e){case Yf.CENTER:return"center";case Yf.RIGHT:return"right";case Yf.LEFT:default:return"left"}},rme=["-apple-system","system-ui"],ame=e=>/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(t=>rme.indexOf(t)===-1):e;class ome extends o5{constructor(n,s){super(n,s);q(this,"canvas");q(this,"ctx");q(this,"options");this.canvas=s.canvas?s.canvas:document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.options=s,this.canvas.width=Math.floor(s.width*s.scale),this.canvas.height=Math.floor(s.height*s.scale),this.canvas.style.width=`${s.width}px`,this.canvas.style.height=`${s.height}px`,this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-s.x,-s.y),this.context.logger.debug(`EXPERIMENTAL ForeignObject renderer initialized (${s.width}x${s.height} at ${s.x},${s.y}) with scale ${s.scale}`)}async render(n){const s=cE(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,n),a=await ime(s);return this.options.backgroundColor&&(this.ctx.fillStyle=Nr(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(a,-this.options.x*this.options.scale,-this.options.y*this.options.scale),this.canvas}}const ime=e=>new Promise((t,n)=>{const s=new Image;s.onload=()=>{t(s)},s.onerror=n,s.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(new XMLSerializer().serializeToString(e))}`}),u5=(e,t={})=>lme(e,t);typeof window<"u"&&Bf.setContext(window);const lme=async(e,t)=>{var k,C,T,v,I,j,D,S,R,A,L,P,M,U,V,W,z;if(!e||typeof e!="object")return Promise.reject("Invalid element provided as first argument");const{ownerDocument:n}=e;if(!n)throw new Error("Element is not attached to a Document");const{defaultView:s}=n;if(!s)throw new Error("Document is not attached to a Window");const a={allowTaint:(k=t.allowTaint)!=null?k:!1,imageTimeout:(C=t.imageTimeout)!=null?C:15e3,proxy:t.proxy,useCORS:(T=t.useCORS)!=null?T:!1},o={logging:(v=t.logging)!=null?v:!1,cache:t.cache,...a},i={windowWidth:(I=t.windowWidth)!=null?I:s.innerWidth,windowHeight:(j=t.windowHeight)!=null?j:s.innerHeight,scrollX:(D=t.scrollX)!=null?D:s.pageXOffset,scrollY:(S=t.scrollY)!=null?S:s.pageYOffset},l=new ko(i.scrollX,i.scrollY,i.windowWidth,i.windowHeight),c=new F1(o,l),u=(R=t.foreignObjectRendering)!=null?R:!1,d={allowTaint:(A=t.allowTaint)!=null?A:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:u,copyStyles:u};c.logger.debug(`Starting document clone with size ${l.width}x${l.height} scrolled to ${-l.left},${-l.top}`);const f=new N4(c,e,d),h=f.clonedReferenceElement;if(!h)return Promise.reject("Unable to find element in cloned iframe");const p=await f.toIFrame(n,l),{width:g,height:_,left:x,top:y}=I3(h)||wfe(h)?uce(h.ownerDocument):dy(c,h),b=cme(c,h,t.backgroundColor),E={canvas:t.canvas,backgroundColor:b,scale:(P=(L=t.scale)!=null?L:s.devicePixelRatio)!=null?P:1,x:((M=t.x)!=null?M:0)+x,y:((U=t.y)!=null?U:0)+y,width:(V=t.width)!=null?V:Math.ceil(g),height:(W=t.height)!=null?W:Math.ceil(_)};let w;if(u)c.logger.debug("Document cloned, using foreign object rendering"),w=await new ome(c,E).render(h);else{c.logger.debug(`Document cloned, element located at ${x},${y} with size ${g}x${_} using computed rendering`),c.logger.debug("Starting DOM parsing");const Q=QP(c,h);b===Q.styles.backgroundColor&&(Q.styles.backgroundColor=pl.TRANSPARENT),c.logger.debug(`Starting renderer for element at ${E.x},${E.y} with size ${E.width}x${E.height}`),w=await new j3(c,E).render(Q)}return((z=t.removeContainer)==null||z)&&(N4.destroy(p)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),w},cme=(e,t,n)=>{const{ownerDocument:s}=t,a=s.documentElement?Qh(e,getComputedStyle(s.documentElement).backgroundColor):pl.TRANSPARENT,o=s.body?Qh(e,getComputedStyle(s.body).backgroundColor):pl.TRANSPARENT,i=typeof n=="string"?Qh(e,n):n===null?pl.TRANSPARENT:4294967295;return t===s.documentElement?mc(a)?mc(o)?i:o:a:i},Bb=new Map,ume=F.memo(e=>{var h,p,g;const t=ah(),n=F.useRef(null),{blockId:s}=e,a=_e(s,["data"],["format","viewMode"]),o=(p=(h=a==null?void 0:a.data.format)==null?void 0:h.language)!=null?p:"",i=(g=a==null?void 0:a.data.viewMode)!=null?g:Vs.card,l=ae(_=>{var x;return de((x=_.blocks[s])==null?void 0:x.data.segments)},{equalityFn:rn}),c=Pj(o,i),[u,d]=F.useState(!1),f=F.useCallback(async _=>{if(Cj(_.target,k=>k.tagName==="a","svg"))return;const y=n.current;if(!y||!u)return;const b=Wa(),E=`mermaid-${b}-${l}`;let w="";Bb.has(E)?w=Bb.get(E):(ye.loading({content:"正在生成图片",key:E}),await xs(300),w=(await u5(y,{useCORS:!0,backgroundColor:b?to.dark.grey8:to.grey8,scale:5})).toDataURL(),Bb.set(E,w),ye.closeMessage(E)),t({uuid:`mermaid-${s}`,src:w})},[s,t,l,u]);return c.preview?r.jsx("div",{ref:n,hidden:!l,className:B("p-4",!c.code&&"pt-0",u&&"animate-click"),onClick:f,children:r.jsx(MU,{onRender:d,text:l})}):null}),dme=F.memo(e=>{var i,l;const{blockId:t}=e,n=_e(t,["data"],["format","viewMode"]),s=(l=(i=n==null?void 0:n.data.format)==null?void 0:i.codePreviewFormat)!=null?l:wi.splitView,a=ke(),o=c=>{a(()=>{pe(t,{data:{format:{codePreviewFormat:c}}})})};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-4 w-px bg-grey4 mx-2.5"}),r.jsx(Uo,{className:"h-full",dropdownClassName:"w-32",SelectView:oC,readonly:!1,options:qU,value:s,onChange:o})]})}),R4=40,fme=({id:e,root:t})=>{var R,A,L,P,M,U,V,W;const n=Lr(),s=Pr(e),a=ke(),o=_e(e,["textColor","data"],["segments","format","description","viewMode"]),i=Ve(e),l=Vn(),[c=!0,u]=cu(e),[d,f]=F.useState(!1),{renderSize:h,onRenderSize:p,changeSize:g,containerWidth:_,containerRef:x,isDisable:y,defaultHeight:b}=zi({id:e,root:t,defaultHeight:(R=o==null?void 0:o.data.format)==null?void 0:R.height,fullPageContentWidth:!0,resizeWidth:!1}),[E,w]=F.useState(!b),k=(P=(L=(A=o==null?void 0:o.data.format)==null?void 0:A.language)!=null?L:hg())!=null?P:Om,C=(U=(M=o==null?void 0:o.data.format)==null?void 0:M.codeWrap)!=null?U:!0,T=(W=(V=o==null?void 0:o.data.format)==null?void 0:V.codePreviewFormat)!=null?W:wi.splitView,v=Pj(k,T),I=F.useCallback(()=>{a(()=>{var Q;const z=(Q=o==null?void 0:o.data.format)!=null?Q:{};pe(e,{data:{format:{...z,codeWrap:!C}}})})},[o==null?void 0:o.data.format,e,a,C]),j=F.useCallback(z=>{o!=null&&o.uuid&&a(()=>{pe(o.uuid,{updatedAt:Date.now(),data:{description:mt(z)}})})},[o==null?void 0:o.uuid,a]),D=pt.print||c,S=de(o==null?void 0:o.data.description);return o?r.jsxs(ln,{id:e,className:"my-1 group",horizontal:t,blockRef:x,children:[r.jsxs("div",{className:"rounded bg-grey8",children:[r.jsxs("div",{className:"h-10 flex items-center text-t2 justify-between px-2 overflow-x-auto",children:[r.jsxs("div",{className:"flex items-center text-ellipsis flex-shrink-0 text-black",children:[r.jsx(H,{name:"IcToggleGrey",size:"middle",className:B("text-grey3 mr-1 animate-hover transition-transform rotate-90",!D&&"rotate-0"),onClick:()=>u(!D)}),d?r.jsx(xt,{autoFocus:!0,showBorder:!1,readonly:i,className:"h-7 w-full rounded-sm",inputClassName:"px-0.5 text-t2 h-7",placeholder:"请输入代码块名称",value:S,onBlur:()=>{d&&f(!1)},onChange:j}):r.jsx("div",{className:B("animate-hover text-ellipsis w-full px-0.5 min-w-[30px] h-[22px] group-hover:opacity-100 transition-opacity",!S&&"text-grey4 opacity-0"),onClick:z=>{i||(z.preventDefault(),z.stopPropagation(),f(!0))},children:S||(i?"":"请输入代码块名称")})]}),r.jsxs("div",{className:"transition-opacity opacity-0 group-hover:opacity-100 flex items-center flex-shrink-0 text-t2 text-grey3 ml-2 h-7",children:[r.jsx(hme,{className:"h-full",value:k,readonly:i,onChange:z=>{a(()=>{var Z;Nn(Bx,z);const Q=(Z=o.data.format)!=null?Z:{};pe(e,{data:{format:{...Q,language:z}}})})}}),!i&&r.jsxs(r.Fragment,{children:[v.button&&r.jsx(dme,{blockId:e}),r.jsx("div",{className:"h-4 w-px bg-grey4 mx-2.5"}),r.jsxs("div",{className:"flex items-center px-1 animate-hover h-full",onClick:I,children:[r.jsx(H,{name:"IcCode",size:"middle",className:"mr-1"}),"自动换行",C?"开启":"关闭"]}),r.jsx("div",{className:"h-4 w-px bg-grey4 mx-2.5"})]}),r.jsxs("div",{className:B("h-7 px-1 animate-hover flex items-center",l===Tt.NOTIFICATION&&"hidden"),onClick:()=>{on(de(o.data.segments),{message:"已复制代码"})},children:[r.jsx(H,{size:"middle",className:"mr-1",name:"IcMenuCopy"}),r.jsx("span",{children:"复制"})]})]})]}),D&&r.jsxs(r.Fragment,{children:[v.code&&r.jsx(Wi,{resizeHeight:!0,readonly:i||y,defaultBlockFullWidth:!0,resizeWidth:!1,maxWidth:_,minHeight:R4,defaultWidth:_,defaultHeight:b||h.height||R4,onChange:g,onRenderSize:p,onKeyDownMoveBar:()=>{w(!1)},onKeyUpMoveBar:()=>{w(!b)},className:B("flex relative z-0 w-full group border-t",y&&"pointer-events-none",E&&"!h-full"),children:r.jsx("div",{className:B("h-full",!E&&"overflow-y-auto"),children:r.jsx("div",{className:B(!E&&"h-full"),children:r.jsx(nP,{className:B("pb-4",!E&&"h-full"),id:e,noScrollbars:l===Tt.NOTIFICATION,maxHeight:l===Tt.NOTIFICATION?150:void 0,padding:"0px",language:k,wordWrap:C,segments:o.data.segments,onChange:(z,Q)=>{s(z,Q)}})})})}),v.preview&&r.jsx(ume,{blockId:e})]})]}),r.jsx(wo,{blockId:e,className:"px-2"})]},`${e}-darkMode-${n}`):null},mme=e=>{var l,c;const t=_e(e.id,["data"],["description","segments","format"]),[n,s]=Li();if(n||pt!=null&&pt.print)return r.jsx(fme,{...e});const a=de(t==null?void 0:t.data.description),o=de((l=t==null?void 0:t.data.segments)!=null?l:[]),i=(c=t==null?void 0:t.data.format)==null?void 0:c.height;return r.jsxs("div",{ref:s,className:"bg-grey8 my-1 text-t2","data-block-id":e.id,children:[r.jsx("div",{className:"px-3 h-8 flex items-center",children:a}),r.jsx("div",{className:"p-3 pl-10 whitespace-pre-wrap break-words border-t border-grey6",style:{height:i||"unset"},children:o})]})},hme=({className:e,value:t,onChange:n,readonly:s})=>{const a=d0.map(o=>({title:o,value:o}));return a.sort(hr(o=>o.title,I1)),r.jsx(Uo,{SelectView:oC,enableSearch:!0,readonly:s,className:e,options:a,value:t,onChange:n})},pme=({children:e})=>r.jsx(r.Fragment,{children:e}),A4=46,gme=70,_me=zt.memo(e=>{_e(e.id,["subNodes"]);const t=Xr(),n=Wc(),s=F.Children.toArray(e.children),a=ke(),o=Ve(e.id),i=On(),l=ny(),c=ae(_=>{const x=_.blocks[e.id];if(!x)return[];const y=[];return x.subNodes.forEach(b=>{const E=_.blocks[b];if(E){const w=M$(E,["data"],["columnRatio"]);y.push(w)}}),y},{equalityFn:kn}),[u,d]=F.useMemo(()=>{const _=[];let x=0;return c.forEach(y=>{const b=y.data.columnRatio||1/c.length;x+=b,_.push(b)}),[x,_]},[c]),f=(_,x)=>{var P,M,U,V;const y=jn(`.column-list-${e.id}`,i);if(!y)return;const b=W=>{let z=gme;const Q=W.querySelectorAll("[data-column-item-min-width]");for(const Z of Q)if(Z instanceof HTMLElement&&Z.dataset.columnItemMinWidth){const te=parseFloat(Z.dataset.columnItemMinWidth);te>z&&(z=te)}return z},E=[],w=[];y.childNodes.forEach(W=>{W instanceof Element&&W.classList.contains("column-block")&&(E.push(W),w.push(b(W)))});const k=y.getBoundingClientRect().width-A4*(E.length-1),C=E[_],T=(P=w[_])!=null?P:0,v=(M=c[_])==null?void 0:M.uuid,I=E[_+1],j=(U=w[_+1])!=null?U:0,D=(V=c[_+1])==null?void 0:V.uuid;if(!C||!v||!I||!D)return;const S=parseFloat(getComputedStyle(C).width)+x.deltaX,R=parseFloat(getComputedStyle(I).width)-x.deltaX;if(S<T||R<j)return;const A=S/k*c.length,L=R/k*c.length;switch(x.resizeStatus){case ra.START:{Ye({$columnResizing:!0});break}case ra.RESIZING:{Is.unstable_batchedUpdates(()=>{pe(v,{data:{columnRatio:A}},!0),pe(D,{data:{columnRatio:L}},!0)});break}case ra.END:{Ye({$columnResizing:!1}),a(()=>{pe(v,{data:{columnRatio:A}}),pe(D,{data:{columnRatio:L}})});break}}},h=Cr(),p=ae(({blocks:_})=>{var y,b;const x=(y=_[e.id])==null?void 0:y.subNodes;return Math.max(...(b=x==null?void 0:x.map(E=>{var w;return((w=K.blocks[E])==null?void 0:w.subNodes.length)||0}))!=null?b:[])}),g=s.flatMap((_,x,y)=>{var T;if(!F.isValidElement(_))return null;const b=(T=d[x])!=null?T:1,E={width:h?"100%":`calc((100% - ${(s.length-1)*A4}px) * ${b/u})`},w=_.props.id,k=r.jsxs("div",{className:"flex flex-col column-block my-[0.5px]",style:E,children:[_,r.jsx("div",{className:"flex-1",onClick:()=>{var I,j;if(o)return;((j=(I=K.blocks[w])==null?void 0:I.subNodes.length)!=null?j:0)<p&&l(w)}})]},w),C=r.jsx(Lb,{readonly:o,className:"col-drop relative w-[46px]",position:"right",id:w,supportResize:!t&&!n,onResize:v=>{f(x,v)}},`${w}-right`);return t?x===0?[r.jsx(Lb,{readonly:o,className:"absolute w-20 inset-y-2 -left-20",position:"left",id:w},`${w}-left`),k,C]:x===y.length-1?[k,r.jsx(Lb,{readonly:o,className:"absolute w-20 inset-y-2 -right-20",position:"right",id:w},`${w}-right`)]:[k,C]:x===y.length-1?k:[k,C]});return r.jsx(ln,{horizontal:!0,hideHoverMenu:!0,"data-column-list":!0,id:e.id,className:B(`flex py-1.5 column-list-${e.id}`,h?"flex-col":""),children:g})}),Lb=({id:e,position:t,className:n,supportResize:s,onResize:a,readonly:o})=>{var f,h,p,g;const i=F.useRef(null),l=F.useRef(null),c=z$(e),{height:u=0}=Ba(l,"height"),d=`-${(u-((h=(f=i.current)==null?void 0:f.clientHeight)!=null?h:0))*.5}px`;return ig(l,{onResize:_=>{var x,y,b;_.resizeStatus===ra.START?((x=l.current)==null||x.setAttribute("style",`opacity:1;top: ${d}`),document.body.classList.add("select-none")):_.resizeStatus===ra.END&&((y=l.current)==null||y.removeAttribute("style"),(b=l.current)==null||b.setAttribute("style",`top: ${d}`),document.body.classList.remove("select-none")),a==null||a(_)},type:"x"}),r.jsxs("div",{"data-column-id":e,ref:i,className:n,children:[c===t&&r.jsx("div",{"data-disable-select":!0,className:B("absolute bg-black/30 h-full w-1",t==="left"?"right-2":"left-2")}),!o&&r.jsx("div",{ref:l,className:B("absolute flex justify-center w-[46px] min-h-[56px] h-full cursor-[col-resize] opacity-0 transition-opacity hover:opacity-100",{hidden:!s||c}),style:{top:`-${(u-((g=(p=i.current)==null?void 0:p.clientHeight)!=null?g:0))*.5}px`},children:r.jsx("div",{className:"bg-black/30 h-full w-1 left-[calc(50%-2px)]"})})]})},xme=({id:e,root:t})=>r.jsx(ln,{id:e,horizontal:t,children:r.jsx("div",{className:"flex items-center h-5 leading-5",children:r.jsx("div",{className:"h-px w-full bg-grey6"})})}),D3=({uuid:e,url:t})=>{const n=t||`${Sn()}/preview/${e}`;return r.jsxs(r.Fragment,{children:[r.jsx("a",{href:n,className:"block my-2 break-words border w-full underline rounded p-8",children:n}),r.jsx(wo,{blockId:e})]})},Fme=({id:e,root:t})=>{const n=_e(e,["data","local"],["link"]);if(!n)return null;const s=pt.print;return n.data.link&&!n.local?s?r.jsx(D3,{uuid:e,url:n.data.link}):r.jsx(bme,{id:e,root:t}):r.jsx(yme,{id:e,root:t})},yme=e=>{var h;const t=_e(e.id,["local","data"],["link","embedType"]),n=me(),[s,a]=F.useState(!1),o=F.useRef(""),i=ke(),l=Ve(e.id),c=t==null?void 0:t.data.embedType,u=c?(h=Zk()[c])==null?void 0:h.data:null;F.useEffect(()=>{t&&t.local&&t.data.link&&(pe(e.id,{local:!1},!0),d(t.data.link))},[]),F.useEffect(()=>{pe(e.id,{local:!1},!0)},[e.id]);const d=F.useCallback(async p=>{if(!p.trim())return;a(!0);const g=await jc(p,!0);i(()=>{var _;((_=g==null?void 0:g.headerMap)==null?void 0:_["X-Frame-Options"])!==void 0&&(g.headerMap["X-Frame-Options"].toLocaleLowerCase()==="allow"||g.headerMap["X-Frame-Options"]==="")&&g.link.match(/(https):\/\/([\w.]+\/?)\S*/gi)&&!kA(g.link)?pe(e.id,{data:{link:p}}):pe(e.id,{type:m.BlockType.BOOKMARK,data:{link:p,linkInfo:mt(g==null?void 0:g.title),cover:g==null?void 0:g.cover,icon:{type:"http",value:g==null?void 0:g.icon},description:mt(g==null?void 0:g.description),headers:g==null?void 0:g.headerMap}})}),a(!1)},[e.id,i]),f=F.useCallback(p=>{s||n.dropdown({popcorn:p.currentTarget,placement:"bottom",content:({onCloseModal:g})=>r.jsxs("div",{className:"flex flex-col w-[370px] next-modal px-2.5 py-3.5",children:[r.jsx(xt,{autoFocus:!0,className:"h-8 rounded-sm",placeholder:u?u.placeholder:"https://www.example.com",onChange:_=>o.current=_,onEnter:()=>{d(o.current),g()}}),r.jsx(je,{size:"large",colorType:"active",className:"mt-3.5 text-t4-medium",onClick:()=>{d(o.current),g()},children:"提交"})]})})},[u,s,n,d]);return r.jsx(ln,{id:e.id,horizontal:e.root,className:"my-1 print:hidden",children:r.jsx(uu,{readonly:l,iconElement:u&&r.jsx("img",{src:u.image,className:"w-6 h-6"}),defaultOpenPanel:!!(t!=null&&t.local&&!t.data.link),iconProp:{name:"IcUploadWeb"},text:s?"正在嵌入内容...":u?`嵌入${u.title}`:"添加嵌入内容",onClick:f,className:l?"cursor-default":"cursor-pointer"})})},bme=({id:e,root:t})=>{const[n,s]=F.useState(!1),[a,o]=F.useState(!1),i=Cr(),l=F.useRef(setTimeout(()=>{})),c=_e(e,["data"],["link"]),u=Ve(e),[d,f]=Li(),[h,p]=F.useState(""),g=F.useMemo(()=>{const{website:D,url:S}=ZE(h);return D?D===mr.music163&&S.includes("?type=2")?{resizeHeight:!1,defaultHeight:86}:{}:{}},[h]),{renderSize:_,onRenderSize:x,changeSize:y,containerWidth:b,containerRef:E,isDisable:w,defaultWidth:k,defaultHeight:C,defaultBlockFullWidth:T,widthBreakPoints:v}=zi({id:e,defaultWidth:500,defaultHeight:400,root:t});F.useEffect(()=>{var D;d&&!h&&jc((D=c==null?void 0:c.data.link)!=null?D:"",!0).then(S=>{p((S==null?void 0:S.link)||(c==null?void 0:c.data.link)||"")})},[c==null?void 0:c.data.link,h,d]);const I=F.useCallback(()=>{var D;on((D=c==null?void 0:c.data.link)!=null?D:"")},[c==null?void 0:c.data.link]),j=F.useCallback(()=>{p(""),s(!0),o(!1),xs(1e3).then(()=>{p(h)})},[h]);return c?r.jsxs(ln,{blockRef:E,id:e,horizontal:t,fullWidth:!t||i,className:"my-2.5 self-center",children:[r.jsxs(Wi,{resizeHeight:!0,widthBreakPoints:v,readonly:u,doubleResize:t,defaultWidth:k||Da,defaultHeight:C,defaultBlockFullWidth:T,maxWidth:b,minHeight:80,onChange:y,onRenderSize:x,...g,children:[a&&!n&&r.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full cursor-pointer bg-grey8",onClick:j,children:[r.jsx($s,{emojiStr:"🕸️",iconSize:70,className:"mb-2 pointer-events-none"}),r.jsx("div",{className:"text-grey4 text-t2",children:"网页加载失败，点击刷新"})]}),!a&&n&&r.jsx(os,{}),r.jsxs("div",{className:"w-full h-full",children:[r.jsxs("div",{onClick:I,className:B("flex absolute top-2.5 right-3 z-10 cursor-pointer bg-black/75 opacity-0 group-hover:opacity-100 text-white1 transition-opacity text-t4 px-1 py-0.5 rounded-sm animate-click items-center"),children:[r.jsx(H,{name:"IcUrl",className:"mr-1",size:"middle"}),r.jsx("span",{children:"复制链接"})]}),r.jsx("div",{className:"relative w-full h-full overflow-hidden",children:r.jsx("iframe",{referrerPolicy:"origin",allowFullScreen:!0,className:B("w-full h-full absolute inset-0",w&&"pointer-events-none",{hidden:a}),ref:f,src:h,sandbox:"allow-scripts allow-popups allow-top-navigation-by-user-activation allow-forms allow-same-origin",onLoad:()=>{clearTimeout(l.current),o(!1),s(!1)}})})]})]}),r.jsx(wo,{blockId:e,style:{width:_.width}})]}):null},S3=e=>{const{uuid:t}=e,n=ke(),{role:s}=it(t),a=ae(l=>{var c,u;return(u=(c=l.blocks[t])==null?void 0:c.data.format)==null?void 0:u.locked}),[o,i]=F.useState(!1);return F.useEffect(()=>{t&&i(!1)},[t]),s===m.PermissionRole.READER?null:a?r.jsx(wme,{uuid:t,onClick:()=>{ce.event("page_lock",{is_open:!1}),n(()=>{pe(t,{data:{format:{locked:!1,lockedBy:K.user.uuid}}})}),o||i(!0)}}):o?r.jsx(kme,{uuid:t,onClick:()=>{ce.event("page_lock",{is_open:!0}),n(()=>{pe(t,{data:{format:{locked:!0,lockedBy:K.user.uuid}}})}),i(!1)}}):null},Eme=zt.memo(e=>{const t=ae(s=>{var a,o;return(o=(a=s.blocks[e.uuid])==null?void 0:a.data.format)==null?void 0:o.lockedBy}),n=Yr(t!=null?t:"","");return r.jsxs("div",{className:"flex rounded px-2 py-1 flex-col items-center",children:[n?r.jsx("div",{children:`已被${n}锁定`}):r.jsx("div",{children:"页面已被锁定"}),r.jsx("div",{children:"点击解锁"})]})}),wme=e=>r.jsx(Fe,{popup:r.jsx(Eme,{uuid:e.uuid}),children:r.jsxs("div",{className:"cursor-pointer flex hover:animate-hover py-1 px-2 items-center rounded h-7.5 text-ellipsis",...e,children:[r.jsx(H,{name:"IcMenuLock",style:{color:"var(--grey4)"}}),r.jsx("div",{className:"text-t2 text-grey4 ml-0.5 sm:hidden",children:"已锁定"})]})}),kme=e=>r.jsx(Fe,{popup:"点击重新锁定页面",children:r.jsxs("div",{className:"cursor-pointer flex border-active_color border hover:opacity-90 py-1 px-2 items-center rounded h-7.5 text-ellipsis",...e,children:[r.jsx(H,{name:"IcMenuUnlock",style:{color:to.active_color}}),r.jsx("div",{className:"text-t2 text-active_color ml-0.5 sm:hidden",children:"重新锁定"})]})}),EE=({className:e})=>{const t=F.useRef(),{viewId:n}=Te(),s=vm(n),[a,o]=F.useState(""),[i,l]=F.useState(!1),c=F.useCallback(_=>{const x=wt.$collectionSearch;Ye({$collectionSearch:{...x,[n]:_}})},[n]);F.useEffect(()=>()=>c(void 0),[c]);const u=F.useCallback(fs(c,300),[c]),d=F.useCallback(_=>{o(_),u(_)},[u]),f=_=>{_.stopPropagation(),l(!1),o(""),c(void 0)},h=_=>{be("esc")(_)&&(l(!1),o(""),c(void 0))},p=()=>{l(!1),a===""&&c(void 0)},g=s!==void 0||i;return r.jsxs("div",{className:B("relative flex items-center",e),onClick:_=>{_.stopPropagation();const x=setTimeout(()=>{var y;(y=t.current)==null||y.focus(),c(""),o(""),clearTimeout(x)});l(!0)},children:[r.jsx(H,{size:"middle",className:"mr-1 text-grey3",name:"IcSearch"}),r.jsx(xt,{type:"text",showBorder:!1,inputRef:t,onBlur:p,placeholder:"输入关键字",className:"border-none !bg-transparent transition-all duration-200 focus:border-0",inputClassName:"px-0 focus:border-none",style:{width:g?160:0},value:a,onChange:d,onKeyDown:h}),g&&r.jsx(H,{size:"middle",className:B("animate-hover cursor-pointer text-grey4",a?"opacity-100":"opacity-0"),name:"IcUploadCancel",onClick:f}),!g&&r.jsx("span",{className:"text-t2 whitespace-nowrap text-grey3",children:"搜索"})]})},R3=()=>{const{viewId:e,collectionId:t}=Te();return ae(({blocks:s,collectionViews:a})=>{var l;const o=a[e];if(!o||o.type!==m.CollectionViewType.CALENDAR)return;const i=(l=s[t])==null?void 0:l.subNodes;if(i)return i.filter(c=>{var g,_;const u=s[c];if((u==null?void 0:u.type)!==m.BlockType.PAGE)return!1;const d=(g=o.format.calendarBy)!=null?g:"",f=(_=o.format.calendarByEnd)!=null?_:"",h=Cl(u,d),p=Cl(u,f);return!h&&!p})})},d5=({closeModal:e,popper:t})=>{var u;const{viewId:n}=Te(),s=ke(),a=R3(),o=Gd(),i=(()=>{if(!a)return[];const{blocks:d}=le();return a.map(f=>{const h=d[f];return{type:$.SEARCH,data:{uuid:f,title:de(h==null?void 0:h.data.segments)||Ot(m.BlockType.PAGE),icon:h==null?void 0:h.data.icon,type:m.BlockType.PAGE,renderRight:()=>r.jsx("div",{className:"text-t2 animate-hover p-1",onClick:p=>{p.stopPropagation(),o(f);const g=setTimeout(()=>{var _;(_=t==null?void 0:t.current)==null||_.forceUpdate(),clearTimeout(g)},300)},children:"查看"})}}})})(),l=d=>{const{uuid:f}=d.data,h=Zt(n);if(!h)return;const{calendarBy:p,calendarByEnd:g}=h;if(!p||!g)return;const{blocks:_}=le(),x=_[f];if(!x)return;(a==null?void 0:a.length)===1&&e();const y=setTimeout(()=>{clearTimeout(y),s(()=>{pe(f,{data:{collectionProperties:{...x.data.collectionProperties,[p]:[Fn({from:new Date})],[g]:[Fn({from:new Date})]}}})})},300)},c=new Date;return r.jsxs("div",{className:"w-[400px] rounded-sm next-modal py-[5px]",children:[r.jsx("div",{className:"h-10 px-4 flex justify-between items-center",children:r.jsxs("div",{className:"flex items-center text-t2",children:[r.jsx(H,{className:"mr-1",name:lo[m.CollectionViewType.CALENDAR],size:"middle"}),r.jsxs("span",{className:"mr-2",children:[(u=a==null?void 0:a.length)!=null?u:0," 条记录没有填写日期时间"]})]})}),r.jsxs("div",{className:"h-10 px-4 flex items-center text-grey3 text-sm",children:["点击将以下记录添加到日历 (",c.getMonth()+1,"月",c.getDate(),"日)"]}),r.jsx(ze,{items:i,onItemClick:d=>l(d)})]})},Cme=()=>{const{viewId:e,viewParentId:t,isLocked:n}=Te(),s=me(),a=ke(),o=ae(({collectionViews:c})=>{var u;return(u=c[e])==null?void 0:u.type}),l=[...f5(),{type:$.OPERATION,data:{icon:n?"IcMenuUnlock":"IcMenuLock",title:n?"解锁多维表":"锁定多维表",tip:"锁定时，无法新增/修改多维表的配置、视图和属性，但可以新增/编辑记录。",onClick:()=>{a(()=>{pe(t,{data:{format:{locked:!n,lockedBy:K.user.uuid}}})})}}},{type:$.LINE},{type:$.OPERATION,data:{title:"属性",icon:"IcProperties",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(KC,{})}})}}},{type:$.OPERATION,isHidden:o===m.CollectionViewType.FORM,data:{title:"筛选",icon:"IcFilter",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(Jg,{})}})}}},{type:$.OPERATION,isHidden:o===m.CollectionViewType.FORM,data:{title:"排序",icon:"IcSort",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(ch,{})}})}}},{type:$.OPERATION,isHidden:o===m.CollectionViewType.CALENDAR||o===m.CollectionViewType.FORM,data:{title:"分组",icon:"IcGroup",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(Pc,{})}})}}},{type:$.OPERATION,isHidden:o!==m.CollectionViewType.BOARD,data:{title:"子分组",icon:"IcSubGroup",onClick(c){s.dropdown({popcorn:c.currentTarget,placement:"left",content(){return r.jsx(Pc,{isSubGroup:!0})}})}}}];return r.jsx("div",{className:"w-[200px] py-2 next-modal",children:r.jsx(ze,{items:l,customFooter:r.jsx(eu,{beforeIcon:!0,linkContainer:!0,link:Ta.bitableLink,className:"text-t4 text-grey3 items-center h-10 mx-4 mt-1 border-t border-grey6 w-full",children:"了解如何使用多维表"})})})},Tme=()=>{var y,b,E;const{viewId:e,viewParentId:t,isLocked:n}=Te(),{getState:s}=Kr(),a=Un(),o=me(),i=ke(),l=R3(),c=eh(),u=Cg(e),d=ae(({collectionViews:w})=>{var k;return(k=w[e])==null?void 0:k.type}),{role:f}=it((b=(y=s().blocks[t])==null?void 0:y.parentId)!=null?b:""),h=Mx(t),p=f5(),g=Kt(),_=w=>{o.dropdown({popcorn:w.currentTarget,placement:"left",content({onCloseModal:k}){var j,D;const{blocks:C}=s(),T=C[t],v=ls(t);if(!T)return null;const I=((D=(j=C[T.spaceId])==null?void 0:j.subNodes)!=null?D:[]).map(S=>{if(S===v||S===t)return;const R=C[S];if(R&&!(R.type!==m.BlockType.PAGE&&R.type!==m.BlockType.COLLECTION_VIEW_PAGE&&R.type!==m.BlockType.COLLECTION_VIEW))return Ax(R)}).filter(S=>!!S);return r.jsx(yc,{onSelect:async S=>{k(),i(()=>Ri([t],{parentId:S.uuid,last:!0}))},defaultValue:I,searchType:"page",source:"move"})}})},x=[{type:$.OPERATION,isHidden:f===m.PermissionRole.READER,data:{title:"删除",icon:"IcMenuDelete",onClick(){i(()=>{ha(t)}),g(Xe.BITABLE_OPTION_MENU)}}},{type:$.OPERATION,isHidden:f===m.PermissionRole.READER,data:{title:"拷贝副本",icon:"IcMenuDuplicate",onClick:()=>{c([t]),g(Xe.BITABLE_OPTION_MENU)}}},{type:$.OPERATION,isHidden:!h,data:{title:"移动到",icon:"IcMenuMove",onClick:_}},{type:$.OPERATION,data:{title:"以页面打开",icon:"IcMenuOpen",onClick:()=>{const w=ht()?`/share/${t}`:`/${t}`;a.push(w),g(Xe.BITABLE_OPTION_MENU)}}},{type:$.OPERATION,data:{icon:n?"IcMenuUnlock":"IcMenuLock",title:n?"解锁多维表":"锁定多维表",tip:"锁定时，无法新增/修改多维表的配置、视图和属性，但可以新增/编辑记录。",onClick:()=>{i(()=>{pe(t,{data:{format:{locked:!n,lockedBy:K.user.uuid}}})})}}},{type:$.LINE},{type:$.OPERATION,isHidden:f===m.PermissionRole.READER,data:{title:"转换为页面",icon:"IcMenuTurnInto",onClick:()=>{i(()=>{const{blocks:w}=s(),k=w[t];pe(t,{type:(k==null?void 0:k.type)===m.BlockType.COLLECTION_VIEW?m.BlockType.COLLECTION_VIEW_PAGE:m.BlockType.REFERENCE_COLLECTION_PAGE}),g(Xe.BITABLE_OPTION_MENU)})}}},{type:$.LINE},...p,{type:$.OPERATION,data:{title:"属性",icon:"IcProperties",onClick(w){o.dropdown({popcorn:w.currentTarget,placement:"left",content(){return r.jsx(KC,{})}})}}},{type:$.OPERATION,isHidden:d&&[m.CollectionViewType.FORM].includes(d),data:{title:"筛选",icon:"IcFilter",onClick(w){o.dropdown({popcorn:w.currentTarget,placement:"left",content(){return r.jsx(Jg,{})}})}}},{type:$.OPERATION,isHidden:d&&[m.CollectionViewType.FORM].includes(d),data:{title:"排序",icon:"IcSort",onClick(w){o.dropdown({popcorn:w.currentTarget,placement:"left",content(){return r.jsx(ch,{})}})}}},{type:$.OPERATION,isHidden:(l==null?void 0:l.length)===0||d!==m.CollectionViewType.CALENDAR,data:{title:`无时间记录(${(E=l==null?void 0:l.length)!=null?E:0})`,icon:"IcTitleNodate",onClick(w){o.dropdown({popcorn:w.currentTarget,placement:"left",content:({onCloseModal:k,popper:C})=>r.jsx(d5,{closeModal:k,popper:C})})}}},{type:$.OPERATION,isHidden:d&&[m.CollectionViewType.CALENDAR,m.CollectionViewType.FORM].includes(d),data:{title:"分组",icon:"IcGroup",onClick:w=>{o.dropdown({popcorn:w.currentTarget,placement:"left",content(){return r.jsx(Pc,{})}})}}},{type:$.OPERATION,isHidden:d&&d!==m.CollectionViewType.BOARD,data:{title:"子分组",icon:"IcSubGroup",onClick:w=>{o.dropdown({popcorn:w.currentTarget,placement:"left",content(){return r.jsx(Pc,{isSubGroup:!0})}})}}},{type:$.LINE,isHidden:d!==m.CollectionViewType.TABLE},{type:$.TEXT_SWITCH,isHidden:d!==m.CollectionViewType.TABLE,data:{title:"自适应行高",disabled:n,switch:u,onSwitch:w=>{n||yt(e,{tableWrap:w})}}}];return r.jsx("div",{className:"w-[200px] py-2 next-modal-scroll",children:r.jsx(ze,{items:x,customFooter:r.jsx(eu,{beforeIcon:!0,linkContainer:!0,link:Ta.bitableLink,className:"text-t4 text-grey3 items-center h-10 mx-4 mt-1 border-t border-grey6 w-full",children:"了解如何使用多维表"})})})},f5=()=>{const{viewId:e,collectionId:t,viewType:n,changeView:s,viewParentId:a}=Te(),o=JC(),i=ZC(),l=Qg(),c=Kt();return F.useMemo(()=>n!==m.CollectionViewType.FORM?[]:[{type:$.OPERATION,data:{title:"预览",icon:"IcMenuItemHide",onClick(){o({viewId:e,collectionId:t}),c(Xe.BITABLE_OPTION_MENU)}}},{type:$.OPERATION,data:{title:"分享收集表",icon:"IcFormShare",onClick(u){i({popcorn:u.currentTarget,viewId:e,collectionId:t,placement:"left-start"})}}},{type:$.OPERATION,data:{title:"查看收集表数据",icon:"IcMenuOpenNew",onClick(){var d,f;const u=(f=(d=K.blocks[t])==null?void 0:d.views)==null?void 0:f.find(h=>{var p;return((p=K.collectionViews[h])==null?void 0:p.type)===m.CollectionViewType.TABLE});if(u)s(u);else{const h=l(a,"表格",m.CollectionViewType.TABLE);h?s(h):ye.error("切换失败")}c(Xe.BITABLE_OPTION_MENU)}}}],[l,s,c,t,o,i,e,a,n])},vme=()=>{const e=ke();return F.useCallback(t=>e(()=>{Gs([t])}),[e])},m5=()=>{const e=ke();return F.useCallback(t=>e(()=>Qe({type:m.BlockType.PAGE,isTemplate:!0},{parentId:t,templatePages:!0})),[e])},Nme=()=>{const{collectionId:e,viewId:t,readonly:n,isLocked:s}=Te(),a=me(),o=Kt(),i=ae(p=>p.collectionViews[t]),l=m5(),c=Gd(),u=Gi({ignoreSorters:!0}),d=ke(),f=ae(({blocks:p})=>{var _;const g=p[e];return((_=g==null?void 0:g.templatePages)!=null?_:[]).map(x=>{const{role:y}=hn(x);return{id:x,role:y}}).filter(x=>x.role!==m.PermissionRole.NONE)},{equalityFn:kn}),h=p=>{o(Xe.BITABLE_TEMPLATE_RECORDS,{noAnimation:!0}),u({viewId:t,where:{first:!0},templateId:p,openInRight:!0})};return i==null?null:r.jsxs("div",{className:"w-[370px] rounded-sm next-modal",children:[r.jsxs("div",{className:"h-10 px-4 flex items-center text-t2",children:[r.jsx(H,{className:"mr-1",name:lo[i.type],size:"middle"}),r.jsx("span",{className:"mr-2 font-medium",children:Ac[i.type]}),r.jsx("span",{className:"max-w-[140px]",children:"模板记录"})]}),r.jsxs("div",{className:B("max-h-[80vh] overflow-auto",f.length>=1&&"m-2"),children:[r.jsx(vr,{items:f,onChange:p=>{d(()=>{pe(e,{templatePages:p.map(g=>g.id)})})},renderItemContent:({item:p,renderDragHandle:g})=>r.jsxs("div",{className:"flex items-center h-10 px-2 text-t2 animate-hover",onClick:()=>h(p.id),children:[g({className:"cursor-pointer flex items-center justify-center w-5 h-5 mr-1 text-grey4"}),r.jsxs("div",{className:"flex items-center flex-1",children:[r.jsx(tn,{iconSize:18,blockId:p.id,className:"w-5 h-5 mr-1",placement:"bottom-start",defaultIcon:r.jsx(as,{uuid:p.id,size:"middle"})}),r.jsx(vc,{uuid:p.id})]}),!n&&!s&&r.jsx("button",{className:B("flex items-center p-1 text-t2 text-grey3 rounded animate-hover whitespace-nowrap"),onClick:_=>{_.stopPropagation(),a.dropdown({modalId:C1,popcorn:_.currentTarget,content:()=>r.jsx(Ime,{templatePageId:p.id,role:p.role})})},children:r.jsx(H,{size:"middle",name:"IcMore"})})]})}),f.length>=1&&r.jsxs("div",{className:"flex items-center flex-1 h-10 pl-8 animate-hover",onClick:()=>h(),children:[r.jsx(H,{name:"MIcPageBlank",size:"middle",className:"mr-1"}),r.jsx("span",{className:"text-t2",children:"空白页面"})]})]}),!s&&r.jsxs("button",{className:B("flex items-center w-full h-10 p-2 animate-hover",f.length>=1&&"border-t border-grey6"),onClick:()=>{o(Xe.BITABLE_TEMPLATE_RECORDS,{noAnimation:!0});const p=l(e);c(p,{state:{noticeBannerShowBackButton:!0}})},children:[r.jsx(H,{className:"mr-1",name:"MIcAddNew",size:"middle"}),r.jsx("span",{className:"text-t2 text-grey3",children:"创建模板记录"})]})]})},C1="57250b19-0854-498f-a71e-2ce59075cbd5",Ime=e=>{const{templatePageId:t,role:n}=e,s=me(),a=Kt(),o=Gd(),i=eh(),l=vme();return r.jsx("div",{className:"w-[200px] py-2 next-modal",children:r.jsx(ze,{items:[{type:$.OPERATION,isHidden:![m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(n),data:{title:"编辑",icon:"IcMenuEditor",onClick:()=>{a(Xe.BITABLE_TEMPLATE_RECORDS,{noAnimation:!0}),a(C1,{noAnimation:!0}),o(t,{state:{noticeBannerShowBackButton:!0}})}}},{type:$.OPERATION,data:{title:"拷贝副本",icon:"IcMenuDuplicate",onClick:async()=>{await i([t]),a(C1)}}},{type:$.OPERATION,isHidden:![m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(n),data:{title:"删除",icon:"IcMenuDelete",onClick:()=>{a(C1),s.warning({title:r.jsx("p",{className:"mt-5 mb-10 w-60",children:"确定删除这个模板记录吗？"}),confirmText:"确定删除",confirm(){l(t)}})}}}]})})},jme=({onClose:e,closeAddPanel:t})=>{const{changeView:n,embed:s,collectionId:a,viewParentId:o}=Te(),i=_e(a,["views"]),[l,c]=F.useState(m.CollectionViewType.TABLE),u=Qg(),d=F.useRef(null),f=F.useRef(""),h=a!==o,p=g=>{var y;ce.event("bitable_view_create",{from_scene:s?"inline":"inThePage",view_type:l});const _=(y=i==null?void 0:i.views)==null?void 0:y.some(b=>{var E;return((E=K.collectionViews[b])==null?void 0:E.type)===m.CollectionViewType.TABLE}),x=u(o,f.current,l);x&&n(x),!_&&l===m.CollectionViewType.FORM&&u(o,"表单视图",m.CollectionViewType.TABLE),g(),e()};return r.jsxs("div",{className:"w-[240px] next-modal p-2",onClick:()=>{var g;return(g=d.current)==null?void 0:g.focus()},children:[r.jsx(xt,{autoFocus:!0,inputRef:d,placeholder:"请输入名称",className:"h-8 flex-1",onChange:g=>f.current=g,onEnter:()=>p(t)}),r.jsxs("div",{className:"p-1 mb-1",children:[r.jsx("div",{className:"text-t2 text-grey3 my-2",children:"视图类型"}),(h?_m.filter(g=>g.type!==m.CollectionViewType.FORM):_m).map(g=>r.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>c(g.type),children:[r.jsxs("div",{className:"flex h-8 items-center",children:[r.jsx(H,{name:lo[g.type],size:"middle"}),r.jsx("span",{className:"text-t2 ml-1",children:g.name})]}),r.jsxs("span",{className:"flex items-center",children:[l===g.type&&r.jsx(H,{name:"IcSelectedSpace",size:"small"}),r.jsx(Nk,{popup:"查看视图帮助",link:g.helperLink})]})]},g.type))]}),r.jsx(je,{className:"h-8 text-t2",size:"auto",colorType:"active",onClick:()=>p(t),children:"创建"})]})},h5=()=>{const e=me(),t=(n,s,a)=>{e.dropdown({popcorn:n,placement:a!=null?a:"right",content({onCloseModal:o}){return r.jsx(jme,{onClose:s,closeAddPanel:o})}})};return F.useCallback(t,[e])},Dme=e=>{var g;const{changeView:t,managerReadonly:n,viewId:s,isLocked:a}=Te(),{viewId:o,onClose:i,dragOverlay:l}=e,c=ae(({collectionViews:_})=>_[o]),u=me(),d=PC(),f=F.useRef(c==null?void 0:c.type);F.useEffect(()=>{f.current=c==null?void 0:c.type},[c==null?void 0:c.type]);const h=F.useRef((g=c==null?void 0:c.title)!=null?g:"");F.useEffect(()=>{var _;h.current=(_=c==null?void 0:c.title)!=null?_:""},[c==null?void 0:c.title]);const p=(_,x)=>{u.dropdown({popcorn:_,placement:"right",closeBeforeCallBack(){const y=h.current;f.current===x.type?y!==x.title&&Zc(o,{title:y}):f.current&&d(o,y,f.current)},content({onCloseModal:y}){return r.jsx(p5,{viewId:o,onCloseModal:y,onClose:i,viewTypeRef:f,viewTitleRef:h})}})};return c?r.jsxs("div",{className:B("px-2 h-8 text-t2 cursor-pointer animate-hover flex items-center justify-between",l&&"cursor-[grabbing]"),onClick:()=>{t(o),i==null||i()},children:[r.jsxs("div",{className:"flex overflow-hidden pr-1",children:[r.jsx("div",{className:"flex flex-shrink-0 justify-center items-center w-5 h-5 mr-1 cursor-[grab]",children:r.jsx(H,{name:"IcBlockHandle",className:"text-grey4"})}),r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:lo[c.type],size:"middle"}),r.jsx("span",{className:B("flex-1 overflow-hidden whitespace-nowrap overflow-ellipsis ml-1",{"text-t2-bold":c.uuid===s}),children:c.title||Ac[c.type]})]})]}),!n&&!a&&r.jsx("button",{className:"w-5 h-5 flex-shrink-0 animate-hover rounded-sm flex items-center justify-center",onClick:_=>{_.stopPropagation(),p(_.currentTarget,c)},children:r.jsx(H,{name:"IcMore",className:"text-grey3"})})]}):null},p5=({viewId:e,onCloseModal:t,onClose:n,viewTypeRef:s,viewTitleRef:a})=>{var b,E;const{changeView:o,embed:i,collectionId:l,viewParentId:c}=Te(),u=ae(({collectionViews:w})=>w[e]),d=me(),f=F.useRef(null),[h,p]=F.useState((b=u==null?void 0:u.type)!=null?b:m.CollectionViewType.TABLE),g=XL(),_=YL(),x=l!==c,{views:y=[]}=(E=sh(c))!=null?E:{};return u?r.jsxs("div",{className:"w-[240px] next-modal p-2",onClick:()=>{var w;return(w=f.current)==null?void 0:w.focus()},children:[r.jsx(xt,{autoFocus:!0,inputRef:f,placeholder:"请输入名称",className:"h-8 flex-1 mb-2",defaultValue:u.title,onEnter:t,onChange:w=>a.current=w}),r.jsx("div",{className:"w-full py-2 text-t2 text-grey3 mb-[4px]",children:"视图类型"}),(x?_m.filter(w=>w.type!==m.CollectionViewType.FORM):_m).map(w=>r.jsxs("div",{className:"flex justify-between items-center",onClick:()=>{p(w.type),s.current=w.type},children:[r.jsxs("div",{className:"flex px-1 items-center h-8",children:[r.jsx(H,{name:lo[w.type],size:"middle"}),r.jsx("span",{className:"text-t2 ml-1",children:w.name})]}),r.jsxs("span",{className:"flex items-center",children:[h===w.type&&r.jsx(H,{name:"IcSelectedSpace",size:"small"}),r.jsx(Nk,{popup:"查看视图帮助",link:w.helperLink})]})]},w.type)),r.jsx(Rr,{className:"my-2"}),r.jsxs("button",{className:"h-8 px-1 flex w-full items-center animate-hover rounded",onClick:()=>{ce.event("bitable_view_create",{from_scene:i?"inline":"inthepage",view_type:h});const w=_(e);w&&o(w),t(),n==null||n()},children:[r.jsx(H,{className:"mr-1",size:"middle",name:"IcMenuDuplicate"}),r.jsx("span",{className:"text-t2",children:"拷贝"})]}),y.length>1&&r.jsxs("button",{className:"h-8 px-1 flex w-full items-center animate-hover rounded",onClick:()=>{d.warning({title:r.jsx(r.Fragment,{children:"是否确认删除该视图？"}),confirm:()=>{g(e),t(),n==null||n()}})},children:[r.jsx(H,{className:"mr-1",size:"middle",name:"IcMenuDelete"}),r.jsx("span",{className:"text-t2",children:"删除"})]})]}):null},B4=({uuid:e})=>{var h;const{viewId:t,changeView:n,managerReadonly:s,isLocked:a}=Te(),o=ae(({collectionViews:p})=>p[e]),i=PC(),l=me(),c=F.useRef(o==null?void 0:o.type);F.useEffect(()=>{c.current=o==null?void 0:o.type},[o==null?void 0:o.type]);const u=F.useRef((h=o==null?void 0:o.title)!=null?h:"");F.useEffect(()=>{var p;u.current=(p=o==null?void 0:o.title)!=null?p:""},[o==null?void 0:o.title]);const d=(p,g)=>{s||a||l.dropdown({popcorn:p,placement:"bottom",closeBeforeCallBack(){const _=u.current;c.current===g.type?_!==g.title&&Zc(e,{title:_}):c.current&&i(e,_,c.current)},content({onCloseModal:_}){return r.jsx(p5,{viewId:e,onCloseModal:_,onClose:()=>{},viewTypeRef:c,viewTitleRef:u})}})};if(!o)return null;const f=t===e;return r.jsx("div",{"data-disable-select":!0,className:B("flex items-center mr-3 text-grey3 h-full",f&&"border-b-2 border-black text-black pt-0.5"),children:r.jsxs("button",{className:B("flex items-center p-1 text-t2  animate-hover"),onContextMenu:p=>{p.preventDefault(),p.stopPropagation(),d(p.currentTarget,o)},onClick:p=>{f?d(p.currentTarget,o):n(e)},children:[r.jsx(H,{className:"mr-1",name:lo[o.type],size:"middle"}),r.jsx("span",{className:"max-w-[150px] text-ellipsis",children:o.title||Ac[o.type]})]})})},Sme=({onClose:e})=>{const{viewParentId:t,managerReadonly:n,readonly:s,isLocked:a}=Te(),o=ae(({blocks:c})=>{var u,d;return(d=(u=c[t])==null?void 0:u.views)!=null?d:[]}),i=ke(),l=h5();return r.jsxs("div",{className:"w-[240px] next-modal-scroll",children:[r.jsx(vr,{disabled:a||s||n,items:o.map(c=>({id:c})),renderItemContent:({item:c})=>r.jsx(Dme,{viewId:c.id,onClose:e}),onChange:c=>{i(()=>{pe(t,{views:c.map(u=>u.id)})})}}),!n&&!a&&r.jsxs(r.Fragment,{children:[r.jsx(Rr,{}),r.jsxs("button",{className:"flex p-2 w-full items-center text-t2 animate-hover",onClick:c=>l(c.currentTarget,e),children:[r.jsx(H,{className:"mr-1",name:"MIcAddNew",size:"middle"}),"创建视图"]})]})]})},g5=({className:e})=>{const{pageManager:t,viewParentId:n,viewId:s,isLocked:a,readonly:o}=Te(),i=h5(),l=ke(),c=me(),u=ae(({blocks:E})=>{var w,k;return(k=(w=E[n])==null?void 0:w.views)!=null?k:[]}),[d,f]=F.useState(u.length),h=F.useRef(null),p=F.useRef(null),g=ae(({collectionViews:E})=>E[s]),{width:_}=Ba(t==null?void 0:t.current),{width:x}=Ba(p.current);F.useEffect(()=>{const E=t==null?void 0:t.current,w=E==null?void 0:E.lastElementChild,k=p.current;if(!w||!k)return;const C=w.clientWidth,T=k.clientWidth,v=window.getComputedStyle(E),I=parseInt(v.paddingLeft,10),j=parseInt(v.paddingRight,10),D=E.clientWidth-I-j-C-150;if(T<D){f(u.length);return}let S=0,R=0;Array.from(k.children).reverse().find(A=>(S++,R+=A.clientWidth,T-R<D)),f(Math.max(u.length-S,1))},[t,d,x,u.length,_]);const y=E=>{c.dropdown({popcorn:E.currentTarget,placement:"bottom",content({onCloseModal:w}){return r.jsx(Sme,{onClose:w})}})};if(!g)return null;const b=u.slice(0,d);return b.includes(s)||(b.pop(),b.push(s)),r.jsxs(r.Fragment,{children:[r.jsx(vr,{isHorizontalAxis:!0,strategy:Z0,modifiers:[J0,Gp],disabled:o||a,className:B("flex h-full flex-1",e),listRef:h,appendChild:d!==u.length?r.jsx("div",{className:B("flex items-center mr-2 text-t2"),onClick:y,children:r.jsxs("button",{className:"flex items-center text-grey4 animate-hover p-1 whitespace-nowrap",children:[u.length-d,"更多..."]})}):!(o||a)&&r.jsx("div",{className:B("flex items-center mr-2"),children:r.jsx("button",{className:"flex items-center text-grey4 animate-hover p-1",onClick:E=>i(E.currentTarget,()=>{},"bottom"),children:r.jsx(H,{name:"IcAddBoard",size:"middle"})})}),onDragStart:()=>W1(),items:b.map(E=>({id:E})),renderItemContent:({item:E})=>r.jsx(B4,{uuid:E.id},E.id),onChange:E=>{l(()=>{const w=E.map(k=>k.id);pe(n,{views:w.concat(u.filter(k=>!w.includes(k)))})})}}),r.jsx("div",{className:"absolute opacity-0 flex top-0 right-0 overflow-hidden pointer-events-none",ref:p,children:u.map(E=>r.jsx(B4,{uuid:E},E))})]})},Rme=({className:e})=>{var S;const{viewId:t,managerReadonly:n,readonly:s,viewType:a,pageManager:o,isLocked:i,collectionId:l}=Te(),c=ps(t),u=c==null?void 0:c.format.formIllegal,d=R3(),{filterEnabled:f,sortersEnabled:h,groupEnabled:p,subGroupEnabled:g}=ae(R=>{var re,ne,Y;const A=Zt(t,R.blocks,R.collectionViews);if(!A)return{};const{view:L,collection:P,subGroupBy:M,groupBy:U}=A,V=qg(L.format.filter,P.data.schema),z=((re=L.format.sorters)!=null?re:[]).filter(X=>!X.disable).length>0,Q=$g(l,R),Z=Q.includes((ne=U==null?void 0:U.property)!=null?ne:""),te=Q.includes((Y=M==null?void 0:M.property)!=null?Y:"");return{filterEnabled:V,sortersEnabled:z,groupEnabled:Z,subGroupEnabled:te}},{equalityFn:Cn}),_=me(),x=m.CollectionViewType.FORM===(c==null?void 0:c.type),y=Ar(WC),b=F.useRef((S=c==null?void 0:c.title)!=null?S:"");F.useEffect(()=>{var R;b.current=(R=c==null?void 0:c.title)!=null?R:""},[c==null?void 0:c.title]);const E=(R,A=!1)=>{_.dropdown({popcorn:Br(R.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Pc,{isSubGroup:A})}})},w=R=>{_.dropdown({popcorn:Br(R.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(ch,{})}})},k=R=>{_.dropdown({popcorn:Br(R.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Jg,{})}})},C=R=>{_.dropdown({modalId:Xe.BITABLE_OPTION_MENU,popcorn:R.currentTarget,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Cme,{})}})},T=R=>{_.dropdown({popcorn:R.currentTarget,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content:({onCloseModal:A,popper:L})=>r.jsx(d5,{closeModal:A,popper:L})})},v=F.useRef(null),I=F.useRef(t);I.current=t;const j=R=>{var A;_.dropdown({popcorn:(A=v.current)!=null?A:document.body,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],closeBeforeCallBack:()=>{var M;const L=b.current,P=(M=le().collectionViews)==null?void 0:M[I.current];L!==(P==null?void 0:P.title)&&Zc(I.current,{title:L})},content:({onCloseModal:L})=>r.jsx(QC,{viewTitleRef:b,defaultItemType:R,onCloseModal:L})})};F.useEffect(()=>{x&&y&&j(XC.FORM_LOGIC)},[x,y]);const D=_5();return r.jsxs("div",{className:B("flex items-center justify-between bg-white1 sticky top-0 flex-shrink-0",e),style:{height:cc},ref:o,children:[r.jsx(g5,{}),r.jsxs("div",{className:B("flex gap-2",u&&"pointer-events-none opacity-30"),children:[n?r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:"筛选",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",f&&"text-active_color"),onClick:k,children:r.jsx(H,{size:"middle",name:"IcFilter"})})}),r.jsx(Fe,{popup:"排序",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",bl.tableSortManager,h&&"text-active_color"),onClick:w,children:r.jsx(H,{size:"middle",name:"IcSort"})})}),r.jsx(EE,{})]}):r.jsxs(r.Fragment,{children:[r.jsx(x5,{}),r.jsxs("button",{ref:v,className:"text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",onClick:()=>j(),children:[r.jsx(H,{size:"middle",className:"mr-1",name:"IcMenuSettings"}),"视图设置"]}),a===m.CollectionViewType.CALENDAR&&d&&d.length>0&&r.jsxs("button",{className:"text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",onClick:T,children:[r.jsx(H,{size:"middle",className:"mr-1",name:"IcTitleDate"}),"无时间记录(",d.length,")"]}),a&&p&&![m.CollectionViewType.CALENDAR,m.CollectionViewType.FORM].includes(a)&&r.jsx(Fe,{popup:"分组",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:R=>E(R),children:r.jsx(H,{size:"middle",name:"IcGroup"})})}),a===m.CollectionViewType.BOARD&&g&&r.jsx(Fe,{popup:"子分组",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:R=>E(R,!0),children:r.jsx(H,{size:"middle",name:"IcSubGroup"})})}),a&&![m.CollectionViewType.FORM].includes(a)&&f&&r.jsx(Fe,{popup:"筛选",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:k,children:r.jsx(H,{size:"middle",name:"IcFilter"})})}),a&&![m.CollectionViewType.FORM].includes(a)&&h&&r.jsx(Fe,{popup:"排序",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color",bl.tableSortManager),onClick:w,children:r.jsx(H,{size:"middle",name:"IcSort"})})}),r.jsx(EE,{}),r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3"),onClick:C,children:r.jsx(H,{size:"middle",name:"IcMore"})}),!i&&r.jsx(Ame,{})]}),!s&&a&&![m.CollectionViewType.FORM].includes(a)&&D()]})]})},_5=()=>{const{viewId:e,collectionId:t}=Te(),n=me(),s=Gi({ignoreSorters:!0}),a=()=>{s({viewId:e,where:{first:!0},openInRight:!0})},o=F.useCallback(c=>{if(c==null){console.warn("showTemplates element == null");return}n.dropdown({popcorn:c,placement:"bottom",modalId:Xe.BITABLE_TEMPLATE_RECORDS,modifiers:[{name:"preventOverflow",options:{padding:16}}],content:()=>r.jsx(Nme,{})})},[n]),i=F.useRef(null),l=$c();return F.useEffect(()=>{let c=!1;const u=l.listen(d=>{var g;const f=Gc(d.search);if(f==null){c&&(c=!1,o(i.current));return}c=!1;const h=le().blocks[f];if(h==null)return;const p=le().blocks[t];p!=null&&h.isTemplate&&(g=p.templatePages)!=null&&g.includes(h.uuid)&&(c=!0)});return()=>u()},[t,l,o]),()=>r.jsxs("div",{className:"flex",ref:i,children:[r.jsx("button",{className:B("text-t2-medium flex items-center whitespace-nowrap rounded-l-l bg-active_color py-1 px-2 text-white hover:brightness-90"),onClick:a,children:"创建"}),r.jsx(Fe,{popup:"多维表模板",children:r.jsx("button",{className:B("flex px-1 items-center justify-center whitespace-nowrap rounded-r bg-active_color py-1 text-white hover:brightness-90 border-l border-l-0.1"),onClick:c=>o(c.currentTarget),children:r.jsx(H,{size:"middle",name:"IcArrowShow"})})})]})},x5=()=>{const{viewId:e,readonly:t,collectionId:n,embed:s}=Te(),a=ps(e),o=ZC(),{format:i,type:l}=a||{},c=JC();return t||l!==m.CollectionViewType.FORM?null:r.jsxs(r.Fragment,{children:[r.jsxs(Fe,{className:B("text-t2 animate-hover flex flex-shrink-0 items-center px-1",i!=null&&i.formShared?"text-active_color":"text-grey3"),onClick:u=>{o({popcorn:u.currentTarget,viewId:e,collectionId:n,placement:"bottom"})},children:[r.jsx(H,{name:"IcFormShare",size:"middle",className:"mr-1"}),i!=null&&i.formShared?"已开启分享":"分享收集表"]}),!s&&r.jsxs(Fe,{className:B("text-t2 animate-hover flex flex-shrink-0 items-center px-1 text-grey3"),onClick:()=>{c({viewId:e,collectionId:n})},children:[r.jsx(H,{name:"IcMenuItemHide",size:"middle",className:"mr-1"}),"预览"]})]})},Ame=()=>{const e=On(),{viewId:t,readonly:n,collectionId:s}=Te(),a=uh(),o=ih(),i=ps(t),{type:l}=i||{},c=u=>{ce.event("bitable_property_create",{from_scene:"form"});const d=o({collectionId:s,viewId:t}),f=jn(".next-space-page",e),h=jn(".next-space-page .block-content",e);d&&(Ye({$newTableProperty:{propertyId:d,from:qn.FORM_PROPERTIES}}),a(d,u.currentTarget,qn.FORM_PROPERTIES,"bottom-start",()=>{f.scrollTo({top:h.clientHeight,behavior:"smooth"})}))};return n||l!==m.CollectionViewType.FORM?null:r.jsx(je,{className:"flex-shrink-0",colorType:"active",onClick:c,children:"创建"})},Bme=({className:e})=>{var D;const{viewId:t,collectionId:n,managerReadonly:s,readonly:a,viewParentId:o,pageManager:i,viewType:l}=Te(),c=vm(t),u=ps(t),d=u==null?void 0:u.format.formIllegal,f=me(),h=m.CollectionViewType.FORM===(u==null?void 0:u.type),p=ae(({collectionViews:S})=>{var R,A;return(A=(R=S[t])==null?void 0:R.format.showTitle)!=null?A:!0}),{filterEnabled:g,sortersEnabled:_,groupEnabled:x,subGroupEnabled:y}=ae(S=>{var te,re,ne;const R=Zt(t,S.blocks,S.collectionViews);if(!R)return{};const{view:A,collection:L,groupBy:P,subGroupBy:M}=R,U=qg(A.format.filter,L.data.schema),W=((te=A.format.sorters)!=null?te:[]).filter(Y=>!Y.disable).length>0,z=$g(n,S),Q=z.includes((re=P==null?void 0:P.property)!=null?re:""),Z=z.includes((ne=M==null?void 0:M.property)!=null?ne:"");return{filterEnabled:U,sortersEnabled:W,groupEnabled:Q,subGroupEnabled:Z}},{equalityFn:Cn}),b=F.useRef((D=u==null?void 0:u.title)!=null?D:"");F.useEffect(()=>{var S;b.current=(S=u==null?void 0:u.title)!=null?S:""},[u==null?void 0:u.title]);const E=S=>{f.dropdown({popcorn:S.currentTarget,modalId:Xe.BITABLE_OPTION_MENU,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Tme,{})}})},w=F.useRef(null),k=F.useRef(t);k.current=t;const C=()=>{f.dropdown({popcorn:w.current||document.body,placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],closeBeforeCallBack(){var A;const S=b.current,R=(A=le().collectionViews)==null?void 0:A[k.current];S!==(R==null?void 0:R.title)&&Zc(k.current,{title:S})},content:({onCloseModal:S})=>r.jsx(QC,{viewTitleRef:b,onCloseModal:S})})},T=(S,R=!1)=>{f.dropdown({popcorn:Br(S.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Pc,{isSubGroup:R})}})},v=S=>{f.dropdown({popcorn:Br(S.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(ch,{})}})},I=S=>{f.dropdown({popcorn:Br(S.currentTarget),placement:"bottom",modifiers:[{name:"preventOverflow",options:{padding:16}}],content(){return r.jsx(Jg,{})}})},j=_5();return F.useEffect(()=>{if(!i)return;const S=i.current,R=S==null?void 0:S.closest("[data-block-id]"),A=S==null?void 0:S.closest(".next-space-page");if(!S||!R||!A)return;const L=()=>{const P=R.getBoundingClientRect(),M=A.getBoundingClientRect();if(P.top<M.top){let U=Math.abs(M.top-P.top);P.bottom-M.top<S.clientHeight&&(U-=S.clientHeight-(P.bottom-M.top)),S.style.transform=`translate3d(0,${Math.round(U)}px,0)`}else S.style.transform="none"};return A.addEventListener("scroll",L),window.addEventListener("resize",L),()=>{A.removeEventListener("scroll",L),window.removeEventListener("resize",L)}},[i]),r.jsxs("div",{className:B("group flex items-center justify-between flex-col",e),children:[r.jsxs("div",{className:"flex items-center justify-between w-full relative bg-white1 z-50",ref:i,children:[r.jsx(g5,{className:"print:hidden"}),r.jsxs("div",{className:B("flex opacity-0 transition-opacity group-hover:opacity-100 print:hidden overflow-auto",c!==void 0&&"opacity-100"),children:[r.jsx(S3,{uuid:o}),!s&&r.jsxs(r.Fragment,{children:[r.jsx(x5,{}),r.jsxs("button",{className:"text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",ref:w,onClick:C,children:[r.jsx(H,{size:"middle",name:"IcMenuSettings",className:"mr-1"}),"视图设置"]}),l&&![m.CollectionViewType.FORM].includes(l)&&g&&r.jsx(Fe,{popup:"筛选",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:I,children:r.jsx(H,{size:"middle",name:"IcFilter"})})}),l&&![m.CollectionViewType.FORM].includes(l)&&_&&r.jsx(Fe,{popup:"排序",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color",bl.tableSortManager),onClick:v,children:r.jsx(H,{size:"middle",name:"IcSort"})})}),l&&x&&![m.CollectionViewType.CALENDAR,m.CollectionViewType.FORM].includes(l)&&r.jsx(Fe,{popup:"分组",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:S=>T(S),children:r.jsx(H,{size:"middle",name:"IcGroup"})})}),l===m.CollectionViewType.BOARD&&y&&r.jsx(Fe,{popup:"子分组",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-active_color"),onClick:S=>T(S,!0),children:r.jsx(H,{size:"middle",name:"IcSubGroup"})})})]}),s&&r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:"筛选",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",g&&"text-active_color"),onClick:I,children:r.jsx(H,{size:"middle",name:"IcFilter"})})}),r.jsx(Fe,{popup:"排序",children:r.jsx("button",{className:B("text-t2 animate-hover flex items-center whitespace-nowrap rounded p-1 text-grey3",bl.tableSortManager,_&&"text-active_color"),onClick:v,children:r.jsx(H,{size:"middle",name:"IcSort"})})})]}),r.jsx(EE,{className:"mx-1"}),r.jsx(Fe,{popup:"以页面打开",children:r.jsx(I8,{to:ht()?`/share/${o}`:`/${o}`,className:"animate-hover flex p-1 items-center justify-center rounded text-grey3",children:r.jsx(H,{size:"middle",name:"IcMenuOpen"})})}),!d&&r.jsxs(r.Fragment,{children:[!s&&r.jsx(Fe,{popup:"菜单",children:r.jsx("button",{className:"animate-hover mx-1 flex p-1 items-center justify-center rounded text-grey3",onClick:E,children:r.jsx(H,{size:"middle",name:"IcMore"})})}),!a&&!h&&j()]})]})]}),p&&r.jsx("div",{className:"flex w-full py-1 border-t",children:r.jsx(Lme,{})})]})},Lme=F.memo(()=>{var b,E;const{collectionId:e,readonly:t,viewParentId:n}=Te(),s=ae(w=>{var k;return(k=w.blocks[e])==null?void 0:k.data.icon}),a=ae(w=>{var k;return(k=w.blocks[e])==null?void 0:k.data.segments}),o=!!((b=s==null?void 0:s.value)!=null&&b.trim()&&((E=s.type)!=null&&E.trim())),i=e!==n,l=Cs(),c=xn(),u=Pl(n),d=c(n,!0,kr),f=IC(n,"segments",Ic),h=jC(n,"segments",Ic),p=F.useRef(),g=F.useRef(NaN),_=Pr(e);F.useEffect(()=>{d.setReadonly(t||i)},[d,i,t]),F.useEffect(()=>(d[Jm]=p,d[Pg]=g,zR(u,d),()=>{Yk(u)}),[u,d]);const x=F.useRef(null);F.useEffect(()=>{const w=x.current;if(w)return w.addEventListener("inlinedinput",f),()=>{w.removeEventListener("inlinedinput",f)}},[f]),F.useEffect(()=>{t||FF(d,a)},[e,d,i,t,a]),F.useEffect(()=>{if(t)return;const w=d.onChange.subscribe(({previousContent:k,previousSelection:C})=>{const{content:T}=d;if(T===k)return;const v=Qs(T);g.current!==d.revision&&(p.current=v,_(v,[k,C]),g.current=d.revision)});return()=>{w.unsubscribe()}},[d,t,_]);const y=F.useMemo(()=>i||t?r.jsx(Pn,{className:"text-t1 inline whitespace-pre-wrap break-words align-middle font-semibold",plugins:kr,segments:a,placeholder:aa,interactable:!1}):r.jsx(HE,{className:B("animate-hover break-all rounded px-1.5 py-0.5 font-semibold focus:bg-black_006",gn({outline:"0 !important"})),emptyClassName:gn({selectors:{"&::after":{content:JSON.stringify(jh),pointerEvents:"none",color:"var(--grey4)",fontWeight:"bold"},"& > br":{display:"none"}}}),ref:x,model:d,spellCheck:!1,onKeyDown:w=>{be(["Enter","Shift+Enter"])(w)||h(w)}}),[h,d,i,t,a]);return i?r.jsxs(Fe,{popup:"点击访问原始多维表",className:B("text-h4 animate-hover relative mr-1 flex items-center rounded px-1.5 py-0.5 text-black whitespace-nowrap max-w-full overflow-auto"),onClick:w=>l(e,{forceOpenInRight:w.altKey,forceOpenNewTab:w.ctrlKey||w.metaKey}),children:[r.jsx(tn,{trigger:!1,iconSize:20,className:"mr-1",tooltipClassName:"flex-shrink-0",hasOverlay:o,blockId:e,offset:[100,0],defaultIcon:r.jsx(H,{name:"IcPagelink"})}),y]}):r.jsx("div",{"data-disable-select":!0,className:"relative mr-1 max-w-full",children:y})}),Pme=({className:e,embed:t})=>t?r.jsx(Bme,{className:e}):r.jsx(Rme,{className:e}),F5=F.memo(Pme);loe(F5);const Ome=(e,t)=>{const{blocks:n}=le();return[...ji(e,n,t)].some(o=>{var i,l;return[m.BlockType.FOLD_LIST,m.BlockType.TOGGLE_HEADER].includes((l=(i=n[o])==null?void 0:i.type)!=null?l:0)})},Mme=(e,t)=>{const{blocks:n}=le();return[...ji(e,n,t)].some(a=>{var o;return((o=n[a])==null?void 0:o.type)===m.BlockType.MARK})},y5=PE({interactive:!1,setInteractive:()=>{}}),Ume=F.memo(e=>{const{children:t,defaultWait:n}=e,[s,a]=F.useState(!1),{wait:o,mode:i}=F.useMemo(()=>s?{wait:n,mode:"throttle"}:{wait:500,mode:"debounce"},[n,s]);return r.jsx(y5.Provider,{value:{interactive:s,setInteractive:a},children:r.jsx(Hm,{wait:o,waitMode:i,children:t})})},kn),L4=e=>{const t=F.useRef((e==null?void 0:e.current)||null),n=v1(y5,s=>s.setInteractive);return F.useLayoutEffect(()=>{const s=t.current;if(!s)return;const a=()=>n(!0),o=()=>n(!1);return s.addEventListener("mouseenter",a),s.addEventListener("mouseleave",o),()=>{s.removeEventListener("mouseenter",a),s.removeEventListener("mouseleave",o)}},[]),{ref:t}},b5=({id:e,root:t})=>{const n=La(),s=Vn(),a=ae(({blocks:l})=>{var d,f;let c=e;const u=l[e];return(u==null?void 0:u.type)===m.BlockType.REFERENCE_COLLECTION&&(c=(f=(d=u.data.ref)==null?void 0:d.uuid)!=null?f:""),l[c]}),[o,i]=F.useState(s!==Tt.PAGE_HISTORY&&!(a!=null&&a.local));return F.useEffect(()=>{if(o){const l=a==null?void 0:a.subNodes.some(c=>!K.blocks[c]);a&&l?n(a.uuid,{force:!0}).finally(()=>{i(!1)}):i(!1)}},[]),a?o?r.jsx(os,{className:"h-[300px]"}):r.jsx(Vme,{collectionId:a.uuid,viewParent:e,root:t}):r.jsx(ln,{id:e,className:"my-2",children:r.jsx(Wx,{id:e})})},Vme=e=>{const{collectionId:t,viewParent:n}=e,s=F.useRef(null),a=F.useRef(null),o=gt(),i=Vn(),l=Dl(n,o),c=Ome(n,o),u=Ve(t,!1),d=Ve(n,!1),f=So(n),[h,p]=m9(n,!0),g=ps(h),_=Qg(),x=RL(h,d);h9(h),f9(t);const y=Os(),b=i===Tt.PAGE_HISTORY;F.useEffect(()=>{if(!u&&!h){const C=_(n,"表格",m.CollectionViewType.TABLE);C&&p(C)}},[_,p,u,h,n]);const E=F.useMemo(()=>{if(!(!t||!h||!g))return{viewId:h,collectionId:t,readonly:u,isLocked:f,managerReadonly:d,changeView:p,embed:!0,isColumnListChildren:l,isFoldListChildren:c,viewType:g.type,viewParentId:g.parentId,pageManager:a}},[p,t,l,c,d,u,g,h,f]),w=(g==null?void 0:g.type)&&![m.CollectionViewType.TIMELINE].includes(g.type);if(a_(s,{enable:w}),!E||!x)return null;const k=r.jsx(Ume,{children:r.jsx(qme,{viewParent:n})});return r.jsx(ln,{id:n,className:"my-2 line-default",children:r.jsx(_l.Provider,{value:E,children:r.jsxs(jl,{children:[r.jsx(F5,{embed:!0}),!b&&y?r.jsx("div",{className:"overflow-x-hidden",children:k}):k]})})})},qme=e=>{const{viewId:t,isFoldListChildren:n,isColumnListChildren:s}=Te(),{viewParent:a}=e,o=gt(),{ref:i}=L4(),l=sr();L4();const c=ps(t),u=w9(c==null?void 0:c.type),d=F.useRef($n(()=>In.emit("removeHoverMenu"),100,{leading:!0})),f=(c==null?void 0:c.type)&&![m.CollectionViewType.TIMELINE].includes(c.type),h=(c==null?void 0:c.type)===m.CollectionViewType.CALENDAR,p=Mme(a,o),g=ow(),_=_e(o,["data"],["pageFixedWidth","directoryMenu"]),{pageFixedWidth:x=!0,directoryMenu:y}=(_==null?void 0:_.data)||{};return a_(i,{enable:f}),r.jsx("div",{ref:i,onClick:b=>b.stopPropagation(),className:B("will-change-scroll",!h&&"overflow-x-auto overflow-y-hidden",!s&&!n&&!p&&!x&&"-mx-24 px-24 sm:-mx-12 sm:px-12",(y||g)&&"mr-0 pr-0"),onScroll:d.current,children:r.jsx(jR.Provider,{value:i,children:r.jsx(u,{embed:!0,scrollRef:l})})},t)},Hme=e=>{const t=F.useRef(null),n=sr(),{mindMapStyle:s,mindMapLineStyle:a}=o_(e.id),o=Ws();Mie(t);const i=tC();return nA(n.current,l=>{var d;const[c,u]=o.getSize();if(l.width&&l.height&&(o.setSize(l.width,l.height),c&&u)){const f=Math.floor(l.width-c),h=Math.floor(l.height-u);(d=n.current)==null||d.scrollBy({left:f,top:h})}},"all"),F.useEffect(()=>{o.setRootId(e.id),o.setDirection(s,!0),o.setLineStyle(a)},[o,a,s,e.id]),F.useEffect(()=>{var c;if(!n.current||!t.current)return;const l=(c=n.current)==null?void 0:c.getBoundingClientRect();l&&o.setSize(l.width,l.height),o.setContainer(t.current),o.setScroller(n.current)},[o,n]),Em(()=>{o.destroy()}),F.useEffect(()=>($9(e.id,o),()=>{G9(e.id)}),[o,e.id]),r.jsxs("div",{className:"group",children:[r.jsxs(Q9,{ref:t,id:e.id,children:[r.jsx(Z9,{}),r.jsx(B0,{id:e.id,level:0}),r.jsx(J9,{})]}),r.jsx("div",{className:"group-hover:opacity-100 opacity-0 transition-opacity",children:r.jsx(L9,{id:e.id})}),!i&&r.jsx(os,{className:"absolute left-0 top-0"})]})},$me=({id:e,root:t})=>{const n=_e(e,[]),s=F.useRef(null),a=Ve(e),o=Cr(),i=Rl(e),l=Un(),{onRenderSize:c,changeSize:u,containerWidth:d,containerRef:f,defaultWidth:h,defaultHeight:p,defaultBlockFullWidth:g}=zi({id:e,defaultWidth:Da,defaultHeight:330,root:t,defaultBlockFullWidth:!0}),_=dr(()=>new eA({getAllElement:()=>{var x;return(x=s.current)==null?void 0:x.querySelectorAll("[data-block-id]")},getCanvasPosition:(x,y,b)=>{if(s.current){const w=x.getState().scale*.01,k=s.current.querySelector(".node-drawer"),C=k==null?void 0:k.getBoundingClientRect();if(!C)return[y,b];const T=y-C.left,v=b-C.top;return[T/w,v/w]}return[y,b]},supportAppendChild:x=>z9(x),getLineColor:x=>ld(x)}));return F.useEffect(()=>{var y;const x=_.addScaleListener({onScaleChange:(b,E)=>{W9(b,E,!0)}});return _.zoom((y=K9(e,!0))!=null?y:80),x},[_,e]),n?r.jsx(ln,{id:e,className:"my-2 self-center w-full",blockRef:f,fullWidth:!t||o,horizontal:t,onDoubleClick:x=>{x.target instanceof Element&&x.target.closest("[data-ignore-double-click]")||l.push(i)},children:r.jsx(Wi,{className:"bg-grey9",resizeHeight:!0,readonly:a,doubleResize:t,defaultWidth:h||Da,defaultHeight:p,defaultBlockFullWidth:g,maxWidth:d,minHeight:250,resizeWidth:!1,onChange:u,onRenderSize:c,children:r.jsx(Hm,{wait:800,waitMode:"debounce",children:r.jsx(ik.Provider,{value:!0,children:r.jsx(bd.Provider,{value:!0,children:r.jsxs(io.Provider,{value:_,children:[r.jsx(au.Provider,{value:s,children:r.jsx("div",{className:"w-full next-space-page embed-mind-page h-full overflow-hidden line-default",ref:s,"data-mind-page-id":e,style:{cursor:"pointer",fontFamily:cw},children:r.jsx(Hme,{id:e},e)})}),r.jsx(Gme,{id:e})]})})})})})}):r.jsx($m,{})},Gme=({id:e})=>{const t=e_(),n=Rl(e);return r.jsxs("div",{className:"absolute flex top-2 text-white1 bg-black/75 right-3 z-10 transition-opacity group-hover:opacity-100 opacity-0 rounded h-[26px] items-center",children:[r.jsx(Fe,{popup:"新窗口查看",children:r.jsx("div",{className:B("cursor-pointer px-1 py-0.5 hover:animate-hover flex items-center"),onClick:()=>{window.open(n)},children:r.jsx(H,{name:"IcMenuOpenNew",size:"middle"})})}),!ht()&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-white/10 h-full w-px"}),r.jsx(Fe,{popup:"菜单",className:"flex items-center",children:r.jsx("div",{className:"cursor-pointer text-t4 px-1 py-0.5 hover:animate-hover",onClick:s=>{t({blockId:e,blockNode:s.currentTarget,placement:"left",offset:[0,5]})},children:r.jsx(H,{name:"IcMore",size:"middle"})})})]})]})},zme=({id:e,root:t})=>{const n=_e(e,["data","local"],["segments"]),s=ke(),a=Ve(e);if(F.useEffect(()=>{e&&pe(e,{local:!1},!0)},[e,s]),!n)return null;const o=de(n.data.segments);return r.jsx(ln,{id:e,horizontal:t,className:B("my-1",{"animate-hover":!a}),children:r.jsx(iC,{readonly:a,content:o,onChange:i=>{const l=mt(i);s(()=>{pe(e,{data:{segments:l}})})},defaultOpenPanel:!!n.local})})},E5=e=>{const t=ke();return F.useCallback(n=>{t(()=>{pe(e,{data:{viewMode:n}})})},[e,t])},A3=e=>{var M,U;const{uuid:t,isFile:n,readonly:s,ownerBlockId:a}=e,o=_e(t,["data"],["ref","viewMode"]),i=Cr(),l=_e(a,["data"],["ref","viewMode"]),c=_e(t,["data"],["segments"]),u=!!((M=o==null?void 0:o.data.ref)!=null&&M.uuid&&!c),d=hh(),f=bL({uuid:t}),h=sf({uuid:t}),p=XF(),g=((U=l||o)==null?void 0:U.data.viewMode)||Vs.normal,_=Md(o==null?void 0:o.spaceId),x=ht(),y=x?`${_}/share/${t}`:`${_}/${t}`,b=de(c==null?void 0:c.data.segments),E=iF(ac(b).extName),w=F.useRef(null),{url:k}=Vi(t,{isImage:!0}),C=ah(),{role:T,allowDuplicate:v,illegal:I}=it(t),j=tf(),D=F.useCallback(V=>{const W=V.currentTarget.getBoundingClientRect();n?h({getBoundingClientRect:()=>W}):f({getBoundingClientRect:()=>W})},[n,h,f]),S=F.useCallback(()=>p(t),[p,t]),R=n&&!u&&(s?v:!0),A=V=>{if(I&&x){ye.error(bj);return}E==="pdf"?window.open(`/${x?"share/":"preview/"}${V}`):E==="image"?C({uuid:V,src:k}):d(V,a)},L=n?()=>A(t):void 0;let P={splitLine:[]};return I||(s?u||(P={openLink:y,onOpen:L,onDownLoad:R?S:void 0,splitLine:[],readonly:s}):P={hiddenPreview:n&&!E,onDownLoad:R?S:void 0,viewMode:g,onReplace:!a&&n?D:void 0,openLink:y,readonly:s,onOpen:L},!a&&Fs(T,m.PermissionRole.COMMENTER)&&(o==null?void 0:o.type)!==m.BlockType.FOLDER&&Object.assign(P,{onAddComment:()=>{j({blockId:t})}})),{isMobileSize:i,illegal:I,isFail:u,toolBarProps:P,openFilePreview:A,onReplace:D,downLoad:S,domain:_,openLink:y,blockRef:w,hasOverlay:!!a}},Wme=e=>{const{value:t=Vs.normal,onChange:n,small:s,hiddenPreview:a}=e,o=(c,u)=>{c.preventDefault(),t!==u&&(n==null||n(u))},i=a?[Vs.normal,Vs.card]:[Vs.normal,Vs.card,Vs.preview],l={[Vs.normal]:"标题视图",[Vs.card]:"卡片视图",[Vs.preview]:"预览视图"};return r.jsx("div",{className:"flex items-center",children:i.map(c=>r.jsx(Js,{popup:l[c],size:s?20:30,className:B("rounded animate-hover",t===c&&"bg-black_006",s&&"mx-0.5"),onClick:u=>o(u,c),children:r.jsx(H,{name:`IcMenuView${II(c)}`,size:"middle"})},c))})},Lp=F.memo(e=>{const{onChangeViewModel:t,onReplace:n,onDownLoad:s,onAddComment:a,openLink:o,splitLine:i=[],className:l,viewMode:c,hiddenOpen:u,readonly:d,onOpen:f,small:h,hiddenPreview:p}=e,g=h?20:30;let _=r.jsx(r.Fragment,{});o&&!u&&(f?_=r.jsx(Js,{popup:"全屏查看",size:g,className:"rounded animate-hover",onClick:f,children:r.jsx(H,{name:"IcMenuOpen",size:"middle"})}):_=r.jsx(pc,{to:o,children:r.jsx(Js,{popup:"全屏查看",size:g,className:"rounded animate-hover",children:r.jsx(H,{name:"IcMenuOpen",size:"middle"})})}));const x=r.jsx(Js,{popup:"下载",size:g,onClick:s,className:Yt("rounded animate-hover",h&&"ml-2.5"),children:r.jsx(H,{name:"IcMenuDownload",size:"middle"})});return d&&o&&!u?r.jsxs("span",{className:Yt("flex items-center h-full cursor-default",l),children:[s&&r.jsx(r.Fragment,{children:x}),_]}):d?null:r.jsxs("span",{className:Yt("flex items-center h-full cursor-default",l),children:[t&&r.jsx(Wme,{small:h,hiddenPreview:p,value:c,onChange:t}),a&&r.jsxs(r.Fragment,{children:[i.includes(1)&&r.jsx("div",{className:Yt("h-4 w-px bg-grey4 mx-4",h&&"mx-2.5")}),r.jsx(Js,{popup:"添加评论",size:g,onClick:a,className:"rounded animate-hover",children:r.jsx(H,{name:"IcMenuComment",size:"middle"})})]}),i.includes(1)&&r.jsx("div",{className:Yt("h-4 w-px bg-grey4 mx-4",h&&"mx-2.5")}),n&&r.jsx(Js,{popup:"替换",size:g,onClick:n,className:"rounded animate-hover",children:r.jsx(H,{name:"IcMenuReplace",size:"middle"})}),s&&x,i.includes(2)&&(n||s)&&!u&&r.jsx("div",{className:Yt("h-4 w-px bg-grey4 mx-4",h&&"mx-2.5")}),_]})}),wE=F.memo(e=>{const{root:t,uuid:n,title:s,context:a,className:o,isFile:i,viewModelToolBarData:l,iconName:c,ownerBlockId:u}=e,{isFail:d,toolBarProps:f,domain:h,openFilePreview:p,blockRef:g,isMobileSize:_,hasOverlay:x}=A3(e),y=Cs(),b=r.jsxs(r.Fragment,{children:[r.jsx(tn,{hasOverlay:x,blockId:n,trigger:!i,iconSize:40,className:"mr-1",defaultIcon:r.jsx(H,{size:"xxxlarge",name:c})}),r.jsxs("div",{className:"flex flex-col justify-start max-full",children:[s&&r.jsx("div",{className:"w-full text-t1",children:s}),a&&r.jsx("div",{className:"text-t4 text-grey3",children:a})]})]});return r.jsxs(ln,{blockRef:g,id:u!=null?u:n,horizontal:t,className:B("my-1 px-0.5",d&&"opacity-50",o),"data-draggable":!0,children:[r.jsxs("div",{className:"h-[90px] border border-black/10 rounded !cursor-default animate-hover-black3 group flex items-center justify-between pr-3.5 overflow-x-auto",children:[i?r.jsx("div",{className:"preview-file flex items-center pl-2.5  h-full text-ellipsis py-3 flex-1 cursor-pointer overflow-hidden w-full",onClick:()=>p(n),children:b}):r.jsx("div",{onClick:E=>{y(n,{forceOpenInRight:E.altKey,domain:h,forceOpenNewTab:E.ctrlKey||E.metaKey})},className:"pl-2.5 flex w-full text-ellipsis py-3 flex-1",children:b}),r.jsxs(r.Fragment,{children:[r.jsx(Lp,{className:B(_?"hidden":"hidden group-hover:flex"),splitLine:[1,2],...f,...l}),r.jsx(Lp,{className:B(_?"flex":"flex group-hover:hidden"),...l,viewMode:f.viewMode,onDownLoad:f.onDownLoad,openLink:f.openLink,onOpen:f.onOpen})]})]}),r.jsx(wo,{blockId:n})]})}),Pp=e=>{const{root:t,uuid:n,title:s,context:a,iconName:o,isFile:i,viewModelToolBarData:l,ownerBlockId:c}=e,{illegal:u,isFail:d,toolBarProps:f,domain:h,openFilePreview:p,blockRef:g,isMobileSize:_,hasOverlay:x}=A3(e),y=Cs(),b=r.jsxs(r.Fragment,{children:[r.jsx(tn,{hasOverlay:x,trigger:!i,className:"mr-1 self-center",blockId:n,iconSize:18,defaultIcon:r.jsx(H,{size:"middle",name:o})}),r.jsxs("div",{className:"flex max-w-full",children:[r.jsxs("div",{className:"relative w-full text-t1-medium text-ellipsis",children:[s,r.jsx("span",{className:"absolute bottom-px left-0 h-px bg-grey5 w-full"})]}),r.jsx("span",{className:"ml-2 text-t4 self-center mt-1 text-grey3 flex-shrink-0",children:a})]})]});return r.jsxs(ln,{blockRef:g,id:c!=null?c:n,horizontal:t,className:Yt("my-px",d&&"opacity-50 text-grey3",u&&"opacity-30"),"data-draggable":!0,children:[r.jsxs("div",{className:"pl-0.5 line-default animate-hover group leading-9 flex justify-between items-center h-9 overflow-x-auto",children:[i?pt.print?r.jsx("a",{href:`${Sn()}/preview/${n}`,className:"pr-10 cursor-pointer text-ellipsis flex w-full",children:b}):r.jsx("div",{className:"preview-file  pr-10 cursor-pointer text-ellipsis flex w-full",onClick:()=>p(n),children:b}):r.jsx("div",{onClick:E=>{y(n,{forceOpenInRight:E.altKey,domain:h,forceOpenNewTab:E.ctrlKey||E.metaKey})},className:"pr-10 cursor-pointer text-ellipsis flex w-full",children:b}),!_&&r.jsx(Lp,{splitLine:[1],...f,...l,className:"hidden group-hover:flex"})]}),r.jsx(wo,{blockId:n})]})},w5=e=>{const{root:t,title:n,context:s,iconName:a,children:o,readonly:i,viewModelToolBarData:l,className:c,smallHeder:u,isFile:d,uuid:f,ownerBlockId:h}=e,p=_e(f,["data"]),g=iF(up(p==null?void 0:p.data.segments).extName),_=g==="video",x=g==="image",y=g==="pdf",{isFail:b,toolBarProps:E,hasOverlay:w}=A3(e),{renderSize:k,onRenderSize:C,widthBreakPoints:T,changeSize:v,containerWidth:I,containerRef:j,isDisable:D,defaultHeight:S,defaultWidth:R,pageContentWidth:A}=zi({root:t,id:f,defaultWidth:500,defaultHeight:140}),L=UC({width:R,maxWidth:A,height:S});return r.jsxs(ln,{blockRef:j,id:h!=null?h:f,horizontal:t,className:B("my-1",b&&"opacity-50",c),children:[r.jsxs("div",{className:B("rounded border border-black/10 !cursor-default flex flex-col max-w-full group",D&&"pointer-events-none"),children:[r.jsxs("div",{className:B("h-[60px] flex justify-between pl-2 py-3 pr-3.5 items-center",o&&"border-b border-black/10",u&&"py-2"),children:[r.jsxs("div",{className:"flex text-ellipsis",children:[r.jsx(tn,{hasOverlay:w,trigger:!d,iconSize:20,className:"mr-2 mt-0.5 flex flex-shrink-0 w-6 h-6",blockId:f,defaultIcon:r.jsx(H,{size:"middle",name:a})}),r.jsxs("div",{className:B("flex flex-col",u&&"flex-row items-center"),children:[r.jsx("div",{className:"mr-2 text-t1",children:n}),r.jsx("div",{className:"text-t4 text-grey3",children:s})]})]}),r.jsx(Lp,{className:"hidden group-hover:flex",small:u,splitLine:[1,2],...E,...l}),r.jsx(Lp,{className:"flex group-hover:hidden",small:u,...l,...d?{onReplace:E.onReplace,onDownLoad:E.onDownLoad}:{openLink:E.openLink}})]}),r.jsx(Wi,{widthBreakPoints:T,resizeHeight:!_,readonly:i,fullHeight:_,defaultHeight:x?L.width:S,resizeWidth:!1,defaultBlockFullWidth:!0,maxWidth:I,defaultWidth:I,onChange:v,minHeight:130,childrenClassName:"flex flex-col overflow-hidden",onRenderSize:C,className:B(y&&"pb-3"),children:o})]}),r.jsx(wo,{blockId:f,style:{width:k.width}})]})},Kme=e=>{var b;const{fileName:t,progress:n,showNotFound:s,defaultOpenUploadPanel:a,uuid:o,readonly:i,ownerBlockId:l,root:c,size:u}=e,d=Px(),f=_e(o,["data"],["ossName","link"]),h=n!==-1&&n!==100,p=Pi(o),g=F.useRef(),_=gt(),x=F.useMemo(()=>Dl(o,_),[_,o]),{extName:y}=sn(t);return h?r.jsxs("div",{className:"flex items-center w-full h-12.5 py-2.5 pl-3 rounded bg-grey8 cursor-pointer my-1 mx-[2px]",children:[r.jsx(H,{size:"large",name:"IcUploadFile",className:"text-grey4"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"ml-2 text-t2 text-grey3",children:p==null?void 0:p.name}),r.jsxs("span",{className:"ml-2 text-t4 text-grey3",children:[n,"%"]})]})]}):!(f!=null&&f.data.ossName)&&!(f!=null&&f.data.link)?r.jsx(ln,{id:l||o,horizontal:c,className:"my-1",children:r.jsx(qne,{title:(p==null?void 0:p.status)===Yn.failure?`文件${(b=p==null?void 0:p.name)!=null?b:""}上传失败`:void 0,uuid:o,ownerBlockId:l,readonly:i,defaultOpenPanel:a})}):r.jsx(Fe,{interactive:!d,lazyLoad:!0,onShow:E=>{g.current=E},theme:"none",popupClass:"next-modal",className:"w-full",offset:[0,8],placement:x?"left":"top-start",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(Hk,{ownerBlockId:l,uuid:o,onCloseOutsideModel:()=>{var E;(E=g.current)==null||E.hide()}}),children:r.jsx(Pp,{ownerBlockId:l,root:c,uuid:o,readonly:i,isFile:!0,iconName:pa(y),title:s?"文件已被删除":r.jsx(Bl,{fileName:t}),context:s?"0 KB":es(u)})})},Yme=e=>r.jsx(uu,{defaultOpenPanel:e.defaultOpenPanel,readonly:e.readonly,iconProp:{name:"IcUploadAudio"},text:"添加音频",onClick:e.onClick,className:e.readonly?"cursor-default":"cursor-pointer"}),Xme=e=>{var u;const{id:t,ownerBlockId:n}=e,s=n!=null?n:t,a=Ve(s),o=e.progress!==-1&&e.progress!==100,[i,l]=F.useState(""),c=sf({uuid:s});return!e.url&&!o?r.jsx(ln,{id:s,horizontal:e.root,className:"my-1",children:r.jsx(Yme,{readonly:a,defaultOpenPanel:e.defaultOpenPanel,onClick:d=>{c(d.currentTarget,"bottom")}})}):(u=e.url)!=null&&u.startsWith("blob")?null:r.jsxs(ln,{id:s,horizontal:e.root,children:[r.jsxs("div",{"data-column-item-min-width":"230px",className:B("flex flex-col my-2.5 justify-center group",n&&"pl-1 border-dashed border-grey5 border-l-[2px]"),children:[r.jsx(Fe,{equalWidth:!0,popupClass:"whitespace-pre-wrap w-full break-words",placement:"top",popup:r.jsx(Qme,{id:t}),offset:[-1,8],children:r.jsx(AI,{preload:"none",autoPlayAfterSrcChange:!1,autoPlay:!1,src:e.url,onError:d=>{const{error:f}=d.target;if(!(!f||!e.url))switch(f.code){case MediaError.MEDIA_ERR_DECODE:l("视频解码时发生错误");break;case MediaError.MEDIA_ERR_NETWORK:l("加载失败");break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:l("浏览器不支持播放该音频源");break}},onPlayError:d=>{i?ye.warning(i):ye.warning(d.message)}})}),o&&r.jsxs("div",{className:"absolute flex flex-row rounded-sm bg-black opacity-75 right-2",children:[r.jsx(F3,{}),r.jsxs("div",{className:"text-white1 text-t4",children:[e.progress,"%"]})]}),e.externalLink&&r.jsx("div",{className:"absolute flex items-center top-3 right-3 bg-black/75 group-hover:opacity-100 opacity-0 rounded-sm",children:r.jsx(H,{size:"middle",className:"text-white1",name:"IcUploadWeb"})})]}),r.jsx(wo,{blockId:s})]})},Qme=e=>{const t=_e(e.id,["data"],["segments"]);return r.jsx(r.Fragment,{children:de(t==null?void 0:t.data.segments)})},k5=({id:e,root:t,ownerBlockId:n})=>{var l;const s=_e(e,["data","local"],["link"]),a=Pi(e),{url:o}=Vi(e);return pt.print?r.jsx(D3,{uuid:e}):r.jsx(Xme,{ownerBlockId:n,externalLink:!!(s!=null&&s.data.link),root:t,id:e,progress:(l=a==null?void 0:a.progress)!=null?l:-1,url:o,defaultOpenPanel:!!(s!=null&&s.local)})},Jme=e=>r.jsx(uu,{defaultOpenPanel:e.defaultOpenPanel,readonly:e.readonly,iconProp:{name:"IcUploadVideo"},text:"添加视频",onClick:e.onClick,className:e.readonly?"cursor-default":"cursor-pointer"}),Zme=96,ehe=480,the=e=>{var v,I;const{id:t,ownerBlockId:n,url:s,progress:a,root:o,defaultOpenPanel:i}=e,l=n!=null?n:t,c=_e(t,["data"],["format","localUrl","size","link"]),u=Ve(l),d=a!==-1&&a!==100,f=Cr(),h=sf({uuid:l}),{renderSize:p,onRenderSize:g,changeSize:_,containerWidth:x,containerRef:y,isDisable:b,defaultBlockFullWidth:E,defaultWidth:w,defaultHeight:k,widthBreakPoints:C}=zi({id:l,root:o,defaultHeight:(I=(v=c==null?void 0:c.data.format)==null?void 0:v.height)!=null?I:ehe,fullPageContentWidth:!0}),T=()=>{c!=null&&c.data.link&&on(c.data.link)};return!s&&!d?r.jsx(ln,{id:l,horizontal:o,className:"my-1",children:r.jsx(Jme,{readonly:u,defaultOpenPanel:i,onClick:j=>{h(j.currentTarget,"bottom")}})}):r.jsx(ln,{blockRef:y,id:l,horizontal:o,fullWidth:f,className:B("my-2.5 group",o&&"self-center"),children:r.jsxs(Wi,{fullHeight:!0,resizeWidth:!0,widthBreakPoints:C,doubleResize:o,readonly:u||b,defaultBlockFullWidth:E,minWidth:Zme,maxWidth:x||void 0,defaultWidth:w||Da,defaultHeight:k,onChange:_,onRenderSize:g,outerLayoutClassName:B(n&&"pl-1 border-dashed border-grey5 border-l-[2px]"),className:B("max-w-full",d&&"bg-black",b&&"pointer-events-none"),customFooter:r.jsx(wo,{blockId:l,style:{width:p.width}}),children:[s&&r.jsx(Vk,{videoUrl:s,size:c==null?void 0:c.data.size,style:{width:x,cursor:"pointer",opacity:s!=null&&s.startsWith("blob")?"0.5":1},options:{fluid:!0,controls:s.startsWith("https"),poster:s.startsWith("https")?`${s}&x-oss-process=video/snapshot,t_10000,f_jpg,w_800`:""}}),d&&r.jsxs("div",{className:"absolute flex items-center px-1.5 right-2.5 top-2.5 rounded-sm bg-black1/75",children:[r.jsx(F3,{}),r.jsxs("div",{className:"text-white text-t4",children:[a,"%"]})]}),(c==null?void 0:c.data.link)&&r.jsx("div",{className:"z-10 absolute flex items-center top-2.5 right-2.5 bg-black/75 group-hover:opacity-100 opacity-0 rounded-sm animate-click",onClick:T,children:r.jsx(H,{size:"middle",className:"text-white",name:"IcUploadWeb"})})]})})},C5=({id:e,root:t,ownerBlockId:n})=>{var c,u;const s=_e(e,["data","local"],["extName"]),a=_e(n,["local"]),o=Pi(e),{url:i}=Vi(e);return pt.print?r.jsx(D3,{uuid:e}):r.jsx(the,{id:e,ownerBlockId:n,extName:s==null?void 0:s.data.extName,root:t,progress:(c=o==null?void 0:o.progress)!=null?c:-1,url:i,defaultOpenPanel:!!((u=a||s)!=null&&u.local)})},B3=F.memo(e=>{var l;const{id:t,root:n,ownerBlockId:s}=e,a=_e(t,["data","local"],["display"]),o=_e(s,["data","local"],["display"]),{illegal:i}=it(s!=null?s:t);if(F.useEffect(()=>{pe(t,{local:!1},!0)},[t]),(o!=null&&o.data.display||a!=null&&a.data.display)&&!i){let c=()=>null;switch((l=o!=null?o:a)==null?void 0:l.data.display){case"image":{c=VC;break}case"video":{c=C5;break}case"audio":{c=k5;break}case"file":return r.jsx(P4,{...e})}return r.jsx(c,{id:t,root:n,children:e.children})}else if(i)return r.jsx(Pp,{uuid:t,root:n,ownerBlockId:s,isFile:!0,title:rs,iconName:pa("")});return r.jsx(P4,{...e})}),P4=({id:e,root:t,ownerBlockId:n})=>{var _,x;const s=_e(e,["data","local"],["segments","viewMode","ossName","size","localUrl","showEmptyCaption","link"]),a=_e(n,["data"],["viewMode"]),o=Pi(e),i=Ve(n!=null?n:e),l=de(s==null?void 0:s.data.segments),c=E5(n||e),u=Px(),d=!s,f=(o==null?void 0:o.status)===Yn.uploading,h=(_=a||s)==null?void 0:_.data.viewMode;let p=r.jsx(r.Fragment,{}),g="default";return!s||!s.data.ossName&&!s.data.link||f||h===Vs.normal||!h?(p=r.jsx(Kme,{root:t,ownerBlockId:n,readonly:i,progress:(x=o==null?void 0:o.progress)!=null?x:-1,fileName:l,size:s==null?void 0:s.data.size,showNotFound:d,defaultOpenUploadPanel:!!(s!=null&&s.local),uuid:e}),!(s!=null&&s.data.ossName)&&!(s!=null&&s.data.link)&&(g=void 0)):h===Vs.card?(p=r.jsx(nhe,{root:t,uuid:e,onReplace:()=>{},ownerBlockId:n,isFile:!0,showNotFound:d,readonly:i,title:l||Ot(m.BlockType.FILE),context:es(s==null?void 0:s.data.size),iconName:pa(sn(l).extName)}),g="small"):h===Vs.preview&&(p=r.jsx(she,{root:t,uuid:e,onReplace:()=>{},ownerBlockId:n,isFile:!0,showNotFound:d,readonly:i,title:l||Ot(m.BlockType.FILE),context:es(s==null?void 0:s.data.size),iconName:pa(sn(l).extName)}),g="large"),r.jsx(Fe,{theme:"none",placement:"top-end",interactive:!u,interactiveDebounce:0,animation:"shift-away",popup:g&&!i&&!ht()?r.jsx(E3,{showType:g,onClick:y=>{switch(y){case"default":c("normal");break;case"small":c("card");break;case"large":c("preview");break}}}):void 0,children:p})},nhe=e=>{const{root:t,uuid:n,ownerBlockId:s,showNotFound:a,readonly:o}=e,i=_e(n,["data"],["segments","size"]),l=de(i==null?void 0:i.data.segments),c=F.useRef(),u=gt(),d=F.useMemo(()=>Dl(n,u),[u,n]);return a?r.jsx(wE,{root:t,uuid:n,onReplace:()=>{},ownerBlockId:s,isFile:!0,title:"文件已被删除",context:"0 KB",iconName:pa(),readonly:o}):r.jsx(Fe,{lazyLoad:!0,onShow:f=>{c.current=f},theme:"none",popupClass:"next-modal",interactive:!0,className:"w-full",offset:[0,8],placement:d?"left":"top-start",maxWidth:1e4,delay:[500,50],animation:"shift-away",popperOptions:{modifiers:[{name:"flip",options:{fallbackPlacements:d?["left","right","bottom","bottom-start","top-start"]:["top-start","bottom-start","left","right"]}}]},popup:r.jsx(Hk,{ownerBlockId:s,uuid:n,onCloseOutsideModel:()=>{var f;(f=c.current)==null||f.hide()}}),children:r.jsx(wE,{root:t,uuid:n,onReplace:()=>{},ownerBlockId:s,isFile:!0,readonly:o,title:l||Ot(m.BlockType.FILE),context:es(i==null?void 0:i.data.size),iconName:pa(sn(l).extName)})})},she=e=>{const{uuid:t,ownerBlockId:n,root:s,readonly:a,title:o}=e,i=_e(t,["data"],["size"]),l=Dd(),{extName:c}=sn(o),u=iF(c),{url:d,loading:f}=Vi(t),h=F.useMemo(()=>bo(d,c),[c,d]);return f?r.jsx(os,{}):r.jsx(w5,{uuid:t,root:s,ownerBlockId:n,isFile:!0,smallHeder:!0,readonly:a,className:"group",title:d?o||Ot(m.BlockType.FILE):"文件已被删除",context:d?es(i==null?void 0:i.data.size):"0 KB",iconName:pa(c),viewModelToolBarData:{dark:!0,fixed:!0},children:d&&u?r.jsx("div",{className:B("flex justify-center h-full max-h-full w-full",{"pointer-events-none":l}),children:r.jsx(qk,{uuid:t,downloadUrl:h,useSimpleImg:!0,embed:!0,style:{width:"100%"}})}):r.jsxs("div",{className:"flex flex-col items-center justify-center h-full bg-grey8 text-grey4 text-t2",children:[r.jsx(H,{name:"IcUploadImageFaild",size:"large",className:"mb-2"}),r.jsx("div",{children:d?"文件不支持预览":"文件被删除"})]})})},rhe=({id:e,root:t,children:n})=>{const{expand:s,toggle:a}=$C(e),o=_e(e,["subNodes"]),i=fr(),l=ke();if(!o)return null;const c=d=>{d.stopPropagation(),l(()=>{const f=Qe({},{parentId:o.uuid,after:o.uuid});i(f,0)})},u=pt.print||s;return r.jsxs(ln,{id:e,className:"my-px",horizontal:t,children:[r.jsxs("div",{className:"block-has-icon-container ignore-focus-click flex-1 overflow-hidden",children:[r.jsx(t_,{"data-no-cancel-selected":!0,className:"block-before-icon-mt",children:r.jsx("span",{className:"flex animate-hover",children:r.jsx(H,{size:"large",name:"IcToggleBlack",onClick:a,className:B("transition duration-150 cursor-pointer",{"rotate-90":u,"opacity-30":o.subNodes.length===0})})})}),r.jsx(Mo,{className:"self-start mr-4 flex-1 w-0",uuid:e,placeholder:"折叠列表"})]}),u&&r.jsx(Ni,{blockId:e,children:o.subNodes.length?n:ht()?null:r.jsx("div",{className:"flex items-center w-full animate-hover cursor-pointer h-9 text-t2 p-1 my-px text-grey3 print:hidden",onClick:c,children:"内容为空，点击编辑"})})]})},ahe=()=>F.useCallback(async e=>{const t=await Ce.editor.getDoc.raw(e);if(t.code!==200)return t.code;const{blocks:{[e]:n,...s}}=t.data;ee(Gn.update({blocks:s}))},[]),kE=({id:e,root:t,ownerBlockId:n})=>{var k,C;const s=_e(e,["subNodes","data"],["viewMode"]),a=_e(n,["data"],["ref","viewMode"]),o=Ve(e),i=!!((k=a==null?void 0:a.data.ref)!=null&&k.uuid&&!s),l=wF(e),c=(C=a==null?void 0:a.data.viewMode)!=null?C:s==null?void 0:s.data.viewMode,{illegal:u}=it(e),d=Vn(),f=iS(e),h=(s==null?void 0:s.subNodes.length)||0,p=E5(n||e),g=F.useRef(),_=gt(),x=F.useMemo(()=>Dl(e,_),[_,e]),y=Px();if(u)return r.jsx(Pp,{uuid:e,root:t,ownerBlockId:n,isFile:!0,title:rs,iconName:h?"MIcFolder":"MIcFolderBlank"});if(f>0&&l.folder.length+l.files.length===0)return r.jsx(Pp,{ownerBlockId:n,root:t,uuid:e,readonly:o,iconName:h?"MIcFolder":"MIcFolderBlank",title:`文件夹上传中 还剩 ${f} 个`,context:`${h} 项内容`});const b={showNotFound:i,uuid:e,root:!!t,ownerBlockId:n,fileCount:h,readonly:o};let E=r.jsx(Fe,{lazyLoad:!0,interactive:!y,onShow:T=>{g.current=T},theme:"none",popupClass:"next-modal",offset:[0,5],placement:x?"left":"top-start",className:"w-full",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(wl,{pageId:e,isLink:!!n,onCloseOutsideModel:()=>{var T;(T=g.current)==null||T.hide()}}),children:r.jsx(ohe,{...b})}),w="default";return c===Vs.card&&(E=r.jsx(Fe,{lazyLoad:!0,onShow:T=>{g.current=T},theme:"none",interactive:!0,popupClass:"next-modal",offset:[0,5],placement:x?"left":"top-start",className:"w-full",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(wl,{pageId:e,isLink:!!n,onCloseOutsideModel:()=>{var T;(T=g.current)==null||T.hide()}}),children:r.jsx(O4,{...b})}),w="small"),c===Vs.preview&&(d===Tt.PAGE_HISTORY&&(E=r.jsx(O4,{...b}),w="small"),E=r.jsx(lhe,{...b}),w="large"),r.jsx(Fe,{theme:"none",placement:"top-end",interactive:!0,animation:"shift-away",interactiveDebounce:0,popup:!o&&!ht()&&r.jsx(E3,{showType:w,onClick:T=>{switch(T){case"default":p("normal");break;case"small":p("card");break;case"large":p("preview");break}}}),children:E})},ohe=e=>{const{uuid:t,root:n,ownerBlockId:s,showNotFound:a,readonly:o,fileCount:i}=e,l=_e(t,["data","subNodes"],["segments"]),c=de(l==null?void 0:l.data.segments)||Ot(m.BlockType.FOLDER);return r.jsx(Pp,{ownerBlockId:s,root:n,uuid:t,readonly:o,iconName:i?"MIcFolder":"MIcFolderBlank",title:a?"文件夹已被删除":c,context:`${i} 项内容`})},O4=e=>{const{uuid:t,ownerBlockId:n,root:s,fileCount:a,showNotFound:o,readonly:i}=e,l=_e(t,["data"],["segments"]),c=()=>{},u=de(l==null?void 0:l.data.segments)||Ot(m.BlockType.FOLDER);return r.jsx(wE,{root:s,uuid:t,onReplace:c,ownerBlockId:n,readonly:i,title:o?"文件夹已被删除":u,context:`${a} 项内容`,iconName:a?"MIcFolder":"MIcFolderBlank"})},M4=e=>{const{block:t,readonly:n,clickFolder:s}=e,a=t.type===m.BlockType.FILE,o=de(t.data.segments)||Ot(t.type),i=sn(o),l=hh(),c=rf(),u=F.useRef(null),d=j8(u.current),f=ah(),{illegal:h}=it(t.uuid),p=F.useCallback(()=>{if(a)if(Hr.pdf.test(i.extName))window.open(`/${ht()?"share/":"preview/"}${t.uuid}`);else{if(ew(i.extName)){f({uuid:t.uuid});return}l(t.uuid)}else s==null||s(t.uuid,o)},[t.uuid,s,i.extName,o,a,l,f]),g=F.useCallback(_=>{_.preventDefault(),_.stopPropagation(),c([t.uuid])},[t.uuid,c]);return r.jsxs("div",{ref:u,className:"flex items-center justify-between px-1 cursor-pointer h-11 text-t2 animate-hover-black3",onClick:p,children:[r.jsxs("div",{className:"flex w-full items-center",children:[a?r.jsx(H,{name:pa(i.extName),className:"ml-1 mr-2",size:"middle"}):r.jsx(tn,{iconSize:20,blockId:t.uuid,className:"mr-2",defaultIcon:r.jsx(as,{uuid:t.uuid,size:"middle"})}),r.jsx(Fe,{placement:"top-start",arrow:!0,className:"w-full pr-9",popup:o,children:a?r.jsx(Bl,{fileName:o}):r.jsx("span",{children:o})})]}),r.jsx("div",{className:"flex",children:!n&&!h&&r.jsx(H,{name:"IcMenuDownload",onClick:g,className:B("transition-opacity rounded-sm animate-hover",d?"opacity-100":"opacity-0"),size:"middle"})})]})},ihe=e=>{const{navs:t,clickFolder:n}=e,s=me(),a=(l,c)=>r.jsxs("div",{className:"flex items-center",children:[c!==0&&r.jsx("div",{className:"px-0.5 text-grey4",children:"/"}),r.jsx(Fe,{popup:l.title||Ot(m.BlockType.FOLDER),onClick:()=>n(l.uuid,l.title),className:B("block rounded-sm animate-hover text-ellipsis max-w-[200px]",c!==0?"px-2":"px-0.5"),children:l.title||Ot(m.BlockType.FOLDER)})]},l.uuid),o=da(t).splice(1,t.length-2),i=l=>{s.dropdown({popcorn:l.currentTarget,placement:"bottom",offset:[0,4],content:({onCloseModal:c})=>r.jsx("div",{className:"w-44 p-2 next-modal overflow-y-auto max-h-[30vh]",children:o.map(u=>r.jsxs("div",{onClick:()=>{n(u.uuid,u.title),c()},className:"flex items-center p-2 rounded cursor-pointer animate-hover text-t2",children:[r.jsx(as,{uuid:u.uuid,size:"middle",className:"mr-2"}),r.jsx("div",{className:"text-ellipsis",children:u.title||Ot(m.BlockType.FOLDER)})]},u.uuid))})})};return t.length>3?r.jsxs(r.Fragment,{children:[a(t[0],0),r.jsx("span",{className:"px-0.5 text-grey4",children:"/"}),r.jsx(Js,{popup:"查看折叠的页面路径",onClick:i,className:"rounded-sm cursor-pointer animate-hover",children:"..."}),a(pn(t),t.length-2)]}):r.jsx(r.Fragment,{children:t.map((l,c)=>a(l,c))})},lhe=e=>{const{uuid:t,ownerBlockId:n,root:s,showNotFound:a,readonly:o}=e,[i,l]=F.useState(t),c=_e(t,["data","subNodes"],["segments"]),[u,d]=F.useState(),[f,h]=F.useState(!1),[p,g]=F.useState([]),_=ahe(),x=Un(),y=wF(i),b=iS(i),E=y.folder.length+y.files.length+b;F.useEffect(()=>{l(t),g([])},[t]),F.useEffect(()=>{var T;if(a&&!E||i===t&&((T=c==null?void 0:c.subNodes)!=null?T:0)===0){d(null);return}h(!0);const C=setTimeout(()=>{_(i).then(v=>{d(v),h(!1)})},500);return()=>{clearTimeout(C)}},[i,_,a,E,t,c==null?void 0:c.subNodes]);const w=(C,T)=>{g(v=>{const I=v.findIndex(j=>j.uuid===C);return t===C?[]:I===-1?(v.push({uuid:C,title:T}),v):(v.splice(I+1,v.length-I),v)}),l(C)},k=F.useMemo(()=>{const C=u===1403,T=r.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 h-full text-grey3 text-t2 bg-grey6",children:[r.jsx(H,{name:"IcUploadImageFaild",size:"large",className:"mb-2"}),r.jsx("span",{children:C?"无法访问该页面":"文件夹已被删除"}),C&&r.jsx("span",{className:"mt-1 text-grey3",children:"当前页面并未开启分享"})]});if(a)return T;switch(u){case 1403:case 3005:case 1600:return T;default:return null}},[u,a]);return r.jsx(w5,{root:s,uuid:t,ownerBlockId:n,readonly:o,title:r.jsx("div",{className:"flex items-center",children:a&&!E?"文件夹已被删除":r.jsx(ihe,{navs:[{uuid:t,title:de(c==null?void 0:c.data.segments)},...p],clickFolder:w})}),context:`${E} 项内容`,iconName:E?"MIcFolder":"MIcFolderBlank",viewModelToolBarData:{onOpen:()=>{x.push(`/${i}`)}},children:r.jsx(Wg,{uuid:i,children:u||a?k:E>0?r.jsxs("div",{className:"overflow-x-hidden overflow-y-auto",children:[r.jsx(che,{uuid:i}),y.folder.map(C=>r.jsx(M4,{readonly:o,block:C,clickFolder:w},C.uuid)),y.files.map(C=>r.jsx(M4,{readonly:o,block:C},C.uuid))]}):r.jsx("div",{className:"flex flex-col items-center justify-center h-full bg-grey8 text-grey4 text-t2",children:f?r.jsx(os,{}):r.jsxs(r.Fragment,{children:[r.jsx(H,{name:"IcUploadImageFaild",size:"large",className:"mb-2"}),r.jsx("span",{children:"当前文件夹为空"})]})})})})},che=({uuid:e})=>{const t=oS(e);return r.jsx(r.Fragment,{children:t.map(n=>{var o,i;const s=(o=n.name)!=null?o:"",a=sn(s);return r.jsxs("div",{className:"relative flex px-2 py-3 text-t2 animate-hover-black3 group",children:[r.jsx(H,{name:pa(a.extName),size:"middle",className:"mr-2"}),r.jsx(Bl,{className:"sm:leading-[15px]",fileName:s}),r.jsx(d3,{progress:(i=n.progress)!=null?i:-1,fail:n.status===Yn.failure,className:B("absolute z-10 h-[3px] w-full left-0 bottom-[0px] ")})]},n.key)})})},uhe=({id:e,root:t,children:n})=>{const s=_e(e,["data"],["level"]),a=Vn();if(!s)return null;const{level:o=1}=s.data;return r.jsxs(ln,{id:e,horizontal:t,className:B("heading",a!==Tt.PAGE_FEEDS&&{"mt-[25px] mb-px":o===1,"mt-[15px] mb-px":o===2,"my-2":o===3,"my-px":o===4}),children:[r.jsx(Mo,{className:B("w-full px-0.5",{"text-h1 py-1.5":o===1,"text-h2 py-2":o===2,"text-h3 py-0.5":o===3,"text-h4 py-0.5":o===4}),uuid:e,placeholder:`标题${o}`}),n&&r.jsx(Ni,{blockId:e,children:n})]})},dhe=({id:e,root:t,children:n})=>{const[s=!0]=cu(e),a=ae(i=>{const{blocks:l}=i;return NC(e,l)},{equalityFn:Cn}),o=pt.print||s;return r.jsxs("div",{className:"relative",children:[r.jsx(HC,{id:e}),r.jsxs(ln,{id:e,className:"relative my-px",horizontal:t,children:[r.jsxs("div",{className:"block-has-icon-container flex-1",children:[r.jsx("div",{className:"min-w-[24px] mr-1 text-center inline-block dot",children:a}),r.jsx(Mo,{uuid:e,className:"self-start flex-1 w-0",placeholder:"编号列表"})]}),n&&o&&r.jsx(Ni,{blockId:e,children:n})]})]})},u_=({id:e,root:t,ownerBlockId:n})=>{const{illegal:s}=it(e),a=gt(),o=ae(u=>{var d,f;return(f=(d=u.blocks[n!=null?n:e])==null?void 0:d.data.format)==null?void 0:f.cardFormat}),i=ae(u=>{var d;return(d=u.blocks[n!=null?n:e])==null?void 0:d.hidden}),l=ae(u=>{var d;return(d=u.blocks[e])==null?void 0:d.type}),c=Dl(n!=null?n:e,a);return i?null:r.jsx(ln,{id:n!=null?n:e,className:B("my-1",s&&"opacity-30",l===m.BlockType.PAGE&&(o==null?void 0:o.showType)==="large"?c?"w-full":"w-fit":""),horizontal:t,"data-draggable":!0,children:r.jsx(rP,{id:e,root:t,ownerBlockId:n})})},fhe=({id:e,root:t,children:n})=>_e(e,["textColor"])?r.jsx(ln,{id:e,className:"py-1 my-px w-full pr-2",horizontal:t,children:r.jsxs("div",{className:"pl-2 border-l-4 border-solid border-current",children:[r.jsx(ln,{dropInChild:!0,bindId:!1,id:e,children:r.jsx(Mo,{uuid:e,placeholder:"引述文字",className:"w-full text-t1 px-0.5"})}),n]})}):null,mhe=({id:e,root:t})=>{var o,i,l,c;const n=_e(e,["data"],["ref","display"]),s=_e((o=n==null?void 0:n.data.ref)==null?void 0:o.uuid,[]);if(F.useEffect(()=>{pe(e,{local:!1},!0)},[e]),!n)return null;let a=()=>r.jsx(r.Fragment,{});switch(n.data.display){case"image":{a=VC;break}case"file":{a=B3;break}case"folder":{a=kE;break}case"video":{a=C5;break}case"audio":{a=k5;break}case"linkPage":{(s==null?void 0:s.type)===m.BlockType.FOLDER?a=kE:a=u_;break}default:(i=n.data.ref)!=null&&i.uuid&&s&&(a=b3(s.type))}return r.jsx(a,{id:(c=(l=n.data.ref)==null?void 0:l.uuid)!=null?c:"",root:t,ownerBlockId:e})},hhe={},T5=()=>F.useCallback(async(e,t)=>{let n=hhe[e];return n||(n=oa(async()=>{var a;const s=await Ce.editor.getDocBacklinks.raw(e);if(s.code===200){ee(Gn.update({blocks:s.data.recordMap.blocks}));const o=Bm(s.data.results,"pageId");return o.unshift({pageId:ls(t),uuid:t,spaceId:(a=K.blocks[t])==null?void 0:a.spaceId}),{result:o,pageCount:Number(s.data.backlinkPageCount)}}})),n},[]),U4=10,phe=e=>{const{backLinks:t,total:n}=e,[s,a]=F.useState(t.length<=U4),o=F.useRef(null),i=s?t:sj(t,U4),l=t.length-i.length,c=n-t.length;return r.jsxs("div",{ref:o,className:"shadow-sync bg-white1 border border-grey6 rounded w-[400px] max-h-[65vh] overflow-scroll",children:[r.jsx(Bd,{defaultIndex:-1,listenPriority:Tr,containerRef:o,itemCount:i.length,children:u=>i.map((d,f)=>r.jsx(ghe,{index:f,uuid:d.uuid,pageId:d.pageId,selected:u===f},d.uuid))}),l>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-grey6 h-px w-full text-t4 "}),r.jsxs("div",{className:"flex py-4 items-center ml-4 cursor-pointer text-t4 text-grey3",onClick:()=>{a(!0)},children:["其他 ",l," 个页面"]})]}),s&&c>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"bg-grey6 h-px w-full"}),r.jsxs("div",{className:"flex items-center text-t4 ml-4 text-grey3 py-4",children:[r.jsx(H,{name:"IcLock",size:"middle",style:{color:"var(--grey3)"}}),r.jsxs("div",{children:["还有 ",c," 个页面你暂无权限"]})]})]})]})},ghe=e=>{const{uuid:t="",pageId:n="",selected:s=!1,index:a,...o}=e,i=_e(n,["data","permissions"],["segments"]),l=_e(t,[]),c=gt(),u=Lx(),d=Ft(),f=d.planType==="freePersonal"||d.planType==="personal",{illegal:h}=it(n),{permissions:p}=it(t),g=Rl(n),_=Md(i==null?void 0:i.spaceId),x=Cs(),y=F.useRef();return!i||!n||!t?null:r.jsx(Fe,{lazyLoad:!0,onShow:b=>{y.current=b},theme:"none",interactive:!0,popupClass:"next-modal",offset:[0,5],disabled:c===n,placement:"top",className:"w-full",maxWidth:1e4,delay:[500,50],animation:"shift-away",popup:r.jsx(wl,{pageId:n,blockId:t,onCloseOutsideModel:()=>{var b;(b=y.current)==null||b.hide()}}),children:r.jsxs(pc,{to:`${g}#${t}`,className:B("flex items-center text-t2-medium w-full animate-hover rounded-sm h-10  p-4 justify-between text-ellipsis",h&&"opacity-30",{"normal-bg":s}),...o,onClick:b=>{c!==n&&(b.preventDefault(),x(n,{hash:`#${t}`,domain:_,forceOpenInRight:b.altKey,forceOpenNewTab:b.ctrlKey||b.metaKey}))},children:[r.jsxs("div",{className:"flex items-center overflow-hidden",children:[r.jsx(tn,{blockId:n,trigger:!1,iconSize:18,defaultIcon:r.jsx(as,{uuid:n,size:"middle"})}),r.jsx("div",{className:"text-ellipsis underline ml-1 mr-1.5 text-black decoration-grey5",children:h?rs:de(i.data.segments)||Ot(i.type)})]}),r.jsxs("div",{className:"flex text-t2",children:[p.every(b=>pn([...u(t)])!==i.spaceId||f?!1:b.type===m.PermissionType.SPACE||b.type===m.PermissionType.GROUP?b.role===m.PermissionRole.NONE:b.type===m.PermissionType.USER?b.role!==m.PermissionRole.NONE&&b.userId===K.user.uuid:!0)&&r.jsxs("span",{className:"flex items-center text-red text-t4-medium mr-1",children:[r.jsx(H,{name:"IcLock",size:"middle"}),r.jsx("span",{children:"仅我可见"})]}),(l==null?void 0:l.type)===m.BlockType.SYNC_CONTAINER&&r.jsx("div",{className:"px-1.5 bg-grey/20 rounded text-grey2/80",children:"源同步块"}),c===n&&r.jsx("div",{className:"ml-1 px-1.5 bg-grey/20 rounded text-grey2/80",children:"当前页"})]})]})})},_he=e=>{const{blockId:t,syncBlockId:n}=e,[s,a]=F.useState(e.backLinks),[o,i]=F.useState(e.total),l=jg(),c=e_(),u=me(),d=rx(),f=T5(),h=F.useContext(xl),p=sD();F.useEffect(()=>{p(!1),s.length===0&&setTimeout(async()=>{const _=await f(t,n);_&&(Is.unstable_batchedUpdates(()=>{a(_.result),i(_.pageCount)}),e.updateSyncInfo(_.result,_.pageCount))},1e3)},[s.length,t,f,e,p,n]),F.useEffect(()=>()=>{u.closeModal(Xe.SYNC_BLACK_LINK)},[u]);const g=DV(t)||d;return r.jsxs("div",{"data-no-cancel-selected":!0,className:B("flex items-center border border-grey6 rounded-sm shadow-sync bg-white1 text-t2 h-9 cursor-pointer",`${g?"hidden":"duration-300 opacity-100"}`),children:[r.jsxs("div",{className:"flex items-center p-2 animate-hover",onClick:async _=>{const x=_.currentTarget.getBoundingClientRect(),y=await f(t,n);y&&(Is.unstable_batchedUpdates(()=>{a(y.result),i(y.pageCount)}),e.updateSyncInfo(y.result,y.pageCount),u.dropdown({modalId:Xe.SYNC_BLACK_LINK,offset:[-19,4],placement:"bottom",popcorn:{getBoundingClientRect:()=>x},content(){return r.jsx(xl.Provider,{value:h,children:r.jsx(phe,{backLinks:y.result,total:y.pageCount})})}}))},children:[r.jsx("div",{children:`${o<=0?"暂无页面同步":`${o}个页面正在同步`}`}),r.jsx(H,{name:"IcArrow",className:"text-grey4 pl-1"})]}),r.jsx("div",{className:"w-[1px] h-9 bg-grey6"}),r.jsx("div",{className:"animate-hover p-2",onClick:()=>{hG(t),ye.success({content:"已复制，你可以粘贴到任意页面生成同步块"}),p(!0),Ye({$focusedInSyncBlockId:""}),l()},children:"复制并同步"}),r.jsx("div",{className:"w-[1px] h-9 bg-grey6"}),r.jsx("div",{className:"animate-hover flex items-center p-2",onClick:_=>{c({blockId:t,blockNode:_.currentTarget,placement:"bottom-start",offset:[0,-5]})},children:r.jsx(H,{name:"IcMore",size:"middle"})})]})},v5=({id:e,ownerBlockId:t,children:n})=>{const s=F.useRef(null),a=me(),o=Kt(),i=F.useRef(),l=t||e,c=Ve(l),{role:u}=it(e),d=cD()===l,f=jg(),[h,p]=F.useState([]),[g,_]=F.useState(0),x=F.useRef(),y=F.useContext(xl),b=ae(D=>l?D.ui.selectedBlocks.length===1&&D.ui.selectedBlocks.findIndex(S=>S.blockId===l)!==-1:!1),E=ke(),w=F.useMemo(()=>n===void 0?!0:Array.isArray(n)?n.length===0:!1,[n]),k=_e(e,[]),C=fr(),v=!Rm(Xe.DOC_HISTORY_MODAL_ID)&&(d||b)&&!c,I=!!k,j=T5();return F.useEffect(()=>{I&&(ht()||j(l,e).then(D=>{var S;D&&(Is.unstable_batchedUpdates(()=>{p(D.result),_(D.pageCount)}),t&&In.emit("syncBlock",{uuid:t,pageId:(S=ls(e))!=null?S:"",spaceId:Ut()}))}))},[l,e,t,I,j]),F.useEffect(()=>()=>{x.current&&clearTimeout(x.current),a.closeModal("dropDownContent-sync")},[a]),F.useEffect(()=>{const D=S=>{const{uuid:R,pageId:A,spaceId:L}=S;h.length===0||h.some(M=>M.pageId===A&&M.uuid!==e)||(p([...h,{uuid:R,pageId:A,spaceId:L}]),_(M=>M+1))};return In.on("syncBlock",D),()=>{In.off("syncBlock",D)}},[h,e]),F.useEffect(()=>{if(ht())return;const D=s.current;D&&(x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{if(v){if(i.current)return;i.current=a.dropdown({id:"dropDownContent-sync",autoClose:!1,mask:!1,flip:!1,placement:"top-end",popcorn:D,closeBeforeCallBack:()=>{i.current=void 0},content({onCloseModal:S}){return r.jsx(xl.Provider,{value:y,children:r.jsx(_he,{updateSyncInfo:(R,A)=>{Is.unstable_batchedUpdates(()=>{p(R),_(A)})},syncBlockId:e,closeSyncMenu:S,backLinks:h,blockId:l,total:g})})}}).modalId}else i.current&&o(i.current,{noAnimation:!0})},50))},[f,o,e,a,v,l,h,g,y]),xhe(s,l),Em(()=>{i.current&&o(i.current)}),k?r.jsx(ln,{id:l,className:"py-1",blockRef:s,"data-sync-count":`${g}`,"data-sync-container-id":l,bindId:!d,children:r.jsxs("div",{className:B("px-[1px] rounded border border-transparent min-h-[36px]  ",{"border-red border-opacity-70":b&&!c},{"hover:border-red hover:border-opacity-40 focus-within:!border-red focus-within:!border-opacity-70":!c},{"flex items-center":w}),children:[w&&!c&&(u===m.PermissionRole.EDITOR||u===m.PermissionRole.WRITER)&&r.jsx(ln,{dropInChild:!0,className:"my-1",bindId:!1,id:l,children:r.jsx("div",{className:"cursor-pointer text-grey4",onClick:()=>{E(()=>{const D=Qe({},{parentId:e,last:!0});C(D,0,void 0,{syncId:l})})},children:"点击或拖拽添加内容，然后粘贴到其他页面进行同步"})}),r.jsx(a6.Provider,{value:c,children:r.jsx(VR.Provider,{value:l,children:n})})]})}):null},xhe=(e,t)=>{F.useEffect(()=>{const n=e.current,s=o=>{if(o.target instanceof Element){if(o.target.closest("[data-no-cancel-selected]")||o.target.id===cg)return;const i=o.target.closest("[data-sync-container-id]");if(i instanceof HTMLElement&&i.dataset.syncContainerId===t)return;wt.$focusedInSyncBlockId===t&&Ye({$focusedInSyncBlockId:""}),qt.removeEventListener("mousedown",s)}},a=()=>{wt.$focusedInSyncBlockId!==t&&(Ye({$focusedInSyncBlockId:t}),In.emit("removeHoverMenu")),qt.addEventListener("mousedown",s)};return n==null||n.addEventListener("focusin",a),()=>{n==null||n.removeEventListener("focusin",a),qt.removeEventListener("mousedown",s)}},[t,e])},Fhe=e=>{const{items:t=[],chunkSize:n=25,maxSize:s=200,renderItem:a,onProgress:o=()=>{}}=e,i=t.length,[l,c]=F.useState([]),[u,d]=F.useState(s>=i),f=F.useRef(!1),h=F.useRef(null);return F.useEffect(()=>{h.current&&clearTimeout(h.current);const p=()=>{CE(()=>{d(!0),c([]),o("end")})};if(!u){if(f.current){p();return}return f.current=!0,i>s?Promise.resolve().then(()=>{o("start");const g=CI(t,n),_=g.shift()||[];c(_),g.pop();const x=b=>{CE(()=>{c(w=>w.concat(b));const E=g.shift();E?x(E):p()})},y=g.shift();if(y){x(y);return}p()}):p(),p}},[i,t,u]),r.jsxs(r.Fragment,{children:[(u?t:l).map((p,g)=>a(p,g)),l.length!==0&&r.jsx("div",{style:{height:l.length*50}})]})},CE=(e,t)=>{const n=Date.now();requestAnimationFrame(()=>{Date.now()-n<20?(e(),t==null||t()):CE(e,t)})},V4=F.memo(({id:e,root:t,type:n,subNodes:s=[],visibleRender:a})=>{const o=b3(n),i=F.useMemo(()=>{if(s.length)return s.map(l=>r.jsx(by,{id:l,visibleRender:a},l))},[s,a]);return r.jsx(Nd,{scope:Gm,initialValues:[[zm,e]],children:r.jsx(o,{id:e,root:t,children:i})})}),yhe=[m.BlockType.TEXTAREA,m.BlockType.TODO,m.BlockType.HEADER,m.BlockType.QUOTE,m.BlockType.PAGE,m.BlockType.ORDER_LIST,m.BlockType.LIST,m.BlockType.LINK_PAGE,m.BlockType.MARK,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE,m.BlockType.TOGGLE_HEADER],bhe=[m.BlockType.MIND_MAPPING,m.BlockType.PAGE],by=F.memo(e=>{var i;const{id:t,visibleRender:n}=e,s=_e(t,["subNodes"]),a=bhe.includes((i=s==null?void 0:s.type)!=null?i:m.BlockType.TEXTAREA);return F.useMemo(()=>{if(!s)return!1;if(a)return!0;if(!n||ht())return!1;const c=yhe.includes(s.type);return c?!!((s==null?void 0:s.subNodes.length)===0&&c):!1},[s,a,n])?r.jsx(n3,{blockId:t,renderMode:a?dc.blank:n,children:r.jsx(V4,{...e,subNodes:s==null?void 0:s.subNodes,type:s==null?void 0:s.type})},`visible-${t}`):r.jsx(V4,{...e,subNodes:s==null?void 0:s.subNodes,type:s==null?void 0:s.type},`normal-${t}`)}),Ehe=F.memo(e=>{const t=tX(),{subNodes:n=[],visibleRender:s,root:a}=e;return r.jsx(Fhe,{maxSize:50,items:n,onProgress:o=>{t(o==="start")},renderItem:o=>r.jsx(by,{id:o,root:a,visibleRender:s},`${o}-root`)})}),whe=({id:e,root:t})=>{var i;const n=_e(e,["data"],["ref"]),s=_e((i=n==null?void 0:n.data.ref)==null?void 0:i.uuid,["subNodes"]),a=!!Os(),o=F.useMemo(()=>s==null?void 0:s.subNodes.map(l=>r.jsx(by,{visibleRender:dc.innerHtml,id:l},l)),[s]);return!n||!s||a?null:r.jsx(v5,{id:s.uuid,root:t,ownerBlockId:e,children:o})},q4={startX:0,startY:0,minX:0,minY:0,minRowIndex:0,minColumnIndex:0,originRows:[""],maxRows:[""],originColumns:[""],maxColumns:[""],localBlock:new Set},khe=120,H4=38,Che=18,$4=40,G4={row:["加一行","快速加/减行"],column:["加一列","快速加/减列"],corner:["加一行和一列","快速加/减行和列"]},z4={row:"dragging-row",column:"dragging-col",corner:"dragging-nwse"},Pb=({tableRef:e,tableId:t,type:n,indexRanges:s})=>{var E,w;const[{width:a,height:o},i]=F.useState({width:0,height:0}),l=ae(({blocks:k,simpleTable:C})=>{var te,re;const T=k[t];if(!T)return!1;const{hoveringCell:v,activityTableId:I}=C;if(!v||I!==t)return!1;const{subNodes:j,data:D}=T,{format:S={}}=D,R=(te=S.tableBlockColumnOrder)!=null?te:[],{rowIndex:A,columnIndex:L}=v,P=j[A],M=R[L];if(!P||!M)return!1;let U=0,V=0;const z=((re=S.tableBlockRanges)!=null?re:[]).find(({start:ne})=>ne&&ne[0]===P&&ne[1]===M);if(z){const{start:ne,end:Y}=z;if(ne&&Y&&ne[1]&&Y[1]){const X=R.indexOf(ne[1]);U=R.indexOf(Y[1])-X+1}if(ne&&Y&&ne[0]&&Y[0]){const X=j.indexOf(ne[0]);V=j.indexOf(Y[0])-X+1}}const Q=v.rowIndex+Math.max(0,V-1)===j.length-1,Z=v.columnIndex+Math.max(0,U-1)===R.length-1;return n==="row"?Q:(n==="column"||Q)&&Z}),[c,u]=F.useState(0),d=_e(t,["data","subNodes"],["format"]),[f,h]=F.useState(!1),p=ae(({simpleTable:k})=>k.activityTableId===t&&!!k.draggingBarType),g=ae(({simpleTable:k})=>k.activityTableId===t&&k.draggingBarType===n),_=F.useRef(nT(q4)),x=ke(),y=(w=(E=d==null?void 0:d.data.format)==null?void 0:E.tableBlockColumnOrder)!=null?w:[];if(F.useLayoutEffect(()=>{setTimeout(()=>{if(!e.current)return;const k=e.current.getBoundingClientRect();i({width:k.width,height:k.height})})},[e,l,g,p,d==null?void 0:d.subNodes.length,y.length]),F.useEffect(()=>{var C;if(!e.current)return;const k=(C=e.current.closest('[data-virtuoso-scroller="true"]'))==null?void 0:C.parentElement;if(n!=="row"&&k){const T=parseInt(getComputedStyle(k).getPropertyValue("padding-left"),10);u(a+T)}},[l,e,n,a]),F.useEffect(()=>{if(!g)return;const k=()=>{var M,U;ee(Qn.update({activityTableId:void 0,draggingBarType:void 0}));const v=document.getElementById("root");v==null||v.classList.remove(z4[n]);const I=_.current.originRows.slice(),j=_.current.originColumns.slice();_.current=nT(q4);const D=K.blocks[t];if(!D)return;const{subNodes:S,data:R}=D,{format:A}=R,L=(M=A==null?void 0:A.tableBlockColumnOrder)!=null?M:[],P=(U=A==null?void 0:A.tableBlockColumnFormat)!=null?U:{};n==="corner"&&ce.event("simpletable_add_drag"),n!=="row"&&pe(t,{data:{format:{tableBlockColumnOrder:j}}},!0),x(()=>{if(n!=="column"&&(S.length<I.length?I.filter(V=>!S.includes(V)).forEach(V=>{ha(V)}):S.length>I.length&&(pe(t,{subNodes:I},!0),S.filter(V=>!I.includes(V)).reduce((V,W)=>(Qe({uuid:W,type:m.BlockType.TABLE_ROW},{parentId:t,after:V}),V),pn(I)))),n!=="row")if(L.length<j.length){const V=L.reduce((W,z)=>{const Q=P[z];return Q&&(W[z]=Q),W},{});pe(t,{data:{format:{tableBlockColumnOrder:L,tableBlockColumnFormat:V}}})}else L.length>j.length&&pe(t,{data:{format:{tableBlockColumnOrder:L}}})})},T=fs(v=>{var Q,Z,te,re;const{minX:I,minY:j,startX:D,startY:S,maxRows:R,maxColumns:A,minRowIndex:L,minColumnIndex:P}=_.current;if(D===0&&S===0)return;const M=K.blocks[t];if(!M)return;const{subNodes:U,data:V}=M;if(n!=="column"&&(v.y>S+Che||v.y<S))if(v.y<j)U.length>L+1&&pe(t,{subNodes:R.slice(0,L+1)},!0);else{const ne=Math.ceil((v.y+H4-j)/H4),Y=ne+L-R.length;if(Y>0)for(let X=0;X<Y;X++){const oe=Qe({type:m.BlockType.TABLE_ROW},{parentId:t,last:!0},!0);_.current.localBlock.add(oe),_.current.maxRows=(Z=(Q=K.blocks[t])==null?void 0:Q.subNodes.slice())!=null?Z:[]}else pe(t,{subNodes:R.slice(0,L+ne)},!0)}const{format:W}=V,z=(re=(te=W==null?void 0:W.tableBlockColumnOrder)==null?void 0:te.slice())!=null?re:[];if(n!=="row"&&(v.x>D+$4||v.x<D-$4))if(v.x<I)z.length>P+1&&pe(t,{data:{format:{tableBlockColumnOrder:A.slice(0,P+1)}}},!0);else{const ne=Math.ceil((v.x-I)/khe),Y=ne+P-A.length;if(Y>0){const X=A.concat(Array.from(Array(Y)).map(()=>qe()));pe(t,{data:{format:{tableBlockColumnOrder:X}}},!0),_.current.maxColumns=X.slice()}else pe(t,{data:{format:{tableBlockColumnOrder:A.slice(0,P+ne)}}},!0)}},32);return document.addEventListener("mouseup",k),document.addEventListener("mousemove",T),()=>{document.removeEventListener("mouseup",k),document.removeEventListener("mousemove",T)}},[g,t,e,x,n]),!d)return null;const b={};return n==="row"&&(b.style={width:a}),n==="corner"&&(b.style={left:c},b.key=c),n==="column"&&(b.style={left:c,height:o},b.key=c),r.jsx(Fe,{placement:"bottom",className:B("absolute items-end justify-end ml-3 opacity-0",!p&&"transition-opacity duration-100 hover:opacity-100",(l||g)&&"opacity-100",n==="corner"&&"w-[18px] h-[18px] bottom-2 pl-0.5",n==="row"&&"h-[18px] bottom-2",n==="column"&&"top-3 w-[18px] pl-0.5"),visible:g||f,popup:g?r.jsx("div",{className:"py-1 px-2 font-semibold",children:`${y.length} × ${d.subNodes.length}`}):r.jsxs("div",{className:"py-1 px-2",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("span",{className:"text-white font-medium mr-1",children:"点击"}),r.jsx("span",{className:"text-grey4",children:G4[n][0]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("span",{className:"text-white font-medium mr-1",children:"拖拽"}),r.jsx("span",{className:"text-grey4",children:G4[n][1]})]})]}),...b,children:r.jsx("div",{"data-disable-select":!0,className:B("flex-1 h-4 bg-grey7 flex items-center justify-center",g&&"bg-black/20",n==="corner"&&"rounded-full h-4 cursor-nwse-resize",n==="row"&&"rounded h-4 cursor-row-resize",n==="column"&&"rounded h-full cursor-col-resize"),onMouseEnter:()=>{!p&&h(!0)},onMouseLeave:()=>h(!1),onMouseDown:()=>{var T,v,I,j,D,S,R;ee(Qn.update({activityTableId:t,draggingBarType:n,chosenCells:void 0}));const k=document.getElementById("root");k==null||k.classList.add(z4[n]),_.current.originRows=d.subNodes.slice(),_.current.maxRows=d.subNodes.slice(),_.current.originColumns=y.slice(),_.current.maxColumns=y.slice();const C=(T=e.current)==null?void 0:T.getBoundingClientRect();if(_.current.startX=(v=C==null?void 0:C.right)!=null?v:0,_.current.startY=(I=C==null?void 0:C.bottom)!=null?I:0,Gb(d.subNodes,(A,L)=>{var M,U;if(_.current.minY)return;const P=K.blocks[A];if(P){const{collectionProperties:V={}}=P.data;if(Object.values(V).some(z=>z.length)){const z=(M=e.current)==null?void 0:M.querySelector(`[data-table-row-index="${L}"]`);_.current.minY=(U=z==null?void 0:z.getBoundingClientRect().bottom)!=null?U:0;const Q=Number(z==null?void 0:z.dataset.tableRowIndex),Z=Math.max(Q,...s.map(te=>te[0][0]===Q?te[1][0]:0));_.current.minRowIndex=Z}}}),!_.current.minY){const A=(j=e.current)==null?void 0:j.querySelector("tr");_.current.minY=(D=A==null?void 0:A.getBoundingClientRect().bottom)!=null?D:0}if(Gb(_.current.originColumns,(A,L)=>{_.current.minX||d.subNodes.some(P=>{var W,z,Q;const M=K.blocks[P];if(!M)return!1;const{collectionProperties:U={}}=M.data,V=(W=U[A])==null?void 0:W.length;if(V){const Z=(z=e.current)==null?void 0:z.querySelector(`[data-table-column-index="${L}"]`);_.current.minX=(Q=Z==null?void 0:Z.getBoundingClientRect().right)!=null?Q:0;const te=Number(Z==null?void 0:Z.dataset.tableColumnIndex),re=Math.max(te,...s.map(ne=>ne[0][1]===te?ne[1][1]:0));_.current.minColumnIndex=re}return V})}),!_.current.minX){const A=(S=e.current)==null?void 0:S.querySelector("td");_.current.minX=(R=A==null?void 0:A.getBoundingClientRect().right)!=null?R:0}},onClick:k=>{k.stopPropagation(),h(!1),n==="corner"?ce.event("simpletable_add_click"):ce.event("simpletable_fastadd"),x(()=>{var C;if(n!=="column"&&Qe({type:m.BlockType.TABLE_ROW},{parentId:t,last:!0}),n!=="row"){const{format:T}=d.data,v=(C=T==null?void 0:T.tableBlockColumnOrder)!=null?C:[];pe(t,{data:{format:{tableBlockColumnOrder:v.concat(qe())}}})}})},children:r.jsx(H,{name:"IcBtnNew",size:"xsmall",className:B(g?"!text-white":"text-grey3")})})})},The=(e,t)=>{const n=ke(),s=F.useCallback((o,i)=>{var h,p;const{blocks:l}=le(),c=l[e];if(!c)return;const d=(p=((h=c.data.format)!=null?h:{}).tableBlockColumnFormat)!=null?p:{},f={format:{tableBlockColumnFormat:{...d,[t]:{...d[t],width:o}}}};i?pe(e,{data:f},!0):n(()=>pe(e,{data:f}))},[t,e,n]),a=F.useMemo(()=>$n(o=>{s(o,!1)},300),[s]);return F.useCallback(o=>{fs(s,32)(o,!0),a(o)},[a,s])},vhe=({tableId:e,tableRef:t})=>{const n=ae(({blocks:o})=>{var l,c;const i=o[e];return i?(c=(l=i==null?void 0:i.data.format)==null?void 0:l.tableBlockColumnOrder)!=null?c:[]:[]}),s=ae(({blocks:o})=>{var l;const i=o[e];return i?(l=i==null?void 0:i.subNodes)!=null?l:[]:[]}),a=ae(({blocks:o})=>{const i=o[e];return i?n.map(l=>{var c,u,d,f;return(f=(d=(u=(c=i.data.format)==null?void 0:c.tableBlockColumnFormat)==null?void 0:u[l])==null?void 0:d.width)!=null?f:b0}):[]});return r.jsxs("div",{className:"absolute top-0 translate-x-2 translate-y-3 pointer-events-none",style:{height:"calc(100% - 30px)"},children:[r.jsx("div",{className:"absolute top-0 w-full h-full",children:s.map((o,i)=>r.jsx(jhe,{recordId:o,tableRef:t,tableId:e},i))}),r.jsx("div",{className:"flex h-full",children:a.map((o,i)=>{const l=n[i];return l?r.jsx(Ihe,{width:o,propertyId:l,tableId:e},i):null})})]})},Nhe=38,Ihe=({width:e,tableId:t,propertyId:n})=>{const s=ae(({simpleTable:c})=>!!c.selecting),a=ae(({simpleTable:c})=>!!c.draggingStart),o=The(t,n),i=ae(({simpleTable:c})=>{const{chosenCells:u,dropInfo:d}=c;return d&&(u==null?void 0:u.tableId)===t&&u.propertyId!==n&&d.propertyId===n?d.position:""}),l=$E(({offset:[c]})=>{const u=Math.floor(Math.max(c,Nhe));o(u)},{from:e,preventDefault:!0});return s?null:r.jsx("div",{className:"relative top-0 left-1",style:{width:e,height:"calc(100% - 10px)"},children:i?r.jsx("div",{className:B("absolute bg-black dark:bg-grey3 h-full w-[3px]",i==="left"&&"-translate-x-px -translate-y-px left-0 top-0",i==="right"&&"translate-x-px -translate-y-px right-0 top-0")}):r.jsx("div",{...l(),className:B("absolute top-px z-10 opacity-0 transition-opacity delay-150 h-full -right-[5px] w-[9px] pointer-events-auto",!a&&"hover:cursor-col-resize hover:opacity-100"),style:{touchAction:"none"},children:r.jsx("div",{className:"absolute left-[3px] top-0 w-[3px] -mt-px bg-black dark:bg-grey6 h-full"})})})},jhe=({recordId:e,tableId:t,tableRef:n})=>{const s=ae(({simpleTable:l})=>!!l.draggingStart),a=ae(({simpleTable:l})=>{const{chosenCells:c,dropInfo:u}=l;return u&&(c==null?void 0:c.tableId)===t&&c.recordId!==e&&u.recordId===e?u.position:""}),[o,i]=F.useState(0);return F.useEffect(()=>{var u,d;if(!s)return;const l=n.current;if(!l)return;const c=l.querySelector(`[data-table-row-id="${e}"]`);i((d=(u=c==null?void 0:c.parentElement)==null?void 0:u.clientHeight)!=null?d:0)},[e,s,n]),s?r.jsx("div",{className:"relative top-0 left-1",style:{height:o},children:r.jsx("div",{hidden:!a,className:B("absolute bg-black dark:bg-grey3 h-[3px] w-full",a==="top"&&"translate-x-px -translate-y-px top-0 left-0",a==="bottom"&&"translate-x-px translate-y-px bottom-0 left-0")})}):null},Dhe=F.memo(({tableId:e,tableRef:t,indexRanges:n})=>{const{subNodes:s,tableBlockColumnOrder:a,tableBlockRanges:o}=k3(e),i=sr(),l=F.useMemo(()=>o.reduce((d,{start:f,end:h})=>{var T,v;if(!f||!h)return d;const[p,g]=f,[_,x]=h;if(!p||!g||!_||!x)return d;const y=s.indexOf(p),b=a.indexOf(g),E=s.indexOf(_),w=a.indexOf(x);d[p]={...(T=d[p])!=null?T:{},[g]:{colSpan:w-b+1,rowSpan:E-y+1}};const k=s.slice(y,E+1),C=a.slice(b,w+1);for(const I of k)for(const j of C)I===p&&j===g||(d[I]={...(v=d[I])!=null?v:{},[j]:{colSpan:0,rowSpan:0}});return d},{}),[s,a,o]),c=F.useMemo(()=>fs(d=>{var x,y;const{hoveringCell:f,draggingStart:h,draggingBarType:p}=K.simpleTable;if(h||p)return;const _=d.target.closest("td");if(_){const b=Number((x=_.dataset.tableRowIndex)!=null?x:0),E=Number((y=_.dataset.tableColumnIndex)!=null?y:0);(!f||f.rowIndex!==b||f.columnIndex!==E)&&ee(Qn.update({activityTableId:e,hoveringCell:{rowIndex:b,columnIndex:E}}))}},50,{leading:!0,trailing:!0}),[e]),u=F.useMemo(()=>fs(()=>{const{draggingStart:d}=K.simpleTable;d||ee(Qn.update({hoveringCell:void 0}))},50,{leading:!0,trailing:!0}),[]);return i.current?r.jsx(D8,{className:"mt-3 ml-3 mr-1 mb-7",overscan:300,increaseViewportBy:o.length?1/0:i.current.clientHeight,customScrollParent:i.current,totalCount:s.length,components:{Table:F.memo(d=>r.jsx("table",{...d,className:"w-max",ref:t,onMouseMove:c,onMouseLeave:u}),kn),TableRow:F.memo(d=>{const f=d["data-index"],h=s[f];return h?r.jsx(CC.Provider,{value:{tableId:e,recordId:h,spans:l,indexRanges:n},children:r.jsx("tr",{...d,className:"align-baseline"})}):null},kn)},itemContent:d=>{var h;const f=(h=s[d])!=null?h:"";return a.map((p,g)=>{var x,y;const _=(y=(x=l[f])==null?void 0:x[p])!=null?y:{};return _.colSpan===0||_.rowSpan===0?null:r.jsx(iP,{span:_,propertyId:p,rowIndex:d,columnIndex:g},`${f}-${p}`)})}}):null},kn),She=({tableRef:e,tableId:t})=>{const n=!oP(t),{width:s=-9999}=Ba(e.current,"width"),[a,o]=F.useState(0),i=ke(),l=me(),c=F.useRef(),u=gt(),d=ae(h=>{var p;return(p=h.blocks[u])==null?void 0:p.data.pageFixedWidth});F.useEffect(()=>{const h=()=>{var g;const p=document.querySelector(`[data-block-id="${t}"]`);o((g=p==null?void 0:p.clientWidth)!=null?g:-9999)};return setTimeout(h,100),window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[t,d]);const f=(s>a?a:s)-88;return r.jsxs("div",{"data-no-cancel-selected":!0,className:B("absolute z-10 flex -top-8 h-8 items-center bg-white1 shadow-modal border border-black_006 rounded-sm transition-opacity",n?"opacity-0 pointer-events-none":"opacity-100"),style:{left:f},children:[r.jsx(Fe,{popup:"自适应宽度",offset:[0,8],onClick:h=>{var y,b;if(h.stopPropagation(),n)return;const p=(b=(y=K.blocks[t])==null?void 0:y.data.format)!=null?b:{},{tableBlockColumnFormat:g={},tableBlockColumnOrder:_=[]}=p,x=_.length;ce.event("simpletable_width"),i(()=>{pe(t,{data:{format:{tableBlockColumnFormat:_.reduce((E,w)=>(E[w]={...g[w],width:(a-28)/x},E),{})}}})})},className:"flex w-9 items-center justify-center border-r border-black_006 animate-click",children:r.jsx(H,{name:"IcTableFitWidth",size:"middle"})}),r.jsxs("div",{ref:c,onClick:h=>{h.stopPropagation(),!n&&l.dropdown({modalId:Xe.TABLE_HEADER_MENU_LIST,popcorn:c.current,placement:"bottom",offset:[0,15],mask:!1,content(){return r.jsx(Rhe,{tableId:t})}})},className:"flex w-[50px] items-center justify-center animate-click",children:[r.jsx(H,{name:"MIcTableHeader",size:"middle"}),r.jsx(H,{name:"IcArrow",size:"xxxsmall",className:"text-grey4 ml-1.5"})]})]})},Rhe=({tableId:e})=>{var a;const t=(a=ae(o=>{var i,l;return(l=(i=o.blocks[e])==null?void 0:i.data)==null?void 0:l.format}))!=null?a:{},n=ke(),s=[{type:$.TEXT_SWITCH,data:{title:"标题行",switch:t.tableBlockRowHeader,icon:"IcTableHeaderRow",noCancelSelected:!0,onSwitch:o=>{ce.event("simpletable_titlerow",{openclose:o?"open":"close"}),n(()=>{pe(e,{data:{format:{tableBlockRowHeader:o}}})})}}},{type:$.TEXT_SWITCH,data:{title:"标题列",switch:t.tableBlockColumnHeader,icon:"IcTableHeaderColumn",noCancelSelected:!0,onSwitch:o=>{ce.event("simpletable_titlecolumn",{openclose:o?"open":"close"}),n(()=>{pe(e,{data:{format:{tableBlockColumnHeader:o}}})})}}}];return r.jsx(ze,{className:"py-[5px] rounded-r w-60 next-modal",items:s})},W4={left:0,width:0,height:0,top:0},K4=12,e1=12,Y4={},X4=1,Ahe=({root:e,tableRef:t,tableId:n,indexRanges:s})=>{const{recordId:a,propertyId:o}=ae(({simpleTable:k})=>{const{chosenCells:C}=k;return!C||n!==C.tableId?Y4:C}),[i,l]=F.useState(W4),{width:c=-9999}=Ba(t.current,"width"),u=ae(({simpleTable:k})=>{const{chosenCells:C,draggingStart:T}=k;return n===(C==null?void 0:C.tableId)&&!!T}),d=F.useRef(W4),f=F.useRef([]),h=F.useRef(),p=F.useRef(),g=ke(),_=e?96:0,x=_+K4,y=uf(a),b=uf(o),E=F.useCallback(()=>{var S,R,A,L,P;const k=t.current;if(!k)return;const C=k.querySelector(".table-selector");if(!C)return;const T=C.closest("td");if(!T)return;let v=K4;const I=(S=k.closest('[data-virtuoso-scroller="true"]'))==null?void 0:S.parentElement;I&&(v+=parseInt(getComputedStyle(I).getPropertyValue("padding-left"),10));const j=T.getBoundingClientRect(),D={top:y?T.offsetTop-k.offsetTop+11:12,left:T.offsetLeft-1+v,width:y?k.clientWidth-.2:j.width+1,height:y?j.height+X4:k.clientHeight};if(l(D),d.current=D,b){const M=K.blocks[n],U=(R=M==null?void 0:M.data.format)!=null?R:{},V=((A=U.tableBlockColumnOrder)!=null?A:[]).map(z=>{var Q,Z,te;return(te=(Z=(Q=U.tableBlockColumnFormat)==null?void 0:Q[z])==null?void 0:Z.width)!=null?te:b0});let W=((L=V[0])!=null?L:0)+_+9;f.current=V.map((z,Q)=>(Q&&(W+=z),W))}if(y){const M=k.querySelectorAll("tr"),U=Array.from(M).map(W=>{const{height:z}=W.getBoundingClientRect();return z});let V=((P=U[0])!=null?P:0)+e1;f.current=U.map((W,z)=>(z&&(V+=W),V))}},[t,y,b,n,_]);F.useEffect(()=>{E()},[E,c,a,o,u]),F.useEffect(()=>{const k=I=>{I.target.closest(".table-handle")&&(p.current={initX:I.pageX,initY:I.pageY})},C=()=>{var L;p.current=void 0,document.onselectstart=function(){return!0};const I=()=>{h.current=void 0,ee(Qn.update({draggingStart:void 0,dropInfo:void 0}))},{blocks:j,simpleTable:D}=K,{chosenCells:S,dropInfo:R}=D;if(!S||n!==S.tableId)return;const A=j[n];if(A&&R){if(uf(a)&&!hc(R.recordId)&&a!==R.recordId){const P=A.subNodes.findIndex(W=>W===a);if(s.some(W=>W[0][0]<=P&&P<=W[1][0]&&W[0][0]!==W[1][0])){ye.warning("有合并的单元格不支持移动"),I();return}const U=h.current,V={parentId:n};U==="top"&&(V.before=R.recordId),U==="bottom"&&(V.after=R.recordId),g(()=>{Ri([a],V)})}if(uf(o)&&!hc(R.propertyId)){const{format:P}=A.data,M=(L=P==null?void 0:P.tableBlockColumnOrder)!=null?L:[];if(o!==R.propertyId){const U=M.findIndex(Z=>Z===o);if(s.some(Z=>Z[0][1]<=U&&U<=Z[1][1]&&Z[0][1]!==Z[1][1])){ye.warning("有合并的单元格不支持移动"),I();return}const W=M.filter(Z=>Z!==o),z=h.current,Q=W.indexOf(R.propertyId);z==="left"&&W.splice(Q,0,o),z==="right"&&W.splice(Q+1,0,o),g(()=>{pe(n,{data:{format:{tableBlockColumnOrder:W}}})})}}}I()},v=fs(I=>{var Q,Z;if(!o&&!a||!p.current)return;(Math.abs(I.pageX-p.current.initX)>5||Math.abs(I.pageY-p.current.initY)>5)&&ee(Qn.update({draggingStart:p.current}));const{chosenCells:j,draggingStart:D}=K.simpleTable;if(!j||!D||n!==j.tableId)return;const{x:S,y:R}=I,{initX:A=-999,initY:L=-999}=D,{top:P=0,left:M=0,right:U=0,bottom:V=0,height:W=0,width:z=0}=(Z=(Q=t.current)==null?void 0:Q.getBoundingClientRect())!=null?Z:{};uf(j.recordId)&&(h.current=L>R?"top":"bottom",l(te=>{const re=R-P-te.height/2+e1;return R>V-te.height?{...te,top:Math.min(re,W-te.height+e1)}:{...te,top:Math.max(re,e1)}})),uf(j.propertyId)&&(h.current=A>S?"left":"right",l(te=>{const re=S-M+x-te.width/2;return S>U-te.width?{...te,left:Math.min(re,z+x-te.width)}:{...te,left:Math.max(re,x)}})),Math.abs(S-A)<20&&Math.abs(R-L)<15&&(h.current=void 0)},16);return document.addEventListener("mousedown",k,!0),document.addEventListener("mousemove",v),document.addEventListener("mouseup",C,!0),()=>{document.removeEventListener("mousedown",k,!0),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",C,!0)}},[x,s,E,u,o,a,n,t,g]),F.useEffect(()=>{var S,R,A;const k=h.current;if(!k){ee(Qn.update({dropInfo:void 0}));return}const{draggingStart:C,chosenCells:T,dropInfo:v}=K.simpleTable;if(!u||!C||!T)return;const{tableId:I}=T,j=K.blocks[I];if(!j)return;let D=-1;if(y){const{top:L}=i;f.current.some((U,V)=>(k==="top"?L<U:L+i.height-X4<=U)?(D=V,!0):!1);const P=j.subNodes.indexOf((S=v==null?void 0:v.recordId)!=null?S:"");s.some(U=>{const V=U[0][0],W=U[1][0],z=k==="top"?V<D:V<=D,Q=k==="top"?D<=W:D<W;return z&&Q})?ee(Qn.update({activityTableId:I,dropInfo:void 0})):(P!==D||(v==null?void 0:v.position)!==k)&&ee(Qn.update({activityTableId:I,dropInfo:{propertyId:void 0,recordId:j.subNodes[D],position:k}}))}if(b){const{left:L}=i;f.current.some((W,z)=>(k==="left"?L<W:L+i.width<=W)?(D=z,!0):!1);const{format:P}=j.data,M=(R=P==null?void 0:P.tableBlockColumnOrder)!=null?R:[],U=M.indexOf((A=v==null?void 0:v.propertyId)!=null?A:"");s.some(W=>{const z=W[0][1],Q=W[1][1],Z=k==="left"?z<D:z<=D,te=k==="left"?D<=Q:D<Q;return Z&&te})?ee(Qn.update({activityTableId:I,dropInfo:void 0})):(U!==D||(v==null?void 0:v.position)!==k)&&ee(Qn.update({activityTableId:I,dropInfo:{propertyId:M[D],recordId:void 0,position:k}}))}},[u,i,n,s,y,b]);const w=F.useMemo(()=>{var T,v;if(!u)return"";let k="";const C=(T=t.current)==null?void 0:T.cloneNode(!0);if(C){const I=document.createElement("div");I.appendChild(C);const j=(v=I.firstElementChild)==null?void 0:v.querySelectorAll(".shadow-button");j==null||j.forEach(D=>D.remove()),k+=I.innerHTML}return k},[u,t]);return!a&&!o?null:r.jsxs("div",{className:B("absolute pointer-events-none border",u?"border-none":"border-black dark:border-grey3"),style:i,children:[u&&r.jsx("div",{className:B("absolute z-10 table-handle shadow-button bg-black dark:bg-grey3",y?"top-1/2 -left-[9px] -mt-[13px]":"-top-[13px] left-1/2 -ml-2 rotate-90"),children:r.jsx(H,{name:"IcBlockHandle",className:"text-white",size:"xsmall"})}),w&&r.jsx("div",{className:"overflow-hidden border border-black dark:border-grey3 shadow-md",style:{width:d.current.width,height:d.current.height,backgroundColor:"var(--grey9)"},children:r.jsx("div",{style:{transform:`translateX(-${y?2:d.current.left-_-10}px) translateY(-${y?d.current.top-10:2}px)`},dangerouslySetInnerHTML:{__html:w}})})]})},Bhe=({id:e,root:t})=>{const n=F.useRef(null),s=Ve(e),a=ae(({simpleTable:h})=>!!h.draggingStart),o=ae(({simpleTable:h})=>!!h.draggingBarType),i=F.useRef(null),l=oP(e);a_(i),BB(e),F.useEffect(()=>{const h=document.getElementById("root");a?h==null||h.classList.add("dragging"):h==null||h.classList.remove("dragging")},[a]);const c=aP(e),u=F.useMemo(()=>({tableRef:n,tableId:e,indexRanges:c}),[e,c]),{wait:d,waitMode:f}=ae(({simpleTable:h})=>{const{activityTableId:p}=h;return p===e||l?{wait:50,waitMode:"throttle"}:{wait:500,waitMode:"debounce"}});return r.jsx(ln,{id:e,horizontal:t,children:r.jsxs(Hm,{wait:d,waitMode:f,children:[r.jsxs("div",{className:B("overflow-x-auto overflow-y-hidden relative",t&&"-ml-[104px] pl-24 sm:-ml-12 sm:pl-12"),ref:i,onScroll:()=>In.emit("removeHoverMenu"),children:[r.jsx(Dhe,{...u}),!s&&r.jsxs(r.Fragment,{children:[r.jsx(Ahe,{root:t,...u}),r.jsx(vhe,{...u}),!a&&r.jsxs(r.Fragment,{children:[r.jsx(Pb,{type:"row",...u}),r.jsx(Pb,{type:"column",...u}),r.jsx(Pb,{type:"corner",...u})]})]})]}),!s&&!o&&r.jsx(She,{...u})]})})},Lhe=({id:e,root:t,children:n})=>{const[s,a]=cu(e),o=AB(e),i=_e(e,["subNodes","data"],["segments"]),l=eh(),c=me(),u=e_(),d=Array.isArray(n)&&n.length>0,f=Ve(e),h=fr(),p=dr(qe);if(!i||pt.print)return null;const g=(b=!s)=>a(b,!1),_=b=>{c.dropdown({popcorn:b.currentTarget,content:({onCloseModal:E})=>r.jsx(yL,{items:[zk],blockId:e,onCloseModal:E,disabledHasRecently:!0,onColorSelect:w=>{ce.event("tempbutton_changecolor",{color:w.desc})}})})},x=async b=>{var I,j;if(b.stopPropagation(),!i.subNodes.length||f)return;const E=K.blocks[i.parentId],w=(I=E==null?void 0:E.subNodes.findIndex(D=>D===e))!=null?I:0,k=E==null?void 0:E.subNodes[w-1],C=pn(E==null?void 0:E.subNodes)===e&&Sa(E==null?void 0:E.subNodes)!==e&&k,v=(j=(await l(i.subNodes,{after:C?k:e,prefixName:!1}))[0])==null?void 0:j.block;v&&h(v.uuid,de(v.data.segments).length),ce.event("click_tempbutton")},y=b=>{b.stopPropagation();const E=Qe({type:m.BlockType.TEXTAREA},{parentId:e});h(E,0)};return r.jsxs(ln,{id:e,className:"my-px",horizontal:t,children:[r.jsxs("div",{className:B("block-has-icon-container h-9 animate-hover items-center px-0.5 group pr-2",f?"cursor-default":""),onClick:x,children:[r.jsx(t_,{className:"mr-1.5",children:r.jsx(H,{size:"middle",name:"IcAddBoard"})}),r.jsx("span",{className:"text-ellipsis w-full text-t1 pr-1",children:r.jsx(co,{uuid:p,className:"text-ellipsis",segments:i.data.segments,readonly:!0,placeholder:"请填写模板按钮名称"})}),!f&&r.jsxs("span",{className:"flex items-center group-hover:opacity-100 opacity-0 transition-opacity",onClick:b=>b.stopPropagation(),children:[r.jsx(Fe,{popup:"编辑",className:"animate-hover",onClick:()=>g(!0),children:r.jsx(H,{name:"MIcListSeetings",size:"middle"})}),r.jsx(Fe,{popup:"菜单",className:"ml-2 animate-hover text-grey3",onClick:b=>{u({blockId:e,offset:[8,0],blockNode:b.currentTarget})},children:r.jsx(H,{name:"IcMore",size:"middle"})})]})]}),s&&r.jsxs("div",{className:"border border-grey6 rounded text-t2 bg-white1",children:[r.jsxs("div",{className:"h-12 flex items-center justify-between px-3 text-black",children:[r.jsx("span",{children:"编辑模板按钮"}),r.jsx(je,{className:"text-t2-medium",colorType:"active",onClick:()=>g(),children:"关闭"})]}),r.jsx(Rr,{className:"my-2.5"}),r.jsxs("div",{children:[r.jsxs("div",{className:"h-12 px-3 text-grey3 flex items-center justify-between",children:[r.jsx("span",{children:"模板按钮名称"}),r.jsxs("span",{className:"flex items-center cursor-pointer",onClick:_,children:[r.jsx(H,{name:"IcMenuColor",size:"middle",className:"mr-1"}),"颜色"]})]}),r.jsx("div",{className:"mx-3 bg-grey8 rounded flex items-center py-1.5",children:r.jsx(Mo,{uuid:e,toolbar:!1,comments:!1,className:"break-normal overflow-y-auto cursor-text px-2 w-full min-h-[24px]",placeholder:"请填写模板按钮名称",keydownOption:fQ,onKeyDown:b=>{be("mod+a")(b)&&o(b.nativeEvent)}})}),r.jsx(Rr,{className:"my-2.5"}),r.jsx("div",{className:"h-12 px-3 text-grey3 flex items-center",children:"模板内容"}),r.jsx("div",{className:"px-3 pb-5",children:r.jsx("div",{className:"bg-grey8 rounded p-1.5 text-black",children:d?n:r.jsx(ln,{dropInChild:!0,bindId:!1,id:e,children:r.jsx("div",{className:"flex items-center text-black",onClick:y,children:"创建文字或’/‘命令，也可以拖拽块至此处"})})})})]})]})]})},Phe=({id:e,children:t,root:n})=>{const s=_e(e,["data"],["segments"]),a=Qd(),{alwaysShowPlaceHolder:o,placeHolder:i}=Cm(e,{defaultPlaceholder:a?"按空格使用 AI，输入文字或 '/' 命令":"输入文字或 '/' 命令"}),l=F.useRef(null),c=Ve(e);if(!s)return null;const u=xc(s.data);return r.jsxs(ln,{id:e,horizontal:n,className:"my-px",children:[r.jsxs("div",{ref:l,className:"px-0.5 py-1 text-t1 group",children:[r.jsx(Mo,{alwaysShowPlaceholder:o,uuid:e,placeholder:i}),u&&!c&&n&&r.jsx(Ohe,{uuid:e})]}),t&&r.jsx(Ni,{blockId:e,children:t})]})},Ohe=F.memo(({uuid:e})=>{const t=ke(),n=$k(),s=Cr(),a=Wc(),o=Xr(),i=xn(),l=F.useMemo(()=>{const u=uF();return[u.basicBlock.todo,u.basicBlock.h1,u.basicBlock.h2,u.basicBlock.h3,u.basicBlock.h4,u.basicBlock.list,u.basicBlock.orderList,u.basicBlock.foldList,u.basicBlock.quote,u.basicBlock.mark].map(d=>d.data)},[]),c=F.useCallback(u=>{const{type:d,params:f={},title:h}=u;t(()=>{ce.event("block_fastchoose",{block_name:h,block_type:d}),_s([e],{type:d,...f,data:{...f.data}});const p=i(e,!1);p==null||p.requestFocus()})},[i,t,e]);return a||o||s?null:r.jsx("div",{className:B("absolute top-2 transition-opacity flex items-center flex-shrink-0 opacity-0 group-hover:opacity-60",n?"left-64":"right-0"),children:l.map(u=>r.jsx(Fe,{onClick:()=>c(u),className:"ml-1 cursor-pointer",popup:u.title,children:r.jsx(H,{size:"large",name:u.icon})},u.title))})}),Mhe=({id:e,root:t,children:n})=>{const[s=!0]=cu(e),a=_e(e,["data"],["checked"]),o=ke(),i=Ve(e);if(!a)return null;const{checked:l}=a.data,c=pt.print||s;return r.jsxs("div",{className:"relative",children:[r.jsx(HC,{id:e}),r.jsxs(ln,{id:e,horizontal:t,className:"my-px relative",children:[r.jsxs("div",{className:"block-has-icon-container",children:[r.jsx(t_,{className:"block-before-icon-mt",children:r.jsx(Ra,{size:"large",checked:l,onClick:u=>{i||(u.stopPropagation(),o(()=>{ck({data:{checked:!l}},e)}))}})}),r.jsx(Mo,{uuid:e,className:B("flex-1 w-0 mr-4",l?"opacity-50":"no-underline",{"line-through":l}),placeholder:"待办列表"})]}),n&&c&&r.jsx(Ni,{blockId:e,children:n})]})]})},Uhe="54px",Vhe="50px",qhe="36px",Hhe="32px",$he=({id:e,root:t,children:n})=>{const{expand:s,toggle:a}=$C(e),o=_e(e,["data","subNodes"]),i=fr(),l=ke();if(!o)return null;const c=h=>{h.stopPropagation(),l(()=>{const p=Qe({},{parentId:o.uuid,after:o.uuid});i(p,0)})},{level:u=1}=o.data,d=pt.print||s;let f=Uhe;switch(u){case 2:f=Vhe;break;case 3:f=qhe;break;case 4:f=Hhe;break}return r.jsxs(ln,{id:e,className:"my-px",horizontal:t,children:[r.jsxs("div",{className:"block-has-icon-container ignore-focus-click flex-1 overflow-hidden",style:{lineHeight:f},children:[r.jsx(t_,{"data-no-cancel-selected":!0,className:B({"mt-4":u===1,"mt-3.5":u===2,"mt-1.5":u===3,"mt-1":u===4}),children:r.jsx("span",{className:"flex animate-hover",children:r.jsx(H,{size:"large",name:"IcToggleBlack",onClick:a,className:B("transition duration-150 cursor-pointer",{"rotate-90":d,"opacity-30":o.subNodes.length===0})})})}),r.jsx(Mo,{className:B("self-start mr-4 flex-1 w-0",{"text-h1 py-1.5":u===1,"text-h2 py-2":u===2,"text-h3 py-0.5":u===3,"text-h4 py-0.5":u===4}),uuid:e,placeholder:`折叠标题${u}`})]}),d&&r.jsx(Ni,{blockId:e,children:o.subNodes.length?n:ht()?null:r.jsx("div",{className:"flex items-center w-full animate-hover cursor-pointer h-9 text-t2 p-1 my-px text-grey3 print:hidden",onClick:c,children:"内容为空，点击编辑"})})]})};Mn(m.BlockType.FILE,B3);Mn(m.BlockType.FOLD_LIST,rhe);Mn(m.BlockType.TOGGLE_HEADER,$he);Mn(m.BlockType.TEMPLATE,Lhe);Mn(m.BlockType.HEADER,uhe);Mn(m.BlockType.IMAGE,VC);Mn(m.BlockType.COLUMN_LIST,_me);Mn(m.BlockType.COLUMN,pme);Mn(m.BlockType.MARK,mse);Mn(m.BlockType.ORDER_LIST,dhe);Mn(m.BlockType.REFERENCE_COLLECTION_PAGE,u_);Mn(m.BlockType.COLLECTION_VIEW_PAGE,u_);Mn(m.BlockType.PAGE,u_);Mn(m.BlockType.COLLECTION_VIEW,b5);Mn(m.BlockType.REFERENCE_COLLECTION,b5);Mn(m.BlockType.QUOTE,fhe);Mn(m.BlockType.TEXTAREA,Phe);Mn(m.BlockType.DIVIDER,xme);Mn(m.BlockType.TODO,Mhe);Mn(m.BlockType.LIST,fse);Mn(m.BlockType.FOLDER,kE);Mn(m.BlockType.REFERENCE,mhe);Mn(m.BlockType.BOOKMARK,Xle);Mn(m.BlockType.EMBED,Fme);Mn(m.BlockType.EQUATION,zme);Mn(m.BlockType.CODE,mme);Mn(m.BlockType.EXTERNAL_FILE,B3);Mn(m.BlockType.TABLE,Bhe);Mn(m.BlockType.SYNC_CONTAINER,v5);Mn(m.BlockType.SYNC_REFERENCE,whe);Mn(m.BlockType.MIND_MAPPING_PAGE,u_);Mn(m.BlockType.MIND_MAPPING,$me);const N5=()=>{const{getState:e,dispatch:t}=Kr(),n=ke(),s=(a,o=m.CollectionViewType.TABLE)=>{n(()=>{const i=qe(),l=qe(),c=qe(),u=o===m.CollectionViewType.TIMELINE,d=o===m.CollectionViewType.CALENDAR,f=o===m.CollectionViewType.FORM,h=UF(),p=e().blocks[a];if(!p)return;p.subNodes.forEach(E=>{ha(E)});const g=[],_={title:{name:"标题",type:m.CollectionSchemaType.TITLE},[i]:{name:"分类",type:m.CollectionSchemaType.SELECT,options:h}};g.push({property:"title",visible:!0},{property:i,visible:!0}),(u||d)&&(_[l]={name:"开始时间",type:m.CollectionSchemaType.DATE},_[c]={name:"结束时间",type:m.CollectionSchemaType.DATE},g.push({property:l,visible:!0},{property:c,visible:!0})),pe(a,{type:m.BlockType.COLLECTION_VIEW_PAGE,local:!0,data:{schema:_,collectionPageProperties:g}});let x=[];!d&&!f&&(x=[5,3,1].map(E=>{const w={[i]:[]};if(u){const k=new Date(Date.now()-E*En);w[l]=[Fn({from:k})],w[c]=[Fn({from:new Date(k.getTime()+5*En)})]}return Qe({type:m.BlockType.PAGE,data:{segments:[],collectionProperties:w}},{parentId:a},!1,!0)}));const y=[{property:"title",visible:!0},{property:i,visible:o===m.CollectionViewType.TABLE}];(u||d)&&y.push({property:l,visible:!1},{property:c,visible:!1});let b={};switch(o){case m.CollectionViewType.TABLE:b=Rc({tableProperties:y});break;case m.CollectionViewType.BOARD:b=hm({groupProperty:i,boardProperties:y,options:h});break;case m.CollectionViewType.GALLERY:b=VF({galleryProperties:y});break;case m.CollectionViewType.LIST:b=qF({listProperties:y});break;case m.CollectionViewType.TIMELINE:b=pm({timelineProperties:y,timelineBy:l,timelineByEnd:c});break;case m.CollectionViewType.CALENDAR:b=gm({calendarProperties:y,calendarBy:l,calendarByEnd:c});break;case m.CollectionViewType.FORM:b=TC({formProperties:y});break}Ka({title:"默认视图",format:b,pageSort:x,type:o},{parentId:a}),f&&Ka({title:"表格",format:Rc({tableProperties:y}),pageSort:[],type:m.CollectionViewType.TABLE},{parentId:a}),t(ED())})};return F.useCallback(s,[t,e,n])},Op=new Map,I5=async(e,t={})=>{const{taskId:n}=await Ce.infra.enqueueTask(e);return Op.set(n,t),j5(),n};let Ob=null;const j5=()=>{Op.size&&(Ob&&clearTimeout(Ob),Ob=setTimeout(async()=>{const{results:e}=await Ce.infra.getTasks({taskIds:[...Op.keys()]});Object.values(e).forEach(Ghe),j5()},2e3))},Ghe=e=>{var a,o;const{status:t,taskId:n,result:s}=e;if(t==="success"){if(ye.closeMessage(n),s){const{status:i,msg:l,...c}=s,u=Op.get(n);i==="success"?(a=u==null?void 0:u.success)==null||a.call(u,c):l&&((o=u==null?void 0:u.fail)==null||o.call(u,c),ye.error(l))}Op.delete(n)}},D5={[m.ImportType.MARKDOWN]:{icon:"MIcImportMarkdown",title:"Markdown",description:"支持 ZIP RAR",accept:".md,.zip,.rar"},[m.ImportType.CSV]:{icon:"MIcImportCsv",title:"CSV",description:"",accept:".csv"},[m.ImportType.HTML]:{icon:"MIcImportHtml",title:"HTML",description:"",accept:".html,.zip,.rar"},[m.ImportType.WORD]:{icon:"MIcImportWord",title:"Word",description:"支持 DOCX",accept:".docx,.zip,.rar"},[m.ImportType.NOTION]:{icon:"MIcImportNotion",title:"Notion",description:"上传从 Notion 导出的压缩包",accept:".zip",help:An.importFromNotion}},S5=({from:e,pageId:t})=>r.jsxs("div",{className:"w-[560px] p-8 ",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("div",{className:"text-h2",children:"导入"}),r.jsxs("a",{target:"_blank",href:An.howToImport,className:"flex items-center text-grey4 animate-click",children:[r.jsx(H,{size:"small",name:"IcInviteHelp",className:"mr-1.5"}),r.jsx("div",{className:"text-t2 text-grey4",children:"如何导入"})]})]}),r.jsx("div",{className:"grid grid-cols-2 gap-5",children:Object.keys(D5).map(n=>r.jsx(zhe,{fileType:n,from:e,pageId:t},n))})]}),zhe=({fileType:e,from:t,pageId:n})=>{const s=NF(),a=Hd(),o=La(),i=Ma(),l=Gk(),c=Ft(),[u,d]=F.useState(""),f=Un(),h=D5[e];if(!h)return null;const p=g=>{const _=g.target.files;if(!_||_.length===0)return;const x=_[0];if(!x)return;const y=t==="page"?"empty_import":"import";ce.event(y,{file_type:e}),d("正在上传... (0%)"),i({file:x,type:"temp",onProgress(b){d(b===100?"正在导入，请稍候...":`正在上传... (${b}%)`)},onComplete(b){if(!b.success){d("");return}const{ossName:E}=b;if(E){let w=n||Kc();if(t==="button"&&(w=a(m.BlockType.PAGE,{parentId:c.uuid},cs.PRIVATE)),!w){ye.error("导入失败，请重试");return}oa(()=>I5({eventName:"import",request:{blockId:w,spaceId:c.uuid,importOptions:{type:e,ossName:E}}},{success:async({uuid:k})=>{k&&o(k,{force:!0}),await s(Ae.STANDING_IMPORT),d(""),l(),t==="button"&&f.push(`/${w}`)},fail(){t==="button"&&w&&ha(w),d("")}}))}}})};return r.jsxs(r.Fragment,{children:[!!u&&r.jsx(tS,{title:u}),r.jsxs("label",{className:"border-grey5 animate-hover animate-click flex h-[70px] items-center rounded-md border px-4 shadow-sm",children:[r.jsx("input",{type:"file",accept:h.accept,className:"hidden",onChange:p}),r.jsx(H,{name:h.icon,size:"xxxlarge"}),r.jsxs("div",{className:"ml-2.5",children:[r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"font-h3 font-semibold",children:h.title}),h.help&&r.jsx("a",{target:"_blank",href:h.help,className:"animate-click",children:r.jsx(H,{size:"small",name:"IcInviteHelp",className:"text-grey3 ml-2"})})]}),!!h.description&&r.jsx("div",{className:"text-t4 text-grey3",children:h.description})]})]})]})};let R5;const Whe=e=>{R5=e},Khe=({closeSelf:e,type:t})=>{var d,f;const[n,s]=F.useState((d=t1[0])==null?void 0:d.type),a=me(),o=ks(),i=lh(),l=Hd(),c=Un(),u=()=>{const h=t1.find(_=>_.type===n);if(!h){e();return}const p=[];t===cs.PRIVATE&&p.push({role:m.PermissionRole.EDITOR,type:m.PermissionType.USER,userId:Vx().uuid}),t===cs.SPACE&&p.push({role:m.PermissionRole.EDITOR,type:m.PermissionType.SPACE});let g="";switch(n){case"template":{g=l(m.BlockType.PAGE,{parentId:Ut(),first:!0},t),g&&c.push(`/${g}`),o(Ae.CREATE_NEW_PAGE,We.basicList,{isFirstTask:!0}),a.modal({modalId:Xe.TEMPLATE_CENTER,content:()=>r.jsx(R5,{from:"page"})}),e();return}case"import":{g=l(m.BlockType.PAGE,{parentId:Ut(),first:!0},t),g&&c.push(`/${g}`),o(Ae.CREATE_NEW_PAGE,We.basicList,{isFirstTask:!0}),a.modal({content:()=>r.jsx(S5,{pageId:g,from:"page"})}),e();return}case"table":case"board":case"gallery":case"list":case"timeline":case"calendar":case"form":{Di(()=>{g=Qe({type:m.BlockType.COLLECTION_VIEW_PAGE,permissions:p},{parentId:Ut(),first:!0},!1,!0),Lh(g,h.viewType)}),o(Ae.CREATE_NEW_PAGE,We.basicList,{isFirstTask:n==="list"||n==="board"||n==="gallery"}),n==="table"?o(Ae.CREATE_BITABLE_EXPLORE,We.basicList,{isFirstTask:!0}):h.taskId&&o(h.taskId,We.basicList,{isFirstTask:!0});break}case"folder":{g=l(m.BlockType.FOLDER,{parentId:Ut(),first:!0},t),o(Ae.CREATE_NEW_PAGE,We.basicList,{isFirstTask:!0});break}case"mindmap":{Di(()=>{g=l(m.BlockType.MIND_MAPPING_PAGE,{parentId:Ut(),first:!0},t),g&&(i({parentId:g,last:!0},g),i({parentId:g,last:!0},g),i({parentId:g,last:!0},g))}),o(Ae.CREATE_NEW_PAGE,We.basicList,{isFirstTask:!0});break}case"doc":{g=l(m.BlockType.PAGE,{parentId:Ut(),first:!0},t),o(Ae.CREATE_NEW_PAGE,We.basicList,{isFirstTask:!0});break}}g&&c.push(`/${g}`),e()};return r.jsxs("div",{className:"next-modal w-[960px]",children:[r.jsx("div",{className:"flex items-center h-[80px] pl-[30px] border-b",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h2",{className:"text-t1-medium flex items-center",children:"页面类型"}),r.jsx("p",{className:"text-t2 text-grey3 mt-0.5",children:"首次创建页面得 ⭐️+5 可累积抵现兑会员"})]})}),r.jsxs("div",{className:"py-2.5 min-h-[440px] flex ",children:[r.jsx("div",{className:"w-[240px]",children:t1.map(h=>{const{title:p,icon:g,type:_}=h;return r.jsx("div",{className:"px-2 h-10",children:r.jsxs("div",{onClick:()=>s(_),className:B("flex items-center h-full rounded animate-hover-black3 pl-[42px] relative",n===_&&"bg-black_006"),children:[r.jsx(H,{name:g,size:"middle",className:"absolute left-5 top-2.5"}),r.jsx("span",{className:"text-t2-medium text-grey2",children:p})]})},p)})}),r.jsxs("div",{className:"pt-4 px-[60px]",children:[r.jsx("img",{src:`https://cdn.allflow.cn/activity/page/${(f=t1.find(h=>h.type===n))==null?void 0:f.type}.png`,className:"w-[600px] h-[338px] border rounded-md"}),r.jsx("div",{className:"flex items-center mt-4",children:r.jsx(je,{colorType:"active",onClick:u,children:"创建"})})]})]})]})},xxe=()=>{const e=me();return F.useCallback(t=>{e.modal({content:({onCloseModal:n})=>r.jsx(Khe,{closeSelf:n,type:t})})},[e])},t1=[{icon:"IcPageNew",title:"页面",type:"doc",btn:""},{icon:"IcMindmapNew",title:"思维导图",type:"mindmap",btn:""},{icon:"IcFolderNew",title:"文件夹",type:"folder",btn:""},{icon:"MIcNaviImport",title:"导入",type:"import",btn:""},{icon:"IcTableNew",title:"表格",viewType:m.CollectionViewType.TABLE,taskId:Ae.CREATE_BITABLE_EXPLORE,type:"table",btn:""},{icon:"IcBoardNew",title:"看板",viewType:m.CollectionViewType.BOARD,type:"board",btn:""},{icon:"IcGalleryNew",title:"画廊",viewType:m.CollectionViewType.GALLERY,type:"gallery",btn:""},{icon:"IcListNew",title:"目录",viewType:m.CollectionViewType.LIST,type:"list",btn:""},{icon:"IcTimelineNew",title:"时间轴",viewType:m.CollectionViewType.TIMELINE,taskId:Ae.CREATE_TIMELINE_VIEW,type:"timeline",btn:""},{icon:"IcCalendarNew",title:"日历",viewType:m.CollectionViewType.CALENDAR,taskId:Ae.CREATE_CALENDAR_VIEW,type:"calendar",btn:""},{icon:"IcFormNew",title:"收集表",viewType:m.CollectionViewType.FORM,taskId:Ae.CREATE_FORM_VIEW,type:"form",btn:""},{icon:"MIcListTemplate",title:"模板库",type:"template",btn:""}],A5=()=>{const e=ae(a=>{var i,l;const o=(i=a.spaceViews[a.user.currentSpaceViewId])==null?void 0:i.spaceId;if(o)return(l=a.spaces[o])==null?void 0:l.customTemplates}),t={name:"我创建的",templates:[]},n={name:"分享给我的",templates:[]};return e==null||e.forEach(a=>{var c;const o=B5(a);if(!o)return;const i=K.blocks[a];let l;((i==null?void 0:i.type)===m.BlockType.REFERENCE_COLLECTION||(i==null?void 0:i.type)===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(l=Vd(a)),i&&(((c=l==null?void 0:l.data.createdTemplateBy)!=null?c:i.data.createdTemplateBy)===K.user.uuid?t.templates.push(o):n.templates.push(o))}),{name:"我的模板",subGroups:[t,n]}},B5=e=>{var a,o,i;if(uC(e))return;const t=K.blocks[e];let n;return((t==null?void 0:t.type)===m.BlockType.REFERENCE_COLLECTION||(t==null?void 0:t.type)===m.BlockType.REFERENCE_COLLECTION_PAGE)&&(n=Vd(e)),t?{id:e,pageId:e,name:de((a=n==null?void 0:n.data.segments)!=null?a:t.data.segments)||Ot((n==null?void 0:n.type)||t.type),source:"",icon:(o=n==null?void 0:n.data.icon)!=null?o:t.data.icon,desc:"",image:Dn.templateEmpty,isCustom:!0,userId:(i=n==null?void 0:n.data.createdTemplateBy)!=null?i:t.data.createdTemplateBy}:void 0},Yhe=e=>{const{keyword:t,currentCategory:n}=e,s=F.useRef(null),[a,o]=F.useState(""),i=sa(ry);F.useEffect(()=>{i({}),o("")},[n,i]);const l=F.useCallback(fs(async d=>{try{const{uuid:f}=Tn();if(!d.trim()){i({});return}const h=await Ce.editor.searchTemplates(d,f),{recommendResult:p=[],recordMap:g,searchResult:_,hasSearchResult:x}=h;ee(Gn.update({blocks:g.blocks}));let y=[];if(x){const{my:b=[],official:E=[]}=_!=null?_:{},w=b.map(C=>B5(C)).filter(C=>!!C),k=E.map(C=>D0(C)).filter(C=>!!C);y=w.concat(k)}else y=p.map(b=>D0(b)).filter(b=>!!b);i({hasResult:x,keyword:d.trim(),templates:y})}catch(f){}},1e3),[]),c=F.useCallback(d=>{o(d),l(d)},[l]);F.useEffect(()=>{t&&c(t)},[c,t]);const u=()=>{c(""),s.current&&s.current.focus()};return r.jsxs("div",{className:"border-b h-[60px] flex flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center w-[240px] pl-[30px]",children:[r.jsx("img",{src:Dn.templateTitle,className:"w-6 h-6",alt:"模板icon"}),r.jsx("h2",{className:"text-t1-medium text-grey2 ml-2 flex items-center",children:"模板库"})]}),r.jsx("div",{className:"px-[30px] flex items-center justify-between",children:r.jsxs("div",{className:"relative",children:[r.jsx(xt,{className:"h-8 pl-10 pr-5 rounded-sm",inputClassName:"pl-0",placeholder:"搜索模板",inputRef:s,value:a,onChange:c}),r.jsx(H,{className:"absolute left-3 top-1.5 text-xl text-grey4 leading-none",name:"IcTitleSearch"}),a&&r.jsx(H,{name:"IcUploadCancel",onClick:u,className:"absolute right-0 top-1.5 text-grey4 mr-2 w-[18px] h-[18px]"})]})})]})},Xhe=e=>{const{officialTemplates:t,currentCategory:n,setCurrentCategory:s}=e,a=sa(ry);return r.jsxs("div",{className:"w-[240px] bg-white2 border-r flex-shrink-0",children:[r.jsxs("div",{className:"w-full overflow-auto relative h-[calc(100%-50px)]",children:[r.jsx("div",{className:"text-t2-medium py-[5px]",children:r.jsx("div",{onClick:()=>{s("myTemplate"),ce.event("template_category",{category_id:"我的模板"}),a({})},className:B("h-10 flex items-center cursor-pointer hover:bg-black_003 rounded pl-[30px] mx-2",n==="myTemplate"&&"bg-black_006"),children:"我的模板"})}),r.jsx("div",{className:"bg-grey6 h-px my-1 mx-2"}),r.jsx("div",{children:t.map(o=>r.jsx(Qhe,{first:o,changeCategory:i=>{s(i),a({})},currentCategory:n},o.name))})]}),r.jsxs("div",{className:"hover:normal-bg w-full cursor-pointer rounded-bl",onClick:()=>window.open(An.templateContribution),children:[r.jsx("div",{className:"h-px bg-grey6 w-full"}),r.jsxs("div",{className:"ml-4 flex items-center",children:[r.jsx("img",{src:Dn.submit,className:"w-5 h-5"}),r.jsx("div",{className:"text-t2-medium h-[50px] flex items-center ml-2",children:"投稿你的模板"})]})]})]})},Q4=5,Qhe=({first:e,changeCategory:t,currentCategory:n})=>{const[s,a]=F.useState(!1),{name:o,subGroups:i}=e;return i?r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h2",{className:"text-t2-medium h-[50px] flex items-center pl-[30px]",children:o}),(s?i:i.slice(0,Q4)).map(l=>{var u,d;if(((u=l.templates)==null?void 0:u.length)===0&&((d=l.subGroups)==null?void 0:d.length)===0)return null;const c=`${o}/${l.name}`;return r.jsx("button",{onClick:()=>{t(c),ce.event("template_category",{category_id:l.name})},className:B("h-10 flex items-center text-t2-medium text-grey2 mx-2 pl-[42px] cursor-pointer rounded hover:bg-black_003",n===c&&"bg-black_006"),children:l.name},c)}),i.length>Q4&&r.jsx("button",{className:"text-t2 text-grey3 mx-2 pl-[42px] animate-hover h-10 flex items-center",onClick:()=>a(!s),children:s?"收起":"显示更多"})]},o):null},Jhe=({category:e,onPreviewOpen:t})=>{var s,a;const n=((s=e==null?void 0:e.templates)!=null?s:[]).length>0;return r.jsxs("div",{children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t1 mt-9 mb-2.5",children:e.name}),r.jsx("div",{className:"bg-grey6 w-full h-px mb-[14px]"})]}),r.jsxs("div",{className:"w-full pb-9 pt-5 grid gap-4",style:{gridTemplateColumns:"repeat(auto-fill, 360px)"},children:[(a=e.templates)==null?void 0:a.map(o=>r.jsx(Yh,{template:o,onPreviewOpen:t},o.pageId)),!n&&r.jsx(Zhe,{})]})]})},Zhe=()=>r.jsxs("div",{className:"px-[30px] relative",children:[r.jsx("div",{style:{fontSize:"60px"},children:"☕️"}),r.jsx("div",{className:"absolute bottom-[-12px] text-grey4 text-t2",children:"暂无模板"})]}),epe=e=>r.jsxs("div",{className:e.className,children:[r.jsx("div",{className:"text-h2",children:"使用模板，高效创作"}),r.jsx("div",{className:"text-grey3 text-t2 mt-2.5",children:"将经常使用的页面转换为模板，避免重复编辑。你还可以分享给团队成员，提高团队效率。"}),r.jsx("div",{className:"w-full max-w-4xl",children:r.jsx("img",{src:Dn.templatesEmpty,className:"mt-7 "})})]}),tpe=e=>{var x,y,b,E,w,k,C,T,v,I;const{officialTemplates:t,currentCategory:n,openTemplatePreview:s}=e,a=Ar(ry),{templates:o=[],hasResult:i=!1,keyword:l}=a,c=n.split("/").filter(Boolean),u=t.find(j=>j.name===c[0]),d=(x=u==null?void 0:u.subGroups)==null?void 0:x.find(j=>j.name===c[1]),[f,h]=F.useState((E=(b=(y=d==null?void 0:d.subGroups)==null?void 0:y[0])==null?void 0:b.name)!=null?E:""),p=A5(),g=n==="myTemplate";F.useEffect(()=>{var j,D,S;h((S=(D=(j=d==null?void 0:d.subGroups)==null?void 0:j[0])==null?void 0:D.name)!=null?S:"")},[n,d]);let _=[];return!g&&d&&(_=(w=d.templates)!=null?w:[],f&&(_=(T=(C=(k=d.subGroups)==null?void 0:k.find(j=>j.name===f))==null?void 0:C.templates)!=null?T:[])),r.jsxs("div",{className:"relative w-full px-[30px] overflow-auto h-full",children:[l&&(i?r.jsx("div",{className:"overflow-auto grid gap-4 pt-5",style:{gridTemplateColumns:"repeat(auto-fill, 360px)"},children:o.map(j=>r.jsx(Yh,{template:j,onPreviewOpen:D=>{s(D)}},j.pageId))}):r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-col items-center relative py-[100px] border-b",children:[r.jsx("div",{className:"text-[70px] leading-[80px]",children:"👀"}),r.jsx("div",{className:"text-t1-medium text-black",children:"暂时没有找到符合条件的模板"}),r.jsx("a",{target:"_blank",href:An.templateFeedback,className:"text-t2 text-active_color cursor-pointer",rel:"noreferrer",children:"点击反馈你的模板需求"})]}),r.jsx("p",{className:"h-9 text-t1 mt-5 mb-2.5",children:"试试这些模板吧"}),r.jsx("div",{className:"overflow-auto grid gap-4",style:{gridTemplateColumns:"repeat(auto-fill, 360px)"},children:o.map(j=>r.jsx(Yh,{template:j,onPreviewOpen:D=>s(D)},j.pageId))})]})),!l&&r.jsxs(r.Fragment,{children:[g&&r.jsx(r.Fragment,{children:((v=p.subGroups)!=null?v:[]).map(j=>{var D;return(D=j.templates)!=null?D:[]}).flat().length===0?r.jsx(epe,{className:"mt-5"}):(I=p.subGroups)==null?void 0:I.map(j=>r.jsx(Jhe,{category:j,onPreviewOpen:s},j.name))}),!g&&(d==null?void 0:d.subGroups)&&r.jsx(npe,{templateGroups:d.subGroups,setThirdCategory:h,thirdCategory:f}),!g&&r.jsx("div",{className:"w-full pb-9 pt-5 grid gap-4",style:{gridTemplateColumns:"repeat(auto-fill, 360px)"},children:_.map(j=>r.jsx(Yh,{template:j,onPreviewOpen:s},j.pageId))})]})]})},npe=({templateGroups:e,setThirdCategory:t,thirdCategory:n})=>{var c;const s=F.useRef(null),[a,o]=F.useState(0),[i,l]=F.useState(!1);return F.useEffect(()=>{var p;l(!1);const u=s.current;if(!u)return;const d=(p=u.parentElement)==null?void 0:p.clientWidth;if(!d)return;let f=0,h=Array.from(u.children).findIndex(g=>(f+=g.clientWidth+20,d-f<80));d-f<70&&h--,o(h!==-1?h+1:e.length)},[e]),e.length===0?null:r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-wrap pt-[15px] sticky top-0 bg-white2 z-10",children:[(c=e.slice(0,i?e.length:a))==null?void 0:c.map(u=>r.jsx("button",{onClick:()=>{ce.event("template_category",{category_id:u.name}),t(u.name)},className:B("px-2 py-[5px] mr-5 rounded hover:bg-black_003 my-[5px] text-t2 text-grey2",n===u.name&&"bg-black_006 text-t2-medium"),children:u.name},u.name)),a!==e.length&&r.jsxs("button",{className:"text-t2 text-grey3 ml-auto animate-hover px-2 flex items-center h-[30px] self-center",onClick:()=>l(!i),children:[i?"收起":"展开",r.jsx(H,{name:"IcArrow",size:"xxxsmall",className:B("ml-1",i&&"rotate-180")})]})]}),r.jsx("div",{className:"flex pt-[15px] top-0 bg-white2 absolute w-[calc(100%-60px)] overflow-auto opacity-0",ref:s,children:e.map(u=>r.jsx("button",{className:"px-2 py-[5px] mr-5 rounded hover:bg-black_003 my-[5px] text-t2 flex-shrink-0 text-grey2",children:u.name},u.name))})]})},W0=()=>{const e=Vj(),[t,n]=F.useState({canGoBack:!1,canGoForward:!1}),s=Un();F.useEffect(()=>(n0(Ss.CanHistoryBackAndForward).then(n),s.listen(()=>{n0(Ss.CanHistoryBackAndForward).then(n)})),[s]);const a=()=>{t.canGoBack&&window.history.back()},o=()=>{t.canGoForward&&window.history.forward()};return!un||!e?null:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Js,{disabled:!t.canGoBack,size:26,className:B("mr-1 animate-hover",!t.canGoBack&&"opacity-30 cursor-not-allowed"),onClick:a,popup:r.jsxs("div",{children:["后退",r.jsx("span",{className:"text-grey3 ml-1",children:`${Gt}+[`})]}),children:r.jsx(H,{size:"xlarge",name:"IcArrowBack"})}),r.jsx(Js,{disabled:!t.canGoForward,size:26,className:B("animate-hover",!t.canGoForward&&"opacity-30 cursor-not-allowed"),onClick:o,popup:r.jsxs("div",{children:["前进",r.jsx("span",{className:"text-grey3 ml-1",children:`${Gt}+]`})]}),children:r.jsx(H,{size:"xlarge",name:"IcArrowForward"})})]})};var Ey=(e=>(e.SPACE_CAPACITY="SPACE_CAPACITY",e.MAIN_LEFT_WIDTH="MAIN_LEFT_WIDTH",e.RIGHT_PAGE_WIDTH="flowus.right.width",e))(Ey||{});const TE=240,Fxe=F.memo(({aside:e,children:t})=>{const n=fw(),s=Cr(),a=Xr(),o=ax(),i=F.useRef(null),[l,c]=WE(Ey.MAIN_LEFT_WIDTH,{defaultValue:TE}),[u,d]=F.useState(!1),f=Math.min(Math.max(200,l),window.innerWidth*.7),[h,p]=F.useState(!1),g=Sd();F.useEffect(()=>{const w=document.getElementById("root"),k=document.getElementById(US);a?(w==null||w.classList.add("dragging"),k==null||k.classList.add("pointer-events-none")):(w==null||w.classList.remove("dragging"),k==null||k.classList.remove("pointer-events-none"))},[a]),F.useEffect(()=>{Ye({$isCollapsed:s||localStorage.getItem(D1)==="true"})},[s]),F.useEffect(()=>{!e&&!ht()&&Ye({$isCollapsed:!0})},[e]),F.useEffect(()=>{const w=()=>{p(!1)};return document.body.addEventListener("mouseleave",w),()=>{Ye({$isCollapsed:!0}),document.body.removeEventListener("mouseleave",w)}},[]);const _=w=>{w.preventDefault(),w.stopPropagation(),d(!0);const k=C=>c(C.pageX);window.addEventListener("mouseup",()=>{window.removeEventListener("mousemove",k),d(!1)},{once:!0}),window.addEventListener("mousemove",k)},x=F.useCallback(w=>{var k;(!h&&o&&w.clientX<15||h&&!((k=i.current)!=null&&k.contains(w.target))&&w.clientX>15)&&p(!h)},[o,h]),y=o&&!h?`-${f}px`:"0",b={width:f,transition:"transform 0.2s, top 0.2s, bottom 0.2s",transform:`translateX(${y})`,borderRadius:o?"0px 4px 4px 0px":"0 0 0 0",top:o?"70px":"0",height:`calc(100vh - ${o?"140px":"0px"})`,boxShadow:y==="0"&&h?"0px 0px 1px rgba(0, 0, 0, 0.3) inset, 0px 12px 25px rgba(0, 0, 0, 0.16)":"0px 0px 1px rgba(0, 0, 0, 0) inset, 0px 12px 25px rgba(0, 0, 0, 0)"},E=o||!e?0:f;return r.jsxs(r.Fragment,{children:[e&&r.jsx(r.Fragment,{children:r.jsxs($f,{disableSpring:g,config:{duration:100},className:"inset-y-0 left-0 z-[100] transition-all bg-aside aside max-h-min transform-gpu fixed",domRef:i,style:b,children:[e,!o&&r.jsx($f,{disableSpring:g,config:{duration:100},className:B("fixed inset-y-0 w-0.5 z-[100] animate-hover cursor-col-resize",u&&"bg-black_006"),style:{left:E},onMouseDown:_,onDoubleClick:()=>{c(TE)}})]})}),r.jsx($f,{disableSpring:g,tagName:"main",className:B("bg-white1 overflow-y-auto",pt.print?"h-auto":"flex flex-col h-full"),style:{width:pt.print?"100%":n,paddingLeft:pt.print?0:E},onMouseMove:x,children:t})]})},kn),L5=()=>F.useCallback(e=>{Ye({$isCollapsed:e}),e?Nn(D1,"true"):localStorage.removeItem(D1)},[]),yxe=({className:e})=>{const t=L5(),n=ax(),s=F.useCallback(a=>{a.stopPropagation(),t(!0)},[t]);return n?null:r.jsx(Fe,{popup:r.jsxs("span",{children:["收起侧边栏 ",r.jsxs("span",{className:"text-grey3",children:[Gt,"+\\ "]})]}),className:B("flex items-center justify-center w-5 h-5 ml-2 transition-all duration-200 rounded opacity-0 toc-collapse-trigger sm:opacity-100",e),onClick:s,children:r.jsx(H,{name:"IcUnfold",className:"text-black animate-hover rotate-180",size:"middle"})})},K0=({showInSharePage:e})=>{const t=ax(),n=ht(),s=L5(),a=Kp(),[o]=S8(Ey.MAIN_LEFT_WIDTH,{defaultValue:TE}),i=Math.min(Math.max(200,o),window.innerWidth*.7),l=c=>{c.stopPropagation(),s(!1);const u=document.querySelector(".main-panel");u&&u.clientWidth<i+iV&&a()};return!t||n&&!e?null:r.jsx(Fe,{popup:r.jsxs("span",{children:["展开侧边栏 ",r.jsxs("span",{className:"text-grey3",children:[Gt,"+\\ "]})]}),className:"toc-collapse flex items-center justify-center mr-0.5 rounded animate-hover group-hover:flex relative",onClick:l,children:r.jsx(Js,{size:28,children:r.jsx(H,{name:"IcUnfold",className:"text-grey3",size:"middle"})})})},P5=e=>{var _,x;const t=gt(),n=(_=e.pageId)!=null?_:t,s=(x=e.styleVariant)!=null?x:"default",a=Mg(),o=me(),i=Vj(),l=On(),c=a(n,!0,e.ancestorId),[u,...d]=c;if(!u||l)return null;const f=rj(d,2),h=zI(d,2),p=y=>{o.dropdown({popcorn:y.currentTarget,placement:"bottom",offset:[0,8],content({onCloseModal:b}){return r.jsx("div",{className:"py-2 next-modal w-60",children:h.map(({uuid:E})=>r.jsx(spe,{uuid:E,onCloseModal:b},`bread-${E}`))})}})},g=c.length>3?r.jsxs(r.Fragment,{children:[r.jsx(Fe,{popup:"查看折叠的页面路径",className:"w-5 h-5 px-1 mx-1 text-black rounded text-t2 animate-hover",onClick:p,children:"..."}),r.jsx(O5,{})]}):null;return r.jsxs("div",{className:"flex items-center overflow-x-auto",children:[i&&s!=="messages"&&e.showHistoryButton&&r.jsxs(r.Fragment,{children:[r.jsx(K0,{}),r.jsx(W0,{})]}),r.jsx(J4,{uuid:u.uuid,styleVariant:s},`bread-${u.uuid}`),g,(s==="messages"?f.slice(0,-1):f).map(({uuid:y},b)=>r.jsx(J4,{uuid:y,last:b===f.length-1,styleVariant:s},`bread-${y}`))]})},spe=({uuid:e,onCloseModal:t})=>{const n=_e(e,["data"],["segments"]),{illegal:s}=it(e),a=Md(n==null?void 0:n.spaceId);if(!n)return null;const o=ht()?`${a}/share/${e}`:`${a}/${e}`;return r.jsxs(pc,{to:o,onClick:t,className:B("flex items-center px-4 py-2 cursor-pointer animate-hover",s&&"opacity-30"),children:[r.jsx(tn,{trigger:!1,blockId:e,className:"mr-1",defaultIcon:r.jsx(as,{uuid:e})}),r.jsx("span",{className:"text-t2 text-ellipsis",children:s?rs:de(n.data.segments)||Ot(n.type)})]})},J4=({uuid:e,last:t,styleVariant:n})=>{var u;const s=_e(e,["data"],["segments","icon"]),a=Md(s==null?void 0:s.spaceId),o=Un(),{illegal:i}=it(e);if(!s)return null;const l=i?rs:r.jsx(vc,{uuid:e}),c=ht()?`${a}/share/${e}`:`${a}/${e}`;return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:B("flex items-center rounded animate-hover",n==="messages"?"text-grey3 text-t4 px-1":"mx-2 text-black text-t2 p-1",i&&"opacity-30"),onPointerDown:()=>{o.push(c),Yu.lastGoBackPath=c,Yu.tmpDisable=!0,setTimeout(()=>{Yu.tmpDisable=!1},500)},children:[((u=s.data.icon)==null?void 0:u.value)&&n!=="messages"&&r.jsx(tn,{blockId:s.uuid,trigger:!1,className:"mr-1",iconSize:18,defaultIcon:r.jsx(as,{uuid:e,size:"middle"})}),r.jsx(Fe,{popup:l,className:B("block text-ellipsis",t?"max-w-[238px]":"max-w-[166px]"),children:l})]}),r.jsx(O5,{})]})},O5=()=>r.jsx("span",{className:"w-1 pointer-events-none text-grey4 last:hidden",children:"/"}),Mb="active-from",Z4=30*1e3;class rpe{constructor(t){q(this,"active",!0);q(this,"timer");q(this,"lastEnterDate");q(this,"request");q(this,"getTimeWithTimeZone",t=>{const n=new Date;let s=n.getTime()+n.getTimezoneOffset()*60*1e3;return s+=t*60*60*1e3,new Date(s)});q(this,"setActive",t=>{this.active=t});q(this,"checkIfSameDay",()=>{var n,s,a;const t=this.getTimeWithTimeZone(8);(((n=this.lastEnterDate)==null?void 0:n.getFullYear())!==t.getFullYear()||((s=this.lastEnterDate)==null?void 0:s.getMonth())!==t.getMonth()||((a=this.lastEnterDate)==null?void 0:a.getDay())!==t.getDay())&&this.reportEnter()});q(this,"reportEnter",async(t={})=>{const n=sessionStorage.getItem(Mb)||void 0;sessionStorage.removeItem(Mb);let s=5;for(;s>0;)try{await this.request.infra.behaviorReport.raw({topic:"activity",business:{type:"enter",activeFrom:n,...t}}),this.lastEnterDate=this.getTimeWithTimeZone(8);break}catch(a){await ape(1500),s--}});q(this,"loop",()=>{this.active&&(this.checkIfSameDay(),this.active=!1,this.request.infra.behaviorReport.raw({topic:"activity",business:{type:"active"}}).catch(()=>{})),this.timer=window.setTimeout(this.loop,Z4)});this.request=t}setFrom(t){t&&sessionStorage.setItem(Mb,t)}start(){this.reportEnter(),this.timer=window.setTimeout(this.loop,Z4)}stop(){window.clearTimeout(this.timer)}}const ape=e=>new Promise(t=>{setTimeout(t,e)}),Ef=new rpe(Ce),ope=()=>{const t=!!Qt().uuid;F.useEffect(()=>{if(!t)return;const n=()=>{Ef.reportEnter()},s=()=>{Ef.setActive(!0)},a=()=>{document.visibilityState==="visible"&&Ef.reportEnter()};return window.addEventListener("visibilitychange",a),window.addEventListener("online",n),window.addEventListener("pointermove",s,{capture:!0}),Ef.start(),()=>{Ef.stop(),window.removeEventListener("visibilitychange",a),window.removeEventListener("online",n),window.removeEventListener("pointermove",s,{capture:!0})}},[t])},ipe=({uuid:e})=>{const t=_e(e,["data","local"],["icon","segments","iconUrl"]),n=gt(),s=!!t,a=jF(),o=La(),i=F.useContext(bd),l=Ve(e),c=uD(),{allowDuplicate:u,illegal:d}=it(e),f=ht(),h=On(),p=Ft(),_=!!Qt().uuid,x=IF();if(F.useEffect(()=>{const b=window.sessionStorage.getItem(kp);f&&b===e&&_&&(window.sessionStorage.removeItem(kp),x(e))},[x,f,e,_]),F.useEffect(()=>{if(!e||!s||!_)return;const b=le().blocks[e];!b||b.local||oa(async()=>{l||Ce.editor.addSpaceVisitsHistory(b.spaceId,{uuid:e}),ht()||Ce.editor.addDocVisits.raw(e)})},[l,e,s,_]),F.useEffect(()=>{if(!s)return;const b=le().blocks[e];b&&(ce.event("page_enter",{is_success:!0,page_type:b.type,page_id:b.uuid,is_shared:f}),_&&Ef.reportEnter({spaceId:b.spaceId,activeFrom:f?"share_link":void 0}))},[e,s,_,f]),F.useEffect(()=>{var b,E;h||Z1(t&&!d?{title:de(t.data.segments)||Ot(t.type),icon:{type:(b=t.data.icon)==null?void 0:b.type,value:t.data.iconUrl||((E=t.data.icon)==null?void 0:E.value)}}:{title:d?rs:p.title})},[t,p.title,h,d]),F.useEffect(()=>{if(!t)return;const b=le().blocks[t.parentId];if((b==null?void 0:b.type)===m.BlockType.COLLECTION_VIEW_PAGE||(b==null?void 0:b.type)===m.BlockType.COLLECTION_VIEW)return a.subscribeChildPages(t.spaceId,e,()=>{o(e)})},[t,o,a,e]),F.useEffect(()=>{const b=document.getElementById("root");f&&!u?b==null||b.classList.add("no-print"):b==null||b.classList.remove("no-print")},[u,f]),F.useEffect(()=>{t!=null&&t.local&&setTimeout(()=>{ee(mn({uuid:e,ignoreOp:!0,patch:{local:!1}}))},200)},[t==null?void 0:t.local,e]),F.useEffect(()=>{localStorage.getItem(hT)!==n&&n&&!f&&Nn(hT,n)},[f,n]),d)return r.jsx(Qx,{uuid:e});let y=null;switch(t==null?void 0:t.type){case m.BlockType.PAGE:{y=r.jsx(S0,{uuid:e});break}case m.BlockType.COLLECTION_VIEW:case m.BlockType.REFERENCE_COLLECTION:case m.BlockType.REFERENCE_COLLECTION_PAGE:case m.BlockType.COLLECTION_VIEW_PAGE:{y=r.jsx(E9,{uuid:e});break}case m.BlockType.FOLDER:{y=r.jsx(A9,{uuid:e});break}case m.BlockType.MIND_MAPPING:case m.BlockType.MIND_MAPPING_PAGE:{y=r.jsx(uP,{uuid:e});break}default:e?y=r.jsx($m,{showBackButton:!1}):y=r.jsx(S0,{uuid:e});break}return r.jsx(Nd,{scope:ur,initialValues:[[Yx,e]],children:r.jsx(bd.Provider,{value:i||c.backup||c.noPermission,children:y})})},lpe=e=>{var z,Q,Z,te,re;const{uuid:t,officialTemplates:n,currentCategory:s,from:a}=e,o=ay(t),i=A5(),l=ks(),c=l3(),{keyword:u,templates:d=[]}=Ar(ry),[f,h]=F.useState(s),[p,g]=F.useState(!1),_=F.useMemo(()=>{const ne=[];return n.forEach(Y=>{var X;(X=Y.subGroups)==null||X.forEach(oe=>ne.push(`${Y.name}/${oe.name}`))}),ne},[n]),x=ne=>{var ie,ue,ge,Ne;let Y=[];const X=ne.split("/").filter(Boolean);if(ne==="myTemplate")(ie=i.subGroups)==null||ie.forEach(De=>{var Se;Y.push(...(Se=De.templates)!=null?Se:[])});else{const De=n.find(Ie=>Ie.name===X[0]),Se=(ue=De==null?void 0:De.subGroups)==null?void 0:ue.find(Ie=>Ie.name===X[1]);Y=(ge=Se==null?void 0:Se.templates)!=null?ge:[],(Ne=Se==null?void 0:Se.subGroups)==null||Ne.forEach(Ie=>{var Ke;Y.push(...(Ke=Ie.templates)!=null?Ke:[])})}return Y};let y=[];u?y=d:y=x(f);const[b,E]=F.useState(y.findIndex(ne=>ne.id===t)),w=(Q=(z=y[b])==null?void 0:z.id)!=null?Q:"",[k,C]=F.useState(w),T=La();x9();const v=Kt(),I=Gk(),j=me();Un();const[D,S]=F.useState(!0),R=dr(()=>DI({initialEntries:[`/share/${t}`]})),A=ke(),{role:L}=it(k);F.useEffect(()=>{R.replace(`${w}`)},[R,w]),F.useEffect(()=>{ce.event("template_view",{template_id:t})},[t]),F.useEffect(()=>{if(!k)return;let ne=!0;return S(!0),T(k).finally(()=>{ne&&S(!1)}),()=>{ne=!1}},[k,T]),F.useEffect(()=>R.listen((ne,Y)=>{const X=qj(ne),oe=X.pathname.substring(X.pathname.lastIndexOf("/")+1);(Y==="PUSH"||Y==="REPLACE")&&C(ie=>{if(ie===oe){const ue=Gc(X.search);if(ue)return ue}return oe})}),[R]);const P=(ne,Y)=>{u||j.dropdown({popcorn:Y.currentTarget,placement:"bottom",content:({onCloseModal:X})=>r.jsx(r.Fragment,{children:r.jsxs("div",{className:"bg-black/75 rounded px-2 py-1",children:[p?r.jsx("div",{className:"text-t4 text-white",children:"无更多模板"}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t4 text-white",children:"该分类下无更多模板"}),r.jsx("div",{className:"cursor-pointer text-t4 text-white underline",onClick:()=>{X(),Is.unstable_batchedUpdates(()=>{const oe=f.split("/").filter(Boolean),ie=_.indexOf(`${oe[0]}/${oe[1]}`),ue=_[ne?ie+1:ie-1];if(!ue){g(!0);return}const ge=x(ue);h(ue),E(ne?0:ge.length-1),S(!0)})},children:`查看${ne?"下":"上"}一分类`})]}),r.jsx("div",{id:"triangle-up","data-popper-arrow":!0,className:"opacity-75"})]})})})};if(!w)return null;const M=b!==0,U=b!==y.length-1,V=L===m.PermissionRole.EDITOR||L===m.PermissionRole.WRITER;let W=null;return o?W=((re=(te=(Z=i.subGroups)==null?void 0:Z[0])==null?void 0:te.templates)==null?void 0:re.find(Y=>Y.id===t))?"我的模板":"分享给我的模板":W=r.jsxs(r.Fragment,{children:[f.split("/")[0],r.jsx("span",{className:"mx-2.5",children:"/"}),f.split("/")[1],r.jsx("span",{className:"ml-2.5",children:"/"}),!D&&r.jsx(P5,{ancestorId:w})]}),r.jsx(SI,{history:R,children:r.jsx(Al.Provider,{value:Tt.TEMPLATE,children:r.jsx(mi.Provider,{value:zc.PAGE_TEMPLATE,children:r.jsxs("div",{className:"relative flex flex-col w-[1040px] h-[85.42vh] next-modal",children:[r.jsxs("div",{className:"flex w-full justify-between items-center h-[55px] px-4 flex-shrink-0",children:[r.jsxs("div",{className:"flex",children:[r.jsxs("div",{className:"flex cursor-pointer hover:opacity-80 items-center hover:normal-bg px-1 rounded",onClick:()=>v(Xe.TEMPLATE_PREVIEW),children:[r.jsx(H,{name:"MIcListTemplate",size:"middle"}),r.jsx("div",{className:"text-t2 ml-2",children:"模板库"})]}),r.jsx("div",{className:"flex items-center text-grey4 ml-2.5",children:"/"}),r.jsx("div",{className:"flex overflow-hidden items-center ml-2.5 text-black text-t2",children:W})]}),r.jsxs("div",{className:"flex items-center",children:[o&&V&&r.jsx(F9,{className:"w-8 h-8 border border-solid border-grey5 rounded mr-5 ",moreColor:"black",onEdit:()=>window.open(`/${t}`),onDelete:()=>{j.warning({title:"确认删除模板？",content:"删除后，该模板将从模板库移除并进入回收站",confirmText:"确认删除",colorType:"red",confirm:()=>{A(()=>{Gs(t)}),v(Xe.TEMPLATE_PREVIEW)}})}}),r.jsx("div",{className:B("flex items-center justify-center cursor-pointer border border-solid border-grey5 w-[49px] h-8 rounded-l-l ",{"hover:normal-bg":M}),onClick:ne=>{M?Is.unstable_batchedUpdates(()=>{var X,oe;E(b-1);const Y=(oe=(X=y[b-1])==null?void 0:X.id)!=null?oe:"";Y!==k&&(R.replace(`/${Y}`),S(!0))}):o||P(!1,ne)},children:r.jsx(H,{name:"IcArrowDateBack",size:"middle",className:B({"opacity-30":!M})})}),r.jsx("div",{className:B("flex items-center justify-center cursor-pointer border-r border-t border-b border-solid border-grey5 w-[49px] h-8 rounded-r ",{"hover:normal-bg":U}),onClick:ne=>{U?Is.unstable_batchedUpdates(()=>{var X,oe;E(b+1);const Y=(oe=(X=y[b+1])==null?void 0:X.id)!=null?oe:"";Y!==k&&(R.replace(`/${Y}`),S(!0))}):o||P(!0,ne)},children:r.jsx(H,{name:"IcArrowDateNext",size:"middle",className:B({"opacity-30":!U})})}),r.jsx("div",{className:"text-white ml-5 text-t2-medium bg-active_color h-8 flex items-center rounded px-[14px] cursor-pointer hover:bg-active_color/90",onClick:async()=>{const ne=y[b];if(!ne)return;await c(ne,a)&&I(),l(Ae.COPY_PAGE_FROM_TEMPLATE,We.basicList)},children:"使用该模板"})]})]}),D?r.jsx(os,{className:"flex-1"}):r.jsx(ipe,{uuid:k})]})})})})},eI=354+30,cpe=1040,Xf=e=>{const[t,n]=F.useState([]),s=Qae(),a=me(),{width:o}=Ba(document.body,"width"),[i,l]=F.useState("");F.useEffect(()=>{s().then(d=>{var h,p;n(d!=null?d:[]);const f=d==null?void 0:d[0];f&&l(`${f.name}/${(p=(h=f.subGroups)==null?void 0:h[0])==null?void 0:p.name}`)})},[s]),F.useEffect(()=>{ce.event("template_page",{is_from:e.from==="quickSetting"?"side_bar":"new_page"})},[e.from]);const c=d=>{a.modal({modalId:Xe.TEMPLATE_PREVIEW,content:()=>r.jsx(lpe,{uuid:d,currentCategory:i,officialTemplates:t,from:e.from})})};let u=cpe;if(o){for(;u<o*.9;)u+=eI;u=u-eI}return i?r.jsx(i3.Provider,{value:e.from,children:r.jsxs("div",{className:"next-modal h-[85.42vh] min-w-[1040px] flex flex-col",style:{width:u},children:[!t&&r.jsx(os,{}),r.jsx(Yhe,{keyword:e.keyword,currentCategory:i}),r.jsxs("div",{className:"flex overflow-hidden flex-1",children:[r.jsx(Xhe,{officialTemplates:t,setCurrentCategory:l,currentCategory:i}),r.jsx(tpe,{officialTemplates:t,currentCategory:i,openTemplatePreview:c})]})]})}):null};aoe(Xf);Whe(Xf);const upe=({uuid:e})=>{const t=ks(),n=me(),s=ke(),a=N5(),o=cF(e),{isTemplate:i,collectionId:l,templatePages:c}=uX(e),u=F.useRef(),d=fr(),f=ny(),h=m5(),p=Gd(),g=La(),_=lh(),x=gt(),[y,b]=F.useState(r.jsx(r.Fragment,{})),E=Qd(),w=lu(),k=()=>{s(()=>{const I=Qe({},{parentId:e,last:!0});d(I,0)}),t(Ae.GUIDE_FIRST_TIME_CREATED_PAGE,We.basicList),t(Ae.CREATE_NEW_PAGE,We.basicList)},C=()=>{s(()=>{pe(e,{type:m.BlockType.FOLDER}),t(Ae.CREATE_FOLDER_AND_UPLOAD,We.basicList,{step1:!0})}),t(Ae.GUIDE_FIRST_TIME_CREATED_FOLDER,We.basicList)},T=()=>{s(()=>{pe(e,{type:m.BlockType.MIND_MAPPING_PAGE}),_({parentId:e,last:!0},x),_({parentId:e,last:!0},x),_({parentId:e,last:!0},x)}),t(Ae.CREATE_MIND_MAP,We.advancedList)},v=aj([{title:"页面",icon:"IcPageNew",group:!1,onClick:()=>{ce.event("pagetype_select",{type_select:m.BlockType.PAGE}),k()}},{title:"让 AI 帮我起草",isHidden:!E,icon:"IcAi",isBeta:!0,group:!1,onClick:()=>{s(()=>{const I=Qe({},{parentId:e,last:!0});setTimeout(()=>{const j=document.querySelector(`[data-block-id="${I}"]`);j&&w({popcorn:j,blockId:I,from:Ll.EmptyAi,editorScene:ct.PageEmpty})},0)})}},{title:"文件夹",icon:"IcFolderNew",group:!1,onClick:()=>{ce.event("pagetype_select",{type_select:m.BlockType.FOLDER}),C()}},{title:"思维导图",icon:"IcMindmapNew",group:!1,onClick:()=>{ce.event("pagetype_select",{type_select:m.BlockType.MIND_MAPPING_PAGE}),T()}},{title:"从模板库选择创建",icon:"IcTemplateNew",group:!1,onClick:()=>{n.modal({modalId:Xe.TEMPLATE_CENTER,content:()=>r.jsx(Xf,{from:"page"})})}},{title:"导入",icon:"IcListImport",group:!1,onClick:()=>{n.modal({content:()=>r.jsx(S5,{pageId:e,from:"page"})})}},{title:"多维表",group:!0},..._m.map(({type:I,name:j})=>({title:j,icon:lo[I],group:!1,onClick:()=>{switch(ce.event("pagetype_select",{type_select:m.BlockType.COLLECTION_VIEW_PAGE,view_type:I}),ce.event("bitable_create",{from_scene:"empty",view_type:I}),a(e,I),t(Ae.GUIDE_FIRST_TIME_CREATED_COLLECTION,We.basicList),I){case m.CollectionViewType.TABLE:t(Ae.CREATE_BITABLE_EXPLORE,We.basicList);break;case m.CollectionViewType.GALLERY:t(Ae.CREATE_GALLERY_VIEW,We.advancedList,{step1:!0});break;case m.CollectionViewType.CALENDAR:t(Ae.GUIDE_FIRST_TIME_CALENDAR_VIEW,We.advancedList),t(Ae.CREATE_CALENDAR_VIEW,We.advancedList);break;case m.CollectionViewType.TIMELINE:t(Ae.GUIDE_FIRST_TIME_TIMELINE_VIEW,We.advancedList),t(Ae.CREATE_TIMELINE_VIEW,We.advancedList);break;case m.CollectionViewType.FORM:t(Ae.GUIDE_FIRST_TIME_COLLECTION_VIEW,We.advancedList),t(Ae.CREATE_FORM_VIEW,We.advancedList);break}}}))],I=>!I.isHidden);return F.useEffect(()=>{b(r.jsx(r.Fragment,{children:o?c.length>=1?"，或从下方选择模板应用":i?"":r.jsxs(r.Fragment,{children:["，或",r.jsx("span",{className:"underline cursor-pointer underline-offset-2",onClick:I=>{I.stopPropagation(),n.modal({modalId:Xe.TEMPLATE_CENTER,content:()=>r.jsx(Xf,{from:"record"})})},children:"从模板库选择创建"})]}):"，或从下方选择页面类型"}))},[o,i,n,c.length]),r.jsxs("div",{className:"line-default text-grey4",ref:u,children:[r.jsxs("div",{className:"my-0.5 px-0.5 mb-6 py-1.5 cursor-text",onClick:k,children:["按回车开始编辑",!i&&y]}),o&&!i&&c.length>=1&&r.jsxs(r.Fragment,{children:[c.map(I=>r.jsxs("div",{className:B("flex items-center flex-1 p-1 rounded cursor-pointer h-9 hover:text-grey4 animate-hover"),onClick:async()=>{await g(I);const j=[];s(()=>{UA(e,I,j)},{noThrottle:!0}),oa(async()=>{await Promise.all(j.map(D=>D()))}),f(e)},children:[r.jsx(tn,{iconSize:18,blockId:I,className:"w-5 h-5 mr-1",placement:"bottom-start",defaultIcon:r.jsx(as,{className:"opacity-30",uuid:I,size:"middle"})}),r.jsx(vc,{uuid:I})]},I)),r.jsxs("div",{className:B("flex items-center flex-1 p-1 rounded cursor-pointer h-9 hover:text-grey4 animate-hover"),onClick:()=>{f(e)},children:[r.jsx(H,{name:"MIcPageBlank",size:"middle",className:"mr-1 opacity-30"}),r.jsx("span",{className:"text-t1",children:"空白页面"})]}),r.jsxs("div",{className:B("flex items-center flex-1 p-1 rounded cursor-pointer h-9 hover:text-grey4 animate-hover"),onClick:()=>{if(l!=null){const I=h(l);p(I,{state:{noticeBannerShowBackButton:!0}})}},children:[r.jsx(H,{name:"MIcAddNew",size:"middle",className:"mr-1 opacity-60"}),r.jsx("span",{className:"text-t1",children:"创建模板记录"})]}),!i&&r.jsxs("div",{className:B("flex items-center flex-1 p-1 rounded cursor-pointer h-9 hover:text-grey4 animate-hover"),onClick:()=>{n.modal({modalId:Xe.TEMPLATE_CENTER,content:()=>r.jsx(Xf,{from:"record"})})},children:[r.jsx(H,{name:"IcTemplateNew",size:"middle",className:"mr-1"}),r.jsx("span",{className:"text-t1",children:"从模板库选择创建"})]})]}),!o&&r.jsx(Bd,{defaultIndex:0,listenPriority:Cx,containerRef:u,itemCount:v.length,children:(I,j)=>v.map((D,S)=>D.isHidden?null:D.group?r.jsx("div",{"list-item-inactive":"",className:"flex items-center mt-4 h-9 text-t2",children:D.title},S):r.jsxs("div",{className:B("flex items-center p-1 h-9 animate-hover",S===I&&"bg-black_006 text-grey3"),onClick:D.onClick,onMouseEnter:()=>j(S),children:[D.icon&&r.jsx(H,{size:"middle",className:"mr-2",name:D.icon}),D.title,D.isBeta&&r.jsx("span",{className:"text-t2 px-1.5 bg-grey/20 rounded-sm ml-2 text-grey2 inline-flex items-center",children:"Beta"}),r.jsx(H,{size:"middle",className:B("ml-auto opacity-0 transition-opacity mr-1",S===I&&"opacity-100"),name:"IcEnter"})]},S))})]})},tI=new Map,dpe=F.memo(({uuid:e})=>{var a;const t=F.useRef(null),n=F.useRef();F.useEffect(()=>{const o=t.current;if(!o)return;n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{clearTimeout(n.current),o.style.minHeight=""},300);const i=Pd.observe(o,l=>{const{clientHeight:c}=l.target;c&&tI.set(e,c)});return()=>{i(),clearTimeout(n.current)}});const s=(a=tI.get(e))!=null?a:void 0;return r.jsx("div",{className:"flex flex-col",ref:t,style:{minHeight:s},children:r.jsx(by,{root:!0,id:e},e)})}),fpe=({uuid:e,className:t,readonly:n,visibleRender:s})=>{const a=F.useRef(null),{isVirtualListMode:o}=PR(),i=nX(),{subNodes:l=[]}=_e(e,["subNodes"])||{},{allowDuplicate:c}=it(e),u=F.useRef(null),d=ae(({user:y})=>{var b;return(b=y.setting)==null?void 0:b.enableHighPerformance}),[f,h]=F.useState(void 0),p=Sd();yoe(u);const g=sr(),[_,x]=F.useState(g.current);return u3(g),F.useEffect(()=>{x(g.current)},[g]),F.useEffect(()=>{if(pt.print)return;const{count:y}=k9(l),{COUNT_THRESHOLD:b,SUPER_VISIBLE_RENDER_THRESHOLD:E,VISIBLE_RENDER_THRESHOLD:w}=C9(p);if(d){const k=y>=b;if(i({isVirtualListMode:k,virtualRef:a,subNodes:l}),k)return}s&&(y>=E?h(dc.blank):y>=w&&h(dc.innerHtml))},[d,i,l,s,p]),_?r.jsx("div",{"data-page-id":e,className:B("next-space-page-content block-list",!pt.print&&"relative flex flex-col flex-shrink-0",t),ref:u,children:r.jsxs(nx.Provider,{value:u,children:[o?r.jsx(mpe,{uuid:e,virtualRef:a,container:_}):r.jsx(Ehe,{root:!0,visibleRender:f,subNodes:l},e),r.jsx(Fm,{readonly:n}),!n&&r.jsx(Bc,{type:"page"}),(!n||c)&&r.jsx(To,{}),!n&&!(l!=null&&l.length)&&!pt.print&&r.jsx(upe,{uuid:e})]})}):null},L3=F.memo(fpe,kn);ine(L3);Roe(L3);sW(dP);qX(L3);const mpe=F.memo(e=>{const{uuid:t,virtualRef:n,container:s}=e,{subNodes:a=[]}=_e(t,["subNodes"])||{};return r.jsx(As,{ref:n,customScrollParent:s,overscan:1e3,data:a,computeItemKey:(o,i)=>i,defaultItemHeight:100,components:{Item:({children:o,...i})=>r.jsx("div",{...i,children:o})},itemContent:(o,i)=>r.jsx(dpe,{uuid:i})})});function d_(e){return new Proxy({},{get(t,n){return F.lazy(()=>e().then(s=>({default:s[n]})))}})}const pu=()=>F.useCallback(async()=>{const e=await Ce.infra.getMyUserInfo.raw();return e.code===200&&ee(Ci.update(e.data)),e},[]),f_=({onSendVerifyCode:e,autoClick:t,showIcon:n=!0,className:s,disable:a})=>{const[o,i]=F.useState(!1),[l,c]=F.useState("获取验证码"),u=F.useRef(null),d=F.useCallback(()=>{i(!1)},[]);return F.useEffect(()=>{var f;t&&((f=u.current)==null||f.click())},[t]),r.jsx("button",{ref:u,disabled:a,className:Xx("text-t4 mr-1 flex h-full w-full items-center font-normal text-black h-lg:text-t2",s,{"opacity-50 cursor-not-allowed":a}),type:"button",onClick:async()=>{o||!await e()||(i(!0),c("重新获取验证码"))},children:o?r.jsx(Dx,{time:60,className:"text-grey3",prefix:"倒计时",onFinish:d}):r.jsxs(r.Fragment,{children:[l,n&&r.jsx("img",{src:kl.IcLoginCode,className:"ml-1 h-3 w-3 dark:invert dark:opacity-50"})]})})};var vE=(e=>(e[e.BY_PHONE=0]="BY_PHONE",e[e.BY_OLD_PASSWORD=1]="BY_OLD_PASSWORD",e))(vE||{});const hpe=e=>{const[t,n]=F.useState(!1),[s,a]=F.useState(!1),{password:o,passwordError:i,newPassword:l,newPasswordError:c,verifyCode:u,setVerifyCode:d,verifyCodeError:f,setPassword:h,setNewPassword:p,settingPassword:g}=ppe(e.type,e.phone);return e.type===0&&e.phone?r.jsxs("div",{className:"next-modal p-7",children:[r.jsx("div",{className:"text-t1-medium ",children:"设置密码"}),r.jsx(xt,{inputType:t?"text":"password",warning:i,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:o,placeholder:"请输入新的密码",onChange:h,addonAfter:r.jsx(H,{onClick:_=>{_.preventDefault(),_.stopPropagation(),n(!t)},name:t?"IcMenuItemHide":"IcMenuItemShow",className:"cursor-pointer absolute right-2.5 text-grey3",size:"middle"})}),r.jsx("div",{className:"text-t2 text-grey3 mt-2.5",children:"6-16位密码，需包含数字、英文大写字母和小写字母"}),r.jsx(xt,{readonly:!0,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:e.phone}),r.jsx(xt,{autoFocus:!0,type:"number",value:u,maxLength:6,warning:f,className:"w-full h-9 mt-5 px-3",inputClassName:"opacity-50 px-0",placeholder:"请输入验证码",onChange:_=>d(_.toString()),addonAfter:r.jsx(f_,{onSendVerifyCode:()=>{var _;return Ce.infra.createPhoneCaptcha((_=e.phone)!=null?_:"",{type:m.CaptchaSendType.RESET_PASSWORD})}})}),r.jsx(je,{onClick:async()=>{await g()&&e.onSuccess()},colorType:"active",className:"mt-6",children:"完成绑定"})]}):r.jsxs("div",{className:"next-modal px-7 pb-7",children:[r.jsx("div",{className:"text-t4 text-grey3 mt-9",children:"原密码"}),r.jsx(xt,{inputType:t?"text":"password",warning:i,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:o,placeholder:"请输入原密码",onChange:h,addonAfter:r.jsx(H,{onClick:_=>{_.preventDefault(),_.stopPropagation(),n(!t)},name:t?"IcMenuItemHide":"IcMenuItemShow",className:"cursor-pointer absolute right-2.5 text-grey3",size:"middle"})}),r.jsx("div",{className:"text-t4 text-grey3 mt-6",children:"新密码"}),r.jsx(xt,{inputType:s?"text":"password",warning:c,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:l,placeholder:"请输入新的密码",onChange:p,addonAfter:r.jsx(H,{onClick:_=>{_.preventDefault(),_.stopPropagation(),a(!s)},name:s?"IcMenuItemHide":"IcMenuItemShow",className:"cursor-pointer absolute right-2.5 text-grey3",size:"middle"})}),r.jsx("div",{className:"text-t2 text-grey3 mt-2.5",children:"6-16位密码，需包含数字、英文大写字母和小写字母"}),r.jsx(je,{onClick:async()=>{await g()&&e.onSuccess()},colorType:"active",className:"mt-6",children:"设置密码"})]})},ppe=(e,t)=>{const[n,s]=F.useState(t!=null?t:""),[a,o]=F.useState(""),[i,l]=F.useState(""),[c,u]=F.useState(""),[d,f]=F.useState(""),[h,p]=F.useState(""),[g,_]=F.useState(""),x=Qt(),y=()=>Qr.VerifyCode.test(a)?!0:(l("验证码错误"),!1),b=()=>!c||!Qr.Password.test(c)?(f("密码格式有误"),!1):!0,E=()=>!h||!Qr.Password.test(h)?(_("密码格式有误"),!1):!0;return{phone:n,password:c,passwordError:d,newPassword:h,newPasswordError:g,verifyCode:a,verifyCodeError:i,setPassword:u,setNewPassword:p,settingPassword:async()=>{if(b()){if(e===0)return y()?Ce.infra.resetUserPasswordByPhone(n,{captcha:a,password:Xu(c)}):void 0;if(E())return await Ce.infra.resetUserPassword(x.uuid,{old:Xu(c),new:Xu(h)})}},setVerifyCode:o}},gpe=({onClick:e,onError:t,autoClick:n,sendCode:s,className:a})=>{const[o,i]=F.useState(!1),[l,c]=F.useState(!1),[u,d]=F.useState("获取验证码"),f=F.useRef(!1),h=F.useCallback(async()=>{if(e==null||e(),!f.current){f.current=!0;try{await s(),c(!0),d("重新获取验证码")}catch(g){f.current=!1,t==null||t(g.message)}}},[e,t,s]),p=F.useCallback(()=>{c(!1),f.current=!1},[]);return F.useEffect(()=>{n?h().then(()=>i(!0)):i(!0)},[]),r.jsx("button",{className:B("flex items-center w-full h-full font-normal text-black text-t4",{hidden:!o},a),type:"button",onClick:h,children:l?r.jsx(Dx,{time:60,className:"text-grey3",prefix:"倒计时",onFinish:p}):r.jsxs(r.Fragment,{children:[u,r.jsx(H,{className:"ml-1 animate__animated animate__headShake",name:"IcLoginCode",size:"xxsmall"})]})})},_pe=e=>{const{mobile:t,type:n=0,...s}=e,a=async()=>{await Ce.infra.createPhoneCaptcha(t,{type:n})};return r.jsx(gpe,{sendCode:a,...s})},xpe=e=>{const[t,n]=F.useState(""),[s,a]=F.useState(),o=F.useRef(null);return r.jsxs("div",{className:"w-[400px] px-[30px]",children:[r.jsx("div",{className:"text-t1-medium mt-10",children:"输入验证码完成注销"}),r.jsx("div",{className:"my-5",children:`已向注册手机号${jd(e.phone)}发送验证码`}),r.jsx(xt,{type:"number",disableFloat:!0,maxLength:6,inputRef:o,className:"w-full h-[50px] mb-5 h-md:text-h4 px-3",inputClassName:"h-full px-0 text-t2",placeholder:"请输入验证码",onEnter:()=>{},value:t,onChange:i=>{n(i.toString())},warning:s,addonAfter:r.jsx(_pe,{autoClick:!0,onClick:()=>{var i;return(i=o.current)==null?void 0:i.focus()},mobile:e.phone,type:m.CaptchaSendType.REMOVE_ACCOUNT,onError:i=>{var l;a(i),(l=o.current)==null||l.focus()}})}),r.jsx(je,{className:"mb-3 font-medium w-full",colorType:"red",disable:t.length===0,onClick:async()=>{const i=await Ce.infra.removeUser.raw(K.user.uuid,{captcha:t.trim(),reasons:e.reasonInfo.reasons,otherReason:e.reasonInfo.otherReason});if(i.code!==200){a(i.msg),ce.event("close_account",{is_success:!1,close_reason:i.msg});return}e.onConfirm()},children:"确定注销"}),r.jsx(je,{className:"mb-5 font-medium w-full",onClick:()=>{e.cancel(),R8(new Error("cancel"))},children:"取消"})]})},Fpe=e=>{const[t,n]=F.useState(!1);return r.jsxs("div",{className:"flex items-center mt-3 text-t2",children:[r.jsx(Ra,{size:"small",checked:t,className:"mr-2",onClick:()=>{n(!t),e.onCheck(!t)}}),e.content]})},nI=100,ype=["产品功能复杂，很难上手","部分使用需求未被满足","产品体验不佳","安全/隐私问题"],bpe=e=>{const[t,n]=F.useState([!1]),[s,a]=F.useState(""),o=t.every(i=>!i&&s.length===0);return r.jsxs("div",{className:"flex flex-col w-[400px] px-[30px] overflow-y-auto",children:[r.jsx("div",{className:"text-center text-t1-medium mt-10",children:"注销服务"}),r.jsx("div",{className:"mt-5 mb-1.5 text-t2",children:"亲爱的用户，请留下你的注销原因，FlowUs 团队将持续改进服务。"}),ype.map((i,l)=>r.jsx(Fpe,{onCheck:c=>{const u=t.slice(0);u[l]=c,n(u)},content:i},l)),r.jsxs("div",{className:"relative my-2 h-[112px]",children:[r.jsx("textarea",{placeholder:"其他(选填)",className:"py-2 px-3 w-full bg-grey9 rounded border border-grey6 focus-within-border text-t2 resize-none",rows:4,maxLength:nI,onChange:i=>a(i.target.value.trim())}),r.jsxs("div",{className:"absolute right-3 bottom-2",children:[s.length," ",r.jsx("span",{className:"text-grey3",children:`/ ${nI}`})]})]}),r.jsx(je,{className:"mb-4",disable:o,colorType:"active",onClick:()=>{e.onNext(t,s)},children:"继续"}),r.jsx(je,{onClick:e.onCancel,className:"mb-5",children:"取消"})]})},Epe=()=>{const e=wpe(),t=kpe(),n=Cpe(),s=Tpe(),a=QS(),o=async()=>{try{await e(),await t();const i=await n();await s(i);const l=[];i.reasons.forEach((c,u)=>{c&&l.push(u.toString())}),i.otherReason&&l.push(i.otherReason),ce.event("close_account",{is_success:!0,close_reason:l.join(";")}),ye.success("注销成功"),setTimeout(()=>{a(),Bs(Rt.login)},1e3)}catch(i){}};return F.useCallback(o,[a,n,t,e,s])},wpe=()=>{const e=me();return F.useCallback(()=>new Promise((t,n)=>{e.warning({colorType:"active",maxWidth:400,title:r.jsx(eu,{popup:"查看注销账户帮助",link:Ta.cancelAccount,children:"注销须知"}),content:r.jsxs("div",{className:"flex flex-col items-start text-left",children:[r.jsx("div",{children:"亲爱的 FlowUs 用户，我们对你的注销深表遗憾。"}),r.jsx("div",{children:"在你提交注销申请生效前，请确保你已知悉以下内容，FlowUs 团队有权进行验证:"}),r.jsxs("ul",{className:"ml-4 mt-5",style:{listStyle:"disc"},children:[r.jsx("li",{children:"该账号下所有权益视为默认放弃，包含积分、已购买的订阅付费等"}),r.jsx("li",{children:"若该账号存在纠纷，如账号封禁、投诉举报、诉讼等，FlowUs 有权配合后续追诉"})]})]}),confirmText:"我已知晓",confirm:()=>{t()},cancelText:"取消",cancel:()=>{n(new Error("cancel"))}})}),[e])},kpe=()=>{const e=me();return F.useCallback(()=>new Promise((t,n)=>{e.warning({maxWidth:400,colorType:"active",title:"注销服务",content:r.jsxs("div",{className:"text-left",children:[r.jsx("div",{children:"请确保你已妥善处理空间及数据，注销后将导致:"}),r.jsxs("ul",{className:"ml-4 mt-5",style:{listStyle:"disc"},children:[r.jsx("li",{children:"自动退出所有多人空间（包含已邀请空间成员及外部协作者的团队空间/个人空间），已有数据不会失效"}),r.jsx("li",{children:"仅含自己的空间，将永久删除空间所有数据"})]})]}),confirmText:"继续",confirm:()=>{t()},cancelText:"取消",cancel:()=>{n(new Error("cancel"))}})}),[e])},Cpe=()=>{const e=me(),t=Kt();return F.useCallback(()=>new Promise((n,s)=>{const{modalId:a}=e.modal({autoClose:!1,keyboard:!1,content:()=>r.jsx(bpe,{onCancel:()=>{s(new Error("cancel")),t(a)},onNext:(o,i)=>{const l=[];o.forEach((c,u)=>{c&&l.push(u.toString())}),n({reasons:l,otherReason:i}),t(a)}})})}),[t,e])},Tpe=()=>{const e=me(),t=Kt();return F.useCallback(n=>new Promise((s,a)=>{const{modalId:o}=e.modal({autoClose:!1,keyboard:!1,content:()=>r.jsx(xpe,{reasonInfo:n,phone:K.user.phone,onConfirm:()=>{t(o),s()},cancel:()=>{t(o),a(new Error("cancel"))}})})}),[t,e])},vpe=()=>{const e=Ft(),t=fi();Qc();const[n,s]=F.useState(Jt.account),[a,o]=F.useState(!0),[i,l]=F.useState(""),c=u=>{l(u),s(Jt.upgrade),C2()};return F.useEffect(()=>{C2(),t(e.uuid)},[]),{checkoutUpgraded:c,currentSettingMenu:n,setCurrentSettingMenu:s,clickMaskClose:a,setClickMaskClose:o,isFrom:i,setIsFrom:l}},la=ag(vpe),Npe={container:"px-[60px] flex-1 cursor-default flex flex-col overflow-y-auto pb-10",name:"mb-3.5 text-black",input:"w-full mb-3 h-9 flex-shrink-0"},Ipe=e=>{const{confirm:t,cancel:n,confirmText:s,cancelText:a}=e;return r.jsxs("div",{className:"flex self-end py-3 px-[60px] w-full h-14 border-t border-grey7",children:[t&&r.jsx(je,{colorType:"active",...bn(Bn.settingSave),onClick:t,className:"mr-[20px] text-t2-medium animate-click",children:s!=null?s:"保存"}),n&&r.jsx(je,{...bn(Bn.settingCancel),onClick:n,className:"text-t2-medium animate-click",children:a!=null?a:"取消"})]})},jpe=({title:e,name:t,addonAfter:n})=>r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex-shrink-0 flex items-center mb-1 text-grey3 h-9 text-t2 justify-between",children:[e,n]}),r.jsx(xp,{className:B(t&&"mb-2.5")}),t&&r.jsx("div",{className:"flex items-center h-9 text-black text-t2",children:t})]}),Dpe=e=>{const{leftChild:t,rightChild:n}=e;return r.jsxs("div",{className:"h-9 flex items-center justify-between text-t2 flex-shrink-0",children:[r.jsx("div",{children:t}),r.jsx("div",{children:n})]})},Spe=({content:e,className:t,disabled:n,...s})=>r.jsxs("div",{className:B("flex items-center h-full",n?"opacity-60 cursor-not-allowed":"animate-click",t),...s,children:[r.jsx("span",{className:"mr-2",children:e}),r.jsx(H,{className:"text-grey3",name:"IcArrow",size:"xxxsmall"})]}),kt={commonStyles:Npe,FooterBar:Ipe,SettingDivider:xp,Header:jpe,Item:Dpe,DropdownButton:Spe},P3=e=>{const[t,n]=F.useState(),[s,a]=F.useState(""),o=async(l,c)=>{if(!l)return;const u=await Nt.request.infra.wechatAuthorization({code:l,type:c});return i(u)},i=async l=>{if(l.status===At.RegisterStatus.UN_REGISTERED&&l.authorizationCode)a(l.authorizationCode),n(ir.NEED_BIND_PHONE);else if(l.status===At.RegisterStatus.REGISTERED&&l.authorizationCode)return n(ir.CAN_LOGIN),await Nt.request.infra.loginAuthorizationCode({type:e,code:l.authorizationCode})};return{accountStatus:t,authorizationCode:s,tryLogin:o,updateAccountState:i}},Rpe=e=>{const[t,n]=F.useState(),s=F.useRef(null),{accountStatus:a,authorizationCode:o,updateAccountState:i}=P3(At.UserAuthorizationType.WECHAT),l=wg(e.switchViewType),{switchViewType:c}=e,u=async()=>{const d=await Nt.request.infra.getUserLoginWechatQrcode();s.current&&clearInterval(s.current),d.qr&&(n(d),s.current=setInterval(async()=>{var f;if(d.uuid){const h=await Nt.request.infra.wechatAuthorizationScan.raw({uuid:d.uuid});if(h.code===200&&h.data.authorizationCode){s.current&&clearInterval(s.current),e.onAuth&&e.onAuth(h.data.authorizationCode);const p=await i(h.data);if(!p)return;(!e.complete||l(p))&&((f=e.onSuccess)==null||f.call(e,p))}}},1e3))};return F.useEffect(()=>(u(),()=>{s.current&&clearInterval(s.current)}),[]),F.useEffect(()=>{switch(a){case ir.NEED_BIND_PHONE:{o&&c({type:Rs.BIND_PHONE,props:{authorization:{code:o,type:At.UserAuthorizationType.WECHAT}}});break}}},[o,e,a,c]),r.jsxs("div",{className:"flex w-full flex-col items-center pb-8",children:[!e.onAuth&&r.jsx("img",{src:kl.IcTitleClose,onClick:()=>{c({type:Rs.LOGIN})},className:"mr-4 mt-4 h-5 w-5 self-end cursor-pointer dark:invert"}),r.jsx("img",{src:kl.wechatLogoLogin,className:"mt-6"}),r.jsx("div",{className:"text-h3 mb-6",children:"微信登录"}),r.jsx("div",{children:r.jsx("img",{src:t==null?void 0:t.qr,className:"h-64 w-64"})}),r.jsxs("div",{className:"text-t2 my-6",children:["请使用",r.jsx("span",{className:"text-active_color mx-1",children:"微信扫码"}),"关注公众号即可安全登录"]})]})},M5=e=>{const{accountStatus:t,authorizationCode:n,tryLogin:s}=P3(At.UserAuthorizationType.WECHAT),a=wg(e.switchViewType),{switchViewType:o}=e;return Ape("wechat_login_container"),F.useEffect(()=>{switch(t){case ir.NEED_BIND_PHONE:{n&&o({type:Rs.BIND_PHONE,props:{authorization:{code:n,type:At.UserAuthorizationType.WECHAT}}});break}}},[n,e,t,o]),F.useEffect(()=>{const i=async l=>{var c;try{const u=l.data;if((u==null?void 0:u.state)===s0){if(e.onAuth){e.onAuth(u.code);return}const d=await s(u.code,"web");if(!d)return;(!e.complete||a(d))&&((c=e.onSuccess)==null||c.call(e,d))}}catch(u){}};return window.addEventListener("message",i),()=>{window.removeEventListener("message",i)}},[a,e,o,s]),r.jsxs("div",{className:"next-modal flex w-full flex-col items-center pb-8",children:[!e.onAuth&&r.jsx("img",{src:kl.IcTitleClose,onClick:()=>{o({type:Rs.LOGIN})},className:"mr-4 mt-4 h-5 w-5 self-end cursor-pointer dark:invert"}),r.jsx("img",{src:kl.wechatLogoLogin,className:"mt-6"}),r.jsx("div",{id:"wechat_login_container",className:"mt-6"})]})},Ape=e=>{F.useLayoutEffect(()=>{let t;t=setInterval(()=>{typeof window.WxLogin=="function"&&(t&&clearInterval(t),window.WxLogin({self_redirect:!0,id:e,appid:Nt.wechatId,scope:"snsapi_login",redirect_uri:`${location.origin}/auth-callback`,state:s0,style:"",href:""}))},50)},[e])};if(typeof document<"u"&&!document.getElementById("wechat_login_js")){const t=document.createElement("script");t.id="wechat_login_js",t.src="https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js",document.body.appendChild(t)}const Bpe=Object.freeze(Object.defineProperty({__proto__:null,BindWeChat:M5,WechatLogin:Rpe},Symbol.toStringTag,{value:"Module"})),sI=`${Nt.origin}/auth-callback`,U5=e=>{const{accountStatus:t,authorizationCode:n,tryLogin:s}=P3(At.UserAuthorizationType.WECHAT),a=F.useRef(null),o=wg(e.switchViewType),{switchViewType:i}=e;return F.useEffect(()=>{switch(t){case ir.NEED_BIND_PHONE:{n&&i({type:Rs.BIND_PHONE,props:{authorization:{code:n,type:At.UserAuthorizationType.WECHAT}}});break}}},[n,e,t,i]),F.useEffect(()=>{const l=a.current,c=()=>{l==null||l.insertCSS("html,body{ padding: 0px !important; background-color:#FFFFFF !important;  overflow: hidden !important;  } .title { color:black !important;}")},u=async()=>{var d;if(l!=null&&l.src.startsWith(sI)){const f=new URL(l.src),h=new URLSearchParams(f.search),p=h.get("code"),g=h.get("state");if(p&&g===s0){if(e.onAuth){e.onAuth(p);return}const _=await s(p,"web");if(!_)return;(!e.complete||o(_))&&((d=e.onSuccess)==null||d.call(e,_))}}};return l==null||l.addEventListener("dom-ready",c),l==null||l.addEventListener("did-stop-loading",u),()=>{l==null||l.removeEventListener("did-stop-loading",u),l==null||l.removeEventListener("dom-ready",c)}},[o,e,s]),r.jsxs("div",{className:"next-modal flex flex-col items-center pb-8",children:[!e.onAuth&&r.jsx("img",{src:kl.IcTitleClose,onClick:()=>{i({type:Rs.LOGIN})},className:"mr-4 mt-4 h-5 w-5 self-end cursor-pointer dark:invert"}),r.jsx("img",{src:kl.wechatLogoLogin,className:"mt-6"}),r.jsx("div",{id:"wechat_login_container",className:"mt-6",children:r.jsx("webview",{className:"overflow-hidden",ref:a,src:`https://open.weixin.qq.com/connect/qrconnect?appid=${Nt.wechatId}&scope=snsapi_login&redirect_uri=${sI}&state=${s0}&login_type=jssdk&self_redirect=true`,style:{width:"300px",height:"410px"}})})]})},Lpe=Object.freeze(Object.defineProperty({__proto__:null,WechatLoginElectron:U5},Symbol.toStringTag,{value:"Module"})),V5=()=>{const e=F.useCallback(async(n,s,a)=>{var i;const o=await Nt.request.infra.emailAuthorization({email:s,captcha:a,type:At.CaptchaSendType.BIND_NEW});if(o.nickname){Nt.message.success(`该账号已被昵称 ${o.nickname} 的账户绑定`);return}return Nt.request.infra.bindThirdAccount(n,{type:At.UserAuthorizationType.EMAIL,code:(i=o.authorizationCode)!=null?i:""})},[]),t=F.useCallback(async(n,s)=>{var o;const a=await Nt.request.infra.wechatAuthorization({code:s,type:"web"});return Nt.request.infra.bindThirdAccount.raw(n,{type:At.UserAuthorizationType.WECHAT,code:(o=a.authorizationCode)!=null?o:""})},[]);return{bindEmail:e,bindWechat:t}};var wf=(e=>(e[e.ALREADY_IN=0]="ALREADY_IN",e[e.MEMBER_FULL=1]="MEMBER_FULL",e[e.LINK_ERROR=2]="LINK_ERROR",e[e.JOINING=3]="JOINING",e[e.JOIN_SUCCESS=4]="JOIN_SUCCESS",e))(wf||{});const Ppe=e=>{const[t,n]=F.useState(),[s,a]=F.useState(),[o,i]=F.useState();return F.useEffect(()=>{Nt.request.infra.getMyUserInfo.raw().then(c=>{c.code===200&&a(c.data)}),Nt.request.infra.getInvitationInfo.raw(e).then(c=>{c.code===200?(i(c.data),c.data.joined&&n(0)):c.code===1208?n(1):n(2)})},[e]),{status:t,teamSpaceInfo:o,user:s,setUser:a,joinTeamSpace:async c=>{var d,f;if(n(3),(f=(await Nt.request.infra.getUserRoot(c.uuid)).spaces)!=null&&f[(d=o==null?void 0:o.space.uuid)!=null?d:""]){n(0);return}return await Nt.request.infra.joinSpaceByInvitation(e),n(4),!0}}},Ope={primary:"bg-black2 border-black text-white-base",secondary:"bg-white dark:bg-transparent text-black border-grey6",red:"bg-white1 text-red border-red",white:"bg-transparent text-black border-white",active:"bg-active_color text-white border-transparent"},Mpe={primary:"hover:opacity-90",secondary:"hover:brightness-90 dark:hover:bg-black_003",red:"hover:bg-red/10",white:"hover:bg-black_003",active:"hover:brightness-90 text-t2-bold dark:hover:brightness-110"},bxe=zt.memo(e=>{const{colorType:t="secondary",disable:n,onClick:s,autoFocus:a=!1,className:o,children:i,...l}=e;return r.jsx("button",{...l,onClick:s,autoFocus:a,disabled:n,className:Xx("flex justify-center items-center rounded-md border outline-none",Ope[t],n?"opacity-30 cursor-not-allowed":Mpe[t],o),children:i})}),Upe=(e,t)=>{var i;const n=(i=t==null?void 0:t.mode)!=null?i:"float",s=F.useRef(),a=F.useRef(e);return a.current=e,{initNECaptcha:F.useCallback(()=>{typeof window.initNECaptchaWithFallback=="function"&&window.initNECaptchaWithFallback({element:"#yidun-captcha",captchaId:cW,width:n==="float"?"100%":`${window.innerWidth*.7}px`,mode:n,apiVersion:2,feedbackEnable:!1,onVerify(l,c){l||a.current(c.validate)}},l=>{s.current=l},l=>{console.warn(l)})},[n]),yidunCaptchaInstance:s}};(function(e,t){e.initNECaptchaWithFallback=t(e)})(typeof window<"u"?window:globalThis,e=>{let t=0;const n="QjGAuvoHrcpuxlbw7cp4WnIbbjzG4rtSlpc7EDovNHQS._ujzPZpeCInSxIT4WunuDDh8dRZYF2GbBGWyHlC6q5uEi9x-TXT9j7J705vSsBXyTar7aqFYyUltKYJ7f4Y2TXm_1Mn6HFkb4M7URQ_rWtpxQ5D6hCgNJYC0HpRE7.2sttqYKLoi7yP1KHzK-PptdHHkVwb77cwS2EJW7Mj_PsOtnPBubTmTZLpnRECJR99dWTVC11xYG0sx8dJNLUxUFxEyzTfX4nSmQz_T5sXATRKHtVAz7nmV0De5unmflfAlUwMGKlCT1khBtewlgN5nHvyxeD8Z1_fPVzi9oznl-sbegj6lKfCWezmLcwft8.4yaVh6SlzXJq-FnSK.euq9OBd5jYc82ge2_hEca1fGU--SkPRzgwkzew4O4qjdS2utdPwFONnhKAIMJRPUmCV4lPHG1OeRDvyNV8sCnuFMw7leasxIhPoycl4pm5bNy70Z1laozEGJgItVNr3",s={"zh-CN":"前方拥堵，已自动跳过验证",en:"captcha error，Verified automatically"},a=1e3*60,o=502,i={};function l(E,w){const k=document.head||document.getElementsByTagName("head")[0],C=document.createElement("script");w=w||function(){},C.type="text/javascript",C.charset="utf8",C.async=!0,C.src=E,"onload"in C||(C.onreadystatechange=function(){this.readyState!=="complete"&&this.readyState!=="loaded"||(this.onreadystatechange=null,w(null,C))}),C.onload=function(){this.onerror=this.onload=null,w(null,C)},C.onerror=function(){this.onerror=this.onload=null,w(new Error(`Failed to load ${this.src}`),C)},k.appendChild(C)}function c(E,w,k){if(E=E||"",w=w||"",k=k||"",E&&(E=E.replace(/:?\/{0,2}$/,"://")),w){const C=w.match(/^([-0-9a-zA-Z.:]*)(\/.*)?/);w=C[1],k=`${C[2]||""}/${k}`}return!w&&(E=""),E+w+k}function u(E,w){if(w===void 0)return;const{nodeType:k}=E;(k===1||k===11||k===9)&&(typeof E.textContent=="string"?E.textContent=w:E.innerText=w)}function d(E,w){if(w=w||document,w.querySelectorAll)return w.querySelectorAll(E);if(!/^\.[^.]+$/.test(E))return[];if(w.getElementsByClassName)return w.getElementsByClassName(E);const k=w.getElementsByTagName("*");let C;const T=[],v=E.slice(1);for(let I=0,j=k.length;I<j;I++)C=k[I],~` ${C.className} `.indexOf(` ${v} `)&&T.push(C);return T}function f(E,w){if(!E)throw new Error(`[NECaptcha] ${w}`)}function h(E){return Number.isInteger?Number.isInteger(E):typeof E=="number"&&isFinite(E)&&Math.floor(E)===E}function p(E){return Array.isArray?Array.isArray(E):Object.prototype.toString.call(E)==="[object Array]"}function g(){if(Object.assign)return Object.assign.apply(null,arguments);const E={};for(let w=1;w<arguments.length;w++){const k=arguments[w];if(k!=null)for(const C in k)Object.prototype.hasOwnProperty.call(k,C)&&(E[C]=k[C])}return E}function _(E){return E=!E&&E!==0?E:1,parseInt(new Date().valueOf()/E,10)}function x(E){const k={protocol:e.location.protocol.replace(":","")==="http"?"http":"https",lang:"zh-CN",errorFallbackCount:3},C=g({},k,E),{errorFallbackCount:T}=C;return f(T===void 0||h(T)&&T>=1,"errorFallbackCount must be an integer, and it's value greater than or equal one"),C}function y(E,w){if(e.initNECaptcha){setTimeout(()=>{w(null)},0);return}function k(v){const I="load.min.js";let j=[];if(p(v))for(let D=0,S=v.length;D<S;D++)j.push(c(E.protocol,v[D],I));else{const D=c(E.protocol,v,I);j=[D,D]}return j}const C=k(E.staticServer||["cstaticdun.126.net","cstaticdun1.126.net","cstatic.dun.163yun.com"]);function T(v){const I=`${C[v]}?v=${_(a)}`;l(I,j=>j||!e.initNECaptcha?(v=v+1,v===C.length?w(new Error(`Failed to load script(${I}).${j?j.message:"unreliable script"}`)):T(v)):w(null))}T(0)}function b(E,w,k){let C=null;const T=x(E),v=T.defaultFallback!==!1,I=s[T.lang==="zh-CN"?T.lang:"en"],j=`${e.location.pathname}_${T.captchaId}_NECAPTCHA_ERROR_COUNTS`;try{t=parseInt(localStorage.getItem(j)||0,10)}catch(V){}const D=v?function(V){function W(z){if(!z||(W(z._captchaIns),!z.$el))return;const Q=d(".yidun-fallback__tip",z.$el);Q.length&&setTimeout(()=>{for(let Z=0,te=Q.length;Z<te;Z++)u(Q[Z],I)},0)}W(C),T.onVerify&&T.onVerify(null,{validate:V})}:T.onFallback||function(){},S=!v&&!T.onFallback,R=function(V){if(t++,t<T.errorFallbackCount){try{localStorage.setItem(j,t)}catch(W){}k(V)}else D(n),A(),S&&k(V)};var A=function(){t=0;try{localStorage.setItem(j,0)}catch(V){}};const L=function(V){if(P&&P.isError()){P.resetError();return}P&&P.resetTimer(),S?k(V):R(V)};T.onError=function(V){P&&P.isError()&&P.resetError(),R(V)},T.onDidRefresh=function(){P&&P.isError()&&P.resetError(),A()};var P=E.initTimeoutError?E.initTimeoutError(R):null;const M=function(){e.initNECaptcha(T,V=>{P&&P.isError()||(P&&P.resetTimer(),C=V,w&&w(V))},L)},U="load-queue";i[U]||(i[U]={rejects:[],resolves:[],status:"error"}),i[U].status==="error"?(i[U].status="pending",y(T,V=>{if(V){const W=new Error;W.code=o,W.message=`${T.staticServer}/load.min.js error`;const{rejects:z}=i[U];for(let Q=0,Z=z.length;Q<Z;Q++)z.pop()(W);i[U].status="error"}else{i[U].status="done";const{resolves:W}=i[U];for(let z=0,Q=W.length;z<Q;z++)W.pop()()}})):i[U].status==="done"&&M(),i[U].status==="pending"&&(i[U].rejects.push(V=>{L(V)}),i[U].resolves.push(M))}return b});const wy=e=>{var te,re,ne;const[t,n]=F.useState(e==null?void 0:e.accountStatus),[s,a]=F.useState((te=e==null?void 0:e.account)!=null?te:""),[o,i]=F.useState(""),[l,c]=F.useState(""),[u,d]=F.useState(""),[f,h]=F.useState((re=e==null?void 0:e.password)!=null?re:""),[p,g]=F.useState(""),[_,x]=F.useState(e==null?void 0:e.authorization),[y,b]=F.useState(),[E,w]=F.useState((ne=e==null?void 0:e.newInviteCode)!=null?ne:""),[k,C]=F.useState(""),T=F.useCallback(Y=>{c(Y.trim()),d("")},[]),v=F.useCallback(Y=>{h(Y.trim()),g("")},[]),I=F.useCallback(Y=>{a(Y.trim()),i(""),T(""),n(X=>{if(X===ir.NEED_BIND_PHONE)return X;C("")})},[T]),j=F.useCallback(Y=>{w(Y)},[]),D=async()=>{if(!S())return;const Y=X=>{X===At.PhoneCheckStatus.CAN_LOGIN?n(ir.CAN_LOGIN):n(ir.CAN_SIGN)};if(Qr.Email.test(s)){const X=await Nt.request.infra.checkEmail({email:s});return Y(X.status),X}else if(Qr.Mobile.test(s)){const X=await Nt.request.infra.checkPhone(s);return Y(X.status),X}i("账号格式不正确")},S=()=>!Qr.Email.test(s)&&!Qr.Mobile.test(s)?(i("账号格式不正确"),!1):!0,R=()=>Qr.VerifyCode.test(l)?!0:(d("验证码错误"),!1),A=()=>!f||!Qr.Password.test(f)?(g("密码格式有误"),!1):!0,L=F.useCallback(()=>Qr.Mobile.test(s),[s]),P=()=>Qr.Email.test(s),M=async Y=>{if(!S())return;if(L()){const oe=await Nt.request.infra.createPhoneCaptcha.raw(s,{type:Y});if(oe.code!==200){d(oe.msg);return}Nt.message.success("验证码已发送")}else{const oe=await Nt.request.infra.emailCaptcha.raw({email:s,type:Y});if(oe.code!==200){d(oe.msg);return}Nt.message.success("验证码已发送")}return!0},U=async()=>{var Y;if(R()&&!(t===ir.CAN_SIGN&&!A())){if(L())return V();if(P()){const X=await Nt.request.infra.emailAuthorization({email:s,captcha:l,type:At.CaptchaSendType.SIGNUP});x({code:(Y=X.authorizationCode)!=null?Y:"",type:At.UserAuthorizationType.EMAIL}),n(ir.NEED_BIND_PHONE)}}},V=async()=>{var oe;if(!R())return;const Y=f?Xu(f):void 0,X=await Nt.request.infra.usersRegister.raw({type:(oe=_==null?void 0:_.type)!=null?oe:At.UserAuthorizationType.PHONE,phone:s,captcha:l,password:Y,inviteCode:E||void 0,authorizationCode:_==null?void 0:_.code,promotionChannel:y,validate:k});if(X.code===200)return y&&Nt.request.infra.behaviorReport.raw({topic:"activity",business:{type:"enter",activeFrom:"new_activation"}}),Nt.event("user_register",{is_success:!0,activation_channel:E?"邀请":"其它",promotion_channel:y,...uW()},!0),Nt.event("config",{user_unique_id:X.data.uuid},!0),Nt.afterLogin(),await sv(800),X.data;if(Nt.event("user_register",{is_success:!1,fail_reason:X.code}),X.code===1009){n(ir.BIND_FAIL);return}if(X.code===1003){Nt.message.error("恶意注册已拦截，如有疑问请联系客服");return}await sv(800),Nt.message.error(X.msg)},W=async()=>{if(!S()||!R())return;const Y=await Nt.request.infra.loginCaptcha.raw({account:s,captcha:l});if(Y.code!==200){d(Y.msg);return}return Nt.event("config",{user_unique_id:Y.data.uuid},!0),Nt.afterLogin(),Y.data};return{accountStatus:t,account:s,accountError:o,verifyCode:l,verifyCodeError:u,password:f,passwordError:p,inviteCode:E,authorization:_,yidunCaptcha:k,setVerifyCodeError:d,setVerifyCode:T,setAccountStatus:n,next:()=>{switch(t){case ir.CAN_LOGIN:return W();case ir.CAN_SIGN:return U();case ir.NEED_BIND_PHONE:return V();case void 0:D();break}},setAccount:I,sendVerifyCode:M,setInviteCode:j,setPassword:v,loginByPassword:async()=>{if(t===void 0){const X=await D();if((X==null?void 0:X.status)===At.PhoneCheckStatus.CAN_SIGN)return}if(!Qr.Email.test(s)&&!Qr.Mobile.test(s)){i("账号格式不正确");return}if(!Qr.Password.test(f)){g("账号或密码错误");return}const Y=await Nt.request.infra.loginPassword.raw({account:s,password:Xu(f)});if(Y.code===200)return Nt.event("config",{user_unique_id:Y.data.uuid},!0),Nt.afterLogin(),Y.data;g(Y.msg)},setAuthorization:x,resetPassword:async()=>{if(!S()||!R()||!A())return;const Y=L();if(t===ir.CAN_SIGN){const X=await U();if(X)return X;!Y&&n(ir.NEED_BIND_PHONE)}else{const X=Xu(f);Y?await Nt.request.infra.resetUserPasswordByPhone(s,{password:X,captcha:l}):await Nt.request.infra.resetUserPasswordByEmail({email:s,password:X,captcha:l});const oe=await Nt.request.infra.loginPassword({account:s,password:X});return Nt.event("config",{user_unique_id:oe.uuid},!0),Nt.afterLogin(),oe}},setPromotionChannel:b,isPhoneNumber:L,checkAccount:S,checkVerifyCode:R,setPasswordError:g,setYidunCaptcha:C}},q5=e=>{var l,c;const{name:t="",color:n="#828282",icon:s}=e,a=Vpe(t),o=(s==null?void 0:s.type)==="upload"&&s.value,i=(s==null?void 0:s.type)==="emoji"&&s.value||a&&a.length>1;return r.jsxs("span",{className:"text-h4 flex h-[50px] w-[50px] flex-shrink-0 select-none items-center justify-center rounded-full uppercase leading-none text-white",style:{...e.style,backgroundColor:i||o||!n?"":n},onClick:e.onClick,children:[o?r.jsx(r.Fragment,{}):i?r.jsx(Nt.EmojiIcon,{value:s==null?void 0:s.value,size:e.iconSize}):a,o&&r.jsx("img",{src:(l=s.value)!=null&&l.startsWith("http")?s.value:Hpe((c=s.value)!=null?c:""),className:"h-full w-full rounded-full object-cover"})]})},Vpe=e=>e.split("")[0],qpe=/^(jpg|jpeg|png|bmp|webp|tiff)$/i;function Hpe(e){if(!e)return"";const t=e.lastIndexOf("."),n=e.substring(t+1);let s="";return qpe.test(n.toLocaleLowerCase())&&(s=`img_process=/resize,w_${500*Math.ceil(window.devicePixelRatio)}/quality,q_80/`),`https://cdn.allflow.cn/${encodeURIComponent(e)}?${s}`}const nd=e=>{var I;const{type:t="text",visible:n=!0,showBorder:s=!0,value:a,onChange:o,placeholder:i,addonAfter:l,addonBefore:c,maxLength:u,autoFocus:d,warning:f,inputRef:h,onEnter:p,defaultValue:g,onBlur:_,onFocus:x,selection:y,style:b,readonly:E=!1,onClick:w,onKeyDown:k}=e,C=F.useRef(!1),T=F.useRef(null),v=j=>{if(!o)return;const D=j.target.value;let S;const R=/^\d+$/.test(D);if(t==="text")S=D;else if(t==="number")if(R||!D)S=D;else return;o(S)};return F.useEffect(()=>{var j,D;h&&(h.current=T.current),(y==null?void 0:y[0])!==void 0&&y[1]!==void 0&&((j=T.current)==null||j.setSelectionRange(y[0],y[1])),d&&((D=T.current)==null||D.focus())},[]),r.jsxs("div",{style:b,className:Jf("flex items-center rounded relative box-border bg-grey8 text-t2 border border-grey6",{hidden:!n,"border-red":f,"focus-within-border":s&&!f,"border-none":!s},e.className),onClick:()=>{var j;!E&&!c&&!l&&((j=T.current)==null||j.focus())},children:[r.jsx("input",{ref:T,spellCheck:!1,className:Jf("align-middle cursor-text text-t1 flex-grow text-black outline-none bg-transparent placeholder-grey4 w-full",e.inputClassName),type:(I=e.inputType)!=null?I:"text",onKeyDown:j=>{if(k)k(j);else{if(j.stopPropagation(),C.current)return;j.key==="Enter"&&p&&p(j)}},disabled:E,onFocus:()=>{E||x==null||x()},onBlur:()=>_==null?void 0:_(),onClick:j=>{var D;w==null||w(),(D=T.current)==null||D.focus(),j.stopPropagation()},autoFocus:d,maxLength:u||-1,value:a,defaultValue:g,placeholder:i,onInput:v,onCompositionStart:()=>C.current=!0,onCompositionEnd:()=>C.current=!1}),l&&r.jsx("span",{className:"flex items-center justify-center h-full pl-2 whitespace-nowrap",children:l}),f&&r.jsx("span",{className:"absolute -bottom-5 mb-0.5 text-red left-2 text-t4",children:f})]})},H5=e=>r.jsx("div",{className:Xx("flex text-h1 text-center justify-center font-semibold sm:w-full",e.className),children:e.text}),$pe=e=>{const{accountStatus:t,account:n,accountError:s,setAccount:a,verifyCode:o,inviteCode:i,setInviteCode:l,verifyCodeError:c,setVerifyCode:u,sendVerifyCode:d,next:f,setAccountStatus:h,isPhoneNumber:p,setPromotionChannel:g,setYidunCaptcha:_,yidunCaptcha:x}=wy({newInviteCode:e.inviteCode,password:e.password,authorization:e.authorization}),y=n.length>0&&o.length>0,b=!!e.inviteCode,E=t===ir.BIND_FAIL,w=wg(e.switchViewType),[k,C]=F.useState(!0),{initNECaptcha:T}=Upe(_);F.useEffect(()=>{h(ir.NEED_BIND_PHONE)},[h]),F.useEffect(()=>{n&&C(!0)},[n]),F.useEffect(()=>{E||T()},[T,E]),F.useEffect(()=>{g(e.promotionChannel)},[e.promotionChannel,g]);const v=async()=>{var j,D;const I=await f();I&&((j=e.onRegister)==null||j.call(e,I),(!e.complete||w(I))&&((D=e.onSuccess)==null||D.call(e,I)))};return e.authorization?E?r.jsx(Gpe,{account:n,goBindPhone:()=>{a(""),u(""),h(ir.NEED_BIND_PHONE)},goLogin:()=>{e.switchViewType({type:Rs.LOGIN})}}):r.jsxs("div",{children:[r.jsx(H5,{text:"绑定手机号"}),r.jsxs("div",{className:"sm:px-5",children:[r.jsx("div",{className:"text-t1 mt-2 text-center text-grey3",children:"应国家法律要求，使用FlowUs之前需要绑定手机号"}),r.jsx(nd,{maxLength:11,type:"number",warning:s,className:"mt-10 h-[50px] w-full px-3 h-md:text-h4",inputClassName:"px-0",autoFocus:!0,onEnter:v,value:n,placeholder:"请输入手机号",onChange:I=>{a(I.toString())}}),r.jsx("div",{id:"yidun-captcha",className:"mt-5"}),r.jsx(nd,{type:"number",value:o,maxLength:6,warning:c,onEnter:v,className:"mt-5 h-[50px] w-full px-3 h-md:text-h4",placeholder:"请输入验证码",onChange:I=>u(I.toString()),addonAfter:r.jsx(f_,{disable:!x,onSendVerifyCode:()=>(p()&&Nt.request.infra.phonePublicData.raw(n).then(j=>{j.code===200?C(!0):C(!1)}),d(At.CaptchaSendType.SIGNUP))})}),!k&&r.jsx(nd,{readonly:b,value:i,maxLength:6,onEnter:v,className:"mt-5 h-[50px] w-full px-3 h-md:text-h4",placeholder:"请输入邀请码领取额外积分（选填）",onChange:l}),r.jsx(ii,{disable:!y,onClick:v,colorType:"primary",className:`text-t1-medium mt-7 h-[50px] w-full !opacity-100 h-md:text-h4 ${!y&&"opacity-[0.3]"}`,size:"auto",children:"继续"})]})]}):null},$5=e=>{const{onSuccess:t,authorizationCode:n,userId:s,type:a}=e,{account:o,accountError:i,setVerifyCodeError:l,setAccount:c,verifyCode:u,verifyCodeError:d,setVerifyCode:f,sendVerifyCode:h}=wy(),p=()=>{Nt.request.infra.changeBindPhone.raw(s,{phone:o,captcha:u,type:a,code:n}).then(g=>{g.code===200?t==null||t():l(g.msg)})};return r.jsxs("div",{className:"next-modal pt-10 pb-5 px-7 flex flex-col items-center min-w-[400px]",children:[r.jsx("div",{className:"mb-5 text-t1-medium",children:"换绑手机号"}),r.jsx(nd,{autoFocus:!0,type:"number",maxLength:11,warning:i,value:o,className:"w-full mb-5 px-3",inputClassName:"h-8",onChange:g=>c(g.toString())}),r.jsx(nd,{type:"number",className:"w-full mb-8 px-3",inputClassName:"h-8",maxLength:6,value:u,warning:d,onChange:g=>f(g.toString()),addonAfter:r.jsx(f_,{showIcon:!1,onSendVerifyCode:()=>h(At.CaptchaSendType.LOGIN)})}),r.jsx(ii,{className:"self-start px-5",colorType:"active",disable:!o||!u,onClick:()=>p(),children:"完成绑定"})]})},Gpe=e=>{const[t,n]=F.useState();return F.useEffect(()=>{Nt.request.infra.phonePublicData(e.account).then(n)},[e.account]),r.jsxs("div",{className:"w-full px-8",children:[r.jsx(H5,{text:"😑 绑定失败"}),r.jsxs("div",{className:"text-t1 mt-2 text-center text-grey3",children:["您的手机号 ",e.account," 已被下方账号绑定"]}),t&&r.jsxs("div",{className:"relative mt-[40px] flex w-full items-center rounded-lg border border-grey7 px-4 py-8 shadow-md",children:[r.jsx(q5,{className:"h-[50px] w-[50px] rounded-full text-white",name:t.nickname,icon:{type:"upload",value:t.avatar},color:t.backgroundColor}),r.jsxs("div",{className:"ml-3 text-grey3",children:[r.jsx("div",{children:t.nickname}),t.createdAt&&r.jsxs("div",{children:[he(t.createdAt).format("YYYY年M月D日")," 完成注册"]})]}),r.jsx("div",{className:"text-t2 absolute top-4 right-4 rounded border border-red py-1 px-2 text-red",children:"当前绑定"})]}),r.jsxs("div",{className:"mt-5 flex justify-between",children:[r.jsx(ii,{onClick:e.goBindPhone,colorType:"white",className:"text-t1-medium mr-4 h-[50px] w-full",size:"auto",children:"重新绑定手机"}),r.jsx(ii,{onClick:e.goLogin,colorType:"primary",className:"text-t1-medium h-[50px] w-full",size:"auto",children:"切换账号登录"})]})]})},zpe=Object.freeze(Object.defineProperty({__proto__:null,BindPhone:$pe,ChangeBindPhone:$5},Symbol.toStringTag,{value:"Module"})),Wpe=e=>{const{status:t,user:n,teamSpaceInfo:s,joinTeamSpace:a,setUser:o}=Ppe(e.teamInviteCode),[i,l]=F.useState(!1),[c,u]=F.useState(!1);return F.useEffect(()=>{t===wf.JOINING?Nt.message.success({content:"正在加入空间",duration:3e3}):t===wf.ALREADY_IN&&s&&(Nt.message.success({content:"您已是此空间成员，正在跳转至团队空间",duration:3e3}),setTimeout(()=>{e.onSuccess(s.space.uuid)},3e3))},[e,t,s]),t===wf.LINK_ERROR||t===wf.MEMBER_FULL?r.jsx(Kpe,{btnText:n?"回到我的空间":"登录",title:t===wf.LINK_ERROR?"邀请链接已失效":"人数已达上限，请联系管理员增加",onClick:()=>{n?e.goBackHome():(window.location.href="/login",l(i))}}):s?c?r.jsx(r0,{promotionChannel:e.promotionChannel,defaultViewState:{type:Rs.WECHAT_LOGIN},complete:!1,quickRegister:!0,inviteCode:e.inviteCode,styleType:"default",onStep:d=>{d===Rs.LOGIN&&u(!1)},onRegister:d=>{var f;(f=e.onLogin)==null||f.call(e,d)},onSuccess:async d=>{var h;await a(d)&&((h=e.onLogin)==null||h.call(e,d),e.onSuccess(s.space.uuid))}}):r.jsx("div",{className:"flex flex-col items-center",children:r.jsxs("div",{className:"flex flex-col items-center sm:px5 w-[400px] pt-[10vh] h-md:pt-[8vh]",children:[r.jsx(q5,{className:"w-[70px] h-[70px] mx-auto text-[60px]",color:s.space.backgroundColor,name:s.space.title,icon:s.space.icon,iconSize:60}),r.jsxs("div",{className:"text-ellipsis mt-5 text-center",children:["邀请你加入团队",r.jsx("br",{}),s.space.title]}),n&&!i?r.jsxs(r.Fragment,{children:[r.jsx(ii,{colorType:"primary",className:Jf("w-full h-[50px] text-t1-medium h-md:text-h4 !opacity-100 mt-7"),size:"auto",onClick:async()=>{await a(n)&&e.onSuccess(s.space.uuid)},children:"加入团队"}),r.jsxs("div",{className:"text-grey3 text-t4 text-center mt-3",children:["当前账号：",n.nickname,"（",dW(n.phone),"）",r.jsx("span",{className:"text-black cursor-pointer text-t4-medium border-b border-black",onClick:()=>l(!0),children:"切换"})]})]}):r.jsx(r0,{inviteCode:e.inviteCode,promotionChannel:e.promotionChannel,quickRegister:!0,onRegister:d=>{var f;(f=e.onLogin)==null||f.call(e,d)},onSuccess:async d=>{var h;o(d),(h=e.onLogin)==null||h.call(e,d),await a(d)&&e.onSuccess(s.space.uuid)}}),r.jsx("div",{className:"mt-10 h-px w-full bg-grey6 my-7 sm:my-3"}),r.jsx("div",{className:"flex justify-center",children:r.jsx("img",{src:kl.wechatBtn,className:"cursor-pointer mx-3.5 hover:opacity-80",onClick:()=>{u(!0)}})})]})}):null},Kpe=({title:e,btnText:t,onClick:n})=>(F.useEffect(()=>{Nt.setBrowserTitle("访问的页面不存在",{type:"emoji",value:"🌚"})},[]),r.jsxs("div",{className:"cursor-default pt-[10vh] h-md:pt-[8vh] flex flex-col items-center",children:[r.jsx("p",{className:"text-[70px] leading-[80px]",children:"🌚"}),r.jsx("p",{className:"mb-2 text-grey4 text-t1",children:e!=null?e:"访问的页面不存在"}),r.jsx(ii,{colorType:"primary",onClick:n,children:t})]})),Ype=e=>{const{userId:t,onSuccess:n}=e,{password:s,setPassword:a,passwordError:o,setPasswordError:i}=wy(),l=async()=>{if(!Qr.Password.test(s)){i("密码不对");return}const c=await Nt.request.infra.passwordAuthorization.raw({uuid:t,password:Xu(s)});c.code===200?c.data.authorizationCode&&(n(c.data.authorizationCode),i("验证失败")):i(c.msg)};return r.jsxs("div",{className:"next-modal pt-10 pb-5 px-7 flex flex-col items-center min-w-[400px]",children:[r.jsx("div",{className:"mb-5 text-t1-medium",children:"验证登录密码"}),r.jsx(nd,{autoFocus:!0,inputType:"password",value:s,className:"mb-10 w-full",placeholder:"请输入当前登录密码",inputClassName:"px-3 h-8 text-t2",onEnter:()=>void l(),warning:o,onChange:c=>a(c.toString())}),r.jsx(ii,{disable:!s,className:"text-t2 h-8",size:"auto",onClick:()=>void l(),children:"下一步"})]})},Xpe=()=>async e=>{const{phone:t,code:n,onError:s,type:a}=e,o=await Nt.request.infra.phoneAuthorization.raw({phone:t,captcha:n,type:a});if(o.code===200)return o.data;s==null||s(o.msg)},Qpe=e=>{const{phone:t,onSuccess:n}=e,s=Xpe(),{sendVerifyCode:a,verifyCode:o,setVerifyCode:i,verifyCodeError:l,setVerifyCodeError:c}=wy({account:t}),u=async()=>{if(!Qr.VerifyCode.test(o)){c("验证码错误");return}const d=await s({phone:t,code:o,type:At.CaptchaSendType.CHANGE_BIND,onError:c});d!=null&&d.authorizationCode&&n(d.authorizationCode)};return r.jsxs("div",{className:"next-modal pt-10 pb-5 px-7 flex flex-col items-center min-w-[400px]",children:[r.jsx("div",{className:"mb-5 text-t1-medium",children:"验证手机号"}),r.jsxs("div",{className:"mb-5 text-t2",children:["已向注册手机号",t,"发送验证码"]}),r.jsx(nd,{value:o,maxLength:6,type:"number",className:"mb-10 w-full",placeholder:"请输入验证码",inputClassName:"px-3 h-8 text-t2",onEnter:()=>void u(),warning:l,onChange:d=>i(d.toString()),addonAfter:r.jsx(f_,{autoClick:!0,className:"mr-3",showIcon:!1,onSendVerifyCode:()=>a(At.CaptchaSendType.LOGIN)})}),r.jsx(ii,{className:"text-t2 h-8",size:"auto",onClick:()=>void u(),children:"下一步"})]})},Jpe=e=>un?r.jsx("div",{className:"h-11 fixed left-0 top-0 w-screen"}):r.jsxs("div",{className:"w-full px-12 pt-8 flex items-center justify-between sm:px-5",children:[r.jsxs("div",{className:"flex items-center cursor-default",children:[r.jsx(rh,{className:"pointer-events-none m-0"}),r.jsx("span",{className:"text-h2",children:r.jsx("span",{className:"font-extralight ml-5 sm:hidden",children:"FlowUs 息流"})})]}),!e.hideAllLink&&r.jsxs("div",{className:"flex text-t1-medium",children:[r.jsx("a",{href:An.appDownload,children:"下载"}),r.jsx("a",{href:An.product,className:"mx-5",children:"进入官网"}),r.jsx("a",{href:An.helpCenter,children:"帮助中心"})]})]}),rI=e=>r.jsxs("div",{className:"flex justify-between h-full w-full flex-col mx-auto overflow-y-auto",children:[r.jsxs("div",{children:[!e.hideHeader&&r.jsx(Jpe,{hideAllLink:e.hideHeaderLink}),r.jsx("div",{className:"flex flex-col items-center",children:r.jsx("div",{className:"pt-[15vh] h-md:pt-[5vh] sm:w-full w-[400px]",children:e.children})})]}),!e.hideFooter&&r.jsx(N6,{isJoinTeam:e.isJoinTeam,showScoreRule:e.showScoreRule})]}),Zpe=()=>{const e=oy();return F.useCallback(async()=>{let t=e(ms.callbackPath);if(t){const n="/share/";if(t.startsWith(n)){const s=t.slice(n.length);(await Ce.editor.getBlock.raw(s)).code===200&&(t=t.replace("/share",""))}Bs(t);return}Bs(Rt.main)},[e])},ege=()=>{window._agl&&window._agl.push(["track",["success",{t:3}]])},G5="promotionChannel",aI=()=>{const e=localStorage.getItem(G5);if(e){const t=JSON.parse(e),n=t.time;if(Date.now()-n<=3*24*60*60*1e3)return t.promotionChannel;z5()}},z5=()=>{localStorage.removeItem(G5)},tge=()=>{const e=oy(),t=e(ms.inviteCode),n=e(ms.inviteTeam),s=e(ms.quickRegister,"false")==="true",a=Zpe(),[o,i]=F.useState(),l=!!(o&&[Rs.FORGET_PASSWORD,Rs.BIND_PHONE].includes(o));return F.useEffect(()=>{n&&Ce.infra.getMyUserInfo.raw().then(c=>{c.code===200&&ee(Ci.update({...c.data}))})},[n]),n?r.jsx(rI,{hideHeaderLink:!0,isJoinTeam:!0,children:r.jsx(Wpe,{promotionChannel:aI(),inviteCode:t,teamInviteCode:n,goBackHome:()=>{Bs(dd())},onLogin:c=>{ee(Ci.update({...c})),Nn(cd,c.uuid)},onSuccess:async c=>{await Pm(),kS(c),a()}})}):r.jsx(rI,{hideFooter:l,showScoreRule:o===Rs.COMPLETE,children:r.jsx(r0,{titleClassName:"text-h0",autoLogin:!0,quickRegister:s,inviteCode:t,promotionChannel:aI(),onRegister:c=>{ee(Ci.update({...c}))},onSuccess:c=>{if(Nn(cd,c.uuid),z5(),c.spaceViews.length===0&&!s){Bs(Rt.create);return}a()},onStep:c=>{i(c)}})})},O3=()=>{oW({request:Ce,event(e,t,n){ce.event(e,t,n)},message:ye,EmojiIcon:e=>{var t;return r.jsx($s,{iconSize:(t=e.size)!=null?t:24,emojiStr:e.value,disableHover:!0})},afterLogin:()=>{ege()},wechatId:"wx7de87594073bf09f",origin:Mt})};O3();const nge=Object.freeze(Object.defineProperty({__proto__:null,LoginWrapper:tge,init:O3},Symbol.toStringTag,{value:"Module"})),sge=e=>{const{email:t,setEmail:n,emailError:s,verifyCode:a,setVerifyCode:o,verifyCodeError:i,bind:l,sendVerifyCode:c}=rge();return r.jsxs("div",{className:"next-modal p-7 w-[400px]",children:[r.jsx("div",{className:"text-t1-medium ",children:"绑定邮箱"}),r.jsx(xt,{autoFocus:!0,warning:s,className:"w-full h-9 mt-5",inputClassName:"opacity-50",value:t,placeholder:"请输入邮箱",onChange:n}),r.jsx(xt,{type:"number",value:a,maxLength:6,warning:i,className:"w-full h-9 mt-5 px-3",inputClassName:"opacity-50 px-0",placeholder:"请输入验证码",onChange:u=>o(u.toString()),addonAfter:r.jsx(f_,{onSendVerifyCode:()=>c()})}),r.jsx(je,{onClick:async()=>{await l()&&e.onSuccess()},colorType:"active",className:"mt-6",children:"完成绑定"})]})};O3();const rge=()=>{const[e,t]=F.useState(""),[n,s]=F.useState(),[a,o]=F.useState(""),[i,l]=F.useState(""),{bindEmail:c}=V5(),u=()=>R1.Email.test(e)?!0:(s("邮箱格式不正确"),!1),d=()=>R1.VerifyCode.test(a)?!0:(l("验证码错误"),!1);return{email:e,emailError:n,verifyCode:a,verifyCodeError:i,setEmail:t,setVerifyCode:o,sendVerifyCode:async()=>{if(u())return Ce.infra.emailCaptcha({email:e,type:m.CaptchaSendType.BIND_NEW})},bind:async()=>{if(u()&&d())return c(K.user.uuid,e,a)}}},age={[m.UserAuthorizationType.WECHAT]:"微信",[m.UserAuthorizationType.QQ]:"QQ",[m.UserAuthorizationType.APPLE]:"苹果账号",[m.UserAuthorizationType.EMAIL]:"邮箱",[m.UserAuthorizationType.PHONE]:"手机",[m.UserAuthorizationType.PASSWORD]:"密码"},oge=()=>{const e=me(),t=pu();return F.useCallback(n=>{e.warning({title:"是否确认解除绑定?",content:`将无法继续使用${age[n]}登录当前FlowUs账号`,confirmText:"确认",confirm:async()=>{await Ce.infra.unbindAccount(K.user.uuid,{type:n}),await t(),ye.success("解绑成功")}})},[t,e])},ige=un?U5:M5,lge=()=>{const e=me(),t=oge(),n=pu(),{bindWechat:s}=V5();return F.useCallback((a,o)=>{var c,u,d,f;const{user:i}=K;if(o===m.UserAuthorizationType.EMAIL&&((c=i.ext)!=null&&c.email)||o===m.UserAuthorizationType.WECHAT&&((u=i.ext)!=null&&u.wechat)||o===m.UserAuthorizationType.QQ&&((d=i.ext)!=null&&d.qq)||o===m.UserAuthorizationType.APPLE&&((f=i.ext)!=null&&f.apple)){t(o);return}const l=async()=>{await n(),ye.success("绑定成功")};o===m.UserAuthorizationType.EMAIL?e.modal({content:({onCloseModal:h})=>r.jsx(sge,{onSuccess:async()=>{l(),h()}})}):o===m.UserAuthorizationType.WECHAT?e.modal({content:({onCloseModal:h})=>r.jsx("div",{className:"w-[400px]",children:r.jsx(ige,{onAuth:async p=>{const g=await s(K.user.uuid,p);g.code===200?l():g.code===1009?ye.error("该微信已注册"):ye.error(g.msg),h()},switchViewType:()=>{}})})}):(o===m.UserAuthorizationType.QQ||o===m.UserAuthorizationType.APPLE)&&ye.warning("请在移动端进行绑定")},[s,n,e,t])},cge=()=>{const e=me(),t=Qt(),n=pu(),s=qx(),a=()=>{e.warning({title:"确认换绑当前手机号？",confirmText:"确认",cancelText:"取消",minWidth:400,content:r.jsxs("div",{className:"mb-10",children:[r.jsx("div",{children:"换绑后，将无法继续通过以下手机号进行验证登录"}),r.jsx("div",{children:t.phone})]}),confirm:o})},o=()=>{e.warning({title:"身份验证",confirmText:"通过原手机号验证",cancelText:"通过登录密码验证",colorType:"active",minWidth:400,content:r.jsxs("div",{className:"mb-10",children:[r.jsx("div",{className:"mb-1.5",children:"为保障账号安全，请选择验证方式"}),r.jsx("div",{className:"text-grey3 text-t4",children:"原手机号无法接收验证码、忘记密码？请联系人工客服处理"})]}),confirm:()=>{i()},cancel:()=>{l()}})},i=()=>{e.modal({content:u=>r.jsx(Qpe,{phone:t.phone,onSuccess:d=>{u.onCloseModal(),c(d,m.UserAuthorizationType.PHONE)}})})},l=()=>{e.modal({content:u=>r.jsx(Ype,{userId:t.uuid,onSuccess:d=>{u.onCloseModal(),c(d,m.UserAuthorizationType.PASSWORD)}})})},c=(u,d)=>{e.modal({content:f=>r.jsx($5,{type:d,authorizationCode:u,userId:t.uuid,onSuccess:async()=>{f.onCloseModal(),await n(),s(),ye.success("登录已失效，请重新登录")}})})};return r.jsx(r.Fragment,{children:r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t2 mb-0.5",children:"手机号"}),r.jsx("div",{className:"text-t4 text-grey3",children:t.phone})]}),r.jsx(ii,{onClick:a,children:"换绑手机号"})]})})},uge=ia(void 0),dge=()=>{const[e,t]=wm(uge),n=(e==null?void 0:e.status)===2;F.useEffect(()=>{Ce.infra.isAuthentication().then(a=>t(a))},[t]);const s=()=>{dg(An.authentication)};return r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t2 mb-0.5",children:n?`Hi, ${e.name}${e.type==="student"?"同学":"老师"}`:"学生教师认证"}),r.jsx("div",{className:"text-t4 text-grey3",children:n?`${e.schoolName}`:"立即认证，解锁更多福利"})]}),r.jsx(je,{onClick:s,disable:n,children:n?"已认证":"立即认证"})]})},fge=()=>{var y,b,E,w,k,C,T,v,I,j,D,S,R,A;const e=qx(),t=Oa(),n=Qt(),s=Hx(),[a,o]=F.useState(n.nickname),[i,l]=F.useState(n.avatar||""),{setClickMaskClose:c}=ws(la),u=Ma(),d=Epe(),f=me(),h=lge(),p=pu(),g=async()=>{const L=a.trim();Zf(L,"").length>=2&&Zf(L,"").length<=20?(await s({nickname:L,avatar:i},!0),t(),ye.success("保存成功")):ye.error("昵称长度应为2-20个字符")},_=L=>{const P=L.target.files;if(!P)return;const M=P[0];ye.loading({key:Fc.UPLOAD_ICON,content:"上传中..."}),u({file:M,type:"public",searchType:"avatar",onComplete:U=>{ye.closeMessage(Fc.UPLOAD_ICON),U.success&&(L.target.value="",ye.success("上传完成"),l(U.ossName))}})},x=()=>{f.modal({content({onCloseModal:L}){return r.jsx(hpe,{phone:n.phone,type:n.password?vE.BY_OLD_PASSWORD:vE.BY_PHONE,onSuccess:async()=>{await p(),ye.success("设置成功"),L(),ye.success("登录已失效，请重新登录"),e()}})}})};return F.useEffect(()=>{c(n.nickname===a&&i===(n.avatar||""))},[a,n.nickname,c,n.avatar,i]),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:kt.commonStyles.container,children:[r.jsx(kt.Header,{title:"账号设置",name:"头像"}),r.jsxs("div",{className:"mt-4 flex flex-row items-center justify-between",children:[r.jsx(Ps,{name:n.nickname,color:n.backgroundColor,icon:{type:"upload",value:i},className:"w-[60px] !h-[60px] rounded-full mb-3.5 text-white",imgClassName:"rounded-full",style:{fontSize:"30px"}}),r.jsxs("div",{className:"flex flex-row",children:[r.jsx(je,{className:B("text-t2 rounded border border-solid border-grey6 px-4 py-1.5 text-black",{hidden:!i}),onClick:()=>l(""),children:"移除头像"}),r.jsx(je,{className:"text-t2 relative ml-5 rounded border border-solid border-grey6 px-0 text-black",children:r.jsxs("label",{className:"cursor-pointer py-1.5 px-4",children:["上传头像",r.jsx("input",{className:"hidden",type:"file",accept:"image/*",onChange:_})]})})]})]}),r.jsx(kt.SettingDivider,{className:"mb-2.5"}),r.jsx("div",{className:kt.commonStyles.name,children:"昵称"}),r.jsx(xt,{maxLength:20,className:kt.commonStyles.input,value:a,inputClassName:"h-8",placeholder:"请输入您的昵称，长度需在2-20个字符之间",...bn(Bn.settingAccountInput),onEnter:()=>g(),onChange:L=>o(`${L}`)}),r.jsx(kt.SettingDivider,{}),r.jsx(cge,{}),r.jsx(kt.SettingDivider,{}),r.jsx(dge,{}),r.jsx(kt.SettingDivider,{}),r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsx("div",{className:"text-t2 mb-0.5",children:"登录密码"}),r.jsx(je,{onClick:x,children:n.password?"修改密码":"设置密码"})]}),r.jsx(kt.SettingDivider,{}),r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t2 mb-0.5",children:"邮箱"},"email"),((y=n.ext)==null?void 0:y.email)&&r.jsx("div",{className:"text-t4 text-grey3",children:n.ext.email.id})]}),r.jsx(je,{onClick:L=>{h(L,m.UserAuthorizationType.EMAIL)},children:r.jsx("div",{className:"text-t2 mb-0.5",children:(b=n.ext)!=null&&b.email?"解除绑定":"绑定邮箱"})})]}),r.jsx(kt.SettingDivider,{}),r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t2 mb-0.5",children:"微信"}),((E=n.ext)==null?void 0:E.wechat)&&r.jsx("div",{className:"text-t4 text-grey3",children:(k=(w=n.ext)==null?void 0:w.wechat)==null?void 0:k.nickname})]}),r.jsx(je,{onClick:L=>{h(L,m.UserAuthorizationType.WECHAT)},children:r.jsx("div",{className:"text-t2 mb-0.5",children:(C=n.ext)!=null&&C.wechat?"解除绑定":"绑定微信"})})]}),r.jsx(kt.SettingDivider,{}),r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t2 mb-0.5",children:"QQ"}),((v=(T=n.ext)==null?void 0:T.qq)==null?void 0:v.nickname)&&r.jsx("div",{className:"text-t4 text-grey3",children:n.ext.qq.nickname})]}),r.jsx(je,{onClick:L=>{h(L,m.UserAuthorizationType.QQ)},children:r.jsx("div",{className:"text-t2 mb-0.5",children:(I=n.ext)!=null&&I.qq?"解除绑定":"绑定QQ"})})]}),r.jsx(kt.SettingDivider,{}),r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t2 mb-0.5",children:"Apple ID"}),((j=n.ext)==null?void 0:j.apple)&&r.jsx("div",{className:"text-t4 text-grey3",children:((D=n.ext)==null?void 0:D.apple.nickname)||((S=n.ext)==null?void 0:S.apple.email)||((R=n.ext)==null?void 0:R.apple.id)})]}),r.jsx(je,{onClick:L=>{h(L,m.UserAuthorizationType.APPLE)},children:r.jsx("div",{className:"text-t2 mb-0.5",children:(A=n.ext)!=null&&A.apple?"解除绑定":"绑定Apple ID"})})]}),r.jsx(kt.SettingDivider,{}),r.jsx("div",{className:"flex w-full justify-end py-2.5",children:r.jsx(je,{colorType:"red",onClick:()=>{d()},children:"注销账户"})})]}),r.jsx(kt.FooterBar,{cancel:()=>t(),confirm:g})]})},oI=e=>{const{addonBefore:t,text:n,active:s,onClick:a,staticStyle:o,activeStyle:i="icon",addonAfter:l,className:c,description:u,showPopup:d,dataTestId:f,badge:h,...p}=e;return r.jsxs("div",{onClick:a,...bn(f),...p,className:B("flex relative items-center justify-between h-10 cursor-pointer px-2 rounded",o?"text-grey3":"text-black",i==="bg"?!s&&"animate-hover hover:bg-black_003":"animate-hover",s&&i==="bg"&&"normal-bg",c),children:[r.jsxs("div",{className:"flex items-center w-10/12",children:[r.jsx("span",{className:"mr-2 flex items-center",children:t}),r.jsxs("div",{className:"w-full text-ellipsis",children:[r.jsx(Fe,{popup:d?n:"",className:"text-ellipsis w-full block",children:n}),u&&r.jsx("div",{className:"text-ellipsis text-grey3 text-t4 mt-px w-full",children:u})]})]}),s&&i==="icon"&&r.jsx(H,{name:"IcSelectedSpace",size:"middle"}),l,h]})},mge=F.memo(()=>{const e=Oa(),{currentSettingMenu:t,setCurrentSettingMenu:n}=ws(la),s=Qt(),a=qd(),{editor:o}=a(s.uuid),i=qx(),l=Ui(),c=Uj(),u=f=>{n(f)},d=F.useMemo(()=>{const f=[{type:Jt.line,name:"账号"},{type:Jt.account,icon:"MIcSettingsAccount",name:"账号设置"},{type:Jt.general,icon:"IcSettingsGeneral",name:"通用设置"},{type:Jt.integral,icon:"MIcSettingsInvite",name:"活动中心",badge:c?r.jsx("span",{className:"flex items-center absolute right-8 top-0.5 text-t4-bold px-1.5 text-red rounded-sm",children:"NEW"}):null},{type:Jt.line,name:"空间"}];return o&&f.push({icon:"MIcSettingsSpace",type:Jt.spaceInfo,name:"空间信息"}),f.push({icon:"MIcListSeetings",type:Jt.space,name:"空间设置"}),l||(f.push({icon:"MIcSettingsMembers",type:Jt.members,name:"空间成员"}),f.push({icon:"MIcSettingsUpdate",type:Jt.upgrade,name:"升级"}),o&&f.push({icon:"MIcSettingsOrder",type:Jt.order,name:"订单"})),f},[o,c,l]);return r.jsxs("div",{className:"flex flex-col shrink-0 px-2 pt-3 w-44 text-grey3 bg-white3 border-r border-grey7 border-solid text-t2 overflow-y-auto",children:[r.jsxs("div",{className:"flex-1",children:[d.map(f=>f.type===Jt.line?r.jsx("span",{className:"flex items-center px-2 h-9 text-t2",children:f.name},f.name):r.jsx(oI,{dataTestId:f.name,activeStyle:"bg",active:f.type===t,text:f.name,onClick:()=>u(f.type),addonBefore:r.jsx(H,{name:f.icon,size:"middle"}),badge:f.badge},f.name)),r.jsx(kt.SettingDivider,{className:"mx-2 mt-[10px] mb-[9px]","list-item-inactive":""}),r.jsx(oI,{staticStyle:!0,text:"退出登录",onClick:()=>{ce.logout(),i(),e()},addonBefore:r.jsx(H,{name:"MIcSettingsLogout",size:"middle"})})]}),r.jsxs("div",{className:"px-2 text-grey4 text-t3",children:[r.jsx(pge,{}),r.jsx(hge,{}),r.jsxs("div",{className:"flex justify-between items-center h-14",children:[r.jsx("a",{className:"border-b border-grey6",target:"_blank",href:An.userAgreement,rel:"noreferrer",children:"用户协议"}),r.jsx("span",{className:"w-px h-3.5 bg-grey6"}),r.jsx("a",{className:"border-b border-grey6",target:"_blank",href:An.privacyPolicy,rel:"noreferrer",children:"隐私条款"})]})]})]})}),hge=F.memo(()=>{if(!un)return null;const e=()=>{ri(Ss.ClearCacheAndReload)};return r.jsx(Fe,{arrow:!0,popup:"用久了有点卡顿？点我试试",className:"text-active_color animate-click inline",onClick:e,children:"清理缓存重启"})}),pge=F.memo(()=>{const e=me(),t=LC(),n=rY(),s=sY(),[a,o]=F.useState(null);F.useEffect(()=>{tp&&Vte().then(c=>{if(c){const u=Qa(c);Qa(`${t}`)<u&&o(c)}})},[t]);const i=F.useCallback(()=>{s?(ri(Ss.UpdateReload),e.loading({className:"h-auto px-4 py-6",autoClose:!0,keyboard:!0,title:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{children:"正在安装更新"}),r.jsxs("div",{className:"text-t3",children:["安装过程中可能会自动重启App",r.jsxs("div",{className:"text-t4 text-grey3 mt-1",children:["若更新过程中出现异常，或长时间无反应",r.jsx("br",{}),r.jsxs(r.Fragment,{children:["请点击",r.jsx("a",{href:An.appDownload,target:"_blank",className:"text-active_color",children:"下载最新安装包"}),"，覆盖安装即可"]})]})]})]})})):(ye.loading("检查更新App"),ri(Ss.CheckForUpdates))},[s,e]),l=F.useMemo(()=>tp?a?r.jsxs("a",{href:An.appDownload,target:"_blank",className:"text-active_color animate-click",children:["下载新版 ",a]}):r.jsx("div",{children:"暂无更新"}):r.jsxs("div",{children:[n&&r.jsx("span",{className:"mr-2",children:s?"新版就绪":"正在下载"}),r.jsx("span",{onClick:i,className:"text-active_color animate-click mt-1",children:s?"立即更新":"检查更新"})]}),[n,s,i,a]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:["版本：","1.53.0-2023/5/19 15:41:37"]}),t&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:["App版本：",t]}),l]})]})}),W5=()=>{const e=Hx(),t=Qt();return n=>{var a;const s=(a=t.setting)!=null?a:{};e({setting:{...s,...n}},!0)}},qs=({title:e,description:t,showSpacePlan:n,from:s,rightPart:a,showSplitLine:o=!0,className:i})=>{const l=di(),{setCurrentSettingMenu:c,setIsFrom:u}=ws(la),d=Ft();return r.jsxs("div",{className:Yt("mt-2.5",i),children:[o&&r.jsx(kt.SettingDivider,{}),r.jsxs("div",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-t2 text-black",children:e}),n&&l&&r.jsx("div",{onClick:()=>{s&&u(s),c(Jt.upgrade)},className:"bg-grey6 text-t4 text-grey3 animate-hover ml-2 rounded-sm px-1.5 py-0.5",children:cr(d.planType)})]}),a]}),t&&r.jsx("div",{className:"text-t3 text-grey3",children:t})]})},gge=()=>F.useCallback(async e=>{const t=await Ce.editor.getDoc.raw(e);if(t.code!==200)return t.code;ee(Gn.update({blocks:t.data.blocks}))},[]),K5=qe(),Y5=qe(),NE=qe(),iI=e=>!!(e!==void 0&&[m.BlockType.PAGE,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.COLLECTION_VIEW].includes(e)),_ge=()=>{var C;const e=F.useRef(null),t=gge(),n=pg(),s=me(),a=Qt(),o=Uw(),i=ae(T=>T.spaceViews),l=pu(),c=Hx(),u=()=>{const T=A8(Object.values(i).filter(I=>!Ux(K.spaces[I.spaceId])),["createBy"],["desc"]),v=T.filter(I=>I.setting.clipperPage);return v.length>0?pn(v):Sa(T)},[d,f]=F.useState(()=>{var T;return a.clipperLocation?a.clipperLocation:(T=u())==null?void 0:T.setting.clipperPage}),h=_e(d,["data"],["segments"]),[p,g]=F.useState((h==null?void 0:h.spaceId)||((C=u())==null?void 0:C.spaceId)||Ut()),_=o.find(T=>T.uuid===p),x=V1(p),y=sy(),b=T=>{f(T),n(async()=>{y(x,{setting:{clipperPage:T}}),await c({clipperLocation:T},!0),await l(),ye.success("保存成功")})},E=async T=>{var j,D,S;g(T);const v=V1(T),I=(j=TS(v))==null?void 0:j.setting.clipperPage;f(I),I&&I!==a.clipperLocation?(await c({clipperLocation:I},!0),ye.success("保存成功")):I||(await xs(200),(S=(D=e==null?void 0:e.current)==null?void 0:D.click)==null||S.call(D))},w=T=>{s.dropdown({modalId:K5,popcorn:T.currentTarget,placement:"bottom-end",offset:[0,8],content:()=>r.jsx(yge,{onItemClick:E})})},k=T=>{p&&s.dropdown({modalId:Y5,popcorn:T.currentTarget,placement:"bottom-end",offset:[0,8],content:()=>r.jsx(xge,{spaceId:p,onItemClick:v=>{b(v)}})})};return F.useEffect(()=>{!d||K.blocks[d]||t(d)},[t,d]),F.useEffect(()=>{h!=null&&h.spaceId&&g(h.spaceId)},[h==null?void 0:h.spaceId]),r.jsxs(r.Fragment,{children:[r.jsx(kt.Item,{leftChild:"设置剪藏保存位置"}),r.jsx(kt.Item,{leftChild:"选择空间",rightChild:r.jsx(kt.DropdownButton,{onClick:w,content:_?r.jsxs("div",{className:"flex items-center",children:[r.jsx(tn,{iconSize:18,blockId:_.uuid,trigger:!1}),r.jsx("span",{className:"ml-2",children:_.title})]}):r.jsx("div",{className:"text-grey3",children:"请选择"})})}),r.jsx(kt.Item,{leftChild:"添加到",rightChild:r.jsx(kt.DropdownButton,{onClick:k,disabled:!_,content:r.jsx("div",{ref:e,children:_?h?r.jsxs("div",{className:"flex items-center",children:[r.jsx(tn,{iconSize:18,blockId:h.uuid,trigger:!1}),r.jsx("span",{className:"ml-2",children:de(h==null?void 0:h.data.segments)||Ot(h.type)})]}):r.jsx("div",{className:"text-grey3",children:"新建我的剪藏"}):r.jsx("div",{className:"text-grey3",children:"请先选择空间"})})})}),r.jsx(bge,{})]})},xge=e=>{const t=me(),{onItemClick:n,spaceId:s}=e,[a,o]=F.useState([]),i=c=>{var f;const{role:u}=hn(c),d=K.blocks[c];if(d){if(!iI(d==null?void 0:d.type)){ye.error("只能选择页面或收藏多维表");return}if(d.type!==m.BlockType.PAGE&&!((f=d.data.format)!=null&&f.isCutStoreContainer)){ye.error("请保存到收藏多维表中");return}[m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(u)?(n(c),t.closeModal(Y5)):ye.error("对该页面无可编辑权限")}},l=()=>{t.modal({modalId:NE,content:()=>r.jsx(Fge,{spaceId:s,onSelect:i})})};return F.useEffect(()=>{Ce.editor.querySpaceVisitsHistory(s,0).then(c=>{var u,d;if((u=c==null?void 0:c.recordMap)!=null&&u.blocks){ee(Gn.update({blocks:c.recordMap.blocks}));const f=[];(d=c.results)==null||d.forEach(({uuid:h})=>{var g,_;const p=(_=(g=c.recordMap)==null?void 0:g.blocks)==null?void 0:_[`${h}`];p&&p.status===m.BlockStatus.NORMAL&&f.push(Ax(p))}),o((f!=null?f:[]).filter(h=>iI(h==null?void 0:h.type)))}})},[s]),r.jsx(Tk,{className:"next-modal py-2.5 relative",searchType:"page",defaultValue:a,onSelect:({uuid:c})=>i(c),placeholder:"搜索页面",spaceId:s,footer:r.jsxs("div",{className:"absolute bottom-0 w-full flex items-center h-10 px-4 bg-white2 border-t border-grey6 text-t2 text-grey3 cursor-pointer rounded-tl-none rounded-tr-none",onClick:l,children:[r.jsx(H,{size:"middle",name:"MIcAddNew",className:"mr-2"}),"新建收藏列表"]})})},Fge=e=>{const t=me(),n=Hd(),s=N5(),a=ke(),[o,i]=F.useState("我的剪藏"),{spaceId:l,onSelect:c}=e,u=()=>{a(()=>{const d=n(m.BlockType.PAGE,{parentId:l,last:!0},cs.PRIVATE);if(!d){ye.error("没有权限，创建失败");return}const f=Ex(!0);pe(d,{data:{icon:{type:"emoji",value:f},segments:mt(o),format:{isCutStoreContainer:!0}}}),s(d,m.CollectionViewType.GALLERY),c(d)}),t.closeModal(NE)};return r.jsxs("div",{className:"next-modal p-2.5 w-80",children:[r.jsx(xt,{autoFocus:!0,value:o,onChange:i,className:"h-8 my-3 mx-1",placeholder:"请输入页面名"}),r.jsxs("div",{className:"flex pt-1 justify-end",children:[r.jsx(je,{colorType:"secondary",onClick:()=>t.closeModal(NE),children:"取消"}),r.jsx(je,{className:"ml-2.5",colorType:"active",onClick:u,children:"创建"})]})]})},yge=e=>{const{onItemClick:t}=e,n=Kt(),[s,a]=F.useState(""),o=Uw(),i=F.useMemo(()=>o.map(c=>({type:$.SEARCH,data:{...c,type:"SPACE",title:c.title,icon:c.icon,backgroundColor:c.backgroundColor}})),[o]),l=c=>{if(Ux(c)){ye.error("对该空间无可编辑权限");return}t(c.uuid),n(K5)};return r.jsx(ze,{items:i,className:"w-64 next-modal",scrollClassName:"overflow-y-auto max-h-64 pb-2",onItemClick:c=>{l(c.data)},customHeader:r.jsx(xt,{className:"h-8 m-2.5",placeholder:"搜索空间",autoFocus:!0,value:s,onChange:a})})},bge=()=>r.jsx(qs,{title:"使用微信剪藏",description:"通过微信剪藏助手，发送信息到FlowUs",rightPart:r.jsx(eu,{link:An.weChatClipper,linkContainer:!0,className:"text-active_color border-b border-active_color",iconClassName:"hidden",children:"如何使用剪藏？"})}),Ege={default:"默认字体",lxgwWenKai:"霞鹜文楷",sourceHanSerif:"思源宋体"},wge={default:"默认布局",compact:"紧密布局",loose:"宽松布局"},kge=()=>{var _,x;Lr();const e=Ro(),t=me(),n=qw(),s=sy(),a=di(),o=Ft(),i=QF(),l=a?"default":(_=n==null?void 0:n.setting.fontFormat)!=null?_:"default",c=a?"default":(x=n==null?void 0:n.setting.pageLayout)!=null?x:"default",u=ke(),d=y=>{if(a&&(y==="lxgwWenKai"||y==="sourceHanSerif")){i(()=>{e(Vt.custom_font_layout)});return}u(()=>{n&&s(n.uuid,{setting:{fontFormat:y}})})},f=y=>{if(a&&(y==="compact"||y==="loose")){i(()=>{e(Vt.custom_font_layout)});return}u(()=>{n&&s(n.uuid,{setting:{pageLayout:y}})})},h=y=>{t.dropdown({popcorn:y.currentTarget,content:({onCloseModal:b})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:tv.map((E,w)=>({type:$.OPERATION,data:{title:E.title,value:E.value,selected:l===E.value,rightText:a&&w!==0?r.jsx(lI,{}):"",className:w===1?`font-[${Rp.lxgwWenKai}]`:w===2?`font-[${Rp.sourceHanSerif}]`:""}})),onItemClick:(E,w)=>{const k=tv[w];k&&d(k.value),b()}})})},p=y=>{t.dropdown({popcorn:y.currentTarget,content:({onCloseModal:b})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:nv.map((E,w)=>({type:$.OPERATION,data:{title:E.title,value:E.value,selected:c===E.value,rightText:a&&w!==1?r.jsx(lI,{}):""}})),onItemClick:(E,w)=>{const k=nv[w];k&&f(k.value),b()}})})};let g="";return o.planType==="freePersonal"?g="个人专业版":o.planType==="freeTeam"&&(g="团队版"),r.jsxs(r.Fragment,{children:[r.jsx(kt.SettingDivider,{}),r.jsxs("div",{className:"flex items-center mt-5",children:[r.jsx("div",{className:"text-t2 ",children:"新建页面字体及布局设置"}),g&&r.jsx("div",{className:"px-1.5 py-0.5 text-center ml-2 rounded text-t2 text-grey2 bg-grey/20",children:g})]}),r.jsx("div",{className:"text-t3 mt-1 text-grey3",children:"新建文档/多维表页面会默认为指定样式，仅在当前空间账号下生效"}),r.jsx(qs,{showSplitLine:!1,title:"字体样式",rightPart:r.jsx(kt.DropdownButton,{onClick:h,content:Ege[l!=null?l:"default"]})}),r.jsx(qs,{className:"mt-0",showSplitLine:!1,title:"布局样式",rightPart:r.jsx(kt.DropdownButton,{onClick:p,content:wge[c!=null?c:"default"]})})]})},lI=()=>r.jsx("div",{className:"flex items-center justify-center w-7 h-4 absolute left-[66px] top-1",style:{background:"linear-gradient(89.52deg, #F3E4B5 0.34%, #E9C770 99.54%)",borderRadius:"10px 10px 10px 2px"},children:r.jsx("span",{className:"text-t4",style:{color:"#8F6C28"},children:"Pro"})}),Cge=()=>{var i,l;const e=me(),t=Qt(),n=W5(),s=(l=(i=t.setting)==null?void 0:i.pageWidthMode)!=null?l:Q1.FIXED,a=ev.find(c=>c.value===s),o=c=>{e.dropdown({popcorn:c.currentTarget,content:({onCloseModal:u})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:ev.map(d=>({type:$.OPERATION,data:{title:d.title,value:d.value,selected:s===d.value}})),onItemClick:d=>{n({pageWidthMode:d.data.value}),u()}})})};return r.jsx(qs,{title:"新建页面宽度",description:"新建文档页面会默认为指定方式",rightPart:r.jsx(kt.DropdownButton,{onClick:o,content:a==null?void 0:a.title})})},Tge=()=>{var h,p,g,_,x,y,b;const e=pu(),t=Oa(),n=me(),s=aD(),a=Qt(),o=W5(),i=JT.find(E=>E.value===s),l=Sd(),c=(p=(h=a.setting)==null?void 0:h.openPageMode)!=null?p:yk.JUMP,u=ZT.find(E=>E.value===c),d=E=>{n.dropdown({popcorn:E.currentTarget,content:({onCloseModal:w})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:JT.map((k,C)=>({type:$.OPERATION,data:{title:k.title,value:k.value,selected:(i==null?void 0:i.value)===k.value,tip:C===0?void 0:`${Gt}+Shift+L`}})),onItemClick:k=>{Nn($j,k.data.value),Ye({$theme:k.data.value}),w()}})})},f=E=>{n.dropdown({popcorn:E.currentTarget,content:({onCloseModal:w})=>r.jsx(ze,{className:"next-modal w-36 py-2.5",items:ZT.map((k,C)=>({type:$.OPERATION,data:{title:k.title,value:k.value,selected:c===k.value,tip:C===0?void 0:`${tp?"Alt":"Option"}+点击`}})),onItemClick:k=>{o({openPageMode:k.data.value}),w()}})})};return F.useEffect(()=>{e()},[e]),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:kt.commonStyles.container,children:[r.jsx(kt.Header,{title:"通用设置"}),r.jsx(kt.Item,{leftChild:"主题",rightChild:r.jsx(r.Fragment,{children:r.jsx(kt.DropdownButton,{onClick:d,content:i==null?void 0:i.title})})}),r.jsx(kt.SettingDivider,{className:"mb-2.5"}),r.jsx(_ge,{}),r.jsx(qs,{title:"默认页面打开方式",description:"单击页面默认会以指定的方式打开",rightPart:r.jsx(kt.DropdownButton,{onClick:f,content:u==null?void 0:u.title})}),r.jsx(qs,{title:"使用右侧栏显示新建页面",description:"开启后，新建页面会显示在右侧栏中",rightPart:r.jsx(wn,{open:!!((g=a.setting)!=null&&g.useRightPageByNew),onSwitch:E=>{o({useRightPageByNew:E})}})}),r.jsx(Cge,{}),r.jsx(qs,{title:"新建页面目录",description:"新建文档页面的目录开启状态",rightPart:r.jsx(wn,{open:!!((_=a.setting)!=null&&_.directoryMenu),onSwitch:E=>{o({directoryMenu:E})}})}),r.jsx(kge,{}),r.jsx(qs,{title:"内容预览浮窗",description:"对页面/文件及引用内容支持浮窗预览",rightPart:r.jsx(wn,{open:((x=a.setting)==null?void 0:x.previewDialog)===void 0||((y=a.setting)==null?void 0:y.previewDialog),onSwitch:E=>{o({previewDialog:E})}})}),r.jsx(qs,{title:r.jsxs(r.Fragment,{children:["高性能模式",r.jsx("span",{className:"text-t2 px-1.5 bg-grey/20 rounded-sm ml-2 text-grey2 inline-flex items-center",children:"Beta"})]}),description:"开启后，部分内容量大的页面将以高性能模式运行，但会无法使用一些功能，例如浏览器自带的搜索功能",rightPart:r.jsx(wn,{open:!!((b=a.setting)!=null&&b.enableHighPerformance),onSwitch:E=>{o({enableHighPerformance:E})}})}),r.jsx(qs,{title:"低配置模式",description:"减少部分动画以提高流畅度",rightPart:r.jsx(wn,{open:l,onSwitch:E=>{Ye({$lowConfig:E}),localStorage.setItem("LOW_CONFIG",`${E}`)}})})]}),r.jsx(kt.FooterBar,{cancel:()=>t(),cancelText:"关闭"})]})},X5=No(()=>({})),vge=(e,t)=>{X5.setState(n=>(n[e]||(n[e]={}),n[e]=t,n))},m_=()=>{const e=Qt();return X5(t=>t[e.uuid]||{},rn)},Nge=async()=>{const e=Vx(),t=await Ce.infra.creditBalanceStatistics();vge(e.uuid,{integralInfo:t})},Ige=()=>{const e=NF(),t=Mj();if(t.length===0)return null;const n=o=>{o.uuid&&(ce.event("online_activity_click",{activity_id:o.uuid}),dg(o.link),e(o.uuid,{onlyViewed:!0}))},s=o=>{o.link&&on(o.link,{message:"已复制链接"})},a=(o,i="")=>r.jsx("span",{className:Yt("absolute -top-px -left-px text-t4 bg-black-base text-white px-2.5 py-0.5 flex items-center justify-center rounded-tl rounded-br",i),children:o});return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex mt-2.5 items-center text-t2 h-9 top-0",children:"线上活动"}),t.map(o=>{var d,f;const i=o.status==="abandoned",l=o.status==="completed",c=!o.viewed&&!i;let u=r.jsx(r.Fragment,{});return i?u=a("已下线"):c?u=a("NEW","top-0 left-0"):l&&(u=a("已完成")),r.jsx("div",{className:Yt("flex h-[110px] mb-2.5 items-center w-full cursor-pointer",{"p-1.5":!c}),onClick:()=>n(o),children:r.jsxs("div",{className:Yt("flex items-center border w-full rounded relative",{"border-active_color/20 bg-active_color/10 p-1.5":c,"border-black/10":["completed","abandoned"].includes(`${o.status}`)}),children:[r.jsx("div",{className:"h-[98px] mr-4 bg-grey6 w-[160px] bg-cover bg-center",style:{backgroundImage:`url(${(f=(d=o.resourceList)==null?void 0:d[0])==null?void 0:f.imgUrl})`},children:u}),r.jsxs("div",{className:"flex items-center justify-between w-[calc(100%-160px-22px)]",children:[r.jsxs("div",{className:Yt("overflow-hidden flex flex-col w-full",i&&"opacity-60"),children:[r.jsx("div",{className:"text-t2-medium text-ellipsis mb-1.5",children:o.name}),r.jsx("div",{className:"text-t2 text-grey3 text-ellipsis mb-2",children:o.synopsis}),r.jsxs("div",{className:"text-t4 text-grey3 mt-auto flex items-center",children:[r.jsx(H,{name:"IcTitleTime",size:"middle",className:"mr-0.5"}),o.type==="standing"?"长期活动":r.jsxs(r.Fragment,{children:[o.startTime&&he(o.startTime).format("MM月DD日"),o.endTime&&` - ${he(o.endTime).format("MM月DD日")}`]})]})]}),r.jsx(Js,{className:"self-start",size:20,children:o.link&&!i&&r.jsx(H,{name:"IcFormShare",size:"middle",className:Yt("cursor-pointer",c?"text-active_color":"text-grey3"),onClick:h=>{h.stopPropagation(),s(o)}})})]})]})},o.uuid)})]})},jge=()=>{const e=Qt(),{integralInfo:t}=m_(),n=s=>{on(s===0?`${Sn()}${Rt.login}?${ms.inviteCode}=${e.inviteCode}`:e.inviteCode),ce.event(s===0?"invite_copylink":"invite_copycode")};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2-regular mt-6 mb-0.5",children:"邀请赚积分"}),r.jsxs("span",{className:"text-t4 text-grey3 mb-2.5",children:["你已邀请",t==null?void 0:t.invitedNum,"人，累计获得",t==null?void 0:t.invitedScore,"积分。"]}),r.jsx("div",{children:[{title:"链接邀请",icon:"IcUrl",text:"好友通过此链接成功注册，双方均可获得积分",button:"复制链接",iconBg:"bg-pink",type:0},{title:`邀请码邀请: ${e.inviteCode}`,icon:"IcCode",iconBg:"bg-pink_purple",text:"好友注册时，填入此邀请码，双方均可获得积分",button:"复制邀请码",type:1},{title:"创建优质内容页并开启分享，好友通过分享页注册",icon:"IcMenuDuplicate",iconBg:"bg-purple",text:"好友在你创建的分享页进行注册，双方均可获得积分",right:r.jsxs("a",{className:"text-grey4 text-t2 flex items-center",href:An.helperShare,target:"_blank",rel:"noreferrer",children:[r.jsx(H,{name:"IcInviteHelp",size:"middle",className:"mr-1"}),r.jsx("span",{children:"如何分享页面"})]}),type:1}].map(s=>r.jsxs("div",{className:"w-full",children:[r.jsxs("div",{className:"w-full flex items-center h-[58px]",children:[r.jsx(Js,{size:30,className:B("rounded-full text-white mr-2",s.iconBg),children:r.jsx(H,{name:s.icon,size:"middle"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-t2-regular mb-0.5 flex items-center",children:s.title}),r.jsx("div",{className:"text-t4 text-grey3",children:s.text})]}),s.button&&r.jsx(je,{className:"border-grey5",onClick:()=>n(s.type),children:s.button}),s.right&&s.right]}),r.jsx(kt.SettingDivider,{})]},s.title))})]})},Dge=()=>{const e=F.useRef(null),[t,n]=F.useState({total:0,list:[]});F.useEffect(()=>{s(1)},[]);const s=async a=>{const o=await Ce.infra.creditIncomes(a,20);n(i=>({total:o.total,list:a===1?o.list:[...i.list,...o.list]}))};return r.jsx("div",{ref:e,className:"flex flex-col overflow-y-auto flex-1 min-w-[500px] h-[600px]",children:r.jsxs(Il,{className:"flex flex-col px-5",pageStart:1,initialLoad:!1,useWindow:!1,loadMore:s,getScrollParent:()=>e.current,hasMore:t.total>t.list.length,children:[r.jsx("div",{className:"flex mt-2.5 items-center text-t2 h-9",children:"积分记录"}),t.list.map(a=>r.jsxs("div",{className:"flex w-full justify-between items-center",children:[r.jsxs("div",{className:"flex flex-col justify-center h-14",children:[r.jsx("div",{className:"text-t2",children:a.title}),a.createdAt&&r.jsx("div",{className:"text-grey3 text-t4",children:aY(a.createdAt)})]}),r.jsxs("div",{className:"text-t2 flex flex-col items-end",children:[r.jsx("span",{children:a.score?a.score<0?a.score:`+${a.score}`:""}),a.score===0&&r.jsx("span",{className:"text-t4 text-grey3",children:"积分达到上限"})]})]},a.id)),!t.list.length&&r.jsx("div",{className:"text-t2 text-grey4 mt-2",children:"暂无记录，快去邀请好友吧～"})]})})},Sge=()=>{const{integralInfo:e}=m_(),t=me(),n=()=>{t.warning({title:"积分兑换活动",content:"FlowUs 不定期推出积分兑换活动，以鼓励用户深入了解平台，请关注活动变化和积分规则。",confirmText:"知道了",noCancel:!0})},s=()=>{t.modal({content:Dge})};return r.jsx("div",{className:"flex items-center my-1 rounded bg-yellow/10 border border-yellow/20 h-20 px-3",children:r.jsxs("div",{className:"flex items-start w-full",children:[r.jsx(Js,{size:24,className:"self-start mt-1",children:r.jsx($s,{emojiStr:"💎",iconSize:22,disableHover:!0})}),r.jsxs("div",{className:"ml-3 flex flex-col flex-1",children:[r.jsxs("div",{className:"text-t1 mb-1 flex items-center",children:[r.jsx("span",{children:"我的积分："}),r.jsx("span",{className:"text-t1-medium",children:e==null?void 0:e.currentScore}),!!(e!=null&&e.todayScore)&&r.jsxs("span",{className:"ml-2.5 text-t4 text-white-base bg-yellow px-1.5 py-px rounded-sm",children:["今日 +",e.todayScore]}),!!(e!=null&&e.aboutToExpireScore)&&r.jsxs("span",{className:"ml-2.5 px-2.5 py-px bg-grey/20 text-grey2/80 text-t3 rounded-sm",children:["你有",e.aboutToExpireScore,"积分将于本月过期"]})]}),r.jsxs("span",{className:"flex items-center text-grey3 text-t4 cursor-pointer",onClick:s,children:["查看积分记录",r.jsx(H,{size:"xxxsmall",name:"IcArrowUnfold",className:"ml-1"})]})]}),r.jsx("div",{className:"ml-auto cursor-pointer self-center text-t2-medium",style:{color:YE(Pe.yellow)},onClick:n,children:"去兑换"})]})})},Rge=({onCloseModal:e})=>{var u;const t=ks(),n=nz(Ae.GUIDE_FIRST_TIME_CREATED_SPACE),[s,a]=F.useState(0),[o,i]=F.useState(!1),l=(n==null?void 0:n.resourceList)||[];F.useEffect(()=>{s===l.length-1&&i(!0)},[s,l.length]);const c=()=>{e(),o&&t(Ae.GUIDE_FIRST_TIME_CREATED_SPACE,We.basicList,{completed:!0})};return r.jsxs("div",{className:"bg-grey9 pb-8 rounded-md",children:[r.jsxs("div",{className:"flex justify-between items-center h-20 px-7",children:[r.jsxs("a",{href:An.integralRule,target:"_blank",rel:"noreferrer",className:"text-t2 text-grey3 flex items-center",children:[r.jsx(H,{name:"IcInviteInfo",className:"mr-1",size:"middle"}),"积分规则"]}),r.jsxs("span",{className:"text-h2",children:["观看完成可领积分 ",r.jsxs("span",{className:"text-active_color",children:["+",n==null?void 0:n.score]})]}),r.jsx("span",{className:"text-t2 cursor-pointer",onClick:()=>c(),children:"关闭"})]}),r.jsxs("div",{className:"px-20 relative",children:[r.jsx(H,{name:"MIcBtnPre",size:"auto",className:B("swiper-pre absolute top-1/2 z-10 w-16 h-16 animate-click left-11",s===0&&"opacity-30 pointer-events-none")}),r.jsx(H,{name:"MIcBtnNext",size:"auto",className:B("swiper-next absolute top-1/2 z-10 w-16 h-16 animate-click right-11",l.length-1===s&&"opacity-30 pointer-events-none")}),r.jsx(GE,{navigation:{nextEl:".swiper-next",prevEl:".swiper-pre"},mousewheel:!0,className:"max-h-[560px] h-[60vh] w-[896px] mb-2.5 rounded-xl border border-black_006",slidesPerView:"auto",keyboard:{enabled:!0,onlyInViewport:!0},modules:[YI,XI,QI],onActiveIndexChange:d=>a(d.realIndex),children:l.map(d=>r.jsx(zE,{className:"bg-no-repeat bg-contain bg-center",style:{backgroundImage:`url(${d.imgUrl})`}},d.content))}),r.jsx("div",{className:"mb-4 flex justify-center",children:l.map((d,f)=>r.jsx("span",{className:B("h-2 w-2 rounded-full mx-1",f===s?"bg-active_color":"bg-grey5")},f))})]}),r.jsx("div",{className:"px-20 text-xl min-h-[56px] flex items-center justify-center",children:(u=l[s])==null?void 0:u.content}),r.jsx(je,{disable:!o,onClick:()=>c(),colorType:"active",size:"large",className:"w-96 mt-6 mx-auto",children:"完成"})]})},Age=()=>{const e=me(),t=Kt();return F.useCallback(n=>{e.modal({modalId:Ae.GUIDE_FIRST_TIME_CREATED_SPACE,className:"shadow-light",autoClose:!1,keyboard:!1,content:()=>r.jsx(Rge,{onCloseModal:()=>{t(Ae.GUIDE_FIRST_TIME_CREATED_SPACE),n==null||n()}})})},[t,e])},Bge=()=>{const e=Age(),{basicList:t,advancedList:n}=sz(),s=Oa(),a=me();if(t.length===0&&n.length===0||[...t,...n].every(l=>l.status==="completed"))return null;const o=l=>{if(l.uuid){if(ce.event("online_activity_click",{activity_id:l.uuid}),l.uuid===Ae.GUIDE_FIRST_TIME_CREATED_SPACE){e();return}dg(l.link)}},i=l=>{const c=l.status==="completed";return r.jsxs(Fe,{popup:l.link&&l.synopsis,followCursor:"horizontal",arrow:!0,plugins:[B8],className:"flex px-3 py-2 cursor-pointer group",onClick:()=>o(l),children:[r.jsx(H,{name:"IcBullrted",size:"large",className:"mr-1"}),r.jsxs("div",{className:"flex-1 text-t2",children:[l.name," ",r.jsxs("span",{className:"text-active_color text-t4",children:["⭐️+",l.score]})]}),r.jsx("div",{className:Yt("flex-shrink-0 ml-auto flex",!c&&"opacity-0 group-hover:opacity-100"),children:c?r.jsx(H,{name:c?"IcCircleCheck":"IcCircleCheckbox",size:"large",className:Yt(c&&"text-active_color")}):r.jsx("span",{className:"text-t3 text-active_color",onClick:u=>{u.stopPropagation(),u.preventDefault(),s(),l.uuid===Ae.COPY_PAGE_FROM_TEMPLATE&&a.modal({modalId:Xe.TEMPLATE_CENTER,content:()=>r.jsx(Xf,{from:"quickSetting"})})},children:l.uuid===Ae.MOBILE_SORT_BLOCK||l.uuid===Ae.MOBILE_SHARE_LONG_PAGE_IMAGE?"去登录":"去完成"})})]})};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex my-2.5 items-center text-t2 h-9 top-0",children:["解锁功能赚积分",r.jsx("span",{className:"ml-2.5 flex items-center relative text-t3 py-px px-1.5 text-white bg-red rounded-sm after:content-[''] after:inline-block after:w-[7px] after:h-[7px] after:bg-red after:rotate-45 after:absolute after:-left-0.5",children:"新用户专享"})]}),r.jsxs("div",{className:"flex",children:[r.jsxs("div",{className:"w-full py-2.5 border border-black/10 rounded",children:[r.jsx("div",{className:"h-9 flex items-center px-3 text-t2 text-grey3",children:"基础入门"}),t.map(l=>r.jsx(F.Fragment,{children:i(l)},l.uuid))]}),r.jsx("div",{className:"w-4 flex-shrink-0"}),r.jsxs("div",{className:"w-full py-2.5 border border-black/10 rounded",children:[r.jsx("div",{className:"h-9 flex items-center px-3 text-t2 text-grey3",children:"进阶操作"}),n.map(l=>r.jsx(F.Fragment,{children:i(l)},l.uuid))]})]})]})},Lge=()=>{const e=Oa(),t=zx(),n=F.useRef(null);return F.useEffect(()=>{Nge(),t(),ce.event("activity_center_show")},[t]),r.jsxs(r.Fragment,{children:[r.jsx("div",{ref:n,className:kt.commonStyles.container,children:r.jsxs(Il,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:()=>{},getScrollParent:()=>n.current,hasMore:!1,children:[r.jsx(kt.Header,{title:"活动中心",addonAfter:r.jsxs("a",{href:An.integralRule,target:"_blank",rel:"noreferrer",className:"flex items-center",children:[r.jsx(H,{name:"IcInviteInfo",size:"middle",className:"mr-1"}),"积分规则"]})}),r.jsx(Sge,{}),r.jsx(Bge,{}),r.jsx(jge,{}),r.jsx(Ige,{})]})}),r.jsx(kt.FooterBar,{confirmText:"关闭",confirm:()=>e()})]})},Mp=e=>{const{items:t,renderItemContent:n,foldLength:s=50}=e,[a,o]=F.useState(!1);return t.length>s&&!a?r.jsxs(r.Fragment,{children:[L8(t,0,s).map(i=>n(i)),r.jsxs("div",{className:"text-grey4 text-t3 flex items-center h-9 cursor-pointer",onClick:()=>o(!0),children:[r.jsx(H,{name:"IcArrowShow",size:"middle",className:"mr-2"}),"查看其他 ",t.length-s," 位成员"]})]}):r.jsxs(r.Fragment,{children:[t.map(i=>n(i)),t.length>s&&a&&r.jsxs("div",{className:"text-grey4 text-t3 flex items-center h-9 cursor-pointer",onClick:()=>o(!1),children:[r.jsx(H,{name:"IcArrowShow",size:"middle",className:"mr-2 rotate-180"}),"收起"]})]})},Q5=e=>r.jsxs("div",{className:Yt("flex flex-row",e.className),onClick:e.onClick,children:[r.jsx(H,{name:"IcBtnEdit",size:"middle"}),r.jsx("div",{className:"ml-0.5 text-t3 text-grey3",children:"添加备注"})]}),Pge=()=>{const e=me(),t=Ft(),n=Qt(),s=Um(),o=qd()(n.uuid).editor,i=t.planType===Et.freeTeam||t.planType===Et.freePersonal,l=j6(t.planType),c=cr(t.planType),u=Qp(),d=ae(({users:T})=>u.map(v=>T[v.userId]).filter(Boolean)),[f,h]=F.useState(""),p=F.useMemo(()=>Cc(d,f),[d,f]),{setCurrentSettingMenu:g,checkoutUpgraded:_}=ws(la),x=Ft(),y=Va(),b=ui(),[E,w]=F.useState(),k=F.useRef(),C=(T,v)=>{const I=u.find(j=>j.userId===v);I&&e.dropdown({placement:"bottom",offset:[0,4],popcorn:T.currentTarget,content:({onCloseModal:j})=>r.jsx(ze,{className:"py-2 w-[270px] next-modal",onItemClick:({type:D,data:S})=>{D===$.SEARCH&&window.open(`/${S.uuid}`)},items:[l?{type:$.TEXT_DESCRIPTION,data:{title:r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:"MIcSettingsMembers",size:"middle"}),r.jsx("div",{className:"ml-2",children:"升级为空间成员"})]}),onClick:async()=>{if(!b&&Object.keys(y).length>=xg().membersMaxLimit){_(Vt.extMember);return}await Ce.infra.addSpaceMember(t.uuid,{userId:v}),s(t.uuid),Ye({$guestsList:wt.$guestsList.filter(D=>D.userId!==v)}),ye.success("已成功升级为空间成员"),j()}}}:null,l?{type:$.LINE}:null,{type:$.TEXT_DESCRIPTION,data:{title:r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:"IcMenuLogout",size:"middle",className:"text-red"}),r.jsx("div",{className:"ml-2 text-red",children:"移除"})]}),onClick:async()=>{await Ce.infra.removeSpaceGuest(t.uuid,{userId:v}),Ye({$guestsList:wt.$guestsList.filter(D=>D.userId!==v)}),ye.success("已成功移除"),j()}}},{type:$.LINE},...I.guestPageIds.map(D=>{const S=K.blocks[D];if(!S)return null;const R=ji(D);return{type:$.SEARCH,data:{uuid:S.uuid,title:de(S.data.segments)||Ot(S.type),icon:S.data.icon,navs:R,type:S.type,backgroundColor:S.backgroundColor}}})].filter(Boolean)})})};return r.jsxs("div",{className:"mt-3.5",children:[o&&r.jsxs(r.Fragment,{children:[i?r.jsxs("div",{className:B("my-2 text-t4 text-grey3"),children:[`当前空间为「${c}」，仅支持邀请5名外部协作者。`,r.jsx("span",{className:"text-active_color border-b border-active_color cursor-pointer",onClick:()=>{t.planType===Et.freePersonal?g(Jt.upgrade):_(Vt.extMember)},children:"升级空间"})]}):r.jsx("div",{children:`当前空间为「${c}」，支持邀请无数量限制的外部协作者。`}),r.jsx(kt.SettingDivider,{className:"my-2.5"})]}),p.length||f?r.jsxs("div",{className:"flex top-0 shrink-0 items-center justify-between mt-2.5 h-9 text-t2",children:[r.jsx("div",{children:"人员信息"}),r.jsx(xt,{className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-full",inputClassName:"px-0",value:f,onChange:h,placeholder:"搜索人员、手机号",addonBefore:r.jsx(H,{size:"middle",name:"IcTitleSearch",className:"text-grey4"}),addonAfter:f&&r.jsx(H,{size:"middle",name:"IcUploadCancel",onClick:()=>h(""),className:"text-grey4 cursor-pointer"})})]}):r.jsxs("div",{children:[r.jsx("div",{className:"text-[70px] leading-[80px]",children:"☕️"}),r.jsx("div",{className:"my-4 text-t2",children:"当前空间未邀请外部协作者"}),r.jsxs("div",{className:"text-grey3",children:[r.jsx("div",{children:"如何邀请外部协作者？"}),r.jsxs("div",{className:"ml-2",children:[r.jsx("div",{children:"1. 进入需要协作的页面"}),r.jsx("div",{children:"2. 点击页面右上角「分享」"}),r.jsx("div",{children:"3. 在输入框内输入手机号并设置权限"}),r.jsx("div",{children:"4. 完成邀请"})]})]})]}),r.jsx(Mp,{foldLength:50,items:p,renderItemContent:T=>{var A,L;const v=T.uuid===n.uuid||o,I=u.find(P=>P.userId===T.uuid),j=(A=x.userRemark)==null?void 0:A[T.uuid],D={...T};let S=T.nickname||"客";const R=!!T.nickname||!!j;return j&&(S=`${j} ${T.nickname?`(${T.nickname})`:""}`),r.jsxs("div",{className:"group flex shrink-0 items-center h-[58px]",children:[r.jsx(Nc,{forceNickname:S,user:D,className:"mr-2 w-[30px] h-[30px] !text-t1"}),r.jsx("div",{className:"flex flex-col grow",children:E===T.uuid?r.jsx(xt,{autoFocus:!0,maxLength:20,className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-sm",inputClassName:"px-0",defaultValue:j,onChange:P=>{k.current=P},placeholder:"请输入备注",onEnter:P=>{P.target instanceof HTMLElement&&P.target.blur()},onBlur:async()=>{const P=k.current;k.current=void 0,w(void 0),P!==void 0&&(await Ce.infra.addSpaceUserRemark(x.uuid,{[T.uuid]:P}),ee(hx({uuid:x.uuid,patch:[{userId:T.uuid,markName:P}]})))}}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"mb-0.5 text-t2",children:R?S:D.phone}),v&&r.jsx(Q5,{className:"ml-1 cursor-pointer transition-opacity group-hover:opacity-100 opacity-0",onClick:()=>{w(T.uuid)}})]}),R&&r.jsx("span",{className:"text-grey3 text-t4",children:jd(T.phone)})]})}),r.jsxs("div",{className:B("self-center flex items-center text-t2",v&&"cursor-pointer"),onClick:P=>v&&C(P,D.uuid),children:[`${(L=I==null?void 0:I.guestPageIds.length)!=null?L:0}个协作页面`,v&&r.jsx(H,{name:"IcArrow",className:"ml-1",size:"xxxsmall"})]})]},D.uuid)}})]})},Oge=()=>{const{spacePlan:e,spaceShareInfo:t}=Qc(),n=Oa(),s=ui(),a=Va(),o=Um(),i=Object.values(a),l=me(),c=Ft(),u=Qt(),d=qd(),f=vS(),h=d(u.uuid).editor,p=Un(),g=Ft(),_=Ro(),x=c.planType===Et.freeTeam,y=Lg(),[b,E]=F.useState(""),{checkoutUpgraded:w}=ws(la),[k,C]=F.useState(),T=F.useRef(),v=F.useMemo(()=>y({keywords:b}),[b,y]),I=`${Sn()}${Rt.login}?${ms.inviteTeam}=${t==null?void 0:t.inviterId}&${ms.inviteCode}=${u.inviteCode}`,j=M=>i.some(U=>U.spaceRole===m.PermissionRole.EDITOR&&U.uuid!==M);F.useEffect(()=>{HT()},[h]);const D=async()=>{l.warning({title:"确认重置吗？",content:"重置后，之前的邀请链接将失效",confirm:async()=>{const M=await Ce.infra.resetSpaceInvitation(c.uuid);ye.success("重置成功"),HT({inviterId:M.uuid,createdAt:M.createdAt,expirationAt:M.expirationAt})}})},S=async()=>{l.warning({title:"成员达到上限",content:`本空间为${cr(c.planType)}，成员已达 ${e==null?void 0:e.maxPeople} 人上限，如需增加空间成员，请升级空间`,confirm:async()=>{_(Vt.importMember)}})},R=()=>{on(I,{message:"none"}),e!=null&&e.maxPeople&&e.maxPeople<=i.length?l.warning({title:r.jsx("div",{className:"mb-4",children:"当前已达团队版购买成员数上限，如需增加成员，请付费后再邀请。"}),cancelText:"知道了",confirmText:"增加人数",confirm:()=>{w(Vt.members)}}):ye.success("复制成功，快去分享给同事吧")},A=M=>{const U=M===u.uuid;if(U&&h&&!j(M)){if(s){l.warning({title:"当前空间还未到期，并且您是本空间唯一的管理员，无法离开空间",confirmText:"知道了"});return}l.warning({title:"确定删除空间？",content:"您是本空间唯一的管理员，无法离开，只能删除空间",countTime:10,confirmText:"确认",confirm:async()=>{await f(c.uuid),n(),G1()||p.push(Rt.main)}});return}l.warning({title:U?"确定离开吗？":"确定移出吗？",content:U?"离开后将不能再访问当前空间":"移出后该用户将不能再访问当前空间",confirmText:U?"确认离开":"确认移出",confirm:async()=>{await Ce.infra.removeSpaceMembers(c.uuid,{userId:M}),U?(ye.success("你已离开该空间"),await Pm(!0),G1()||p.push(Rt.main)):await o(c.uuid)}})},L=async(M,U)=>{if(M===u.uuid){ye.error("不能修改自己的权限");return}await Ce.infra.setSpaceMemberRole(c.uuid,{userId:M,role:U}),o(c.uuid),ye.success("修改成功")},P=(M,U)=>{const V=U===u.uuid,W=i.find(z=>z.uuid===U);W&&l.dropdown({placement:"bottom",offset:[0,4],popcorn:M.currentTarget,content:({onCloseModal:z})=>r.jsx(ze,{className:"py-2 w-[270px] next-modal",onItemClick:()=>z(),items:h?[{type:$.TEXT_DESCRIPTION,data:{title:"管理员",description:"仅管理员可以设置空间和邀请新成员",selected:W.spaceRole===m.PermissionRole.EDITOR,onClick:()=>void L(U,m.PermissionRole.EDITOR)}},{type:$.TEXT_DESCRIPTION,data:{title:"成员",selected:W.spaceRole!==m.PermissionRole.EDITOR,onClick:()=>void L(U,m.PermissionRole.WRITER)}},{type:$.LINE},{type:$.TEXT_DESCRIPTION,data:{title:r.jsxs("div",{className:"text-red",children:[V?"离开":"移出","团队"]}),onClick:()=>A(U)}}]:[{type:$.TEXT_DESCRIPTION,data:{title:r.jsx("div",{className:"text-red",children:"离开团队"}),onClick:()=>A(U)}}]})})};return r.jsxs("div",{className:"mt-3.5",children:[h&&(e==null?void 0:e.maxPeople)&&r.jsxs(r.Fragment,{children:[x&&(i.length<e.maxPeople?r.jsx("div",{className:"flex items-center px-4 my-2.5 min-h-[60px] border border-grey6 text-t2",children:r.jsxs("div",{children:["📢 本空间为",cr(c.planType),"，成员上限是 ",e==null?void 0:e.maxPeople," 人，如需增加空间成员，请",r.jsx("span",{className:"border-b border-black cursor-pointer text-t2-medium",onClick:()=>w(Vt.members),children:"升级空间"}),"。"]})}):r.jsxs("div",{className:"flex shrink-0 justify-between items-center px-4 my-2.5 h-[60px] bg-yellow/20",children:[r.jsxs("div",{className:"text-t2",children:["本空间为",cr(c.planType),"，成员已达 ",e.maxPeople," 人上限，如需增加空间成员，请升级空间。"]}),r.jsx(je,{onClick:()=>w(Vt.members),colorType:"black",children:"升级空间"})]})),r.jsxs("div",{className:"flex items-center h-9 justify-between",children:[r.jsx("div",{className:"text-black text-t2",children:"邀请空间成员"}),r.jsx("div",{className:"text-active_color text-t3 cursor-pointer",onClick:async M=>{l.dropdown({popcorn:M.currentTarget,placement:"left",content:({onCloseModal:U})=>r.jsx(cR,{isGuest:!1,onReceiveGuestList:async V=>{if(e!=null&&e.maxPeople&&i.length+V.length>(e==null?void 0:e.maxPeople)){S();return}const{userIds:W,markNames:z}=await dR(V);await Ce.infra.setSpaceMemberRoleBatch(g.uuid,W),Object.entries(z).length>0&&(await Ce.infra.addSpaceUserRemark(g.uuid,z),await o(g.uuid),ye.success("导入成功"),U())}})})},children:"批量导入空间成员"})]}),r.jsxs("div",{className:B("mt-2 mb-[18px] text-t4 text-grey3",!(t!=null&&t.expirationAt)&&"opacity-0"),children:[he(t==null?void 0:t.expirationAt).format("YYYY年MM月DD日"),"前，任何通过此链接邀请的人都可以进入当前空间，到达空间人数上限后将无法加入"]}),r.jsx(xt,{readonly:!0,inputClassName:"h-8 text-black",value:I,addonAfter:r.jsxs(r.Fragment,{children:[r.jsx("span",{onClick:D,className:"flex justify-center items-center w-[110px] h-8 text-center text-black rounded-r-sm border-l border-grey6 animate-click text-t2-medium",children:"重置链接"}),r.jsx("span",{onClick:R,className:"flex justify-center items-center w-[110px] h-8 text-center text-black rounded-r-sm border-l border-grey6 animate-click text-t2-medium",children:"复制邀请链接"})]})}),r.jsx(kt.SettingDivider,{className:"my-2.5"})]}),r.jsxs("div",{className:"flex top-0 shrink-0 items-center justify-between mt-2.5 h-9 text-t2",children:[r.jsx("div",{children:"人员信息"}),r.jsx(xt,{className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-full",inputClassName:"px-0",value:b,onChange:E,placeholder:"搜索人员、手机号",addonBefore:r.jsx(H,{size:"middle",name:"IcTitleSearch",className:"text-grey4"}),addonAfter:b&&r.jsx(H,{size:"middle",name:"IcUploadCancel",onClick:()=>E(""),className:"text-grey4 cursor-pointer"})})]}),r.jsx(Mp,{foldLength:50,items:v,renderItemContent:M=>{var z;const U=M.uuid===u.uuid||h,V=(z=g.userRemark)==null?void 0:z[M.uuid];let W=M.nickname;return V&&(W=`${V} (${M.nickname||"未命名用户"})`),r.jsxs("div",{className:"group flex shrink-0 items-center h-[58px]",children:[r.jsx(Nc,{user:M,className:"mr-2 w-[30px] h-[30px] !text-t1"}),r.jsx("div",{className:"flex flex-col grow",children:k===M.uuid?r.jsx(xt,{autoFocus:!0,maxLength:20,className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-sm",inputClassName:"px-0",defaultValue:V,onChange:Q=>{T.current=Q},placeholder:"请输入备注",onEnter:Q=>{Q.target instanceof HTMLElement&&Q.target.blur()},onBlur:async()=>{const Q=T.current;T.current=void 0,C(void 0),Q!==void 0&&(await Ce.infra.addSpaceUserRemark(g.uuid,{[M.uuid]:Q}),ee(hx({uuid:g.uuid,patch:[{userId:M.uuid,markName:Q}]})))}}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"mb-0.5 text-t2",children:W||ni}),U&&r.jsx(Q5,{className:"ml-1 cursor-pointer transition-opacity group-hover:opacity-100 opacity-0",onClick:()=>{C(M.uuid)}})]}),r.jsx("span",{className:"text-grey3 text-t4",children:jd(M.phone)})]})}),r.jsxs("div",{className:B("self-center flex items-center text-t2",U&&"cursor-pointer"),onClick:Q=>U&&P(Q,M.uuid),children:[M.spaceRole===m.PermissionRole.EDITOR?"管理员":"成员",U&&r.jsx(H,{name:"IcArrow",className:"ml-1",size:"xxxsmall"})]})]},M.uuid)}})]})},Mge=()=>{const e=me(),t=Ft(),n=Qt(),s=ke(),a=Hw(),{checkoutUpgraded:o}=ws(la),i=AG(),l=qd(),{editor:c}=l(n.uuid),{permissionGroups:u=[]}=t,[d,f]=F.useState(u),[h,p]=F.useState(""),[g,_]=F.useState("");F.useEffect(()=>{f(u)},[u]);const x=(C=[])=>{s(()=>{a(t.uuid,{permissionGroups:C})})},y=F.useRef(fs(x,1e3)).current,b=(C,T,v)=>{const I=[];d.forEach(j=>{j.id===C?I.push({...j,[T]:v}):I.push(j)}),f(I),y(I)},E=()=>{const C={name:"",id:qe(),userIds:[]};ce.event("new_group"),_(C.id),y([C,...d])},w=C=>{e.warning({title:"确定删除当前分组吗？",content:"如果有仅该组成员可管理的页面将会转移给你管理。",confirmText:"确认删除",colorType:"red",confirm:()=>{ce.event("delete_group"),y(d.filter(T=>T.id!==C))}})},k=(C=[])=>{f(C),y(C)};return i?r.jsxs("div",{className:"mt-3.5",children:[r.jsxs("div",{className:"mb-9",children:[r.jsx("div",{className:"flex items-center mb-2.5 h-9",children:"你可以将任意成员组成 1 个或多个成员组，成员组可以帮你更方便的配置页面协作权限。"}),r.jsxs("div",{className:"flex justify-between items-center h-14",children:[c?r.jsx(je,{colorType:"active",className:"text-t2-medium",onClick:E,children:"创建成员组"}):r.jsx("div",{}),!!d.length&&r.jsx(xt,{className:"pl-3 pr-1.5 w-full max-w-[300px] h-8 rounded-full",inputClassName:"px-0",value:h,onChange:p,placeholder:"搜索人员、手机号",addonBefore:r.jsx(H,{size:"middle",name:"IcTitleSearch",className:"text-grey4"}),addonAfter:h&&r.jsx(H,{size:"middle",name:"IcUploadCancel",onClick:()=>p(""),className:"text-grey4 cursor-pointer"})})]}),!!d.length&&r.jsx(kt.SettingDivider,{})]}),r.jsx(vr,{items:d,onChange:k,renderItemContent:({item:C,renderDragHandle:T})=>r.jsx(Uge,{item:C,searchKeywords:h,lastCreateGroup:g,deleteGroup:w,renderDragHandle:T,updateGroupInfo:b})})]}):r.jsxs("div",{children:[r.jsx("div",{className:"h-9 text-t1-medium flex items-center mt-3.5",children:"升级空间开启成员组"}),r.jsx("div",{className:"text-t3 text-grey3 h-9 flex items-center mb-5",children:"你可以将任意成员组成 1 个或多个成员组，成员组可以帮你更方便的配置页面协作权限。"}),r.jsx(je,{className:"!text-t2-medium",colorType:"active",onClick:()=>o(Vt.group),children:"升级空间"})]})},Uge=e=>{const{item:t,lastCreateGroup:n,searchKeywords:s,renderDragHandle:a,updateGroupInfo:o,deleteGroup:i}=e,l=me(),c=Qt(),u=qd(),{editor:d}=u(c.uuid),f=Lg(),h=Ma(),p=Ft(),g=F.useMemo(()=>f({keywords:s}).filter(k=>t.userIds.includes(k.uuid)),[f,s,t.userIds]),_=w=>{o(t.id,"userIds",w)},x=w=>{l.dropdown({popcorn:Br(w.currentTarget),placement:"bottom-start",content:({onCloseModal:k})=>r.jsx(Vge,{defaultSelectIds:t.userIds,updateGroupMembers:_,onCloseModal:k})})},y=w=>{l.warning({title:"确认移除这位成员吗？",confirm:()=>{_(t.userIds.filter(k=>k!==w))}})},b=w=>{l.dropdown({popcorn:w.currentTarget,placement:"bottom-start",content:({onCloseModal:k})=>r.jsx(ze,{className:"py-2 w-[270px] next-modal",items:[{type:$.TEXT_DESCRIPTION,data:{title:r.jsxs("div",{className:"text-red",children:[r.jsx(H,{name:"IcMenuDelete",size:"middle",className:"mr-2"}),"删除分组"]}),onClick:()=>{i(t.id),k()}}}]})})},E=w=>{w.preventDefault(),w.stopPropagation(),d&&l.dropdown({popcorn:w.currentTarget,placement:"bottom",content:({onCloseModal:k})=>r.jsx(Fk,{showRecently:!1,onSelectEmoji:(C,T)=>{T||k(),o(t.id,"icon",{type:"emoji",value:C})},onUploadFile:C=>{k(),ye.loading({key:Fc.UPLOAD_ICON,content:"头像上传中..."}),h({file:C,type:"public",searchType:"avatar",onComplete(T){T.success&&(ye.success("上传完成"),o(t.id,"icon",{type:"upload",value:T.ossName}))}})},onRemoveBtnClick:()=>{k(),o(t.id,"icon",{})}})})};return r.jsxs("div",{className:"mb-9",children:[r.jsxs("div",{className:"flex relative items-center h-9 group",children:[d&&a({className:"cursor-pointer flex items-center justify-center w-5 h-5 mr-1 text-grey4 absolute top-2 -left-7  opacity-0 group-hover:opacity-100 transition-opacity",popup:"长按拖拽"}),r.jsx(Ps,{className:B("mr-2 text-h4",d&&"cursor-pointer"),name:t.name||"未",icon:t.icon,onClick:E}),r.jsx(oo,{singleLine:!0,readonly:!d,autoFocus:!t.name&&n===t.id,value:t.name,className:"whitespace-nowrap",boxClassName:"cursor-text rounded animate-hover text-ellipsis",placeholder:"请输入组名",fontClassName:B("text-t2-medium whitespace-nowrap text-ellipsis",!t.name&&"min-w-[70px]"),onChange:w=>o(t.id,"name",w.currentTarget.value)}),!!t.userIds.length&&r.jsxs("div",{className:"ml-2 text-grey3 text-t2 flex-shrink-0",children:[t.userIds.length,"位成员"]}),d&&r.jsx(H,{name:"IcMore",size:"middle",className:"text-grey3 ml-auto flex-shrink-0 animate-hover",onClick:b})]}),r.jsx(kt.SettingDivider,{}),r.jsxs(r.Fragment,{children:[r.jsx(Mp,{foldLength:10,items:g,renderItemContent:w=>{var T;const k=(T=p.userRemark)==null?void 0:T[w.uuid];let C=w.nickname;return k&&(C=`${k} (${w.nickname})`),r.jsxs("div",{className:"flex items-center justify-between h-9 text-t2 group",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Nc,{user:w,className:"mr-2 !text-t2-medium"}),C,w.spaceRole===m.PermissionRole.EDITOR&&r.jsx("span",{className:"ml-2 flex items-center px-1.5 bg-grey/20 text-grey3 rounded-sm h-5",children:"管理员"})]}),d&&r.jsx("span",{className:"text-red cursor-pointer opacity-0 group-hover:opacity-100",onClick:()=>y(w.uuid),children:"移出"})]},w.uuid)}}),d&&r.jsxs("div",{className:"flex items-center h-9 text-grey4 cursor-pointer",onClick:x,children:[r.jsx(H,{name:"IcAddBoard",className:"mr-2",size:"middle"}),"添加成员"]})]})]})},Vge=e=>{const{updateGroupMembers:t,onCloseModal:n,defaultSelectIds:s=[]}=e,a=Va(),o=Lg()({filterIds:s,users:a}),i=F.useRef(),[l,c]=F.useState(""),[u,d]=F.useState([]),f=y=>{c(""),d(b=>[...b,y])},h=y=>{d(b=>b.filter(E=>E!==y))},p=y=>{const b=pn(u);be("BackSpace")(y)&&!l&&b&&h(b)},g=()=>{t([...s,...u]),n()},_=u.length>0,x=F.useMemo(()=>{const y=o.filter(b=>!u.includes(b.uuid));return Cc(y,l)},[l,u,o]);return r.jsxs("div",{className:"w-[400px] next-modal",children:[r.jsxs("div",{className:"p-2.5 pb-1 border-b border-grey6",children:[r.jsxs("div",{className:"flex flex-wrap items-center",children:[u.map(y=>{const b=a[y];return b?r.jsxs("span",{className:"flex items-center mr-1.5 mb-1.5 cursor-default text-t2",children:[r.jsx(Nc,{user:b,className:"mr-2 !text-t2-medium"}),ss(y)||ni,r.jsx(H,{name:"IcToastClose",size:"middle",className:"opacity-50",onClick:()=>h(y)})]},b.uuid):null}),r.jsx(xt,{autoFocus:!0,showBorder:!1,className:"flex-1 mb-1.5 h-6 !bg-transparent min-w-[100px]",inputClassName:"px-0 text-t2",value:l,onChange:c,onKeyDown:p,placeholder:"搜索成员昵称"})]}),r.jsx("div",{className:"flex justify-end -translate-y-1",hidden:!_,children:r.jsx(je,{onClick:g,colorType:"active",className:"text-t2-medium",children:"添加"})})]}),r.jsxs("div",{ref:i,className:"overflow-y-auto p-2.5 w-[400px] max-h-[40vh]",children:[r.jsx(Bd,{containerRef:i,itemCount:x.length,children:(y,b)=>x.map((E,w)=>r.jsxs("div",{onClick:()=>f(E.uuid),className:B("flex items-center h-10 text-t2 w-full px-1 cursor-pointer animate-hover rounded",y===w&&"normal-bg"),onMouseEnter:()=>b(w),children:[r.jsx(Nc,{user:E,className:"mr-2 !text-t2-medium"}),ss(E.uuid)||ni]},E.uuid))}),!x.length&&r.jsx("div",{className:"flex items-center text-grey3 cursor-default text-t2",children:"无搜索结果"})]})]})},qge=()=>{const e=Oa(),t=Va(),n=Object.values(t),s=Qp(),a=Ao();return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:kt.commonStyles.container,children:r.jsxs($d,{children:[a&&r.jsx(Zs,{title:`成员${n.length?`（${n.length}）`:""}`,children:r.jsx(Oge,{})}),a&&r.jsx(Zs,{title:"成员组",children:r.jsx(Mge,{})}),r.jsx(Zs,{title:`外部协作者（${s.length}）`,children:r.jsx(Pge,{})})]})}),r.jsx(kt.FooterBar,{confirmText:"关闭",confirm:()=>e()})]})};var Ns=(e=>(e.wxpay="wxpay",e.alipay="alipay",e.irpay="irpay",e.offline="offline",e))(Ns||{});const ky=e=>{const{bizType:t,...n}=e;ce.event(t,{...n})},J5=e=>{if(e)return qp({firstBuyCycle:"first",stuDiscountCash:"education",limitTimeCycle:"limit"},e)},vo=e=>{const{children:t,className:n,height:s,...a}=e;return r.jsx("div",{className:Yt("flex items-center py-2.5",n),...a,style:{height:s},children:t})},Z5=qe(),M3=F.memo(e=>{const t=me(),{className:n,couponList:s=[],selectId:a,onSelectId:o}=e,i=s.find(c=>c.id===a),l=c=>{t.dropdown({modalId:Z5,popcorn:c.currentTarget,offset:[0,10],content:()=>r.jsx($ge,{couponList:s,selectId:a,onSelectId:o})})};return r.jsxs("div",{className:n,children:[r.jsx(xp,{}),r.jsxs(vo,{height:36,className:"py-2 justify-between text-t2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:"IcTicket",size:"middle"}),r.jsx("span",{className:"ml-2",children:"优惠券"})]}),r.jsxs("div",{onClick:l,className:"flex items-center cursor-pointer h-full",children:[i?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mr-1",children:i.name}),r.jsxs("span",{className:"text-active_color",children:["-¥",i.salePrice]})]}):r.jsx(r.Fragment,{children:s.length>0?`${s.length}张可用优惠券`:"暂无可用"}),r.jsx(H,{name:"IcArrow",size:"xxxsmall",className:"ml-1"})]})]}),r.jsx(xp,{})]})}),Hge={integralRecord:"linear-gradient(270deg, rgba(249, 139, 42, 0.5) 0%, rgba(249, 139, 42, 0) 100%)",education:"linear-gradient(270deg, rgba(193, 50, 135, 0.1) 0%, rgba(193, 50, 135, 0) 100%)",limitTime:"linear-gradient(270deg, rgba(0, 92, 175, 0.1) 0%, rgba(0, 92, 175, 0) 100%)",activity:"linear-gradient(270deg, rgba(17, 187, 136, 0.1) 0%, rgba(17, 187, 136, 0) 100%)"},$ge=e=>{const{onSelectId:t,couponList:n=[],selectId:s}=e,a=me(),o=()=>{a.closeModal(Z5)},i=r.jsx(H,{name:"IcSelectedSpace",size:"middle",className:Yt("absolute -top-px -right-px rounded-tr rounded-bl bg-black-base text-white-base",!s&&"top-2.5 right-4 rounded")});return r.jsxs("div",{className:"next-modal py-1.5 w-[360px] text-t2-medium",children:[r.jsxs(vo,{className:"mx-2 px-2 cursor-pointer relative animate-click animate-hover",onClick:()=>{t(),o()},height:40,children:["不使用优惠券",!s&&i]}),r.jsx(xp,{}),r.jsxs("div",{className:"overflow-y-auto max-h-56 px-4 pt-2.5",children:[n.map(l=>{var c;return r.jsxs("div",{className:"relative flex items-center py-2.5 px-4 border border-grey6 rounded cursor-pointer mb-2.5 min-h-[100px] animate-click",style:{background:Hge[l.showType]},onClick:()=>{t(l.id),o()},children:[s===l.id&&i,r.jsxs("div",{className:"min-w-[60px] text-center tex-t2-medium",children:[r.jsx("span",{children:"¥"}),r.jsx("span",{className:"text-h2",children:l.salePrice})]}),r.jsxs("div",{className:"ml-5 dark:text-white-base",children:[r.jsx("div",{className:"text-t2-medium",children:l.name}),r.jsx("div",{className:"my-1 text-t4 text-grey3 dark:text-grey1 whitespace-pre-line",children:(c=l.description)==null?void 0:c.replace("\\n",`
`)}),r.jsx("div",{className:"text-t4-medium text-grey3 dark:text-grey1",children:l.subtitle})]}),l.showType==="integralRecord"&&r.jsx("img",{src:Dn.star,className:"absolute right-0 opacity-30 pointer-events-none"})]},l.id)}),!n.length&&r.jsx(vo,{height:40,className:"cursor-not-allowed",children:"暂无可用优惠券"})]})]})},eO=e=>{const{children:t,className:n,bgColor:s}=e;return r.jsx("span",{className:Yt("flex absolute -top-0.5 -left-0.5 justify-center items-center py-0.5 px-1.5 text-white-base rounded-br-md rounded-tl-md text-t5 z-10",n),style:{background:s||"linear-gradient(270.32deg, #FF4E47 0.24%, #FC938F 96.14%)"},children:t})},tO={bothSides:async()=>{const e=()=>{const n=(s,a)=>{P8(Object.assign({y:.7,x:0},a,{zIndex:9999,particleCount:Math.floor(200*s)}))};n(.25,{spread:26,startVelocity:55}),n(.2,{spread:60}),n(.35,{spread:100,decay:.91,scalar:.8}),n(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2}),n(.1,{spread:120,startVelocity:45})};await Za(500),e(),await Za(1e3),e(),await Za(1e3),e()}},Gge=e=>{ce.event("support_clk"),e.modal({content:()=>r.jsxs("div",{className:"p-12 pt-10 flex flex-col items-center",children:[r.jsx("div",{className:"text-h4",children:"请用微信手机端扫码咨询客服"}),r.jsx("img",{className:"mt-6 p-3 bg-white-base",width:"230px",height:"230px",src:"https://work.weixin.qq.com/kf/kefu/qrcode?kfcode=kfcdde5f9fac82bd755"})]})})},nO=e=>{const{price:t,endTime:n,remark:s,changePayType:a,customFooter:o,onCloseModal:i,onFinish:l}=e,c=F.useRef(),u=me(),d=h=>{h?Ce.infra.getOrderStatus.raw(h).then(async p=>{if(p.code===200)switch(p.data.status){case 20:c.current&&clearInterval(c.current),await Pm(),i(),tO.bothSides(),l==null||l(),ye.success("订单支付成功");break;case 30:ye.error("订单失效，请重新下单"),c.current&&clearInterval(c.current);break}else c.current&&clearInterval(c.current)}):i()},f=()=>{on(`转账金额：${t}
收款方账户名：云上绿洲（北京）科技有限公司
收款方账户：110944870510101
开户行：招商银行股份有限公司北京分行望京融科支行
转账备注：${s}`)};return F.useEffect(()=>(c.current=setInterval(()=>{d(e.orderId)},3e3),()=>{c.current&&clearInterval(c.current)}),[e.orderId]),r.jsxs("div",{className:"w-[550px] px-12 pt-6 pb-10 text-center",children:[r.jsx("div",{className:"text-h2 mb-6",children:"购买团队版"}),r.jsxs("div",{className:"mb-2.5 text-t2-medium",children:["请于",r.jsxs("span",{className:"text-blue",children:[he(n).format("YYYY/MM/DD HH:mm"),"之前"]}),"完成转账，转账时请备注订单，我们会在确认到账后2个工作日内开通服务。"]}),r.jsxs("div",{className:"text-t4 text-grey3 mb-7",children:["如有任何疑问，请立即联系",r.jsx("span",{className:"border-b border-grey3 cursor-pointer",onClick:()=>{Gge(u)},children:"在线客服"}),"帮您解决。"]}),r.jsxs("div",{className:"border border-black/10 rounded py-4 px-5 mb-2.5 relative",children:[r.jsx("div",{className:"flex items-center h-10",children:r.jsx(je,{onClick:f,children:"复制账户信息"})}),[{title:"转账金额",content:t},{title:"收款方账户名",content:"云上绿洲（北京）科技有限公司"},{title:"收款方账户",content:"110944870510101"},{title:"开户行",content:"招商银行股份有限公司北京分行望京融科支行"},{title:"转账备注",content:s}].map(h=>r.jsxs("div",{className:"flex items-center justify-between h-10 text-t2 text-grey3",children:[r.jsx("span",{children:h.title}),r.jsx("span",{className:"text-t2-medium text-black",children:h.content})]},h.title)),r.jsx("img",{src:Dn.orderRemarks,className:"absolute -bottom-6 right-3 pointer-events-none"})]}),r.jsx("div",{className:"text-red text-t2 text-right pr-20",children:"记得填写备注，否则无法确定到账！"}),r.jsxs("div",{className:"flex items-center justify-center my-4",children:[o,a&&r.jsx(je,{className:"w-32 text-t2-medium",onClick:()=>{a()},children:"更换支付方式"})]})]})},xr=e=>{switch(e){case 0:return"积分";case 1:return"¥";case 2:return"$";case 3:return"€";default:return"¥"}},zge=()=>{var h,p;const e=Oa(),t=me(),n=Ft(),s=F.useRef(null),a=F.useRef(0),[o,i]=F.useState(),l=(h=o==null?void 0:o.pendingList)==null?void 0:h[0],c=async(g=!1)=>{g||a.current++;const _=await Ce.infra.getOrderList(a.current,20,n.uuid);i(x=>({..._,list:Bm([...(x==null?void 0:x.list)||[],..._.list||[]],"id")}))},u=g=>{c(!0),ky({bizType:"order_finish",order_amount:l==null?void 0:l.total,order_channel:"card",is_from:Vt.order,order_new:g})},d=g=>{const _=n6()?"yes":"no";t.modal({content:({onCloseModal:x})=>{var y;return r.jsx(nO,{orderId:g.id||"",onFinish:()=>{u(_),x()},onCloseModal:x,price:g.total||0,endTime:(y=g.expirationTime)!=null?y:0,remark:g.remark,customFooter:r.jsx(je,{className:"w-32 text-t2-medium",onClick:()=>x(),children:"确定"})})}})},f=g=>{t.warning({title:"确认取消订单吗？",content:"取消后，您也可以重斯下单",confirmText:"取消订单",cancelText:"我再想想",confirm:async()=>{ye.loading({key:"cancelOrder",content:"正在取消订单"}),await Ce.infra.cancelOrder(g),c(!0),ye.closeMessage("cancelOrder"),ye.success("取消成功")}})};return F.useEffect(()=>{c()},[]),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:B(kt.commonStyles.container,"overflow-y-hidden"),children:[r.jsx(kt.Header,{title:"订单",addonAfter:r.jsx("div",{className:"flex items-center justify-center text-t2 text-black",children:r.jsx("a",{href:An.applyInvoice,target:"_blank",rel:"noopener noreferrer",children:"开发票"})})}),l&&r.jsxs("div",{className:"flex items-center justify-between h-14 bg-active_color/10 text-active_color px-4",children:[r.jsxs("div",{children:["有一笔订单（",xr(l.currencyUnit),l.total,"）待支付"]}),r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(je,{colorType:"secondary",onClick:()=>l.id&&f(l.id),className:"text-active_color border-active_color mr-5 animate-hover",children:"取消订单"}),r.jsx(je,{colorType:"active",onClick:()=>d(l),children:"查看订单"})]})]}),r.jsxs("div",{className:"flex flex-col justify-between items-center mt-5 overflow-y-hidden overscroll-x-auto flex-1",children:[r.jsxs("div",{className:"grid grid-cols-9 gap-x-2 w-full py-2",children:[r.jsx("div",{className:"col-span-3",children:"订单号"}),r.jsx("div",{className:"col-span-2",children:"订单内容"}),r.jsx("div",{className:"col-span-1",children:"金额"}),r.jsx("div",{className:"col-span-1",children:"操作人"}),r.jsx("div",{className:"col-span-2",children:"订单时间"})]}),r.jsx("div",{className:"w-full h-2.5 border-b border-grey6"}),r.jsx("div",{ref:s,className:"overflow-y-auto w-full flex-1 flex-shrink-0",children:r.jsx(Il,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:()=>c(),getScrollParent:()=>s.current,hasMore:o==null?void 0:o.more,children:(p=o==null?void 0:o.list)!=null&&p.length?r.jsx(r.Fragment,{children:o.list.map(g=>r.jsxs("div",{className:"grid grid-cols-9 gap-x-2 w-full py-2",children:[r.jsx("div",{className:"col-span-3 break-words",children:g.id}),r.jsxs("div",{className:"break-words col-span-2",children:[r.jsx("div",{children:g.description}),g.subDesc&&r.jsx("div",{className:"text-t4 text-grey3",children:g.subDesc})]}),r.jsxs("div",{className:"break-words col-span-1",children:[xr(g.currencyUnit),g.total]}),r.jsx(Fe,{placement:"top-start",className:"col-span-1 text-ellipsis",popup:g.userName,children:g.userName}),r.jsx("div",{className:"break-words col-span-2",children:g.createdAt?he(new Date(g.createdAt)).format("YYYY/MM/DD HH:mm"):""})]},g.id))}):r.jsx("div",{className:"text-t4 text-center text-grey3 mt-3",children:"暂无订单"})})})]})]}),r.jsx(kt.FooterBar,{confirm:()=>e(),confirmText:"关闭"})]})},Wge=({restUsage:e,usage:t})=>{const n=F.useRef(null),[s,a]=F.useState([]);F.useEffect(()=>{o(1)},[]);const o=async i=>{const l=Ut(),c=await Ce.infra.getSpaceAiDetail(l,i,20);a(c)};return r.jsxs("div",{className:"py-[5px] max-h-[60vh]",children:[r.jsxs("div",{className:"flex items-center justify-between h-[50px] px-[30px]",children:[r.jsx("div",{className:"text-h4",children:"FlowUs AI 用量详情"}),r.jsxs("p",{className:"text-t2 text-grey3",children:[r.jsxs("span",{children:["剩余使用量 ",e]}),r.jsxs("span",{className:"ml-1",children:["本月使用量 ",t]})]})]}),r.jsx("div",{className:"bg-grey6 h-[1px] my-1 w-full"}),r.jsx("div",{ref:n,className:"flex flex-col overflow-y-auto flex-1 min-w-[500px] h-[600px] px-[30px]",children:r.jsxs(Il,{className:"flex flex-col",pageStart:1,initialLoad:!1,useWindow:!1,loadMore:o,getScrollParent:()=>n.current,children:[r.jsxs("div",{className:"text-t2 h-10 flex items-center",children:[r.jsx("span",{className:"w-[160px]",children:"记录类型"}),r.jsx("span",{className:"w-[120px]",children:"请求量（次）"}),r.jsx("span",{className:"w-[120px]",children:"使用量"}),r.jsx("span",{className:"w-[140px]",children:"记录时间"})]}),r.jsx("div",{className:"bg-grey6 h-[1px] my-1"}),s.map(i=>{var l,c;return r.jsxs("div",{className:"flex w-full justify-between items-center h-10",children:[r.jsxs("div",{className:"text-t2 w-[160px] flex flex-col",children:[i.title,((l=i.endAt)!=null?l:0)>0&&r.jsxs("span",{className:"text-t4 text-grey3 w-[140px]",children:["有效期至 ",he(i.endAt).format("YYYY/MM/DD")]})]}),r.jsx("div",{className:"text-t2 w-[120px]",children:i.count}),r.jsxs("div",{className:"text-t2 w-[120px]",children:[((c=i.usage)!=null?c:0)>0&&"+",i.usage]}),i.updatedAt&&r.jsx("div",{className:"text-t2 w-[140px]",children:he(i.updatedAt).format("YYYY/MM/DD HH:mm:ss")})]},i.updatedAt)}),!s.length&&r.jsx("div",{className:"text-t2 text-grey4 mt-2",children:"暂无记录～"})]})})]})},Kge=()=>{var o,i,l,c,u,d,f;const e=Ft(),t=me(),[n,s]=F.useState(),a=()=>{t.modal({content:()=>{var h,p,g,_;return r.jsx(Wge,{restUsage:((h=n==null?void 0:n.basic)!=null?h:0)+((p=n==null?void 0:n.seat)!=null?p:0)+((g=n==null?void 0:n.additional)!=null?g:0),usage:(_=n==null?void 0:n.usage)!=null?_:0})}})};return F.useEffect(()=>{Ce.infra.getSpaceAiUsage(e.uuid).then(h=>{s(h)})},[e.uuid]),r.jsxs(r.Fragment,{children:[r.jsx(qs,{title:r.jsxs(r.Fragment,{children:["FlowUs AI ",r.jsx("span",{className:"text-t2 px-1.5 bg-grey/20 rounded-sm ml-2 text-grey2 inline-flex items-center",children:"Beta"})]}),description:null}),r.jsxs("div",{className:"flex justify-between items-center text-t3 h-9",children:[r.jsxs("span",{className:"mr-4",children:["剩余使用量 ",((o=n==null?void 0:n.basic)!=null?o:0)+((i=n==null?void 0:n.seat)!=null?i:0)+((l=n==null?void 0:n.additional)!=null?l:0)]}),r.jsxs("span",{children:["本月使用量 ",(c=n==null?void 0:n.usage)!=null?c:0]}),r.jsxs("button",{className:"ml-auto mr-[5px] flex items-center",onClick:a,children:[r.jsx("span",{className:"text-t3 text-grey3",children:"查看详情"}),r.jsx(H,{name:"IcArrowUnfold",size:"xxxsmall",className:"text-grey3"})]})]}),r.jsxs("div",{className:"bg-grey9 rounded py-2 px-4 text-t3 text-grey3",children:[r.jsxs("div",{className:"h-7 flex justify-between items-center",children:[r.jsxs("span",{className:"",children:["基础配额 ",(u=n==null?void 0:n.basic)!=null?u:0]}),r.jsxs("span",{className:"ml-auto",children:["重置日期 ",he(n==null?void 0:n.resetDate).format("YYYY/MM/DD")]})]}),e.planType==="team"&&r.jsxs("div",{className:"h-7 flex justify-between items-center",children:[r.jsxs("span",{className:"",children:["席位配额 ",(d=n==null?void 0:n.seat)!=null?d:0]}),r.jsxs("span",{className:"ml-auto",children:["重置日期 ",he(n==null?void 0:n.resetDate).format("YYYY/MM/DD")]})]}),r.jsx("div",{className:"h-7 flex justify-between items-center",children:r.jsxs("span",{children:["补充配额 ",(f=n==null?void 0:n.additional)!=null?f:0]})})]}),r.jsxs("p",{className:"text-t3 text-grey3 h-9 flex items-center",children:["配额以虚拟券形式发放，不同功能消耗的虚拟券数量也不相同，",r.jsx("a",{href:"/share/a3555796-d96c-4e02-9a38-4aba1ca6a418",className:"underline",target:"_blank",children:"了解详情"})]})]})},Yge=()=>{const{setCurrentSettingMenu:e}=ws(la),t=Ft();return r.jsxs("div",{className:"flex h-20 items-center",children:[r.jsx("div",{className:"rounded-md border border-black_006 p-1",children:r.jsx(Ps,{name:t.title,color:t.backgroundColor,icon:t.icon,iconSize:50,className:"h-[50px] w-[50px]",style:{fontSize:"30px"}})}),r.jsxs("div",{className:"ml-4 flex-1 flex flex-col justify-center",children:[r.jsx("div",{className:"text-t1-medium",children:t.title}),r.jsx("div",{className:"text-t3 mt-1",children:t.domain?r.jsxs(r.Fragment,{children:[Yj,"/",t.domain]}):r.jsx(r.Fragment,{children:" "})})]}),r.jsx(je,{className:"self-center mr-4",onClick:()=>{on(t.uuid,{message:"已复制空间 ID"})},children:"复制空间 ID"}),r.jsx(je,{className:"self-center",onClick:()=>{e(Jt.space)},children:"信息设置"})]})},Xge=e=>{const{handleAttachBottomDebounce:t,loadList:n,loading:s,more:a,placeholder:o,container:i,renderItem:l}=Qge(e);return r.jsxs(Il,{initialLoad:!1,useWindow:!1,loadMore:t,getScrollParent:()=>i.current,hasMore:a,children:[n.map(l),s&&r.jsxs("div",{className:"text-center text-grey3 my-4",children:[r.jsx(hs,{size:"middle"}),r.jsx("div",{className:"ml-1 text-t2",children:"正在加载..."})]}),!!n.length&&!a&&!s&&r.jsx("div",{className:"text-center text-grey3 my-4",children:r.jsx("div",{className:"ml-1 text-t2",children:"到底了..."})}),!n.length&&!s&&r.jsx("div",{className:"text-center text-grey3 my-4",children:o})]})},Qge=e=>{const{placeholder:t,container:n,getApi:s,renderItem:a}=e,[o,i]=F.useState([]),[l,c]=F.useState(!0),[u,d]=F.useState(!0),f=F.useRef(0),h=F.useCallback(async(_,x=30)=>{const y=await s({pageIndex:_,pageSize:x});_<=1?i(y.list):i(b=>[...b,...y.list]),d(y.more)},[s]),p=F.useCallback(async()=>{u&&(c(!0),f.current+=1,await h(f.current),c(!1))},[u,h]),g=F.useMemo(()=>$n(p,1e3),[p]);return O8(()=>{p()}),{handleAttachBottomDebounce:g,loadList:o,loading:l,more:u,placeholder:t,container:n,renderItem:a}},Jge=async(e=Ut())=>{await r6(e),await sk(e),await C2(),await kG(e),await Pm()},U3=e=>{const{rePayOrder:t,onCloseModal:n,priceTitle:s,payType:a,changePayType:o,onFinish:i,qaCodeUrlIsImage:l}=e,c=a===Ns.alipay;fi();const u=F.useRef(),d=F.useRef(),[f,h]=F.useState({loading:!1,qrFailure:!1,qrCodeImageUrl:"",orderId:e.orderId||"",initRefresh:!1}),p=async()=>{g("loading",!0),d.current&&clearTimeout(d.current),u.current&&clearInterval(u.current);const y=await t();if(!y.orderId){ye.warning("刷新失败，请重新下单"),n();return}const b=await Kb.toDataURL(`${y.qrCodeUrl}`,{errorCorrectionLevel:"H"});u.current&&(u.current=setInterval(()=>_(`${y.orderId}`),3e3)),d.current&&!l&&(d.current=setTimeout(()=>{g("qrFailure",!0),u.current&&clearInterval(u.current),d.current&&clearTimeout(d.current)},10*60*1e3)),h({qrCodeImageUrl:l?`${y.qrCodeUrl}`:b,orderId:y.orderId,qrFailure:!1,loading:!1,initRefresh:!1})},g=(y,b)=>{h(E=>({...E,[y]:b}))},_=y=>{y?Ce.infra.getOrderStatus.raw(y).then(async b=>{if(b.code===200)switch(b.data.status){case 20:u.current&&clearInterval(u.current),d.current&&clearTimeout(d.current),ye.success("订单支付成功"),n(),await Jge(),await(i==null?void 0:i()),tO.bothSides();break;case 30:g("qrFailure",!0),ye.error("订单失效，请重新下单"),u.current&&clearInterval(u.current),d.current&&clearTimeout(d.current);break}else u.current&&clearInterval(u.current),d.current&&clearTimeout(d.current);g("loading",!1)}):n()},x=()=>{g("loading",!0),g("initRefresh",!0),_(f.orderId)};return F.useEffect(()=>(u.current=setInterval(()=>{_(e.orderId)},3e3),d.current=setTimeout(()=>{g("qrFailure",!0),u.current&&clearInterval(u.current),d.current&&clearTimeout(d.current)},10*60*1e3),e.qrCodeUrl&&(l?g("qrCodeImageUrl",e.qrCodeUrl):Kb.toDataURL(e.qrCodeUrl,{errorCorrectionLevel:"H"}).then(y=>{g("qrCodeImageUrl",y)})),()=>{d.current&&clearTimeout(d.current)}),[]),r.jsxs("div",{className:"flex flex-col items-center justify-center py-7",children:[r.jsxs("div",{className:"text-h2",children:["支付金额：",r.jsx("span",{className:"text-active_color",children:s})]}),r.jsxs("div",{className:"text-h3 mb-5 flex items-center py-4 font-normal",children:[c?r.jsx(H,{name:"IcAlipayPay",size:"large",className:"mr-2 text-[#1677FF]"}):r.jsx(H,{name:"IcWechatPay",size:"large",className:"mr-2 text-[#07C160]"}),"请用",c?"支付宝":"微信","扫码完成支付"]}),r.jsxs("div",{className:"relative mx-20 mb-5 h-60 w-60",children:[f.qrFailure&&r.jsx("div",{className:"absolute top-0 left-0 flex h-full w-full items-center justify-center bg-black/75",children:r.jsxs("span",{className:"flex cursor-pointer items-center text-white",onClick:p,children:[r.jsx(H,{name:"IcMenuRelink",className:"mr-2 text-white"}),"刷新"]})}),r.jsx("img",{src:f.qrCodeImageUrl,alt:f.orderId,className:"h-full w-full"})]}),r.jsxs("div",{className:"text-t2-medium flex h-10 items-center justify-center text-grey3",children:[f.qrFailure?"二维码失效，请点击刷新":f.loading?"正在核实订单中...":f.initRefresh?"未查到付款记录":"支付后未跳转？",(!f.loading||f.qrFailure)&&r.jsx("div",{className:Yt("cursor-pointer underline"),onClick:x,children:"点我刷新"})]}),o&&r.jsx("div",{className:"my-4 py-2.5",children:r.jsx(je,{onClick:()=>{u.current&&clearInterval(u.current),o()},className:"text-t2-medium",children:"更换支付方式"})})]})},Uc=({value:e=0})=>{const t=LI({number:e||0}),n=String(e).indexOf(".")+1,s=String(e).length-n;return r.jsx(ME.span,{children:t.number.to(a=>{if(n===0)return a.toFixed(0);if(s>0)return a.toFixed(s)})})},Zge=e=>{const{close:t}=e,n=Ao(),s=Qt(),a=Yr(s.uuid),o=Ft();let i=r.jsxs(r.Fragment,{children:[r.jsx(Ps,{className:"mr-2 h-6 w-6",icon:o.icon,name:o.title,color:o.backgroundColor}),r.jsx("span",{className:"text-t2 text-grey3",children:o.title})]});return n||(i=r.jsxs(r.Fragment,{children:[r.jsx(Ps,{name:a,color:s.backgroundColor,icon:{type:"upload",value:s.avatar},className:"mr-2 w-[25px] h-[25px] text-white rounded-full",imgClassName:"rounded-full",style:{fontSize:"14px"}}),r.jsxs("span",{className:"text-grey3 text-t2",children:[a," ",jd(s.phone)]})]})),r.jsxs("div",{className:"flex items-center pr-5 pl-8 h-12 border-b border-grey6 mb-2.5",children:[i,r.jsx(H,{name:"IcTitleClose",onClick:t,size:"middle",className:"ml-auto animate-click"})]})},e_e=e=>{const{items:t,selectId:n,loading:s,itemRender:a,itemClick:o,itemClassName:i}=e;return r.jsx(vo,{className:Yt("px-7 overflow-x-auto transition-all",s&&"opacity-60"),children:t.map(l=>r.jsx("div",{className:Yt("flex flex-col items-center justify-center flex-shrink-0 w-[120px] h-32 mr-5 border-2 rounded-md cursor-pointer relative",i,n===l.id?"border-black bg-black_003":"border-grey5",l.enable===2&&"opacity-30 cursor-not-allowed"),onClick:()=>{l.enable===2||n===l.id||o(l.id)},children:a(l)},l.id))})},t_e=e=>{const{endTime:t,children:n}=e;return r.jsxs(vo,{height:36,className:"px-8 text-grey3 text-t3",children:["购买后有效期至 ",t,n]})},n_e=e=>{const{payMethod:t,switchPayMethod:n,disablePayMethod:s,payMethodList:a}=e,o=F.useMemo(()=>a||[{type:Ns.alipay,disable:s==null?void 0:s.includes(Ns.alipay),title:r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:"IcAlipayPay",size:"middle",className:"mr-2 text-[#1677FF]"})," 支付宝支付"]})},{type:Ns.wxpay,disable:s==null?void 0:s.includes(Ns.wxpay),title:r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:"IcWechatPay",size:"middle",className:"mr-2 text-[#07C160]"})," 微信支付"]})}],[s,a]);return r.jsxs(r.Fragment,{children:[r.jsx(vo,{height:54,className:"text-h3 px-8",children:"支付方式"}),r.jsx("div",{className:"flex justify-center px-6",children:o.map(i=>r.jsx("div",{onClick:()=>!i.disable&&n(i.type),className:Yt("text-t2-medium flex items-center justify-center mx-2.5 border flex-1 h-10 rounded-md cursor-pointer transition-all",i.type===t?"border-black bg-black_003":"border-grey5",i.disable&&"cursor-not-allowed opacity-30"),children:i.title},i.type))})]})},s_e=e=>{const{price:t,onPay:n,disablePay:s,priceUnit:a,protocols:o=[]}=e,[i,l]=F.useState(!1),c={link:An.paidServices,title:"《付费服务条款》"},u=()=>{if(!i){ye.warning("请开通前阅读并同意《付费服务条款》");return}n()};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-between items-center px-8 mt-4 mb-2.5 h-9 text-grey3 text-t3 select-none",children:[r.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>l(!i),children:[r.jsx(H,{name:i?"IcCircleCheck":"IcCircleCheckbox",size:"middle",className:Yt("mr-1.5",i?"text-active_color":"text-grey3")}),"开通前阅读并同意",[c,...o].map(d=>r.jsx("a",{href:d.link,onClick:f=>f.stopPropagation(),target:"_blank",children:d.title},d.title))]}),r.jsxs("span",{className:"flex items-center",children:[r.jsx($s,{emojiStr:"⚠️",disableHover:!0,iconSize:12})," 暂不支持退款"]})]}),r.jsxs("div",{className:"flex justify-between items-center px-8 h-20 border-t border-grey6 select-none",children:[r.jsxs("div",{className:"text-h3",children:["总计：",r.jsxs("span",{className:"text-active_color-base",children:[xr(a),r.jsx(Uc,{value:t})]})]}),r.jsx(je,{autoFocus:!0,className:"text-t2-medium w-52 h-10",disable:s,colorType:"active",onClick:u,children:"立即支付"})]})]})},Xo={Header:Zge,SelectPlan:e_e,PayBar:s_e,PayMethod:n_e,PlanEndTime:t_e},r_e=e=>{var L;const{isFrom:t=Vt.dashboard_file}=e,{integralInfo:n}=m_(),s=Pa(),a=Oa(),o=fi(),i=Ft(),l=me(),[c,u]=F.useState(Ns.alipay),[d,f]=F.useState((L=e.planId)!=null?L:""),[h,p]=F.useState([]),[g,_]=F.useState({}),[x,y]=F.useState(),[b,E]=F.useState([]),[w,k]=F.useState(!0),C=g[d],T=()=>l.closeModal(Xe.UPGRADE_CAPACITY),v=async()=>{var U,V,W;if(!d)return;const P=await Ce.infra.getCouponList(d,void 0,i.uuid);E((U=P.list)!=null?U:[]);const M=Sa((V=P.list)==null?void 0:V.filter(z=>{var Q,Z;return((Q=z.integralRecord)!=null?Q:0)<=((Z=n==null?void 0:n.currentScore)!=null?Z:0)}));if(!M){y(void 0);return}(W=P.list)!=null&&W.some(z=>z.id===x)||y(M.id)},I=P=>{k(!0),f(P)},j=async()=>{if(d&&i.uuid){const P=await Ce.infra.getQuote({spaceId:i.uuid,planId:d,couponId:x,date:0,people:0});d&&_(M=>({...M,[d]:{...P,planId:d}}))}k(!1)};bm(()=>{j()},[d,x],{wait:100});const D=P=>{const M=h.find(U=>U.id===d);ky({bizType:`${P}_file`,order_channel:c===Ns.alipay?"zhifubao":"weixin",is_from:t,order_amount:C==null?void 0:C.amount,order_capacity:M==null?void 0:M.currentPriceUnit,space_type:i.planType})};F.useEffect(()=>{v()},[d]);const S=F.useMemo(()=>C!=null&&C.desiredExpireTime?he((C==null?void 0:C.desiredExpireTime)||Date.now()).format("YYYY年MM月DD日"):"",[C==null?void 0:C.desiredExpireTime]),R=async()=>{ye.loading("正在创建订单"),k(!0);const P=()=>Ce.infra.createCapacityOrder({spaceId:i.uuid,planId:d,couponId:x,payType:c});D("pay_order");const M=await P();if(k(!1),!M.orderId)return ye.error("下单失败，请重试");l.modal({content:({onCloseModal:U})=>r.jsx(U3,{rePayOrder:P,onFinish:async()=>{D("order_finish"),T(),a(),await o(i.uuid),await Za(500),s({defaultMenuType:Jt.upgrade,from:Vt.pay})},payType:c,priceTitle:`${xr(C==null?void 0:C.amountUnit)}${M.amount}`,onCloseModal:U,orderId:`${M.orderId}`,qrCodeUrl:`${M.qrCodeUrl}`})})},A=P=>{y(P)};return F.useEffect(()=>{Ce.infra.capacityPlanList(i.uuid).then(P=>{var V;const M=(V=P.list)!=null?V:[],[U]=M;U&&(p(M),(!d||!M.map(W=>W.id).includes(d))&&f(U.id))})},[i.uuid]),{couponId:x,selectCoupon:A,onPay:R,close:T,payMethod:c,setPayMethod:u,planId:d,onSelectPlan:I,planList:h,couponList:b,curCalculateQuote:C,loading:w,lastDate:S}},sO=ag(r_e),a_e=()=>{const{couponId:e,selectCoupon:t,onPay:n,close:s,payMethod:a,setPayMethod:o,planId:i,onSelectPlan:l,planList:c,curCalculateQuote:u,loading:d,lastDate:f,couponList:h}=ws(sO),p=yd();return r.jsxs(r.Fragment,{children:[r.jsx(Xo.Header,{close:s}),r.jsxs("div",{className:"px-7",children:[r.jsx(vo,{height:54,className:"text-h2",children:"购买容量包"}),r.jsxs(vo,{height:36,className:"text-grey3 text-t3",children:["已使用",es(p.currentCapacity),"，",r.jsxs("span",{children:[" 总容量 ",es(p.maxCapacity)," = "]}),r.jsxs("span",{children:[es(p.baseCapacity),"基础容量"]}),r.jsxs("span",{hidden:!(p.buyCapacity+p.giveCapacity),children:[" + ",es(p.buyCapacity+p.giveCapacity),"补充容量包"]}),r.jsxs("span",{hidden:!p.peopleCapacity,children:[" + ",es(p.peopleCapacity),"席位容量"]})]})]}),r.jsx(Xo.SelectPlan,{items:c,loading:d,selectId:i,itemClick:l,itemRender:g=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2-medium mb-2.5",children:g.name}),r.jsxs("div",{className:"text-h3",children:[xr(g.currentPriceUnit),g.currentPrice,"/年"]})]})}),r.jsx(Xo.PlanEndTime,{endTime:f}),r.jsx(M3,{onSelectId:t,couponList:h,selectId:e,className:"px-8 my-2.5"}),r.jsx(Xo.PayMethod,{payMethod:a,switchPayMethod:o}),r.jsx(Xo.PayBar,{price:u==null?void 0:u.amount,priceUnit:u==null?void 0:u.amountUnit,disablePay:d,onPay:n})]})},rO=()=>{const e=me();return F.useCallback(t=>e.modal({modalId:Xe.UPGRADE_CAPACITY,className:"w-[600px] max-h-[80vh] next-modal-scroll",content:()=>r.jsx(sO,{planId:t==null?void 0:t.planId,isFrom:t==null?void 0:t.isFrom,children:r.jsx(a_e,{})})}),[e])},aO=e=>{var C,T;const{type:t}=e,n=Ft(),s=Ro(),a=Pa(),o=yd(n.uuid),i=Math.min(CT((C=o==null?void 0:o.currentCapacity)!=null?C:0,(T=o==null?void 0:o.maxCapacity)!=null?T:0),100),{blocksMaxLimit:l,blocksUsage:c,blocksIsMax:u}=_g(),d=Math.min(CT(c,l),100),f=Qt(),p=Va()[f.uuid],{isNovice:g}=yd(),_=hk(),[x,y]=WE(Ey.SPACE_CAPACITY),b=oD();if((p==null?void 0:p.spaceRole)!==m.PermissionRole.EDITOR)return null;const E=d>80,w=`linear-gradient(to right, ${i>=80?to.red:"var(--grey3)"} ${i}%, var(--black-10) ${i}%)`,k=`linear-gradient(to right, ${d>=80?to.red:"var(--grey3)"} ${d}%, var(--black-10) ${d}%)`;if(t==="setting")return r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:["总容量 ",es(o==null?void 0:o.maxCapacity),"，",r.jsxs("span",{className:i>=80?"text-red":"",children:["已使用 ",es(o==null?void 0:o.currentCapacity)," ",i,"%"]})]}),r.jsx("div",{className:"h-9 flex items-center",children:r.jsx("div",{style:{width:"100%",maxWidth:400,height:5,backgroundImage:w}})})]});if(t==="header"){if(i<=95||he(b).diff(he(x),"day")<1&&x)return null;const I={title:g?"新手期存储容量已达上限":`「${n.title}」存储容量已达上限`,button:g?"解锁免费容量":"升级扩容",bg:g?"bg-active_color":"bg-red"};return u&&sd(I,{title:"小组试用版使用块数已达上限",button:"升级扩容",bg:"bg-red"}),r.jsxs("div",{className:B("text-t2 h-[60px] flex items-center justify-center text-white-base pr-10 text-ellipsis",I.bg),children:[I.title,"，查看 ",r.jsx("span",{className:"underline underline-offset-4 animate-click",onClick:()=>{a({defaultMenuType:Jt.spaceInfo,from:Vt.capacity_header})},children:"空间信息"})," 或",r.jsx(je,{className:"ml-3",colorType:"white",onClick:()=>{if(g){_();return}s(Vt.capacity_header)},children:I.button}),r.jsx(Js,{className:"absolute right-4 z-10 animate-click",onClick:()=>{y(he(b).format("YYYY-MM-DD HH:mm"))},children:r.jsx(H,{name:"IcTitleClose",size:"middle"})})]})}return i<=80&&d<=80?null:r.jsxs(Fe,{className:"py-5 px-4 border-grey6 border-t w-full flex flex-col text-t4 animate-hover",placement:"right",arrow:!0,popupClass:"py-1 px-2",onClick:()=>{s(Vt.cataFile)},popup:E?`免费块已使用 ${c}/${l} ${d}%`:`当前空间免费存储容量${es(o==null?void 0:o.maxCapacity)}`,children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"border-b border-black whitespace-nowrap mr-1",children:E?"升级获得无限块":"升级空间"}),r.jsx("div",{className:"text-grey3 text-right",children:E?r.jsxs(r.Fragment,{children:["免费块已使用 ",c,"/",l," ",d,"%"]}):r.jsxs(r.Fragment,{children:[es(o==null?void 0:o.currentCapacity),"/",es(o==null?void 0:o.maxCapacity)]})})]}),r.jsx("div",{className:"mt-3 h-[5px] w-full",style:{backgroundImage:E?k:w}})]})},o_e=()=>{var h;const e=rO(),t=Qc(),n=yd(),{setCurrentSettingMenu:s,setIsFrom:a}=ws(la),o=me(),i=ui(),l=Ao(),c=()=>{s(Jt.upgrade),a(Vt.dashboard_file)},u=F.useCallback(()=>{o.modal({modalId:Xe.CAPACITY_ORDER_LIST_ID,content:()=>r.jsx(i_e,{})})},[o]),d=F.useMemo(()=>{var _;const p=(_=t.spacePlan)!=null&&_.endAt?he(t.spacePlan.endAt).format("YYYY/MM/DD"):void 0,g=[{title:"基础容量",size:n.baseCapacity,rightPart:i?p:"永久有效"}];return i&&(l&&n.peopleCapacity&&g.push({title:"席位容量",size:n.peopleCapacity,rightPart:p}),g.push({title:"补充容量",size:n.buyCapacity+n.giveCapacity,desc:r.jsx("span",{className:"ml-1 text-active_color animate-click",onClick:()=>e(),children:"购买容量包"}),rightPart:r.jsxs("div",{className:"flex items-center justify-between animate-click",onClick:u,children:[r.jsxs("span",{className:"text-red mr-1",hidden:!n.expirationCapacity,children:[es(n.expirationCapacity)," 即将到期"]}),r.jsx("span",{className:"w-4",hidden:!!n.expirationCapacity}),r.jsx(H,{name:"IcArrowUnfold",size:"xxxsmall"})]})})),g},[(h=t.spacePlan)==null?void 0:h.endAt,i,l,u,e,n]),f=F.useMemo(()=>{let p="";return n.isNovice&&(p=`新手期限制容量 ${es(n.maxCapacity)}
      ，完成入门任务解锁免费容量 2GB`),!i&&l&&(p=`小组版试用期间限制容量 ${es(n.maxCapacity)}，升级到小组正式版解锁全部容量 300GB`),p?r.jsx("div",{className:"bg-active_color_10 text-active_color h-9 px-4 text-t3 flex items-center mt-2.5",children:p}):null},[i,l,n.isNovice,n.maxCapacity]);return r.jsxs(r.Fragment,{children:[r.jsx(qs,{title:"空间储存容量",description:r.jsx(aO,{type:"setting"}),rightPart:!i&&r.jsx(je,{onClick:c,children:"升级扩容"})}),r.jsx("div",{className:"px-4 py-2 rounded bg-grey9 select-none",children:d.map((p,g)=>r.jsxs("div",{className:"h-7 flex items-center justify-between text-grey3",children:[r.jsxs("div",{children:[p.title," ",es(p.size)," ",p.desc]}),r.jsx("div",{children:p.rightPart})]},g))}),f]})},i_e=()=>{const e=me(),t=rO(),n=F.useRef(null),s=Ft(),a=yd(),o=c=>{e.closeModal(Xe.CAPACITY_ORDER_LIST_ID),t({planId:c})},i=async c=>{const u=await Ce.infra.capacityList(c.pageIndex,c.pageSize,s.uuid);return{list:u.list,more:u.list.length<=c.pageSize&&u.list.length>0}},l=a.giveCapacity>0;return r.jsxs("div",{className:"w-125 py-1",children:[r.jsxs("div",{className:"h-12 flex items-center justify-between px-7",children:[r.jsx("span",{className:"text-h4",children:"补充容量"}),r.jsx("span",{className:"text-t2 animate-click text-active_color",onClick:()=>o(),children:"购买容量包"})]}),r.jsx(kt.SettingDivider,{}),r.jsxs("div",{className:"px-7 text-t2",children:[r.jsxs("div",{className:"grid grid-cols-6 h-10 items-center",children:[r.jsx("span",{className:"col-span-2",children:"容量套餐"}),r.jsx("span",{className:"col-span-2",children:"使用状态"}),r.jsx("span",{className:"col-span-2",children:"到期时间"})]}),r.jsx(kt.SettingDivider,{}),r.jsxs("div",{ref:n,className:"max-h-80 overflow-y-auto",children:[l&&r.jsx(r.Fragment,{children:r.jsxs("div",{className:"grid grid-cols-6 h-10 items-center",children:[r.jsxs("span",{className:"col-span-2",children:[es(a.giveCapacity)," "]}),r.jsx("span",{className:"col-span-2",children:"使用中"}),r.jsx("span",{className:"col-span-2",children:"2023/12/31 23:59"})]})}),r.jsx(Xge,{container:n,getApi:i,placeholder:l?"":"无容量包记录",renderItem:c=>r.jsxs("div",{className:Yt("grid grid-cols-6 h-10 items-center",c.status!==20&&"opacity-30"),children:[r.jsxs("span",{className:"col-span-2",children:[c.planPriceUnit,"GB ",r.jsx("span",{className:"text-active_color animate-click ml-1",hidden:c.status!==20,onClick:()=>o(c.planId),children:"续费"})]}),r.jsx("span",{className:"col-span-2",children:c.status===20?"使用中":"已过期"}),r.jsx("span",{className:"col-span-2",children:he(c.expirationTime).format("YYYY/MM/DD HH:mm")})]},c.id)})]})]})]})},l_e=()=>{var h;const{spacePlan:e}=Qc(),{setCurrentSettingMenu:t,setIsFrom:n}=ws(la),s=ui(),a=Va(),o=Ft(),i=Object.values(a),l=Qp(),c=Ao(),u=r.jsx("span",{className:"mx-4 text-grey3 text-t2",children:"|"}),[d,f]=F.useMemo(()=>{const p=c?i.length>=((e==null?void 0:e.maxPeople)||1):!1;return s?[!1,p]:[l.length>=5,p]},[e==null?void 0:e.maxPeople,l.length,s,c,i.length]);return r.jsx(r.Fragment,{children:r.jsx(qs,{title:"空间成员与外部协作者",description:r.jsx(kt.Item,{leftChild:r.jsxs("div",{className:"flex whitespace-nowrap mr-2",children:[r.jsxs("div",{children:["空间成员 ",r.jsxs("span",{className:B(f&&"text-red"),children:[i.length,"/",(e==null?void 0:e.maxPeople)||1]})]}),u,c&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex",children:["空间成员组 ",r.jsx("span",{children:((h=o.permissionGroups)==null?void 0:h.length)||0})]}),u]}),r.jsxs("div",{children:["外部协作者 ",r.jsxs("span",{className:B(d&&"text-red"),children:[l.length,s?"":"/5人"]})]})]}),rightChild:r.jsx(je,{onClick:()=>{t(Jt.upgrade),n(Vt.dashboard_member)},children:"升级扩容成员席位"})})})})},c_e=e=>{var Z,te,re,ne,Y;const{isFrom:t,selectPlanSpaceType:n}=e,{integralInfo:s}=m_(),a=(Z=s==null?void 0:s.currentScore)!=null?Z:0,{spacePlan:o}=Qc(),i=Pa(),l=Oa(),c=Ft(),u=me(),d=Kt(),f=ui(),h=c.planType===n,[p,g]=F.useState([]),[_,x]=F.useState([]),[y,b]=F.useState({planId:(te=p[0])==null?void 0:te.id,selectPayType:Ns.alipay,selectCoupon:void 0}),[E,w]=F.useState(!0),[k,C]=F.useState({}),T=F.useCallback(X=>X?k[X]:void 0,[k]),v=F.useMemo(()=>p.find(X=>X.id===y.planId),[p,y.planId]),I=F.useMemo(()=>T(y.planId),[y.planId,T]),j=((re=v==null?void 0:v.monthNum)!=null?re:0)>=12,D=(Y=(ne=v==null?void 0:v.spacePlanType)==null?void 0:ne.toLocaleLowerCase())==null?void 0:Y.includes("cycle"),S=(v==null?void 0:v.spacePlanType)==="stuDiscountCash",R=_.find(X=>X.id===y.selectCoupon),A=(X,oe)=>{b(ie=>({...ie,[X]:oe}))},L=()=>{d(Xe.SELECT_UPDATE_PLAN)},P=async()=>{var oe,ie,ue;w(!0);const X=await Ce.infra.getNewPlanList(c.uuid,"personal",y.selectPayType);if(g((oe=X.list)!=null?oe:[]),!((ie=X.list)!=null&&ie.some(ge=>ge.id===y.planId))){const ge=Sa((ue=X.list)==null?void 0:ue.filter(Ne=>Ne.enabled!==2));A("planId",ge==null?void 0:ge.id)}w(!1)},M=async()=>{var ie,ue,ge;if(!y.planId)return;const X=await Ce.infra.getCouponList(y.planId,void 0,c.uuid);x((ie=X.list)!=null?ie:[]);const oe=Sa((ue=X.list)==null?void 0:ue.filter(Ne=>{var De;return((De=Ne.integralRecord)!=null?De:0)<=a}));if(!oe){A("selectCoupon","");return}(ge=X.list)!=null&&ge.some(Ne=>Ne.id===y.selectCoupon)||A("selectCoupon",oe.id)},U=async()=>{var oe;const{planId:X}=y;if(X&&c.uuid){const ie=await Ce.infra.getQuote({spaceId:c.uuid,planId:X,couponId:y.selectCoupon,date:(oe=v==null?void 0:v.monthNum)!=null?oe:0,people:1});X&&C(ue=>({...ue,[X]:{...ie,planId:X}}))}},V=X=>{ky({bizType:X,order_amount:I==null?void 0:I.amount,order_month:v==null?void 0:v.monthNum,order_channel:y.selectPayType===Ns.irpay?"point":y.selectPayType===Ns.alipay?"zhifubao":"weixin",is_from:t,order_type:D?"repeat":"single",order_new:f?"yes":"no",coupon_amount:R==null?void 0:R.salePrice,pay_point:R==null?void 0:R.integralRecord,coupon_type:J5(R==null?void 0:R.type),space_current_type:c.planType,space_target_type:n})},W=async()=>{if(!y.planId){ye.warning("请选择套餐");return}w(!0),ye.loading("正在创建订单"),V("pay_order");const X=()=>Ce.infra.createPreOrderV2({payType:y.selectPayType,planId:`${y.planId}`,spaceId:c.uuid,couponId:y.selectCoupon}),oe=await X();if(w(!1),!oe.orderId)return ye.error("下单失败，请重试");u.modal({content:({onCloseModal:ie})=>r.jsx(U3,{rePayOrder:X,onFinish:async()=>{V("order_finish"),L(),l(),await xs(500),i({defaultMenuType:Jt.upgrade,from:Vt.pay})},payType:y.selectPayType,priceTitle:`${xr(I==null?void 0:I.amountUnit)}${oe.amount}`,onCloseModal:ie,orderId:`${oe.orderId}`,qrCodeUrl:`${oe.qrCodeUrl}`})})},z=F.useMemo(()=>E?!0:!(y.planId&&(I!=null&&I.amount)),[E,y.planId,I==null?void 0:I.amount]);F.useEffect(()=>{P()},[c.uuid,y.selectPayType]),F.useEffect(()=>{M()},[y.planId]),bm(()=>{U()},[y.planId,y.selectCoupon],{wait:100});const Q=F.useMemo(()=>he((I==null?void 0:I.desiredExpireTime)||(o==null?void 0:o.endAt)||Date.now()).format("YYYY年MM月DD日"),[I==null?void 0:I.desiredExpireTime,o==null?void 0:o.endAt]);return r.jsxs(r.Fragment,{children:[r.jsx(Xo.Header,{close:L}),r.jsxs("div",{className:"px-8",children:[r.jsxs(vo,{height:54,className:"text-h2",children:[h?"续费":"升级到","“",cr(v==null?void 0:v.spaceType),"”"]}),r.jsxs(vo,{height:36,className:"text-grey3 text-t3",children:[h?"":"升级",cr(v==null?void 0:v.spaceType),"，单文件大小提升到5G，以及更多高级功能。"]})]}),r.jsx(Xo.SelectPlan,{items:p,itemClick:X=>{C({}),A("planId",X),A("selectCoupon",void 0)},selectId:y.planId,itemClassName:"w-[135px]",itemRender:X=>{const oe=_.find(Ie=>Ie.id===y.selectCoupon),ie=y.planId===X.id?oe==null?void 0:oe.label:void 0,ue=X.currentPrice||X.originalPrice,ge=X.currentPriceUnit||X.originalPriceUnit,Ne=k[X.id],De=Ne?Ne==null?void 0:Ne.amount:ue,Se=Ne?Ne==null?void 0:Ne.amountUnit:ge;return r.jsxs(r.Fragment,{children:[ie&&r.jsx(eO,{bgColor:y.selectPayType===Ns.irpay?"black":"",children:ie}),r.jsx("div",{className:"mb-2.5 text-t2-medium",children:X.name}),r.jsxs("div",{className:"text-h3",children:[r.jsxs("span",{className:"text-black mr-0.5",children:[xr(Se),De]}),r.jsxs("span",{className:"text-grey3 line-through text-t2 whitespace-nowrap",hidden:!De||!X.originalPrice||De>=X.originalPrice,children:["原价 ",xr(X.originalPriceUnit),X.originalPrice]})]})]})}}),r.jsxs(Xo.PlanEndTime,{endTime:Q,children:[D&&r.jsxs(r.Fragment,{children:["，次",j?"年":"月"," ",xr(v==null?void 0:v.currentPriceUnit),v==null?void 0:v.currentPrice," 续费，随时取消。"]}),S&&r.jsx(r.Fragment,{children:"，教育优惠专享价格"})]}),r.jsx(M3,{onSelectId:X=>A("selectCoupon",X),couponList:_,selectId:y.selectCoupon,className:"px-8 my-2.5"}),r.jsx(Xo.PayMethod,{payMethod:y.selectPayType,switchPayMethod:X=>A("selectPayType",X),disablePayMethod:D?[Ns.wxpay]:[]}),r.jsx(Xo.PayBar,{price:I==null?void 0:I.amount,priceUnit:I==null?void 0:I.amountUnit,disablePay:z,onPay:W,protocols:D?[{link:An.cyclePlan,title:"《自动续费服务协议》"}]:[]})]})},u_e=({onCloseModal:e})=>r.jsxs("div",{className:"flex flex-col items-center py-10 px-20",children:[r.jsx("div",{className:"text-h3 mb-5",children:"恭喜升级到团队版！"}),r.jsx("div",{className:"text-t1 mb-2.5",children:"添加你的客户经理获取发票和合同"}),r.jsx("img",{src:Dn.teamWechatQr,className:"mb-7 w-60 h-60"}),r.jsx(je,{colorType:"active",className:"w-full",onClick:()=>e(),children:"确定"})]}),d_e=()=>{const e=me();return()=>{e.modal({modalId:"paySuccess",content:({onCloseModal:t})=>r.jsx("div",{children:r.jsx(u_e,{onCloseModal:t})})})}},f_e=e=>{var Q;const{isFrom:t,selectPlanSpaceType:n}=e,s=Pa(),{integralInfo:a}=m_(),o=(Q=a==null?void 0:a.currentScore)!=null?Q:0,i=d_e(),l=me(),c=Ft(),u=Va(),d=Object.values(u),f=F.useRef(),{spacePlan:h}=Qc(),p=n===c.planType,g=p?`续费“${cr(n)}”`:`升级到“${cr(n)}”`,_=n===Et.team,x=n===Et.smallTeam,y=F.useMemo(()=>{var Z;return Math.max(x?5:p?(Z=h==null?void 0:h.maxPeople)!=null?Z:1:2,d.length)},[p,h==null?void 0:h.maxPeople,d.length,x]),[b,E]=F.useState(!0),[w,k]=F.useState([]),[C,T]=F.useState([]),[v,I]=F.useState({read:!1,customPeople:Math.max(y,2),selectedPayType:Ns.alipay,selectedRenewalType:p?1:0,addPeople:1,selectedYear:{type:"fixed",value:1},couponId:void 0}),j=C.find(Z=>Z.id===v.couponId),[D,S]=F.useState(),R=F.useMemo(()=>{if(!(D!=null&&D.desiredExpireTime))return{day:0};const Z=Date.now(),te=new Date(D.desiredExpireTime),re=he(te).diff(Z,"year"),ne=he(Z).add(re,"year"),Y=he(te).diff(ne,"day");return{year:re,day:Y}},[D==null?void 0:D.desiredExpireTime]),A=(Z=v)=>{var X;const te=w.find(oe=>{if(p){if(Z.selectedRenewalType===0)return oe.spacePlanType==="renewTeamPeople";if(Z.selectedRenewalType===1)return oe.spacePlanType==="renewTeamTime"}return oe.spacePlanType==="upgradeTeam"});let re=Z.selectedYear.type==="custom"?Z.customYear:Z.selectedYear.value,ne=0,Y=Z.customPeople||y;return p?Z.selectedRenewalType===0?(ne=Z.addPeople,Y=Z.addPeople+y,re=0):(ne=y,Y=y):ne=Z.customPeople||0,{addPeople:ne,currentPlan:te,planId:(X=te==null?void 0:te.id)!=null?X:"",date:re!=null?re:0,people:Y}},L=async(Z=v)=>{const{planId:te,date:re,people:ne}=A(Z);return await Ce.infra.getQuote({planId:te,date:re,people:ne,spaceId:c.uuid,couponId:Z.couponId})},P=async(Z=v)=>{const{planId:te}=A(Z);if(!te)return;const re=setTimeout(()=>{E(!0),clearTimeout(re)},800),ne=await L(Z);clearTimeout(re),S(ne),E(!1)},M=async(Z=v,te=0)=>{const{planId:re,date:ne}=A(Z),Y=await Ce.infra.getCouponList(re,oj(`${ne*12}`),c.uuid),X=aj(Y.list,ue=>{var ge,Ne;return((ge=ue.minPrice)!=null?ge:0)<=te&&((Ne=ue.integralRecord)!=null?Ne:0)<=o});T(X);const oe=Sa(X);let ie=Z.couponId;oe?X!=null&&X.some(ue=>ue.id===Z.couponId)||(U("couponId",oe.id),ie=oe.id):U("couponId",""),P({...Z,couponId:ie})};F.useEffect(()=>{Ce.infra.getNewPlanList(c.uuid,n).then(Z=>k(Z.list||[])),ce.event("payorder_show",{is_from:t})},[c.uuid,t,n]),bm(()=>{var te;if(w.length===0)return;const Z={...v,couponId:""};(te=L(Z))==null||te.then(re=>{M(Z,re.amount)})},[w,v.customYear,v.selectedYear,v.selectedRenewalType,v.addPeople,v.customPeople],{wait:300});const U=(Z,te)=>{I(re=>({...re,[Z]:te}))},V=()=>{l.closeModal(Xe.SELECT_UPDATE_PLAN)},W=Z=>{Ce.infra.cancelOrder(Z)};return{selectPlanSpaceType:n,couponList:C,state:v,patchState:U,calculateQuote:D,inputCustomPeopleTimer:f,spaceMaxPeople:y,completionTime:R,loading:b,getOrderParams:A,payOrder:async()=>{var ue;if(v.selectedPayType===Ns.offline&&(ue=(await Ce.infra.getOrderList(1,1,c.uuid)).pendingList)!=null&&ue[0]){l.warning({title:r.jsx("div",{className:"mb-3",children:"请先处理未完成订单"}),confirmText:"去查看",confirm:()=>{V(),s({defaultMenuType:Jt.order,from:Vt.order})}});return}if(!v.read){ye.warning("请开通前阅读并同意《付费服务条款》");return}const Z=()=>Ce.infra.createPreOrderV2({payType:v.selectedPayType,spaceId:c.uuid,couponId:v.couponId,planId:te,date:re,people:ne});l.loading({modalId:"payLoading",title:"正在下单"});const{planId:te,date:re,people:ne}=A(),Y=await Z();l.closeModal("payLoading");const X=p?"yes":"no",oe=ge=>{ky({bizType:ge,order_amount:Y.amount,order_month:(R.year||0)*12,order_channel:v.selectedPayType===Ns.offline?"card":Ns.alipay?"zhifubao":"weixin",is_from:t,order_new:X,order_type:"single",coupon_type:J5(j==null?void 0:j.type),coupon_amount:j==null?void 0:j.salePrice,pay_point:j==null?void 0:j.integralRecord,space_current_type:c.planType,space_target_type:n})},ie=async()=>{oe("order_finish"),V(),await xs(1e3),s({defaultMenuType:Jt.upgrade,from:Vt.pay}),_&&i()};oe("pay_order"),Ns.offline===v.selectedPayType?l.modal({keyboard:!1,content:({onCloseModal:ge})=>{var Ne;return r.jsx(nO,{onCloseModal:ge,onFinish:ie,orderId:Y.orderId,price:Y.amount||0,endTime:(Ne=Y.expirationTime)!=null?Ne:0,remark:Y.remark,changePayType:()=>{ge(),W(Y.orderId)}})}}):l.modal({keyboard:!1,content:({onCloseModal:ge})=>r.jsx(U3,{onFinish:ie,qrCodeUrl:`${Y.qrCodeUrl}`,orderId:Y.orderId,payType:v.selectedPayType,priceTitle:`${xr(D==null?void 0:D.amountUnit)}${Y.amount}`,onCloseModal:ge,rePayOrder:Z,changePayType:()=>{ge(),W(Y.orderId)}})})},upgradeTitle:g,close:V}},gu=ag(f_e),m_e=e=>r.jsx(gu,{...e,children:r.jsx(h_e,{})}),h_e=F.memo(()=>{var d;const{state:e,patchState:t,calculateQuote:n,completionTime:s,loading:a,getOrderParams:o,payOrder:i,couponList:l,upgradeTitle:c,close:u}=ws(gu);return r.jsxs(r.Fragment,{children:[r.jsx(Xo.Header,{close:u}),r.jsxs("div",{className:B("max-h-[80vh] overflow-y-auto px-8 transition-opacity",a&&"opacity-60"),children:[r.jsx(vo,{height:54,className:"text-h2",children:c}),r.jsx(p_e,{}),r.jsx(M3,{onSelectId:f=>t("couponId",f),couponList:l,selectId:e.couponId,className:"my-2.5"}),r.jsx(F_e,{}),r.jsxs("div",{className:"text-t2 flex h-9 items-center justify-between",children:[r.jsxs("div",{className:"flex cursor-pointer items-center text-grey3",onClick:()=>t("read",!e.read),children:[r.jsx(H,{name:e.read?"IcCircleCheck":"IcCircleCheckbox",size:"middle",className:B("mr-1.5",e.read?"text-active_color":"text-grey3")}),"阅读并同意",r.jsx("a",{href:An.paidServices,onClick:f=>f.stopPropagation(),target:"_blank",rel:"noreferrer",children:"《付费服务条款》"})]}),r.jsxs("span",{className:"flex items-center text-grey4",children:[r.jsx($s,{emojiStr:"⚠️",disableHover:!0,iconSize:12}),"  暂不支持退款"]})]}),r.jsx("div",{className:"my-2.5 h-px w-full bg-grey6"}),r.jsxs("div",{className:"text-h3 mb-2.5 flex h-20 items-center justify-between",children:[r.jsxs("div",{className:"flex-1 flex items-center",children:[r.jsx("span",{children:"总价："}),r.jsxs("span",{className:"text-active_color",children:[xr(n==null?void 0:n.amountUnit),r.jsx(Uc,{value:n==null?void 0:n.amount})]}),r.jsx(Fe,{className:"ml-1.5 text-grey4",placement:"bottom",maxWidth:"none",interactive:!0,popup:r.jsxs("div",{children:[r.jsx("div",{children:"计算方式"}),r.jsx("div",{children:"总价 = 人数 * 购买时长 * 当前版本每人价格"}),r.jsxs("div",{children:[r.jsx("span",{children:xr(n==null?void 0:n.amountUnit)}),r.jsxs("span",{children:[n==null?void 0:n.amount," = "]}),r.jsxs("span",{children:[o().addPeople,"人 * "]}),r.jsxs("span",{children:[e.selectedRenewalType===1?r.jsxs(r.Fragment,{children:[o().date,"年"]}):r.jsxs(r.Fragment,{children:[!!s.year&&r.jsxs(r.Fragment,{children:[s.year,"年"]}),!!s.day&&r.jsxs(r.Fragment,{children:[s.day,"天"]})]})," * "]}),r.jsxs("span",{children:[xr(n==null?void 0:n.amountUnit),(d=o({...e,selectedRenewalType:1}).currentPlan)==null?void 0:d.originalPrice,"/人/年"]})]})]}),children:r.jsx(H,{name:"IcInviteHelp",size:"middle"})})]}),r.jsx(je,{colorType:"active",disable:a,className:"text-t1-medium h-10 w-52",onClick:i,children:"立即支付"})]})]})]})}),p_e=F.memo(()=>{const{selectPlanSpaceType:e}=ws(gu);return Ft().planType===Et.team?r.jsx(x_e,{}):e===Et.team?r.jsxs(r.Fragment,{children:[r.jsx(IE,{}),r.jsx(g_e,{})]}):e===Et.smallTeam?r.jsx(IE,{}):r.jsx(r.Fragment,{})}),IE=F.memo(()=>{const{couponList:e,state:t,patchState:n,calculateQuote:s}=ws(gu);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 flex h-9 items-center",children:"购买时长"}),r.jsxs("div",{className:"text-t2 flex items-center justify-between py-2.5",children:[[{num:1},{num:2}].map(a=>{const o=e.find(l=>l.id===t.couponId),i=o==null?void 0:o.label;return r.jsxs("div",{onClick:()=>n("selectedYear",{type:"fixed",value:a.num}),className:B("relative animate-hover mr-4 flex h-10 w-1/3 items-center justify-center border-[1.5px] border-grey5",{"border-black":t.selectedYear.type==="fixed"&&t.selectedYear.value===a.num}),children:[i&&r.jsx(eO,{children:i}),a.num,"年"]},a.num)}),r.jsx("div",{className:B("animate-hover w-1/3 border border-grey6",{"border-black":t.selectedYear.type==="custom"}),children:r.jsx(V3,{onFocus:()=>{t.customYear&&n("selectedYear",{type:"custom"})},onClick:()=>{t.customYear&&n("selectedYear",{type:"custom"})},afterText:"年",value:t.customYear,onChange:a=>{n("customYear",Math.min(Number(a),99)),a?n("selectedYear",{type:"custom"}):n("selectedYear",{type:"fixed",value:1})}})})]}),r.jsxs("div",{className:"text-t2 py-2 text-grey3",children:["购买后有效期至 ",he(s==null?void 0:s.desiredExpireTime).format("YYYY年MM月DD日"),"。"]})]})}),g_e=F.memo(()=>{const{state:e,patchState:t,inputCustomPeopleTimer:n,spaceMaxPeople:s}=ws(gu);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 mt-2.5 flex h-9 items-center",children:"购买人数"}),r.jsx("div",{className:"w-1/3 py-2.5 pr-4",children:r.jsx(V3,{showBorder:!0,className:"border-[1.5px] border-grey5",value:e.customPeople,afterText:"人",onChange:a=>{t("customPeople",Math.min(Math.max(a,0),99999)),n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{n.current&&clearTimeout(n.current);const o=Math.max(a,Math.max(s,2));o>a&&ye.warning(`最少购买${o}人`),t("customPeople",Math.min(o,99999))},1e3)}})}),r.jsxs("div",{className:"text-t2 py-2 text-grey3",children:["购买后上限  ",r.jsx(Uc,{value:e.customPeople})," 人，当前上限 ",r.jsx(Uc,{value:s})," 人。"]})]})}),__e=F.memo(()=>{const{state:e,patchState:t,spaceMaxPeople:n}=ws(gu);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 mt-2.5 flex h-9 items-center",children:"增加人数"}),r.jsx("div",{className:"w-1/3 py-2.5 pr-4",children:r.jsx(V3,{showBorder:!0,className:"border-[1.5px] border-grey5",value:e.addPeople,afterText:"人",onChange:s=>{t("addPeople",Math.min(Math.max(s,1),99999-n))}})}),r.jsxs("div",{className:"text-t2 py-2 text-grey3",children:["购买后上限 ",r.jsx(Uc,{value:n+e.addPeople})," 人，当前上限 ",r.jsx(Uc,{value:n})," 人。"]})]})}),x_e=F.memo(()=>{const{state:e,patchState:t,completionTime:n,calculateQuote:s}=ws(gu);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 flex h-9 items-center",children:"购买类型"}),r.jsx("div",{className:"text-t2 flex items-center justify-between py-2.5",children:[{type:0,text:"人数"},{type:1,text:"时长"}].map(a=>r.jsxs("div",{onClick:()=>t("selectedRenewalType",a.type),className:B("text-t2-medium animate-hover flex h-10 w-[calc(50%-10px)] items-center justify-center border-[1.5px] border-grey5",e.selectedRenewalType===a.type&&"border-black"),children:["增加",a.text]},a.type))}),r.jsx("div",{className:"text-t2 py-2 text-grey3",children:e.selectedRenewalType===0?"只增加当前空间的人数，不调整到期时间。":"只增加当前空间的到期时间，不调整人数。"}),e.selectedRenewalType===0?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t2 mt-2.5 flex h-9 items-center",children:"购买时长"}),r.jsxs("div",{className:"text-t2 my-2.5 mr-4 flex h-10 w-1/3 items-center justify-center rounded border-[1.5px] border-grey6 text-black/30",children:[!!n.year&&r.jsxs(r.Fragment,{children:[r.jsx(Uc,{value:n.year}),"年"]}),!!n.day&&r.jsxs(r.Fragment,{children:[r.jsx(Uc,{value:n.day}),"天"]})]}),r.jsxs("div",{className:"text-t2 py-2 text-grey3",children:["为保证所有空间成员到期时间均为 ",he(s==null?void 0:s.desiredExpireTime).format("YYYY年MM月DD日"),"，新成员需购买到期剩余时长。"]}),r.jsx(__e,{})]}):r.jsx(IE,{})]})}),F_e=F.memo(()=>{const{state:e,patchState:t,getOrderParams:n,calculateQuote:s,selectPlanSpaceType:a}=ws(gu),o=Ft(),{currentPlan:i}=n(),l=i==null?void 0:i.payList,c=[{type:Ns.alipay,enable:l==null?void 0:l.includes(Ns.alipay),text:r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:"IcAlipayPay",size:"middle",className:"mr-2 text-[#1677FF]"}),"支付宝支付"]})},{type:Ns.wxpay,enable:l==null?void 0:l.includes(Ns.wxpay),text:r.jsxs("span",{className:"flex",children:[r.jsx(H,{name:"IcWechatPay",size:"large",className:"mr-2 text-[#07C160]"}),"微信支付"]})},{type:Ns.offline,enable:l==null?void 0:l.includes(Ns.offline),text:"对公转账"}].filter(u=>u.enable);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-h2 mt-2.5 py-2.5",children:"支付方式"}),r.jsx("div",{className:"flex items-center justify-between py-2.5",children:c.map(u=>r.jsx("div",{onClick:()=>t("selectedPayType",u.type),className:B("text-t2-medium animate-hover flex h-10 w-[calc(50%-10px)] items-center justify-center border-[1.5px] border-grey5 mx-2.5",e.selectedPayType===u.type&&"border-black"),children:u.text},u.type))}),r.jsx(vo,{className:"justify-end text-t2",hidden:((s==null?void 0:s.diffDays)||0)+((s==null?void 0:s.diffAmount)||0)<=0,children:r.jsxs("p",{children:[cr(o.planType),"空间权益剩余",r.jsx("span",{className:"text-active_color mx-1 whitespace-nowrap",children:s==null?void 0:s.diffDays}),"天，可抵",r.jsx("span",{className:"text-active_color mx-1 whitespace-nowrap",children:s==null?void 0:s.diffAmount}),"元。 抵扣金额上限不超过升级",cr(a),"的实际支付金额"]})})]})}),V3=F.memo(e=>{const{value:t,afterText:n,inputClassName:s,onChange:a,...o}=e;return r.jsx(xt,{focusHiddenPlaceholder:!0,inputType:"number",placeholder:"自定义",showBorder:!1,value:t||"",inputClassName:B("h-9 text-center",s),onChange:i=>{const l=Math.max(0,Number(oj(`${i}`)));a==null||a(Number.isNaN(l)?0:l)},addonAfter:r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"h-4 w-px bg-black_006"}),r.jsx("span",{className:"flex h-full w-10 items-center justify-center",children:n})]}),...o})}),y_e=e=>{const{selectPlanSpaceType:t}=e;return t===Et.personal?r.jsx(c_e,{...e}):r.jsx(m_e,{...e})},oO=()=>{const{isFrom:e}=ws(la),t=me();return F.useCallback((n,s)=>{ce.event("pay_show",{is_from:s||e||Vt.package}),t.modal({modalId:Xe.SELECT_UPDATE_PLAN,className:"w-[670px]",keyboard:!1,content:()=>r.jsx(y_e,{selectPlanSpaceType:n,isFrom:e||Vt.package})})},[e,t])},Ff=({planType:e,color:t,right:n})=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:Yt("text-t3-medium pt-px px-1.5 mr-2 rounded text-white",!t&&"text-grey3-base bg-[#A2A4A633]",t==="green"&&"bg-green",t==="purple"&&"bg-purple",t==="pink"&&"bg-pink_purple",t==="black"&&" bg-[#3D3D3D]"),children:cr(e)}),r.jsx("div",{className:"text-t3 text-grey3",children:n})]}),b_e=()=>{const{spacePlan:e}=Qc(),{setCurrentSettingMenu:t,setIsFrom:n}=ws(la),s=Ft(),a=oO(),{isNovice:o}=yd(),i=hk(),l=_g(),[c,u]=F.useMemo(()=>{const d=()=>{const f=he(e==null?void 0:e.endAt).diff(he(),"day");return r.jsxs(r.Fragment,{children:["有效期至 ",he(e==null?void 0:e.endAt).format("YYYY/MM/DD"),"，",r.jsxs("span",{className:f<=5?"text-red":"",children:["剩余",f,"天"]})]})};return o?[r.jsx(Ff,{planType:s.planType,right:"新手期，做任务解锁2G容量"}),r.jsx(je,{className:"text-active_color",onClick:i,children:"解锁免费扩容"})]:s.planType==="freePersonal"?[r.jsx(Ff,{planType:s.planType}),r.jsx(je,{onClick:()=>{t(Jt.upgrade),n(Vt.dashboard_plan)},children:"升级使用更多功能"})]:s.planType==="personal"?[r.jsx(Ff,{color:"green",planType:s.planType,right:r.jsxs(r.Fragment,{children:[d(),r.jsx("span",{className:"text-active_color ml-2 animate-click",onClick:()=>a(Et.personal,Vt.dashboard_plan),children:"立即续费"})]})})]:s.planType==="freeTeam"?[r.jsx(Ff,{planType:s.planType,color:"pink",right:`块数限制 ${l.blocksMaxLimit}，免费块剩余 ${l.blocksStock} 个`}),r.jsx(je,{onClick:()=>{t(Jt.upgrade),n(Vt.dashboard_plan)},children:"升级使用更多功能"})]:s.planType===Et.smallTeam?[r.jsx(Ff,{color:"purple",planType:s.planType,right:r.jsxs(r.Fragment,{children:[d(),r.jsx("span",{className:"text-active_color ml-2 animate-click",onClick:()=>a(Et.smallTeam,Vt.dashboard_plan),children:"立即续费"})]})})]:s.planType===Et.team?[r.jsx(Ff,{color:"black",planType:s.planType,right:r.jsxs(r.Fragment,{children:[d(),r.jsx("span",{className:"text-active_color ml-2 animate-click",onClick:()=>a(Et.team,Vt.dashboard_plan),children:"立即续费"})]})})]:[]},[o,s.planType,e==null?void 0:e.endAt,i,t,n,a,l.blocksMaxLimit,l.blocksStock]);return r.jsxs(r.Fragment,{children:[r.jsx(qs,{title:"空间计划"}),r.jsx(kt.Item,{leftChild:c,rightChild:u})]})},E_e=()=>{const e=Oa();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:kt.commonStyles.container,children:[r.jsx(kt.Header,{title:"空间信息"}),r.jsxs("div",{className:"py-2.5",children:[r.jsx(Yge,{}),r.jsx(b_e,{}),r.jsx(o_e,{}),r.jsx(l_e,{}),r.jsx(Kge,{})]})]}),r.jsx(kt.FooterBar,{confirmText:"关闭",confirm:()=>e()})]})},w_e=({enable:e,setAI:t})=>{var b,E;const{uuid:n}=Qt(),s=Va(),a=Ft(),o=me(),i=dD(),c=Lg()({keywords:void 0}),u=s[n],d=dw(),f=(w,k,C)=>{o.dropdown({popcorn:w.currentTarget,placement:"bottom",content:({onCloseModal:T})=>r.jsx(k_e,{uuid:k,closeSelf:T,type:C})})},h=w=>{o.dropdown({popcorn:w.currentTarget,placement:"left",content:({onCloseModal:k})=>r.jsx("div",{className:"next-modal w-[400px] pt-2.5",children:r.jsx(Ak,{searchType:"aiMember",uuid:Ut(),backToMainPanel:k})})})},p=(E=(b=a.planType)==null?void 0:b.toLowerCase())==null?void 0:E.includes("team"),g=new Set;i.forEach(w=>g.add(w.uuid));const{permissionGroups:_=[]}=a,x=[];_.forEach(w=>{g.has(w.id)&&x.push({...w,uuid:w.id,type:m.PermissionType.GROUP,name:w.name,userIds:w.userIds})});const y=c.filter(w=>g.has(w.uuid));return d?r.jsxs(r.Fragment,{children:[r.jsx(qs,{title:"FlowUs AI",description:r.jsxs(r.Fragment,{children:["关闭后，空间里将不再显示AI写作入口，开启 FlowUs AI 即代表您同意",r.jsx("a",{className:"underline ml-1",target:"_blank",href:"/share/55698213-8c16-4710-a147-2279853aa133",children:"免责声明"})]}),rightPart:r.jsx(wn,{open:e,onSwitch:w=>{ce.event("ai_switch_set",{is_open:w}),t(w)}})}),p&&e&&r.jsxs("div",{className:"mt-2.5",children:[g.has(a.uuid)&&r.jsxs("div",{className:"group flex shrink-0 items-center h-[58px]",children:[r.jsx(Ps,{className:"w-[34px] h-[34px] mr-2",name:a.title,icon:a.icon,color:a.backgroundColor,iconSize:34,style:{fontSize:"20px"}}),r.jsxs("div",{className:"flex flex-col text-t2 grow mr-3 text-ellipsis",children:[a.title,"（",Object.keys(s).length," 人）"]}),r.jsxs("button",{className:"flex items-center ml-auto flex-shrink-0",onClick:w=>f(w,a.uuid,"space"),children:["允许",r.jsx(H,{name:"IcArrow",className:"ml-1",size:"xxxsmall"})]})]}),r.jsx(Mp,{foldLength:50,items:y,renderItemContent:w=>{var v;const k=(u==null?void 0:u.spaceRole)===m.PermissionRole.EDITOR,C=(v=a.userRemark)==null?void 0:v[w.uuid];let T=w.nickname;return C&&(T=`${C} (${w.nickname||"未命名用户"})`),r.jsxs("div",{className:"group flex shrink-0 items-center h-[58px]",children:[r.jsx(Nc,{user:w,className:"mr-2 w-[30px] h-[30px] !text-t1"}),r.jsxs("div",{className:"flex flex-col grow mr-3 text-ellipsis",children:[r.jsx("div",{className:"flex items-center",children:r.jsx("span",{className:"mb-0.5 text-t2",children:T||ni})}),r.jsx("span",{className:"text-grey3 text-t4",children:jd(w.phone)})]}),k&&r.jsxs("button",{className:"flex items-center ml-auto flex-shrink-0",onClick:I=>f(I,w.uuid,"user"),children:["允许",r.jsx(H,{name:"IcArrow",className:"ml-1",size:"xxxsmall"})]})]},w.uuid)}}),r.jsx(Mp,{foldLength:50,items:x,renderItemContent:w=>{const k=(u==null?void 0:u.spaceRole)===m.PermissionRole.EDITOR;return r.jsxs("div",{className:"group flex shrink-0 items-center h-[58px]",children:[r.jsx(Ps,{className:"w-[34px] h-[34px] mr-2 text-white",name:w.name,icon:w.icon,color:to.grey,iconSize:34,style:{fontSize:"20px"}}),r.jsxs("div",{className:"flex flex-col text-t2 grow mr-3 text-ellipsis",children:[w.name,"（",w.userIds.length," 人）"]}),k&&r.jsxs("button",{className:"flex items-center ml-auto flex-shrink-0",onClick:C=>f(C,w.uuid,"group"),children:["允许",r.jsx(H,{name:"IcArrow",className:"ml-1",size:"xxxsmall"})]})]},w.uuid)}}),(u==null?void 0:u.spaceRole)===m.PermissionRole.EDITOR&&r.jsxs("button",{className:"flex flex-shrink-0 items-center pl-2 h-9 text-grey4 text-t3",onClick:h,children:[r.jsx(H,{size:"middle",name:"IcAddBoard",className:"mr-1 "}),r.jsx("span",{className:"text-t2",children:"添加成员"})]})]})]}):r.jsx(qs,{title:"FlowUs AI",description:"请先前往参加AI公测",rightPart:r.jsx(je,{onClick:()=>window.open(An.ai),children:"参加公测"})})},k_e=({type:e,uuid:t,closeSelf:n})=>{const s=[{type:$.TEXT_DESCRIPTION,data:{type:"allow",title:"允许",onClick:()=>n()}},{type:$.LINE},{type:$.TEXT_DESCRIPTION,data:{title:r.jsx("div",{className:"text-red",children:"移除"}),onClick:async()=>{n();const a=Ut();await Ce.infra.deleteSpaceAiMembers(a,{type:e,uuid:t}),Ye({$aiMembers:wt.$aiMembers.filter(o=>o.uuid!==t)})}}}];return r.jsx(ze,{className:"rounded-r next-modal py-1.5 w-[120px]",items:s})},C_e=({startDay:e,setStartDay:t})=>{const n=me(),s=a=>{n.dropdown({popcorn:a.currentTarget,placement:"bottom",content:()=>r.jsx(T_e,{startDay:e,setStartDay:t})})};return r.jsx(qs,{title:"日期设置",description:"设置每周起始日，仅影响日历显示方式",rightPart:r.jsxs("button",{className:"text-t2 text-black flex items-center",onClick:s,children:[e===m.DaySetting.MON?"周一":"周日",r.jsx(H,{name:"IcArrow",size:"xxxsmall",className:"ml-1"})]})})},T_e=({startDay:e,setStartDay:t})=>{const[n,s]=F.useState(e),a=[{type:m.DaySetting.MON,title:"周一"},{type:m.DaySetting.SUN,title:"周日"}].map(o=>({type:$.OPERABLE_BLOCK_TEXT,data:{...o,selected:o.type===n}}));return r.jsx(ze,{className:"rounded-r next-modal py-1.5 w-[120px]",items:a,onItemClick:o=>{s(o.data.type),t(o.data.type)}})};var ua=(e=>(e[e.INIT=1]="INIT",e[e.CAN_USE=2]="CAN_USE",e[e.CAN_NOT_USE=3]="CAN_NOT_USE",e[e.LEN_NOT_RIGHT=4]="LEN_NOT_RIGHT",e[e.CHECKING=5]="CHECKING",e))(ua||{});const jE={[1]:"",[2]:"",[3]:"域名不可用，请更换",[4]:"域名不能超过30字符，至少4个字符",[5]:""},v_e=({show:e,setShow:t})=>r.jsx(qs,{title:"引用记录显示设置",description:"当前页面被其他页面引用时，显示引用记录",rightPart:r.jsx(wn,{open:e,onSwitch:t})}),N_e=()=>{const e=Ft(),t=Hw(),n=di(),s=ak(),a=F.useCallback(i=>{ce.event("ad_switch_set",{is_open:i}),Di(()=>{t(e.uuid,{isShowAd:i})})},[e.uuid,t]),o=F.useMemo(()=>r.jsx(wn,{open:s,onSwitch:a,disabled:n}),[n,s,a]);return r.jsx(qs,{title:"分享页广告",showSpacePlan:!0,description:"关闭后，分享页面底部将不再显示广告",rightPart:o})},I_e=({icon:e,setIcon:t})=>{const n=Ft(),s=me(),a=Ma(),o=F.useCallback(i=>{i.preventDefault(),i.stopPropagation(),s.dropdown({popcorn:i.currentTarget,placement:"bottom",content:({onCloseModal:l})=>r.jsx(Fk,{showRecently:!1,onSelectCustomIcon:(c,u)=>{u||l(),t({type:"icon",value:c})},onSelectEmoji:(c,u)=>{u||l(),t({type:"emoji",value:c})},onUploadFile:c=>{l(),ye.loading({key:Fc.UPLOAD_ICON,content:"头像上传中..."}),a({file:c,type:"public",searchType:"spaceIcon",onComplete:u=>{ye.closeMessage(Fc.UPLOAD_ICON),u.success&&(ye.success("上传完成"),t({type:"upload",value:u.ossName}))}})},onRemoveBtnClick:()=>{t({}),l()}})})},[s,t,a]);return r.jsx(r.Fragment,{children:r.jsxs("div",{className:"mt-4 flex flex-row items-center justify-between",children:[r.jsx("div",{className:"mb-3.5 rounded-md border border-black_006 p-1",children:r.jsx(Ps,{name:n.title,color:n.backgroundColor,icon:e,iconSize:50,className:"!h-[50px] w-[50px]",style:{fontSize:"30px"}})}),r.jsxs("div",{className:"flex",children:[e&&r.jsx(je,{onClick:()=>{t({})},className:"text-t2 rounded border border-solid border-grey6 py-1.5 px-4 text-black",children:"移除空间头像"}),r.jsx(je,{onClick:o,className:"text-t2 ml-5 rounded border border-solid border-grey6 py-1.5 px-4 text-black",children:"上传空间头像"})]})]})})},j_e=({domain:e,setDomain:t,domainStatus:n})=>{const s=F.useMemo(()=>{switch(n){case ua.CHECKING:return r.jsxs("div",{className:"text-t4 flex items-center opacity-100 transition-all",children:[r.jsx(H,{className:"text-grey4 ml-2.5 mr-1 animate-spin align-middle text-xl leading-none",name:"IcNaviLoading",size:"middle"}),r.jsx("span",{className:"text-grey4 whitespace-nowrap",children:"检测中..."})]});case ua.CAN_USE:return r.jsxs("div",{className:"text-t4 text-active_color flex items-center opacity-100 transition-all",children:[r.jsx($s,{className:"ml-2.5 mr-1",iconSize:14,emojiStr:"👌",disableHover:!0}),r.jsx("span",{className:"whitespace-nowrap",children:"域名可用"})]});case ua.CAN_NOT_USE:return r.jsxs("div",{className:"text-t4 text-red flex items-center opacity-100 transition-all",children:[r.jsx($s,{className:"ml-2.5 mr-1",iconSize:14,emojiStr:"⚠️",disableHover:!0}),r.jsx("span",{className:"whitespace-nowrap",children:jE[ua.CAN_NOT_USE]})]});case ua.LEN_NOT_RIGHT:return r.jsxs("div",{className:"text-t4 text-red flex items-center opacity-100 transition-all",children:[r.jsx($s,{className:"ml-2.5 mr-1",iconSize:14,emojiStr:"⚠️",disableHover:!0}),r.jsx("span",{className:"whitespace-nowrap",children:jE[ua.LEN_NOT_RIGHT]})]});default:return null}},[n]);return r.jsxs(r.Fragment,{children:[r.jsx(qs,{title:"空间域名",description:`页面分享链接支持自定义域名，且旧链接仍然生效。链接将显示为：${Yj}/${e!=null?e:""}`}),r.jsxs("div",{className:"mt-2 flex items-center",children:[r.jsx("div",{className:"bg-grey8 text-t2 border-grey6 relative flex w-80 items-center rounded-sm border",children:r.jsx("input",{spellCheck:!1,placeholder:"请输入英文域名",className:"text-t2 h-7.5 placeholder-grey4 w-full flex-grow cursor-text bg-transparent px-2 align-middle text-black outline-none",value:e||"",maxLength:31,onChange:a=>{const o=a.target.value.trim();/^[a-z0-9_-]*$/.test(o)&&t(a.target.value.trim())}})}),s]})]})},D_e=({domain:e,publicHomePage:t="",setPublicHomePage:n})=>{const s=Ft(),[a,o]=F.useState(""),[i,l]=F.useState("设置任意公开分享中的页面为公开主页"),[c,u]=F.useState(!1),[d,f]=F.useState(!1),{setCurrentSettingMenu:h}=ws(la),[p,g]=F.useState([]),_=F.useRef([]),x=_e(t,["data"],["segments"]),[y,b]=F.useState(!1),E=di(),w=Md(x==null?void 0:x.spaceId),k=Mg(),C=(e!=null?e:"").trim(),T=c&&!C,v=`${C||"英文域名"}.flowus.cn`,I=()=>{on(v)},j=F.useMemo(()=>$n(async D=>{if(!D){g(_.current);return}b(!0);const{results:S,recordMap:R}=await Ce.infra.searchDocs(s.uuid,{query:D,filters:{isPublic:!0,isTitleOnly:!0},perPage:50,page:1});if(b(!1),S.length&&R){const A=R.blocks;A&&(ee(Gn.update({blocks:A})),g(S.map(({uuid:L})=>A[L])))}else g([])},200),[s.uuid]);return F.useEffect(()=>{j(a)},[j,a]),F.useEffect(()=>{if(c&&_.current.length===0){const S=Gx(K.blocks,s.uuid).filter(R=>{const A=K.blocks[R];return A?A.permissions.some(L=>L.type===m.PermissionType.PUBLIC):!1});_.current=S.map(R=>K.blocks[R]),g(_.current)}},[c,C,s.uuid,a]),F.useEffect(()=>{t&&!x&&Ce.editor.getBlock.raw(t).then(D=>{D.code===200&&ee(Gn.update({blocks:{[D.data.uuid]:D.data}}))})},[x,t]),r.jsxs(r.Fragment,{children:[r.jsx(qs,{title:"公开主页",showSpacePlan:!0,from:Vt.homepage,description:r.jsxs("div",{className:"flex items-center",children:["访问",C?r.jsx(Fe,{popup:"点击复制链接",className:"animate-hover mx-1 px-0.5 underline",onClick:I,children:v}):` ${v} `,"即可查看当前空间的公开主页"]})}),x?r.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(tn,{className:"mr-1",blockId:t,trigger:!1}),r.jsx(pc,{to:`${w}/${x.uuid}`,className:"text-t1 animate-hover px-2",children:de(x.data.segments)||Ot(x.type)})]}),r.jsx(je,{onClick:()=>n(""),children:"移除"})]}):r.jsx(og,{visible:d,onChange:f,placement:"bottom-start",content:C?r.jsx("div",{className:"next-modal mt-1 w-60 py-2",children:y?r.jsx("div",{className:"text-t3 text-grey3 flex items-center px-2",children:r.jsx(hs,{size:"middle"})}):p.length===0?r.jsx("div",{className:"text-t3 text-grey3 px-2",children:a?"无相关结果":"暂无公开分享中的页面"}):r.jsx(ze,{onItemClick:D=>{n(D.data.uuid),f(!1),o("")},items:p.map(D=>({type:$.SEARCH,data:{uuid:D.uuid,title:de(D.data.segments)||Ot(D.type),icon:D.data.icon,type:D.type,backgroundColor:D.backgroundColor,navs:k(D.uuid)}}))})}):r.jsx(r.Fragment,{}),children:r.jsxs("div",{className:"bg-grey8 text-t2 border-grey6 mt-4 flex w-full items-center rounded-sm border",children:[c&&C&&r.jsx(H,{name:"IcTitleSearch",className:"text-grey4 ml-3"}),r.jsx("input",{spellCheck:!1,onFocus:()=>{if(E){h(Jt.upgrade);return}l(C?"搜索公开分享中的页面":"请先设置空间域名👆"),u(!0),f(!0)},onBlur:()=>{l("设置任意公开分享中的页面为公开主页"),u(!1)},placeholder:i,className:B("text-t2 h-7.5 placeholder-grey4 w-full flex-grow cursor-text bg-transparent px-2 align-middle text-black outline-none",{"placeholder:text-red caret-transparent":T}),value:a,onChange:D=>{if(T)return;const S=D.target.value.trim();o(S)}})]})})]})},S_e=({spaceName:e,setSpaceName:t,saveSpaceName:n})=>r.jsxs(r.Fragment,{children:[r.jsx(kt.SettingDivider,{className:"mb-2.5"}),r.jsx("div",{className:kt.commonStyles.name,children:"空间名"}),r.jsx(xt,{...bn(Bn.settingSpaceInput),maxLength:20,placeholder:"请输入空间名，长度需在2-20个字符之间",className:kt.commonStyles.input,value:e||"",onChange:s=>t(s||""),onEnter:n})]}),R_e=({enable:e,setRecommend:t})=>{const n=Ft();return n.planType!=="freePersonal"&&n.planType!=="personal"?null:r.jsx(qs,{title:"智能推荐模版",description:"关闭后，新建空白页面将不进行相关模板推荐",rightPart:r.jsx(wn,{open:e,onSwitch:t})})},A_e=()=>{var X,oe,ie,ue;const e=Oa(),{setClickMaskClose:t}=ws(la),n=ui(),s=Va(),a=Object.values(s),o=Ft(),i=qw(),l=Qt(),c=vS(),u=Hw(),d=me(),f=Un(),h=ke(),[p,g]=F.useState(o.icon),[_,x]=F.useState(o.title),y=qd(),{editor:b}=y(l.uuid),E=o.planType===Et.freeTeam,w=Ui(),[k,C]=F.useState(o.domain),[T,v]=F.useState(o.domain),[I,j]=F.useState(o.publicHomePage),[D,S]=F.useState(ua.INIT),R=F.useRef(),[A,L]=F.useState(o.setting===null||typeof o.setting>"u"||!!o.setting.isShowBacklink),[P,M]=F.useState(!((X=i==null?void 0:i.setting)!=null&&X.closeTemplateRecommend));dw();const[U,V]=F.useState(((oe=o==null?void 0:o.setting)==null?void 0:oe.enableAI)===!0),[W,z]=F.useState((ue=(ie=o==null?void 0:o.setting)==null?void 0:ie.daySetting)!=null?ue:m.DaySetting.MON),Q=sy(),Z=ge=>{C(ge),ge||v(ge),R.current&&(clearTimeout(R.current),R.current=void 0),R.current=setTimeout(()=>{if(!ge){S(ua.INIT);return}if(ge===o.domain&&D===ua.INIT)return;if(ge.length<4||ge.length>30){S(ua.LEN_NOT_RIGHT);return}if(ge===o.domain){S(ua.CAN_USE);return}const Ne=ge;S(ua.CHECKING),Ce.infra.postSpaceDomainCheck.raw(Ut(),{domain:ge}).then(De=>{setTimeout(()=>{Ne===ge&&(De.code===200&&De.data?(S(ua.CAN_USE),v(ge)):S(ua.CAN_NOT_USE))},500)})},800)};F.useEffect(()=>{t(_===o.title&&kn(p,o.icon))},[o.icon,o.title,p,t,_]);const te=b&&!a.some(ge=>ge.spaceRole===m.PermissionRole.EDITOR&&ge.uuid!==l.uuid),re=async()=>{const ge=_.trim(),Ne=jE[D];if(Ne){ye.error(Ne);return}Zf(ge,"").length>=2&&Zf(ge,"").length<=20?(h(()=>{u(o.uuid,{title:ge,icon:p,domain:T,publicHomePage:I,setting:{isShowBacklink:A,daySetting:W,enableAI:U}}),i&&Q(i.uuid,{setting:{closeTemplateRecommend:!P}})}),e(),ye.success("保存成功")):ye.error("名称长度应为2-20个字符")},ne=()=>{if(n){d.warning({title:"当前空间还未到期，无法删除",confirmText:"知道了"});return}d.warning({title:"此操作无法撤销。",content:"删除工作空间，将永久删除其中所包含的所有页面和文件",countTime:10,confirmText:"确认删除",confirm:async()=>{await c(o.uuid),G1()||f.push(Rt.main),e()}})},Y=async()=>{d.warning({title:"确定离开吗？",content:"离开后将不能再访问当前空间",confirmText:"确定离开",confirm:async()=>{await Ce.infra.removeSpaceMembers(o.uuid,{userId:l.uuid}),ye.success("你已离开该空间"),await Pm(!0),G1()||f.push(Rt.main)}})};return b?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:kt.commonStyles.container,children:[r.jsx(kt.Header,{title:"空间设置",name:"空间头像"}),r.jsx(I_e,{icon:p,setIcon:g}),r.jsx(S_e,{spaceName:_,setSpaceName:x,saveSpaceName:re}),r.jsx(j_e,{domain:k,setDomain:Z,domainStatus:D}),r.jsx(D_e,{domain:k,publicHomePage:I,setPublicHomePage:j}),r.jsx(C_e,{startDay:W,setStartDay:z}),r.jsx(N_e,{}),r.jsx(v_e,{show:A,setShow:L}),r.jsx(R_e,{enable:P,setRecommend:M}),r.jsx(w_e,{enable:U,setAI:V}),r.jsxs("div",{className:"mt-4 flex justify-end",children:[E&&!te&&r.jsx(je,{className:"mr-5",...bn(Bn.settingSpaceDelete),onClick:Y,children:"离开空间"}),r.jsx(je,{...bn(Bn.settingSpaceDelete),colorType:"red",className:"mb-10",onClick:ne,children:"删除空间"})]})]}),r.jsx(kt.FooterBar,{cancel:()=>e(),confirm:re})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:kt.commonStyles.container,children:[r.jsx(kt.Header,{title:"空间设置"}),w&&r.jsx("div",{className:"text-t3 text-grey3 mt-2",children:"当前为「外部协作者」身份，如需查看更多空间设置，可联系空间管理员将你升级为「空间成员」"}),r.jsx(je,{onClick:Y,className:"text-t2-medium mt-5 ml-auto",children:"离开空间"})]}),r.jsx(kt.FooterBar,{cancel:()=>e(),cancelText:"关闭"})]})},rt=r.jsx(H,{name:"IcSelectedSpace",size:"middle"}),is=(e,t,n)=>r.jsx(Fe,{popup:n,className:B(t&&"cursor-pointer border-b border-grey6"),children:r.jsx("a",{href:t||void 0,target:"_blank",rel:"noreferrer",children:e})}),B_e=()=>{const{isNovice:e}=yd(),t=[{title:"用量",data:[["用量","","","",""],[is("页面/块数量",""),"无限","无限","无限","无限"],[is("空间成员人数",`${Mt}/share/12a522e8-cf0d-4959-af83-28276ead05e6`,"可邀请团队伙伴加入空间实现团队内部的高效协作"),"1","1","上限5人","无限"],[is("外部协作人数",`${Mt}/share/b987ee4d-ee13-44d2-96a9-07161675ae13`,"可邀请外部临时人员加入空间的指定页面协作，适用于跨团队协作、客户沟通等场景"),"上限5人","无限","无限","无限"],[is("文件上传","","上传单个图片或文件附件的大小限制"),"2GB","5GB","5GB","5GB"],[is("存储容量","","团队版的计算方式，假设10人团队空间，存储容量为：300GB+150GB*10=1800GB"),r.jsx("div",{className:"py-1.5",children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("div",{children:"2GB"}),e&&r.jsx("span",{className:"text-grey3",children:"解锁前200MB"})]})}),"200GB","300GB","300GB+150GB/人"],["思维导图节点数","300","无限","无限","无限"],["单个块字数限制","100000","100000","100000","100000"]]},{title:"基础",data:[["基础","","","",""],[is("多端同步（Web+APP）","","支持全平台客户端使用，Windows / Mac / iOS / Android"),rt,rt,rt,rt],[is("全文搜索","","页面内容层面的搜索"),rt,rt,rt,rt],[is("页面动态","","支持查看页面所有具体编辑记录，便于协作时追溯"),rt,rt,rt,rt],[is("页面历史","","页面每隔一段时间会保存页面版本，可查看或返回到过去任意一个版本"),"","30天","60天","180天"],[is("引用建议","","当页面内容与其它页面标题存在隐含关联时进行的自动推荐，辅助知识点串联"),"",rt,rt,rt],[is("文件批量下载","",""),"",rt,rt,rt]]},{title:"分享与协作",data:[["分享与协作","","","",""],[is("分享链接","","支持公开分享页面 / 文件夹 / 单文件"),rt,rt,rt,rt],[is("分享链接密码访问","","支持为公开分享的页面设置访问密码，就像网盘分享一样"),rt,rt,rt,rt],[is("自定义空间域名","","如，英文域名.flowus.cn 的自定义空间域名"),rt,rt,rt,rt],[is("分享页关闭广告","","如，英文域名.flowus.cn 的自定义空间域名"),"",rt,rt,rt],[is("单页面外部协作","","单个页面可加入的外部协作者人数上限"),"5","1000","1000","1000"],[is("公共模板","将页面设置为可快速创建的公共模板","单个页面可加入的外部协作者人数上限"),"5","无限","无限","无限"],[is("公开主页","如，英文域名.flowus.cn 的自定义空间域名"),"",rt,rt,rt],["团队协作","","",rt,rt],["团队空间","","",rt,rt]]},{title:"安全与权限管理",data:[["安全与权限管理","","","",""],["页面权限管理","","",rt,rt],["空间成员管理","","",rt,rt],["空间成员分组","","","",rt],[r.jsxs("div",{children:[r.jsx("div",{children:"空间安全设置"}),r.jsx("div",{children:"（即将上线）"})]}),"","","",rt]]},{title:"更多功能",data:[["更多功能","","","",""],[is("多维表全部属性",`${Mt}/share/6a17bdee-5155-4569-9715-5ad894b0f4dd`,"支持18种属性类型，广泛适用于各类场景"),rt,rt,rt,rt],[is("多维表全部视图",`${Mt}/share/6a17bdee-5155-4569-9715-5ad894b0f4dd`,"支持7种视图，同组数据多种展现形式"),rt,rt,rt,rt],[is("多维表单附件","","多维表媒体属性上传单个文件附件的大小限制"),"2GB","5GB","5GB","5GB"],[is("文件/文件夹管理",`${Mt}/share/fa4ab5ea-075f-4ccc-8e70-a112186310f3`,"支持在页面中插入文件，或通过文件夹形式管理文件"),rt,rt,rt,rt],[is("引用页面和双向链接",`${Mt}/share/ef1a1829-baf5-4d92-bb9f-55a16e07219f`,"支持引用已有页面以及查看被引用情况，便于网状式管理内容"),rt,rt,rt,rt],[is("文件预览（Office、PDF等）",`${Mt}/share/771003b8-40d9-4f59-8d3a-99a690338fbe`,"支持PDF/Office/图片/视频等类型在线预览"),rt,rt,rt,rt],[is("微信剪藏","",""),rt,rt,rt,rt],[is("全部模板",`${Mt}/template`,"通过借鉴优质模板，更好更快上手使用"),rt,rt,rt,rt],["夜间模式",rt,rt,rt,rt],[is("字体/页面排版","",""),"",rt,rt,rt]]}];return r.jsx(r.Fragment,{children:t.map((n,s)=>r.jsx(F.Fragment,{children:n.data.map((a,o)=>r.jsx("div",{className:B("text-t2 flex border-grey5 border-b",s===t.length-1&&o===n.data.length-1&&"border-none"),children:a.map((i,l)=>r.jsx("span",{className:B("flex items-center px-2 flex-shrink-0 w-1/5 min-h-[36px] border-grey5 border-l",l===0&&"text-grey3 border-l-0",l%2!==0&&"bg-black_003",o===0&&"border-none bg-transparent text-t2-medium"),children:i},l))},`${n.title}-${o}`))},`${n.title}`))})},L_e=()=>{var y,b,E;const e=me(),t=Ft(),n=Ao(),s=Qt(),a=KW(),o=_g(),i=qd(),{editor:l}=i(s.uuid),[c,u]=F.useState([]),[d,f]=F.useState(),h=oO(),[p,g]=F.useState();F.useEffect(()=>{Ce.infra.getNewPlanList(t.uuid,"all").then(w=>{var k;return((k=w.list)==null?void 0:k.length)&&u(w.list)})},[t.uuid]);const _=F.useMemo(()=>{var L,P,M,U,V,W,z;const w=Q=>c.find(Z=>Z.spaceType===Q),k=w(Et.personal),C=w(Et.team),T=w(Et.smallTeam),v=(L=T==null?void 0:T.currentPrice)!=null?L:T==null?void 0:T.originalPrice,I=(P=T==null?void 0:T.currentPriceUnit)!=null?P:T==null?void 0:T.originalPriceUnit,j=(M=C==null?void 0:C.currentPrice)!=null?M:C==null?void 0:C.originalPrice,D=(U=C==null?void 0:C.currentPriceUnit)!=null?U:C==null?void 0:C.originalPriceUnit,S=n?(V=k==null?void 0:k.currentPrice)!=null?V:k==null?void 0:k.originalPrice:p==null?void 0:p.amount,R=n?(W=k==null?void 0:k.currentPrice)!=null?W:k==null?void 0:k.originalPriceUnit:p==null?void 0:p.amountUnit,A=t.planType&&[Et.smallTeam,Et.personal,Et.freePersonal,Et.freeTeam].includes(t.planType);return[[{type:Et.freePersonal,originalPrice:0,currentPrice:0,description:cr(Et.freePersonal)},{type:Et.personal,currentPrice:S,currentPriceUnit:xr(R),originalPrice:k==null?void 0:k.originalPrice,originalPriceUnit:xr(n?k==null?void 0:k.originalPriceUnit:p==null?void 0:p.amountUnit),description:cr(Et.personal),updatePlan:!n,label:n?"":d==null?void 0:d.personal.label,id:k==null?void 0:k.id}],[{type:Et.smallTeam,currentPrice:v,currentPriceUnit:xr(I),originalPrice:T==null?void 0:T.originalPrice,originalPriceUnit:xr(T==null?void 0:T.originalPriceUnit),description:cr(Et.smallTeam),updatePlan:A},{type:Et.team,currentPrice:j,currentPriceUnit:xr(D),originalPrice:C==null?void 0:C.originalPrice,originalPriceUnit:xr(C==null?void 0:C.originalPriceUnit),description:cr(Et.team),updatePlan:n,label:n?(z=d==null?void 0:d.team)==null?void 0:z.label:"",id:C==null?void 0:C.id}]]},[p==null?void 0:p.amount,p==null?void 0:p.amountUnit,d==null?void 0:d.personal.label,(y=d==null?void 0:d.team)==null?void 0:y.label,t.planType,n,c]),x=w=>{if(w===Et.smallTeam&&a>o.membersMaxLimit){e.warning({title:`小组版空间成员人数上限${o.membersMaxLimit}人，请移出超出成员后重试升级。`,confirmText:"知道了",noCancel:!0});return}h(w)};return F.useEffect(()=>{var k,C;const w=n?(k=_[1])==null?void 0:k[1]:(C=_[0])==null?void 0:C[1];w!=null&&w.id&&Ce.infra.getCouponList(w.id,void 0,t.uuid).then(async T=>{var D;const v=(D=T.list)==null?void 0:D[0],I=v==null?void 0:v.label;if(f(n?{team:{label:I},personal:{}}:{personal:{label:I},team:{}}),!w.id||n)return;const j=await Ce.infra.getQuote({spaceId:t.uuid,planId:w.id,couponId:v==null?void 0:v.id,date:1,people:1});g(j)})},[t.uuid,n,(E=(b=_[0])==null?void 0:b[1])==null?void 0:E.id]),r.jsx(r.Fragment,{children:r.jsxs("div",{className:B("shrink-0 pb-2 transition-opacity min-w-[720px]",c.length===0&&"opacity-0"),children:[r.jsx("div",{className:"flex border-b border-grey5 before:w-1/5",children:_.map(w=>w.map((k,C)=>{const T=t.planType===k.type,v=k.currentPrice!==0&&!k.currentPrice,I=k.type===Et.team,j=t.planType===Et.freeTeam&&k.type===Et.smallTeam;let D=r.jsx(r.Fragment,{});k.updatePlan?v||(D=r.jsx(Fe,{className:"flex-1 flex text-t2-medium",popup:l?"":"仅管理员可操作",children:r.jsxs(r.Fragment,{children:[j&&r.jsx(je,{colorType:"secondary",className:"pointer-events-none w-14 mr-2.5",children:"试用中"}),r.jsx(je,{disable:!l,colorType:"active",className:"flex-1",onClick:()=>x(k.type),children:T?"续费":"升级"})]})})):D=r.jsx(Fe,{className:"cursor-not-allowed flex-1",popup:T?void 0:"当前空间暂不支持升级到该空间计划",children:r.jsx(je,{className:"text-t2-medium pointer-events-none w-full bg-white text-grey3",children:T?"当前版本":"升级"})});let S=r.jsx(r.Fragment,{});return k.label&&(S=r.jsx("div",{className:"mb-5 w-full bg-red text-white rounded-sm py-px px-1.5 text-t3 flex justify-center",children:k.label})),r.jsxs("div",{className:B("flex flex-col justify-between border-l border-grey5 p-2.5 flex-grow-0 w-1/5 flex-shrink-0",C%2===0&&"bg-black_003"),children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-h4 mb-5",children:k.description}),r.jsxs("div",{className:"mb-5",children:[r.jsx("span",{className:B("text-h2",k.currentPrice!==0&&!k.currentPrice&&"text-grey4"),children:v?"暂未公布":k.currentPrice===0?"免费":`${k.currentPriceUnit}${k.currentPrice}`}),r.jsxs("span",{className:"text-t1 text-grey4",hidden:!k.currentPrice,children:["/",I?"人/年":"年"]}),r.jsxs("div",{className:"text-t1 text-grey4",hidden:!k.currentPrice||!k.originalPrice||k.currentPrice>=k.originalPrice,children:[r.jsxs("span",{className:"line-through",children:[k.originalPriceUnit,k.originalPrice]}),"/",I?"人/年":"年"]})]}),r.jsx(r.Fragment,{children:S})]}),r.jsx("div",{className:"mb-2.5 flex h-8",children:D})]},`${k}-${C}`)}))}),r.jsx(B_e,{})]})})},P_e=()=>{var l,c,u;const e=Tn(),{spacePlan:t,currentSpacePlanConfig:n}=Qc(),{blocksMaxLimit:s}=_g(),a=(c=(l=t==null?void 0:t.spacePlanType)==null?void 0:l.toLocaleLowerCase())==null?void 0:c.includes("cycle"),o=(u=t==null?void 0:t.month)!=null?u:0,i=F.useMemo(()=>{var g;const d={1:"月",3:"季",12:"年"},f=`有效期至${he(t==null?void 0:t.endAt).format("YYYY.MM.DD HH:mm")}`,h=a&&d[o]&&r.jsxs(r.Fragment,{children:["，连续包",d[o]]});let p=r.jsxs(r.Fragment,{children:[f,h]});return e.planType===Et.smallTeam&&(p=r.jsxs(r.Fragment,{children:[f,h,"，升级到团队版每增加1席位空间存储容量可扩容150GB"]})),e.planType===Et.freeTeam&&(p=r.jsxs(r.Fragment,{children:["，免费块数",s,"，升级获得无限块和300GB空间存储容量"]})),e.planType===Et.freePersonal&&(p=r.jsxs(r.Fragment,{children:[f,"，升级到个人专业版，支持超大文件上传"]})),(g=n==null?void 0:n.description)!=null&&g.guide&&(p=r.jsx(r.Fragment,{children:n.description.guide})),p},[s,e.planType,n==null?void 0:n.description,a,o,t==null?void 0:t.endAt]);return r.jsx(r.Fragment,{children:e&&r.jsxs("div",{className:"text-t2 h-10 flex items-center text-grey3 flex-shrink-0",children:[r.jsx("span",{className:"whitespace-nowrap",children:"当前版本："}),r.jsxs("span",{className:"text-t2-bold mr-2 text-black whitespace-nowrap",children:[cr(e.planType),"空间"]}),i]})})},O_e=()=>{const e=Oa(),t=F.useRef(null),n=Ft(),{isFrom:s}=ws(la);return F.useEffect(()=>{ce.event("package_show",{is_from:s===Vt.package?"set":s})},[n.uuid]),r.jsxs(r.Fragment,{children:[r.jsxs("div",{ref:t,className:B(kt.commonStyles.container,"pb-0 px-[30px]"),children:[r.jsx(kt.Header,{title:"空间升级",addonAfter:r.jsx(eu,{link:Ta.upgradeSpace,linkContainer:!0,beforeIcon:!0,className:"text-active_color underline underline-offset-4",children:"如何获得空间升级优惠"})}),r.jsx(P_e,{}),r.jsx(kt.SettingDivider,{className:"mb-5"}),r.jsx("div",{className:"overflow-x-auto border border-grey5",children:r.jsx(L_e,{})})]}),r.jsx(kt.FooterBar,{confirmText:"关闭",confirm:()=>e()})]})},M_e=e=>{const t=pu(),n=Oa(),{from:s=""}=e,{clickMaskClose:a,setIsFrom:o,currentSettingMenu:i,setCurrentSettingMenu:l}=ws(la),c=Ft(),u=Um(),[d,f]=F.useState(!1),h=F.useCallback(()=>{a&&n()},[a,n]);return F.useEffect(()=>{const p=g=>{be("esc")(g)&&(g.stopPropagation(),g.preventDefault(),h())};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[h]),F.useEffect(()=>{o(s),u(c.uuid),c.permissions&&Jx(c.uuid),l(e.defaultMenuType),f(!0)},[]),F.useEffect(()=>{t()},[t]),F.useEffect(()=>n,[n]),d?r.jsx("div",{className:"flex justify-center items-center w-screen h-screen",onClick:h,onMouseDown:p=>p.stopPropagation(),children:r.jsxs("div",{className:"flex overflow-y-auto w-[80vw] max-w-[960px] h-[75vh] min-h-[300px] max-h-[700px] next-modal",onClick:p=>p.stopPropagation(),children:[r.jsx(mge,{}),r.jsxs("div",{className:"flex relative flex-col pt-2.5 w-full h-full text-t2 overflow-x-hidden min-w-[550px]",children:[i===Jt.account&&r.jsx(fge,{}),i===Jt.general&&r.jsx(Tge,{}),i===Jt.integral&&r.jsx(Lge,{}),i===Jt.spaceInfo&&r.jsx(E_e,{}),i===Jt.space&&r.jsx(A_e,{}),i===Jt.members&&r.jsx(qge,{}),i===Jt.upgrade&&r.jsx(O_e,{}),i===Jt.order&&r.jsx(zge,{})]})]})}):null},U_e=e=>{const t=me(),n=oz(),s=F.useCallback(a=>{t.modal({modalId:Xe.SETTING,autoClose:!1,forceUpdate:!0,className:"!bg-transparent border-none shadow-none",closeAfterCallBack:()=>{dk("$settingState",{open:!1})},content:()=>r.jsx(la,{children:r.jsx(M_e,{...a})})})},[t]);return F.useEffect(()=>{var a;n.open?s({from:n.from||Vt.package,defaultMenuType:(a=n.defaultMenuType)!=null?a:Jt.account}):t.closeModal(Xe.SETTING)},[n]),r.jsx(r.Fragment,{children:e.children})},V_e=()=>{var c,u;const e=Ft(),t=Qt(),n=Ui(),s=S9(e.uuid,t.uuid,n),a=localStorage.getItem("tryPageId"),o=s.team.concat(s.person),i=o.findIndex(d=>d===a);return(u=(c=o[i+1])!=null?c:o[0])!=null?u:""},q_e=({errorMessage:e})=>{const t=V_e(),n=()=>{Nn("tryPageId",t),un?ri(Ss.Reload):Bs(`/${t}`)};return r.jsxs("div",{className:"fixed flex-col left-0 top-0 w-full h-full flex items-center justify-center z-50 bg-white1",children:[e&&r.jsx("p",{className:"px-20 mb-4 select-text",children:e}),r.jsx(je,{colorType:"primary",onClick:n,children:"重新加载"})]})},H_e=()=>{F.useEffect(()=>{if(!un)return;const e=t=>{var s;const{className:n}=t.target;(s=n==null?void 0:n.includes)!=null&&s.call(n,"drag-container")&&ri(Ss.Zoom)};return document.addEventListener("dblclick",e,!0),()=>{document.removeEventListener("dblclick",e,!0)}},[])},$_e=()=>{H_e();const e=LC(),{pathname:t}=Vc();F.useEffect(()=>{yu(Ss.HotUpdateComplete,()=>{Ye({$readyUpdate:!0}),Ute()})},[]),F.useEffect(()=>{const n=async()=>{const s=await n0(Ss.IsFullScreen);v_({isFullscreen:s})};yu(Ss.OnFullScreenToggle,n),yu(Ss.UpdateDownloadComplete,()=>{v_({isUpdateReload:!0})}),yu(Ss.UpdateAvailable,()=>{v_({isUpdateAvailable:!0})}),yu(Ss.UpdateNotAvailable,()=>{v_({isUpdateAvailable:!1})}),n()},[]),F.useEffect(()=>{ri(Ss.CheckForUpdates),yu(Ss.Log,(n,...s)=>{console.log(s)}),yu(Ss.Message,(n,...s)=>{console.log(s)})},[]),F.useEffect(()=>{un&&(console.log("当前版本号",e),console.log("当前页面路径",t))},[e,t])},G_e=()=>{F.useEffect(()=>{let e=setTimeout(()=>{},0);const t=()=>{Ye({$isCtrlKeyDown:!1}),clearTimeout(e)},n=a=>{a==null||a.preventDefault(),t(),qt.removeEventListener("keyup",n)},s=a=>{if(be(["mod","ctrl"],{byKey:!0})(a)){if(wt.$isCtrlKeyDown)return;t(),e=setTimeout(()=>{a.preventDefault(),Ye({$isCtrlKeyDown:!0})},300),qt.addEventListener("keyup",n)}else t(),n()};return qt.addEventListener("keydown",s),qt.addEventListener("blur",n),()=>{clearTimeout(e),Ye({$isCtrlKeyDown:!1}),qt.removeEventListener("keydown",s),qt.removeEventListener("keyup",n),qt.removeEventListener("blur",n)}},[])},z_e=()=>{const e=me(),t=Pa(),n=()=>{e.warning({modalId:Xe.MAXIMUM_CAPACITY_DIALOG,title:"小组版试用块数已达上限",confirmText:"升级获得无限块",forceUpdate:!0,maxWidth:350,colorType:"active",footer:r.jsxs("div",{className:"text-t3 text-grey3 mt-2.5",children:["块数量每15分钟自动更新，你可以",r.jsx("span",{className:"mx-0.5 animate-click underline underline-offset-2",onClick:async()=>{ye.loading({key:"refreshCount",content:"正在刷新计数"}),await sk(),ye.closeMessage("refreshCount"),ye.success("刷新计数成功"),e.closeModal(Xe.MAXIMUM_CAPACITY_DIALOG)},children:"刷新计数"}),"后重试"]}),confirm:()=>{t({from:Vt.spaceSetBlock,defaultMenuType:Jt.upgrade})}})};F.useEffect(()=>{In.on("modalId",s=>{xs(100).then(()=>{switch(s){case Xe.MAXIMUM_CAPACITY_DIALOG:n();break}})})},[])},W_e=()=>{F.useEffect(()=>{const e=$n(n=>{const{offsetWidth:s,offsetHeight:a}=n.target;Ye({$isMobileSize:s<=640,$bodyHeight:a,$bodyWidth:s})},500,{leading:!0,trailing:!0});return Pd.observe(document.body,e)},[])},K_e=()=>{const e=EG(),t=pu();return F.useCallback(async(n=!1)=>{const s=await t();if(s.code===200){s.data.uuid&&(Nn(iW,s.data.uuid),ce.login(s.data.uuid));const a=await NS(q1|H1|$1,!1,n);return n||e(),a}n||e()},[t,e])},Y_e=()=>{F.useEffect(()=>{const e=document.querySelector("#splash");e&&setTimeout(()=>{e.remove()},300)},[])},X_e=()=>{const{pathname:e}=Vc(),t=g6();F.useEffect(()=>{wt.$readyUpdate&&(un?ri(Ss.Reload):location.reload())},[e]);const n=async()=>{var i;if(wt.$readyUpdate)return;const s=await GF(),a=(i=s==null?void 0:s.version)!=null?i:"",o=$F();if(a){if(!o.version){Np(a,{open:!1});return}if(o.version!==a){const l=Qa(o.version),c=Qa(a);Np(a,{open:l<c}),Ye({$readyUpdate:!0})}}};F.useEffect(()=>{if(un||!t)return;const s=setInterval(n,5*60*1e3);return()=>{clearInterval(s)}},[t])},Q_e=()=>r.jsx("div",{className:"cursor-default login-wrapper",children:r.jsx(J_e,{})}),J_e=()=>{const e=()=>{un?ri(Ss.Reload):window.location.reload()};return r.jsxs("div",{className:"flex flex-col items-center w-full",children:[r.jsx("div",{className:"leading-[80px]",children:r.jsx(H,{className:"text-grey4 text-[70px]",name:"IcNetworkOutage",size:"auto"})}),r.jsx("div",{className:"text-grey4 text-t1",children:"您已离线"}),r.jsx("div",{className:"text-grey4 text-t2 mt-1",children:"如果网络正常，可尝试开关Wi-Fi来恢复正常"}),r.jsx(je,{className:"mt-4",onClick:e,children:r.jsx("span",{className:"text-grey3 text-t2",children:"刷新页面"})})]})},Z_e=()=>{const e=zx(),t=gt(),n=Un(),s=Um(),[a,o]=F.useState(null),[i,l]=F.useState(null),u=oy()(ms.inviteCode);return F.useEffect(()=>{t?(async()=>{var f;const d=await Ce.editor.formViewGetBlock.raw(t);if(d.code===200)if(d.data.view&&d.data.view.type===m.CollectionViewType.FORM){K.user.uuid&&s(d.data.view.spaceId,{notJumpLocation:!0}),ee(Gn.update({blocks:d.data.blocks}));const h=await Ce.infra.getSpacesPublicData({spaceIds:[d.data.view.spaceId]});ee(gS.update(h.spaces)),ee(Am.update({[d.data.view.uuid]:d.data.view}));const p=K.blocks[d.data.view.parentId];if((p==null?void 0:p.type)===m.BlockType.REFERENCE_COLLECTION){if(!((f=p.data.ref)!=null&&f.uuid)){o(r.jsx(nl,{icon:"😑",description:"链接失效"}));return}const g=K.blocks[p.data.ref.uuid];if(!g){o(r.jsx(nl,{icon:"😑",description:"链接失效"}));return}l({viewId:d.data.view.uuid,collectionId:g.uuid,viewParentId:d.data.view.parentId}),ce.event("page_enter",{is_success:!0,page_type:g.type,page_id:g.uuid,is_shared:!0})}else K.user.uuid&&e(),l({viewId:d.data.view.uuid,collectionId:d.data.view.parentId,viewParentId:d.data.view.parentId}),ce.event("page_enter",{is_success:!0,page_type:p==null?void 0:p.type,page_id:d.data.view.parentId,is_shared:!0});Z1({title:d.data.view.title||zj,icon:p==null?void 0:p.data.icon})}else o(r.jsx(nl,{icon:"😑",description:"链接失效"}));else switch(d.code){case 1102:ye.error("请先登录"),n.push(nh(Rt.login,[{key:ms.callbackPath,value:location.pathname},{key:ms.inviteCode,value:u}]));return;case 1403:o(r.jsx(nl,{icon:"✋",description:"无权限访问"}));break;case 1600:o(r.jsx(nl,{icon:"🚫",description:r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-center mb-1",children:"无法访问该页面"}),r.jsx("div",{className:"text-grey3 text-t2",children:"当前页面违反平台分享协作条例，已禁止访问"})]})}));break;case 5003:o(r.jsx(nl,{icon:"😊",description:"您已提交收集表"}));break;default:o(r.jsx(nl,{icon:"😑",description:d.msg}))}})():ye.error("链接有误")},[t]),a?r.jsx(YC,{className:"max-h-[500px]",header:r.jsx(nf,{uuid:"uuid",ossName:"cover/flowus2",hiddenEditorButton:!0,height:320}),children:a}):i?r.jsx(_l.Provider,{value:{...i,readonly:!0,managerReadonly:!0,changeView:()=>{},isColumnListChildren:!1,isFoldListChildren:!1,viewType:m.CollectionViewType.FORM},children:r.jsx(jl,{children:r.jsx("div",{className:"form-scroll-container overflow-y-auto h-full min-h-screen",children:r.jsx(JL,{shareId:t})})})}):r.jsx(os,{})},iO=e=>{const t=K.blocks[e];return ud()&&(t==null?void 0:t.status)!==m.BlockStatus.NORMAL},lO=5,e1e=()=>{const e=gt(),[t,n]=F.useState({}),[s,a]=F.useState(0),o=pw(),i=ae(f=>Object.entries(o).filter(([h,p])=>p.pageId===e&&p.userId!==f.user.uuid).reduce((h,[p,g])=>(h[p]={...Jn(g,"activityTime","blockId"),lastVisitTime:g.activityTime},h),{}),{equalityFn:kn});F.useEffect(()=>{var f;(f=K.blocks[e])!=null&&f.local||!e||(Ye({$membersStates:{}}),Ce.editor.getDocVisits.raw(e).then(h=>{if(h.code===200){const p=Date.now(),g=h.data.visits.filter(_=>_.userId!==K.user.uuid).reduce((_,x)=>(_[x.userId]={userId:x.userId,pageId:e,present:x.present&&p-x.visitedAt<Wh,lastVisitTime:x.visitedAt},_),{});n(g)}}))},[e]),F.useEffect(()=>{const f={};for(const[h,p]of Object.entries(t)){const g=i[h];g&&g.userId===h&&g.pageId===p.pageId&&g.lastVisitTime>p.lastVisitTime&&(f[h]=g)}Object.entries(f).length>0&&n({...t,...f})},[i,t]),F.useEffect(()=>{const f=setInterval(()=>{a(Date.now())},Wh);return()=>{clearInterval(f)}},[a]);const l=F.useMemo(()=>{const f={},h=Date.now(),p=_=>{_&&_.present&&_.lastVisitTime+Wh<h&&(_.present=!1)};for(const[_,x]of Object.entries(t))f[x.userId]={...x},p(f[x.userId]);for(const[_,x]of Object.entries(i))f[x.userId]={...x},p(f[x.userId]);const g=Object.entries(f).map(([_,x])=>x).sort((_,x)=>_.present&&x.present?x.lastVisitTime-_.lastVisitTime:_.present?-1:x.present?1:x.lastVisitTime-_.lastVisitTime);return g.unshift({userId:K.user.uuid,pageId:e,present:!0,lastVisitTime:Date.now()}),g},[i,e,t,s]);if(l.length<=1)return null;const c=sj(l,lO),u=l.length-c.length,d=rj(l,u);return r.jsxs("div",{className:"flex items-center relative transition-all h-9",children:[r.jsx(r.Fragment,{children:c.map((f,h)=>r.jsx(n1e,{memberInfo:f,index:h},h))}),u>0&&r.jsx(Fe,{hideOnClick:!1,theme:"members-tooltip",maxWidth:260,interactive:!0,className:"ml-1",placement:"bottom",popup:r.jsx(r1e,{memberInfos:d}),children:r.jsx("div",{className:"cursor-pointer text-t2 text-grey4",children:`+${u}`})})]})},t1e=F.memo(e1e),n1e=e=>{var o,i;const t=$i(e.memberInfo.userId),n=(o=pw()[e.memberInfo.userId])==null?void 0:o.blockId,s=Yr(e.memberInfo.userId);if(!t)return r.jsx("div",{className:"w-6 h-6 -ml-2 rounded-full text-white shadow-sm"});const a=e.index>0&&e.memberInfo.present&&n;return r.jsx(Fe,{style:{zIndex:lO-e.index},className:"-ml-1.5",placement:"bottom",onClick:()=>{const l=wt.$membersStates[t.uuid];l&&cO(l.blockId)},popup:r.jsx(s1e,{userId:e.memberInfo.userId,lastVisitTime:e.memberInfo.lastVisitTime,username:s,type:e.index===0?"self":e.memberInfo.present?"present":"absent"}),children:r.jsx("div",{className:"bg-white1 rounded-full inline-block",children:r.jsx(Ps,{className:B("rounded-full text-white shadow-sm transition",{"hover:scale-[1.3]":a,"opacity-30":!e.memberInfo.present,"cursor-pointer":e.index!==0&&e.memberInfo.present&&((i=wt.$membersStates[t.uuid])==null?void 0:i.blockId),"w-[26px] h-[26px]":t.avatar}),name:s,color:t.backgroundColor,icon:{type:"upload",value:t.avatar},imgClassName:"rounded-full",iconSize:18})})})},s1e=e=>{var n;const t=!!((n=wt.$membersStates[e.userId])!=null&&n.blockId);return r.jsxs("div",{className:"px-2 py-1",children:[r.jsx("div",{className:"text-t4-medium",children:e.username}),e.type==="present"&&t&&r.jsx("div",{className:"text-t4-medium text-grey4",children:"点击查看TA在看什么"}),e.type==="present"&&!t&&r.jsx("div",{className:"text-t4-medium text-grey4",children:"正在浏览"}),e.type==="absent"&&e.lastVisitTime&&r.jsxs("div",{className:"text-t4-medium text-grey4",children:[bR(Date.now()-e.lastVisitTime),"看过"]})]})},cO=e=>{const t=document.querySelector(".block-list");if(!t)return;const n=t.querySelector(`[data-block-id="${e}"]`);n==null||n.scrollIntoView({behavior:"smooth",block:"center"})},r1e=e=>{const t=e.memberInfos.filter(s=>s.present).sort((s,a)=>{var o;return(o=wt.$membersStates[s.userId])!=null&&o.blockId?-1:1}),n=e.memberInfos.filter(s=>!s.present);return r.jsxs("div",{className:"w-[252px] px-2 py-1",children:[t.length>0&&r.jsx("div",{className:"text-t4-medium text-grey4 mb-1",children:"正在浏览"}),t.map(s=>{const a=wt.$membersStates[s.userId],o=s.present&&(a==null?void 0:a.blockId),i=K.users[s.userId],l=ss(s.userId);return i?r.jsx("div",{className:B("flex items-center justify-between mb-1",{"cursor-pointer":o}),onClick:()=>{a&&cO(a.blockId)},children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Ps,{className:B("rounded-full text-white"),name:l,color:i.backgroundColor,icon:{type:"upload",value:i.avatar},imgClassName:"rounded-full"}),r.jsx("div",{className:"ml-2 text-t4-medium text-ellipsis w-[150px]",children:l})]})},s.userId):null}),n.length>0&&r.jsx("div",{className:"text-t4-medium text-grey4 mb-1",children:"上次浏览"}),n.map(s=>{const a=K.users[s.userId],o=ss(s.userId);return a?r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsxs("div",{className:"flex items-center ",children:[r.jsx(Ps,{className:B("rounded-full text-white"),name:o,color:a.backgroundColor,icon:{type:"upload",value:a.avatar},imgClassName:"rounded-full"}),r.jsx("div",{className:"ml-2 text-t4-medium text-ellipsis w-[150px]",children:o})]}),s.lastVisitTime&&r.jsx("div",{className:"text-t4-medium text-grey4",children:bR(Date.now()-s.lastVisitTime)})]},s.userId):null})]})},a1e=qe(),uO=()=>{const e=me();return F.useCallback((t,n)=>{if(!t.current)return;const s=Date.now(),a=localStorage.getItem("last-close-tips");if(a&&he(s).diff(new Date(Number(a)),"hour")<=24)return;const o=()=>{localStorage.setItem("last-close-tips",`${s}`)};e.dropdown({modalId:a1e,mask:!1,autoClose:!1,popcorn:t.current,placement:"bottom-end",offset:[0,8],arrow:!0,content:i=>r.jsxs("div",{className:"next-modal flex text-t2 p-2.5 max-w-[270px]",children:[r.jsx("div",{className:"pl-1.5",children:n.content}),r.jsx(H,{onClick:()=>{i.onCloseModal(),o()},name:"IcToastClose",size:"middle",className:"text-grey3 animate-click"})]})})},[e])},Ub=({title:e,text:t,onClick:n,icon:s})=>r.jsx(Fe,{popup:r.jsx(DE,{title:e,text:t}),children:r.jsx("button",{className:"flex items-center justify-center w-5 h-5 rounded outline-none animate-hover",onClick:n,children:r.jsx(H,{name:s,size:"middle"})})}),DE=({title:e,text:t,className:n})=>r.jsxs("div",{className:Yt("p-1",n),children:[r.jsx("div",{className:"text-t4-medium text-white",children:e}),t&&r.jsx("div",{className:"text-t4-medium text-gray-300",children:t})]}),dO={"page-feeds":"关闭页面动态","page-feeds-right":"关闭页面动态","page-resolved-discussions":"关闭已解决评论","page-resolved-discussions-right":"关闭已解决评论","service-center":"关闭帮助中心","service-center-right":"关闭帮助中心"},fO=()=>{const e=gt(),t=_e(e,[]),n=uO(),{role:s}=it(e),a=me(),o=ht(),i=Qt(),l=Od(t==null?void 0:t.spaceId),c=ak(t==null?void 0:t.spaceId),u=ui(t==null?void 0:t.spaceId),d=F.useRef(null);return F.useEffect(()=>{if(!!(!i.uuid&&c&&o&&l.uuid&&!Fs(s,m.PermissionRole.COMMENTER))&&d.current){if(u)return;n(d,{content:"创建自己的空间，分享好看的页面 快来 FlowUs，提升学习、办公效能"})}},[i.uuid,u,o,c,n,a,s,l.uuid]),o?r.jsxs(r.Fragment,{children:[r.jsx("span",{hidden:!i.uuid&&u,className:"w-px mx-2 h-3.5 bg-grey6 flex-shrink-0"}),r.jsx("div",{ref:d,hidden:!i.uuid&&u,className:"cursor-pointer text-t2-medium ml-2 flex-shrink-0 bg-white dark:bg-transparent text-black",onClick:()=>Bs(dd()),children:r.jsx("div",{children:i.uuid?"返回空间":"体验 FlowUs"})})]}):r.jsx(r.Fragment,{})},o1e=()=>{const e=gt(),n=!!Qt().uuid,s=ae(u=>{var d;return(d=u.blocks[e])==null?void 0:d.type}),{roleWithoutPublic:a}=it(e),o=Im(),i=!!(a!==nj.PermissionRole.NONE&&Xt(s)),l=uO(),c=F.useRef(null);return F.useEffect(()=>{n||l(c,{content:"本文开启了评论权限,注册即刻发表评论"})},[n,l]),o?null:r.jsx("div",{ref:c,children:r.jsxs(je,{className:"text-t2-medium mr-4 sm:mx-4 flex-shrink-0",onClick:()=>{if(!n){const u=nh(Rt.login,[{key:ms.callbackPath,value:location.pathname},{key:ms.quickRegister,value:"true"}]);Bs(`${dd()}${u}`);return}n&&i&&sk(Ut()),Ye({$allowCommentInSharePage:!0})},children:[r.jsx(H,{name:"IcMenuComment",size:"middle"}),r.jsx("span",{className:"ml-2",children:"评论"})]})})};function i1e(e){const{className:t,children:n}=e;return r.jsx("div",{className:B("h-[60px] w-full bg-grey8 flex-shrink-0 text-grey3 flex items-center justify-center sticky cursor-default top-0 left-0 z-20",t),children:n})}const l1e=e=>{var o;const t=_e(e.uuid,["createdBy","status","data"],["createdTemplateBy"]),n=$i(t==null?void 0:t.data.createdTemplateBy),s=Yr((o=n==null?void 0:n.uuid)!=null?o:""),a=l3();return!e.uuid||!n?null:r.jsxs("div",{className:"h-[60px] w-full bg-active_color flex-shrink-0 text-white text-t2-medium flex items-center justify-center sticky cursor-default top-0 left-0 z-20",children:[r.jsxs("div",{children:["此模板由 @",s," 创建，可一键使用或者分享"]}),r.jsx("div",{className:"cursor-pointer rounded border-white border px-4 py-1.5 ml-3",onClick:async()=>{await a({id:e.uuid,isCustom:!0},"templateBar"),ce.event("page_temp_use"),ye.closeMessage("templateLoading")},children:"使用模板"})]})},c1e=5,u1e=()=>ae(e=>{var o,i;const t=(o=e.spaceViews[e.user.currentSpaceViewId])==null?void 0:o.spaceId;if(!t)return;const n=e.spaces[t];if(!n||!s6(t))return;const a=(i=n.customTemplates)==null?void 0:i.filter(l=>!uC(l)).length;return c1e<=a}),Exe=({id:e,title:t,children:n,type:s=cs.PRIVATE,tooltipDesc:a})=>{const o=Ut(),i=!!hZ(),l=`${IG}:${o}:${s}`,[c,u]=F.useState(()=>{let p=!1;if(i)return p;try{const g=localStorage.getItem(l);g&&(p=JSON.parse(g))}catch(g){}return p}),d=Hd(),f=Un(),h=p=>{if(p.stopPropagation(),s===cs.PRIVATE||s===cs.SPACE){c&&u(!1),ce.event("page_new",{group_category:s});const g=d(m.BlockType.PAGE,{parentId:o,first:!0},s);f.push(`/${g}`)}};return r.jsxs("div",{id:e,children:[r.jsxs("div",{className:"z-11 flex items-center justify-between top-0 py-2 text-t2 text-grey3",children:[r.jsx(Fe,{offset:[2,4],placement:"right",popup:r.jsx(cI,{title:`点击${c?"展开":"收起"}页面列表`,text:a}),children:r.jsx("div",{className:"px-1 ml-3 rounded-sm cursor-pointer animate-hover",onClick:()=>{i||Nn(l,JSON.stringify(!c)),u(!c)},children:t})}),(s===cs.PRIVATE||s===cs.SPACE)&&r.jsx(Fe,{popup:r.jsx(cI,{title:"创建新页面",text:a}),placement:"right",className:B("transition-all flex items-center pr-3 opacity-0 add-page",NG[s]),children:r.jsx("button",{...bn(s===cs.PRIVATE?Bn.asideTocHeaderCreateByPrivate:Bn.asideTocHeaderCreateBySpace),onClick:h,className:"rounded-sm cursor-pointer animate-hover",children:r.jsx(H,{name:"MIcAddNew",size:"middle",className:"block"})})})]}),r.jsx(mO.Provider,{value:s,children:r.jsx("div",{className:B({hidden:c}),children:n})})]})},cI=({title:e,text:t})=>r.jsxs("div",{className:"p-1 w-28",children:[r.jsx("div",{children:e}),t&&r.jsx("div",{className:"text-gray-300",children:t})]}),mO=F.createContext(cs.PRIVATE),d1e=()=>F.useContext(mO),SE=async e=>{await Ce.editor.leaveDoc(e),ee(Zp({uuid:e,ignoreOp:!0}))},f1e=({uuid:e,popcorn:t,close:n,isInFavoriteTop:s,groupType:a,isRoot:o})=>{var S,R;const i=tk(e),l=_e(e,["data"],["segments","ref"]),c=ki(l),u=ke(),d=mu(),f=me(),h=eh(),p=Og(e),g=(l==null?void 0:l.type)===m.BlockType.FILE,{illegal:_,role:x}=it(e),y=Ve(e),b=Mx(e),E=gg(e),w=Un(),k=ht(),C=Ui(),T=Cs(),v=ks(),I=()=>{ce.event("rename_click",{group_category:a}),f.dropdown({popcorn:t,placement:"bottom-start",content({onCloseModal:A}){return l?r.jsx(h1e,{close:A,uuid:e}):null}})};let j;if(k)j=[{type:$.OPERATION,data:{icon:"IcUrl",title:"复制页面访问链接",onClick:()=>{const A=k?"share/":"";on(`${Sn()}/${A}${e}`)}}}];else if(g)j=[{type:$.OPERATION,data:{icon:"IcQuickAccessRemove",title:"取消快速访问",onClick:()=>{u(()=>{ce.event("favorite_cancel_click"),Gh(e,{parentId:le().user.currentSpaceViewId})})}},isHidden:!i}];else{const A=c&&!K.blocks[(R=(S=l==null?void 0:l.data.ref)==null?void 0:S.uuid)!=null?R:""];j=[{type:$.OPERATION,data:{icon:"IcMenuDelete",title:"删除",onClick:()=>{ce.event("delete_click"),u(()=>{Gs(e),l&&B1(l)&&w.push(k?`/share/${l.parentId}`:l.parentId)})}},isHidden:s||!E||!(x===m.PermissionRole.EDITOR||x===m.PermissionRole.WRITER)},{type:$.OPERATION,data:{icon:"IcQuickAccessRemove",title:"取消快速访问",onClick:()=>{ce.event("favorite_cancel_click"),u(()=>{Gh(e,{parentId:le().user.currentSpaceViewId})})}},isHidden:!i},{type:$.OPERATION,data:{icon:"IcQuickAccess",title:"添加到快速访问",onClick:()=>{ce.event("favorite_click"),u(()=>{t6(e,{first:!0,parentId:le().user.currentSpaceViewId}),v(Ae.ADD_TO_FAVORITE,We.advancedList)})}},isHidden:i||c},{type:$.OPERATION,data:{icon:"IcMenuDuplicate",title:"拷贝副本",onClick:()=>{ce.event("copy_click"),h([e])}},isHidden:s||!E||C&&o||A},{type:$.OPERATION,data:{icon:"IcUrl",title:"复制页面访问链接",onClick:()=>{const L=k?"share/":"";on(`${Sn()}/${L}${e}`)}}},{type:$.OPERATION,data:{icon:"IcMenuRename",title:"重命名",onClick:I},isHidden:c||y},{type:$.LINE,data:{},disableClick:!0,isHidden:!b||A},{type:$.OPERATION,data:{icon:"IcMenuMove",title:"移动到",onClick:()=>{ce.event("moveto_menu_click",{group_category:a}),d({popcorn:t,uuid:e})}},isHidden:!b||A}],a===cs.SHARE&&o&&C&&(j.unshift({type:$.LINE,data:{},disableClick:!0,isHidden:!1}),j.unshift({type:$.OPERATION,data:{icon:"MIcSettingsLogout",title:"退出协作",onClick:()=>{SE(e)}},isHidden:!1}))}!l&&s?j=[{type:$.OPERATION,data:{icon:"IcQuickAccessRemove",title:"取消快速访问",onClick:()=>{ce.event("favorite_cancel_click"),u(()=>{Gh(e,{parentId:le().user.currentSpaceViewId})})}}}]:_&&(a===cs.SHARE&&o&&C?j=[{type:$.OPERATION,data:{icon:"MIcSettingsLogout",title:"退出协作",onClick:()=>{SE(e)}}}]:j=[{type:$.OPERATION,data:{icon:"IcMenuDelete",title:"彻底删除",onClick:()=>p()},isHidden:y}]);const D={type:$.OPERATION,isHidden:g,data:{icon:"IcOpenRight",title:"在侧边栏中打开",onClick:()=>T(e,{forceOpenInRight:!0})}};return j.unshift(D),r.jsx(ze,{className:"w-56 py-2 rounded-r next-modal",items:j,onItemClick:()=>n()})},m1e=({uuid:e,deep:t})=>{const n=me(),s=d1e(),a=s===cs.FAVORITE&&t===0;return F.useCallback(o=>{ce.event("pagemenu_click",{group_category:s}),o.preventDefault(),o.stopPropagation(),n.dropdown({popcorn:lm(o),placement:"right-start",offset:[-18,16],content({onCloseModal:i}){return r.jsx(f1e,{groupType:s,isInFavoriteTop:a,uuid:e,popcorn:lm(o),close:i,isRoot:t===0})}})},[t,s,a,n,e])},wxe=e=>{const t=m1e(e);return r.jsx(Fe,{popup:"展开菜单",children:r.jsx("button",{...bn(Bn.asideItemMore),className:"items-center justify-center hidden rounded-sm animate-hover group-hover:flex",onClick:t,children:r.jsx(H,{name:"IcMore",className:"text-grey3",size:"middle"})})})},h1e=({uuid:e,close:t})=>{const n=_e(e,["data"],["segments"]),s=ke();return F.useEffect(()=>{const a=o=>{o.code==="Enter"&&t()};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[t]),n?r.jsx("div",{className:"next-modal flex items-center p-1 rounded-t",style:{width:"365px"},children:r.jsx(xt,{autoFocus:!0,showBorder:!1,value:de(n.data.segments),onEnter:t,onChange:a=>{s(()=>{pe(e,{data:{segments:mt(a)}})})},placeholder:Ot(n.type),className:"w-full h-8 bg-grey8"})}):null},p1e=(e,t)=>{ye.loading({key:e,content:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{children:t}),r.jsx("div",{onClick:()=>ye.closeMessage(e),className:"text-active_color animate-click",children:"关闭提示"})]})})},n1=({items:e,onClick:t,value:n})=>{const s=me(),a=e.find(o=>o.data.value===n);return r.jsxs("div",{className:"flex items-center animate-click",onClick:o=>{s.dropdown({popcorn:o.target,content({onCloseModal:i}){return r.jsx("div",{className:"next-modal w-[200px] py-2",children:r.jsx(ze,{items:e,onItemClick:l=>{t(l.data.value),i()}})})}})},children:[r.jsx("div",{className:"text-t2",children:a==null?void 0:a.data.title}),r.jsx(H,{name:"IcArrow",className:"ml-2 text-grey4",size:"tiny"})]})},Nu=({title:e,className:t,children:n})=>r.jsxs("div",{className:B("flex items-center justify-between mb-4",t),children:[r.jsx("div",{className:"text-t2 text-grey3",children:e}),n]}),g1e=[.25,.5,.75,1,1.25,1.5,1.75,2].map(e=>({type:$.OPERABLE_BLOCK_TEXT,data:{title:`${e*100}%`,value:e}})),_1e=[{type:$.OPERABLE_BLOCK_TEXT,data:{title:"PDF",value:"pdf"}},{type:$.OPERABLE_BLOCK_TEXT,data:{title:"Markdown & CSV",value:"markdown"}},{type:$.OPERABLE_BLOCK_TEXT,data:{title:"Word",value:"word"}}],x1e=[{type:$.OPERABLE_BLOCK_TEXT,data:{title:"A4",value:"a4"}},{type:$.OPERABLE_BLOCK_TEXT,data:{title:"A3",value:"a3"}}],F1e=[{type:$.OPERABLE_BLOCK_TEXT,data:{title:"当前视图范围",value:"current"}},{type:$.OPERABLE_BLOCK_TEXT,data:{title:"全部",value:"all"}}],y1e=({onCloseModal:e})=>{const t=gt(),n=Ft(),s=ae(({blocks:l})=>{const c=l[t];if(!c)return!1;if(Wr(c.type))return!0;const u=d=>{const f=l[d];if(f){if([m.BlockType.COLLECTION_VIEW,m.BlockType.REFERENCE_COLLECTION].includes(f.type))return!0;if(Xt(f.type))return!1;const{subNodes:h}=f;return h.some(u)}};return!!c.subNodes.some(u)}),[a,o]=F.useState({type:"pdf",pdfFormat:"a4",dataBaseRange:"current",scale:1}),i=async()=>{var c;ce.event("export_page",{export_type:a==null?void 0:a.type,page_type:(c=K.blocks[t])==null?void 0:c.type});const l=await I5({eventName:"export",request:{blockId:t,spaceId:n.uuid,exportOptions:a}},{success({url:u}){u&&fR(u)}});e(),p1e(l,"正在导出，请稍候...")};return r.jsxs("div",{className:"next-modal w-[360px] px-8 py-6",children:[r.jsx(Nu,{title:"导出格式",children:r.jsx(n1,{items:_1e,value:a==null?void 0:a.type,onClick:l=>{o(l==="markdown"?()=>({type:l,includeContents:!0,includeSubPages:!0,flattenFileTree:!1}):()=>({type:l,pdfFormat:"a4",dataBaseRange:"current",scale:1}))}})}),(a==null?void 0:a.type)==="pdf"&&r.jsxs(r.Fragment,{children:[r.jsx(Nu,{title:"页面尺寸",children:r.jsx(n1,{items:x1e,value:a==null?void 0:a.pdfFormat,onClick:l=>o(c=>({...c,pdfFormat:l}))})}),s&&r.jsx(Nu,{title:"多维表导出范围",children:r.jsx(n1,{items:F1e,value:a==null?void 0:a.dataBaseRange,onClick:l=>o(c=>({...c,dataBaseRange:l}))})}),r.jsx(Nu,{title:"显示比例",children:r.jsx(n1,{items:g1e,value:a==null?void 0:a.scale,onClick:l=>o(c=>({...c,scale:l}))})})]}),(a==null?void 0:a.type)==="markdown"&&r.jsxs(r.Fragment,{children:[r.jsx(Nu,{title:"导出附件",children:r.jsx(wn,{open:!!a.includeContents,onSwitch:l=>o(c=>({...c,includeContents:l}))})}),r.jsx(Nu,{title:"导出子页面",children:r.jsx(wn,{open:!!a.includeSubPages,onSwitch:l=>o(c=>({...c,includeSubPages:l}))})}),r.jsx(Nu,{title:"按目录导出",children:r.jsx(wn,{open:!a.flattenFileTree,onSwitch:l=>o(c=>({...c,flattenFileTree:!l}))})})]}),r.jsxs("div",{className:"flex items-center justify-end mt-6",children:[r.jsx(je,{onClick:e,className:"mr-4 text-t2-medium",children:"取消"}),r.jsx(je,{colorType:"active",className:"text-t2-medium text-white",onClick:i,children:"导出"})]})]})},hO="由 FlowUs 息流提供技术支持",b1e=e=>{const{exportOption:t}=e,n=di(),s=QF(),a=Ro();return t.type!=="png"?null:r.jsxs("div",{className:e.className,children:[r.jsxs("div",{className:"flex mb-4",children:[r.jsx("div",{className:"text-t2 text-grey3",children:"导出格式"}),r.jsxs("div",{className:"flex items-center ml-5 ",children:[r.jsx("div",{className:"text-t2",children:"PNG"}),r.jsx(H,{name:"IcArrow",className:"ml-2 text-grey4",size:"tiny"})]})]}),r.jsxs("div",{className:"flex items-start mb-4",children:[r.jsx("div",{className:"text-t2 text-grey3",children:"更多设置"}),r.jsxs("div",{className:"ml-5",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx(H,{size:"large",name:t.transparent?"IcCheckboxCheck":"IcCheckbox",className:B("mr-0.5 ",t.transparent?"text-active_color":""),onClick:()=>{e.onExportOptionChange({transparent:!t.transparent,watermark:t.watermark})}}),r.jsx("div",{className:"text-t2",children:"透明背景"})]}),r.jsxs("div",{className:"relative flex items-center",children:[r.jsx(H,{size:"large",name:t.watermark?"IcCheckboxCheck":"IcCheckbox",className:B("mr-0.5 ",t.watermark?"text-active_color":""),onClick:()=>{if(n){s(()=>{a(Vt.export_watermark)});return}e.onExportOptionChange({transparent:t.transparent,watermark:t.watermark?"":hO})}}),r.jsx("div",{className:"text-t2",children:"FlowUs 水印"}),n&&r.jsx("div",{className:"flex items-center justify-center w-7 h-4 absolute right-[-30px] top-1",style:{background:"linear-gradient(89.52deg, #F3E4B5 0.34%, #E9C770 99.54%)",borderRadius:"10px 10px 10px 2px"},children:r.jsx("span",{className:"text-t4",style:{color:"#8F6C28"},children:"Pro"})})]})]})]}),r.jsxs("div",{className:"flex items-center justify-end mt-24 ml-10",children:[r.jsx(je,{onClick:e.onCancel,className:"mr-4 text-t2-medium",children:"取消"}),r.jsx(je,{colorType:"active",className:"text-t2-medium text-white",onClick:async()=>{var o;(o=e.onExport)==null||o.call(e)},children:"导出"})]})]})},E1e=e=>{const{snapshot:t,transparent:n,isWidthMax:s=!0}=e,a=()=>t?r.jsx("img",{src:t,className:s?"w-full":"h-full"}):r.jsx(os,{className:"h-full"});return r.jsx("div",{className:"w-[250px] h-[250px] shrink-0 p-5 flex items-center justify-center",style:{background:n?`url(${Dn.transparent})`:void 0},children:a()})},RE=60,w1e=async(e,t)=>{if(t.type==="png"&&e.firstChild instanceof HTMLElement){const n=e.querySelector(".node-drawer");if(!n)return;const s=n.getBoundingClientRect();return await u5(n,{backgroundColor:t.transparent?null:void 0,useCORS:!0,x:0,y:0,width:s.width-100,height:s.height+RE,scale:window.devicePixelRatio,ignoreElements:o=>!!o.classList.contains("hidden-textarea")})}},uI=(e,t,n)=>{var s,a,o;if(t.firstChild instanceof HTMLElement){const i=t.firstChild.getBoundingClientRect(),l=e.getContext("2d");if(!l)return;l.save(),l.font="14px normal",l.textAlign="left";const c=e.width/((s=n.scale)!=null?s:window.devicePixelRatio),u=e.height/((a=n.scale)!=null?a:window.devicePixelRatio),d=(i.width-c)/2,f=(i.height-u)/2;if(l.translate(i.left+d,i.top+f),l.clearRect(0,u,c,u+RE),n.watermark){l.fillStyle=n.isDarkMode?"white":"grey";const h=l.measureText(n.watermark).width;l.fillText(n.watermark,(c-h)*.5,u+(RE-10)/((o=n.scale)!=null?o:window.devicePixelRatio))}l.restore()}},k1e=e=>{const[t,n]=F.useState(),s=F.useMemo(()=>Kc("right")===e.id,[e.id]),[a,o]=F.useState(),[i,l]=F.useState(()=>({type:"png",transparent:!1,watermark:hO,isDarkMode:Wa(),alreadySnapShot:!1})),[c,u]=F.useState(!0);return F.useEffect(()=>{const d=Eb(e.id);if(!d)return;const{scale:f}=d.getSnapShot();return d==null||d.zoom(100),()=>{d.zoom(f)}},[e.id]),F.useEffect(()=>{if(i.type==="png"&&i.alreadySnapShot)return;const d=jn(".next-space-page,.mind-page",s);if(d instanceof HTMLElement){if(!Eb(e.id))return;setTimeout(()=>{w1e(d,{...i,transparent:!0}).then(h=>{o(h),n(h==null?void 0:h.toDataURL("image/png")),l(p=>({...p,alreadySnapShot:!0}))})},1e3)}},[i,s,e.id]),F.useEffect(()=>{switch(i.type){case"png":{if(!i.alreadySnapShot||!a)return;const d=jn(".next-space-page,.mind-page",s);if(!Eb(e.id))return;d instanceof HTMLElement&&(uI(a,d,{transparent:i.transparent,watermark:i.watermark,isDarkMode:Wa()}),n(a==null?void 0:a.toDataURL("image/png")));break}}},[a,i.alreadySnapShot,i.transparent,i.type,i.watermark,s,e.id,c]),r.jsxs("div",{className:"next-modal w-[600px] py-7 pb-5 px-7",children:[r.jsx("div",{className:"text-h2",children:"导出页面"}),r.jsxs("div",{className:"flex mt-7",children:[r.jsx(E1e,{snapshot:t,transparent:i.transparent,isWidthMax:!!(a&&a.width>a.height)}),r.jsx(b1e,{exportOption:i,onExportOptionChange:d=>{l(f=>({...f,...d}))},className:"ml-7 mt-2 w-full",onCancel:()=>{var d;(d=e.onCloseModal)==null||d.call(e)},onExport:()=>{var E;if(!a||!t)return;const d=K.blocks[e.id];if(!d)return;(E=e.onCloseModal)==null||E.call(e),ce.event("export_page",{export_type:"PNG",page_type:d.type});const f=jn(".next-space-page,.mind-page",s);if(!f)return;const h=document.createElement("a"),g=`${de(d==null?void 0:d.data.segments)||Ot(d==null?void 0:d.type)}.png`;i.watermark&&uI(a,f,{transparent:i.transparent,watermark:"",isDarkMode:Wa()});const _=document.createElement("canvas"),x=240;_.width=a.width+x,_.height=a.height+x;const y=_.getContext("2d");if(!y)return;y.save(),y.fillStyle=i.transparent?"transparent":Wa()?"black":"white",y.fillRect(0,0,_.width,_.height);const b=new Image;b.setAttribute("crossOrigin","anonymous"),b.onload=()=>{if(y.drawImage(b,0,0,a.width,a.height,x/2,x/2,a.width,a.height),y.stroke(),i.watermark){y.font="28px normal",y.textAlign="left",y.fillStyle=Wa()||i.transparent?"white":"grey";const k=y.measureText(i.watermark).width;y.fillText(i.watermark,(_.width-k)*.5,_.height-x*.3)}y.restore();const w=_.toDataURL("image/png");h.download=g,h.href=w,h.click()},b.src=a==null?void 0:a.toDataURL("image/png")}})]})]})},C1e=e=>{Lr();const t=QF(),n=Ro(),s=di(),{fontFormat:a,pageLayout:o}=$L(e.pageId),i=ke(),l=u=>{var f;if(s&&(u==="lxgwWenKai"||u==="sourceHanSerif")){t(()=>{n(Vt.custom_font_layout)});return}let d="default";u==="lxgwWenKai"?d="LXGW_WenKai":u==="sourceHanSerif"&&(d="Source_Han_Serif_SCVF"),ce.event("font_set",{font_type:d}),i(()=>{pe(e.pageId,{data:{format:{fontFormat:u}}})}),(f=e.onOperationFinish)==null||f.call(e)},c=u=>{var f;if(s&&(u==="compact"||u==="loose")){t(()=>{n(Vt.custom_font_layout)});return}let d="default";u==="compact"?d="tight":u==="loose"&&(d="loose"),ce.event("font_set",{layout_set:d}),i(()=>{pe(e.pageId,{data:{format:{pageLayout:u}}})}),(f=e.onOperationFinish)==null||f.call(e)};return r.jsxs("div",{className:e.className,children:[!e.hideFontComponent&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t4 text-grey3",children:"默认字体"}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx(Vb,{title:"息流",desc:"默认",isSelected:a==="default",onClick:()=>{l("default")}}),r.jsx(Vb,{title:"息流",desc:"霞鹜文楷",showPro:s,isSelected:a==="lxgwWenKai",style:{fontFamily:Rp.lxgwWenKai},onClick:()=>{l("lxgwWenKai")}}),r.jsx(Vb,{title:"息流",desc:"思源宋体",showPro:s,isSelected:a==="sourceHanSerif",style:{fontFamily:Rp.sourceHanSerif},onClick:()=>{l("sourceHanSerif")}})]})]}),!e.hideLayoutComponent&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-t4 text-grey3 mt-5",children:"页面布局"}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx(qb,{title:"紧密",showPro:s,src:Dn.compactLayout,isSelected:o==="compact",onClick:()=>{c("compact")}}),r.jsx(qb,{title:"默认",src:Dn.defaultLayout,isSelected:o==="default",onClick:()=>{c("default")}}),r.jsx(qb,{title:"宽松",showPro:s,src:Dn.looseLayout,isSelected:o==="loose",onClick:()=>{c("loose")}})]})]})]})},Vb=e=>r.jsxs("div",{className:Yt("relative flex flex-col justify-center items-center w-[66px] h-[60px] border-[1px] border-solid mt-2.5 rounded cursor-pointer",{"border-active_color":e.isSelected,"border-grey6 ":!e.isSelected,"bg-active_color/5":e.isSelected}),style:e.style,onClick:e.onClick,children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-t2 text-center",children:e.title}),r.jsx("div",{className:"text-t4 mt-1 text-grey3 text-center",children:e.desc})]}),e.showPro&&r.jsx("div",{className:"flex items-center justify-center w-7 h-4 absolute right-[-4px] top-[-8px]",style:{background:"linear-gradient(89.52deg, #F3E4B5 0.34%, #E9C770 99.54%)",borderRadius:"10px 10px 10px 2px"},children:r.jsx("span",{className:"text-t4",style:{color:"#8F6C28"},children:"Pro"})})]}),qb=e=>r.jsxs("div",{className:Yt("relative flex flex-col justify-center items-center w-[66px] h-[44px] border-[1px] border-solid mt-2.5 rounded cursor-pointer",{"border-active_color":e.isSelected,"border-grey6 ":!e.isSelected,"bg-active_color/5":e.isSelected}),style:{borderColor:e.isSelected?"--active_color":void 0},onClick:e.onClick,children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("img",{src:e.src,className:"w-5"}),r.jsx("div",{className:"text-t4 text-grey3 text-center ml-1",children:e.title})]}),e.showPro&&r.jsx("div",{className:"flex items-center justify-center w-7 h-4 absolute right-[-4px] top-[-8px]",style:{background:"linear-gradient(89.52deg, #F3E4B5 0.34%, #E9C770 99.54%)",borderRadius:"10px 10px 10px 2px"},children:r.jsx("span",{className:"text-t4",style:{color:"#8F6C28"},children:"Pro"})})]}),pO=()=>{const e=gt(),t=me(),n=ht(),s=Ve(e),a=_e(e,[]),o=gg(e),i=u=>{var f;if(c)return;ce.event("page_menu_click",{page_type:(f=le().blocks[e])==null?void 0:f.type,is_share:n});const d=u.currentTarget;t.dropdown({modalId:Xe.PAGE_HEADER_MENU_LIST,popcorn:d,placement:"bottom-end",offset:[0,15],content(){return r.jsx(T1e,{popcorn:d,uuid:e})}})},l=(a==null?void 0:a.type)!==m.BlockType.PAGE,c=!n&&(s||l&&!o);return r.jsx(Fe,{popup:"菜单",id:"page-header-more",...bn(Bn.pageHeaderMore),disabled:c,onClick:i,className:B("flex items-center justify-center p-1",c?"cursor-not-allowed":"animate-hover"),children:r.jsx(H,{size:"middle",name:"IcTitleMore",className:B(c&&"opacity-20")})})},T1e=e=>{var W;const{popcorn:t,uuid:n}=e,s=On(),a=rf(),o=kF(n),i=_e(n,["data","updatedAt","updatedBy"],["pageFixedWidth","directoryMenu"]),l=Yr((W=i==null?void 0:i.updatedBy)!=null?W:""),{pageFixedWidth:c=!0,directoryMenu:u}=(i==null?void 0:i.data)||{},d=mu(),f=ke(),h=gg(n),p=So(n),g=Mx(n),_=rB(n),x=me(),y=Kt(),b=Og(n),E=jV(),w=Ui(),k=ay(n),C=u1e(),T=Ro(),v=ks(),I=sa(Oc),j=Pa(),{illegal:D,role:S}=it(n),R=[m.PermissionRole.WRITER,m.PermissionRole.EDITOR].includes(S),A=ht(),L=(i==null?void 0:i.type)!==m.BlockType.PAGE,P=(i==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW||(i==null?void 0:i.type)===m.BlockType.COLLECTION_VIEW_PAGE||(i==null?void 0:i.type)===m.BlockType.REFERENCE_COLLECTION||(i==null?void 0:i.type)===m.BlockType.REFERENCE_COLLECTION_PAGE,M=(i==null?void 0:i.type)===m.BlockType.FOLDER,U=Vc();let V=_;return A||(D?V=[w&&E.includes(n)?{type:$.OPERATION,data:{icon:"MIcSettingsLogout",title:"退出协作",onClick:()=>{SE(n)}}}:{type:$.OPERATION,data:{icon:"IcMenuDelete",title:"彻底删除",onClick:()=>b()}},{type:$.LINE,isHidden:!R,data:{},disableClick:!0}]:V=[{type:$.TEXT_SWITCH,isHidden:L,data:{title:"固定宽度",switch:c,onSwitch:z=>{ce.event("fixedwidth",{is_open:z}),f(()=>{pe(n,{data:{pageFixedWidth:z}})})}}},{type:$.TEXT_SWITCH,isHidden:L,data:{title:"页面目录",switch:u,onSwitch:z=>{var te,re;if(ce.event("float_catalog_switch",{is_open:z}),f(()=>{v(Ae.CREATE_HEADER_BLOCK,We.basicList,{step2:!0}),pe(n,{data:{directoryMenu:z}})}),!z||((te=K.user.setting)==null?void 0:te.directoryMenu))return;const Z=parseInt((re=sessionStorage.getItem("settingTipCount"))!=null?re:"0",10);sessionStorage.setItem("settingTipCount",(Z+1).toString()),Z===2&&x.warning({title:"是否希望新建页面的目录自动打开?",content:"【设置】->【通用设置】->【新建页面目录】",cancelText:"取消",colorType:"active",confirmText:"现在就去设置",confirm:()=>{j({defaultMenuType:Jt.general,from:Vt.tip})}})}}},{type:$.LINE,isHidden:L||!h,data:{},disableClick:!0},{type:$.CUSTOM_RENDER,isHidden:xo(i==null?void 0:i.type),render:()=>r.jsx(C1e,{className:"px-4 mt-4 mb-3",pageId:n,hideLayoutComponent:P||M})},{type:$.LINE,isHidden:xo(i==null?void 0:i.type),data:{},disableClick:!0},{type:$.OPERATION,isHidden:L&&!P&&!xo(i==null?void 0:i.type),data:{icon:p?"IcMenuUnlock":"IcMenuLock",title:p?P?"解锁多维表":"解锁页面":P?"锁定多维表":"锁定页面",tip:P?"锁定时，无法新增/修改多维表的配置、视图和属性，但可以新增/编辑记录。":"锁定时，无法编辑页面",onClick:()=>{ce.event("page_lock",{is_open:!p}),f(()=>{pe(n,{data:{format:{locked:!p,lockedBy:K.user.uuid}}})})},rightText:p?`${Gt}+L`:`${Gt}+L`}},{type:$.LINE,isHidden:L&&!P||M,data:{},disableClick:!0},{type:$.OPERATION,isHidden:!h||S===m.PermissionRole.READER||S===m.PermissionRole.NONE,data:{icon:"IcUrl",title:"拷贝页面访问链接",onClick:$n(()=>{ce.event("copy_page_link"),on(`${Sn()}${U.pathname}`)},300,{leading:!0})}},{type:$.LINE,isHidden:L||o||!h,data:{},disableClick:!0},{type:$.OPERATION,isHidden:S===m.PermissionRole.READER||S===m.PermissionRole.NONE,data:{icon:"IcMenuUndo",rightText:`${Gt}+Z`,title:"撤销",onClick:$n(()=>{ce.event("undo_click"),ee(Ad())},300,{leading:!0})}},{type:$.OPERATION,isHidden:S===m.PermissionRole.READER||S===m.PermissionRole.NONE,data:{icon:"IcMenuRedo",rightText:`${Gt}+Shift+Z`,title:"重做",onClick:$n(()=>{ce.event("redo_click"),ee(Dm())},300,{leading:!0})}},{type:$.OPERATION,isHidden:S!==m.PermissionRole.EDITOR&&S!==m.PermissionRole.WRITER,data:{icon:"IcMenuPageHistory",title:"页面历史",onClick:$n(()=>{x.modal({modalId:Xe.DOC_HISTORY_MODAL_ID,content:()=>r.jsx(Nre,{docId:n})})},300,{leading:!0})}},{type:$.OPERATION,isHidden:!Fs(S,m.PermissionRole.WRITER),data:{icon:"IcMenuResolved",title:"已解决评论",onClick:$n(()=>{I(s?"page-resolved-discussions-right":"page-resolved-discussions")},300,{leading:!0})}},{type:$.OPERATION,isHidden:o||!h||S===m.PermissionRole.READER||S===m.PermissionRole.NONE,data:{icon:"IcMenuDelete",title:"删除",onClick:$n(()=>{ce.event("delete_pageclick"),f(()=>{Gs(n)})},300,{leading:!0})}},{type:$.LINE,data:{},disableClick:!0},{type:$.TEXT_SWITCH,isHidden:M||o||w||S===m.PermissionRole.READER||S===m.PermissionRole.NONE,data:{icon:"IcTemplateNew",title:"转换为模板",switch:k,context:Bt({title:"转换为模板后，有协作权限的空间成员和访客可以在模板库看到并使用模板。",image:"custom_template_tip"}),onSwitch:z=>{f(()=>{if(z){if(!C){ce.event("temp_switch",{is_open:!0}),LW(n,{parentId:Tn().uuid,first:!0}),pe(n,{data:{createdTemplateBy:K.user.uuid}}),v(Ae.CONVERT_TO_TEMPLATE,We.advancedList);return}x.warning({title:r.jsx("div",{className:"mb-5",children:r.jsx("p",{className:"text-t1-medium mb-2.5",children:"已达到空间模板上限，升级空间解锁无限数量的模板。"})}),colorType:"active",confirmText:"升级空间",confirm:()=>{T(Vt.temp_max)}})}else ce.event("temp_switch",{is_open:!1}),kk(n,{parentId:Tn().uuid})})}}},{type:$.OPERATION,isHidden:M,data:{icon:"IcUploadDocMenu",title:"导出页面",onClick:$n(()=>{x.modal({content:({onCloseModal:z})=>xo(i==null?void 0:i.type)?r.jsx(k1e,{onCloseModal:z,id:n}):r.jsx(y1e,{onCloseModal:z})})},300,{leading:!0})}},{type:$.LINE,isHidden:!g||M,data:{},disableClick:!0},{type:$.OPERATION,isHidden:!M,data:{icon:"IcMenuDownload",title:"下载",onClick:()=>{a([n])}}},{type:$.OPERATION,isHidden:!g,data:{icon:"IcMenuMove",rightText:`${Gt}+Shift+P`,title:"移动到",onClick:()=>{ce.event("moveto_pageclick"),d({popcorn:t,uuid:n,placement:"bottom-end",offset:[0,15]})}}},{type:$.LINE,isHidden:!(R&&!A),data:{},disableClick:!0}]),r.jsx(ze,{className:"py-1 rounded-r w-[250px] next-modal max-h-[90vh] overflow-auto",items:V,customFooter:R&&!A&&r.jsx(Km,{className:"!py-2",name:l,updatedAt:i==null?void 0:i.updatedAt,showWordCount:(i==null?void 0:i.type)===m.BlockType.PAGE}),onItemClick:()=>y(Xe.PAGE_HEADER_MENU_LIST)})},gO=({className:e})=>{const[t,n]=wm(Oc),s=On(),a=s&&t==="page-feeds-right"||!s&&t==="page-feeds";return r.jsx(Fe,{popup:`${t?"关闭":"查看"}页面动态`,className:B("p-1 flex items-center justify-center animate-hover",a&&"bg-black_006",e),onClick:()=>{n(s?t!=="page-feeds-right"?"page-feeds-right":!1:t!=="page-feeds"?"page-feeds":!1)},children:r.jsx(H,{name:"IcTitleUpdates",size:"middle"})})},v1e=()=>{var d;const e=gt(),t=On(),n=kF(e),s=iO(e),a=ay(e),o=ht(),{role:i}=it(e),l=_e(e,["isTemplate"]),c=$c(),u=Ve(e);return r.jsxs(r.Fragment,{children:[t&&r.jsx(N1e,{}),r.jsx(aO,{type:"header"}),!s&&n&&r.jsx(dC,{uuid:e}),a&&!o&&!n&&i!==m.PermissionRole.NONE&&r.jsx(l1e,{uuid:e}),(l==null?void 0:l.isTemplate)&&r.jsxs(i1e,{className:"flex justify-between text-t2",children:[(d=c.location.state)!=null&&d.noticeBannerShowBackButton?r.jsxs("button",{className:"text-grey3 ml-3 pl-1 pr-2 flex items-center animate-hover",onClick:()=>{c.goBack()},children:[r.jsx(H,{name:"IcArrowBack",size:"middle",className:"mt-[1px]"}),"返回"]}):r.jsx("span",{}),r.jsxs("span",{className:"flex items-center",children:["你正在",r.jsx(Aa,{className:"text-black",uuid:l.parentId,isLinkPage:!0,interactable:!0,autoIconSize:!0}),"中",u?"查看":"编辑","模板记录"]}),r.jsx("span",{})]})]})},N1e=()=>{const e=gt(),t=Ar(pC),s=Object.values(t).find(y=>y.checkRecord(e)),a=Un(),o=Kp(),i=ZU(),l=OV(),c=ht(),u=hw(),{role:d,illegal:f}=it(e),h=Yd(e),p=f||u,g=Ar(Oc),_=g==="page-feeds-right"||g==="page-resolved-discussions-right",x=sa(Oc);return F.useEffect(()=>{if(s==null)return;const y=N1(document,"keydown").subscribe(b=>{if(be("ctrl+shift+k")(b)){const E=s.prevRecord(e);if(E==null)return;a.push(`/${E}`),b.preventDefault()}else if(be("ctrl+shift+j")(b)){const E=s.nextRecord(e);if(E==null)return;a.push(`/${E}`),b.preventDefault()}});return()=>y.unsubscribe()},[a,e,s]),r.jsxs("div",{className:"absolute top-0 left-1 w-full h-[54px] bg-white1 flex items-center justify-between z-50 px-4 text-black",children:[r.jsxs("div",{className:"flex items-center space-x-5",children:[r.jsx(Ub,{title:"关闭",text:`${Py}+Q`,icon:"IcTitleClose",onClick:o}),r.jsx(Ub,{title:"切换",text:`${Py}+'`,icon:"IcTitleSwitch",onClick:l}),r.jsx(Ub,{title:"放大",text:`${Py}+F`,icon:"IcMenuOpen",onClick:i}),s!=null&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-0 border-l-[1px] border-grey6  h-[14px]"}),r.jsx(Fe,{popup:r.jsx(DE,{title:"上一条记录",text:"ctrl+Shift+K",className:"w-28"}),children:r.jsx("button",{className:"flex items-center justify-center w-5 h-5 rounded outline-none animate-hover disabled:opacity-30",disabled:s.prevRecord(e)==null,onClick:()=>{const y=s.prevRecord(e);y!=null&&a.push(`/${y}`)},children:r.jsx(H,{name:"IcArrowPagePrev",size:"middle"})})}),r.jsx(Fe,{popup:r.jsx(DE,{title:"下一条记录",text:"ctrl+Shift+J",className:"w-28"}),children:r.jsx("button",{className:"flex items-center justify-center w-5 h-5 rounded outline-none animate-hover disabled:opacity-30",disabled:s.nextRecord(e)==null,onClick:()=>{const y=s.nextRecord(e);y!=null&&a.push(`/${y}`)},children:r.jsx(H,{name:"IcArrowPageNext",size:"middle"})})})]}),r.jsx(S3,{uuid:e})]}),r.jsxs("div",{className:B("fixed top-0 right-0 flex items-center justify-end h-[54px]",_&&"w-[360px] border-l border-l-grey6"),children:[_&&r.jsx(Fe,{className:"mr-auto flex items-center justify-center p-1 text-grey3 animate-hover ml-4 z-10",popup:dO[g],onClick:()=>{x(!1)},children:r.jsx(H,{name:"IcUnfold",size:"middle"})}),r.jsx("div",{className:B("absolute top-0 left-0 flex items-center justify-end h-[54px] bg-white1",_&&"w-[140px]")})]}),r.jsxs("div",{className:"flex item-center z-10",children:[!c&&!p&&!h&&r.jsx(vg,{showType:"button",className:"mr-1.5"}),!f&&(d===m.PermissionRole.WRITER||d===m.PermissionRole.EDITOR)&&r.jsx(gO,{className:"mr-[6px]"}),!c&&!f&&r.jsx(oF,{uuid:e,className:"mr-1.5"}),r.jsx(pO,{})]})]})},_O=()=>F.useCallback(async e=>{var l,c,u;const{space:t,...n}=e,s=await Ce.infra.searchDocs(t,n),a=(l=s.recordMap)==null?void 0:l.blocks;if(!a)return{hasMore:!1,results:[],total:(c=s.total)!=null?c:0};const o=d=>{const f=[];let h=a[d];for(;h;)h=a[h.parentId],h&&Xt(h.type)&&f.unshift(h);return f};ee(Gn.update({blocks:a}));const i=[];return s.results.forEach(d=>{if(d.pageId){const f=o(d.pageId);i.push({...d,navs:f})}}),{hasMore:s.results.length===e.perPage,results:i,total:(u=s.total)!=null?u:0}},[]),mo=e=>{var t,n;return r.jsxs("div",{className:`flex flex-row items-center ${e.className}`,style:e.style,onClick:e.onClick,children:[r.jsx(H,{size:"middle",name:e.name}),r.jsx("div",{className:`ml-2 ${(t=e.textConfig)==null?void 0:t.className}`,style:(n=e.textConfig)==null?void 0:n.style,children:e.text})]})},xO=()=>{const e=me(),t=F.useRef();return F.useCallback((n,s,a)=>{e.dropdown({popcorn:n.target,placement:"bottom",closeBeforeCallBack:()=>{t.current&&s(t.current)},content:({onCloseModal:o})=>{const i=new Date;return i.setHours(0,0,0,0),r.jsx(ZB,{includeTime:!1,showTimeSwitch:!1,date:a!=null?a:{from:i},selectRangeDate:!0,closeDatePicker:()=>{o()},onChange:(l,c)=>{t.current=l},onClear:()=>{}})}})},[e])},FO=()=>{const e=me();return F.useCallback((t,n,s)=>{e.dropdown({popcorn:t.target,placement:"bottom",content:({onCloseModal:a})=>r.jsx(I1e,{existPeople:n,onSelectPerson:o=>{s(o),a()}})})},[e])},I1e=e=>{const[t,n]=F.useState(""),a=Bg().filter(o=>!e.existPeople.includes(o.uuid));return r.jsx("div",{className:"w-[260px] py-2 next-modal",children:r.jsx(wC,{customHeader:r.jsx(xt,{autoFocus:!0,className:"h-8 mx-2.5 mb-2.5",placeholder:"搜索成员",onChange:o=>{n(o)}}),className:"py-1.5",search:t,users:a,onSelectPerson:e.onSelectPerson})})},yO=()=>{const e=me();return F.useCallback((t,n,s)=>{const a=dp({ancestorId:Ut(),filterTypes:[m.BlockType.FILE]});e.dropdown({popcorn:t.target,placement:"bottom",content:({onCloseModal:o})=>r.jsx(yc,{filterItems:n,defaultValue:a,onSelect:i=>{s(i.uuid),o()}})})},[e])},dI=7*24*60*60*1e3,_i="rounded pl-2 h-10 cursor-pointer hover:bg-black_006",j1e=e=>{const t=gt(),[n,s]=F.useState(e.defaultFilter),a=F.useCallback(R=>{s(A=>{const L=R(A);if(!L)return A;const P={...A,...L};return e.onFilterChange(P),P})},[e]),o=()=>{a(R=>({isTitleOnly:!R.isTitleOnly}))},i=yO(),l=FO(),c=xO(),u=F.useCallback(R=>{i(R,[],A=>{a(L=>{var M,U,V;if(((U=(M=L.ancestors)==null?void 0:M.indexOf(A))!=null?U:-1)===-1)return{ancestors:[...(V=L.ancestors)!=null?V:[],A]}})})},[i,a]),d=F.useCallback(R=>{var A;l(R,(A=n.createdBy)!=null?A:[],L=>{a(P=>{var U,V,W;if(((V=(U=P.createdBy)==null?void 0:U.indexOf(L))!=null?V:-1)===-1)return{createdBy:[...(W=P.createdBy)!=null?W:[],L]}})})},[n.createdBy,l,a]),f=F.useCallback(R=>{c(R,A=>{a(()=>{var L;return{createdTime:{start:A.from.getTime(),end:(L=A.to)==null?void 0:L.getTime()}}})})},[c,a]),h=F.useCallback(R=>{c(R,A=>{a(()=>{var L;return{lastEditedTime:{start:A.from.getTime(),end:(L=A.to)==null?void 0:L.getTime()}}})})},[c,a]),p=F.useCallback(()=>{a(R=>{var A;return{createdBy:[...(A=R.createdBy)!=null?A:[],K.user.uuid]}})},[a]),g=F.useCallback(()=>{const R=new Date(Date.now()-dI);R.setHours(0,0,0,0);const A=new Date;A.setHours(0,0,0,0),a(()=>({lastEditedTime:{start:R.getTime(),end:A.getTime()}}))},[a]),_=F.useCallback(()=>{a(R=>{var A;return{...R,ancestors:[...(A=R.ancestors)!=null?A:[],t]}})},[t,a]),{ancestors:x,createdBy:y,createdTime:b,lastEditedTime:E}=n,w=!(y!=null&&y.includes(K.user.uuid)),k=!(x!=null&&x.includes(t)),C=F.useMemo(()=>{const R=new Date(Date.now()-dI);R.setHours(0,0,0,0);const A=new Date;return A.setHours(0,0,0,0),(E==null?void 0:E.start)!==R.getTime()||E.end!==A.getTime()},[E]),T=w||k||C,v=!(x!=null&&x.length),I=!(y!=null&&y.length),j=!b,D=!E,S=v||I||j||D;return r.jsxs("div",{className:"bg-grey9 px-2 text-t2 text-grey3 w-[220px] py-2.5 overflow-scroll",children:[r.jsxs("div",{className:`flex justify-between items-center h-10 ${_i}`,onClick:o,children:[r.jsx(mo,{name:"IcTitleName",text:"只搜索标题"}),r.jsx(wn,{bgClassName:"mr-2",open:!!n.isTitleOnly,onSwitch:o})]}),r.jsx(D1e,{filter:n,updateFilter:a}),T&&r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none",children:"快速筛选"}),w&&r.jsx(mo,{className:_i,name:"IcTitleEditor",text:"我创建的页面",onClick:p}),C&&r.jsx(mo,{className:_i,name:"IcMenuDate",text:"上周编辑过的页面",onClick:g}),k&&r.jsx(mo,{className:_i,name:"IcSearchInpage",text:"在当前页面内搜索",onClick:_}),S&&r.jsx("div",{className:" flex items-center mt-2.5 ml-2 h-9 select-none",children:"自定义筛选"}),v&&r.jsx(mo,{className:_i,name:"IcSearchInpage",text:"在指定页面内搜索",onClick:u}),I&&r.jsx(mo,{className:_i,name:"IcTitleEditor",text:"创建人",onClick:d}),j&&r.jsx(mo,{className:_i,name:"IcMenuDate",text:"创建时间",onClick:f}),D&&r.jsx(mo,{className:_i,name:"IcMenuDate",text:"最后编辑时间",onClick:h})]})},D1e=e=>{var h,p;const{updateFilter:t,filter:n}=e,s=FO(),a=xO(),o=yO(),i=g=>{let _;n.lastEditedTime&&n.lastEditedTime.start&&n.lastEditedTime.end&&(_={from:new Date(n.lastEditedTime.start),to:new Date(n.lastEditedTime.end)}),a(g,x=>{t(()=>{var y;return{lastEditedTime:{start:x.from.getTime(),end:(y=x.to)==null?void 0:y.getTime()}}})},_)},l=g=>{let _;n.createdTime&&n.createdTime.start&&n.createdTime.end&&(_={from:new Date(n.createdTime.start),to:new Date(n.createdTime.end)}),a(g,x=>{t(()=>{var y;return{createdTime:{start:x.from.getTime(),end:(y=x.to)==null?void 0:y.getTime()}}})},_)},c=(g,_)=>{var x;s(g,(x=n.createdBy)!=null?x:[],y=>{t(b=>{if(!b.createdBy)return b;if(_){const E=b.createdBy.indexOf(_);if(E!==-1){const w=b.createdBy.slice(0);return w.splice(E,1),w.splice(E,0,y),{createdBy:w}}}else return{createdBy:[...b.createdBy,y]};return b})})},u=g=>{t(_=>{if(!_.createdBy)return _;const x=_.createdBy.indexOf(g);if(x!==-1){const y=_.createdBy.slice(0);return y.splice(x,1),{createdBy:y}}return _})},d=(g,_)=>{var x;o(g,(x=n.ancestors)!=null?x:[],y=>{t(b=>{if(!b.ancestors)return b;if(_){const E=b.ancestors.indexOf(_);if(E!==-1){const w=b.ancestors.slice(0);return w.splice(E,1),w.splice(E,0,y),{ancestors:w}}}else return{ancestors:[...b.ancestors,y]};return b})})},f=g=>{t(_=>{if(!_.ancestors)return _;const x=_.ancestors.indexOf(g);if(x!==-1){const y=_.ancestors.slice(0);return y.splice(x,1),{ancestors:y}}return _})};return r.jsxs("div",{children:[r.jsx("div",{children:(h=n.createdBy)==null?void 0:h.map((g,_,x)=>r.jsxs("div",{children:[_===0&&r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none",children:"创建人"}),r.jsxs("div",{className:"cursor-pointer rounded flex justify-between items-center pr-2 hover:bg-black_006",onClick:y=>{c(y,g)},children:[r.jsx(hi,{className:"my-px px-2 py-1.5",userId:g}),r.jsx(H,{onClick:y=>{y.stopPropagation(),u(g)},name:"IcUploadCancel",className:"text-grey4",style:{width:"18px",height:"18px"}})]}),_===x.length-1&&r.jsx(mo,{className:`${_i} text-grey4`,name:"IcAddBoard",text:"添加人员",onClick:y=>{c(y)}})]},_))}),n.createdTime&&r.jsxs("div",{children:[r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none text-center",children:"创建时间"}),r.jsxs("div",{className:"flex justify-between items-center cursor-pointer rounded hover:bg-black_006 pb-2",onClick:g=>{l(g)},children:[r.jsxs("div",{children:[r.jsx(mo,{className:"pl-2 h-10 text-black",name:"IcMenuDate",text:he(n.createdTime.start).format(Ct)}),r.jsxs("div",{className:"ml-9 text-black",children:["- ",he(n.createdTime.end).format(Ct)]})]}),r.jsx(H,{onClick:g=>{g.stopPropagation(),t(()=>({createdTime:void 0}))},name:"IcUploadCancel",className:"text-grey4 mr-2",style:{width:"18px",height:"18px"}})]})]}),n.lastEditedTime&&r.jsxs("div",{children:[r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none text-center",children:"最后编辑"}),r.jsxs("div",{className:"flex justify-between items-center cursor-pointer rounded hover:bg-black_006 pb-2",onClick:g=>{i(g)},children:[r.jsxs("div",{children:[r.jsx(mo,{className:"pl-2 h-10 text-black",name:"IcMenuDate",text:he(n.lastEditedTime.start).format(Ct)}),r.jsxs("div",{className:"ml-9 text-black",children:["- ",he(n.lastEditedTime.end).format(Ct)]})]}),r.jsx(H,{onClick:g=>{g.stopPropagation(),t(()=>({lastEditedTime:void 0}))},name:"IcUploadCancel",className:"text-grey4 mr-2",style:{width:"18px",height:"18px"}})]})]}),r.jsx("div",{children:(p=n.ancestors)==null?void 0:p.map((g,_,x)=>r.jsxs("div",{children:[_===0&&r.jsx("div",{className:"flex items-center mt-2.5 ml-2 h-9 select-none",children:"页面内搜索"}),r.jsxs("div",{className:"cursor-pointer rounded py-1 pl-1 flex justify-between items-center hover:bg-black_006",onClick:y=>{d(y,g)},children:[r.jsx(Aa,{uuid:g,interactable:!1,className:"text-ellipsis",showUnderLine:!1}),r.jsx(H,{onClick:y=>{y.stopPropagation(),f(g)},name:"IcUploadCancel",className:"text-grey4 mr-2",style:{width:"18px",height:"18px"}})]}),_===x.length-1&&r.jsx(mo,{className:`${_i} text-grey4`,name:"IcAddBoard",text:"添加页面",onClick:y=>{d(y)}})]},_))})]})},Hb={[m.SearchDocSortType.RELEVANCE]:"按匹配度",[m.SearchDocSortType.LAST_EDITED_NEWEST]:"按创建时间 - 最近到最早",[m.SearchDocSortType.LAST_EDITED_OLDEST]:"按创建时间 - 最早到最近",[m.SearchDocSortType.CREATED_NEWEST]:"按最后编辑时间：最近到最早",[m.SearchDocSortType.CREATED_OLDEST]:"按最后编辑时间：最早到最近"},S1e=e=>{const t=me(),n=s=>{const a=Object.keys(Hb).map(o=>({type:$.OPERATION,data:{sortType:o,title:Hb[o],hasArrow:e.sortType===o,arrow:r.jsx(H,{name:"IcSelectedSpace"})}}));t.dropdown({popcorn:s.target,placement:"top",content:({onCloseModal:o})=>r.jsx("div",{className:"next-modal w-[246px] py-1",children:r.jsx(ze,{items:a,onItemClick:(i,l)=>{const c=a[l];c&&(e.onSwitchType(c.data.sortType),o())}})})})};return r.jsxs("div",{className:"ml-[2px] rounded-sm cursor-pointer px-1.5 py-[2px] flex text-t2-medium items-center text-grey3 text-center hover:bg-black_006",onClick:n,children:[r.jsx("div",{children:Hb[e.sortType]}),r.jsx(H,{className:"ml-1",name:"IcArrow",size:"tiny"})]})},R1e=e=>r.jsxs("div",{className:"h-[46px] mt-2.5 mx-[15px] flex items-center justify-between text-t2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-grey3",children:"排序:"}),r.jsx(S1e,{sortType:e.sortType,onSwitchType:e.onSwitchType})]}),e.showCurrentPageSwitch&&r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-t2 text-grey3",children:"在当前页面搜索"}),r.jsx(wn,{bgClassName:"ml-2",open:e.searchInCurrentPage,onSwitch:e.onClickSearchInCurrentPage})]})]}),$b=new Map,fI=7;var AE=(e=>(e.normal="normal",e.share="share",e))(AE||{});const A1e=e=>{const t=L1e(),n=()=>{t(e)};return r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"w-px mx-2 h-3.5 bg-grey6 flex-shrink-0"}),r.jsx(Fe,{popup:`快速查找文档或文件${Gt}+P`,className:"flex justify-center items-center p-1 animate-hover",children:r.jsx(H,{size:"middle",name:"IcTitleSearch",onClick:n})})]})},mI={createdBy:[],ancestors:[]},B1e=e=>{const{type:t="normal",inPageId:n,rootPageId:s}=e,a=Ft(),o=gt(),i=_e(o,[]),l=Qt(),c=dr(()=>{var p;return new jo(localStorage,`recently_search${l.uuid}${(p=i==null?void 0:i.spaceId)!=null?p:Ut()}`,5)}),[u,d]=F.useState(()=>$b.has(a.uuid)?$b.get(a.uuid):{searchRecord:c,type:t,view:t==="normal"?"RECENT":"RESULT",keyword:"",recent:[],result:{total:0,items:[],hasMore:!1,pageNo:1},sortType:m.SearchDocSortType.RELEVANCE,showFilter:!1,inPageId:n,rootPageId:s,filter:n?{ancestors:[n]}:mI}),f=F.useCallback((p,g)=>{d(_=>{if(p==="view"&&g==="RESULT"&&!_.keyword)return _;if(t==="share")switch(p){case"showFilter":return _;case"view":if(g==="RECENT")return{..._,view:"RESULT",result:{total:0,items:[],hasMore:!1,pageNo:1}};break}return{..._,[p]:g}})},[t]);F.useEffect(()=>{$b.set(a.uuid,u)},[a.uuid,u]),F.useEffect(()=>{const p=()=>{f("searchRecord",c)};return c.addChangeListener(p),()=>{c.removeChangeListener(p)}},[f,c]);const h={RECENT:M1e,RESULT:hI,LOADING:hI,NOT_FOUND:V1e}[u.view];return F.useEffect(()=>{u.showFilter||f("filter",n?{ancestors:[n]}:mI)},[n,o,f,u.showFilter]),F.useEffect(()=>()=>{ce.event("search_cancel")},[]),r.jsxs("div",{className:`flex next-modal transition-all max-h-[630px] width-600 ${u.showFilter&&"max-w-[820px]"}`,children:[r.jsxs("div",{className:"width-600",children:[r.jsx(P1e,{state:u,patch:f}),r.jsx(h,{state:u,patch:f})]}),u.showFilter&&r.jsx(j1e,{defaultFilter:u.filter,onFilterChange:p=>{f("filter",p)}})]})},L1e=()=>{const e=me();return t=>{ce.event("search_click"),e.modal({modalId:Xe.QUICK_SEARCH,center:!1,containerClassName:"!pt-[10vh]",content:()=>r.jsx(B1e,{...t})})}},P1e=e=>{var x;const{state:{keyword:t,view:n,filter:s,sortType:a,type:o,inPageId:i},patch:l}=e,c=_O(),u=F.useRef(null),d=gt(),f=_e(d,["data"],["segments"]),h=Od((x=f==null?void 0:f.spaceId)!=null?x:Ut()),p=F.useRef(!1),g=y=>{y||(l("view","RECENT"),l("showFilter",!1)),l("keyword",y)},_=F.useRef(0);return bm(()=>{if(!t||p.current)return;(async b=>{var T;const E=++_.current,{total:w,results:k,hasMore:C}=await c({space:(T=f==null?void 0:f.spaceId)!=null?T:Ut(),page:1,perPage:10,query:b,source:o==="normal"?"quickFind":"quickFindPublic",sort:a,filters:s});E===_.current&&(k.length>0?(l("result",{total:w,items:k,hasMore:C,pageNo:1}),l("view","RESULT")):(l("result",{total:0,items:[],hasMore:C,pageNo:1}),l("view","NOT_FOUND")),l("showFilter",!0))})(t)},[a,s,t,l,f==null?void 0:f.spaceId,c],{wait:800}),F.useEffect(()=>{t&&l("view","LOADING")},[a,s,t,l]),r.jsxs("div",{className:"pt-2.5 mx-2.5 relative",children:[r.jsx(xt,{selection:[0,t.length],onCompositionChange:y=>{p.current=y},inputRef:u,autoFocus:!0,className:"h-8 pl-10 rounded-sm",inputClassName:"pl-0",placeholder:i?`在「${de(f==null?void 0:f.data.segments)||Ot(f==null?void 0:f.type)}」页面搜索`:`在「${h.title}」中搜索`,value:t,onFocus:()=>ce.event("search_box_click"),onChange:y=>g(y)}),n==="LOADING"?r.jsx(hs,{size:"middle",className:"absolute left-3 top-4 text-xl text-grey4 leading-none"}):r.jsx(H,{className:"absolute left-3 top-4 text-xl text-grey4 leading-none",name:"IcTitleSearch"}),t&&r.jsx(H,{onClick:()=>{var y;l("showFilter",!1),g(""),(y=u.current)==null||y.focus()},name:"IcUploadCancel",className:"absolute right-0 top-4 text-grey4 mr-2",style:{width:"18px",height:"18px"}})]})},O1e=({filter:e})=>{const t=[];if(!e)return null;e.isTitleOnly&&t.push("只搜索标题"),e.pagesName&&e.pagesName.length>0&&e.pagesName.forEach((s,a,o)=>{t.push(`${a===0?"在":""}${s}${a!==o.length-1?", ":" 中搜索"}`)}),e.createdBy&&e.createdBy.length>0&&e.createdBy.forEach((s,a,o)=>{const i=ss(s);i&&t.push(`${a===0?"由":""}${i}${a!==o.length-1?", ":" 创建"}`)}),e.createdTime&&t.push(`创建于 ${he(e.createdTime.start).format(Ct)}-${he(e.createdTime.start).format(Ct)}`),e.lastEditedTime&&t.push(`最后编辑于 ${he(e.lastEditedTime.start).format(Ct)}-${he(e.lastEditedTime.start).format(Ct)}`);let n="";return t.length>0&&(n=`- ${t.join("·")}`),r.jsx("span",{className:"ml-2 text-t2 text-grey4",children:n})},M1e=e=>{const{state:{recent:t,searchRecord:n},patch:s}=e,a=gt(),o=_e(a,[]),i=F.useRef(null),l=hh(),c=Kt(),u=bO(),d=Cs(),f={key:"RECENT_VISIT_TIMESTAMP",get:()=>{var y;return Number((y=localStorage.getItem(f.key))!=null?y:0)},set:y=>Nn(f.key,String(y))},h=n.getSortItems(),p=async()=>{var j,D;const y=(j=o==null?void 0:o.spaceId)!=null?j:Ut(),b=f.get(),E=await Ce.editor.querySpaceVisitsHistory(y,+b);if(typeof E!="object")return;const{results:w,recordMap:k}=E;if(!w||!k)return;const{blocks:C}=k;if(!C)return;ee(Gn.update({blocks:C}));const T=S=>{if(S){const R=C[S];if(R)return R}},v=[];let I=0;for(let S=0;I<fI&&S<w.length;S++){const R=(D=w[S])==null?void 0:D.uuid,A=T(R);A&&v.length<fI&&(I++,v.push(A))}s("recent",v)};F.useEffect(()=>{p()},[]);const g=()=>{ce.event("clear_recent_used"),f.set(Date.now()),s("recent",[])},_=y=>{const b=de(y.data.segments);return b||Ot(y.type)},x=(y,b)=>{ce.event("recent_used",{page_type:y.type}),y.type===m.BlockType.FILE?(l(y.uuid),c(Xe.QUICK_SEARCH)):(d(y.uuid,{forceOpenInRight:b.forceOpenInRight,forceOpenNewTab:b.forceOpenNewTab}),b.forceOpenNewTab||c(Xe.QUICK_SEARCH))};return t.length===0&&n.length()===0?r.jsx("div",{className:"h-2.5"}):r.jsx("div",{className:"max-h-[580px] overflow-y-auto py-1 transition-all",ref:i,children:r.jsx(Bd,{customItem:!0,defaultIndex:0,containerRef:i,listenPriority:Tr,itemCount:t.length+n.length(),children:(y,b)=>r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"group",children:t.map((E,w)=>r.jsxs("div",{children:[w===0&&r.jsxs("div",{className:"h-[46px] mt-2.5 mx-[15px] flex items-center justify-between text-t2",children:[r.jsx("div",{className:"text-grey3",children:"最近浏览"}),r.jsx("div",{className:"px-2 text-grey4 text-center rounded animate-hover hidden group-hover:block",onClick:g,children:"清除"})]}),r.jsxs("div",{"list-item-custom":"",className:B("py-[9px] flex  mx-2 flex-row animate-hover",{"normal-bg":w===y}),onContextMenu:k=>{u(k,()=>x(E,{forceOpenNewTab:!0}))},onClick:k=>x(E,{forceOpenInRight:k.altKey,forceOpenNewTab:k.ctrlKey||k.metaKey}),onMouseEnter:()=>b(w),children:[r.jsx("div",{className:"ml-2 text-xl leading-none block",children:r.jsx(tn,{blockId:E.uuid,trigger:!1,defaultIcon:r.jsx(as,{uuid:E.uuid})})}),r.jsx("div",{className:B("flex flex-col justify-center ml-2 flex-1 max-w-[280px]"),children:r.jsx(Hh,{className:"text-t2-medium block",children:_(E)})})]})]},w))}),r.jsx("div",{className:"group",children:h.map((E,w)=>r.jsxs("div",{children:[w===0&&r.jsxs("div",{className:"h-[46px] mt-2.5 mx-[15px] flex items-center justify-between text-t2",children:[r.jsx("div",{className:"text-grey3",children:"最近搜索"}),r.jsx("div",{className:"px-2 text-grey4 text-center rounded animate-hover hidden group-hover:block",onClick:()=>{n.clear()},children:"清除"})]}),r.jsxs("div",{"list-item-custom":"",className:B("group-scope py-[9px] flex  mx-2 flex-row animate-hover",{"normal-bg":w===y-t.length}),onMouseEnter:()=>b(w),onClick:()=>{if(s("keyword",E.key),E.value){const{pagesName:k,...C}=E.value;s("filter",C)}},children:[r.jsx("div",{className:"ml-2 text-xl leading-none block",children:r.jsx(H,{name:"IcSearch",size:"middle"})}),r.jsx("div",{className:B("flex flex-col justify-center ml-2 flex-1 text-t2-medium text-ellipsis"),children:r.jsxs("span",{children:[E.key,r.jsx(O1e,{filter:E.value})]})}),r.jsx(H,{onClick:k=>{n.delete(E.key),k.stopPropagation()},name:"IcUploadCancel",className:"text-grey4 mr-2 transition-opacity opacity-0 group-scope-hover:opacity-100",size:"middle"})]})]},E.key))})]})})})},hI=e=>{var v,I;const{state:{searchRecord:t,keyword:n,result:{items:s,hasMore:a,pageNo:o},sortType:i,filter:l,showFilter:c,type:u,rootPageId:d},patch:f}=e,h=gt(),p=_e(h,[]),g=_O(),[_,x]=F.useState(!1),y=Kt();Un();const b=hh(),E=bO(),w=Cs(),k=async()=>{var D;const j=(D=p==null?void 0:p.spaceId)!=null?D:Ut();x(!0);try{const{total:S,results:R,hasMore:A}=await g({space:j,page:o+1,perPage:10,sort:i,filters:l,query:n,source:u==="normal"?"quickFind":"quickFindPublic"}),L=[...s];L.push(...R),f("result",{total:S,items:L,hasMore:A,pageNo:o+1})}finally{x(!1)}},C=F.useRef(),T=(j,D)=>{var P,M,U;const S=K.blocks[(P=j.pageId)!=null?P:""];if(!S)return;ce.event("search_result_click",{page_type:S.type});let{pageId:R,uuid:A}=j;if((p==null?void 0:p.type)===m.BlockType.TABLE_ROW)A=p.parentId;else if(S.type===m.BlockType.FILE)b(S.uuid),y(Xe.QUICK_SEARCH);else if(j.pageId===j.uuid)A="";else{let V=S.uuid;const W=ls(j.uuid);W&&((M=K.blocks[W])==null?void 0:M.type)===m.BlockType.MIND_MAPPING&&(V=W),R=V}R&&w(R,{forceOpenInRight:D.forceOpenInRight,forceOpenNewTab:D.forceOpenNewTab,hash:A?`#${A}`:void 0}),y(Xe.QUICK_SEARCH);const L=(U=l==null?void 0:l.ancestors)==null?void 0:U.map(V=>{const W=K.blocks[V],z=de(W==null?void 0:W.data.segments);return z||Ot(W==null?void 0:W.type)});t.put(n,{...l,pagesName:L})};return r.jsxs(r.Fragment,{children:[s.length>0&&r.jsx(R1e,{showCurrentPageSwitch:u==="share"&&h!==d,searchInCurrentPage:((v=l.ancestors)==null?void 0:v.length)===1&&((I=l.ancestors)==null?void 0:I[0])===h,onClickSearchInCurrentPage:j=>{j?f("filter",{...l,ancestors:[h]}):d&&f("filter",{...l,ancestors:[d]})},onShowFilter:()=>{f("showFilter",!0)},showFilter:c,sortType:i,onSwitchType:j=>{f("sortType",j)}}),r.jsxs("div",{ref:C,className:"max-h-[530px] overflow-y-auto pb-2 transition-all",children:[r.jsx(Il,{pageStart:1,initialLoad:!1,useWindow:!1,loadMore:k,getScrollParent:()=>C.current,hasMore:a,children:r.jsx(Bd,{customItem:!0,defaultIndex:-1,containerRef:C,itemCount:s.length,children:j=>s.map((D,S)=>r.jsx(U1e,{active:S===j,item:D,keyword:n,onClick:R=>{T(D,{forceOpenNewTab:R.metaKey||R.ctrlKey,forceOpenInRight:R.altKey})},onContextMenu:R=>{E(R,()=>T(D,{forceOpenNewTab:!0}))}},S))})}),_&&r.jsx("div",{className:"w-full flex justify-center",children:r.jsx(hs,{size:"large"})})]})]})},U1e=e=>{var l;const{item:t,active:n,keyword:s}=e,a=_e((l=t.pageId)!=null?l:"",["data"],["segments"]);if(!a)return null;const o=()=>{const c=de(a.data.segments);return c||Ot(a.type)},i=t.uuid===t.pageId;return r.jsxs("div",{"list-item-custom":"",className:B("py-[9px] flex flex-row animate-hover mx-2 rounded",{"normal-bg":n}),onContextMenu:e.onContextMenu,onClick:e.onClick,children:[r.jsx("div",{className:"ml-[15px] text-xl leading-none block",children:r.jsx(tn,{blockId:a.uuid,trigger:!1,defaultIcon:r.jsx(as,{uuid:a.uuid})})}),r.jsxs("div",{className:B("ml-2 overflow-hidden",!t.navs.length&&"flex flex-col justify-center"),children:[r.jsx(Hh,{className:"text-t2 block",children:i?r.jsx(Rx,{text:o(),search:s,className:"text-t2-medium"}):r.jsx("div",{className:"text-t2-medium",children:o()})}),r.jsx("div",{className:"mt-[2px] text-t4 text-grey3",hidden:!t.navs.length,children:r.jsx(lg,{navs:t.navs})}),!i&&r.jsx(I$,{limitLen:50,text:t.hitText,search:s,className:"text-t2-medium",containerClassName:"text-ellipsis"})]})]},a.uuid)},V1e=()=>r.jsx("div",{className:"py-5 text-t2 text-grey4 text-center leading-[22px]",children:"无相关页面"}),bO=()=>{const e=me();return F.useCallback((t,n)=>{e.dropdown({placement:"bottom-start",offset:[4,4],popcorn:lm(t),content:()=>r.jsx("div",{className:"next-modal w-[240px]",onClick:n,children:r.jsx("div",{className:"animate-hover rounded flex items-center p-2 cursor-pointer justify-between",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(H,{name:"IcMenuOpenNew",size:"middle"}),r.jsx("div",{className:"text-t2 ml-2",children:"新窗口打开"})]})})})})},[e])},EO=e=>{const{emptyStyle:t}=e,n=me(),s=gt(),a=Ve(s),o=zg(s),i=_e(s,["isTemplate"]),l=iD(),c=NV(),u=uD(),d=rx(),f=On(),h=hw(),p=IF(),{role:g,illegal:_,allowDuplicate:x,publicRole:y,allowShowSidebar:b}=it(s),E=_||h,w=ht(),k=Yd(s),C=Ar(Oc),T=sa(Oc),v=iO(s),I=ax(),j=Lk(),D=Pk&&!j,S=ae(P=>{let M=P.blocks[s],U=M;for(;M;){const V=P.blocks[M.parentId];if(V!=null&&V.permissions.some(W=>W.shareShowSidebar)&&(U=V),V&&V.type!=="SPACE"){M=V;continue}break}return U==null?void 0:U.uuid}),R=()=>{n.warning({title:"重置网络状态",content:r.jsxs("div",{className:"text-left",children:[r.jsx("p",{className:"mb-2",children:"  操作系统可能会误判网络状态，如果您的网络正常，点“确定”可以重置网络状态。"}),r.jsx("p",{children:"  如果重置后还是会复现，可以按此步骤切换网络状态"})]}),confirm:()=>{$r.setStatus("online")},confirmText:"确定",cancelText:"取消"})},A=C==="page-feeds"||C==="page-resolved-discussions"||C==="service-center";if(pt.print)return null;let L=null;return i&&!((o==null?void 0:o.tag)==="NO_PERMISSION"||g===m.PermissionRole.NONE)||E?L=r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex overflow-hidden",children:[w&&r.jsx(K0,{showInSharePage:b}),w&&r.jsx(rh,{className:"sm:hidden border-r pr-4"}),!v&&r.jsx(P5,{showHistoryButton:!0,ancestorId:A1?LV():void 0}),!w&&r.jsx(S3,{uuid:s})]}),(i&&[m.BlockType.PAGE,m.BlockType.FOLDER,m.BlockType.COLLECTION_VIEW_PAGE,m.BlockType.REFERENCE_COLLECTION,m.BlockType.REFERENCE_COLLECTION_PAGE,m.BlockType.COLLECTION_VIEW,m.BlockType.MIND_MAPPING,m.BlockType.MIND_MAPPING_PAGE].includes(i.type)&&!f||E)&&!A1&&r.jsx("div",{className:B("relative flex items-center justify-end h-full flex-shrink-0",A&&"w-[calc(360px-16px)] border-l border-l-grey6"),children:r.jsxs("div",{className:B("flex items-center justify-end",A&&"absolute w-full"),children:[A&&r.jsx(Fe,{className:"mr-auto flex items-center justify-center p-1 text-grey3 animate-hover ml-4",popup:dO[C],onClick:()=>{T(!1)},children:r.jsx(H,{name:"IcUnfold",size:"middle"})}),u.backup?r.jsx(Fe,{className:"mr-2",popup:r.jsxs(r.Fragment,{children:["您的本地修改多次同步失败。请",r.jsx("strong",{children:"*备份*"}),"文档内容并尝试",r.jsx("strong",{children:"*刷新*"}),"页面。在同步恢复之前，您将无法继续编辑"]}),children:r.jsxs("span",{className:"inline-flex text-t2 px-3 py-1 rounded items-center text-white bg-red",children:[r.jsx(H,{className:"mr-1",name:"IcBadgeDanger",size:"middle"}),r.jsx("span",{children:"保存失败"})]})}):l?c?r.jsx(Fe,{className:"mr-2 animate-click",popup:r.jsx("div",{children:"🤔 网络一切正常？点击立即恢复"}),onClick:R,children:r.jsxs("span",{className:"inline-flex text-t2 px-3 py-1 rounded items-center text-white bg-red",children:[r.jsx(H,{className:"mr-1",name:"IcTitleOffline",size:"middle"}),r.jsx("span",{children:"网络故障"})]})}):r.jsx(Fe,{className:"mr-2 animate-click",popup:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{children:"离线中"}),r.jsx("p",{children:"🤔 网络一切正常？点击立即恢复"})]}),onClick:R,children:r.jsx(H,{className:"text-grey4",name:"IcTitleOffline",size:"middle"})}):c?r.jsx(Fe,{className:"mr-2",popup:"同步中",children:r.jsx(H,{className:"text-grey4 animate-spin",name:"IcMenuReplace",size:"middle"})}):null,!a&&r.jsx("div",{className:"px-2.5 mr-2 flex-1 overflow-x-auto",children:r.jsx(t1e,{},s)}),!w&&!E&&!k&&r.jsx(vg,{showType:"button",className:"mr-1.5"}),w&&!_&&y===m.PermissionRole.COMMENTER&&r.jsx(o1e,{}),w&&!_&&x&&!k&&r.jsx(je,{className:"text-t2-medium mr-4 sm:mx-4 flex-shrink-0",onClick:()=>{ce.event("copytomyspace",{page_id:s}),p(s)},children:"拷贝到"}),!_&&(g===m.PermissionRole.WRITER||g===m.PermissionRole.EDITOR)&&r.jsx(gO,{className:"mr-[6px]"}),!w&&!a&&!_&&r.jsx(oF,{uuid:s,className:"mr-1.5"}),r.jsx(pO,{}),!v&&r.jsx(A1e,{type:w?AE.share:AE.normal,inPageId:s,rootPageId:w?S:void 0}),r.jsx(fO,{})]})})]}):L=r.jsx(q1e,{}),t&&(L=r.jsx(H1e,{})),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex w-full",children:r.jsx("div",{className:B("flex justify-between items-center w-full h-[54px] px-4 bg-white1 transition-all",d&&!(u.backup||u.noPermission||l&&c)?"duration-500 opacity-0":"duration-100 opacity-100",D&&"pl-20",D&&!I&&!w&&"pl-4",D&&t&&"pl-20",D&&"drag-container"),children:L})}),r.jsx(v1e,{})]})},q1e=()=>{const e=Ve(),t=gt(),n=zg(t),s=ht();let a=null;return e||(n==null?void 0:n.tag)==="NO_PERMISSION"?s?a=r.jsx(rh,{className:"sm:hidden"}):a=r.jsxs("div",{className:"flex items-center",children:[r.jsx(K0,{}),r.jsx(W0,{})]}):a=r.jsxs("div",{className:"flex items-center",children:[r.jsx(K0,{}),r.jsx(W0,{})]}),a},H1e=()=>r.jsxs(r.Fragment,{children:[r.jsx(W0,{}),r.jsx(rh,{className:"sm:hidden"}),r.jsx(fO,{})]});Moe(EO);const{LoginWrapper:$1e}=d_(()=>ve(()=>Promise.resolve().then(()=>nge),void 0)),{Create:G1e}=d_(()=>ve(()=>import("./create-2bc41414.js"),["assets/create-2bc41414.js","assets/vendor-72681657.js"])),{FilePreviewPage:z1e}=d_(()=>ve(()=>import("./index-6f94e90c.js"),["assets/index-6f94e90c.js","assets/vendor-72681657.js"])),{SharePage:W1e}=d_(()=>ve(()=>import("./index-9af15db3.js").then(e=>e.l),["assets/index-9af15db3.js","assets/vendor-72681657.js"])),{Home:pI}=d_(()=>ve(()=>import("./home-1fa1ce7d.js"),["assets/home-1fa1ce7d.js","assets/vendor-72681657.js","assets/index-9af15db3.js"])),K1e=({children:e})=>r.jsx(F.StrictMode,{children:r.jsx(M8,{children:r.jsx(ej,{store:U1,children:r.jsx(Nd,{children:r.jsx(Wg,{children:r.jsx(jl,{children:r.jsx(U_e,{children:e})})})})})})}),Y1e=()=>{const e=kV(),[,t]=F.useState();return F.useEffect(()=>{e&&t(()=>{throw new Error(e)})},[e]),r.jsxs(U8,{children:[r.jsx(xu,{path:"/preview/:blockId",component:z1e}),r.jsx(xu,{path:"/form",component:Z_e}),r.jsx(xu,{path:"/login",component:$1e}),r.jsx(xu,{path:"/create",component:G1e}),r.jsx(xu,{path:["/share/:blockId","/:domain/share/:blockId"],component:W1e}),r.jsx(xu,{path:"/",component:pI}),r.jsx(xu,{path:["/:domain/:blockId","/:blockId?"],component:pI})]})},X1e=({children:e})=>{$_e(),Y_e(),ope(),VV(),W_e(),X_e(),G_e(),z_e();const t=iD(),n=K_e(),s=Gk(),a=Un(),[o,i]=F.useState(""),[l,c]=F.useState(!0),u=Qw(),d=sa(Oc),f=wV();F.useEffect(()=>{if(location.pathname==="/"&&ud()){c(!1);return}if(ma(Rt.login)||ma(Rt.create))c(!1);else if(un)n().finally(()=>{c(!1)});else{const p=location.pathname!==Rt.main;n(p).finally(()=>{c(!1)})}},[n]),F.useEffect(()=>{ce.event("predefinePageView")},[]),F.useEffect(()=>{setInterval(()=>{const p=ns(Date.now());wt.$today!==p&&Ye({$today:p})},30*60*1e3)},[]),F.useEffect(()=>{const p=g=>(g.type==="offline"?fetch(`${aw}gen_204`,{cache:"no-cache"}).then(()=>{$r.setStatus("online")}).catch(()=>{navigator.onLine?$r.setStatus("online"):$r.setStatus("offline")}):$r.setStatus("online"),g.type!=="offline"&&wt.$firstLoadPage&&location.reload(),!0);return qt.addEventListener("online",p),qt.addEventListener("offline",p),()=>{qt.removeEventListener("online",p),qt.removeEventListener("offline",p)}}),F.useEffect(()=>a.block((g,_)=>{var b,E,w,k;if(_==="PUSH"&&nN(g)===nN(a.location)){if(g.hash===a.location.hash){const C=GS(g.hash);C&&N9(lx(g.pathname),C,u)}return!1}const x=g.pathname.slice(-36);if(!Q0(x))return;mT.lastPageId=(b=Gc(g.search))!=null?b:mT.lastPageId;const y=(k=K.spaces[(w=(E=K.blocks[x])==null?void 0:E.spaceId)!=null?w:""])==null?void 0:k.domain;if(!ud()&&y&&!g.pathname.startsWith(`/${y}`)){const C=_==="PUSH"?a.push:a.replace;return ma(Rt.share,"startsWith",g.pathname)?(C(`/${y}${Rt.share}${x}${g.search}${g.hash}`),!1):(C(`/${y}/${x}${g.search}${g.hash}`),d(!1),!1)}Yu.tmpDisable||(Yu.lastGoBackPath=_==="POP"?g.pathname:""),s==null||s(),ee(nt.updateSelectBlocks([])),d(!1)}),[a,s,u,d]);const h=F.useMemo(()=>t&&f?r.jsxs(r.Fragment,{children:[r.jsx(EO,{}),r.jsx(Q_e,{})]}):l?r.jsx(os,{fixed:!0}):e,[e,f,l,t]);return r.jsxs(r.Fragment,{children:[un&&!tp&&r.jsx("div",{className:"drag-container fixed w-full top-0 h-3.5 z-[8848]"}),r.jsx(V8,{onError:p=>i(JSON.stringify(p.stack)),fallback:r.jsx(q_e,{errorMessage:o}),children:r.jsx(F.Suspense,{fallback:r.jsx(os,{fixed:!0}),children:h})})]})},Q1e=()=>null,J1e=pt.print;J1e&&pt.token&&pt.sig&&pt.userId&&(T1.set("next_auth",pt.token),T1.set("next_auth.sig",pt.sig),Nn(cd,pt.userId));const Z1e=()=>{cse()!==0&&(lse()?document.documentElement.classList.add("next-scrollbar-overlay"):document.documentElement.classList.add("next-scrollbar"))},e0e=()=>{const e=decodeURIComponent(window.location.href);if(e.includes(id)){const[t]=e.split(id);if(t)return cp(t.trim()),!0}if(e.includes(" ")){const t=Sa(e.split(" "));if(t)return cp(t),!0}},t0e=()=>{if(location.pathname===Rt.main&&ud())return!0},n0e=async()=>{if(location.pathname===Rt.main)return un?!1:(cp(`${Sn()}/product${location.search}${location.hash}`),!0)},s0e=()=>{const{search:e,hash:t}=location,n=Rt.share,s=location.pathname.indexOf(n);if(s===-1)return;if(location.pathname.slice(s+n.length).length>36){const o=location.pathname.slice(0,s+n.length+36);return cp(`${o}${e}${t}`),!0}},gI=()=>{Is.render(r.jsx(K1e,{children:r.jsxs(X1e,{children:[r.jsx(Y1e,{}),r.jsx(Q1e,{})]})}),document.getElementById("root"))},r0e=()=>{const t=new URLSearchParams(location.search).get(ms.promotionChannel);t&&Nn(ms.promotionChannel,JSON.stringify({promotionChannel:t,time:Date.now()}))},a0e="code",o0e="state",i0e="/auth-callback",l0e=()=>{if(!location.pathname.startsWith(i0e))return;const e=new URLSearchParams(location.search),t=e.get(a0e),n=e.get(o0e);if(t&&n)return window.parent.postMessage({code:t,state:n}),!0};const c0e=async()=>{if(e0e())return;if(Z1e(),r0e(),t0e()){gI();return}if(l0e())return;const t=yx();let n;!t&&(n=s0e(),n||(n=await n0e(),n))||gI()};c0e();if(un){const e=async()=>{var o;const n=await GF();((o=n==null?void 0:n.forceClearLocalAndReloadIds)!=null?o:[]).includes("1.53.0-2023/5/19 15:41:37")&&ri(Ss.ClearCacheAndReload)};(()=>{e()})()}q8({dsn:"https://a99f4f441a1641c8aa2e423c01e6c705@sentry.allflow.cn/6",autoSessionTracking:!0,tracesSampleRate:1,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications.","Unexpected token '<'"],environment:"production",release:"303a12d8e6f8a744e8260c6edd6c4eecf1c9f733"});export{Xt as $,am as A,je as B,tq as C,om as D,V_e as E,R9 as F,Nn as G,Bs as H,H as I,Gn as J,Am as K,ze as L,Ye as M,Hd as N,ke as O,S6 as P,cs as Q,UF as R,Et as S,Bn as T,id as U,Rt as V,pe as W,Ka as X,TC as Y,Rc as Z,Pu as _,d0e as __vite_legacy_guard,Kt as a,P0e as a$,yw as a0,tr as a1,Zp as a2,S0e as a3,E0e as a4,hn as a5,ek as a6,go as a7,eG as a8,U0e as a9,A0e as aA,O0e as aB,Ri as aC,th as aD,ks as aE,sy as aF,Ol as aG,Fne as aH,Ug as aI,W1 as aJ,Po as aK,rG as aL,Ya as aM,K$ as aN,kd as aO,F0 as aP,Ae as aQ,We as aR,Ma as aS,F6 as aT,Ut as aU,ae as aV,So as aW,X$ as aX,R0 as aY,xo as aZ,cg as a_,OS as aa,Es as ab,V0e as ac,Sk as ad,uc as ae,Jw as af,Ud as ag,kB as ah,M0e as ai,Wr as aj,Ou as ak,Zo as al,w2 as am,Vd as an,Kc as ao,Q$ as ap,US as aq,$S as ar,Eb as as,wt as at,iG as au,nt as av,tG as aw,J$ as ax,ZR as ay,VT as az,Qt as b,Ac as b$,H$ as b0,Ft as b1,Qd as b2,ef as b3,Wc as b4,jF as b5,On as b6,x0e as b7,hk as b8,Ro as b9,Hr as bA,Fg as bB,Mw as bC,K0e as bD,ls as bE,Vn as bF,b0e as bG,Oc as bH,ow as bI,Tt as bJ,Xr as bK,L0e as bL,Z$ as bM,jn as bN,lB as bO,An as bP,Ui as bQ,pt as bR,Vx as bS,sz as bT,Pa as bU,Jt as bV,xz as bW,fa as bX,lV as bY,Gte as bZ,S_ as b_,Vt as ba,qt as bb,GD as bc,uD as bd,Xe as be,GH as bf,xs as bg,My as bh,j0e as bi,Fc as bj,I0e as bk,In as bl,Ao as bm,Bk as bn,ac as bo,pa as bp,Bl as bq,es as br,J1 as bs,Fe as bt,v0e as bu,Yn as bv,vR as bw,Pi as bx,Y0e as by,ht as bz,B as c,qj as c$,_O as c0,os as c1,_e as c2,de as c3,Ot as c4,tn as c5,as as c6,I$ as c7,Ls as c8,m_ as c9,xV as cA,n$ as cB,ZH as cC,au as cD,Vj as cE,it as cF,zg as cG,La as cH,axe as cI,W0e as cJ,TV as cK,iD as cL,g0e as cM,sD as cN,ED as cO,EO as cP,Q_e as cQ,GN as cR,$m as cS,jW as cT,Al as cU,a6 as cV,Hm as cW,Wg as cX,ipe as cY,Cr as cZ,Sd as c_,Uj as ca,GU as cb,Voe as cc,Gge as cd,dO as ce,Rr as cf,Xj as cg,Ve as ch,qh as ci,$o as cj,hr as ck,pJ as cl,_J as cm,lxe as cn,zD as co,nxe as cp,BA as cq,im as cr,YD as cs,fK as ct,yU as cu,Fa as cv,yD as cw,Aa as cx,Wj as cy,dr as cz,ee as d,fxe as d$,Gc as d0,PV as d1,tx as d2,$f as d3,xl as d4,jl as d5,ise as d6,wV as d7,Um as d8,Ey as d9,qT as dA,nr as dB,sle as dC,gxe as dD,_xe as dE,hxe as dF,Qs as dG,pxe as dH,KR as dI,rxe as dJ,mxe as dK,X0e as dL,Gs as dM,cxe as dN,yB as dO,Si as dP,yF as dQ,dV as dR,sxe as dS,Qe as dT,Zt as dU,Vg as dV,Kn as dW,TB as dX,fC as dY,mt as dZ,B1 as d_,TE as da,nA as db,N0e as dc,fi as dd,Nge as de,kG as df,Fxe as dg,D1 as dh,iV as di,sk as dj,qoe as dk,ty as dl,ud as dm,txe as dn,y$ as dp,eV as dq,cd as dr,Ci as ds,pG as dt,XJ as du,oxe as dv,ki as dw,rle as dx,bB as dy,Qm as dz,oy as e,kL as e$,LJ as e0,wr as e1,RC as e2,sn as e3,die as e4,_s as e5,C$ as e6,bs as e7,mp as e8,Er as e9,Rle as eA,e_ as eB,tV as eC,Br as eD,Ale as eE,lm as eF,cB as eG,q0e as eH,Cj as eI,fV as eJ,Yne as eK,_G as eL,lG as eM,bH as eN,jg as eO,_d as eP,Fr as eQ,Kp as eR,ZU as eS,OV as eT,Cs as eU,mT as eV,mu as eW,fee as eX,L5 as eY,tf as eZ,wL as e_,gp as ea,fj as eb,Pe as ec,Rv as ed,hg as ee,Jk as ef,Bee as eg,JE as eh,ma as ei,Zk as ej,dxe as ek,Ad as el,kg as em,oi as en,_o as eo,$0e as ep,uxe as eq,ka as er,fm as es,zl as et,Qn as eu,tm as ev,CZ as ew,YY as ex,SC as ey,Kne as ez,Uw as f,H6 as f$,L1e as f0,Tie as f1,Rm as f2,Nie as f3,Dle as f4,vie as f5,lu as f6,H0e as f7,HS as f8,Dm as f9,Xf as fA,d2 as fB,p0e as fC,ss as fD,ni as fE,AV as fF,y0e as fG,ax as fH,F0e as fI,Lk as fJ,w0e as fK,Ps as fL,yxe as fM,Pk as fN,Pm as fO,G1 as fP,Bm as fQ,vr as fR,oI as fS,cr as fT,Aj as fU,Wp as fV,Yr as fW,us as fX,yQ as fY,lK as fZ,aK as f_,ct as fa,Ll as fb,Wa as fc,bi as fd,$j as fe,$r as ff,AE as fg,Sg as fh,DG as fi,hs as fj,hh as fk,Hh as fl,Rx as fm,rs as fn,lg as fo,yR as fp,o6 as fq,Mg as fr,CJ as fs,Og as ft,G0e as fu,IS as fv,R0e as fw,ui as fx,aO as fy,Js as fz,NS as g,lx as g$,eK as g0,nK as g1,$6 as g2,rK as g3,dK as g4,iK as g5,Pn as g6,mk as g7,YT as g8,Ra as g9,Gt as gA,S5 as gB,d1e as gC,NB as gD,z0e as gE,B0e as gF,m1e as gG,hZ as gH,_0e as gI,Do as gJ,Wx as gK,wxe as gL,ox as gM,n3 as gN,xxe as gO,NG as gP,zx as gQ,S9 as gR,$1 as gS,yg as gT,u0 as gU,Exe as gV,W$ as gW,VS as gX,ixe as gY,IF as gZ,nh as g_,zy as ga,JW as gb,zp as gc,SF as gd,oh as ge,XE as gf,YE as gg,Nc as gh,lo as gi,an as gj,nV as gk,mi as gl,zc as gm,jX as gn,by as go,bS as gp,$i as gq,Nre as gr,xJ as gs,P5 as gt,Rl as gu,vc as gv,hi as gw,Mm as gx,yu as gy,Ss as gz,bn as h,Uoe as h0,hw as h1,Im as h2,mn as h3,IU as h4,nw as h5,ip as h6,gS as h7,hD as h8,Qx as h9,iO as ha,wy as hb,v6 as hc,wg as hd,ir as he,Rs as hf,H5 as hg,Xx as hh,nd as hi,Z0e as hj,kl as hk,exe as hl,ii as hm,Upe as hn,f_ as ho,Nt as hp,sv as hq,bxe as hr,Q0e as hs,J0e as ht,Dx as hu,Dn as i,xt as j,Sn as k,ms as l,ce as m,ye as n,kS as o,$ as p,gt as q,Ce as r,Z1 as s,oa as t,me as u,K as v,on as w,le as x,Tn as y,hd as z};
//# sourceMappingURL=index-3008c55e.js.map
